{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6108387973314772, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3331525405248006, "policy_loss": -0.005990482315974077, "vf_loss": 3.335299070055286, "vf_explained_var": 3.8335410257180534e-05, "kl": 0.01921978158255418, "entropy": 1.6037340244899194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0462661823102584, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.754797784487407, "policy_loss": 0.0058451156243487885, "vf_loss": 9.742199178536733, "vf_explained_var": 0.00034168995916843413, "kl": 0.033767470680565265, "entropy": 1.5996920411785445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -604.0, "episode_reward_mean": 92.33333333333333, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -1274.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 670.0}, "policy_reward_mean": {"prey_policy": 2.611111111111111, "predator_policy": 89.72222222222223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 32.0, 116.0, 200.0, 176.0, -604.0, 158.0, 182.0, 200.0, 188.0, -64.0, 200.0, 170.0, 194.0, 62.0, 200.0, 200.0, -64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -108.0, 46.0, 200.0, 156.0, -1274.0, 123.0, 167.0, 200.0, 178.0, -284.0, 200.0, 145.0, 189.0, -53.0, 200.0, 200.0, -284.0], "policy_predator_policy_reward": [70.0, 140.0, 70.0, 0.0, 20.0, 670.0, 35.0, 15.0, 0.0, 10.0, 220.0, 0.0, 25.0, 5.0, 115.0, 0.0, 0.0, 220.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4423950945158506, "mean_inference_ms": 1.7343716518809384, "mean_action_processing_ms": 0.18949445639692758, "mean_env_wait_ms": 0.13955797978553436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005861785676744249, "StateBufferConnector_ms": 0.0023994180891248914, "ViewRequirementAgentConnector_ms": 0.08809367815653484}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -604.0, "episode_return_mean": 92.33333333333333, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.4987094491783, "num_env_steps_trained_throughput_per_sec": 169.4987094491783, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 23599.009, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23598.952, "sample_time_ms": 1236.996, "learn_time_ms": 22347.959, "learn_throughput": 178.987, "synch_weights_time_ms": 12.525}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 1, "trial_id": "25fa0_00000", "date": "2024-08-12_13-28-01", "timestamp": 1723483681, "time_this_iter_s": 23.646274089813232, "time_total_s": 23.646274089813232, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2261f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.646274089813232, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.73235294117647, "ram_util_percent": 83.13823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5957398000173271, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6381430034836133, "policy_loss": -0.007980335373334431, "vf_loss": 3.645173020288348, "vf_explained_var": -0.0002147128184636434, "kl": 0.004751653482720345, "entropy": 1.6052077042559783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5741829165878396, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.706618457039196, "policy_loss": -0.005422820187231991, "vf_loss": 9.711442501346271, "vf_explained_var": 0.0005422758559385936, "kl": 0.001995852148521308, "entropy": 1.5944232458869616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -604.0, "episode_reward_mean": 66.33333333333333, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -1274.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 670.0}, "policy_reward_mean": {"prey_policy": -45.05555555555556, "predator_policy": 111.38888888888889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 32.0, 116.0, 200.0, 176.0, -604.0, 158.0, 182.0, 200.0, 188.0, -64.0, 200.0, 170.0, 194.0, 62.0, 200.0, 200.0, -64.0, 200.0, 200.0, 2.0, 176.0, 92.0, 200.0, 188.0, 128.0, -274.0, 200.0, -196.0, -70.0, -238.0, -124.0, 146.0, -70.0, 200.0, -34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -108.0, 46.0, 200.0, 156.0, -1274.0, 123.0, 167.0, 200.0, 178.0, -284.0, 200.0, 145.0, 189.0, -53.0, 200.0, 200.0, -284.0, 200.0, 200.0, -163.0, 156.0, 2.0, 200.0, 178.0, 68.0, -669.0, 200.0, -526.0, -295.0, -603.0, -394.0, 101.0, -295.0, 200.0, -229.0], "policy_predator_policy_reward": [70.0, 140.0, 70.0, 0.0, 20.0, 670.0, 35.0, 15.0, 0.0, 10.0, 220.0, 0.0, 25.0, 5.0, 115.0, 0.0, 0.0, 220.0, 0.0, 0.0, 165.0, 20.0, 90.0, 0.0, 10.0, 60.0, 395.0, 0.0, 330.0, 225.0, 365.0, 270.0, 45.0, 225.0, 0.0, 195.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4275083554064123, "mean_inference_ms": 1.630784261472314, "mean_action_processing_ms": 0.17696684464767282, "mean_env_wait_ms": 0.13212345361104266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005885296397738987, "StateBufferConnector_ms": 0.002288818359375, "ViewRequirementAgentConnector_ms": 0.07289846738179524}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -604.0, "episode_return_mean": 66.33333333333333, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.76152137539756, "num_env_steps_trained_throughput_per_sec": 172.76152137539756, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 23376.204, "restore_workers_time_ms": 0.081, "training_step_time_ms": 23376.003, "sample_time_ms": 1104.404, "learn_time_ms": 22254.461, "learn_throughput": 179.739, "synch_weights_time_ms": 15.79}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 2, "trial_id": "25fa0_00000", "date": "2024-08-12_13-28-27", "timestamp": 1723483707, "time_this_iter_s": 23.16427493095398, "time_total_s": 46.81054902076721, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dcd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.81054902076721, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.727027027027024, "ram_util_percent": 83.13243243243245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.775538057119896, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.005598077178002, "policy_loss": -0.01097265935629063, "vf_loss": 4.015663398305575, "vf_explained_var": -0.00011488795280456543, "kl": 0.009073310778463755, "entropy": 1.5984323875357707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8873395201129217, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.706523980696996, "policy_loss": -0.007995634545416882, "vf_loss": 9.71275610824426, "vf_explained_var": 0.0012565741315484047, "kl": 0.011756643952305594, "entropy": 1.572102939710021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -604.0, "episode_reward_mean": 53.111111111111114, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -1274.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 670.0}, "policy_reward_mean": {"prey_policy": -69.29629629629629, "predator_policy": 122.4074074074074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 32.0, 116.0, 200.0, 176.0, -604.0, 158.0, 182.0, 200.0, 188.0, -64.0, 200.0, 170.0, 194.0, 62.0, 200.0, 200.0, -64.0, 200.0, 200.0, 2.0, 176.0, 92.0, 200.0, 188.0, 128.0, -274.0, 200.0, -196.0, -70.0, -238.0, -124.0, 146.0, -70.0, 200.0, -34.0, 146.0, 182.0, -202.0, -124.0, 200.0, -388.0, 200.0, 176.0, -370.0, 200.0, 176.0, 62.0, -322.0, -226.0, 200.0, 200.0, 200.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -108.0, 46.0, 200.0, 156.0, -1274.0, 123.0, 167.0, 200.0, 178.0, -284.0, 200.0, 145.0, 189.0, -53.0, 200.0, 200.0, -284.0, 200.0, 200.0, -163.0, 156.0, 2.0, 200.0, 178.0, 68.0, -669.0, 200.0, -526.0, -295.0, -603.0, -394.0, 101.0, -295.0, 200.0, -229.0, 101.0, 167.0, -537.0, -394.0, 200.0, -878.0, 200.0, 156.0, -845.0, 200.0, 156.0, -53.0, -757.0, -581.0, 200.0, 200.0, 200.0, 145.0], "policy_predator_policy_reward": [70.0, 140.0, 70.0, 0.0, 20.0, 670.0, 35.0, 15.0, 0.0, 10.0, 220.0, 0.0, 25.0, 5.0, 115.0, 0.0, 0.0, 220.0, 0.0, 0.0, 165.0, 20.0, 90.0, 0.0, 10.0, 60.0, 395.0, 0.0, 330.0, 225.0, 365.0, 270.0, 45.0, 225.0, 0.0, 195.0, 45.0, 15.0, 335.0, 270.0, 0.0, 490.0, 0.0, 20.0, 475.0, 0.0, 20.0, 115.0, 435.0, 355.0, 0.0, 0.0, 0.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4099889077468017, "mean_inference_ms": 1.552290160388591, "mean_action_processing_ms": 0.1685608078823714, "mean_env_wait_ms": 0.12676221445109145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005561113357543945, "StateBufferConnector_ms": 0.0022089039837872543, "ViewRequirementAgentConnector_ms": 0.06574922137790257}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -604.0, "episode_return_mean": 53.111111111111114, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.4688677686564, "num_env_steps_trained_throughput_per_sec": 156.4688677686564, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 24105.551, "restore_workers_time_ms": 0.064, "training_step_time_ms": 24105.267, "sample_time_ms": 1007.481, "learn_time_ms": 23076.12, "learn_throughput": 173.339, "synch_weights_time_ms": 19.366}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 3, "trial_id": "25fa0_00000", "date": "2024-08-12_13-28-52", "timestamp": 1723483732, "time_this_iter_s": 25.613183975219727, "time_total_s": 72.42373299598694, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2360dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.42373299598694, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.648648648648646, "ram_util_percent": 82.99459459459462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8117262096144259, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9364562859137853, "policy_loss": -0.01669712662114762, "vf_loss": 3.9511416683594387, "vf_explained_var": -0.0004210577035943667, "kl": 0.020117415698037176, "entropy": 1.5793810536464055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3778898815624414, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.6833580772082, "policy_loss": -0.006527486599225085, "vf_loss": 9.68897177875042, "vf_explained_var": 0.0016711137567957243, "kl": 0.0060916904569323195, "entropy": 1.5865511380136013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -616.0, "episode_reward_mean": 37.166666666666664, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -1296.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 680.0}, "policy_reward_mean": {"prey_policy": -98.52777777777777, "predator_policy": 135.69444444444446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 32.0, 116.0, 200.0, 176.0, -604.0, 158.0, 182.0, 200.0, 188.0, -64.0, 200.0, 170.0, 194.0, 62.0, 200.0, 200.0, -64.0, 200.0, 200.0, 2.0, 176.0, 92.0, 200.0, 188.0, 128.0, -274.0, 200.0, -196.0, -70.0, -238.0, -124.0, 146.0, -70.0, 200.0, -34.0, 146.0, 182.0, -202.0, -124.0, 200.0, -388.0, 200.0, 176.0, -370.0, 200.0, 176.0, 62.0, -322.0, -226.0, 200.0, 200.0, 200.0, 170.0, -178.0, 146.0, 200.0, 194.0, -178.0, 110.0, 200.0, 86.0, -490.0, -616.0, -52.0, -22.0, 200.0, -148.0, -106.0, 194.0, 68.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -108.0, 46.0, 200.0, 156.0, -1274.0, 123.0, 167.0, 200.0, 178.0, -284.0, 200.0, 145.0, 189.0, -53.0, 200.0, 200.0, -284.0, 200.0, 200.0, -163.0, 156.0, 2.0, 200.0, 178.0, 68.0, -669.0, 200.0, -526.0, -295.0, -603.0, -394.0, 101.0, -295.0, 200.0, -229.0, 101.0, 167.0, -537.0, -394.0, 200.0, -878.0, 200.0, 156.0, -845.0, 200.0, 156.0, -53.0, -757.0, -581.0, 200.0, 200.0, 200.0, 145.0, -493.0, 101.0, 200.0, 189.0, -493.0, 35.0, 200.0, -9.0, -1065.0, -1296.0, -262.0, -207.0, 200.0, -438.0, -361.0, 189.0, -42.0, 200.0], "policy_predator_policy_reward": [70.0, 140.0, 70.0, 0.0, 20.0, 670.0, 35.0, 15.0, 0.0, 10.0, 220.0, 0.0, 25.0, 5.0, 115.0, 0.0, 0.0, 220.0, 0.0, 0.0, 165.0, 20.0, 90.0, 0.0, 10.0, 60.0, 395.0, 0.0, 330.0, 225.0, 365.0, 270.0, 45.0, 225.0, 0.0, 195.0, 45.0, 15.0, 335.0, 270.0, 0.0, 490.0, 0.0, 20.0, 475.0, 0.0, 20.0, 115.0, 435.0, 355.0, 0.0, 0.0, 0.0, 25.0, 315.0, 45.0, 0.0, 5.0, 315.0, 75.0, 0.0, 95.0, 575.0, 680.0, 210.0, 185.0, 0.0, 290.0, 255.0, 5.0, 110.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.404087079583308, "mean_inference_ms": 1.5277725217633804, "mean_action_processing_ms": 0.16538534022629847, "mean_env_wait_ms": 0.12653662000247307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006105005741119385, "StateBufferConnector_ms": 0.0022336840629577637, "ViewRequirementAgentConnector_ms": 0.06633914179272121}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -616.0, "episode_return_mean": 37.166666666666664, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.21841972231206, "num_env_steps_trained_throughput_per_sec": 154.21841972231206, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 24563.485, "restore_workers_time_ms": 0.062, "training_step_time_ms": 24563.237, "sample_time_ms": 1054.44, "learn_time_ms": 23488.605, "learn_throughput": 170.295, "synch_weights_time_ms": 17.482}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 4, "trial_id": "25fa0_00000", "date": "2024-08-12_13-29-18", "timestamp": 1723483758, "time_this_iter_s": 25.989872217178345, "time_total_s": 98.41360521316528, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.41360521316528, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.85675675675676, "ram_util_percent": 82.82702702702703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8433125472627581, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.881207842131456, "policy_loss": -0.00900308619069013, "vf_loss": 5.888915348052978, "vf_explained_var": -0.00013442356139421464, "kl": 0.00863732746060073, "entropy": 1.5533521234989167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8452337741230926, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.629162876804669, "policy_loss": -0.01737694876889388, "vf_loss": 9.643204110860825, "vf_explained_var": 0.0022994654253125192, "kl": 0.022238044062621577, "entropy": 1.5514567079643409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -928.0, "episode_reward_mean": 11.93939393939394, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -144.77777777777777, "predator_policy": 156.7171717171717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, 32.0, 116.0, 200.0, 176.0, -604.0, 158.0, 182.0, 200.0, 188.0, -64.0, 200.0, 170.0, 194.0, 62.0, 200.0, 200.0, -64.0, 200.0, 200.0, 2.0, 176.0, 92.0, 200.0, 188.0, 128.0, -274.0, 200.0, -196.0, -70.0, -238.0, -124.0, 146.0, -70.0, 200.0, -34.0, 146.0, 182.0, -202.0, -124.0, 200.0, -388.0, 200.0, 176.0, -370.0, 200.0, 176.0, 62.0, -322.0, -226.0, 200.0, 200.0, 200.0, 170.0, -178.0, 146.0, 200.0, 194.0, -178.0, 110.0, 200.0, 86.0, -490.0, -616.0, -52.0, -22.0, 200.0, -148.0, -106.0, 194.0, 68.0, 200.0, 200.0, -172.0, 140.0, -46.0, -298.0, 164.0, -148.0, 200.0, 200.0, 200.0, -280.0, 200.0, 200.0, -928.0, -448.0, -670.0, -46.0, 194.0, 200.0, 200.0, -424.0, 200.0, 122.0, -328.0, 200.0, -142.0, -184.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -108.0, 46.0, 200.0, 156.0, -1274.0, 123.0, 167.0, 200.0, 178.0, -284.0, 200.0, 145.0, 189.0, -53.0, 200.0, 200.0, -284.0, 200.0, 200.0, -163.0, 156.0, 2.0, 200.0, 178.0, 68.0, -669.0, 200.0, -526.0, -295.0, -603.0, -394.0, 101.0, -295.0, 200.0, -229.0, 101.0, 167.0, -537.0, -394.0, 200.0, -878.0, 200.0, 156.0, -845.0, 200.0, 156.0, -53.0, -757.0, -581.0, 200.0, 200.0, 200.0, 145.0, -493.0, 101.0, 200.0, 189.0, -493.0, 35.0, 200.0, -9.0, -1065.0, -1296.0, -262.0, -207.0, 200.0, -438.0, -361.0, 189.0, -42.0, 200.0, 200.0, -482.0, 90.0, -251.0, -713.0, 134.0, -438.0, 200.0, 200.0, 200.0, -680.0, 200.0, 200.0, -1868.0, -988.0, -1395.0, -251.0, 189.0, 200.0, 200.0, -944.0, 200.0, 57.0, -768.0, 200.0, -427.0, -504.0], "policy_predator_policy_reward": [70.0, 140.0, 70.0, 0.0, 20.0, 670.0, 35.0, 15.0, 0.0, 10.0, 220.0, 0.0, 25.0, 5.0, 115.0, 0.0, 0.0, 220.0, 0.0, 0.0, 165.0, 20.0, 90.0, 0.0, 10.0, 60.0, 395.0, 0.0, 330.0, 225.0, 365.0, 270.0, 45.0, 225.0, 0.0, 195.0, 45.0, 15.0, 335.0, 270.0, 0.0, 490.0, 0.0, 20.0, 475.0, 0.0, 20.0, 115.0, 435.0, 355.0, 0.0, 0.0, 0.0, 25.0, 315.0, 45.0, 0.0, 5.0, 315.0, 75.0, 0.0, 95.0, 575.0, 680.0, 210.0, 185.0, 0.0, 290.0, 255.0, 5.0, 110.0, 0.0, 0.0, 310.0, 50.0, 205.0, 415.0, 30.0, 290.0, 0.0, 0.0, 0.0, 400.0, 0.0, 0.0, 940.0, 540.0, 725.0, 205.0, 5.0, 0.0, 0.0, 520.0, 0.0, 65.0, 440.0, 0.0, 285.0, 320.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40526138935727385, "mean_inference_ms": 1.5371903875758264, "mean_action_processing_ms": 0.16509932759734453, "mean_env_wait_ms": 0.1278945075259185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007186995612250434, "StateBufferConnector_ms": 0.0023042312776199495, "ViewRequirementAgentConnector_ms": 0.06635201097738863}, "num_episodes": 27, "episode_return_max": 200.0, "episode_return_min": -928.0, "episode_return_mean": 11.93939393939394, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.92971991001383, "num_env_steps_trained_throughput_per_sec": 159.92971991001383, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 24652.987, "restore_workers_time_ms": 0.052, "training_step_time_ms": 24652.736, "sample_time_ms": 1128.036, "learn_time_ms": 23503.056, "learn_throughput": 170.191, "synch_weights_time_ms": 19.102}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 5, "trial_id": "25fa0_00000", "date": "2024-08-12_13-29-43", "timestamp": 1723483783, "time_this_iter_s": 25.061731100082397, "time_total_s": 123.47533631324768, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 123.47533631324768, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.191428571428574, "ram_util_percent": 83.22571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.896740541420877, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.676527966807286, "policy_loss": -0.00990899111299465, "vf_loss": 3.6852023601531982, "vf_explained_var": -4.216531912485758e-05, "kl": 0.008230694888721097, "entropy": 1.5506322524199883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4041885968918604, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.60047677954038, "policy_loss": -0.013035291082633193, "vf_loss": 9.610773900151253, "vf_explained_var": 0.004014740139245987, "kl": 0.012169601661240962, "entropy": 1.5303969442844392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -928.0, "episode_reward_mean": -14.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -193.91, "predator_policy": 179.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.0, 200.0, 200.0, 2.0, 176.0, 92.0, 200.0, 188.0, 128.0, -274.0, 200.0, -196.0, -70.0, -238.0, -124.0, 146.0, -70.0, 200.0, -34.0, 146.0, 182.0, -202.0, -124.0, 200.0, -388.0, 200.0, 176.0, -370.0, 200.0, 176.0, 62.0, -322.0, -226.0, 200.0, 200.0, 200.0, 170.0, -178.0, 146.0, 200.0, 194.0, -178.0, 110.0, 200.0, 86.0, -490.0, -616.0, -52.0, -22.0, 200.0, -148.0, -106.0, 194.0, 68.0, 200.0, 200.0, -172.0, 140.0, -46.0, -298.0, 164.0, -148.0, 200.0, 200.0, 200.0, -280.0, 200.0, 200.0, -928.0, -448.0, -670.0, -46.0, 194.0, 200.0, 200.0, -424.0, 200.0, 122.0, -328.0, 200.0, -142.0, -184.0, 170.0, -454.0, 122.0, 158.0, 110.0, 200.0, -178.0, -592.0, -118.0, -28.0, 200.0, -166.0, -448.0, 38.0, 200.0, -322.0, 50.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-284.0, 200.0, 200.0, -163.0, 156.0, 2.0, 200.0, 178.0, 68.0, -669.0, 200.0, -526.0, -295.0, -603.0, -394.0, 101.0, -295.0, 200.0, -229.0, 101.0, 167.0, -537.0, -394.0, 200.0, -878.0, 200.0, 156.0, -845.0, 200.0, 156.0, -53.0, -757.0, -581.0, 200.0, 200.0, 200.0, 145.0, -493.0, 101.0, 200.0, 189.0, -493.0, 35.0, 200.0, -9.0, -1065.0, -1296.0, -262.0, -207.0, 200.0, -438.0, -361.0, 189.0, -42.0, 200.0, 200.0, -482.0, 90.0, -251.0, -713.0, 134.0, -438.0, 200.0, 200.0, 200.0, -680.0, 200.0, 200.0, -1868.0, -988.0, -1395.0, -251.0, 189.0, 200.0, 200.0, -944.0, 200.0, 57.0, -768.0, 200.0, -427.0, -504.0, 145.0, -999.0, 57.0, 123.0, 35.0, 200.0, -493.0, -1252.0, -383.0, -218.0, 200.0, -471.0, -988.0, -97.0, 200.0, -757.0, -75.0, 46.0], "policy_predator_policy_reward": [220.0, 0.0, 0.0, 165.0, 20.0, 90.0, 0.0, 10.0, 60.0, 395.0, 0.0, 330.0, 225.0, 365.0, 270.0, 45.0, 225.0, 0.0, 195.0, 45.0, 15.0, 335.0, 270.0, 0.0, 490.0, 0.0, 20.0, 475.0, 0.0, 20.0, 115.0, 435.0, 355.0, 0.0, 0.0, 0.0, 25.0, 315.0, 45.0, 0.0, 5.0, 315.0, 75.0, 0.0, 95.0, 575.0, 680.0, 210.0, 185.0, 0.0, 290.0, 255.0, 5.0, 110.0, 0.0, 0.0, 310.0, 50.0, 205.0, 415.0, 30.0, 290.0, 0.0, 0.0, 0.0, 400.0, 0.0, 0.0, 940.0, 540.0, 725.0, 205.0, 5.0, 0.0, 0.0, 520.0, 0.0, 65.0, 440.0, 0.0, 285.0, 320.0, 25.0, 545.0, 65.0, 35.0, 75.0, 0.0, 315.0, 660.0, 265.0, 190.0, 0.0, 305.0, 540.0, 135.0, 0.0, 435.0, 125.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3970349685095679, "mean_inference_ms": 1.4965093818309425, "mean_action_processing_ms": 0.15951026544500105, "mean_env_wait_ms": 0.12570412242528525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065860748291015625, "StateBufferConnector_ms": 0.0023926496505737305, "ViewRequirementAgentConnector_ms": 0.06068682670593262}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -928.0, "episode_return_mean": -14.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.44681473126613, "num_env_steps_trained_throughput_per_sec": 169.44681473126613, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 24478.54, "restore_workers_time_ms": 0.054, "training_step_time_ms": 24478.299, "sample_time_ms": 1089.835, "learn_time_ms": 23367.421, "learn_throughput": 171.178, "synch_weights_time_ms": 18.236}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 6, "trial_id": "25fa0_00000", "date": "2024-08-12_13-30-07", "timestamp": 1723483807, "time_this_iter_s": 23.645612001419067, "time_total_s": 147.12094831466675, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dcee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.12094831466675, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 24.808823529411764, "ram_util_percent": 82.87941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8919395256011436, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6604753321502358, "policy_loss": -0.008604332612109526, "vf_loss": 0.6680426483354078, "vf_explained_var": -0.0011794112622737884, "kl": 0.00691344302957186, "entropy": 1.5466926441838345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.310045465019842, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.563044201334318, "policy_loss": -0.009424586593134639, "vf_loss": 9.571238340934118, "vf_explained_var": 0.007940782979130746, "kl": 0.005468699647073646, "entropy": 1.5218403965234757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -928.0, "episode_reward_mean": 5.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -156.62, "predator_policy": 162.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-34.0, 146.0, 182.0, -202.0, -124.0, 200.0, -388.0, 200.0, 176.0, -370.0, 200.0, 176.0, 62.0, -322.0, -226.0, 200.0, 200.0, 200.0, 170.0, -178.0, 146.0, 200.0, 194.0, -178.0, 110.0, 200.0, 86.0, -490.0, -616.0, -52.0, -22.0, 200.0, -148.0, -106.0, 194.0, 68.0, 200.0, 200.0, -172.0, 140.0, -46.0, -298.0, 164.0, -148.0, 200.0, 200.0, 200.0, -280.0, 200.0, 200.0, -928.0, -448.0, -670.0, -46.0, 194.0, 200.0, 200.0, -424.0, 200.0, 122.0, -328.0, 200.0, -142.0, -184.0, 170.0, -454.0, 122.0, 158.0, 110.0, 200.0, -178.0, -592.0, -118.0, -28.0, 200.0, -166.0, -448.0, 38.0, 200.0, -322.0, 50.0, 116.0, -136.0, 188.0, 200.0, 200.0, -10.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, -10.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-229.0, 101.0, 167.0, -537.0, -394.0, 200.0, -878.0, 200.0, 156.0, -845.0, 200.0, 156.0, -53.0, -757.0, -581.0, 200.0, 200.0, 200.0, 145.0, -493.0, 101.0, 200.0, 189.0, -493.0, 35.0, 200.0, -9.0, -1065.0, -1296.0, -262.0, -207.0, 200.0, -438.0, -361.0, 189.0, -42.0, 200.0, 200.0, -482.0, 90.0, -251.0, -713.0, 134.0, -438.0, 200.0, 200.0, 200.0, -680.0, 200.0, 200.0, -1868.0, -988.0, -1395.0, -251.0, 189.0, 200.0, 200.0, -944.0, 200.0, 57.0, -768.0, 200.0, -427.0, -504.0, 145.0, -999.0, 57.0, 123.0, 35.0, 200.0, -493.0, -1252.0, -383.0, -218.0, 200.0, -471.0, -988.0, -97.0, 200.0, -757.0, -75.0, 46.0, -416.0, 178.0, 200.0, 200.0, -185.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, -185.0, 200.0, 200.0], "policy_predator_policy_reward": [195.0, 45.0, 15.0, 335.0, 270.0, 0.0, 490.0, 0.0, 20.0, 475.0, 0.0, 20.0, 115.0, 435.0, 355.0, 0.0, 0.0, 0.0, 25.0, 315.0, 45.0, 0.0, 5.0, 315.0, 75.0, 0.0, 95.0, 575.0, 680.0, 210.0, 185.0, 0.0, 290.0, 255.0, 5.0, 110.0, 0.0, 0.0, 310.0, 50.0, 205.0, 415.0, 30.0, 290.0, 0.0, 0.0, 0.0, 400.0, 0.0, 0.0, 940.0, 540.0, 725.0, 205.0, 5.0, 0.0, 0.0, 520.0, 0.0, 65.0, 440.0, 0.0, 285.0, 320.0, 25.0, 545.0, 65.0, 35.0, 75.0, 0.0, 315.0, 660.0, 265.0, 190.0, 0.0, 305.0, 540.0, 135.0, 0.0, 435.0, 125.0, 70.0, 280.0, 10.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3915897110205904, "mean_inference_ms": 1.484805072482108, "mean_action_processing_ms": 0.15752022033249297, "mean_env_wait_ms": 0.12532061641855965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005950212478637695, "StateBufferConnector_ms": 0.0023990869522094727, "ViewRequirementAgentConnector_ms": 0.05847775936126709}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -928.0, "episode_return_mean": 5.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.58596352736646, "num_env_steps_trained_throughput_per_sec": 170.58596352736646, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 24331.405, "restore_workers_time_ms": 0.049, "training_step_time_ms": 24331.157, "sample_time_ms": 1060.254, "learn_time_ms": 23246.204, "learn_throughput": 172.071, "synch_weights_time_ms": 21.714}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 7, "trial_id": "25fa0_00000", "date": "2024-08-12_13-30-31", "timestamp": 1723483831, "time_this_iter_s": 23.48240900039673, "time_total_s": 170.60335731506348, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 170.60335731506348, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 28.890909090909094, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0229065038419018, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0993047861382366, "policy_loss": -0.011231770896605061, "vf_loss": 1.1091749289429136, "vf_explained_var": -0.001963643729686737, "kl": 0.009077520598225943, "entropy": 1.550752811258038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.313731326969961, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.49905104637146, "policy_loss": -0.008214427886074797, "vf_loss": 9.505789864063264, "vf_explained_var": 0.005899971909821033, "kl": 0.006558328804723601, "entropy": 1.5151553475608428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -928.0, "episode_reward_mean": 25.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -120.76, "predator_policy": 145.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, -178.0, 146.0, 200.0, 194.0, -178.0, 110.0, 200.0, 86.0, -490.0, -616.0, -52.0, -22.0, 200.0, -148.0, -106.0, 194.0, 68.0, 200.0, 200.0, -172.0, 140.0, -46.0, -298.0, 164.0, -148.0, 200.0, 200.0, 200.0, -280.0, 200.0, 200.0, -928.0, -448.0, -670.0, -46.0, 194.0, 200.0, 200.0, -424.0, 200.0, 122.0, -328.0, 200.0, -142.0, -184.0, 170.0, -454.0, 122.0, 158.0, 110.0, 200.0, -178.0, -592.0, -118.0, -28.0, 200.0, -166.0, -448.0, 38.0, 200.0, -322.0, 50.0, 116.0, -136.0, 188.0, 200.0, 200.0, -10.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, -10.0, 200.0, 200.0, 140.0, 26.0, 8.0, 200.0, 200.0, 200.0, 170.0, -28.0, 14.0, 200.0, 200.0, 74.0, 176.0, 86.0, 134.0, 32.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, -493.0, 101.0, 200.0, 189.0, -493.0, 35.0, 200.0, -9.0, -1065.0, -1296.0, -262.0, -207.0, 200.0, -438.0, -361.0, 189.0, -42.0, 200.0, 200.0, -482.0, 90.0, -251.0, -713.0, 134.0, -438.0, 200.0, 200.0, 200.0, -680.0, 200.0, 200.0, -1868.0, -988.0, -1395.0, -251.0, 189.0, 200.0, 200.0, -944.0, 200.0, 57.0, -768.0, 200.0, -427.0, -504.0, 145.0, -999.0, 57.0, 123.0, 35.0, 200.0, -493.0, -1252.0, -383.0, -218.0, 200.0, -471.0, -988.0, -97.0, 200.0, -757.0, -75.0, 46.0, -416.0, 178.0, 200.0, 200.0, -185.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, -185.0, 200.0, 200.0, 90.0, -119.0, -152.0, 200.0, 200.0, 200.0, 145.0, -218.0, -141.0, 200.0, 200.0, -31.0, 156.0, -9.0, 79.0, -108.0, 200.0, 200.0], "policy_predator_policy_reward": [25.0, 315.0, 45.0, 0.0, 5.0, 315.0, 75.0, 0.0, 95.0, 575.0, 680.0, 210.0, 185.0, 0.0, 290.0, 255.0, 5.0, 110.0, 0.0, 0.0, 310.0, 50.0, 205.0, 415.0, 30.0, 290.0, 0.0, 0.0, 0.0, 400.0, 0.0, 0.0, 940.0, 540.0, 725.0, 205.0, 5.0, 0.0, 0.0, 520.0, 0.0, 65.0, 440.0, 0.0, 285.0, 320.0, 25.0, 545.0, 65.0, 35.0, 75.0, 0.0, 315.0, 660.0, 265.0, 190.0, 0.0, 305.0, 540.0, 135.0, 0.0, 435.0, 125.0, 70.0, 280.0, 10.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 50.0, 145.0, 160.0, 0.0, 0.0, 0.0, 25.0, 190.0, 155.0, 0.0, 0.0, 105.0, 20.0, 95.0, 55.0, 140.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39271406481373833, "mean_inference_ms": 1.5027537314642523, "mean_action_processing_ms": 0.15831088914364239, "mean_env_wait_ms": 0.12705346036147083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069571733474731445, "StateBufferConnector_ms": 0.002429366111755371, "ViewRequirementAgentConnector_ms": 0.06107437610626221}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -928.0, "episode_return_mean": 25.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.02244445733055, "num_env_steps_trained_throughput_per_sec": 170.02244445733055, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 24230.77, "restore_workers_time_ms": 0.046, "training_step_time_ms": 24230.544, "sample_time_ms": 1072.635, "learn_time_ms": 23134.729, "learn_throughput": 172.9, "synch_weights_time_ms": 20.403}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 8, "trial_id": "25fa0_00000", "date": "2024-08-12_13-30-54", "timestamp": 1723483854, "time_this_iter_s": 23.575320959091187, "time_total_s": 194.17867827415466, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4825c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.17867827415466, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.88235294117647, "ram_util_percent": 82.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.004265842307359, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9850289041486879, "policy_loss": -0.008906041466980241, "vf_loss": 0.9919522110993664, "vf_explained_var": -6.208096941312154e-05, "kl": 0.013218212312112124, "entropy": 1.5220245917638142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.612885343655944, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.333795514702796, "policy_loss": -0.010195184746165372, "vf_loss": 9.342017542322477, "vf_explained_var": 0.011226859875023365, "kl": 0.008769445196748025, "entropy": 1.5073105866710346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -928.0, "episode_reward_mean": 54.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -66.86, "predator_policy": 121.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-46.0, -298.0, 164.0, -148.0, 200.0, 200.0, 200.0, -280.0, 200.0, 200.0, -928.0, -448.0, -670.0, -46.0, 194.0, 200.0, 200.0, -424.0, 200.0, 122.0, -328.0, 200.0, -142.0, -184.0, 170.0, -454.0, 122.0, 158.0, 110.0, 200.0, -178.0, -592.0, -118.0, -28.0, 200.0, -166.0, -448.0, 38.0, 200.0, -322.0, 50.0, 116.0, -136.0, 188.0, 200.0, 200.0, -10.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, -10.0, 200.0, 200.0, 140.0, 26.0, 8.0, 200.0, 200.0, 200.0, 170.0, -28.0, 14.0, 200.0, 200.0, 74.0, 176.0, 86.0, 134.0, 32.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 80.0, 200.0, 62.0, 200.0, -22.0, 200.0, 200.0, 140.0, 80.0, 200.0, 98.0, 26.0, 200.0, 176.0, 200.0, 194.0, 44.0, 140.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-251.0, -713.0, 134.0, -438.0, 200.0, 200.0, 200.0, -680.0, 200.0, 200.0, -1868.0, -988.0, -1395.0, -251.0, 189.0, 200.0, 200.0, -944.0, 200.0, 57.0, -768.0, 200.0, -427.0, -504.0, 145.0, -999.0, 57.0, 123.0, 35.0, 200.0, -493.0, -1252.0, -383.0, -218.0, 200.0, -471.0, -988.0, -97.0, 200.0, -757.0, -75.0, 46.0, -416.0, 178.0, 200.0, 200.0, -185.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, -185.0, 200.0, 200.0, 90.0, -119.0, -152.0, 200.0, 200.0, 200.0, 145.0, -218.0, -141.0, 200.0, 200.0, -31.0, 156.0, -9.0, 79.0, -108.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, -20.0, 200.0, -53.0, 200.0, -207.0, 200.0, 200.0, 90.0, -20.0, 200.0, 13.0, -119.0, 200.0, 156.0, 200.0, 189.0, -86.0, 90.0], "policy_predator_policy_reward": [205.0, 415.0, 30.0, 290.0, 0.0, 0.0, 0.0, 400.0, 0.0, 0.0, 940.0, 540.0, 725.0, 205.0, 5.0, 0.0, 0.0, 520.0, 0.0, 65.0, 440.0, 0.0, 285.0, 320.0, 25.0, 545.0, 65.0, 35.0, 75.0, 0.0, 315.0, 660.0, 265.0, 190.0, 0.0, 305.0, 540.0, 135.0, 0.0, 435.0, 125.0, 70.0, 280.0, 10.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 50.0, 145.0, 160.0, 0.0, 0.0, 0.0, 25.0, 190.0, 155.0, 0.0, 0.0, 105.0, 20.0, 95.0, 55.0, 140.0, 0.0, 0.0, 0.0, 110.0, 0.0, 0.0, 100.0, 0.0, 115.0, 0.0, 185.0, 0.0, 0.0, 50.0, 100.0, 0.0, 85.0, 145.0, 0.0, 20.0, 0.0, 5.0, 130.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3910144407694361, "mean_inference_ms": 1.5066766667848857, "mean_action_processing_ms": 0.15793249258096834, "mean_env_wait_ms": 0.12672844248061177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058743953704833984, "StateBufferConnector_ms": 0.002361297607421875, "ViewRequirementAgentConnector_ms": 0.057242393493652344}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -928.0, "episode_return_mean": 54.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.9699622559647, "num_env_steps_trained_throughput_per_sec": 171.9699622559647, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 24122.902, "restore_workers_time_ms": 0.042, "training_step_time_ms": 24122.651, "sample_time_ms": 1042.793, "learn_time_ms": 23056.581, "learn_throughput": 173.486, "synch_weights_time_ms": 20.548}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 9, "trial_id": "25fa0_00000", "date": "2024-08-12_13-31-18", "timestamp": 1723483878, "time_this_iter_s": 23.29528498649597, "time_total_s": 217.47396326065063, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 217.47396326065063, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.92727272727273, "ram_util_percent": 82.39696969696969}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9837765003864963, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.585696127762397, "policy_loss": -0.010941819135041442, "vf_loss": 1.5947466986253858, "vf_explained_var": 6.706503530343374e-05, "kl": 0.012608303286227357, "entropy": 1.5216444128503401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.584201123627524, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.270108764370283, "policy_loss": -0.004757305988459848, "vf_loss": 9.273380598425865, "vf_explained_var": 0.010859924616913002, "kl": 0.0066020636157190895, "entropy": 1.491383133456111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -592.0, "episode_reward_mean": 105.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1252.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 660.0}, "policy_reward_mean": {"prey_policy": 26.31, "predator_policy": 78.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-184.0, 170.0, -454.0, 122.0, 158.0, 110.0, 200.0, -178.0, -592.0, -118.0, -28.0, 200.0, -166.0, -448.0, 38.0, 200.0, -322.0, 50.0, 116.0, -136.0, 188.0, 200.0, 200.0, -10.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, -10.0, 200.0, 200.0, 140.0, 26.0, 8.0, 200.0, 200.0, 200.0, 170.0, -28.0, 14.0, 200.0, 200.0, 74.0, 176.0, 86.0, 134.0, 32.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 80.0, 200.0, 62.0, 200.0, -22.0, 200.0, 200.0, 140.0, 80.0, 200.0, 98.0, 26.0, 200.0, 176.0, 200.0, 194.0, 44.0, 140.0, 158.0, 200.0, 200.0, 116.0, 200.0, -58.0, 200.0, 200.0, 200.0, 140.0, -10.0, 200.0, 128.0, 92.0, 194.0, 200.0, 200.0, 200.0, 158.0, 194.0, 200.0, 128.0, 164.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-504.0, 145.0, -999.0, 57.0, 123.0, 35.0, 200.0, -493.0, -1252.0, -383.0, -218.0, 200.0, -471.0, -988.0, -97.0, 200.0, -757.0, -75.0, 46.0, -416.0, 178.0, 200.0, 200.0, -185.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, -185.0, 200.0, 200.0, 90.0, -119.0, -152.0, 200.0, 200.0, 200.0, 145.0, -218.0, -141.0, 200.0, 200.0, -31.0, 156.0, -9.0, 79.0, -108.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, -20.0, 200.0, -53.0, 200.0, -207.0, 200.0, 200.0, 90.0, -20.0, 200.0, 13.0, -119.0, 200.0, 156.0, 200.0, 189.0, -86.0, 90.0, 123.0, 200.0, 200.0, 46.0, 200.0, -273.0, 200.0, 200.0, 200.0, 90.0, -185.0, 200.0, 68.0, 2.0, 189.0, 200.0, 200.0, 200.0, 123.0, 189.0, 200.0, 68.0, 134.0], "policy_predator_policy_reward": [320.0, 25.0, 545.0, 65.0, 35.0, 75.0, 0.0, 315.0, 660.0, 265.0, 190.0, 0.0, 305.0, 540.0, 135.0, 0.0, 435.0, 125.0, 70.0, 280.0, 10.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 50.0, 145.0, 160.0, 0.0, 0.0, 0.0, 25.0, 190.0, 155.0, 0.0, 0.0, 105.0, 20.0, 95.0, 55.0, 140.0, 0.0, 0.0, 0.0, 110.0, 0.0, 0.0, 100.0, 0.0, 115.0, 0.0, 185.0, 0.0, 0.0, 50.0, 100.0, 0.0, 85.0, 145.0, 0.0, 20.0, 0.0, 5.0, 130.0, 50.0, 35.0, 0.0, 0.0, 70.0, 0.0, 215.0, 0.0, 0.0, 0.0, 50.0, 175.0, 0.0, 60.0, 90.0, 5.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3819858623219655, "mean_inference_ms": 1.4757288088495535, "mean_action_processing_ms": 0.15448733455374142, "mean_env_wait_ms": 0.12348868031393213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005593776702880859, "StateBufferConnector_ms": 0.002853870391845703, "ViewRequirementAgentConnector_ms": 0.061705827713012695}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -592.0, "episode_return_mean": 105.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.73133352124358, "num_env_steps_trained_throughput_per_sec": 170.73133352124358, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 24053.476, "restore_workers_time_ms": 0.041, "training_step_time_ms": 24053.211, "sample_time_ms": 1037.677, "learn_time_ms": 22991.815, "learn_throughput": 173.975, "synch_weights_time_ms": 20.582}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 10, "trial_id": "25fa0_00000", "date": "2024-08-12_13-31-41", "timestamp": 1723483901, "time_this_iter_s": 23.47937512397766, "time_total_s": 240.9533383846283, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482dca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 240.9533383846283, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 23.58529411764706, "ram_util_percent": 82.62352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9846910544050237, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.12671207798024, "policy_loss": -0.004300117357828034, "vf_loss": 3.1301330580065647, "vf_explained_var": 5.040019750595093e-05, "kl": 0.005860716030057356, "entropy": 1.5187778146316608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.923399415177604, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.118938238422077, "policy_loss": -0.0103233967408111, "vf_loss": 9.126926056543986, "vf_explained_var": 0.01056175772100687, "kl": 0.01038032516861828, "entropy": 1.4824866857379675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -796.0, "episode_reward_mean": 119.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1626.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 830.0}, "policy_reward_mean": {"prey_policy": 52.82, "predator_policy": 66.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.0, -136.0, 188.0, 200.0, 200.0, -10.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, -10.0, 200.0, 200.0, 140.0, 26.0, 8.0, 200.0, 200.0, 200.0, 170.0, -28.0, 14.0, 200.0, 200.0, 74.0, 176.0, 86.0, 134.0, 32.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 80.0, 200.0, 62.0, 200.0, -22.0, 200.0, 200.0, 140.0, 80.0, 200.0, 98.0, 26.0, 200.0, 176.0, 200.0, 194.0, 44.0, 140.0, 158.0, 200.0, 200.0, 116.0, 200.0, -58.0, 200.0, 200.0, 200.0, 140.0, -10.0, 200.0, 128.0, 92.0, 194.0, 200.0, 200.0, 200.0, 158.0, 194.0, 200.0, 128.0, 164.0, -82.0, -538.0, 122.0, 200.0, 170.0, 158.0, 62.0, 200.0, 14.0, -616.0, 200.0, 200.0, -796.0, 200.0, 188.0, 146.0, 176.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -416.0, 178.0, 200.0, 200.0, -185.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, -185.0, 200.0, 200.0, 90.0, -119.0, -152.0, 200.0, 200.0, 200.0, 145.0, -218.0, -141.0, 200.0, 200.0, -31.0, 156.0, -9.0, 79.0, -108.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, -20.0, 200.0, -53.0, 200.0, -207.0, 200.0, 200.0, 90.0, -20.0, 200.0, 13.0, -119.0, 200.0, 156.0, 200.0, 189.0, -86.0, 90.0, 123.0, 200.0, 200.0, 46.0, 200.0, -273.0, 200.0, 200.0, 200.0, 90.0, -185.0, 200.0, 68.0, 2.0, 189.0, 200.0, 200.0, 200.0, 123.0, 189.0, 200.0, 68.0, 134.0, -317.0, -1153.0, 57.0, 200.0, 145.0, 123.0, -53.0, 200.0, -141.0, -1296.0, 200.0, 200.0, -1626.0, 200.0, 178.0, 101.0, 156.0, 200.0], "policy_predator_policy_reward": [70.0, 280.0, 10.0, 0.0, 0.0, 175.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 175.0, 0.0, 0.0, 50.0, 145.0, 160.0, 0.0, 0.0, 0.0, 25.0, 190.0, 155.0, 0.0, 0.0, 105.0, 20.0, 95.0, 55.0, 140.0, 0.0, 0.0, 0.0, 110.0, 0.0, 0.0, 100.0, 0.0, 115.0, 0.0, 185.0, 0.0, 0.0, 50.0, 100.0, 0.0, 85.0, 145.0, 0.0, 20.0, 0.0, 5.0, 130.0, 50.0, 35.0, 0.0, 0.0, 70.0, 0.0, 215.0, 0.0, 0.0, 0.0, 50.0, 175.0, 0.0, 60.0, 90.0, 5.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 60.0, 30.0, 235.0, 615.0, 65.0, 0.0, 25.0, 35.0, 115.0, 0.0, 155.0, 680.0, 0.0, 0.0, 830.0, 0.0, 10.0, 45.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768804626258347, "mean_inference_ms": 1.4604762208583315, "mean_action_processing_ms": 0.15293313844274428, "mean_env_wait_ms": 0.12191873813940711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005553483963012695, "StateBufferConnector_ms": 0.0025979280471801758, "ViewRequirementAgentConnector_ms": 0.057788968086242676}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -796.0, "episode_return_mean": 119.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.4287136678576, "num_env_steps_trained_throughput_per_sec": 169.4287136678576, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 24054.453, "restore_workers_time_ms": 0.042, "training_step_time_ms": 24054.186, "sample_time_ms": 996.173, "learn_time_ms": 23033.852, "learn_throughput": 173.657, "synch_weights_time_ms": 20.932}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 11, "trial_id": "25fa0_00000", "date": "2024-08-12_13-32-05", "timestamp": 1723483925, "time_this_iter_s": 23.65355920791626, "time_total_s": 264.60689759254456, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.60689759254456, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.00909090909091, "ram_util_percent": 82.74242424242425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1662146048930784, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7355293051029246, "policy_loss": -0.006473389162662594, "vf_loss": 1.7412487099257608, "vf_explained_var": 0.0013664882630109788, "kl": 0.005026570384349203, "entropy": 1.526339357594649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.811381264900167, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.010430582364401, "policy_loss": -0.015815371741822067, "vf_loss": 7.023775075376034, "vf_explained_var": 0.017388319410383702, "kl": 0.010981666804715007, "entropy": 1.4570156092445055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -796.0, "episode_reward_mean": 106.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1626.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 830.0}, "policy_reward_mean": {"prey_policy": 29.17, "predator_policy": 77.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 140.0, 26.0, 8.0, 200.0, 200.0, 200.0, 170.0, -28.0, 14.0, 200.0, 200.0, 74.0, 176.0, 86.0, 134.0, 32.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 80.0, 200.0, 62.0, 200.0, -22.0, 200.0, 200.0, 140.0, 80.0, 200.0, 98.0, 26.0, 200.0, 176.0, 200.0, 194.0, 44.0, 140.0, 158.0, 200.0, 200.0, 116.0, 200.0, -58.0, 200.0, 200.0, 200.0, 140.0, -10.0, 200.0, 128.0, 92.0, 194.0, 200.0, 200.0, 200.0, 158.0, 194.0, 200.0, 128.0, 164.0, -82.0, -538.0, 122.0, 200.0, 170.0, 158.0, 62.0, 200.0, 14.0, -616.0, 200.0, 200.0, -796.0, 200.0, 188.0, 146.0, 176.0, 200.0, 200.0, -430.0, 200.0, 200.0, -100.0, 152.0, -10.0, 200.0, -190.0, 2.0, 146.0, 146.0, 182.0, 122.0, 200.0, 74.0, 62.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 90.0, -119.0, -152.0, 200.0, 200.0, 200.0, 145.0, -218.0, -141.0, 200.0, 200.0, -31.0, 156.0, -9.0, 79.0, -108.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, -20.0, 200.0, -53.0, 200.0, -207.0, 200.0, 200.0, 90.0, -20.0, 200.0, 13.0, -119.0, 200.0, 156.0, 200.0, 189.0, -86.0, 90.0, 123.0, 200.0, 200.0, 46.0, 200.0, -273.0, 200.0, 200.0, 200.0, 90.0, -185.0, 200.0, 68.0, 2.0, 189.0, 200.0, 200.0, 200.0, 123.0, 189.0, 200.0, 68.0, 134.0, -317.0, -1153.0, 57.0, 200.0, 145.0, 123.0, -53.0, 200.0, -141.0, -1296.0, 200.0, 200.0, -1626.0, 200.0, 178.0, 101.0, 156.0, 200.0, 200.0, -955.0, 200.0, 200.0, -350.0, 112.0, -185.0, 200.0, -515.0, -163.0, 101.0, 101.0, 167.0, 57.0, 200.0, -31.0, -53.0, 200.0], "policy_predator_policy_reward": [0.0, 50.0, 145.0, 160.0, 0.0, 0.0, 0.0, 25.0, 190.0, 155.0, 0.0, 0.0, 105.0, 20.0, 95.0, 55.0, 140.0, 0.0, 0.0, 0.0, 110.0, 0.0, 0.0, 100.0, 0.0, 115.0, 0.0, 185.0, 0.0, 0.0, 50.0, 100.0, 0.0, 85.0, 145.0, 0.0, 20.0, 0.0, 5.0, 130.0, 50.0, 35.0, 0.0, 0.0, 70.0, 0.0, 215.0, 0.0, 0.0, 0.0, 50.0, 175.0, 0.0, 60.0, 90.0, 5.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 60.0, 30.0, 235.0, 615.0, 65.0, 0.0, 25.0, 35.0, 115.0, 0.0, 155.0, 680.0, 0.0, 0.0, 830.0, 0.0, 10.0, 45.0, 20.0, 0.0, 0.0, 525.0, 0.0, 0.0, 250.0, 40.0, 175.0, 0.0, 325.0, 165.0, 45.0, 45.0, 15.0, 65.0, 0.0, 105.0, 115.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37277192890513533, "mean_inference_ms": 1.447397397606184, "mean_action_processing_ms": 0.15161960160720017, "mean_env_wait_ms": 0.12050762219230822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055391788482666016, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.05718588829040527}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -796.0, "episode_return_mean": 106.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.68229289356816, "num_env_steps_trained_throughput_per_sec": 171.68229289356816, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 24068.999, "restore_workers_time_ms": 0.029, "training_step_time_ms": 24068.75, "sample_time_ms": 979.599, "learn_time_ms": 23064.796, "learn_throughput": 173.424, "synch_weights_time_ms": 21.01}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 12, "trial_id": "25fa0_00000", "date": "2024-08-12_13-32-28", "timestamp": 1723483948, "time_this_iter_s": 23.349444150924683, "time_total_s": 287.95634174346924, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 287.95634174346924, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.12121212121212, "ram_util_percent": 83.17878787878789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0088438702592006, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7024108668323606, "policy_loss": -0.006301869511662517, "vf_loss": 0.707605651673839, "vf_explained_var": -0.0012070986752708752, "kl": 0.007380546630016246, "entropy": 1.5345232628285885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.42301161189874, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.567740688472986, "policy_loss": -0.004840603070624639, "vf_loss": 4.571722237020731, "vf_explained_var": 0.016609377724428973, "kl": 0.0038179232391238834, "entropy": 1.4515582309414943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -796.0, "episode_reward_mean": 106.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1626.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 830.0}, "policy_reward_mean": {"prey_policy": 28.73, "predator_policy": 77.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 68.0, 200.0, 200.0, 80.0, 200.0, 62.0, 200.0, -22.0, 200.0, 200.0, 140.0, 80.0, 200.0, 98.0, 26.0, 200.0, 176.0, 200.0, 194.0, 44.0, 140.0, 158.0, 200.0, 200.0, 116.0, 200.0, -58.0, 200.0, 200.0, 200.0, 140.0, -10.0, 200.0, 128.0, 92.0, 194.0, 200.0, 200.0, 200.0, 158.0, 194.0, 200.0, 128.0, 164.0, -82.0, -538.0, 122.0, 200.0, 170.0, 158.0, 62.0, 200.0, 14.0, -616.0, 200.0, 200.0, -796.0, 200.0, 188.0, 146.0, 176.0, 200.0, 200.0, -430.0, 200.0, 200.0, -100.0, 152.0, -10.0, 200.0, -190.0, 2.0, 146.0, 146.0, 182.0, 122.0, 200.0, 74.0, 62.0, 200.0, 62.0, 110.0, 194.0, 200.0, 38.0, 200.0, -130.0, 200.0, 194.0, 200.0, 8.0, -40.0, 200.0, 200.0, 146.0, 200.0, 62.0, 164.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -42.0, 200.0, 200.0, -20.0, 200.0, -53.0, 200.0, -207.0, 200.0, 200.0, 90.0, -20.0, 200.0, 13.0, -119.0, 200.0, 156.0, 200.0, 189.0, -86.0, 90.0, 123.0, 200.0, 200.0, 46.0, 200.0, -273.0, 200.0, 200.0, 200.0, 90.0, -185.0, 200.0, 68.0, 2.0, 189.0, 200.0, 200.0, 200.0, 123.0, 189.0, 200.0, 68.0, 134.0, -317.0, -1153.0, 57.0, 200.0, 145.0, 123.0, -53.0, 200.0, -141.0, -1296.0, 200.0, 200.0, -1626.0, 200.0, 178.0, 101.0, 156.0, 200.0, 200.0, -955.0, 200.0, 200.0, -350.0, 112.0, -185.0, 200.0, -515.0, -163.0, 101.0, 101.0, 167.0, 57.0, 200.0, -31.0, -53.0, 200.0, -53.0, 35.0, 189.0, 200.0, -97.0, 200.0, -405.0, 200.0, 189.0, 200.0, -152.0, -240.0, 200.0, 200.0, 101.0, 200.0, -53.0, 134.0], "policy_predator_policy_reward": [0.0, 0.0, 110.0, 0.0, 0.0, 100.0, 0.0, 115.0, 0.0, 185.0, 0.0, 0.0, 50.0, 100.0, 0.0, 85.0, 145.0, 0.0, 20.0, 0.0, 5.0, 130.0, 50.0, 35.0, 0.0, 0.0, 70.0, 0.0, 215.0, 0.0, 0.0, 0.0, 50.0, 175.0, 0.0, 60.0, 90.0, 5.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 60.0, 30.0, 235.0, 615.0, 65.0, 0.0, 25.0, 35.0, 115.0, 0.0, 155.0, 680.0, 0.0, 0.0, 830.0, 0.0, 10.0, 45.0, 20.0, 0.0, 0.0, 525.0, 0.0, 0.0, 250.0, 40.0, 175.0, 0.0, 325.0, 165.0, 45.0, 45.0, 15.0, 65.0, 0.0, 105.0, 115.0, 0.0, 115.0, 75.0, 5.0, 0.0, 135.0, 0.0, 275.0, 0.0, 5.0, 0.0, 160.0, 200.0, 0.0, 0.0, 45.0, 0.0, 115.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3678786497582533, "mean_inference_ms": 1.427284061623845, "mean_action_processing_ms": 0.14960033294010272, "mean_env_wait_ms": 0.11843740146633229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041533708572387695, "StateBufferConnector_ms": 0.0025769472122192383, "ViewRequirementAgentConnector_ms": 0.05713534355163574}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -796.0, "episode_return_mean": 106.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.46785962956145, "num_env_steps_trained_throughput_per_sec": 172.46785962956145, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 23831.849, "restore_workers_time_ms": 0.029, "training_step_time_ms": 23831.638, "sample_time_ms": 989.013, "learn_time_ms": 22819.66, "learn_throughput": 175.287, "synch_weights_time_ms": 19.826}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "training_iteration": 13, "trial_id": "25fa0_00000", "date": "2024-08-12_13-32-51", "timestamp": 1723483971, "time_this_iter_s": 23.245500087738037, "time_total_s": 311.2018418312073, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 311.2018418312073, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 21.650000000000002, "ram_util_percent": 82.62941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9538395379980406, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1246804003914197, "policy_loss": -0.012458233099702435, "vf_loss": 1.1351820362954337, "vf_explained_var": -0.0008504721646507581, "kl": 0.013043981199837995, "entropy": 1.5018005397170782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.338754799341164, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.499468527858456, "policy_loss": -0.00918572010753754, "vf_loss": 3.5073667728652556, "vf_explained_var": 0.019580864223341148, "kl": 0.011444131688546032, "entropy": 1.4288675318161645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -796.0, "episode_reward_mean": 108.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1626.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 830.0}, "policy_reward_mean": {"prey_policy": 31.81, "predator_policy": 76.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -58.0, 200.0, 200.0, 200.0, 140.0, -10.0, 200.0, 128.0, 92.0, 194.0, 200.0, 200.0, 200.0, 158.0, 194.0, 200.0, 128.0, 164.0, -82.0, -538.0, 122.0, 200.0, 170.0, 158.0, 62.0, 200.0, 14.0, -616.0, 200.0, 200.0, -796.0, 200.0, 188.0, 146.0, 176.0, 200.0, 200.0, -430.0, 200.0, 200.0, -100.0, 152.0, -10.0, 200.0, -190.0, 2.0, 146.0, 146.0, 182.0, 122.0, 200.0, 74.0, 62.0, 200.0, 62.0, 110.0, 194.0, 200.0, 38.0, 200.0, -130.0, 200.0, 194.0, 200.0, 8.0, -40.0, 200.0, 200.0, 146.0, 200.0, 62.0, 164.0, 200.0, 200.0, 104.0, 170.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 110.0, 176.0, 104.0, 152.0, -70.0, 188.0, 38.0, 200.0, 182.0, 146.0, 8.0, 152.0, 182.0, 200.0, 200.0, 86.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -273.0, 200.0, 200.0, 200.0, 90.0, -185.0, 200.0, 68.0, 2.0, 189.0, 200.0, 200.0, 200.0, 123.0, 189.0, 200.0, 68.0, 134.0, -317.0, -1153.0, 57.0, 200.0, 145.0, 123.0, -53.0, 200.0, -141.0, -1296.0, 200.0, 200.0, -1626.0, 200.0, 178.0, 101.0, 156.0, 200.0, 200.0, -955.0, 200.0, 200.0, -350.0, 112.0, -185.0, 200.0, -515.0, -163.0, 101.0, 101.0, 167.0, 57.0, 200.0, -31.0, -53.0, 200.0, -53.0, 35.0, 189.0, 200.0, -97.0, 200.0, -405.0, 200.0, 189.0, 200.0, -152.0, -240.0, 200.0, 200.0, 101.0, 200.0, -53.0, 134.0, 200.0, 200.0, 24.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 35.0, 156.0, 24.0, 112.0, -295.0, 178.0, -97.0, 200.0, 167.0, 101.0, -152.0, 112.0, 167.0, 200.0, 200.0, -9.0], "policy_predator_policy_reward": [0.0, 215.0, 0.0, 0.0, 0.0, 50.0, 175.0, 0.0, 60.0, 90.0, 5.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 60.0, 30.0, 235.0, 615.0, 65.0, 0.0, 25.0, 35.0, 115.0, 0.0, 155.0, 680.0, 0.0, 0.0, 830.0, 0.0, 10.0, 45.0, 20.0, 0.0, 0.0, 525.0, 0.0, 0.0, 250.0, 40.0, 175.0, 0.0, 325.0, 165.0, 45.0, 45.0, 15.0, 65.0, 0.0, 105.0, 115.0, 0.0, 115.0, 75.0, 5.0, 0.0, 135.0, 0.0, 275.0, 0.0, 5.0, 0.0, 160.0, 200.0, 0.0, 0.0, 45.0, 0.0, 115.0, 30.0, 0.0, 0.0, 80.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 20.0, 80.0, 40.0, 225.0, 10.0, 135.0, 0.0, 15.0, 45.0, 160.0, 40.0, 15.0, 0.0, 0.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3613800657936095, "mean_inference_ms": 1.405931263145441, "mean_action_processing_ms": 0.14754072641522745, "mean_env_wait_ms": 0.11621158816739101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298567771911621, "StateBufferConnector_ms": 0.0025953054428100586, "ViewRequirementAgentConnector_ms": 0.057575225830078125}, "num_episodes": 27, "episode_return_max": 200.0, "episode_return_min": -796.0, "episode_return_mean": 108.26, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.7997280260076, "num_env_steps_trained_throughput_per_sec": 171.7997280260076, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 23566.413, "restore_workers_time_ms": 0.025, "training_step_time_ms": 23566.204, "sample_time_ms": 953.933, "learn_time_ms": 22588.83, "learn_throughput": 177.079, "synch_weights_time_ms": 20.52}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 14, "trial_id": "25fa0_00000", "date": "2024-08-12_13-33-15", "timestamp": 1723483995, "time_this_iter_s": 23.324553966522217, "time_total_s": 334.5263957977295, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 334.5263957977295, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.093939393939394, "ram_util_percent": 82.84242424242424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0160672630493839, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1830236740099886, "policy_loss": -0.005773104769953837, "vf_loss": 1.18778418992988, "vf_explained_var": 0.0005287321284413338, "kl": 0.00675059132090261, "entropy": 1.5145634339501461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.235365576048693, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6342660299191873, "policy_loss": -0.004797398785982902, "vf_loss": 2.6382875137031077, "vf_explained_var": 0.017601785187919935, "kl": 0.006897059997228365, "entropy": 1.407671949888269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -796.0, "episode_reward_mean": 102.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1626.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 830.0}, "policy_reward_mean": {"prey_policy": 20.48, "predator_policy": 81.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, -82.0, -538.0, 122.0, 200.0, 170.0, 158.0, 62.0, 200.0, 14.0, -616.0, 200.0, 200.0, -796.0, 200.0, 188.0, 146.0, 176.0, 200.0, 200.0, -430.0, 200.0, 200.0, -100.0, 152.0, -10.0, 200.0, -190.0, 2.0, 146.0, 146.0, 182.0, 122.0, 200.0, 74.0, 62.0, 200.0, 62.0, 110.0, 194.0, 200.0, 38.0, 200.0, -130.0, 200.0, 194.0, 200.0, 8.0, -40.0, 200.0, 200.0, 146.0, 200.0, 62.0, 164.0, 200.0, 200.0, 104.0, 170.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 110.0, 176.0, 104.0, 152.0, -70.0, 188.0, 38.0, 200.0, 182.0, 146.0, 8.0, 152.0, 182.0, 200.0, 200.0, 86.0, 26.0, 200.0, 98.0, 200.0, 200.0, 122.0, 188.0, 200.0, -154.0, 200.0, 8.0, 194.0, 122.0, 200.0, 86.0, 200.0, 170.0, -112.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.0, -317.0, -1153.0, 57.0, 200.0, 145.0, 123.0, -53.0, 200.0, -141.0, -1296.0, 200.0, 200.0, -1626.0, 200.0, 178.0, 101.0, 156.0, 200.0, 200.0, -955.0, 200.0, 200.0, -350.0, 112.0, -185.0, 200.0, -515.0, -163.0, 101.0, 101.0, 167.0, 57.0, 200.0, -31.0, -53.0, 200.0, -53.0, 35.0, 189.0, 200.0, -97.0, 200.0, -405.0, 200.0, 189.0, 200.0, -152.0, -240.0, 200.0, 200.0, 101.0, 200.0, -53.0, 134.0, 200.0, 200.0, 24.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 35.0, 156.0, 24.0, 112.0, -295.0, 178.0, -97.0, 200.0, 167.0, 101.0, -152.0, 112.0, 167.0, 200.0, 200.0, -9.0, -119.0, 200.0, 13.0, 200.0, 200.0, 57.0, 178.0, 200.0, -449.0, 200.0, -152.0, 189.0, 57.0, 200.0, -9.0, 200.0, 145.0, -372.0], "policy_predator_policy_reward": [30.0, 235.0, 615.0, 65.0, 0.0, 25.0, 35.0, 115.0, 0.0, 155.0, 680.0, 0.0, 0.0, 830.0, 0.0, 10.0, 45.0, 20.0, 0.0, 0.0, 525.0, 0.0, 0.0, 250.0, 40.0, 175.0, 0.0, 325.0, 165.0, 45.0, 45.0, 15.0, 65.0, 0.0, 105.0, 115.0, 0.0, 115.0, 75.0, 5.0, 0.0, 135.0, 0.0, 275.0, 0.0, 5.0, 0.0, 160.0, 200.0, 0.0, 0.0, 45.0, 0.0, 115.0, 30.0, 0.0, 0.0, 80.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 20.0, 80.0, 40.0, 225.0, 10.0, 135.0, 0.0, 15.0, 45.0, 160.0, 40.0, 15.0, 0.0, 0.0, 95.0, 145.0, 0.0, 85.0, 0.0, 0.0, 65.0, 10.0, 0.0, 295.0, 0.0, 160.0, 5.0, 65.0, 0.0, 95.0, 0.0, 25.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35717246715221934, "mean_inference_ms": 1.3862271560188326, "mean_action_processing_ms": 0.1454465126886738, "mean_env_wait_ms": 0.11450634467851498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025871992111206055, "StateBufferConnector_ms": 0.002019524574279785, "ViewRequirementAgentConnector_ms": 0.05046284198760986}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -796.0, "episode_return_mean": 102.08, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.3922597568438, "num_env_steps_trained_throughput_per_sec": 169.3922597568438, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 23426.699, "restore_workers_time_ms": 0.026, "training_step_time_ms": 23426.506, "sample_time_ms": 892.762, "learn_time_ms": 22510.817, "learn_throughput": 177.692, "synch_weights_time_ms": 20.08}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 15, "trial_id": "25fa0_00000", "date": "2024-08-12_13-33-38", "timestamp": 1723484018, "time_this_iter_s": 23.642976760864258, "time_total_s": 358.16937255859375, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 358.16937255859375, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.23939393939394, "ram_util_percent": 83.0909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9863816173747182, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.73526996622483, "policy_loss": -0.009173585679673125, "vf_loss": 5.7426258161664006, "vf_explained_var": 0.0008311656614144644, "kl": 0.012118264397731497, "entropy": 1.466853879019618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.840108008186023, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.339390965799491, "policy_loss": -0.010669823610320843, "vf_loss": 6.348234624663989, "vf_explained_var": 0.012202419775227706, "kl": 0.016232549056034794, "entropy": 1.3651489872485398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -850.0, "episode_reward_mean": 68.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1725.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": -41.23, "predator_policy": 109.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, -430.0, 200.0, 200.0, -100.0, 152.0, -10.0, 200.0, -190.0, 2.0, 146.0, 146.0, 182.0, 122.0, 200.0, 74.0, 62.0, 200.0, 62.0, 110.0, 194.0, 200.0, 38.0, 200.0, -130.0, 200.0, 194.0, 200.0, 8.0, -40.0, 200.0, 200.0, 146.0, 200.0, 62.0, 164.0, 200.0, 200.0, 104.0, 170.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 110.0, 176.0, 104.0, 152.0, -70.0, 188.0, 38.0, 200.0, 182.0, 146.0, 8.0, 152.0, 182.0, 200.0, 200.0, 86.0, 26.0, 200.0, 98.0, 200.0, 200.0, 122.0, 188.0, 200.0, -154.0, 200.0, 8.0, 194.0, 122.0, 200.0, 86.0, 200.0, 170.0, -112.0, 200.0, 188.0, -784.0, -394.0, -250.0, -106.0, -424.0, -160.0, 200.0, -406.0, 200.0, -748.0, -268.0, -196.0, -850.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -955.0, 200.0, 200.0, -350.0, 112.0, -185.0, 200.0, -515.0, -163.0, 101.0, 101.0, 167.0, 57.0, 200.0, -31.0, -53.0, 200.0, -53.0, 35.0, 189.0, 200.0, -97.0, 200.0, -405.0, 200.0, 189.0, 200.0, -152.0, -240.0, 200.0, 200.0, 101.0, 200.0, -53.0, 134.0, 200.0, 200.0, 24.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 35.0, 156.0, 24.0, 112.0, -295.0, 178.0, -97.0, 200.0, 167.0, 101.0, -152.0, 112.0, 167.0, 200.0, 200.0, -9.0, -119.0, 200.0, 13.0, 200.0, 200.0, 57.0, 178.0, 200.0, -449.0, 200.0, -152.0, 189.0, 57.0, 200.0, -9.0, 200.0, 145.0, -372.0, 200.0, 178.0, -1604.0, -889.0, -625.0, -361.0, -944.0, -460.0, 200.0, -911.0, 200.0, -1538.0, -658.0, -526.0, -1725.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 525.0, 0.0, 0.0, 250.0, 40.0, 175.0, 0.0, 325.0, 165.0, 45.0, 45.0, 15.0, 65.0, 0.0, 105.0, 115.0, 0.0, 115.0, 75.0, 5.0, 0.0, 135.0, 0.0, 275.0, 0.0, 5.0, 0.0, 160.0, 200.0, 0.0, 0.0, 45.0, 0.0, 115.0, 30.0, 0.0, 0.0, 80.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 20.0, 80.0, 40.0, 225.0, 10.0, 135.0, 0.0, 15.0, 45.0, 160.0, 40.0, 15.0, 0.0, 0.0, 95.0, 145.0, 0.0, 85.0, 0.0, 0.0, 65.0, 10.0, 0.0, 295.0, 0.0, 160.0, 5.0, 65.0, 0.0, 95.0, 0.0, 25.0, 260.0, 0.0, 10.0, 820.0, 495.0, 375.0, 255.0, 520.0, 300.0, 0.0, 505.0, 0.0, 790.0, 390.0, 330.0, 875.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3537928910950035, "mean_inference_ms": 1.3724494116226578, "mean_action_processing_ms": 0.14403350554555794, "mean_env_wait_ms": 0.1131778729545104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026235580444335938, "StateBufferConnector_ms": 0.0020363330841064453, "ViewRequirementAgentConnector_ms": 0.055353641510009766}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -850.0, "episode_return_mean": 68.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.1099137068779, "num_env_steps_trained_throughput_per_sec": 153.1099137068779, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 23678.573, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23678.388, "sample_time_ms": 893.985, "learn_time_ms": 22756.733, "learn_throughput": 175.772, "synch_weights_time_ms": 24.113}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 16, "trial_id": "25fa0_00000", "date": "2024-08-12_13-34-05", "timestamp": 1723484045, "time_this_iter_s": 26.19503879547119, "time_total_s": 384.36441135406494, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 384.36441135406494, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 28.216666666666665, "ram_util_percent": 83.01111111111109}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0189977202254037, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.422807882726193, "policy_loss": -0.006412084832360657, "vf_loss": 8.428014095127583, "vf_explained_var": 0.00014015063643455506, "kl": 0.00803906994105598, "entropy": 1.4282149877399206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.819019088707864, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.578922884166241, "policy_loss": -0.012880155797756743, "vf_loss": 8.590581586460273, "vf_explained_var": 0.006372100735704104, "kl": 0.01085709181875168, "entropy": 1.4055746493240198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -952.0, "episode_reward_mean": -9.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -183.9, "predator_policy": 174.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 62.0, 110.0, 194.0, 200.0, 38.0, 200.0, -130.0, 200.0, 194.0, 200.0, 8.0, -40.0, 200.0, 200.0, 146.0, 200.0, 62.0, 164.0, 200.0, 200.0, 104.0, 170.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 110.0, 176.0, 104.0, 152.0, -70.0, 188.0, 38.0, 200.0, 182.0, 146.0, 8.0, 152.0, 182.0, 200.0, 200.0, 86.0, 26.0, 200.0, 98.0, 200.0, 200.0, 122.0, 188.0, 200.0, -154.0, 200.0, 8.0, 194.0, 122.0, 200.0, 86.0, 200.0, 170.0, -112.0, 200.0, 188.0, -784.0, -394.0, -250.0, -106.0, -424.0, -160.0, 200.0, -406.0, 200.0, -748.0, -268.0, -196.0, -850.0, 200.0, 200.0, 200.0, 200.0, -910.0, -142.0, -952.0, -256.0, -904.0, -4.0, -520.0, 200.0, 38.0, -796.0, 38.0, -448.0, -172.0, -880.0, -526.0, 134.0, -526.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -53.0, 35.0, 189.0, 200.0, -97.0, 200.0, -405.0, 200.0, 189.0, 200.0, -152.0, -240.0, 200.0, 200.0, 101.0, 200.0, -53.0, 134.0, 200.0, 200.0, 24.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 35.0, 156.0, 24.0, 112.0, -295.0, 178.0, -97.0, 200.0, 167.0, 101.0, -152.0, 112.0, 167.0, 200.0, 200.0, -9.0, -119.0, 200.0, 13.0, 200.0, 200.0, 57.0, 178.0, 200.0, -449.0, 200.0, -152.0, 189.0, 57.0, 200.0, -9.0, 200.0, 145.0, -372.0, 200.0, 178.0, -1604.0, -889.0, -625.0, -361.0, -944.0, -460.0, 200.0, -911.0, 200.0, -1538.0, -658.0, -526.0, -1725.0, 200.0, 200.0, 200.0, 200.0, -1835.0, -427.0, -1912.0, -636.0, -1824.0, -174.0, -1120.0, 200.0, -97.0, -1626.0, -97.0, -988.0, -482.0, -1780.0, -1131.0, 79.0, -1131.0], "policy_predator_policy_reward": [0.0, 115.0, 75.0, 5.0, 0.0, 135.0, 0.0, 275.0, 0.0, 5.0, 0.0, 160.0, 200.0, 0.0, 0.0, 45.0, 0.0, 115.0, 30.0, 0.0, 0.0, 80.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 20.0, 80.0, 40.0, 225.0, 10.0, 135.0, 0.0, 15.0, 45.0, 160.0, 40.0, 15.0, 0.0, 0.0, 95.0, 145.0, 0.0, 85.0, 0.0, 0.0, 65.0, 10.0, 0.0, 295.0, 0.0, 160.0, 5.0, 65.0, 0.0, 95.0, 0.0, 25.0, 260.0, 0.0, 10.0, 820.0, 495.0, 375.0, 255.0, 520.0, 300.0, 0.0, 505.0, 0.0, 790.0, 390.0, 330.0, 875.0, 0.0, 0.0, 0.0, 0.0, 925.0, 285.0, 960.0, 380.0, 920.0, 170.0, 600.0, 0.0, 135.0, 830.0, 135.0, 540.0, 310.0, 900.0, 605.0, 55.0, 605.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3564872127480115, "mean_inference_ms": 1.3857189499328704, "mean_action_processing_ms": 0.14505313482406101, "mean_env_wait_ms": 0.11438666239336451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027627944946289062, "StateBufferConnector_ms": 0.0022122859954833984, "ViewRequirementAgentConnector_ms": 0.06644511222839355}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -952.0, "episode_return_mean": -9.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.211615095564035, "num_env_steps_trained_throughput_per_sec": 15.211615095564035, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 47629.412, "restore_workers_time_ms": 0.028, "training_step_time_ms": 47629.216, "sample_time_ms": 1076.202, "learn_time_ms": 46519.521, "learn_throughput": 85.985, "synch_weights_time_ms": 29.494}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "training_iteration": 17, "trial_id": "25fa0_00000", "date": "2024-08-12_13-38-28", "timestamp": 1723484308, "time_this_iter_s": 263.0348596572876, "time_total_s": 647.3992710113525, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 647.3992710113525, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 64.602, "ram_util_percent": 83.458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9697558529675007, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.301160433888436, "policy_loss": -0.007457425271180303, "vf_loss": 5.306740113347769, "vf_explained_var": 8.051550636688868e-05, "kl": 0.012518335846930951, "entropy": 1.3823630674431722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.054913776678344, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.783674927552541, "policy_loss": -0.011400775025928548, "vf_loss": 5.793270124495029, "vf_explained_var": 0.006393696616093318, "kl": 0.016049585991444307, "entropy": 1.417739105472962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -952.0, "episode_reward_mean": -83.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -320.19, "predator_policy": 236.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 110.0, 176.0, 104.0, 152.0, -70.0, 188.0, 38.0, 200.0, 182.0, 146.0, 8.0, 152.0, 182.0, 200.0, 200.0, 86.0, 26.0, 200.0, 98.0, 200.0, 200.0, 122.0, 188.0, 200.0, -154.0, 200.0, 8.0, 194.0, 122.0, 200.0, 86.0, 200.0, 170.0, -112.0, 200.0, 188.0, -784.0, -394.0, -250.0, -106.0, -424.0, -160.0, 200.0, -406.0, 200.0, -748.0, -268.0, -196.0, -850.0, 200.0, 200.0, 200.0, 200.0, -910.0, -142.0, -952.0, -256.0, -904.0, -4.0, -520.0, 200.0, 38.0, -796.0, 38.0, -448.0, -172.0, -880.0, -526.0, 134.0, -526.0, 14.0, 200.0, 170.0, -532.0, -244.0, 200.0, 200.0, -658.0, 200.0, -820.0, 200.0, 200.0, -874.0, -664.0, -718.0, 158.0, -424.0, -796.0, 176.0, 200.0, -310.0, -400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 35.0, 156.0, 24.0, 112.0, -295.0, 178.0, -97.0, 200.0, 167.0, 101.0, -152.0, 112.0, 167.0, 200.0, 200.0, -9.0, -119.0, 200.0, 13.0, 200.0, 200.0, 57.0, 178.0, 200.0, -449.0, 200.0, -152.0, 189.0, 57.0, 200.0, -9.0, 200.0, 145.0, -372.0, 200.0, 178.0, -1604.0, -889.0, -625.0, -361.0, -944.0, -460.0, 200.0, -911.0, 200.0, -1538.0, -658.0, -526.0, -1725.0, 200.0, 200.0, 200.0, 200.0, -1835.0, -427.0, -1912.0, -636.0, -1824.0, -174.0, -1120.0, 200.0, -97.0, -1626.0, -97.0, -988.0, -482.0, -1780.0, -1131.0, 79.0, -1131.0, -141.0, 200.0, 145.0, -1142.0, -614.0, 200.0, 200.0, -1373.0, 200.0, -1670.0, 200.0, 200.0, -1769.0, -1384.0, -1483.0, 123.0, -944.0, -1626.0, 156.0, 200.0, -735.0, -900.0], "policy_predator_policy_reward": [25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 75.0, 20.0, 80.0, 40.0, 225.0, 10.0, 135.0, 0.0, 15.0, 45.0, 160.0, 40.0, 15.0, 0.0, 0.0, 95.0, 145.0, 0.0, 85.0, 0.0, 0.0, 65.0, 10.0, 0.0, 295.0, 0.0, 160.0, 5.0, 65.0, 0.0, 95.0, 0.0, 25.0, 260.0, 0.0, 10.0, 820.0, 495.0, 375.0, 255.0, 520.0, 300.0, 0.0, 505.0, 0.0, 790.0, 390.0, 330.0, 875.0, 0.0, 0.0, 0.0, 0.0, 925.0, 285.0, 960.0, 380.0, 920.0, 170.0, 600.0, 0.0, 135.0, 830.0, 135.0, 540.0, 310.0, 900.0, 605.0, 55.0, 605.0, 155.0, 0.0, 25.0, 610.0, 370.0, 0.0, 0.0, 715.0, 0.0, 850.0, 0.0, 0.0, 895.0, 720.0, 765.0, 35.0, 520.0, 830.0, 20.0, 0.0, 425.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36238196224178665, "mean_inference_ms": 1.4125801197865018, "mean_action_processing_ms": 0.14746244291279456, "mean_env_wait_ms": 0.11693688030478715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027587413787841797, "StateBufferConnector_ms": 0.002177596092224121, "ViewRequirementAgentConnector_ms": 0.06812083721160889}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -952.0, "episode_return_mean": -83.74, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.14740739089763, "num_env_steps_trained_throughput_per_sec": 163.14740739089763, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 47728.552, "restore_workers_time_ms": 0.028, "training_step_time_ms": 47728.357, "sample_time_ms": 1074.098, "learn_time_ms": 46620.335, "learn_throughput": 85.799, "synch_weights_time_ms": 29.939}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 18, "trial_id": "25fa0_00000", "date": "2024-08-12_13-38-52", "timestamp": 1723484332, "time_this_iter_s": 24.565847158432007, "time_total_s": 671.9651181697845, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 671.9651181697845, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 27.082857142857144, "ram_util_percent": 83.19428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1015832119000455, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.075998913745085, "policy_loss": -0.00842261479907999, "vf_loss": 5.082331896821658, "vf_explained_var": -5.423178275426229e-05, "kl": 0.013930938477415417, "entropy": 1.3771316662430764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.115190686347585, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.454642178118229, "policy_loss": -0.007827561936088993, "vf_loss": 5.461312720427911, "vf_explained_var": 0.006983594720562299, "kl": 0.01028465009744772, "entropy": 1.4108748930195967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -952.0, "episode_reward_mean": -170.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -479.36, "predator_policy": 308.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.0, 26.0, 200.0, 98.0, 200.0, 200.0, 122.0, 188.0, 200.0, -154.0, 200.0, 8.0, 194.0, 122.0, 200.0, 86.0, 200.0, 170.0, -112.0, 200.0, 188.0, -784.0, -394.0, -250.0, -106.0, -424.0, -160.0, 200.0, -406.0, 200.0, -748.0, -268.0, -196.0, -850.0, 200.0, 200.0, 200.0, 200.0, -910.0, -142.0, -952.0, -256.0, -904.0, -4.0, -520.0, 200.0, 38.0, -796.0, 38.0, -448.0, -172.0, -880.0, -526.0, 134.0, -526.0, 14.0, 200.0, 170.0, -532.0, -244.0, 200.0, 200.0, -658.0, 200.0, -820.0, 200.0, 200.0, -874.0, -664.0, -718.0, 158.0, -424.0, -796.0, 176.0, 200.0, -310.0, -400.0, 200.0, -454.0, 20.0, -808.0, 164.0, 200.0, -904.0, 32.0, -256.0, -646.0, -700.0, -352.0, 200.0, 158.0, -406.0, 200.0, -610.0, -382.0, -592.0, 200.0, 200.0, 158.0, -766.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, -119.0, 200.0, 13.0, 200.0, 200.0, 57.0, 178.0, 200.0, -449.0, 200.0, -152.0, 189.0, 57.0, 200.0, -9.0, 200.0, 145.0, -372.0, 200.0, 178.0, -1604.0, -889.0, -625.0, -361.0, -944.0, -460.0, 200.0, -911.0, 200.0, -1538.0, -658.0, -526.0, -1725.0, 200.0, 200.0, 200.0, 200.0, -1835.0, -427.0, -1912.0, -636.0, -1824.0, -174.0, -1120.0, 200.0, -97.0, -1626.0, -97.0, -988.0, -482.0, -1780.0, -1131.0, 79.0, -1131.0, -141.0, 200.0, 145.0, -1142.0, -614.0, 200.0, 200.0, -1373.0, 200.0, -1670.0, 200.0, 200.0, -1769.0, -1384.0, -1483.0, 123.0, -944.0, -1626.0, 156.0, 200.0, -735.0, -900.0, 200.0, -999.0, -130.0, -1648.0, 134.0, 200.0, -1824.0, -108.0, -636.0, -1351.0, -1450.0, -812.0, 200.0, 123.0, -911.0, 200.0, -1285.0, -867.0, -1252.0, 200.0, 200.0, 123.0, -1571.0], "policy_predator_policy_reward": [95.0, 145.0, 0.0, 85.0, 0.0, 0.0, 65.0, 10.0, 0.0, 295.0, 0.0, 160.0, 5.0, 65.0, 0.0, 95.0, 0.0, 25.0, 260.0, 0.0, 10.0, 820.0, 495.0, 375.0, 255.0, 520.0, 300.0, 0.0, 505.0, 0.0, 790.0, 390.0, 330.0, 875.0, 0.0, 0.0, 0.0, 0.0, 925.0, 285.0, 960.0, 380.0, 920.0, 170.0, 600.0, 0.0, 135.0, 830.0, 135.0, 540.0, 310.0, 900.0, 605.0, 55.0, 605.0, 155.0, 0.0, 25.0, 610.0, 370.0, 0.0, 0.0, 715.0, 0.0, 850.0, 0.0, 0.0, 895.0, 720.0, 765.0, 35.0, 520.0, 830.0, 20.0, 0.0, 425.0, 500.0, 0.0, 545.0, 150.0, 840.0, 30.0, 0.0, 920.0, 140.0, 380.0, 705.0, 750.0, 460.0, 0.0, 35.0, 505.0, 0.0, 675.0, 485.0, 660.0, 0.0, 0.0, 35.0, 805.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3679136727875246, "mean_inference_ms": 1.431564895665128, "mean_action_processing_ms": 0.1487926623402673, "mean_env_wait_ms": 0.1187419561026902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004063248634338379, "StateBufferConnector_ms": 0.002483844757080078, "ViewRequirementAgentConnector_ms": 0.08316600322723389}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -952.0, "episode_return_mean": -170.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.9510285663979, "num_env_steps_trained_throughput_per_sec": 170.9510285663979, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 47742.409, "restore_workers_time_ms": 0.028, "training_step_time_ms": 47742.251, "sample_time_ms": 1094.431, "learn_time_ms": 46613.619, "learn_throughput": 85.812, "synch_weights_time_ms": 30.341}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "training_iteration": 19, "trial_id": "25fa0_00000", "date": "2024-08-12_13-39-16", "timestamp": 1723484356, "time_this_iter_s": 23.437605142593384, "time_total_s": 695.4027233123779, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4825e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.4027233123779, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 27.115151515151517, "ram_util_percent": 83.44848484848485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9670446863863618, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.809904628495375, "policy_loss": -0.00585288195773804, "vf_loss": 4.814837884654602, "vf_explained_var": 7.277168333530426e-06, "kl": 0.00613076931769001, "entropy": 1.3721519867579142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.825231066284081, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.973671747495731, "policy_loss": -0.009652046445504917, "vf_loss": 4.981865063806375, "vf_explained_var": 0.008079563019176323, "kl": 0.012966393758658823, "entropy": 1.4298772701372704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -952.0, "episode_reward_mean": -230.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -588.81, "predator_policy": 358.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-112.0, 200.0, 188.0, -784.0, -394.0, -250.0, -106.0, -424.0, -160.0, 200.0, -406.0, 200.0, -748.0, -268.0, -196.0, -850.0, 200.0, 200.0, 200.0, 200.0, -910.0, -142.0, -952.0, -256.0, -904.0, -4.0, -520.0, 200.0, 38.0, -796.0, 38.0, -448.0, -172.0, -880.0, -526.0, 134.0, -526.0, 14.0, 200.0, 170.0, -532.0, -244.0, 200.0, 200.0, -658.0, 200.0, -820.0, 200.0, 200.0, -874.0, -664.0, -718.0, 158.0, -424.0, -796.0, 176.0, 200.0, -310.0, -400.0, 200.0, -454.0, 20.0, -808.0, 164.0, 200.0, -904.0, 32.0, -256.0, -646.0, -700.0, -352.0, 200.0, 158.0, -406.0, 200.0, -610.0, -382.0, -592.0, 200.0, 200.0, 158.0, -766.0, -622.0, -760.0, 122.0, 122.0, -766.0, 200.0, -628.0, -124.0, -100.0, -148.0, -10.0, -676.0, -160.0, 200.0, 200.0, 92.0, 20.0, -586.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-372.0, 200.0, 178.0, -1604.0, -889.0, -625.0, -361.0, -944.0, -460.0, 200.0, -911.0, 200.0, -1538.0, -658.0, -526.0, -1725.0, 200.0, 200.0, 200.0, 200.0, -1835.0, -427.0, -1912.0, -636.0, -1824.0, -174.0, -1120.0, 200.0, -97.0, -1626.0, -97.0, -988.0, -482.0, -1780.0, -1131.0, 79.0, -1131.0, -141.0, 200.0, 145.0, -1142.0, -614.0, 200.0, 200.0, -1373.0, 200.0, -1670.0, 200.0, 200.0, -1769.0, -1384.0, -1483.0, 123.0, -944.0, -1626.0, 156.0, 200.0, -735.0, -900.0, 200.0, -999.0, -130.0, -1648.0, 134.0, 200.0, -1824.0, -108.0, -636.0, -1351.0, -1450.0, -812.0, 200.0, 123.0, -911.0, 200.0, -1285.0, -867.0, -1252.0, 200.0, 200.0, 123.0, -1571.0, -1307.0, -1560.0, 57.0, 57.0, -1571.0, 200.0, -1318.0, -394.0, -350.0, -438.0, -185.0, -1406.0, -460.0, 200.0, 200.0, 2.0, -130.0, -1241.0], "policy_predator_policy_reward": [260.0, 0.0, 10.0, 820.0, 495.0, 375.0, 255.0, 520.0, 300.0, 0.0, 505.0, 0.0, 790.0, 390.0, 330.0, 875.0, 0.0, 0.0, 0.0, 0.0, 925.0, 285.0, 960.0, 380.0, 920.0, 170.0, 600.0, 0.0, 135.0, 830.0, 135.0, 540.0, 310.0, 900.0, 605.0, 55.0, 605.0, 155.0, 0.0, 25.0, 610.0, 370.0, 0.0, 0.0, 715.0, 0.0, 850.0, 0.0, 0.0, 895.0, 720.0, 765.0, 35.0, 520.0, 830.0, 20.0, 0.0, 425.0, 500.0, 0.0, 545.0, 150.0, 840.0, 30.0, 0.0, 920.0, 140.0, 380.0, 705.0, 750.0, 460.0, 0.0, 35.0, 505.0, 0.0, 675.0, 485.0, 660.0, 0.0, 0.0, 35.0, 805.0, 685.0, 800.0, 65.0, 65.0, 805.0, 0.0, 690.0, 270.0, 250.0, 290.0, 175.0, 730.0, 300.0, 0.0, 0.0, 90.0, 150.0, 655.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3731713705236217, "mean_inference_ms": 1.4514039620461545, "mean_action_processing_ms": 0.1504206654229385, "mean_env_wait_ms": 0.12053530408854599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004092574119567871, "StateBufferConnector_ms": 0.0025087594985961914, "ViewRequirementAgentConnector_ms": 0.08706331253051758}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -952.0, "episode_return_mean": -230.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.9641334280804, "num_env_steps_trained_throughput_per_sec": 150.9641334280804, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 48049.188, "restore_workers_time_ms": 0.041, "training_step_time_ms": 48049.035, "sample_time_ms": 1086.449, "learn_time_ms": 46927.811, "learn_throughput": 85.237, "synch_weights_time_ms": 30.57}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 20, "trial_id": "25fa0_00000", "date": "2024-08-12_13-39-42", "timestamp": 1723484382, "time_this_iter_s": 26.540860891342163, "time_total_s": 721.9435842037201, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482ddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 721.9435842037201, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.72368421052632, "ram_util_percent": 82.98947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8903445494826883, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.675217296803991, "policy_loss": -0.005820173578589068, "vf_loss": 2.6797497385491926, "vf_explained_var": -9.840515752633413e-05, "kl": 0.008584805953811761, "entropy": 1.3355240485320488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.865183416629831, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.02809624299407, "policy_loss": -0.019500171185063662, "vf_loss": 3.0453582306702933, "vf_explained_var": 0.01194278517117103, "kl": 0.019895098810360837, "entropy": 1.446393866216143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -952.0, "episode_reward_mean": -211.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 960.0}, "policy_reward_mean": {"prey_policy": -553.5, "predator_policy": 342.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, -910.0, -142.0, -952.0, -256.0, -904.0, -4.0, -520.0, 200.0, 38.0, -796.0, 38.0, -448.0, -172.0, -880.0, -526.0, 134.0, -526.0, 14.0, 200.0, 170.0, -532.0, -244.0, 200.0, 200.0, -658.0, 200.0, -820.0, 200.0, 200.0, -874.0, -664.0, -718.0, 158.0, -424.0, -796.0, 176.0, 200.0, -310.0, -400.0, 200.0, -454.0, 20.0, -808.0, 164.0, 200.0, -904.0, 32.0, -256.0, -646.0, -700.0, -352.0, 200.0, 158.0, -406.0, 200.0, -610.0, -382.0, -592.0, 200.0, 200.0, 158.0, -766.0, -622.0, -760.0, 122.0, 122.0, -766.0, 200.0, -628.0, -124.0, -100.0, -148.0, -10.0, -676.0, -160.0, 200.0, 200.0, 92.0, 20.0, -586.0, 200.0, 164.0, -904.0, 200.0, -508.0, 200.0, -736.0, 200.0, 200.0, 200.0, 200.0, -130.0, 122.0, 200.0, -394.0, -436.0, 38.0, -400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -1835.0, -427.0, -1912.0, -636.0, -1824.0, -174.0, -1120.0, 200.0, -97.0, -1626.0, -97.0, -988.0, -482.0, -1780.0, -1131.0, 79.0, -1131.0, -141.0, 200.0, 145.0, -1142.0, -614.0, 200.0, 200.0, -1373.0, 200.0, -1670.0, 200.0, 200.0, -1769.0, -1384.0, -1483.0, 123.0, -944.0, -1626.0, 156.0, 200.0, -735.0, -900.0, 200.0, -999.0, -130.0, -1648.0, 134.0, 200.0, -1824.0, -108.0, -636.0, -1351.0, -1450.0, -812.0, 200.0, 123.0, -911.0, 200.0, -1285.0, -867.0, -1252.0, 200.0, 200.0, 123.0, -1571.0, -1307.0, -1560.0, 57.0, 57.0, -1571.0, 200.0, -1318.0, -394.0, -350.0, -438.0, -185.0, -1406.0, -460.0, 200.0, 200.0, 2.0, -130.0, -1241.0, 200.0, 134.0, -1824.0, 200.0, -1098.0, 200.0, -1516.0, 200.0, 200.0, 200.0, 200.0, -405.0, 57.0, 200.0, -889.0, -966.0, -97.0, -900.0], "policy_predator_policy_reward": [0.0, 0.0, 925.0, 285.0, 960.0, 380.0, 920.0, 170.0, 600.0, 0.0, 135.0, 830.0, 135.0, 540.0, 310.0, 900.0, 605.0, 55.0, 605.0, 155.0, 0.0, 25.0, 610.0, 370.0, 0.0, 0.0, 715.0, 0.0, 850.0, 0.0, 0.0, 895.0, 720.0, 765.0, 35.0, 520.0, 830.0, 20.0, 0.0, 425.0, 500.0, 0.0, 545.0, 150.0, 840.0, 30.0, 0.0, 920.0, 140.0, 380.0, 705.0, 750.0, 460.0, 0.0, 35.0, 505.0, 0.0, 675.0, 485.0, 660.0, 0.0, 0.0, 35.0, 805.0, 685.0, 800.0, 65.0, 65.0, 805.0, 0.0, 690.0, 270.0, 250.0, 290.0, 175.0, 730.0, 300.0, 0.0, 0.0, 90.0, 150.0, 655.0, 0.0, 30.0, 920.0, 0.0, 590.0, 0.0, 780.0, 0.0, 0.0, 0.0, 0.0, 275.0, 65.0, 0.0, 495.0, 530.0, 135.0, 500.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785104749137099, "mean_inference_ms": 1.4714307671093492, "mean_action_processing_ms": 0.15209088888495978, "mean_env_wait_ms": 0.12238888007561342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004116415977478027, "StateBufferConnector_ms": 0.0025783777236938477, "ViewRequirementAgentConnector_ms": 0.08327007293701172}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -952.0, "episode_return_mean": -211.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.25877208274318, "num_env_steps_trained_throughput_per_sec": 149.25877208274318, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 48368.222, "restore_workers_time_ms": 0.058, "training_step_time_ms": 48368.052, "sample_time_ms": 1099.975, "learn_time_ms": 47233.165, "learn_throughput": 84.686, "synch_weights_time_ms": 30.62}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 21, "trial_id": "25fa0_00000", "date": "2024-08-12_13-40-09", "timestamp": 1723484409, "time_this_iter_s": 26.815104961395264, "time_total_s": 748.7586891651154, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 748.7586891651154, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 39.931578947368415, "ram_util_percent": 83.33421052631581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9119053612152735, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.309250057923297, "policy_loss": -0.013793568398493031, "vf_loss": 1.3210711888348063, "vf_explained_var": -0.00010468661785125732, "kl": 0.013149552568171763, "entropy": 1.3221270555009446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.013592239779731, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4421817110075306, "policy_loss": -0.013924826718478774, "vf_loss": 1.454528073919937, "vf_explained_var": 0.01460002331684033, "kl": 0.014030825960630032, "entropy": 1.3992409322410821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -904.0, "episode_reward_mean": -135.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -415.89, "predator_policy": 279.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-526.0, 14.0, 200.0, 170.0, -532.0, -244.0, 200.0, 200.0, -658.0, 200.0, -820.0, 200.0, 200.0, -874.0, -664.0, -718.0, 158.0, -424.0, -796.0, 176.0, 200.0, -310.0, -400.0, 200.0, -454.0, 20.0, -808.0, 164.0, 200.0, -904.0, 32.0, -256.0, -646.0, -700.0, -352.0, 200.0, 158.0, -406.0, 200.0, -610.0, -382.0, -592.0, 200.0, 200.0, 158.0, -766.0, -622.0, -760.0, 122.0, 122.0, -766.0, 200.0, -628.0, -124.0, -100.0, -148.0, -10.0, -676.0, -160.0, 200.0, 200.0, 92.0, 20.0, -586.0, 200.0, 164.0, -904.0, 200.0, -508.0, 200.0, -736.0, 200.0, 200.0, 200.0, 200.0, -130.0, 122.0, 200.0, -394.0, -436.0, 38.0, -400.0, -136.0, 194.0, -172.0, 26.0, 200.0, 170.0, 188.0, -40.0, -34.0, 134.0, 200.0, 74.0, 200.0, 152.0, 188.0, 62.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1131.0, -141.0, 200.0, 145.0, -1142.0, -614.0, 200.0, 200.0, -1373.0, 200.0, -1670.0, 200.0, 200.0, -1769.0, -1384.0, -1483.0, 123.0, -944.0, -1626.0, 156.0, 200.0, -735.0, -900.0, 200.0, -999.0, -130.0, -1648.0, 134.0, 200.0, -1824.0, -108.0, -636.0, -1351.0, -1450.0, -812.0, 200.0, 123.0, -911.0, 200.0, -1285.0, -867.0, -1252.0, 200.0, 200.0, 123.0, -1571.0, -1307.0, -1560.0, 57.0, 57.0, -1571.0, 200.0, -1318.0, -394.0, -350.0, -438.0, -185.0, -1406.0, -460.0, 200.0, 200.0, 2.0, -130.0, -1241.0, 200.0, 134.0, -1824.0, 200.0, -1098.0, 200.0, -1516.0, 200.0, 200.0, 200.0, 200.0, -405.0, 57.0, 200.0, -889.0, -966.0, -97.0, -900.0, -416.0, 189.0, -482.0, -119.0, 200.0, 145.0, 178.0, -240.0, -229.0, 79.0, 200.0, -31.0, 200.0, 112.0, 178.0, -53.0, 200.0, 200.0], "policy_predator_policy_reward": [605.0, 155.0, 0.0, 25.0, 610.0, 370.0, 0.0, 0.0, 715.0, 0.0, 850.0, 0.0, 0.0, 895.0, 720.0, 765.0, 35.0, 520.0, 830.0, 20.0, 0.0, 425.0, 500.0, 0.0, 545.0, 150.0, 840.0, 30.0, 0.0, 920.0, 140.0, 380.0, 705.0, 750.0, 460.0, 0.0, 35.0, 505.0, 0.0, 675.0, 485.0, 660.0, 0.0, 0.0, 35.0, 805.0, 685.0, 800.0, 65.0, 65.0, 805.0, 0.0, 690.0, 270.0, 250.0, 290.0, 175.0, 730.0, 300.0, 0.0, 0.0, 90.0, 150.0, 655.0, 0.0, 30.0, 920.0, 0.0, 590.0, 0.0, 780.0, 0.0, 0.0, 0.0, 0.0, 275.0, 65.0, 0.0, 495.0, 530.0, 135.0, 500.0, 280.0, 5.0, 310.0, 145.0, 0.0, 25.0, 10.0, 200.0, 195.0, 55.0, 0.0, 105.0, 0.0, 40.0, 10.0, 115.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783518296490709, "mean_inference_ms": 1.4674765311535187, "mean_action_processing_ms": 0.15172698713076638, "mean_env_wait_ms": 0.12206848499507415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003992676734924316, "StateBufferConnector_ms": 0.002390265464782715, "ViewRequirementAgentConnector_ms": 0.07205164432525635}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -904.0, "episode_return_mean": -135.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.49471162232965, "num_env_steps_trained_throughput_per_sec": 170.49471162232965, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 48384.451, "restore_workers_time_ms": 0.058, "training_step_time_ms": 48384.058, "sample_time_ms": 1103.645, "learn_time_ms": 47244.366, "learn_throughput": 84.666, "synch_weights_time_ms": 31.459}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 22, "trial_id": "25fa0_00000", "date": "2024-08-12_13-40-33", "timestamp": 1723484433, "time_this_iter_s": 23.49778413772583, "time_total_s": 772.2564733028412, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a485af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 772.2564733028412, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 24.60909090909091, "ram_util_percent": 82.55151515151515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9771155812156697, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.196591416622202, "policy_loss": -0.009278321475236832, "vf_loss": 3.204504773269097, "vf_explained_var": 0.0002032893399397532, "kl": 0.009099754438203907, "entropy": 1.2232909453411898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.889392559416592, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3202981289476154, "policy_loss": -0.009285308369241345, "vf_loss": 3.327832002937794, "vf_explained_var": 0.009589519972602526, "kl": 0.015568408788066522, "entropy": 1.4111931326488654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -904.0, "episode_reward_mean": -60.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -277.18, "predator_policy": 216.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, 200.0, -904.0, 32.0, -256.0, -646.0, -700.0, -352.0, 200.0, 158.0, -406.0, 200.0, -610.0, -382.0, -592.0, 200.0, 200.0, 158.0, -766.0, -622.0, -760.0, 122.0, 122.0, -766.0, 200.0, -628.0, -124.0, -100.0, -148.0, -10.0, -676.0, -160.0, 200.0, 200.0, 92.0, 20.0, -586.0, 200.0, 164.0, -904.0, 200.0, -508.0, 200.0, -736.0, 200.0, 200.0, 200.0, 200.0, -130.0, 122.0, 200.0, -394.0, -436.0, 38.0, -400.0, -136.0, 194.0, -172.0, 26.0, 200.0, 170.0, 188.0, -40.0, -34.0, 134.0, 200.0, 74.0, 200.0, 152.0, 188.0, 62.0, 200.0, 200.0, 200.0, 182.0, 200.0, 200.0, -418.0, -292.0, -166.0, 86.0, -118.0, 170.0, 200.0, 92.0, 200.0, -4.0, 146.0, -268.0, 152.0, -40.0, 20.0, 56.0, 200.0, 200.0, -58.0, 26.0, 188.0, 200.0, 122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.0, 200.0, -1824.0, -108.0, -636.0, -1351.0, -1450.0, -812.0, 200.0, 123.0, -911.0, 200.0, -1285.0, -867.0, -1252.0, 200.0, 200.0, 123.0, -1571.0, -1307.0, -1560.0, 57.0, 57.0, -1571.0, 200.0, -1318.0, -394.0, -350.0, -438.0, -185.0, -1406.0, -460.0, 200.0, 200.0, 2.0, -130.0, -1241.0, 200.0, 134.0, -1824.0, 200.0, -1098.0, 200.0, -1516.0, 200.0, 200.0, 200.0, 200.0, -405.0, 57.0, 200.0, -889.0, -966.0, -97.0, -900.0, -416.0, 189.0, -482.0, -119.0, 200.0, 145.0, 178.0, -240.0, -229.0, 79.0, 200.0, -31.0, 200.0, 112.0, 178.0, -53.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, -933.0, -702.0, -471.0, -9.0, -383.0, 145.0, 200.0, 2.0, 200.0, -174.0, 101.0, -658.0, 112.0, -240.0, -130.0, -64.0, 200.0, 200.0, -273.0, -119.0, 178.0, 200.0, 57.0], "policy_predator_policy_reward": [30.0, 0.0, 920.0, 140.0, 380.0, 705.0, 750.0, 460.0, 0.0, 35.0, 505.0, 0.0, 675.0, 485.0, 660.0, 0.0, 0.0, 35.0, 805.0, 685.0, 800.0, 65.0, 65.0, 805.0, 0.0, 690.0, 270.0, 250.0, 290.0, 175.0, 730.0, 300.0, 0.0, 0.0, 90.0, 150.0, 655.0, 0.0, 30.0, 920.0, 0.0, 590.0, 0.0, 780.0, 0.0, 0.0, 0.0, 0.0, 275.0, 65.0, 0.0, 495.0, 530.0, 135.0, 500.0, 280.0, 5.0, 310.0, 145.0, 0.0, 25.0, 10.0, 200.0, 195.0, 55.0, 0.0, 105.0, 0.0, 40.0, 10.0, 115.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 515.0, 410.0, 305.0, 95.0, 265.0, 25.0, 0.0, 90.0, 0.0, 170.0, 45.0, 390.0, 40.0, 200.0, 150.0, 120.0, 0.0, 0.0, 215.0, 145.0, 10.0, 0.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769929258373452, "mean_inference_ms": 1.4582191736226044, "mean_action_processing_ms": 0.15097596694455245, "mean_env_wait_ms": 0.12130543595500588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00424647331237793, "StateBufferConnector_ms": 0.0025300979614257812, "ViewRequirementAgentConnector_ms": 0.07080495357513428}, "num_episodes": 27, "episode_return_max": 200.0, "episode_return_min": -904.0, "episode_return_mean": -60.28, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.28256778380958, "num_env_steps_trained_throughput_per_sec": 170.28256778380958, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 48414.215, "restore_workers_time_ms": 0.058, "training_step_time_ms": 48413.822, "sample_time_ms": 1100.529, "learn_time_ms": 47277.563, "learn_throughput": 84.607, "synch_weights_time_ms": 31.287}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "training_iteration": 23, "trial_id": "25fa0_00000", "date": "2024-08-12_13-40-56", "timestamp": 1723484456, "time_this_iter_s": 23.522358179092407, "time_total_s": 795.7788314819336, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 795.7788314819336, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.249999999999996, "ram_util_percent": 82.4735294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9006130806170404, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.326152264078458, "policy_loss": -0.011752009487827309, "vf_loss": 2.3356904594848555, "vf_explained_var": 9.941520790259043e-05, "kl": 0.014758724999028269, "entropy": 1.1841862024118504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.973128077387809, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3971808553362886, "policy_loss": -0.009700250328266217, "vf_loss": 2.406250895932317, "vf_explained_var": 0.009736538181702297, "kl": 0.005601953437080928, "entropy": 1.414717255036036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": -29.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": -221.63, "predator_policy": 191.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.0, -622.0, -760.0, 122.0, 122.0, -766.0, 200.0, -628.0, -124.0, -100.0, -148.0, -10.0, -676.0, -160.0, 200.0, 200.0, 92.0, 20.0, -586.0, 200.0, 164.0, -904.0, 200.0, -508.0, 200.0, -736.0, 200.0, 200.0, 200.0, 200.0, -130.0, 122.0, 200.0, -394.0, -436.0, 38.0, -400.0, -136.0, 194.0, -172.0, 26.0, 200.0, 170.0, 188.0, -40.0, -34.0, 134.0, 200.0, 74.0, 200.0, 152.0, 188.0, 62.0, 200.0, 200.0, 200.0, 182.0, 200.0, 200.0, -418.0, -292.0, -166.0, 86.0, -118.0, 170.0, 200.0, 92.0, 200.0, -4.0, 146.0, -268.0, 152.0, -40.0, 20.0, 56.0, 200.0, 200.0, -58.0, 26.0, 188.0, 200.0, 122.0, 200.0, 200.0, 200.0, -958.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, -214.0, -442.0, 194.0, -514.0, 140.0, 200.0, -640.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1571.0, -1307.0, -1560.0, 57.0, 57.0, -1571.0, 200.0, -1318.0, -394.0, -350.0, -438.0, -185.0, -1406.0, -460.0, 200.0, 200.0, 2.0, -130.0, -1241.0, 200.0, 134.0, -1824.0, 200.0, -1098.0, 200.0, -1516.0, 200.0, 200.0, 200.0, 200.0, -405.0, 57.0, 200.0, -889.0, -966.0, -97.0, -900.0, -416.0, 189.0, -482.0, -119.0, 200.0, 145.0, 178.0, -240.0, -229.0, 79.0, 200.0, -31.0, 200.0, 112.0, 178.0, -53.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, -933.0, -702.0, -471.0, -9.0, -383.0, 145.0, 200.0, 2.0, 200.0, -174.0, 101.0, -658.0, 112.0, -240.0, -130.0, -64.0, 200.0, 200.0, -273.0, -119.0, 178.0, 200.0, 57.0, 200.0, 200.0, 200.0, -1923.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, -559.0, -977.0, 189.0, -1109.0, 90.0, 200.0, -1340.0, 200.0], "policy_predator_policy_reward": [805.0, 685.0, 800.0, 65.0, 65.0, 805.0, 0.0, 690.0, 270.0, 250.0, 290.0, 175.0, 730.0, 300.0, 0.0, 0.0, 90.0, 150.0, 655.0, 0.0, 30.0, 920.0, 0.0, 590.0, 0.0, 780.0, 0.0, 0.0, 0.0, 0.0, 275.0, 65.0, 0.0, 495.0, 530.0, 135.0, 500.0, 280.0, 5.0, 310.0, 145.0, 0.0, 25.0, 10.0, 200.0, 195.0, 55.0, 0.0, 105.0, 0.0, 40.0, 10.0, 115.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 515.0, 410.0, 305.0, 95.0, 265.0, 25.0, 0.0, 90.0, 0.0, 170.0, 45.0, 390.0, 40.0, 200.0, 150.0, 120.0, 0.0, 0.0, 215.0, 145.0, 10.0, 0.0, 65.0, 0.0, 0.0, 0.0, 965.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 345.0, 535.0, 5.0, 595.0, 50.0, 0.0, 700.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37462525899049787, "mean_inference_ms": 1.447023767629426, "mean_action_processing_ms": 0.14998115138479273, "mean_env_wait_ms": 0.12044784917801725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028715133666992188, "StateBufferConnector_ms": 0.0022830963134765625, "ViewRequirementAgentConnector_ms": 0.05652928352355957}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": -29.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.1194475273063, "num_env_steps_trained_throughput_per_sec": 173.1194475273063, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 48396.466, "restore_workers_time_ms": 0.058, "training_step_time_ms": 48396.079, "sample_time_ms": 1102.924, "learn_time_ms": 47255.26, "learn_throughput": 84.647, "synch_weights_time_ms": 33.517}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 24, "trial_id": "25fa0_00000", "date": "2024-08-12_13-41-19", "timestamp": 1723484479, "time_this_iter_s": 23.13561987876892, "time_total_s": 818.9144513607025, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 818.9144513607025, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 22.375757575757575, "ram_util_percent": 82.55757575757575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.937119756732136, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.550483945012092, "policy_loss": -0.003706366481249764, "vf_loss": 4.553647229323785, "vf_explained_var": -6.805850813786188e-05, "kl": 0.0036206170452214377, "entropy": 1.1626260325312614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.926601082645357, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.611798182874918, "policy_loss": -0.005697805880239078, "vf_loss": 4.616454969346523, "vf_explained_var": 0.008978570935626824, "kl": 0.009253528868327976, "entropy": 1.3907377836604913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 3.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": -160.69, "predator_policy": 163.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.0, 200.0, 164.0, -904.0, 200.0, -508.0, 200.0, -736.0, 200.0, 200.0, 200.0, 200.0, -130.0, 122.0, 200.0, -394.0, -436.0, 38.0, -400.0, -136.0, 194.0, -172.0, 26.0, 200.0, 170.0, 188.0, -40.0, -34.0, 134.0, 200.0, 74.0, 200.0, 152.0, 188.0, 62.0, 200.0, 200.0, 200.0, 182.0, 200.0, 200.0, -418.0, -292.0, -166.0, 86.0, -118.0, 170.0, 200.0, 92.0, 200.0, -4.0, 146.0, -268.0, 152.0, -40.0, 20.0, 56.0, 200.0, 200.0, -58.0, 26.0, 188.0, 200.0, 122.0, 200.0, 200.0, 200.0, -958.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, -214.0, -442.0, 194.0, -514.0, 140.0, 200.0, -640.0, 200.0, 200.0, -226.0, 194.0, -802.0, 200.0, -106.0, 146.0, 200.0, 200.0, -850.0, 200.0, 200.0, 176.0, 116.0, -34.0, 20.0, 164.0, -478.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1241.0, 200.0, 134.0, -1824.0, 200.0, -1098.0, 200.0, -1516.0, 200.0, 200.0, 200.0, 200.0, -405.0, 57.0, 200.0, -889.0, -966.0, -97.0, -900.0, -416.0, 189.0, -482.0, -119.0, 200.0, 145.0, 178.0, -240.0, -229.0, 79.0, 200.0, -31.0, 200.0, 112.0, 178.0, -53.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, -933.0, -702.0, -471.0, -9.0, -383.0, 145.0, 200.0, 2.0, 200.0, -174.0, 101.0, -658.0, 112.0, -240.0, -130.0, -64.0, 200.0, 200.0, -273.0, -119.0, 178.0, 200.0, 57.0, 200.0, 200.0, 200.0, -1923.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, -559.0, -977.0, 189.0, -1109.0, 90.0, 200.0, -1340.0, 200.0, 200.0, -581.0, 189.0, -1637.0, 200.0, -361.0, 101.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 156.0, 46.0, -229.0, -130.0, 134.0, -1043.0], "policy_predator_policy_reward": [655.0, 0.0, 30.0, 920.0, 0.0, 590.0, 0.0, 780.0, 0.0, 0.0, 0.0, 0.0, 275.0, 65.0, 0.0, 495.0, 530.0, 135.0, 500.0, 280.0, 5.0, 310.0, 145.0, 0.0, 25.0, 10.0, 200.0, 195.0, 55.0, 0.0, 105.0, 0.0, 40.0, 10.0, 115.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 515.0, 410.0, 305.0, 95.0, 265.0, 25.0, 0.0, 90.0, 0.0, 170.0, 45.0, 390.0, 40.0, 200.0, 150.0, 120.0, 0.0, 0.0, 215.0, 145.0, 10.0, 0.0, 65.0, 0.0, 0.0, 0.0, 965.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 345.0, 535.0, 5.0, 595.0, 50.0, 0.0, 700.0, 0.0, 0.0, 355.0, 5.0, 835.0, 0.0, 255.0, 45.0, 0.0, 0.0, 875.0, 0.0, 0.0, 20.0, 70.0, 195.0, 150.0, 30.0, 565.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37253269309291553, "mean_inference_ms": 1.4381187714845014, "mean_action_processing_ms": 0.14922634142417418, "mean_env_wait_ms": 0.11977441629984381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002848029136657715, "StateBufferConnector_ms": 0.0022628307342529297, "ViewRequirementAgentConnector_ms": 0.052486300468444824}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 3.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 168.52747147749196, "num_env_steps_trained_throughput_per_sec": 168.52747147749196, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 48408.583, "restore_workers_time_ms": 0.057, "training_step_time_ms": 48408.196, "sample_time_ms": 1103.058, "learn_time_ms": 47267.703, "learn_throughput": 84.624, "synch_weights_time_ms": 32.875}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 25, "trial_id": "25fa0_00000", "date": "2024-08-12_13-41-43", "timestamp": 1723484503, "time_this_iter_s": 23.76905083656311, "time_total_s": 842.6835021972656, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 842.6835021972656, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.81470588235294, "ram_util_percent": 82.96470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9705267630672704, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.461435445646445, "policy_loss": -0.007976309743632252, "vf_loss": 6.468767619132995, "vf_explained_var": 3.709656496842702e-05, "kl": 0.008588680435709574, "entropy": 1.1296778141210477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.384578336123377, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.4917953059077265, "policy_loss": -0.004002516202793534, "vf_loss": 6.49532571285963, "vf_explained_var": 0.00595395527780056, "kl": 0.004196497617917402, "entropy": 1.3387862333407006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -982.0, "episode_reward_mean": -32.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": -226.25, "predator_policy": 193.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.0, -136.0, 194.0, -172.0, 26.0, 200.0, 170.0, 188.0, -40.0, -34.0, 134.0, 200.0, 74.0, 200.0, 152.0, 188.0, 62.0, 200.0, 200.0, 200.0, 182.0, 200.0, 200.0, -418.0, -292.0, -166.0, 86.0, -118.0, 170.0, 200.0, 92.0, 200.0, -4.0, 146.0, -268.0, 152.0, -40.0, 20.0, 56.0, 200.0, 200.0, -58.0, 26.0, 188.0, 200.0, 122.0, 200.0, 200.0, 200.0, -958.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, -214.0, -442.0, 194.0, -514.0, 140.0, 200.0, -640.0, 200.0, 200.0, -226.0, 194.0, -802.0, 200.0, -106.0, 146.0, 200.0, 200.0, -850.0, 200.0, 200.0, 176.0, 116.0, -34.0, 20.0, 164.0, -478.0, -346.0, 92.0, 2.0, 68.0, -778.0, -94.0, -982.0, -904.0, 200.0, -568.0, 200.0, 80.0, -664.0, -724.0, 200.0, -430.0, -898.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-900.0, -416.0, 189.0, -482.0, -119.0, 200.0, 145.0, 178.0, -240.0, -229.0, 79.0, 200.0, -31.0, 200.0, 112.0, 178.0, -53.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, -933.0, -702.0, -471.0, -9.0, -383.0, 145.0, 200.0, 2.0, 200.0, -174.0, 101.0, -658.0, 112.0, -240.0, -130.0, -64.0, 200.0, 200.0, -273.0, -119.0, 178.0, 200.0, 57.0, 200.0, 200.0, 200.0, -1923.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, -559.0, -977.0, 189.0, -1109.0, 90.0, 200.0, -1340.0, 200.0, 200.0, -581.0, 189.0, -1637.0, 200.0, -361.0, 101.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 156.0, 46.0, -229.0, -130.0, 134.0, -1043.0, -801.0, 2.0, -163.0, -42.0, -1593.0, -339.0, -1967.0, -1824.0, 200.0, -1208.0, 200.0, -20.0, -1384.0, -1494.0, 200.0, -955.0, -1813.0, 200.0], "policy_predator_policy_reward": [500.0, 280.0, 5.0, 310.0, 145.0, 0.0, 25.0, 10.0, 200.0, 195.0, 55.0, 0.0, 105.0, 0.0, 40.0, 10.0, 115.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 515.0, 410.0, 305.0, 95.0, 265.0, 25.0, 0.0, 90.0, 0.0, 170.0, 45.0, 390.0, 40.0, 200.0, 150.0, 120.0, 0.0, 0.0, 215.0, 145.0, 10.0, 0.0, 65.0, 0.0, 0.0, 0.0, 965.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 345.0, 535.0, 5.0, 595.0, 50.0, 0.0, 700.0, 0.0, 0.0, 355.0, 5.0, 835.0, 0.0, 255.0, 45.0, 0.0, 0.0, 875.0, 0.0, 0.0, 20.0, 70.0, 195.0, 150.0, 30.0, 565.0, 455.0, 90.0, 165.0, 110.0, 815.0, 245.0, 985.0, 920.0, 0.0, 640.0, 0.0, 100.0, 720.0, 770.0, 0.0, 525.0, 915.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3701808375566246, "mean_inference_ms": 1.428409028544494, "mean_action_processing_ms": 0.1483780964196458, "mean_env_wait_ms": 0.11897881245448726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027539730072021484, "StateBufferConnector_ms": 0.0022379159927368164, "ViewRequirementAgentConnector_ms": 0.05115151405334473}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -982.0, "episode_return_mean": -32.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.46436036972378, "num_env_steps_trained_throughput_per_sec": 171.46436036972378, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 48128.926, "restore_workers_time_ms": 0.056, "training_step_time_ms": 48128.527, "sample_time_ms": 1094.742, "learn_time_ms": 46999.85, "learn_throughput": 85.107, "synch_weights_time_ms": 30.292}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 26, "trial_id": "25fa0_00000", "date": "2024-08-12_13-42-07", "timestamp": 1723484527, "time_this_iter_s": 23.374722003936768, "time_total_s": 866.0582242012024, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a484da60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 866.0582242012024, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 22.924242424242422, "ram_util_percent": 82.87272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9384461342512319, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.858697640399138, "policy_loss": -0.012496506218546225, "vf_loss": 8.869903993606567, "vf_explained_var": 8.666813373565674e-05, "kl": 0.017201306077253283, "entropy": 1.174147645259897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3175659061409535, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.878665519257387, "policy_loss": -0.00914213367116948, "vf_loss": 8.886912013590337, "vf_explained_var": 0.0019483905906478563, "kl": 0.01592199071876961, "entropy": 1.3506660067786773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -982.0, "episode_reward_mean": -157.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": -454.61, "predator_policy": 297.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -418.0, -292.0, -166.0, 86.0, -118.0, 170.0, 200.0, 92.0, 200.0, -4.0, 146.0, -268.0, 152.0, -40.0, 20.0, 56.0, 200.0, 200.0, -58.0, 26.0, 188.0, 200.0, 122.0, 200.0, 200.0, 200.0, -958.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, -214.0, -442.0, 194.0, -514.0, 140.0, 200.0, -640.0, 200.0, 200.0, -226.0, 194.0, -802.0, 200.0, -106.0, 146.0, 200.0, 200.0, -850.0, 200.0, 200.0, 176.0, 116.0, -34.0, 20.0, 164.0, -478.0, -346.0, 92.0, 2.0, 68.0, -778.0, -94.0, -982.0, -904.0, 200.0, -568.0, 200.0, 80.0, -664.0, -724.0, 200.0, -430.0, -898.0, 200.0, 74.0, -754.0, -22.0, 26.0, -490.0, -706.0, 200.0, -682.0, -382.0, -580.0, -658.0, -532.0, -808.0, -724.0, -202.0, -814.0, -700.0, -694.0, -178.0, -700.0, -514.0, -628.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -933.0, -702.0, -471.0, -9.0, -383.0, 145.0, 200.0, 2.0, 200.0, -174.0, 101.0, -658.0, 112.0, -240.0, -130.0, -64.0, 200.0, 200.0, -273.0, -119.0, 178.0, 200.0, 57.0, 200.0, 200.0, 200.0, -1923.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, -559.0, -977.0, 189.0, -1109.0, 90.0, 200.0, -1340.0, 200.0, 200.0, -581.0, 189.0, -1637.0, 200.0, -361.0, 101.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 156.0, 46.0, -229.0, -130.0, 134.0, -1043.0, -801.0, 2.0, -163.0, -42.0, -1593.0, -339.0, -1967.0, -1824.0, 200.0, -1208.0, 200.0, -20.0, -1384.0, -1494.0, 200.0, -955.0, -1813.0, 200.0, -31.0, -1549.0, -207.0, -119.0, -1065.0, -1461.0, 200.0, -1417.0, -867.0, -1230.0, -1373.0, -1142.0, -1648.0, -1494.0, -537.0, -1659.0, -1450.0, -1439.0, -493.0, -1450.0, -1109.0, -1318.0], "policy_predator_policy_reward": [0.0, 515.0, 410.0, 305.0, 95.0, 265.0, 25.0, 0.0, 90.0, 0.0, 170.0, 45.0, 390.0, 40.0, 200.0, 150.0, 120.0, 0.0, 0.0, 215.0, 145.0, 10.0, 0.0, 65.0, 0.0, 0.0, 0.0, 965.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 345.0, 535.0, 5.0, 595.0, 50.0, 0.0, 700.0, 0.0, 0.0, 355.0, 5.0, 835.0, 0.0, 255.0, 45.0, 0.0, 0.0, 875.0, 0.0, 0.0, 20.0, 70.0, 195.0, 150.0, 30.0, 565.0, 455.0, 90.0, 165.0, 110.0, 815.0, 245.0, 985.0, 920.0, 0.0, 640.0, 0.0, 100.0, 720.0, 770.0, 0.0, 525.0, 915.0, 0.0, 105.0, 795.0, 185.0, 145.0, 575.0, 755.0, 0.0, 735.0, 485.0, 650.0, 715.0, 610.0, 840.0, 770.0, 335.0, 845.0, 750.0, 745.0, 315.0, 750.0, 595.0, 690.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3684805681097998, "mean_inference_ms": 1.4225827389132388, "mean_action_processing_ms": 0.14791398694310742, "mean_env_wait_ms": 0.11854137598384519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026673078536987305, "StateBufferConnector_ms": 0.002191901206970215, "ViewRequirementAgentConnector_ms": 0.049411654472351074}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -982.0, "episode_return_mean": -157.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.54155776497447, "num_env_steps_trained_throughput_per_sec": 173.54155776497447, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 24138.153, "restore_workers_time_ms": 0.051, "training_step_time_ms": 24137.762, "sample_time_ms": 906.203, "learn_time_ms": 23206.158, "learn_throughput": 172.368, "synch_weights_time_ms": 22.449}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 27, "trial_id": "25fa0_00000", "date": "2024-08-12_13-42-30", "timestamp": 1723484550, "time_this_iter_s": 23.09837007522583, "time_total_s": 889.1565942764282, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a484daf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 889.1565942764282, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 22.106060606060606, "ram_util_percent": 83.1969696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9369728253999104, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.325897721449534, "policy_loss": -0.007789779885691435, "vf_loss": 9.332776816685994, "vf_explained_var": 4.893578588962555e-05, "kl": 0.012140657313514864, "entropy": 1.1259880118072032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7360605811700225, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.340188082059225, "policy_loss": -0.007960534475569148, "vf_loss": 9.347534084320069, "vf_explained_var": 0.001067476657529672, "kl": 0.01092544135970345, "entropy": 1.3433255825191737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -982.0, "episode_reward_mean": -280.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": -681.21, "predator_policy": 400.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.0, 200.0, 200.0, 200.0, -958.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, -214.0, -442.0, 194.0, -514.0, 140.0, 200.0, -640.0, 200.0, 200.0, -226.0, 194.0, -802.0, 200.0, -106.0, 146.0, 200.0, 200.0, -850.0, 200.0, 200.0, 176.0, 116.0, -34.0, 20.0, 164.0, -478.0, -346.0, 92.0, 2.0, 68.0, -778.0, -94.0, -982.0, -904.0, 200.0, -568.0, 200.0, 80.0, -664.0, -724.0, 200.0, -430.0, -898.0, 200.0, 74.0, -754.0, -22.0, 26.0, -490.0, -706.0, 200.0, -682.0, -382.0, -580.0, -658.0, -532.0, -808.0, -724.0, -202.0, -814.0, -700.0, -694.0, -178.0, -700.0, -514.0, -628.0, -958.0, -550.0, -406.0, -604.0, -478.0, -364.0, -724.0, -556.0, -820.0, -532.0, -694.0, 170.0, -490.0, -268.0, -160.0, -856.0, -694.0, 200.0, -640.0, -118.0, -790.0, -514.0, -742.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [57.0, 200.0, 200.0, 200.0, -1923.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, -559.0, -977.0, 189.0, -1109.0, 90.0, 200.0, -1340.0, 200.0, 200.0, -581.0, 189.0, -1637.0, 200.0, -361.0, 101.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 156.0, 46.0, -229.0, -130.0, 134.0, -1043.0, -801.0, 2.0, -163.0, -42.0, -1593.0, -339.0, -1967.0, -1824.0, 200.0, -1208.0, 200.0, -20.0, -1384.0, -1494.0, 200.0, -955.0, -1813.0, 200.0, -31.0, -1549.0, -207.0, -119.0, -1065.0, -1461.0, 200.0, -1417.0, -867.0, -1230.0, -1373.0, -1142.0, -1648.0, -1494.0, -537.0, -1659.0, -1450.0, -1439.0, -493.0, -1450.0, -1109.0, -1318.0, -1923.0, -1175.0, -911.0, -1274.0, -1043.0, -834.0, -1494.0, -1186.0, -1670.0, -1142.0, -1439.0, 145.0, -1065.0, -658.0, -460.0, -1736.0, -1439.0, 200.0, -1340.0, -383.0, -1615.0, -1109.0, -1527.0], "policy_predator_policy_reward": [65.0, 0.0, 0.0, 0.0, 965.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 345.0, 535.0, 5.0, 595.0, 50.0, 0.0, 700.0, 0.0, 0.0, 355.0, 5.0, 835.0, 0.0, 255.0, 45.0, 0.0, 0.0, 875.0, 0.0, 0.0, 20.0, 70.0, 195.0, 150.0, 30.0, 565.0, 455.0, 90.0, 165.0, 110.0, 815.0, 245.0, 985.0, 920.0, 0.0, 640.0, 0.0, 100.0, 720.0, 770.0, 0.0, 525.0, 915.0, 0.0, 105.0, 795.0, 185.0, 145.0, 575.0, 755.0, 0.0, 735.0, 485.0, 650.0, 715.0, 610.0, 840.0, 770.0, 335.0, 845.0, 750.0, 745.0, 315.0, 750.0, 595.0, 690.0, 965.0, 625.0, 505.0, 670.0, 565.0, 470.0, 770.0, 630.0, 850.0, 610.0, 745.0, 25.0, 575.0, 390.0, 300.0, 880.0, 745.0, 0.0, 700.0, 265.0, 825.0, 595.0, 785.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3644542436981517, "mean_inference_ms": 1.404894899558211, "mean_action_processing_ms": 0.14625189740541764, "mean_env_wait_ms": 0.11686823699801696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002377152442932129, "StateBufferConnector_ms": 0.002045869827270508, "ViewRequirementAgentConnector_ms": 0.04668629169464111}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -982.0, "episode_return_mean": -280.66, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.92614495502355, "num_env_steps_trained_throughput_per_sec": 171.92614495502355, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 24012.963, "restore_workers_time_ms": 0.051, "training_step_time_ms": 24012.571, "sample_time_ms": 878.053, "learn_time_ms": 23109.157, "learn_throughput": 173.092, "synch_weights_time_ms": 22.277}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 28, "trial_id": "25fa0_00000", "date": "2024-08-12_13-42-53", "timestamp": 1723484573, "time_this_iter_s": 23.319726943969727, "time_total_s": 912.476321220398, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 912.476321220398, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 22.406060606060606, "ram_util_percent": 83.26969696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1239906491090854, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.562467797597249, "policy_loss": -0.006778271409954565, "vf_loss": 9.568628350893656, "vf_explained_var": 4.716416200002034e-05, "kl": 0.008236365969760812, "entropy": 1.1691120235870283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.467870750837028, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.565946552157403, "policy_loss": -0.012015012914829034, "vf_loss": 9.576870862642924, "vf_explained_var": 0.0010484262680013974, "kl": 0.019390262418856163, "entropy": 1.3650001271317402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -982.0, "episode_reward_mean": -382.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": -867.66, "predator_policy": 485.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, -226.0, 194.0, -802.0, 200.0, -106.0, 146.0, 200.0, 200.0, -850.0, 200.0, 200.0, 176.0, 116.0, -34.0, 20.0, 164.0, -478.0, -346.0, 92.0, 2.0, 68.0, -778.0, -94.0, -982.0, -904.0, 200.0, -568.0, 200.0, 80.0, -664.0, -724.0, 200.0, -430.0, -898.0, 200.0, 74.0, -754.0, -22.0, 26.0, -490.0, -706.0, 200.0, -682.0, -382.0, -580.0, -658.0, -532.0, -808.0, -724.0, -202.0, -814.0, -700.0, -694.0, -178.0, -700.0, -514.0, -628.0, -958.0, -550.0, -406.0, -604.0, -478.0, -364.0, -724.0, -556.0, -820.0, -532.0, -694.0, 170.0, -490.0, -268.0, -160.0, -856.0, -694.0, 200.0, -640.0, -118.0, -790.0, -514.0, -742.0, -556.0, -124.0, -190.0, -592.0, -394.0, -52.0, -604.0, -532.0, -970.0, -826.0, -862.0, -454.0, -670.0, -946.0, -472.0, -724.0, -892.0, -694.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -581.0, 189.0, -1637.0, 200.0, -361.0, 101.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 156.0, 46.0, -229.0, -130.0, 134.0, -1043.0, -801.0, 2.0, -163.0, -42.0, -1593.0, -339.0, -1967.0, -1824.0, 200.0, -1208.0, 200.0, -20.0, -1384.0, -1494.0, 200.0, -955.0, -1813.0, 200.0, -31.0, -1549.0, -207.0, -119.0, -1065.0, -1461.0, 200.0, -1417.0, -867.0, -1230.0, -1373.0, -1142.0, -1648.0, -1494.0, -537.0, -1659.0, -1450.0, -1439.0, -493.0, -1450.0, -1109.0, -1318.0, -1923.0, -1175.0, -911.0, -1274.0, -1043.0, -834.0, -1494.0, -1186.0, -1670.0, -1142.0, -1439.0, 145.0, -1065.0, -658.0, -460.0, -1736.0, -1439.0, 200.0, -1340.0, -383.0, -1615.0, -1109.0, -1527.0, -1186.0, -394.0, -515.0, -1252.0, -889.0, -262.0, -1274.0, -1142.0, -1945.0, -1681.0, -1747.0, -999.0, -1395.0, -1901.0, -1032.0, -1494.0, -1802.0, -1439.0], "policy_predator_policy_reward": [0.0, 0.0, 355.0, 5.0, 835.0, 0.0, 255.0, 45.0, 0.0, 0.0, 875.0, 0.0, 0.0, 20.0, 70.0, 195.0, 150.0, 30.0, 565.0, 455.0, 90.0, 165.0, 110.0, 815.0, 245.0, 985.0, 920.0, 0.0, 640.0, 0.0, 100.0, 720.0, 770.0, 0.0, 525.0, 915.0, 0.0, 105.0, 795.0, 185.0, 145.0, 575.0, 755.0, 0.0, 735.0, 485.0, 650.0, 715.0, 610.0, 840.0, 770.0, 335.0, 845.0, 750.0, 745.0, 315.0, 750.0, 595.0, 690.0, 965.0, 625.0, 505.0, 670.0, 565.0, 470.0, 770.0, 630.0, 850.0, 610.0, 745.0, 25.0, 575.0, 390.0, 300.0, 880.0, 745.0, 0.0, 700.0, 265.0, 825.0, 595.0, 785.0, 630.0, 270.0, 325.0, 660.0, 495.0, 210.0, 670.0, 610.0, 975.0, 855.0, 885.0, 545.0, 725.0, 955.0, 560.0, 770.0, 910.0, 745.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3623146404747469, "mean_inference_ms": 1.3960387461527983, "mean_action_processing_ms": 0.14543186338117736, "mean_env_wait_ms": 0.11611590776708612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023311376571655273, "StateBufferConnector_ms": 0.0020307302474975586, "ViewRequirementAgentConnector_ms": 0.04774653911590576}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -982.0, "episode_return_mean": -382.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.66699046305297, "num_env_steps_trained_throughput_per_sec": 171.66699046305297, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 24003.204, "restore_workers_time_ms": 0.051, "training_step_time_ms": 24002.773, "sample_time_ms": 859.679, "learn_time_ms": 23118.141, "learn_throughput": 173.024, "synch_weights_time_ms": 21.763}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "training_iteration": 29, "trial_id": "25fa0_00000", "date": "2024-08-12_13-43-17", "timestamp": 1723484597, "time_this_iter_s": 23.34148097038269, "time_total_s": 935.8178021907806, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 935.8178021907806, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.187878787878788, "ram_util_percent": 83.39090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0358936918899417, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4710720350344975, "policy_loss": -0.002045797018702918, "vf_loss": 7.47291623800993, "vf_explained_var": -0.00012141143282254538, "kl": 0.002687505297776449, "entropy": 1.1984099958091974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.250394582624237, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.568117981652419, "policy_loss": -0.01478779768270518, "vf_loss": 7.581747594475746, "vf_explained_var": 0.004306950295964877, "kl": 0.02058966398722679, "entropy": 1.3445319578051567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -982.0, "episode_reward_mean": -457.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": -1006.26, "predator_policy": 548.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-478.0, -346.0, 92.0, 2.0, 68.0, -778.0, -94.0, -982.0, -904.0, 200.0, -568.0, 200.0, 80.0, -664.0, -724.0, 200.0, -430.0, -898.0, 200.0, 74.0, -754.0, -22.0, 26.0, -490.0, -706.0, 200.0, -682.0, -382.0, -580.0, -658.0, -532.0, -808.0, -724.0, -202.0, -814.0, -700.0, -694.0, -178.0, -700.0, -514.0, -628.0, -958.0, -550.0, -406.0, -604.0, -478.0, -364.0, -724.0, -556.0, -820.0, -532.0, -694.0, 170.0, -490.0, -268.0, -160.0, -856.0, -694.0, 200.0, -640.0, -118.0, -790.0, -514.0, -742.0, -556.0, -124.0, -190.0, -592.0, -394.0, -52.0, -604.0, -532.0, -970.0, -826.0, -862.0, -454.0, -670.0, -946.0, -472.0, -724.0, -892.0, -694.0, -568.0, 56.0, -424.0, -760.0, -406.0, 200.0, -802.0, 44.0, -568.0, -754.0, -682.0, -874.0, 146.0, -694.0, -568.0, -58.0, -286.0, -364.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1043.0, -801.0, 2.0, -163.0, -42.0, -1593.0, -339.0, -1967.0, -1824.0, 200.0, -1208.0, 200.0, -20.0, -1384.0, -1494.0, 200.0, -955.0, -1813.0, 200.0, -31.0, -1549.0, -207.0, -119.0, -1065.0, -1461.0, 200.0, -1417.0, -867.0, -1230.0, -1373.0, -1142.0, -1648.0, -1494.0, -537.0, -1659.0, -1450.0, -1439.0, -493.0, -1450.0, -1109.0, -1318.0, -1923.0, -1175.0, -911.0, -1274.0, -1043.0, -834.0, -1494.0, -1186.0, -1670.0, -1142.0, -1439.0, 145.0, -1065.0, -658.0, -460.0, -1736.0, -1439.0, 200.0, -1340.0, -383.0, -1615.0, -1109.0, -1527.0, -1186.0, -394.0, -515.0, -1252.0, -889.0, -262.0, -1274.0, -1142.0, -1945.0, -1681.0, -1747.0, -999.0, -1395.0, -1901.0, -1032.0, -1494.0, -1802.0, -1439.0, -1208.0, -64.0, -944.0, -1560.0, -911.0, 200.0, -1637.0, -86.0, -1208.0, -1549.0, -1417.0, -1769.0, 101.0, -1439.0, -1208.0, -273.0, -691.0, -834.0], "policy_predator_policy_reward": [565.0, 455.0, 90.0, 165.0, 110.0, 815.0, 245.0, 985.0, 920.0, 0.0, 640.0, 0.0, 100.0, 720.0, 770.0, 0.0, 525.0, 915.0, 0.0, 105.0, 795.0, 185.0, 145.0, 575.0, 755.0, 0.0, 735.0, 485.0, 650.0, 715.0, 610.0, 840.0, 770.0, 335.0, 845.0, 750.0, 745.0, 315.0, 750.0, 595.0, 690.0, 965.0, 625.0, 505.0, 670.0, 565.0, 470.0, 770.0, 630.0, 850.0, 610.0, 745.0, 25.0, 575.0, 390.0, 300.0, 880.0, 745.0, 0.0, 700.0, 265.0, 825.0, 595.0, 785.0, 630.0, 270.0, 325.0, 660.0, 495.0, 210.0, 670.0, 610.0, 975.0, 855.0, 885.0, 545.0, 725.0, 955.0, 560.0, 770.0, 910.0, 745.0, 640.0, 120.0, 520.0, 800.0, 505.0, 0.0, 835.0, 130.0, 640.0, 795.0, 735.0, 895.0, 45.0, 745.0, 640.0, 215.0, 405.0, 470.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36031297742460155, "mean_inference_ms": 1.3875982894259322, "mean_action_processing_ms": 0.14468383543267913, "mean_env_wait_ms": 0.11542031420325437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0023458003997802734, "StateBufferConnector_ms": 0.0020492076873779297, "ViewRequirementAgentConnector_ms": 0.04797220230102539}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -982.0, "episode_return_mean": -457.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.5234258180466, "num_env_steps_trained_throughput_per_sec": 172.5234258180466, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 23672.087, "restore_workers_time_ms": 0.037, "training_step_time_ms": 23671.685, "sample_time_ms": 851.135, "learn_time_ms": 22797.583, "learn_throughput": 175.457, "synch_weights_time_ms": 20.655}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 30, "trial_id": "25fa0_00000", "date": "2024-08-12_13-43-40", "timestamp": 1723484620, "time_this_iter_s": 23.24112892150879, "time_total_s": 959.0589311122894, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 959.0589311122894, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 22.503030303030307, "ram_util_percent": 83.37878787878788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0792646474204957, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3528489396907388, "policy_loss": -0.006232204748569833, "vf_loss": 1.3587900767102838, "vf_explained_var": -0.0001452621693412463, "kl": 0.007761736002023262, "entropy": 1.1763646346827348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.859936870758734, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5629161570376406, "policy_loss": -0.011814027230623953, "vf_loss": 1.5734851744025946, "vf_explained_var": 0.011247546287874381, "kl": 0.014755689052477068, "entropy": 1.3365392328550418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -394.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -890.1, "predator_policy": 495.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 74.0, -754.0, -22.0, 26.0, -490.0, -706.0, 200.0, -682.0, -382.0, -580.0, -658.0, -532.0, -808.0, -724.0, -202.0, -814.0, -700.0, -694.0, -178.0, -700.0, -514.0, -628.0, -958.0, -550.0, -406.0, -604.0, -478.0, -364.0, -724.0, -556.0, -820.0, -532.0, -694.0, 170.0, -490.0, -268.0, -160.0, -856.0, -694.0, 200.0, -640.0, -118.0, -790.0, -514.0, -742.0, -556.0, -124.0, -190.0, -592.0, -394.0, -52.0, -604.0, -532.0, -970.0, -826.0, -862.0, -454.0, -670.0, -946.0, -472.0, -724.0, -892.0, -694.0, -568.0, 56.0, -424.0, -760.0, -406.0, 200.0, -802.0, 44.0, -568.0, -754.0, -682.0, -874.0, 146.0, -694.0, -568.0, -58.0, -286.0, -364.0, -214.0, 200.0, 200.0, 200.0, 200.0, 200.0, -232.0, -100.0, -304.0, 56.0, 44.0, 86.0, 8.0, 176.0, -568.0, 200.0, 200.0, -40.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -31.0, -1549.0, -207.0, -119.0, -1065.0, -1461.0, 200.0, -1417.0, -867.0, -1230.0, -1373.0, -1142.0, -1648.0, -1494.0, -537.0, -1659.0, -1450.0, -1439.0, -493.0, -1450.0, -1109.0, -1318.0, -1923.0, -1175.0, -911.0, -1274.0, -1043.0, -834.0, -1494.0, -1186.0, -1670.0, -1142.0, -1439.0, 145.0, -1065.0, -658.0, -460.0, -1736.0, -1439.0, 200.0, -1340.0, -383.0, -1615.0, -1109.0, -1527.0, -1186.0, -394.0, -515.0, -1252.0, -889.0, -262.0, -1274.0, -1142.0, -1945.0, -1681.0, -1747.0, -999.0, -1395.0, -1901.0, -1032.0, -1494.0, -1802.0, -1439.0, -1208.0, -64.0, -944.0, -1560.0, -911.0, 200.0, -1637.0, -86.0, -1208.0, -1549.0, -1417.0, -1769.0, 101.0, -1439.0, -1208.0, -273.0, -691.0, -834.0, -559.0, 200.0, 200.0, 200.0, 200.0, 200.0, -592.0, -350.0, -724.0, -64.0, -86.0, -9.0, -152.0, 156.0, -1208.0, 200.0, 200.0, -240.0], "policy_predator_policy_reward": [0.0, 105.0, 795.0, 185.0, 145.0, 575.0, 755.0, 0.0, 735.0, 485.0, 650.0, 715.0, 610.0, 840.0, 770.0, 335.0, 845.0, 750.0, 745.0, 315.0, 750.0, 595.0, 690.0, 965.0, 625.0, 505.0, 670.0, 565.0, 470.0, 770.0, 630.0, 850.0, 610.0, 745.0, 25.0, 575.0, 390.0, 300.0, 880.0, 745.0, 0.0, 700.0, 265.0, 825.0, 595.0, 785.0, 630.0, 270.0, 325.0, 660.0, 495.0, 210.0, 670.0, 610.0, 975.0, 855.0, 885.0, 545.0, 725.0, 955.0, 560.0, 770.0, 910.0, 745.0, 640.0, 120.0, 520.0, 800.0, 505.0, 0.0, 835.0, 130.0, 640.0, 795.0, 735.0, 895.0, 45.0, 745.0, 640.0, 215.0, 405.0, 470.0, 345.0, 0.0, 0.0, 0.0, 0.0, 0.0, 360.0, 250.0, 420.0, 120.0, 130.0, 95.0, 160.0, 20.0, 640.0, 0.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35849020459780734, "mean_inference_ms": 1.3803148215779868, "mean_action_processing_ms": 0.14404543112246515, "mean_env_wait_ms": 0.1148925103340699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024895668029785156, "StateBufferConnector_ms": 0.002035975456237793, "ViewRequirementAgentConnector_ms": 0.05039358139038086}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -394.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.79164171011635, "num_env_steps_trained_throughput_per_sec": 160.79164171011635, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 23479.868, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23479.479, "sample_time_ms": 841.909, "learn_time_ms": 22613.314, "learn_throughput": 176.887, "synch_weights_time_ms": 21.932}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "training_iteration": 31, "trial_id": "25fa0_00000", "date": "2024-08-12_13-44-05", "timestamp": 1723484645, "time_this_iter_s": 24.903696060180664, "time_total_s": 983.9626271724701, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4895940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 983.9626271724701, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 28.616666666666674, "ram_util_percent": 82.83611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9763231799394513, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.42561238119378686, "policy_loss": -0.011333163983848257, "vf_loss": 0.43660643104509517, "vf_explained_var": 0.0016868343576788903, "kl": 0.009043037619509708, "entropy": 1.1462017855296531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.744756286342938, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6022367147083666, "policy_loss": -0.010508307429457393, "vf_loss": 0.6115046187109935, "vf_explained_var": 0.021197684792180857, "kl": 0.014701067993701144, "entropy": 1.335382890328765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -217.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -565.82, "predator_policy": 348.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-478.0, -364.0, -724.0, -556.0, -820.0, -532.0, -694.0, 170.0, -490.0, -268.0, -160.0, -856.0, -694.0, 200.0, -640.0, -118.0, -790.0, -514.0, -742.0, -556.0, -124.0, -190.0, -592.0, -394.0, -52.0, -604.0, -532.0, -970.0, -826.0, -862.0, -454.0, -670.0, -946.0, -472.0, -724.0, -892.0, -694.0, -568.0, 56.0, -424.0, -760.0, -406.0, 200.0, -802.0, 44.0, -568.0, -754.0, -682.0, -874.0, 146.0, -694.0, -568.0, -58.0, -286.0, -364.0, -214.0, 200.0, 200.0, 200.0, 200.0, 200.0, -232.0, -100.0, -304.0, 56.0, 44.0, 86.0, 8.0, 176.0, -568.0, 200.0, 200.0, -40.0, 200.0, 200.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 194.0, 50.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 164.0, 140.0, 50.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1043.0, -834.0, -1494.0, -1186.0, -1670.0, -1142.0, -1439.0, 145.0, -1065.0, -658.0, -460.0, -1736.0, -1439.0, 200.0, -1340.0, -383.0, -1615.0, -1109.0, -1527.0, -1186.0, -394.0, -515.0, -1252.0, -889.0, -262.0, -1274.0, -1142.0, -1945.0, -1681.0, -1747.0, -999.0, -1395.0, -1901.0, -1032.0, -1494.0, -1802.0, -1439.0, -1208.0, -64.0, -944.0, -1560.0, -911.0, 200.0, -1637.0, -86.0, -1208.0, -1549.0, -1417.0, -1769.0, 101.0, -1439.0, -1208.0, -273.0, -691.0, -834.0, -559.0, 200.0, 200.0, 200.0, 200.0, 200.0, -592.0, -350.0, -724.0, -64.0, -86.0, -9.0, -152.0, 156.0, -1208.0, 200.0, 200.0, -240.0, 200.0, 200.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 189.0, -75.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 134.0, 90.0, -75.0, 200.0, 200.0], "policy_predator_policy_reward": [565.0, 470.0, 770.0, 630.0, 850.0, 610.0, 745.0, 25.0, 575.0, 390.0, 300.0, 880.0, 745.0, 0.0, 700.0, 265.0, 825.0, 595.0, 785.0, 630.0, 270.0, 325.0, 660.0, 495.0, 210.0, 670.0, 610.0, 975.0, 855.0, 885.0, 545.0, 725.0, 955.0, 560.0, 770.0, 910.0, 745.0, 640.0, 120.0, 520.0, 800.0, 505.0, 0.0, 835.0, 130.0, 640.0, 795.0, 735.0, 895.0, 45.0, 745.0, 640.0, 215.0, 405.0, 470.0, 345.0, 0.0, 0.0, 0.0, 0.0, 0.0, 360.0, 250.0, 420.0, 120.0, 130.0, 95.0, 160.0, 20.0, 640.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 50.0, 125.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3567850698143147, "mean_inference_ms": 1.3731438746374875, "mean_action_processing_ms": 0.1433622937524393, "mean_env_wait_ms": 0.114374294584563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002782583236694336, "StateBufferConnector_ms": 0.0021871328353881836, "ViewRequirementAgentConnector_ms": 0.05294692516326904}, "num_episodes": 27, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -217.72, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.9981181581886, "num_env_steps_trained_throughput_per_sec": 170.9981181581886, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 23472.963, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23472.801, "sample_time_ms": 841.943, "learn_time_ms": 22606.926, "learn_throughput": 176.937, "synch_weights_time_ms": 21.729}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 32, "trial_id": "25fa0_00000", "date": "2024-08-12_13-44-28", "timestamp": 1723484668, "time_this_iter_s": 23.432827949523926, "time_total_s": 1007.395455121994, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1007.395455121994, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 24.560606060606062, "ram_util_percent": 82.83939393939393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0199585013712447, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6665314135762552, "policy_loss": -0.006863228384948646, "vf_loss": 0.6731247893120137, "vf_explained_var": -8.702818304300308e-05, "kl": 0.007196022313293941, "entropy": 1.1075014928976694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.653814551234245, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.720358931144195, "policy_loss": -0.006181605172362954, "vf_loss": 0.7257001226224626, "vf_explained_var": 0.010712934099137783, "kl": 0.009960462710786789, "entropy": 1.304193678125739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -103.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -357.26, "predator_policy": 253.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742.0, -556.0, -124.0, -190.0, -592.0, -394.0, -52.0, -604.0, -532.0, -970.0, -826.0, -862.0, -454.0, -670.0, -946.0, -472.0, -724.0, -892.0, -694.0, -568.0, 56.0, -424.0, -760.0, -406.0, 200.0, -802.0, 44.0, -568.0, -754.0, -682.0, -874.0, 146.0, -694.0, -568.0, -58.0, -286.0, -364.0, -214.0, 200.0, 200.0, 200.0, 200.0, 200.0, -232.0, -100.0, -304.0, 56.0, 44.0, 86.0, 8.0, 176.0, -568.0, 200.0, 200.0, -40.0, 200.0, 200.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 194.0, 50.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 164.0, 140.0, 50.0, 200.0, 200.0, 200.0, 128.0, 200.0, -10.0, 122.0, 200.0, 200.0, 110.0, 188.0, 200.0, 200.0, 110.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1527.0, -1186.0, -394.0, -515.0, -1252.0, -889.0, -262.0, -1274.0, -1142.0, -1945.0, -1681.0, -1747.0, -999.0, -1395.0, -1901.0, -1032.0, -1494.0, -1802.0, -1439.0, -1208.0, -64.0, -944.0, -1560.0, -911.0, 200.0, -1637.0, -86.0, -1208.0, -1549.0, -1417.0, -1769.0, 101.0, -1439.0, -1208.0, -273.0, -691.0, -834.0, -559.0, 200.0, 200.0, 200.0, 200.0, 200.0, -592.0, -350.0, -724.0, -64.0, -86.0, -9.0, -152.0, 156.0, -1208.0, 200.0, 200.0, -240.0, 200.0, 200.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 189.0, -75.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 134.0, 90.0, -75.0, 200.0, 200.0, 200.0, 68.0, 200.0, -185.0, 57.0, 200.0, 200.0, 35.0, 178.0, 200.0, 200.0, 35.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [785.0, 630.0, 270.0, 325.0, 660.0, 495.0, 210.0, 670.0, 610.0, 975.0, 855.0, 885.0, 545.0, 725.0, 955.0, 560.0, 770.0, 910.0, 745.0, 640.0, 120.0, 520.0, 800.0, 505.0, 0.0, 835.0, 130.0, 640.0, 795.0, 735.0, 895.0, 45.0, 745.0, 640.0, 215.0, 405.0, 470.0, 345.0, 0.0, 0.0, 0.0, 0.0, 0.0, 360.0, 250.0, 420.0, 120.0, 130.0, 95.0, 160.0, 20.0, 640.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 50.0, 125.0, 0.0, 0.0, 0.0, 60.0, 0.0, 175.0, 65.0, 0.0, 0.0, 75.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35484120841718714, "mean_inference_ms": 1.365631445660452, "mean_action_processing_ms": 0.14269336823432255, "mean_env_wait_ms": 0.11387211153673292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002796769142150879, "StateBufferConnector_ms": 0.002197265625, "ViewRequirementAgentConnector_ms": 0.05449414253234863}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -103.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.0958832018937, "num_env_steps_trained_throughput_per_sec": 172.0958832018937, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 23448.212, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23448.049, "sample_time_ms": 837.241, "learn_time_ms": 22586.901, "learn_throughput": 177.094, "synch_weights_time_ms": 21.622}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 33, "trial_id": "25fa0_00000", "date": "2024-08-12_13-44-52", "timestamp": 1723484692, "time_this_iter_s": 23.28251075744629, "time_total_s": 1030.6779658794403, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4825af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1030.6779658794403, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 22.942424242424238, "ram_util_percent": 82.62727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.101119740617772, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4340359562387069, "policy_loss": -0.0059384003950981425, "vf_loss": 0.4397094166638534, "vf_explained_var": 0.0028554536402225494, "kl": 0.007065026161363998, "entropy": 1.1094736854235332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.770475046957532, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48000171041979534, "policy_loss": -0.011693321853817907, "vf_loss": 0.490258023084607, "vf_explained_var": 0.03170338825633128, "kl": 0.017031211727559295, "entropy": 1.2868865232914686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -874.0, "episode_reward_mean": 31.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1769.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -108.22, "predator_policy": 140.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.0, -568.0, 56.0, -424.0, -760.0, -406.0, 200.0, -802.0, 44.0, -568.0, -754.0, -682.0, -874.0, 146.0, -694.0, -568.0, -58.0, -286.0, -364.0, -214.0, 200.0, 200.0, 200.0, 200.0, 200.0, -232.0, -100.0, -304.0, 56.0, 44.0, 86.0, 8.0, 176.0, -568.0, 200.0, 200.0, -40.0, 200.0, 200.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 194.0, 50.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 164.0, 140.0, 50.0, 200.0, 200.0, 200.0, 128.0, 200.0, -10.0, 122.0, 200.0, 200.0, 110.0, 188.0, 200.0, 200.0, 110.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 116.0, 200.0, 194.0, 200.0, 152.0, 176.0, 200.0, 140.0, 152.0, 80.0, 98.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1439.0, -1208.0, -64.0, -944.0, -1560.0, -911.0, 200.0, -1637.0, -86.0, -1208.0, -1549.0, -1417.0, -1769.0, 101.0, -1439.0, -1208.0, -273.0, -691.0, -834.0, -559.0, 200.0, 200.0, 200.0, 200.0, 200.0, -592.0, -350.0, -724.0, -64.0, -86.0, -9.0, -152.0, 156.0, -1208.0, 200.0, 200.0, -240.0, 200.0, 200.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 189.0, -75.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 134.0, 90.0, -75.0, 200.0, 200.0, 200.0, 68.0, 200.0, -185.0, 57.0, 200.0, 200.0, 35.0, 178.0, 200.0, 200.0, 35.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 46.0, 200.0, 189.0, 200.0, 112.0, 156.0, 200.0, 90.0, 112.0, -20.0, 13.0], "policy_predator_policy_reward": [745.0, 640.0, 120.0, 520.0, 800.0, 505.0, 0.0, 835.0, 130.0, 640.0, 795.0, 735.0, 895.0, 45.0, 745.0, 640.0, 215.0, 405.0, 470.0, 345.0, 0.0, 0.0, 0.0, 0.0, 0.0, 360.0, 250.0, 420.0, 120.0, 130.0, 95.0, 160.0, 20.0, 640.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 50.0, 125.0, 0.0, 0.0, 0.0, 60.0, 0.0, 175.0, 65.0, 0.0, 0.0, 75.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 70.0, 0.0, 5.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 100.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3535780290629971, "mean_inference_ms": 1.360625399947736, "mean_action_processing_ms": 0.1422193281945561, "mean_env_wait_ms": 0.11342820854495918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030536651611328125, "StateBufferConnector_ms": 0.002293705940246582, "ViewRequirementAgentConnector_ms": 0.0540776252746582}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -874.0, "episode_return_mean": 31.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.41945573067485, "num_env_steps_trained_throughput_per_sec": 172.41945573067485, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 23457.592, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23457.431, "sample_time_ms": 838.253, "learn_time_ms": 22597.463, "learn_throughput": 177.011, "synch_weights_time_ms": 19.466}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 34, "trial_id": "25fa0_00000", "date": "2024-08-12_13-45-15", "timestamp": 1723484715, "time_this_iter_s": 23.206127882003784, "time_total_s": 1053.884093761444, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a484d1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1053.884093761444, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 22.442424242424238, "ram_util_percent": 82.53636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0882031436311081, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28052517150063067, "policy_loss": -0.006578174816483321, "vf_loss": 0.2866256868345809, "vf_explained_var": 0.011662568834920724, "kl": 0.012737519871852026, "entropy": 1.1158173866569996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.154069335293025, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3082358178119951, "policy_loss": -0.008699015717381069, "vf_loss": 0.3163108080298116, "vf_explained_var": 0.00953421884526809, "kl": 0.007395849744768257, "entropy": 1.2507355983058612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -568.0, "episode_reward_mean": 137.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1208.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 640.0}, "policy_reward_mean": {"prey_policy": 86.26, "predator_policy": 51.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-364.0, -214.0, 200.0, 200.0, 200.0, 200.0, 200.0, -232.0, -100.0, -304.0, 56.0, 44.0, 86.0, 8.0, 176.0, -568.0, 200.0, 200.0, -40.0, 200.0, 200.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 194.0, 50.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 164.0, 140.0, 50.0, 200.0, 200.0, 200.0, 128.0, 200.0, -10.0, 122.0, 200.0, 200.0, 110.0, 188.0, 200.0, 200.0, 110.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 116.0, 200.0, 194.0, 200.0, 152.0, 176.0, 200.0, 140.0, 152.0, 80.0, 98.0, 158.0, 92.0, 122.0, 146.0, 200.0, 146.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 194.0, 134.0, 158.0, 104.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-834.0, -559.0, 200.0, 200.0, 200.0, 200.0, 200.0, -592.0, -350.0, -724.0, -64.0, -86.0, -9.0, -152.0, 156.0, -1208.0, 200.0, 200.0, -240.0, 200.0, 200.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 189.0, -75.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 134.0, 90.0, -75.0, 200.0, 200.0, 200.0, 68.0, 200.0, -185.0, 57.0, 200.0, 200.0, 35.0, 178.0, 200.0, 200.0, 35.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 46.0, 200.0, 189.0, 200.0, 112.0, 156.0, 200.0, 90.0, 112.0, -20.0, 13.0, 123.0, 2.0, 57.0, 101.0, 200.0, 101.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 189.0, 79.0, 123.0, 24.0, 200.0], "policy_predator_policy_reward": [470.0, 345.0, 0.0, 0.0, 0.0, 0.0, 0.0, 360.0, 250.0, 420.0, 120.0, 130.0, 95.0, 160.0, 20.0, 640.0, 0.0, 0.0, 200.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 50.0, 125.0, 0.0, 0.0, 0.0, 60.0, 0.0, 175.0, 65.0, 0.0, 0.0, 75.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 70.0, 0.0, 5.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 100.0, 85.0, 35.0, 90.0, 65.0, 45.0, 0.0, 45.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 5.0, 55.0, 35.0, 80.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35238059578135167, "mean_inference_ms": 1.355896068087163, "mean_action_processing_ms": 0.14178044179149712, "mean_env_wait_ms": 0.1129553697917882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030629634857177734, "StateBufferConnector_ms": 0.002299666404724121, "ViewRequirementAgentConnector_ms": 0.054097652435302734}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -568.0, "episode_return_mean": 137.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.7447631117734, "num_env_steps_trained_throughput_per_sec": 172.7447631117734, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 23399.646, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23399.491, "sample_time_ms": 839.869, "learn_time_ms": 22538.339, "learn_throughput": 177.475, "synch_weights_time_ms": 19.276}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 35, "trial_id": "25fa0_00000", "date": "2024-08-12_13-45-38", "timestamp": 1723484738, "time_this_iter_s": 23.159965753555298, "time_total_s": 1077.0440595149994, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48951f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1077.0440595149994, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 21.972727272727273, "ram_util_percent": 82.06060606060605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8337293886346743, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3031480989535339, "policy_loss": -0.006469937481354767, "vf_loss": 0.30908570504491845, "vf_explained_var": 0.003346029855310917, "kl": 0.014195400451840682, "entropy": 1.0786961056292057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.749720328239103, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.35229844116923537, "policy_loss": -0.007859931589337066, "vf_loss": 0.3596209467602118, "vf_explained_var": 0.05242052270720402, "kl": 0.006369468612808323, "entropy": 1.2437355807671944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -10.0, "episode_reward_mean": 172.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -185.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 149.62, "predator_policy": 22.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 194.0, 50.0, 200.0, 200.0, 152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 164.0, 140.0, 50.0, 200.0, 200.0, 200.0, 128.0, 200.0, -10.0, 122.0, 200.0, 200.0, 110.0, 188.0, 200.0, 200.0, 110.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 116.0, 200.0, 194.0, 200.0, 152.0, 176.0, 200.0, 140.0, 152.0, 80.0, 98.0, 158.0, 92.0, 122.0, 146.0, 200.0, 146.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 194.0, 134.0, 158.0, 104.0, 200.0, 200.0, 122.0, 200.0, 104.0, 158.0, 200.0, 200.0, 182.0, 200.0, 200.0, 176.0, 62.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 189.0, -75.0, 200.0, 200.0, 112.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 134.0, 90.0, -75.0, 200.0, 200.0, 200.0, 68.0, 200.0, -185.0, 57.0, 200.0, 200.0, 35.0, 178.0, 200.0, 200.0, 35.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 46.0, 200.0, 189.0, 200.0, 112.0, 156.0, 200.0, 90.0, 112.0, -20.0, 13.0, 123.0, 2.0, 57.0, 101.0, 200.0, 101.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 189.0, 79.0, 123.0, 24.0, 200.0, 200.0, 57.0, 200.0, 24.0, 123.0, 200.0, 200.0, 167.0, 200.0, 200.0, 156.0, -53.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 50.0, 125.0, 0.0, 0.0, 0.0, 60.0, 0.0, 175.0, 65.0, 0.0, 0.0, 75.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 70.0, 0.0, 5.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 100.0, 85.0, 35.0, 90.0, 65.0, 45.0, 0.0, 45.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 5.0, 55.0, 35.0, 80.0, 0.0, 0.0, 65.0, 0.0, 80.0, 35.0, 0.0, 0.0, 15.0, 0.0, 0.0, 20.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.35171772856227157, "mean_inference_ms": 1.354484521251417, "mean_action_processing_ms": 0.14170462400663925, "mean_env_wait_ms": 0.11276321082958042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029164552688598633, "StateBufferConnector_ms": 0.0022503137588500977, "ViewRequirementAgentConnector_ms": 0.05142331123352051}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -10.0, "episode_return_mean": 172.52, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.77249215771016, "num_env_steps_trained_throughput_per_sec": 174.77249215771016, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 23355.49, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23355.352, "sample_time_ms": 832.181, "learn_time_ms": 22503.099, "learn_throughput": 177.753, "synch_weights_time_ms": 18.176}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 36, "trial_id": "25fa0_00000", "date": "2024-08-12_13-46-01", "timestamp": 1723484761, "time_this_iter_s": 22.892979860305786, "time_total_s": 1099.9370393753052, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4895e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1099.9370393753052, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 22.01818181818182, "ram_util_percent": 81.76969696969695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9171167923292766, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4216598545356343, "policy_loss": -0.009347331485090156, "vf_loss": 0.43042223215691044, "vf_explained_var": 0.005482566356658935, "kl": 0.015598708416927008, "entropy": 1.129104138414065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.9959528889817495, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45878815550240687, "policy_loss": -0.007032868237001821, "vf_loss": 0.4652056883952658, "vf_explained_var": 0.04213322345167399, "kl": 0.007292848830839927, "entropy": 1.2325433907409509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -10.0, "episode_reward_mean": 171.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -185.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 175.0}, "policy_reward_mean": {"prey_policy": 147.31, "predator_policy": 23.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 128.0, 200.0, -10.0, 122.0, 200.0, 200.0, 110.0, 188.0, 200.0, 200.0, 110.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 116.0, 200.0, 194.0, 200.0, 152.0, 176.0, 200.0, 140.0, 152.0, 80.0, 98.0, 158.0, 92.0, 122.0, 146.0, 200.0, 146.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 194.0, 134.0, 158.0, 104.0, 200.0, 200.0, 122.0, 200.0, 104.0, 158.0, 200.0, 200.0, 182.0, 200.0, 200.0, 176.0, 62.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 176.0, 188.0, 200.0, 200.0, 200.0, 128.0, 182.0, 200.0, 200.0, 200.0, 200.0, 152.0, 164.0, 200.0, 164.0, 44.0, 146.0, 104.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 68.0, 200.0, -185.0, 57.0, 200.0, 200.0, 35.0, 178.0, 200.0, 200.0, 35.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 46.0, 200.0, 189.0, 200.0, 112.0, 156.0, 200.0, 90.0, 112.0, -20.0, 13.0, 123.0, 2.0, 57.0, 101.0, 200.0, 101.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 189.0, 79.0, 123.0, 24.0, 200.0, 200.0, 57.0, 200.0, 24.0, 123.0, 200.0, 200.0, 167.0, 200.0, 200.0, 156.0, -53.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 156.0, 178.0, 200.0, 200.0, 200.0, 68.0, 167.0, 200.0, 200.0, 200.0, 200.0, 112.0, 134.0, 200.0, 134.0, -86.0, 101.0, 24.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 60.0, 0.0, 175.0, 65.0, 0.0, 0.0, 75.0, 10.0, 0.0, 0.0, 75.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 70.0, 0.0, 5.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 100.0, 85.0, 35.0, 90.0, 65.0, 45.0, 0.0, 45.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 5.0, 55.0, 35.0, 80.0, 0.0, 0.0, 65.0, 0.0, 80.0, 35.0, 0.0, 0.0, 15.0, 0.0, 0.0, 20.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 0.0, 0.0, 0.0, 60.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 30.0, 130.0, 45.0, 80.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34943266793999955, "mean_inference_ms": 1.343342853725383, "mean_action_processing_ms": 0.14071197068377791, "mean_env_wait_ms": 0.11158160387569536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028630495071411133, "StateBufferConnector_ms": 0.0022646188735961914, "ViewRequirementAgentConnector_ms": 0.05443704128265381}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -10.0, "episode_return_mean": 171.26, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.84149919490196, "num_env_steps_trained_throughput_per_sec": 172.84149919490196, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 23364.824, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23364.713, "sample_time_ms": 836.571, "learn_time_ms": 22507.81, "learn_throughput": 177.716, "synch_weights_time_ms": 18.476}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "training_iteration": 37, "trial_id": "25fa0_00000", "date": "2024-08-12_13-46-24", "timestamp": 1723484784, "time_this_iter_s": 23.14827299118042, "time_total_s": 1123.0853123664856, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a484d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1123.0853123664856, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 23.03939393939394, "ram_util_percent": 82.06666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7974794817583946, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3285453108527387, "policy_loss": -0.008674296350121343, "vf_loss": 0.33667172087925745, "vf_explained_var": 0.005185793216029803, "kl": 0.014610179472811069, "entropy": 1.013537759333849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.489813119235139, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3549487547591222, "policy_loss": -0.006996284927784775, "vf_loss": 0.3612686612534162, "vf_explained_var": 0.01883461686472098, "kl": 0.008016321128597837, "entropy": 1.2366170513133208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": 44.0, "episode_reward_mean": 172.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -86.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 130.0}, "policy_reward_mean": {"prey_policy": 149.84, "predator_policy": 22.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 116.0, 200.0, 194.0, 200.0, 152.0, 176.0, 200.0, 140.0, 152.0, 80.0, 98.0, 158.0, 92.0, 122.0, 146.0, 200.0, 146.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 194.0, 134.0, 158.0, 104.0, 200.0, 200.0, 122.0, 200.0, 104.0, 158.0, 200.0, 200.0, 182.0, 200.0, 200.0, 176.0, 62.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 176.0, 188.0, 200.0, 200.0, 200.0, 128.0, 182.0, 200.0, 200.0, 200.0, 200.0, 152.0, 164.0, 200.0, 164.0, 44.0, 146.0, 104.0, 200.0, 200.0, 200.0, 200.0, 152.0, 92.0, 200.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 92.0, 182.0, 140.0, 200.0, 200.0, 164.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 46.0, 200.0, 189.0, 200.0, 112.0, 156.0, 200.0, 90.0, 112.0, -20.0, 13.0, 123.0, 2.0, 57.0, 101.0, 200.0, 101.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 189.0, 79.0, 123.0, 24.0, 200.0, 200.0, 57.0, 200.0, 24.0, 123.0, 200.0, 200.0, 167.0, 200.0, 200.0, 156.0, -53.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 156.0, 178.0, 200.0, 200.0, 200.0, 68.0, 167.0, 200.0, 200.0, 200.0, 200.0, 112.0, 134.0, 200.0, 134.0, -86.0, 101.0, 24.0, 200.0, 200.0, 200.0, 200.0, 112.0, 2.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 2.0, 167.0, 90.0, 200.0, 200.0, 134.0, 200.0], "policy_predator_policy_reward": [0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 70.0, 0.0, 5.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 100.0, 85.0, 35.0, 90.0, 65.0, 45.0, 0.0, 45.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 5.0, 55.0, 35.0, 80.0, 0.0, 0.0, 65.0, 0.0, 80.0, 35.0, 0.0, 0.0, 15.0, 0.0, 0.0, 20.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 0.0, 0.0, 0.0, 60.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 30.0, 130.0, 45.0, 80.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 15.0, 50.0, 0.0, 0.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3483079893446802, "mean_inference_ms": 1.3384298808214032, "mean_action_processing_ms": 0.1403201736379382, "mean_env_wait_ms": 0.11100959597447789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027854442596435547, "StateBufferConnector_ms": 0.0022295713424682617, "ViewRequirementAgentConnector_ms": 0.052063584327697754}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": 44.0, "episode_return_mean": 172.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.23573696363854, "num_env_steps_trained_throughput_per_sec": 172.23573696363854, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 23360.644, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23360.53, "sample_time_ms": 829.443, "learn_time_ms": 22511.039, "learn_throughput": 177.691, "synch_weights_time_ms": 18.384}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 38, "trial_id": "25fa0_00000", "date": "2024-08-12_13-46-47", "timestamp": 1723484807, "time_this_iter_s": 23.231961727142334, "time_total_s": 1146.317274093628, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48259d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1146.317274093628, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.790909090909093, "ram_util_percent": 82.02727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.743514550368612, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3064180031574021, "policy_loss": -0.00532304919033777, "vf_loss": 0.311282926770861, "vf_explained_var": 0.006419929241140683, "kl": 0.01221660218248625, "entropy": 0.9496923667068283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.428052928857506, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3297799214922634, "policy_loss": -0.008882759915528974, "vf_loss": 0.3379969367776842, "vf_explained_var": 0.02460369685043891, "kl": 0.007890307851495783, "entropy": 1.2630420704682668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": 2.0, "episode_reward_mean": 171.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -163.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 148.41, "predator_policy": 23.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 158.0, 92.0, 122.0, 146.0, 200.0, 146.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 194.0, 134.0, 158.0, 104.0, 200.0, 200.0, 122.0, 200.0, 104.0, 158.0, 200.0, 200.0, 182.0, 200.0, 200.0, 176.0, 62.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 176.0, 188.0, 200.0, 200.0, 200.0, 128.0, 182.0, 200.0, 200.0, 200.0, 200.0, 152.0, 164.0, 200.0, 164.0, 44.0, 146.0, 104.0, 200.0, 200.0, 200.0, 200.0, 152.0, 92.0, 200.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 92.0, 182.0, 140.0, 200.0, 200.0, 164.0, 200.0, 200.0, 116.0, 200.0, 134.0, 200.0, 170.0, 2.0, 140.0, 200.0, 200.0, 200.0, 152.0, 158.0, 200.0, 200.0, 158.0, 200.0, 176.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 123.0, 2.0, 57.0, 101.0, 200.0, 101.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 189.0, 79.0, 123.0, 24.0, 200.0, 200.0, 57.0, 200.0, 24.0, 123.0, 200.0, 200.0, 167.0, 200.0, 200.0, 156.0, -53.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 156.0, 178.0, 200.0, 200.0, 200.0, 68.0, 167.0, 200.0, 200.0, 200.0, 200.0, 112.0, 134.0, 200.0, 134.0, -86.0, 101.0, 24.0, 200.0, 200.0, 200.0, 200.0, 112.0, 2.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 2.0, 167.0, 90.0, 200.0, 200.0, 134.0, 200.0, 200.0, 46.0, 200.0, 79.0, 200.0, 145.0, -163.0, 90.0, 200.0, 200.0, 200.0, 112.0, 123.0, 200.0, 200.0, 123.0, 200.0, 156.0], "policy_predator_policy_reward": [85.0, 35.0, 90.0, 65.0, 45.0, 0.0, 45.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 5.0, 55.0, 35.0, 80.0, 0.0, 0.0, 65.0, 0.0, 80.0, 35.0, 0.0, 0.0, 15.0, 0.0, 0.0, 20.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 0.0, 0.0, 0.0, 60.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 30.0, 130.0, 45.0, 80.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 15.0, 50.0, 0.0, 0.0, 30.0, 0.0, 0.0, 70.0, 0.0, 55.0, 0.0, 25.0, 165.0, 50.0, 0.0, 0.0, 0.0, 40.0, 35.0, 0.0, 0.0, 35.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34708334529725166, "mean_inference_ms": 1.333236679702385, "mean_action_processing_ms": 0.13988208570278485, "mean_env_wait_ms": 0.11049030201462877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025326013565063477, "StateBufferConnector_ms": 0.002076387405395508, "ViewRequirementAgentConnector_ms": 0.05015826225280762}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": 2.0, "episode_return_mean": 171.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.2095128442321, "num_env_steps_trained_throughput_per_sec": 171.2095128442321, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 23366.87, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23366.72, "sample_time_ms": 826.387, "learn_time_ms": 22520.261, "learn_throughput": 177.618, "synch_weights_time_ms": 18.367}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 39, "trial_id": "25fa0_00000", "date": "2024-08-12_13-47-11", "timestamp": 1723484831, "time_this_iter_s": 23.40647602081299, "time_total_s": 1169.723750114441, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482d9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1169.723750114441, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 22.933333333333334, "ram_util_percent": 82.26060606060605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6792943430288384, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14736018631980793, "policy_loss": -0.004952839302131906, "vf_loss": 0.15161268893470461, "vf_explained_var": 0.05508138916144768, "kl": 0.01867556843592953, "entropy": 0.892977109613518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.682149521866814, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16338855292845741, "policy_loss": -0.007157854953159889, "vf_loss": 0.16993821079243693, "vf_explained_var": -0.08726578205823898, "kl": 0.00720827237421562, "entropy": 1.2957414551327626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": 2.0, "episode_reward_mean": 177.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -163.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 165.0}, "policy_reward_mean": {"prey_policy": 159.41, "predator_policy": 18.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.0, 158.0, 200.0, 200.0, 182.0, 200.0, 200.0, 176.0, 62.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 128.0, 176.0, 188.0, 200.0, 200.0, 200.0, 128.0, 182.0, 200.0, 200.0, 200.0, 200.0, 152.0, 164.0, 200.0, 164.0, 44.0, 146.0, 104.0, 200.0, 200.0, 200.0, 200.0, 152.0, 92.0, 200.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 92.0, 182.0, 140.0, 200.0, 200.0, 164.0, 200.0, 200.0, 116.0, 200.0, 134.0, 200.0, 170.0, 2.0, 140.0, 200.0, 200.0, 200.0, 152.0, 158.0, 200.0, 200.0, 158.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 200.0, 194.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 116.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 123.0, 200.0, 200.0, 167.0, 200.0, 200.0, 156.0, -53.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 156.0, 178.0, 200.0, 200.0, 200.0, 68.0, 167.0, 200.0, 200.0, 200.0, 200.0, 112.0, 134.0, 200.0, 134.0, -86.0, 101.0, 24.0, 200.0, 200.0, 200.0, 200.0, 112.0, 2.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 2.0, 167.0, 90.0, 200.0, 200.0, 134.0, 200.0, 200.0, 46.0, 200.0, 79.0, 200.0, 145.0, -163.0, 90.0, 200.0, 200.0, 200.0, 112.0, 123.0, 200.0, 200.0, 123.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 46.0, 200.0], "policy_predator_policy_reward": [80.0, 35.0, 0.0, 0.0, 15.0, 0.0, 0.0, 20.0, 115.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 20.0, 10.0, 0.0, 0.0, 0.0, 60.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 30.0, 130.0, 45.0, 80.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 15.0, 50.0, 0.0, 0.0, 30.0, 0.0, 0.0, 70.0, 0.0, 55.0, 0.0, 25.0, 165.0, 50.0, 0.0, 0.0, 0.0, 40.0, 35.0, 0.0, 0.0, 35.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3465650407902207, "mean_inference_ms": 1.3319907233489394, "mean_action_processing_ms": 0.13983093888743553, "mean_env_wait_ms": 0.11037819508580761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002573728561401367, "StateBufferConnector_ms": 0.002078413963317871, "ViewRequirementAgentConnector_ms": 0.050872206687927246}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": 2.0, "episode_return_mean": 177.86, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.63903469288994, "num_env_steps_trained_throughput_per_sec": 171.63903469288994, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 23378.817, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23378.667, "sample_time_ms": 822.571, "learn_time_ms": 22535.753, "learn_throughput": 177.496, "synch_weights_time_ms": 18.721}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 40, "trial_id": "25fa0_00000", "date": "2024-08-12_13-47-34", "timestamp": 1723484854, "time_this_iter_s": 23.3105731010437, "time_total_s": 1193.0343232154846, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1193.0343232154846, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.621212121212125, "ram_util_percent": 82.49090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7678491775800164, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4061330459391077, "policy_loss": -0.004076232132016837, "vf_loss": 1.4099135570848982, "vf_explained_var": -0.00012761081258455914, "kl": 0.007884397875342649, "entropy": 0.8644608266030749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.913041971406589, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.423731663041205, "policy_loss": -0.00976530345797073, "vf_loss": 1.432469162872682, "vf_explained_var": 0.017553880251944064, "kl": 0.0121813743781838, "entropy": 1.3246554664025705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -4.0, "episode_reward_mean": 171.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -174.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 170.0}, "policy_reward_mean": {"prey_policy": 148.41, "predator_policy": 23.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 128.0, 182.0, 200.0, 200.0, 200.0, 200.0, 152.0, 164.0, 200.0, 164.0, 44.0, 146.0, 104.0, 200.0, 200.0, 200.0, 200.0, 152.0, 92.0, 200.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 92.0, 182.0, 140.0, 200.0, 200.0, 164.0, 200.0, 200.0, 116.0, 200.0, 134.0, 200.0, 170.0, 2.0, 140.0, 200.0, 200.0, 200.0, 152.0, 158.0, 200.0, 200.0, 158.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 200.0, 194.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 116.0, 200.0, -4.0, 200.0, 86.0, 140.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 194.0, 188.0, 110.0, 140.0, 98.0, 146.0, 200.0, 200.0, 200.0, 98.0, 122.0, 134.0, 134.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 68.0, 167.0, 200.0, 200.0, 200.0, 200.0, 112.0, 134.0, 200.0, 134.0, -86.0, 101.0, 24.0, 200.0, 200.0, 200.0, 200.0, 112.0, 2.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 2.0, 167.0, 90.0, 200.0, 200.0, 134.0, 200.0, 200.0, 46.0, 200.0, 79.0, 200.0, 145.0, -163.0, 90.0, 200.0, 200.0, 200.0, 112.0, 123.0, 200.0, 200.0, 123.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 46.0, 200.0, -174.0, 200.0, -9.0, 90.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 189.0, 178.0, 35.0, 90.0, 13.0, 101.0, 200.0, 200.0, 200.0, 13.0, 57.0, 79.0, 79.0], "policy_predator_policy_reward": [0.0, 0.0, 60.0, 15.0, 0.0, 0.0, 0.0, 0.0, 40.0, 30.0, 0.0, 30.0, 130.0, 45.0, 80.0, 0.0, 0.0, 0.0, 0.0, 40.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 15.0, 50.0, 0.0, 0.0, 30.0, 0.0, 0.0, 70.0, 0.0, 55.0, 0.0, 25.0, 165.0, 50.0, 0.0, 0.0, 0.0, 40.0, 35.0, 0.0, 0.0, 35.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 170.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 10.0, 75.0, 50.0, 85.0, 45.0, 0.0, 0.0, 0.0, 85.0, 65.0, 55.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3449046782391928, "mean_inference_ms": 1.3235495478021806, "mean_action_processing_ms": 0.13901686619898762, "mean_env_wait_ms": 0.10954285804805569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00256955623626709, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.049546241760253906}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -4.0, "episode_return_mean": 171.86, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.3694515602601, "num_env_steps_trained_throughput_per_sec": 171.3694515602601, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 23225.263, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23225.046, "sample_time_ms": 813.737, "learn_time_ms": 22391.206, "learn_throughput": 178.642, "synch_weights_time_ms": 18.06}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "training_iteration": 41, "trial_id": "25fa0_00000", "date": "2024-08-12_13-47-57", "timestamp": 1723484877, "time_this_iter_s": 23.39973282814026, "time_total_s": 1216.4340560436249, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1216.4340560436249, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 23.869696969696967, "ram_util_percent": 82.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7296122870097558, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6930523555725813, "policy_loss": -0.010247643371015632, "vf_loss": 0.7023944682441652, "vf_explained_var": 8.358551810185114e-05, "kl": 0.024146784706933773, "entropy": 0.8076784500231345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9781622833261885, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6995024805612047, "policy_loss": -0.011878825580546011, "vf_loss": 0.7101946901995688, "vf_explained_var": 0.020270727823177973, "kl": 0.01406356987543289, "entropy": 1.280415813003977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -28.0, "episode_reward_mean": 166.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 138.4, "predator_policy": 28.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 152.0, 92.0, 200.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 92.0, 182.0, 140.0, 200.0, 200.0, 164.0, 200.0, 200.0, 116.0, 200.0, 134.0, 200.0, 170.0, 2.0, 140.0, 200.0, 200.0, 200.0, 152.0, 158.0, 200.0, 200.0, 158.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 200.0, 194.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 116.0, 200.0, -4.0, 200.0, 86.0, 140.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 194.0, 188.0, 110.0, 140.0, 98.0, 146.0, 200.0, 200.0, 200.0, 98.0, 122.0, 134.0, 134.0, 122.0, 200.0, -28.0, 116.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -28.0, 38.0, 8.0, 110.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 112.0, 2.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 2.0, 167.0, 90.0, 200.0, 200.0, 134.0, 200.0, 200.0, 46.0, 200.0, 79.0, 200.0, 145.0, -163.0, 90.0, 200.0, 200.0, 200.0, 112.0, 123.0, 200.0, 200.0, 123.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 46.0, 200.0, -174.0, 200.0, -9.0, 90.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 189.0, 178.0, 35.0, 90.0, 13.0, 101.0, 200.0, 200.0, 200.0, 13.0, 57.0, 79.0, 79.0, 57.0, 200.0, -218.0, 46.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -218.0, -97.0, -152.0, 35.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 40.0, 90.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 90.0, 15.0, 50.0, 0.0, 0.0, 30.0, 0.0, 0.0, 70.0, 0.0, 55.0, 0.0, 25.0, 165.0, 50.0, 0.0, 0.0, 0.0, 40.0, 35.0, 0.0, 0.0, 35.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 170.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 10.0, 75.0, 50.0, 85.0, 45.0, 0.0, 0.0, 0.0, 85.0, 65.0, 55.0, 55.0, 65.0, 0.0, 190.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 135.0, 160.0, 75.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3434598215026455, "mean_inference_ms": 1.3190823070194082, "mean_action_processing_ms": 0.13860199131860995, "mean_env_wait_ms": 0.10920796011587214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0024758577346801758, "StateBufferConnector_ms": 0.0019835233688354492, "ViewRequirementAgentConnector_ms": 0.04692578315734863}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -28.0, "episode_return_mean": 166.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 168.09097984237684, "num_env_steps_trained_throughput_per_sec": 168.09097984237684, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 23265.72, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23265.493, "sample_time_ms": 838.045, "learn_time_ms": 22408.882, "learn_throughput": 178.501, "synch_weights_time_ms": 16.705}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 42, "trial_id": "25fa0_00000", "date": "2024-08-12_13-48-21", "timestamp": 1723484901, "time_this_iter_s": 23.819177865982056, "time_total_s": 1240.253233909607, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1240.253233909607, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 25.14117647058823, "ram_util_percent": 82.98235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7266924114897847, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39176628619122006, "policy_loss": -0.004014366141927894, "vf_loss": 0.3955090760183585, "vf_explained_var": 0.007870767389734586, "kl": 0.0048278666604012425, "entropy": 0.8405107428009312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.900099241298934, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39704067833020723, "policy_loss": -0.01043585770627639, "vf_loss": 0.4068920019211267, "vf_explained_var": 0.02712384474774202, "kl": 0.0069277932963932665, "entropy": 1.2954748378445704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -28.0, "episode_reward_mean": 163.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 133.01, "predator_policy": 30.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 116.0, 200.0, 134.0, 200.0, 170.0, 2.0, 140.0, 200.0, 200.0, 200.0, 152.0, 158.0, 200.0, 200.0, 158.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 200.0, 194.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 116.0, 200.0, -4.0, 200.0, 86.0, 140.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 194.0, 188.0, 110.0, 140.0, 98.0, 146.0, 200.0, 200.0, 200.0, 98.0, 122.0, 134.0, 134.0, 122.0, 200.0, -28.0, 116.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -28.0, 38.0, 8.0, 110.0, 200.0, 200.0, 200.0, 200.0, 164.0, 8.0, 8.0, 194.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, 200.0, 80.0, 194.0, 200.0, 200.0, 164.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 46.0, 200.0, 79.0, 200.0, 145.0, -163.0, 90.0, 200.0, 200.0, 200.0, 112.0, 123.0, 200.0, 200.0, 123.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 46.0, 200.0, -174.0, 200.0, -9.0, 90.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 189.0, 178.0, 35.0, 90.0, 13.0, 101.0, 200.0, 200.0, 200.0, 13.0, 57.0, 79.0, 79.0, 57.0, 200.0, -218.0, 46.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -218.0, -97.0, -152.0, 35.0, 200.0, 200.0, 200.0, 200.0, 134.0, -152.0, -152.0, 189.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, 200.0, -20.0, 189.0, 200.0, 200.0, 134.0], "policy_predator_policy_reward": [0.0, 0.0, 70.0, 0.0, 55.0, 0.0, 25.0, 165.0, 50.0, 0.0, 0.0, 0.0, 40.0, 35.0, 0.0, 0.0, 35.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 170.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 10.0, 75.0, 50.0, 85.0, 45.0, 0.0, 0.0, 0.0, 85.0, 65.0, 55.0, 55.0, 65.0, 0.0, 190.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 135.0, 160.0, 75.0, 0.0, 0.0, 0.0, 0.0, 30.0, 160.0, 160.0, 5.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 0.0, 100.0, 5.0, 0.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34257744165160675, "mean_inference_ms": 1.316341437908012, "mean_action_processing_ms": 0.1383213897206523, "mean_env_wait_ms": 0.10902770234602226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00246584415435791, "StateBufferConnector_ms": 0.001973390579223633, "ViewRequirementAgentConnector_ms": 0.04653322696685791}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -28.0, "episode_return_mean": 163.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.8940733034923, "num_env_steps_trained_throughput_per_sec": 171.8940733034923, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 23268.448, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23268.196, "sample_time_ms": 833.148, "learn_time_ms": 22414.682, "learn_throughput": 178.454, "synch_weights_time_ms": 18.19}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "training_iteration": 43, "trial_id": "25fa0_00000", "date": "2024-08-12_13-48-45", "timestamp": 1723484925, "time_this_iter_s": 23.308441877365112, "time_total_s": 1263.561675786972, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4895ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1263.561675786972, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.13939393939394, "ram_util_percent": 83.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7548150178665917, "cur_kl_coeff": 0.028125000000000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6864997339124481, "policy_loss": -0.002537445407748843, "vf_loss": 0.6889657106579148, "vf_explained_var": 0.00578089952468872, "kl": 0.002539980219523841, "entropy": 0.8391944866627454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.254701531399041, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7010634025757706, "policy_loss": -0.008922750742446322, "vf_loss": 0.7091343907128854, "vf_explained_var": 0.030759389946858087, "kl": 0.010094987948658336, "entropy": 1.2515296475340922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -28.0, "episode_reward_mean": 162.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 131.47, "predator_policy": 31.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 200.0, 194.0, 200.0, 128.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 116.0, 200.0, -4.0, 200.0, 86.0, 140.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 194.0, 188.0, 110.0, 140.0, 98.0, 146.0, 200.0, 200.0, 200.0, 98.0, 122.0, 134.0, 134.0, 122.0, 200.0, -28.0, 116.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -28.0, 38.0, 8.0, 110.0, 200.0, 200.0, 200.0, 200.0, 164.0, 8.0, 8.0, 194.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, 200.0, 80.0, 194.0, 200.0, 200.0, 164.0, 200.0, 140.0, 200.0, 200.0, 128.0, 146.0, 200.0, 200.0, 200.0, 146.0, 110.0, 62.0, 200.0, 110.0, 200.0, 200.0, 110.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 46.0, 200.0, -174.0, 200.0, -9.0, 90.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 189.0, 178.0, 35.0, 90.0, 13.0, 101.0, 200.0, 200.0, 200.0, 13.0, 57.0, 79.0, 79.0, 57.0, 200.0, -218.0, 46.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -218.0, -97.0, -152.0, 35.0, 200.0, 200.0, 200.0, 200.0, 134.0, -152.0, -152.0, 189.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, 200.0, -20.0, 189.0, 200.0, 200.0, 134.0, 200.0, 90.0, 200.0, 200.0, 68.0, 101.0, 200.0, 200.0, 200.0, 101.0, 35.0, -53.0, 200.0, 35.0, 200.0, 200.0, 35.0, 189.0], "policy_predator_policy_reward": [20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 0.0, 170.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 10.0, 75.0, 50.0, 85.0, 45.0, 0.0, 0.0, 0.0, 85.0, 65.0, 55.0, 55.0, 65.0, 0.0, 190.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 135.0, 160.0, 75.0, 0.0, 0.0, 0.0, 0.0, 30.0, 160.0, 160.0, 5.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 0.0, 100.0, 5.0, 0.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 0.0, 45.0, 75.0, 115.0, 0.0, 75.0, 0.0, 0.0, 75.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34187891055105313, "mean_inference_ms": 1.314246187889027, "mean_action_processing_ms": 0.13807720972381687, "mean_env_wait_ms": 0.10884460455867599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002524256706237793, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.047580599784851074}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -28.0, "episode_return_mean": 162.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.90874451141354, "num_env_steps_trained_throughput_per_sec": 172.90874451141354, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 23261.884, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23261.626, "sample_time_ms": 830.546, "learn_time_ms": 22410.838, "learn_throughput": 178.485, "synch_weights_time_ms": 18.046}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 44, "trial_id": "25fa0_00000", "date": "2024-08-12_13-49-08", "timestamp": 1723484948, "time_this_iter_s": 23.16425609588623, "time_total_s": 1286.7259318828583, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1286.7259318828583, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 23.951515151515153, "ram_util_percent": 83.10606060606061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5546545831253752, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20380624835961497, "policy_loss": -0.006556254128615061, "vf_loss": 0.2102068091795538, "vf_explained_var": 0.03705247684071462, "kl": 0.011070964801094619, "entropy": 0.8704370087633531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.692702656860153, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22223747890535986, "policy_loss": -0.009808310106260857, "vf_loss": 0.2310329568103043, "vf_explained_var": 0.004085170601805051, "kl": 0.012003925922927768, "entropy": 1.3157050302873055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -28.0, "episode_reward_mean": 159.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 125.2, "predator_policy": 34.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -4.0, 200.0, 86.0, 140.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 194.0, 188.0, 110.0, 140.0, 98.0, 146.0, 200.0, 200.0, 200.0, 98.0, 122.0, 134.0, 134.0, 122.0, 200.0, -28.0, 116.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -28.0, 38.0, 8.0, 110.0, 200.0, 200.0, 200.0, 200.0, 164.0, 8.0, 8.0, 194.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, 200.0, 80.0, 194.0, 200.0, 200.0, 164.0, 200.0, 140.0, 200.0, 200.0, 128.0, 146.0, 200.0, 200.0, 200.0, 146.0, 110.0, 62.0, 200.0, 110.0, 200.0, 200.0, 110.0, 194.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, -4.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 26.0, 200.0, 200.0, 200.0, 134.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -174.0, 200.0, -9.0, 90.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 189.0, 178.0, 35.0, 90.0, 13.0, 101.0, 200.0, 200.0, 200.0, 13.0, 57.0, 79.0, 79.0, 57.0, 200.0, -218.0, 46.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -218.0, -97.0, -152.0, 35.0, 200.0, 200.0, 200.0, 200.0, 134.0, -152.0, -152.0, 189.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, 200.0, -20.0, 189.0, 200.0, 200.0, 134.0, 200.0, 90.0, 200.0, 200.0, 68.0, 101.0, 200.0, 200.0, 200.0, 101.0, 35.0, -53.0, 200.0, 35.0, 200.0, 200.0, 35.0, 189.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -174.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, -119.0, 200.0, 200.0, 200.0, 79.0, 189.0], "policy_predator_policy_reward": [0.0, 170.0, 0.0, 95.0, 50.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 10.0, 75.0, 50.0, 85.0, 45.0, 0.0, 0.0, 0.0, 85.0, 65.0, 55.0, 55.0, 65.0, 0.0, 190.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 135.0, 160.0, 75.0, 0.0, 0.0, 0.0, 0.0, 30.0, 160.0, 160.0, 5.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 0.0, 100.0, 5.0, 0.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 0.0, 45.0, 75.0, 115.0, 0.0, 75.0, 0.0, 0.0, 75.0, 5.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 170.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 0.0, 0.0, 55.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.34109075847549347, "mean_inference_ms": 1.311889181380666, "mean_action_processing_ms": 0.1377711105455268, "mean_env_wait_ms": 0.10866163709812403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025397539138793945, "StateBufferConnector_ms": 0.0021036863327026367, "ViewRequirementAgentConnector_ms": 0.048743367195129395}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -28.0, "episode_return_mean": 159.2, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.34398578441858, "num_env_steps_trained_throughput_per_sec": 172.34398578441858, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 23267.269, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23267.01, "sample_time_ms": 826.646, "learn_time_ms": 22420.016, "learn_throughput": 178.412, "synch_weights_time_ms": 18.037}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 45, "trial_id": "25fa0_00000", "date": "2024-08-12_13-49-31", "timestamp": 1723484971, "time_this_iter_s": 23.23949098587036, "time_total_s": 1309.9654228687286, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1309.9654228687286, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 22.606060606060606, "ram_util_percent": 83.29090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7021150955076639, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6187107658013702, "policy_loss": -0.0030950836730577673, "vf_loss": 0.621583465852112, "vf_explained_var": 0.005417301443715891, "kl": 0.01581304462445985, "entropy": 0.8041045979286233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.782794714315484, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6273012923301091, "policy_loss": -0.008138568061500944, "vf_loss": 0.6345758187429359, "vf_explained_var": 0.021869312102595965, "kl": 0.010240495783326272, "entropy": 1.3042067752530178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -28.0, "episode_reward_mean": 161.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -218.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.0}, "policy_reward_mean": {"prey_policy": 130.15, "predator_policy": 31.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 122.0, 200.0, -28.0, 116.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -28.0, 38.0, 8.0, 110.0, 200.0, 200.0, 200.0, 200.0, 164.0, 8.0, 8.0, 194.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, 200.0, 80.0, 194.0, 200.0, 200.0, 164.0, 200.0, 140.0, 200.0, 200.0, 128.0, 146.0, 200.0, 200.0, 200.0, 146.0, 110.0, 62.0, 200.0, 110.0, 200.0, 200.0, 110.0, 194.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, -4.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 26.0, 200.0, 200.0, 200.0, 134.0, 194.0, 128.0, 200.0, 140.0, 128.0, 200.0, 200.0, 200.0, 182.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 194.0, 134.0, 56.0, 200.0, 200.0, 56.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 57.0, 200.0, -218.0, 46.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -218.0, -97.0, -152.0, 35.0, 200.0, 200.0, 200.0, 200.0, 134.0, -152.0, -152.0, 189.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, 200.0, -20.0, 189.0, 200.0, 200.0, 134.0, 200.0, 90.0, 200.0, 200.0, 68.0, 101.0, 200.0, 200.0, 200.0, 101.0, 35.0, -53.0, 200.0, 35.0, 200.0, 200.0, 35.0, 189.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -174.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, -119.0, 200.0, 200.0, 200.0, 79.0, 189.0, 68.0, 200.0, 90.0, 68.0, 200.0, 200.0, 200.0, 167.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 189.0, 79.0, -64.0, 200.0, 200.0, -64.0], "policy_predator_policy_reward": [55.0, 65.0, 0.0, 190.0, 70.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 190.0, 135.0, 160.0, 75.0, 0.0, 0.0, 0.0, 0.0, 30.0, 160.0, 160.0, 5.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 0.0, 100.0, 5.0, 0.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 0.0, 45.0, 75.0, 115.0, 0.0, 75.0, 0.0, 0.0, 75.0, 5.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 170.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 0.0, 0.0, 55.0, 5.0, 60.0, 0.0, 50.0, 60.0, 0.0, 0.0, 0.0, 15.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 5.0, 55.0, 120.0, 0.0, 0.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3404691494937768, "mean_inference_ms": 1.3097661555825377, "mean_action_processing_ms": 0.13748806189636129, "mean_env_wait_ms": 0.10853667336794931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00295102596282959, "StateBufferConnector_ms": 0.0020869970321655273, "ViewRequirementAgentConnector_ms": 0.048377275466918945}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -28.0, "episode_return_mean": 161.9, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.92203118084637, "num_env_steps_trained_throughput_per_sec": 171.92203118084637, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 23305.216, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23304.918, "sample_time_ms": 836.499, "learn_time_ms": 22446.868, "learn_throughput": 178.199, "synch_weights_time_ms": 18.88}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 46, "trial_id": "25fa0_00000", "date": "2024-08-12_13-49-54", "timestamp": 1723484994, "time_this_iter_s": 23.31696891784668, "time_total_s": 1333.2823917865753, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48951f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1333.2823917865753, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 22.11212121212121, "ram_util_percent": 83.16969696969696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.064688791676114, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7776318667146067, "policy_loss": -0.0031977789602630462, "vf_loss": 0.7807073613839748, "vf_explained_var": 0.013026491180062294, "kl": 0.00869573281746266, "entropy": 0.6837713518490394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.825481643434614, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8730737566559886, "policy_loss": -0.010098974606080446, "vf_loss": 0.8825194880365113, "vf_explained_var": 0.014872262130180995, "kl": 0.007742094304668815, "entropy": 1.3014538751294216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -160.0, "episode_reward_mean": 169.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -460.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 300.0}, "policy_reward_mean": {"prey_policy": 143.46, "predator_policy": 25.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 164.0, 8.0, 8.0, 194.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, 200.0, 80.0, 194.0, 200.0, 200.0, 164.0, 200.0, 140.0, 200.0, 200.0, 128.0, 146.0, 200.0, 200.0, 200.0, 146.0, 110.0, 62.0, 200.0, 110.0, 200.0, 200.0, 110.0, 194.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, -4.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 26.0, 200.0, 200.0, 200.0, 134.0, 194.0, 128.0, 200.0, 140.0, 128.0, 200.0, 200.0, 200.0, 182.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 194.0, 134.0, 56.0, 200.0, 200.0, 56.0, 200.0, 200.0, -160.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 134.0, -152.0, -152.0, 189.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, 200.0, -20.0, 189.0, 200.0, 200.0, 134.0, 200.0, 90.0, 200.0, 200.0, 68.0, 101.0, 200.0, 200.0, 200.0, 101.0, 35.0, -53.0, 200.0, 35.0, 200.0, 200.0, 35.0, 189.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -174.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, -119.0, 200.0, 200.0, 200.0, 79.0, 189.0, 68.0, 200.0, 90.0, 68.0, 200.0, 200.0, 200.0, 167.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 189.0, 79.0, -64.0, 200.0, 200.0, -64.0, 200.0, 200.0, -460.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 30.0, 160.0, 160.0, 5.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 0.0, 100.0, 5.0, 0.0, 0.0, 30.0, 0.0, 50.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 0.0, 45.0, 75.0, 115.0, 0.0, 75.0, 0.0, 0.0, 75.0, 5.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 170.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 0.0, 0.0, 55.0, 5.0, 60.0, 0.0, 50.0, 60.0, 0.0, 0.0, 0.0, 15.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 5.0, 55.0, 120.0, 0.0, 0.0, 120.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3397789784069161, "mean_inference_ms": 1.3068330312917453, "mean_action_processing_ms": 0.13717513055580588, "mean_env_wait_ms": 0.10827390669366938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033059120178222656, "StateBufferConnector_ms": 0.0020350217819213867, "ViewRequirementAgentConnector_ms": 0.047605156898498535}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -160.0, "episode_return_mean": 169.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.67285719884495, "num_env_steps_trained_throughput_per_sec": 162.67285719884495, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 23449.881, "restore_workers_time_ms": 0.023, "training_step_time_ms": 23449.582, "sample_time_ms": 834.353, "learn_time_ms": 22594.204, "learn_throughput": 177.037, "synch_weights_time_ms": 18.264}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "training_iteration": 47, "trial_id": "25fa0_00000", "date": "2024-08-12_13-50-19", "timestamp": 1723485019, "time_this_iter_s": 24.63860511779785, "time_total_s": 1357.9209969043732, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a484d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1357.9209969043732, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 28.742857142857144, "ram_util_percent": 83.21142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0497547309690465, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3182688733562826, "policy_loss": -0.004950687569362344, "vf_loss": 1.3231049034123619, "vf_explained_var": 0.0026144585261742275, "kl": 0.00815354320657858, "entropy": 0.5430891996870438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.890839986254772, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.327477507685156, "policy_loss": -0.008470568576497802, "vf_loss": 1.3353681576748688, "vf_explained_var": 0.011569995308915774, "kl": 0.006873067075232105, "entropy": 1.2821640975773334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -160.0, "episode_reward_mean": 168.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -460.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 300.0}, "policy_reward_mean": {"prey_policy": 141.37, "predator_policy": 26.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.0, 200.0, 140.0, 200.0, 200.0, 128.0, 146.0, 200.0, 200.0, 200.0, 146.0, 110.0, 62.0, 200.0, 110.0, 200.0, 200.0, 110.0, 194.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, -4.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 26.0, 200.0, 200.0, 200.0, 134.0, 194.0, 128.0, 200.0, 140.0, 128.0, 200.0, 200.0, 200.0, 182.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 194.0, 134.0, 56.0, 200.0, 200.0, 56.0, 200.0, 200.0, -160.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 86.0, 200.0, 200.0, -52.0, 200.0, 200.0, 194.0, 200.0, 98.0, 158.0, 200.0, 194.0, 182.0, 200.0, 200.0, 20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.0, 200.0, 90.0, 200.0, 200.0, 68.0, 101.0, 200.0, 200.0, 200.0, 101.0, 35.0, -53.0, 200.0, 35.0, 200.0, 200.0, 35.0, 189.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -174.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, -119.0, 200.0, 200.0, 200.0, 79.0, 189.0, 68.0, 200.0, 90.0, 68.0, 200.0, 200.0, 200.0, 167.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 189.0, 79.0, -64.0, 200.0, 200.0, -64.0, 200.0, 200.0, -460.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 200.0, -9.0, 200.0, 200.0, -262.0, 200.0, 200.0, 189.0, 200.0, 13.0, 123.0, 200.0, 189.0, 167.0, 200.0, 200.0, -130.0], "policy_predator_policy_reward": [30.0, 0.0, 50.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 0.0, 45.0, 75.0, 115.0, 0.0, 75.0, 0.0, 0.0, 75.0, 5.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 170.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 0.0, 0.0, 55.0, 5.0, 60.0, 0.0, 50.0, 60.0, 0.0, 0.0, 0.0, 15.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 5.0, 55.0, 120.0, 0.0, 0.0, 120.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 95.0, 0.0, 0.0, 210.0, 0.0, 0.0, 5.0, 0.0, 85.0, 35.0, 0.0, 5.0, 15.0, 0.0, 0.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3391634318266496, "mean_inference_ms": 1.3039876403561015, "mean_action_processing_ms": 0.13687491132848284, "mean_env_wait_ms": 0.10799746095664922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004399299621582031, "StateBufferConnector_ms": 0.0020859241485595703, "ViewRequirementAgentConnector_ms": 0.05130469799041748}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -160.0, "episode_return_mean": 168.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.9580510701993, "num_env_steps_trained_throughput_per_sec": 174.9580510701993, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 23413.741, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23413.448, "sample_time_ms": 835.211, "learn_time_ms": 22556.814, "learn_throughput": 177.33, "synch_weights_time_ms": 18.638}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 48, "trial_id": "25fa0_00000", "date": "2024-08-12_13-50-42", "timestamp": 1723485042, "time_this_iter_s": 22.8680739402771, "time_total_s": 1380.7890708446503, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1380.7890708446503, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.80606060606061, "ram_util_percent": 82.30909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6405950637611871, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5142573098031182, "policy_loss": -0.0020284841884858906, "vf_loss": 1.5162471616949915, "vf_explained_var": 5.8994504312674206e-05, "kl": 0.0027471354438417415, "entropy": 0.4753956578982373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.398843179425846, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5454225416916112, "policy_loss": -0.011017446040447491, "vf_loss": 1.5548075184846917, "vf_explained_var": 0.020632421101133027, "kl": 0.019347871441776004, "entropy": 1.2090197605391344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -454.0, "episode_reward_mean": 157.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -999.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 121.68, "predator_policy": 35.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 182.0, -4.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 26.0, 200.0, 200.0, 200.0, 134.0, 194.0, 128.0, 200.0, 140.0, 128.0, 200.0, 200.0, 200.0, 182.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 194.0, 134.0, 56.0, 200.0, 200.0, 56.0, 200.0, 200.0, -160.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 86.0, 200.0, 200.0, -52.0, 200.0, 200.0, 194.0, 200.0, 98.0, 158.0, 200.0, 194.0, 182.0, 200.0, 200.0, 20.0, 200.0, 146.0, 116.0, 200.0, 200.0, 32.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 2.0, 92.0, -454.0, 122.0, 74.0, 110.0, 200.0, 182.0, 68.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 167.0, -174.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, -119.0, 200.0, 200.0, 200.0, 79.0, 189.0, 68.0, 200.0, 90.0, 68.0, 200.0, 200.0, 200.0, 167.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 189.0, 79.0, -64.0, 200.0, 200.0, -64.0, 200.0, 200.0, -460.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 200.0, -9.0, 200.0, 200.0, -262.0, 200.0, 200.0, 189.0, 200.0, 13.0, 123.0, 200.0, 189.0, 167.0, 200.0, 200.0, -130.0, 200.0, 101.0, 46.0, 200.0, 200.0, -108.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -163.0, 2.0, -999.0, 57.0, -31.0, 35.0, 200.0, 167.0, -42.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 15.0, 170.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 145.0, 0.0, 0.0, 0.0, 55.0, 5.0, 60.0, 0.0, 50.0, 60.0, 0.0, 0.0, 0.0, 15.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 5.0, 55.0, 120.0, 0.0, 0.0, 120.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 95.0, 0.0, 0.0, 210.0, 0.0, 0.0, 5.0, 0.0, 85.0, 35.0, 0.0, 5.0, 15.0, 0.0, 0.0, 150.0, 0.0, 45.0, 70.0, 0.0, 0.0, 140.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 165.0, 90.0, 545.0, 65.0, 105.0, 75.0, 0.0, 15.0, 110.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33904903142306936, "mean_inference_ms": 1.304256175762566, "mean_action_processing_ms": 0.1369205865787749, "mean_env_wait_ms": 0.10801537200106655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005006194114685059, "StateBufferConnector_ms": 0.0020788908004760742, "ViewRequirementAgentConnector_ms": 0.05051994323730469}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -454.0, "episode_return_mean": 157.28, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.94980500900184, "num_env_steps_trained_throughput_per_sec": 172.94980500900184, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 23390.232, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23390.007, "sample_time_ms": 830.302, "learn_time_ms": 22538.129, "learn_throughput": 177.477, "synch_weights_time_ms": 18.839}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "training_iteration": 49, "trial_id": "25fa0_00000", "date": "2024-08-12_13-51-05", "timestamp": 1723485065, "time_this_iter_s": 23.164297103881836, "time_total_s": 1403.953367948532, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1403.953367948532, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 23.209090909090907, "ram_util_percent": 81.76969696969695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37875001243082806, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4057928871673842, "policy_loss": -0.003901517366466578, "vf_loss": 0.4096517122227245, "vf_explained_var": -0.00213279581318299, "kl": 0.006071837636605437, "entropy": 0.4280847298912704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.756509242237856, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4183595633989171, "policy_loss": -0.008410456745089808, "vf_loss": 0.4255696824793934, "vf_explained_var": 0.024625646198789278, "kl": 0.014226208550041974, "entropy": 1.1379362292587758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -454.0, "episode_reward_mean": 155.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -999.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 119.26, "predator_policy": 36.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 182.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 194.0, 134.0, 56.0, 200.0, 200.0, 56.0, 200.0, 200.0, -160.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 86.0, 200.0, 200.0, -52.0, 200.0, 200.0, 194.0, 200.0, 98.0, 158.0, 200.0, 194.0, 182.0, 200.0, 200.0, 20.0, 200.0, 146.0, 116.0, 200.0, 200.0, 32.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 2.0, 92.0, -454.0, 122.0, 74.0, 110.0, 200.0, 182.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 140.0, 2.0, 200.0, 200.0, 200.0, 146.0, -130.0, 200.0, 200.0, 56.0, 92.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 167.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 189.0, 79.0, -64.0, 200.0, 200.0, -64.0, 200.0, 200.0, -460.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 200.0, -9.0, 200.0, 200.0, -262.0, 200.0, 200.0, 189.0, 200.0, 13.0, 123.0, 200.0, 189.0, 167.0, 200.0, 200.0, -130.0, 200.0, 101.0, 46.0, 200.0, 200.0, -108.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -163.0, 2.0, -999.0, 57.0, -31.0, 35.0, 200.0, 167.0, -42.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 90.0, -163.0, 200.0, 200.0, 200.0, 101.0, -405.0, 200.0, 200.0, -64.0, 2.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 15.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 5.0, 55.0, 120.0, 0.0, 0.0, 120.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 95.0, 0.0, 0.0, 210.0, 0.0, 0.0, 5.0, 0.0, 85.0, 35.0, 0.0, 5.0, 15.0, 0.0, 0.0, 150.0, 0.0, 45.0, 70.0, 0.0, 0.0, 140.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 165.0, 90.0, 545.0, 65.0, 105.0, 75.0, 0.0, 15.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 50.0, 165.0, 0.0, 0.0, 0.0, 45.0, 275.0, 0.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3378113255056872, "mean_inference_ms": 1.2977096501657364, "mean_action_processing_ms": 0.1362807532453977, "mean_env_wait_ms": 0.10739373751876327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005464673042297363, "StateBufferConnector_ms": 0.0020133256912231445, "ViewRequirementAgentConnector_ms": 0.0495375394821167}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -454.0, "episode_return_mean": 155.96, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 168.76932851444775, "num_env_steps_trained_throughput_per_sec": 168.76932851444775, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 23429.859, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23429.634, "sample_time_ms": 832.302, "learn_time_ms": 22575.601, "learn_throughput": 177.182, "synch_weights_time_ms": 18.902}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 50, "trial_id": "25fa0_00000", "date": "2024-08-12_13-51-29", "timestamp": 1723485089, "time_this_iter_s": 23.731549978256226, "time_total_s": 1427.6849179267883, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2360af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1427.6849179267883, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.33529411764706, "ram_util_percent": 82.33235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.18437857105551908, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6737649846511583, "policy_loss": -0.0030318859363129983, "vf_loss": 0.6767657032309217, "vf_explained_var": 0.03616639214257399, "kl": 0.004432578984861241, "entropy": 0.25296248534383875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.093590613796065, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6810721088128048, "policy_loss": -0.0055290547888337946, "vf_loss": 0.6859453049655713, "vf_explained_var": 0.02032615877687931, "kl": 0.007773103271516538, "entropy": 1.0938535831868648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -454.0, "episode_reward_mean": 152.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -999.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 113.65, "predator_policy": 39.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.0, 200.0, 200.0, -160.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 200.0, 200.0, 170.0, 200.0, 200.0, 200.0, 200.0, 134.0, 200.0, 86.0, 200.0, 200.0, -52.0, 200.0, 200.0, 194.0, 200.0, 98.0, 158.0, 200.0, 194.0, 182.0, 200.0, 200.0, 20.0, 200.0, 146.0, 116.0, 200.0, 200.0, 32.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 2.0, 92.0, -454.0, 122.0, 74.0, 110.0, 200.0, 182.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 140.0, 2.0, 200.0, 200.0, 200.0, 146.0, -130.0, 200.0, 200.0, 56.0, 92.0, 200.0, 200.0, 200.0, 200.0, 56.0, 176.0, 200.0, 200.0, 200.0, 44.0, 200.0, 200.0, 200.0, 122.0, 200.0, 80.0, 176.0, 200.0, 200.0, 200.0, 98.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, 200.0, 200.0, -460.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 200.0, -9.0, 200.0, 200.0, -262.0, 200.0, 200.0, 189.0, 200.0, 13.0, 123.0, 200.0, 189.0, 167.0, 200.0, 200.0, -130.0, 200.0, 101.0, 46.0, 200.0, 200.0, -108.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -163.0, 2.0, -999.0, 57.0, -31.0, 35.0, 200.0, 167.0, -42.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 90.0, -163.0, 200.0, 200.0, 200.0, 101.0, -405.0, 200.0, 200.0, -64.0, 2.0, 200.0, 200.0, 200.0, 200.0, -64.0, 156.0, 200.0, 200.0, 200.0, -86.0, 200.0, 200.0, 200.0, 57.0, 200.0, -20.0, 156.0, 200.0, 200.0, 200.0, 13.0, 200.0], "policy_predator_policy_reward": [120.0, 0.0, 0.0, 300.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 95.0, 0.0, 0.0, 210.0, 0.0, 0.0, 5.0, 0.0, 85.0, 35.0, 0.0, 5.0, 15.0, 0.0, 0.0, 150.0, 0.0, 45.0, 70.0, 0.0, 0.0, 140.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 165.0, 90.0, 545.0, 65.0, 105.0, 75.0, 0.0, 15.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 50.0, 165.0, 0.0, 0.0, 0.0, 45.0, 275.0, 0.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0, 120.0, 20.0, 0.0, 0.0, 0.0, 130.0, 0.0, 0.0, 0.0, 65.0, 0.0, 100.0, 20.0, 0.0, 0.0, 0.0, 85.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33665805589041775, "mean_inference_ms": 1.2935119082626543, "mean_action_processing_ms": 0.13595131910317879, "mean_env_wait_ms": 0.10708926488678724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005211472511291504, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.05068063735961914}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -454.0, "episode_return_mean": 152.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.72983012668175, "num_env_steps_trained_throughput_per_sec": 166.72983012668175, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 23494.838, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23494.56, "sample_time_ms": 845.219, "learn_time_ms": 22627.862, "learn_throughput": 176.773, "synch_weights_time_ms": 19.006}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 51, "trial_id": "25fa0_00000", "date": "2024-08-12_13-51-53", "timestamp": 1723485113, "time_this_iter_s": 24.036580801010132, "time_total_s": 1451.7214987277985, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a22dc4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1451.7214987277985, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 26.452941176470585, "ram_util_percent": 82.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46757575833859544, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48776983146866165, "policy_loss": -0.0030601539906153145, "vf_loss": 0.4908209807003137, "vf_explained_var": 0.004151920539637407, "kl": 0.0025610676476618623, "entropy": 0.2931516794643054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5430694168433545, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48944311891003356, "policy_loss": -0.010463714405098775, "vf_loss": 0.4992394077061666, "vf_explained_var": 0.03403445618848006, "kl": 0.007910210808728252, "entropy": 1.0677552122622729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -454.0, "episode_reward_mean": 154.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -999.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 117.28, "predator_policy": 37.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 134.0, 200.0, 86.0, 200.0, 200.0, -52.0, 200.0, 200.0, 194.0, 200.0, 98.0, 158.0, 200.0, 194.0, 182.0, 200.0, 200.0, 20.0, 200.0, 146.0, 116.0, 200.0, 200.0, 32.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 2.0, 92.0, -454.0, 122.0, 74.0, 110.0, 200.0, 182.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 140.0, 2.0, 200.0, 200.0, 200.0, 146.0, -130.0, 200.0, 200.0, 56.0, 92.0, 200.0, 200.0, 200.0, 200.0, 56.0, 176.0, 200.0, 200.0, 200.0, 44.0, 200.0, 200.0, 200.0, 122.0, 200.0, 80.0, 176.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 188.0, 140.0, 200.0, 200.0, 200.0, 170.0, 92.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 79.0, 200.0, -9.0, 200.0, 200.0, -262.0, 200.0, 200.0, 189.0, 200.0, 13.0, 123.0, 200.0, 189.0, 167.0, 200.0, 200.0, -130.0, 200.0, 101.0, 46.0, 200.0, 200.0, -108.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -163.0, 2.0, -999.0, 57.0, -31.0, 35.0, 200.0, 167.0, -42.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 90.0, -163.0, 200.0, 200.0, 200.0, 101.0, -405.0, 200.0, 200.0, -64.0, 2.0, 200.0, 200.0, 200.0, 200.0, -64.0, 156.0, 200.0, 200.0, 200.0, -86.0, 200.0, 200.0, 200.0, 57.0, 200.0, -20.0, 156.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 178.0, 90.0, 200.0, 200.0, 200.0, 145.0, 2.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 55.0, 0.0, 95.0, 0.0, 0.0, 210.0, 0.0, 0.0, 5.0, 0.0, 85.0, 35.0, 0.0, 5.0, 15.0, 0.0, 0.0, 150.0, 0.0, 45.0, 70.0, 0.0, 0.0, 140.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 165.0, 90.0, 545.0, 65.0, 105.0, 75.0, 0.0, 15.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 50.0, 165.0, 0.0, 0.0, 0.0, 45.0, 275.0, 0.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0, 120.0, 20.0, 0.0, 0.0, 0.0, 130.0, 0.0, 0.0, 0.0, 65.0, 0.0, 100.0, 20.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 0.0, 25.0, 90.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3360430968306927, "mean_inference_ms": 1.2912269875622482, "mean_action_processing_ms": 0.13574386583017897, "mean_env_wait_ms": 0.10691999504930014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048296451568603516, "StateBufferConnector_ms": 0.002149224281311035, "ViewRequirementAgentConnector_ms": 0.051503658294677734}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -454.0, "episode_return_mean": 154.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.72325838370833, "num_env_steps_trained_throughput_per_sec": 172.72325838370833, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 23431.018, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23430.756, "sample_time_ms": 826.93, "learn_time_ms": 22582.379, "learn_throughput": 177.129, "synch_weights_time_ms": 19.148}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 52, "trial_id": "25fa0_00000", "date": "2024-08-12_13-52-16", "timestamp": 1723485136, "time_this_iter_s": 23.162877082824707, "time_total_s": 1474.8843758106232, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1474.8843758106232, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 22.963636363636365, "ram_util_percent": 82.02727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4880037577978025, "cur_kl_coeff": 0.0017578125000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6604167781459789, "policy_loss": -0.0005638200452570648, "vf_loss": 1.6609790933214148, "vf_explained_var": -1.6263499855995178e-05, "kl": 0.0008518411688823502, "entropy": 0.2423312176329394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.133379458946487, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6748048644512892, "policy_loss": -0.006028005600334533, "vf_loss": 1.6799423299108942, "vf_explained_var": 0.009941065373520056, "kl": 0.010554541944568974, "entropy": 1.0386111492291092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -454.0, "episode_reward_mean": 146.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -999.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 101.33, "predator_policy": 44.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 200.0, 146.0, 116.0, 200.0, 200.0, 32.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, 2.0, 92.0, -454.0, 122.0, 74.0, 110.0, 200.0, 182.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 140.0, 2.0, 200.0, 200.0, 200.0, 146.0, -130.0, 200.0, 200.0, 56.0, 92.0, 200.0, 200.0, 200.0, 200.0, 56.0, 176.0, 200.0, 200.0, 200.0, 44.0, 200.0, 200.0, 200.0, 122.0, 200.0, 80.0, 176.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 188.0, 140.0, 200.0, 200.0, 200.0, 170.0, 92.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 164.0, 32.0, 200.0, 80.0, 122.0, 200.0, 44.0, 200.0, -88.0, 98.0, 200.0, 38.0, 116.0, 20.0, 200.0, 116.0, 182.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, 200.0, 101.0, 46.0, 200.0, 200.0, -108.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -163.0, 2.0, -999.0, 57.0, -31.0, 35.0, 200.0, 167.0, -42.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 90.0, -163.0, 200.0, 200.0, 200.0, 101.0, -405.0, 200.0, 200.0, -64.0, 2.0, 200.0, 200.0, 200.0, 200.0, -64.0, 156.0, 200.0, 200.0, 200.0, -86.0, 200.0, 200.0, 200.0, 57.0, 200.0, -20.0, 156.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 178.0, 90.0, 200.0, 200.0, 200.0, 145.0, 2.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 134.0, -108.0, 200.0, -20.0, 57.0, 200.0, -86.0, 200.0, -328.0, 13.0, 200.0, -97.0, 46.0, -130.0, 200.0, 46.0, 167.0], "policy_predator_policy_reward": [150.0, 0.0, 45.0, 70.0, 0.0, 0.0, 140.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 165.0, 90.0, 545.0, 65.0, 105.0, 75.0, 0.0, 15.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 50.0, 165.0, 0.0, 0.0, 0.0, 45.0, 275.0, 0.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0, 120.0, 20.0, 0.0, 0.0, 0.0, 130.0, 0.0, 0.0, 0.0, 65.0, 0.0, 100.0, 20.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 0.0, 25.0, 90.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 30.0, 140.0, 0.0, 100.0, 65.0, 0.0, 130.0, 0.0, 240.0, 85.0, 0.0, 135.0, 70.0, 150.0, 0.0, 70.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33535133628126396, "mean_inference_ms": 1.288870453793022, "mean_action_processing_ms": 0.1355356085435822, "mean_env_wait_ms": 0.10674134852637451, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037376880645751953, "StateBufferConnector_ms": 0.0021048784255981445, "ViewRequirementAgentConnector_ms": 0.04783964157104492}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -454.0, "episode_return_mean": 146.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.82948605105688, "num_env_steps_trained_throughput_per_sec": 172.82948605105688, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 23418.423, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23418.189, "sample_time_ms": 824.249, "learn_time_ms": 22573.984, "learn_throughput": 177.195, "synch_weights_time_ms": 18.047}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "training_iteration": 53, "trial_id": "25fa0_00000", "date": "2024-08-12_13-52-39", "timestamp": 1723485159, "time_this_iter_s": 23.147933959960938, "time_total_s": 1498.032309770584, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487bd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1498.032309770584, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 22.09090909090909, "ram_util_percent": 81.05757575757576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2571105155434149, "cur_kl_coeff": 0.0008789062500000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.309656929038465, "policy_loss": 0.00016231474243492508, "vf_loss": 1.3094933688330153, "vf_explained_var": 0.01660970368733009, "kl": 0.0014218928987132155, "entropy": 0.20925437402911484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.87439781492576, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3125796235127685, "policy_loss": -0.007204998678450162, "vf_loss": 1.3191026020484666, "vf_explained_var": 0.009075941890478135, "kl": 0.008083195612551256, "entropy": 1.0238049348816276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -712.0, "episode_reward_mean": 149.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1472.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 760.0}, "policy_reward_mean": {"prey_policy": 106.72, "predator_policy": 42.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 140.0, 2.0, 200.0, 200.0, 200.0, 146.0, -130.0, 200.0, 200.0, 56.0, 92.0, 200.0, 200.0, 200.0, 200.0, 56.0, 176.0, 200.0, 200.0, 200.0, 44.0, 200.0, 200.0, 200.0, 122.0, 200.0, 80.0, 176.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 188.0, 140.0, 200.0, 200.0, 200.0, 170.0, 92.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 164.0, 32.0, 200.0, 80.0, 122.0, 200.0, 44.0, 200.0, -88.0, 98.0, 200.0, 38.0, 116.0, 20.0, 200.0, 116.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 38.0, -130.0, 200.0, 200.0, -712.0, 200.0, 200.0, 164.0, 170.0, 128.0, 200.0, 200.0, 74.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 90.0, -163.0, 200.0, 200.0, 200.0, 101.0, -405.0, 200.0, 200.0, -64.0, 2.0, 200.0, 200.0, 200.0, 200.0, -64.0, 156.0, 200.0, 200.0, 200.0, -86.0, 200.0, 200.0, 200.0, 57.0, 200.0, -20.0, 156.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 178.0, 90.0, 200.0, 200.0, 200.0, 145.0, 2.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 134.0, -108.0, 200.0, -20.0, 57.0, 200.0, -86.0, 200.0, -328.0, 13.0, 200.0, -97.0, 46.0, -130.0, 200.0, 46.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -97.0, -405.0, 200.0, 200.0, -1472.0, 200.0, 200.0, 134.0, 145.0, 68.0, 200.0, 200.0, -31.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 50.0, 165.0, 0.0, 0.0, 0.0, 45.0, 275.0, 0.0, 0.0, 120.0, 90.0, 0.0, 0.0, 0.0, 0.0, 120.0, 20.0, 0.0, 0.0, 0.0, 130.0, 0.0, 0.0, 0.0, 65.0, 0.0, 100.0, 20.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 0.0, 25.0, 90.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 30.0, 140.0, 0.0, 100.0, 65.0, 0.0, 130.0, 0.0, 240.0, 85.0, 0.0, 135.0, 70.0, 150.0, 0.0, 70.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 135.0, 275.0, 0.0, 0.0, 760.0, 0.0, 0.0, 30.0, 25.0, 60.0, 0.0, 0.0, 105.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3345619976198806, "mean_inference_ms": 1.286290039993509, "mean_action_processing_ms": 0.13530369734861666, "mean_env_wait_ms": 0.10655578442888743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030840635299682617, "StateBufferConnector_ms": 0.002105236053466797, "ViewRequirementAgentConnector_ms": 0.0481257438659668}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -712.0, "episode_return_mean": 149.12, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.43394081703744, "num_env_steps_trained_throughput_per_sec": 153.43394081703744, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 23712.052, "restore_workers_time_ms": 0.018, "training_step_time_ms": 23711.805, "sample_time_ms": 815.314, "learn_time_ms": 22874.949, "learn_throughput": 174.864, "synch_weights_time_ms": 19.286}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 54, "trial_id": "25fa0_00000", "date": "2024-08-12_13-53-06", "timestamp": 1723485186, "time_this_iter_s": 26.129273176193237, "time_total_s": 1524.1615829467773, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1524.1615829467773, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 37.75135135135135, "ram_util_percent": 81.95675675675675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4542295830207877, "cur_kl_coeff": 0.0004394531250000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9898031175136566, "policy_loss": -0.0014561588638268101, "vf_loss": 0.9912586643050114, "vf_explained_var": 0.0023977456614375113, "kl": 0.001399667574880444, "entropy": 0.21117910530107717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.338525921540955, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0077977828138198, "policy_loss": -0.002412483738589799, "vf_loss": 1.009597261440164, "vf_explained_var": 0.007204867651065191, "kl": 0.0072652741811528665, "entropy": 1.002113694138825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -712.0, "episode_reward_mean": 148.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1472.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 760.0}, "policy_reward_mean": {"prey_policy": 106.17, "predator_policy": 42.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 56.0, 176.0, 200.0, 200.0, 200.0, 44.0, 200.0, 200.0, 200.0, 122.0, 200.0, 80.0, 176.0, 200.0, 200.0, 200.0, 98.0, 200.0, 200.0, 200.0, 188.0, 140.0, 200.0, 200.0, 200.0, 170.0, 92.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 164.0, 32.0, 200.0, 80.0, 122.0, 200.0, 44.0, 200.0, -88.0, 98.0, 200.0, 38.0, 116.0, 20.0, 200.0, 116.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 38.0, -130.0, 200.0, 200.0, -712.0, 200.0, 200.0, 164.0, 170.0, 128.0, 200.0, 200.0, 74.0, 200.0, 200.0, 200.0, 200.0, 200.0, 86.0, 200.0, 86.0, 200.0, -130.0, 200.0, 200.0, 170.0, 8.0, 152.0, 158.0, 200.0, 200.0, 200.0, 200.0, 158.0, 134.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -64.0, 156.0, 200.0, 200.0, 200.0, -86.0, 200.0, 200.0, 200.0, 57.0, 200.0, -20.0, 156.0, 200.0, 200.0, 200.0, 13.0, 200.0, 200.0, 200.0, 178.0, 90.0, 200.0, 200.0, 200.0, 145.0, 2.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 134.0, -108.0, 200.0, -20.0, 57.0, 200.0, -86.0, 200.0, -328.0, 13.0, 200.0, -97.0, 46.0, -130.0, 200.0, 46.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -97.0, -405.0, 200.0, 200.0, -1472.0, 200.0, 200.0, 134.0, 145.0, 68.0, 200.0, 200.0, -31.0, 200.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -9.0, 200.0, -405.0, 200.0, 200.0, 145.0, -152.0, 112.0, 123.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 120.0, 20.0, 0.0, 0.0, 0.0, 130.0, 0.0, 0.0, 0.0, 65.0, 0.0, 100.0, 20.0, 0.0, 0.0, 0.0, 85.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 0.0, 25.0, 90.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 30.0, 140.0, 0.0, 100.0, 65.0, 0.0, 130.0, 0.0, 240.0, 85.0, 0.0, 135.0, 70.0, 150.0, 0.0, 70.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 135.0, 275.0, 0.0, 0.0, 760.0, 0.0, 0.0, 30.0, 25.0, 60.0, 0.0, 0.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 95.0, 0.0, 275.0, 0.0, 0.0, 25.0, 160.0, 40.0, 35.0, 0.0, 0.0, 0.0, 0.0, 35.0, 55.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33448838702352846, "mean_inference_ms": 1.28632490902851, "mean_action_processing_ms": 0.13532194877005785, "mean_env_wait_ms": 0.10653289276397476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002530813217163086, "StateBufferConnector_ms": 0.0021436214447021484, "ViewRequirementAgentConnector_ms": 0.0505976676940918}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -712.0, "episode_return_mean": 148.82, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.33382767906394, "num_env_steps_trained_throughput_per_sec": 169.33382767906394, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 23753.313, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23753.057, "sample_time_ms": 860.344, "learn_time_ms": 22871.057, "learn_throughput": 174.894, "synch_weights_time_ms": 19.393}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 55, "trial_id": "25fa0_00000", "date": "2024-08-12_13-53-29", "timestamp": 1723485209, "time_this_iter_s": 23.649593830108643, "time_total_s": 1547.811176776886, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1547.811176776886, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 26.48235294117647, "ram_util_percent": 82.81764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37932341611788917, "cur_kl_coeff": 0.00021972656250000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.286370805837214, "policy_loss": -0.00231700001071052, "vf_loss": 1.2886876162452003, "vf_explained_var": 0.01422729759166638, "kl": 0.000841770755252802, "entropy": 0.251269406809782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.602309862772624, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2938469503948, "policy_loss": -0.012355313503940124, "vf_loss": 1.305692356382709, "vf_explained_var": 0.018399498797953127, "kl": 0.006043361336532808, "entropy": 1.0479290828108787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -712.0, "episode_reward_mean": 144.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1472.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 760.0}, "policy_reward_mean": {"prey_policy": 98.25, "predator_policy": 46.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 188.0, 140.0, 200.0, 200.0, 200.0, 170.0, 92.0, 200.0, 200.0, 86.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 164.0, 32.0, 200.0, 80.0, 122.0, 200.0, 44.0, 200.0, -88.0, 98.0, 200.0, 38.0, 116.0, 20.0, 200.0, 116.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 38.0, -130.0, 200.0, 200.0, -712.0, 200.0, 200.0, 164.0, 170.0, 128.0, 200.0, 200.0, 74.0, 200.0, 200.0, 200.0, 200.0, 200.0, 86.0, 200.0, 86.0, 200.0, -130.0, 200.0, 200.0, 170.0, 8.0, 152.0, 158.0, 200.0, 200.0, 200.0, 200.0, 158.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 152.0, 2.0, 200.0, 200.0, 200.0, 200.0, -28.0, -268.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 178.0, 90.0, 200.0, 200.0, 200.0, 145.0, 2.0, 200.0, 200.0, -9.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 134.0, -108.0, 200.0, -20.0, 57.0, 200.0, -86.0, 200.0, -328.0, 13.0, 200.0, -97.0, 46.0, -130.0, 200.0, 46.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -97.0, -405.0, 200.0, 200.0, -1472.0, 200.0, 200.0, 134.0, 145.0, 68.0, 200.0, 200.0, -31.0, 200.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -9.0, 200.0, -405.0, 200.0, 200.0, 145.0, -152.0, 112.0, 123.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 112.0, -163.0, 200.0, 200.0, 200.0, 200.0, -218.0, -658.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 0.0, 25.0, 90.0, 0.0, 0.0, 95.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 30.0, 140.0, 0.0, 100.0, 65.0, 0.0, 130.0, 0.0, 240.0, 85.0, 0.0, 135.0, 70.0, 150.0, 0.0, 70.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 135.0, 275.0, 0.0, 0.0, 760.0, 0.0, 0.0, 30.0, 25.0, 60.0, 0.0, 0.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 95.0, 0.0, 275.0, 0.0, 0.0, 25.0, 160.0, 40.0, 35.0, 0.0, 0.0, 0.0, 0.0, 35.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 40.0, 165.0, 0.0, 0.0, 0.0, 0.0, 190.0, 390.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3345360552188465, "mean_inference_ms": 1.2863142745906417, "mean_action_processing_ms": 0.13531038298359074, "mean_env_wait_ms": 0.10647193326445403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025415420532226562, "StateBufferConnector_ms": 0.0021616220474243164, "ViewRequirementAgentConnector_ms": 0.0516277551651001}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -712.0, "episode_return_mean": 144.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.03008437225412, "num_env_steps_trained_throughput_per_sec": 163.03008437225412, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 23880.225, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23879.947, "sample_time_ms": 865.534, "learn_time_ms": 22992.362, "learn_throughput": 173.971, "synch_weights_time_ms": 19.985}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 56, "trial_id": "25fa0_00000", "date": "2024-08-12_13-53-54", "timestamp": 1723485234, "time_this_iter_s": 24.61634111404419, "time_total_s": 1572.4275178909302, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1572.4275178909302, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 28.717142857142854, "ram_util_percent": 82.44857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2138895365409553, "cur_kl_coeff": 0.00010986328125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9452714298386127, "policy_loss": -0.0028445229307787184, "vf_loss": 0.9481155643960619, "vf_explained_var": 0.014947745203971862, "kl": 0.0035127840723939005, "entropy": 0.24450451629236342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.946714783304682, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9531584313993032, "policy_loss": -0.008158865104875682, "vf_loss": 0.9603803148169997, "vf_explained_var": 0.02718765897055467, "kl": 0.011104899622023368, "entropy": 1.0490493794282278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -850.0, "episode_reward_mean": 126.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1725.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": 65.25, "predator_policy": 61.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 164.0, 32.0, 200.0, 80.0, 122.0, 200.0, 44.0, 200.0, -88.0, 98.0, 200.0, 38.0, 116.0, 20.0, 200.0, 116.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 38.0, -130.0, 200.0, 200.0, -712.0, 200.0, 200.0, 164.0, 170.0, 128.0, 200.0, 200.0, 74.0, 200.0, 200.0, 200.0, 200.0, 200.0, 86.0, 200.0, 86.0, 200.0, -130.0, 200.0, 200.0, 170.0, 8.0, 152.0, 158.0, 200.0, 200.0, 200.0, 200.0, 158.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 152.0, 2.0, 200.0, 200.0, 200.0, 200.0, -28.0, -268.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -850.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, 26.0, 188.0, 200.0, -592.0, 200.0, 116.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 134.0, -108.0, 200.0, -20.0, 57.0, 200.0, -86.0, 200.0, -328.0, 13.0, 200.0, -97.0, 46.0, -130.0, 200.0, 46.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -97.0, -405.0, 200.0, 200.0, -1472.0, 200.0, 200.0, 134.0, 145.0, 68.0, 200.0, 200.0, -31.0, 200.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -9.0, 200.0, -405.0, 200.0, 200.0, 145.0, -152.0, 112.0, 123.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 112.0, -163.0, 200.0, 200.0, 200.0, 200.0, -218.0, -658.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -119.0, 178.0, 200.0, -1252.0, 200.0, 46.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 30.0, 140.0, 0.0, 100.0, 65.0, 0.0, 130.0, 0.0, 240.0, 85.0, 0.0, 135.0, 70.0, 150.0, 0.0, 70.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 135.0, 275.0, 0.0, 0.0, 760.0, 0.0, 0.0, 30.0, 25.0, 60.0, 0.0, 0.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 95.0, 0.0, 275.0, 0.0, 0.0, 25.0, 160.0, 40.0, 35.0, 0.0, 0.0, 0.0, 0.0, 35.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 40.0, 165.0, 0.0, 0.0, 0.0, 0.0, 190.0, 390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 875.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 145.0, 10.0, 0.0, 660.0, 0.0, 70.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3345467288822032, "mean_inference_ms": 1.2860609252199902, "mean_action_processing_ms": 0.13529254927050655, "mean_env_wait_ms": 0.1063680020412707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0025734901428222656, "StateBufferConnector_ms": 0.0021467208862304688, "ViewRequirementAgentConnector_ms": 0.05308353900909424}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -850.0, "episode_return_mean": 126.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.06562302538478, "num_env_steps_trained_throughput_per_sec": 173.06562302538478, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 23732.564, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23732.286, "sample_time_ms": 866.414, "learn_time_ms": 22843.51, "learn_throughput": 175.104, "synch_weights_time_ms": 20.43}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 57, "trial_id": "25fa0_00000", "date": "2024-08-12_13-54-17", "timestamp": 1723485257, "time_this_iter_s": 23.14295196533203, "time_total_s": 1595.5704698562622, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1595.5704698562622, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 24.127272727272732, "ram_util_percent": 82.34545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6745765569852665, "cur_kl_coeff": 5.4931640625000015e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7774063300962248, "policy_loss": -0.012391537315609942, "vf_loss": 1.7897920961181322, "vf_explained_var": 0.006011694855988026, "kl": 0.1049157413961798, "entropy": 0.4097269002503405, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.427086993058523, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7922514416277409, "policy_loss": -0.009662205566322276, "vf_loss": 1.801409197350343, "vf_explained_var": 0.010415313889582951, "kl": 0.005978657458720023, "entropy": 1.0896141855667034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -850.0, "episode_reward_mean": 126.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1725.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 875.0}, "policy_reward_mean": {"prey_policy": 65.03, "predator_policy": 61.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 38.0, -130.0, 200.0, 200.0, -712.0, 200.0, 200.0, 164.0, 170.0, 128.0, 200.0, 200.0, 74.0, 200.0, 200.0, 200.0, 200.0, 200.0, 86.0, 200.0, 86.0, 200.0, -130.0, 200.0, 200.0, 170.0, 8.0, 152.0, 158.0, 200.0, 200.0, 200.0, 200.0, 158.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 152.0, 2.0, 200.0, 200.0, 200.0, 200.0, -28.0, -268.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -850.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, 26.0, 188.0, 200.0, -592.0, 200.0, 116.0, 200.0, 200.0, 200.0, 182.0, 44.0, 62.0, -40.0, 200.0, 110.0, 200.0, 164.0, 200.0, 200.0, 194.0, 200.0, 200.0, 194.0, 74.0, 200.0, 14.0, -274.0, 200.0, 188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -97.0, -405.0, 200.0, 200.0, -1472.0, 200.0, 200.0, 134.0, 145.0, 68.0, 200.0, 200.0, -31.0, 200.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -9.0, 200.0, -405.0, 200.0, 200.0, 145.0, -152.0, 112.0, 123.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 112.0, -163.0, 200.0, 200.0, 200.0, 200.0, -218.0, -658.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -119.0, 178.0, 200.0, -1252.0, 200.0, 46.0, 200.0, 200.0, 200.0, 167.0, -86.0, -53.0, -240.0, 200.0, 35.0, 200.0, 134.0, 200.0, 200.0, 189.0, 200.0, 200.0, 189.0, -31.0, 200.0, -141.0, -669.0, 200.0, 178.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 135.0, 275.0, 0.0, 0.0, 760.0, 0.0, 0.0, 30.0, 25.0, 60.0, 0.0, 0.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 95.0, 0.0, 275.0, 0.0, 0.0, 25.0, 160.0, 40.0, 35.0, 0.0, 0.0, 0.0, 0.0, 35.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 40.0, 165.0, 0.0, 0.0, 0.0, 0.0, 190.0, 390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 875.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 145.0, 10.0, 0.0, 660.0, 0.0, 70.0, 0.0, 0.0, 0.0, 15.0, 130.0, 115.0, 200.0, 0.0, 75.0, 0.0, 30.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 105.0, 0.0, 155.0, 395.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33575655111480107, "mean_inference_ms": 1.3016758259169159, "mean_action_processing_ms": 0.1358554545427974, "mean_env_wait_ms": 0.10676459605552585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030344724655151367, "StateBufferConnector_ms": 0.0022231340408325195, "ViewRequirementAgentConnector_ms": 0.057602882385253906}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -850.0, "episode_return_mean": 126.38, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.3179649361029, "num_env_steps_trained_throughput_per_sec": 159.3179649361029, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 23957.004, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23956.713, "sample_time_ms": 1014.084, "learn_time_ms": 22919.509, "learn_throughput": 174.524, "synch_weights_time_ms": 21.006}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 58, "trial_id": "25fa0_00000", "date": "2024-08-12_13-54-42", "timestamp": 1723485282, "time_this_iter_s": 25.141278982162476, "time_total_s": 1620.7117488384247, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a489a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1620.7117488384247, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 28.70285714285714, "ram_util_percent": 83.38000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44863898868206886, "cur_kl_coeff": 8.239746093750002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8177981913089751, "policy_loss": -0.003200003199162893, "vf_loss": 1.820997688329468, "vf_explained_var": 0.0058943260461092, "kl": 0.006077805552289002, "entropy": 0.4244343118742108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.308681335238119, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8294609722681343, "policy_loss": -0.010450741212116555, "vf_loss": 1.839329499999682, "vf_explained_var": 0.019621863464514413, "kl": 0.006900347792311991, "entropy": 1.0979291141033172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 102.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": 21.8, "predator_policy": 81.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 86.0, 200.0, 86.0, 200.0, -130.0, 200.0, 200.0, 170.0, 8.0, 152.0, 158.0, 200.0, 200.0, 200.0, 200.0, 158.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 152.0, 2.0, 200.0, 200.0, 200.0, 200.0, -28.0, -268.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -850.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, 26.0, 188.0, 200.0, -592.0, 200.0, 116.0, 200.0, 200.0, 200.0, 182.0, 44.0, 62.0, -40.0, 200.0, 110.0, 200.0, 164.0, 200.0, 200.0, 194.0, 200.0, 200.0, 194.0, 74.0, 200.0, 14.0, -274.0, 200.0, 188.0, 56.0, 200.0, 164.0, -682.0, 200.0, 200.0, 200.0, 200.0, 104.0, -466.0, -766.0, 200.0, -958.0, 122.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -9.0, 200.0, -9.0, 200.0, -405.0, 200.0, 200.0, 145.0, -152.0, 112.0, 123.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 112.0, -163.0, 200.0, 200.0, 200.0, 200.0, -218.0, -658.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -119.0, 178.0, 200.0, -1252.0, 200.0, 46.0, 200.0, 200.0, 200.0, 167.0, -86.0, -53.0, -240.0, 200.0, 35.0, 200.0, 134.0, 200.0, 200.0, 189.0, 200.0, 200.0, 189.0, -31.0, 200.0, -141.0, -669.0, 200.0, 178.0, -64.0, 200.0, 134.0, -1417.0, 200.0, 200.0, 200.0, 200.0, 24.0, -1021.0, -1571.0, 200.0, -1923.0, 57.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 95.0, 0.0, 95.0, 0.0, 275.0, 0.0, 0.0, 25.0, 160.0, 40.0, 35.0, 0.0, 0.0, 0.0, 0.0, 35.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 40.0, 165.0, 0.0, 0.0, 0.0, 0.0, 190.0, 390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 875.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 145.0, 10.0, 0.0, 660.0, 0.0, 70.0, 0.0, 0.0, 0.0, 15.0, 130.0, 115.0, 200.0, 0.0, 75.0, 0.0, 30.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 105.0, 0.0, 155.0, 395.0, 0.0, 10.0, 120.0, 0.0, 30.0, 735.0, 0.0, 0.0, 0.0, 0.0, 80.0, 555.0, 805.0, 0.0, 965.0, 65.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355209960141925, "mean_inference_ms": 1.307764412195279, "mean_action_processing_ms": 0.13566954404270531, "mean_env_wait_ms": 0.10656602842569879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031118392944335938, "StateBufferConnector_ms": 0.002279520034790039, "ViewRequirementAgentConnector_ms": 0.0583873987197876}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 102.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.1294448404988, "num_env_steps_trained_throughput_per_sec": 164.1294448404988, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 24081.3, "restore_workers_time_ms": 0.023, "training_step_time_ms": 24081.012, "sample_time_ms": 1031.269, "learn_time_ms": 23026.959, "learn_throughput": 173.709, "synch_weights_time_ms": 20.696}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "training_iteration": 59, "trial_id": "25fa0_00000", "date": "2024-08-12_13-55-07", "timestamp": 1723485307, "time_this_iter_s": 24.428523063659668, "time_total_s": 1645.1402719020844, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a489a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.1402719020844, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 29.642857142857142, "ram_util_percent": 82.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5560369045318415, "cur_kl_coeff": 8.239746093750002e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.069288807734847, "policy_loss": -0.0035551277551955232, "vf_loss": 1.0728435532898444, "vf_explained_var": 0.008233045786619186, "kl": 0.004591630892383695, "entropy": 0.4548816349978248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.254416832886636, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0942865698753546, "policy_loss": -0.010285410918974473, "vf_loss": 1.1038035734246174, "vf_explained_var": 0.027145698294043542, "kl": 0.009107062271808885, "entropy": 1.1091016344726086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 97.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": 12.78, "predator_policy": 85.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 62.0, 200.0, 200.0, 200.0, 200.0, 152.0, 2.0, 200.0, 200.0, 200.0, 200.0, -28.0, -268.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -850.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, 26.0, 188.0, 200.0, -592.0, 200.0, 116.0, 200.0, 200.0, 200.0, 182.0, 44.0, 62.0, -40.0, 200.0, 110.0, 200.0, 164.0, 200.0, 200.0, 194.0, 200.0, 200.0, 194.0, 74.0, 200.0, 14.0, -274.0, 200.0, 188.0, 56.0, 200.0, 164.0, -682.0, 200.0, 200.0, 200.0, 200.0, 104.0, -466.0, -766.0, 200.0, -958.0, 122.0, 200.0, 200.0, 200.0, 200.0, -364.0, 200.0, 200.0, -28.0, 146.0, 8.0, 188.0, 170.0, 104.0, 200.0, 200.0, 74.0, 200.0, 74.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 200.0, 112.0, -163.0, 200.0, 200.0, 200.0, 200.0, -218.0, -658.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -119.0, 178.0, 200.0, -1252.0, 200.0, 46.0, 200.0, 200.0, 200.0, 167.0, -86.0, -53.0, -240.0, 200.0, 35.0, 200.0, 134.0, 200.0, 200.0, 189.0, 200.0, 200.0, 189.0, -31.0, 200.0, -141.0, -669.0, 200.0, 178.0, -64.0, 200.0, 134.0, -1417.0, 200.0, 200.0, 200.0, 200.0, 24.0, -1021.0, -1571.0, 200.0, -1923.0, 57.0, 200.0, 200.0, 200.0, 200.0, -834.0, 200.0, 200.0, -218.0, 101.0, -152.0, 178.0, 145.0, 24.0, 200.0, 200.0, -31.0, 200.0, -31.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 115.0, 0.0, 0.0, 0.0, 0.0, 40.0, 165.0, 0.0, 0.0, 0.0, 0.0, 190.0, 390.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 875.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 145.0, 10.0, 0.0, 660.0, 0.0, 70.0, 0.0, 0.0, 0.0, 15.0, 130.0, 115.0, 200.0, 0.0, 75.0, 0.0, 30.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 105.0, 0.0, 155.0, 395.0, 0.0, 10.0, 120.0, 0.0, 30.0, 735.0, 0.0, 0.0, 0.0, 0.0, 80.0, 555.0, 805.0, 0.0, 965.0, 65.0, 0.0, 0.0, 0.0, 0.0, 470.0, 0.0, 0.0, 190.0, 45.0, 160.0, 10.0, 25.0, 80.0, 0.0, 0.0, 105.0, 0.0, 105.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33560974422158246, "mean_inference_ms": 1.3188128882027876, "mean_action_processing_ms": 0.1357841197022771, "mean_env_wait_ms": 0.10662349459613443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035325288772583008, "StateBufferConnector_ms": 0.0024421215057373047, "ViewRequirementAgentConnector_ms": 0.06301617622375488}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 97.88, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.31630004786757, "num_env_steps_trained_throughput_per_sec": 167.31630004786757, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 24101.884, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24101.577, "sample_time_ms": 1049.487, "learn_time_ms": 23028.709, "learn_throughput": 173.696, "synch_weights_time_ms": 21.247}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 60, "trial_id": "25fa0_00000", "date": "2024-08-12_13-55-31", "timestamp": 1723485331, "time_this_iter_s": 23.931736707687378, "time_total_s": 1669.0720086097717, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a485ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1669.0720086097717, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 27.041176470588233, "ram_util_percent": 82.48235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49615647660102696, "cur_kl_coeff": 4.119873046875001e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6951738027234873, "policy_loss": -0.0021995678839933437, "vf_loss": 1.6973731779803833, "vf_explained_var": 0.003439273436864217, "kl": 0.004609431849211713, "entropy": 0.4722936922684312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.856878262137373, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.695779487154808, "policy_loss": -0.011467854453561207, "vf_loss": 1.70675960102429, "vf_explained_var": 0.018807417216400304, "kl": 0.0057806725874987325, "entropy": 1.1236144458254178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 93.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": 5.63, "predator_policy": 88.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 200.0, 200.0, -850.0, 200.0, 200.0, 182.0, 200.0, 200.0, 182.0, 26.0, 188.0, 200.0, -592.0, 200.0, 116.0, 200.0, 200.0, 200.0, 182.0, 44.0, 62.0, -40.0, 200.0, 110.0, 200.0, 164.0, 200.0, 200.0, 194.0, 200.0, 200.0, 194.0, 74.0, 200.0, 14.0, -274.0, 200.0, 188.0, 56.0, 200.0, 164.0, -682.0, 200.0, 200.0, 200.0, 200.0, 104.0, -466.0, -766.0, 200.0, -958.0, 122.0, 200.0, 200.0, 200.0, 200.0, -364.0, 200.0, 200.0, -28.0, 146.0, 8.0, 188.0, 170.0, 104.0, 200.0, 200.0, 74.0, 200.0, 74.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 92.0, 200.0, 200.0, -10.0, 200.0, -64.0, 200.0, 200.0, 62.0, -280.0, 200.0, 152.0, 170.0, 200.0, 8.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 200.0, 200.0, -1725.0, 200.0, 200.0, 167.0, 200.0, 200.0, 167.0, -119.0, 178.0, 200.0, -1252.0, 200.0, 46.0, 200.0, 200.0, 200.0, 167.0, -86.0, -53.0, -240.0, 200.0, 35.0, 200.0, 134.0, 200.0, 200.0, 189.0, 200.0, 200.0, 189.0, -31.0, 200.0, -141.0, -669.0, 200.0, 178.0, -64.0, 200.0, 134.0, -1417.0, 200.0, 200.0, 200.0, 200.0, 24.0, -1021.0, -1571.0, 200.0, -1923.0, 57.0, 200.0, 200.0, 200.0, 200.0, -834.0, 200.0, 200.0, -218.0, 101.0, -152.0, 178.0, 145.0, 24.0, 200.0, 200.0, -31.0, 200.0, -31.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, -185.0, 200.0, -284.0, 200.0, 200.0, -53.0, -680.0, 200.0, 112.0, 145.0, 200.0, -152.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 875.0, 0.0, 0.0, 15.0, 0.0, 0.0, 15.0, 145.0, 10.0, 0.0, 660.0, 0.0, 70.0, 0.0, 0.0, 0.0, 15.0, 130.0, 115.0, 200.0, 0.0, 75.0, 0.0, 30.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 105.0, 0.0, 155.0, 395.0, 0.0, 10.0, 120.0, 0.0, 30.0, 735.0, 0.0, 0.0, 0.0, 0.0, 80.0, 555.0, 805.0, 0.0, 965.0, 65.0, 0.0, 0.0, 0.0, 0.0, 470.0, 0.0, 0.0, 190.0, 45.0, 160.0, 10.0, 25.0, 80.0, 0.0, 0.0, 105.0, 0.0, 105.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 0.0, 175.0, 0.0, 220.0, 0.0, 0.0, 115.0, 400.0, 0.0, 40.0, 25.0, 0.0, 160.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3355344961557559, "mean_inference_ms": 1.327034981918883, "mean_action_processing_ms": 0.13584465960724415, "mean_env_wait_ms": 0.10668183130110002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034990310668945312, "StateBufferConnector_ms": 0.0023888349533081055, "ViewRequirementAgentConnector_ms": 0.06159234046936035}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 93.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.22947982623083, "num_env_steps_trained_throughput_per_sec": 175.22947982623083, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 23985.488, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23985.302, "sample_time_ms": 1041.278, "learn_time_ms": 22920.823, "learn_throughput": 174.514, "synch_weights_time_ms": 21.352}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "training_iteration": 61, "trial_id": "25fa0_00000", "date": "2024-08-12_13-55-54", "timestamp": 1723485354, "time_this_iter_s": 22.852415323257446, "time_total_s": 1691.9244239330292, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1691.9244239330292, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 22.63939393939394, "ram_util_percent": 82.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.418344088527374, "cur_kl_coeff": 2.0599365234375005e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.032867223303765, "policy_loss": -0.0010885852927458473, "vf_loss": 1.0339557172148601, "vf_explained_var": 0.00320450725654761, "kl": 0.00422271755970242, "entropy": 0.5132060263305902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.97529732187589, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0331950831692667, "policy_loss": -0.008594780625814261, "vf_loss": 1.0413132620975376, "vf_explained_var": 0.036913059279322626, "kl": 0.0056486693455156, "entropy": 1.0698980130255222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 96.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": 10.47, "predator_policy": 86.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 182.0, 44.0, 62.0, -40.0, 200.0, 110.0, 200.0, 164.0, 200.0, 200.0, 194.0, 200.0, 200.0, 194.0, 74.0, 200.0, 14.0, -274.0, 200.0, 188.0, 56.0, 200.0, 164.0, -682.0, 200.0, 200.0, 200.0, 200.0, 104.0, -466.0, -766.0, 200.0, -958.0, 122.0, 200.0, 200.0, 200.0, 200.0, -364.0, 200.0, 200.0, -28.0, 146.0, 8.0, 188.0, 170.0, 104.0, 200.0, 200.0, 74.0, 200.0, 74.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 92.0, 200.0, 200.0, -10.0, 200.0, -64.0, 200.0, 200.0, 62.0, -280.0, 200.0, 152.0, 170.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -106.0, 200.0, 200.0, 200.0, -682.0, 128.0, 2.0, 134.0, 200.0, -160.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 167.0, -86.0, -53.0, -240.0, 200.0, 35.0, 200.0, 134.0, 200.0, 200.0, 189.0, 200.0, 200.0, 189.0, -31.0, 200.0, -141.0, -669.0, 200.0, 178.0, -64.0, 200.0, 134.0, -1417.0, 200.0, 200.0, 200.0, 200.0, 24.0, -1021.0, -1571.0, 200.0, -1923.0, 57.0, 200.0, 200.0, 200.0, 200.0, -834.0, 200.0, 200.0, -218.0, 101.0, -152.0, 178.0, 145.0, 24.0, 200.0, 200.0, -31.0, 200.0, -31.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, -185.0, 200.0, -284.0, 200.0, 200.0, -53.0, -680.0, 200.0, 112.0, 145.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -361.0, 200.0, 200.0, 200.0, -1417.0, 68.0, -163.0, 79.0, 200.0, -460.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 15.0, 130.0, 115.0, 200.0, 0.0, 75.0, 0.0, 30.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 105.0, 0.0, 155.0, 395.0, 0.0, 10.0, 120.0, 0.0, 30.0, 735.0, 0.0, 0.0, 0.0, 0.0, 80.0, 555.0, 805.0, 0.0, 965.0, 65.0, 0.0, 0.0, 0.0, 0.0, 470.0, 0.0, 0.0, 190.0, 45.0, 160.0, 10.0, 25.0, 80.0, 0.0, 0.0, 105.0, 0.0, 105.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 0.0, 175.0, 0.0, 220.0, 0.0, 0.0, 115.0, 400.0, 0.0, 40.0, 25.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 255.0, 0.0, 0.0, 0.0, 735.0, 60.0, 165.0, 55.0, 0.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3354613946117145, "mean_inference_ms": 1.3350039412397476, "mean_action_processing_ms": 0.13590429490940029, "mean_env_wait_ms": 0.10674873843202544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003461480140686035, "StateBufferConnector_ms": 0.002353072166442871, "ViewRequirementAgentConnector_ms": 0.06067073345184326}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 96.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.12581781231356, "num_env_steps_trained_throughput_per_sec": 174.12581781231356, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 23966.834, "restore_workers_time_ms": 0.023, "training_step_time_ms": 23966.648, "sample_time_ms": 1036.164, "learn_time_ms": 22907.403, "learn_throughput": 174.616, "synch_weights_time_ms": 21.212}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 62, "trial_id": "25fa0_00000", "date": "2024-08-12_13-56-17", "timestamp": 1723485377, "time_this_iter_s": 23.029749870300293, "time_total_s": 1714.9541738033295, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1714.9541738033295, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 23.6875, "ram_util_percent": 81.884375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6297562696582948, "cur_kl_coeff": 1.0299682617187502e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5560796361416578, "policy_loss": -0.0025261722248008786, "vf_loss": 1.558605421986431, "vf_explained_var": 0.0043339485923449194, "kl": 0.03557013244500808, "entropy": 0.6083444871629278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.608587129538258, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.566102985831094, "policy_loss": -0.007786003570072353, "vf_loss": 1.5734610391759816, "vf_explained_var": 0.012763459111253421, "kl": 0.005072044632719515, "entropy": 1.0921576240410407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -958.0, "episode_reward_mean": 91.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": 1.67, "predator_policy": 90.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [188.0, 56.0, 200.0, 164.0, -682.0, 200.0, 200.0, 200.0, 200.0, 104.0, -466.0, -766.0, 200.0, -958.0, 122.0, 200.0, 200.0, 200.0, 200.0, -364.0, 200.0, 200.0, -28.0, 146.0, 8.0, 188.0, 170.0, 104.0, 200.0, 200.0, 74.0, 200.0, 74.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 92.0, 200.0, 200.0, -10.0, 200.0, -64.0, 200.0, 200.0, 62.0, -280.0, 200.0, 152.0, 170.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -106.0, 200.0, 200.0, 200.0, -682.0, 128.0, 2.0, 134.0, 200.0, -160.0, -166.0, -724.0, 140.0, 200.0, 200.0, 146.0, 200.0, 194.0, 194.0, 200.0, 200.0, -250.0, 200.0, 200.0, 200.0, 164.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -64.0, 200.0, 134.0, -1417.0, 200.0, 200.0, 200.0, 200.0, 24.0, -1021.0, -1571.0, 200.0, -1923.0, 57.0, 200.0, 200.0, 200.0, 200.0, -834.0, 200.0, 200.0, -218.0, 101.0, -152.0, 178.0, 145.0, 24.0, 200.0, 200.0, -31.0, 200.0, -31.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, -185.0, 200.0, -284.0, 200.0, 200.0, -53.0, -680.0, 200.0, 112.0, 145.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -361.0, 200.0, 200.0, 200.0, -1417.0, 68.0, -163.0, 79.0, 200.0, -460.0, -471.0, -1494.0, 90.0, 200.0, 200.0, 101.0, 200.0, 189.0, 189.0, 200.0, 200.0, -625.0, 200.0, 200.0, 200.0, 134.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [10.0, 120.0, 0.0, 30.0, 735.0, 0.0, 0.0, 0.0, 0.0, 80.0, 555.0, 805.0, 0.0, 965.0, 65.0, 0.0, 0.0, 0.0, 0.0, 470.0, 0.0, 0.0, 190.0, 45.0, 160.0, 10.0, 25.0, 80.0, 0.0, 0.0, 105.0, 0.0, 105.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 0.0, 175.0, 0.0, 220.0, 0.0, 0.0, 115.0, 400.0, 0.0, 40.0, 25.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 255.0, 0.0, 0.0, 0.0, 735.0, 60.0, 165.0, 55.0, 0.0, 300.0, 305.0, 770.0, 50.0, 0.0, 0.0, 45.0, 0.0, 5.0, 5.0, 0.0, 0.0, 375.0, 0.0, 0.0, 0.0, 30.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33552915729829, "mean_inference_ms": 1.3359817829162417, "mean_action_processing_ms": 0.13598287071370552, "mean_env_wait_ms": 0.10680874148102618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034791231155395508, "StateBufferConnector_ms": 0.0028406381607055664, "ViewRequirementAgentConnector_ms": 0.0715630054473877}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -958.0, "episode_return_mean": 91.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.02565333273995, "num_env_steps_trained_throughput_per_sec": 164.02565333273995, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 24091.058, "restore_workers_time_ms": 0.023, "training_step_time_ms": 24090.84, "sample_time_ms": 1083.793, "learn_time_ms": 22982.705, "learn_throughput": 174.044, "synch_weights_time_ms": 22.341}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 63, "trial_id": "25fa0_00000", "date": "2024-08-12_13-56-41", "timestamp": 1723485401, "time_this_iter_s": 24.42010998725891, "time_total_s": 1739.3742837905884, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4921790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1739.3742837905884, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 28.80857142857143, "ram_util_percent": 82.85142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8727008837003571, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1474451089706387, "policy_loss": -0.0024747407083244373, "vf_loss": 0.14991958197306404, "vf_explained_var": 0.0065085103114446005, "kl": 0.017278757665496216, "entropy": 0.869129277082781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.95888542397879, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16246478949857798, "policy_loss": -0.007145570671612708, "vf_loss": 0.1688488094036984, "vf_explained_var": -0.10907467963794867, "kl": 0.009025769750131, "entropy": 1.0892436736573776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -724.0, "episode_reward_mean": 130.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1494.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 770.0}, "policy_reward_mean": {"prey_policy": 71.96, "predator_policy": 58.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0, 8.0, 188.0, 170.0, 104.0, 200.0, 200.0, 74.0, 200.0, 74.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 92.0, 200.0, 200.0, -10.0, 200.0, -64.0, 200.0, 200.0, 62.0, -280.0, 200.0, 152.0, 170.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -106.0, 200.0, 200.0, 200.0, -682.0, 128.0, 2.0, 134.0, 200.0, -160.0, -166.0, -724.0, 140.0, 200.0, 200.0, 146.0, 200.0, 194.0, 194.0, 200.0, 200.0, -250.0, 200.0, 200.0, 200.0, 164.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 188.0, 38.0, 104.0, 194.0, -34.0, 200.0, 200.0, 194.0, 200.0, 200.0, 116.0, 200.0, 200.0, 86.0, 50.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, -152.0, 178.0, 145.0, 24.0, 200.0, 200.0, -31.0, 200.0, -31.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, -185.0, 200.0, -284.0, 200.0, 200.0, -53.0, -680.0, 200.0, 112.0, 145.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -361.0, 200.0, 200.0, 200.0, -1417.0, 68.0, -163.0, 79.0, 200.0, -460.0, -471.0, -1494.0, 90.0, 200.0, 200.0, 101.0, 200.0, 189.0, 189.0, 200.0, 200.0, -625.0, 200.0, 200.0, 200.0, 134.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -42.0, 178.0, -97.0, 24.0, 189.0, -229.0, 200.0, 200.0, 189.0, 200.0, 200.0, 46.0, 200.0, 200.0, -9.0, -75.0, 200.0], "policy_predator_policy_reward": [45.0, 160.0, 10.0, 25.0, 80.0, 0.0, 0.0, 105.0, 0.0, 105.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 90.0, 0.0, 0.0, 175.0, 0.0, 220.0, 0.0, 0.0, 115.0, 400.0, 0.0, 40.0, 25.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 255.0, 0.0, 0.0, 0.0, 735.0, 60.0, 165.0, 55.0, 0.0, 300.0, 305.0, 770.0, 50.0, 0.0, 0.0, 45.0, 0.0, 5.0, 5.0, 0.0, 0.0, 375.0, 0.0, 0.0, 0.0, 30.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 110.0, 10.0, 135.0, 80.0, 5.0, 195.0, 0.0, 0.0, 5.0, 0.0, 0.0, 70.0, 0.0, 0.0, 95.0, 125.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33601951487801296, "mean_inference_ms": 1.3375181198011195, "mean_action_processing_ms": 0.1361376467543097, "mean_env_wait_ms": 0.10686757883467383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035430192947387695, "StateBufferConnector_ms": 0.002826094627380371, "ViewRequirementAgentConnector_ms": 0.07048022747039795}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -724.0, "episode_return_mean": 130.16, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.73943456524728, "num_env_steps_trained_throughput_per_sec": 163.73943456524728, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 23926.976, "restore_workers_time_ms": 0.025, "training_step_time_ms": 23926.774, "sample_time_ms": 1095.556, "learn_time_ms": 22808.282, "learn_throughput": 175.375, "synch_weights_time_ms": 21.162}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 64, "trial_id": "25fa0_00000", "date": "2024-08-12_13-57-06", "timestamp": 1723485426, "time_this_iter_s": 24.470383882522583, "time_total_s": 1763.844667673111, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48410d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1763.844667673111, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 28.874285714285712, "ram_util_percent": 81.88857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9338395248943319, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2671706230690083, "policy_loss": -0.003349621953869549, "vf_loss": 1.2705201159231365, "vf_explained_var": 0.0009774299959341684, "kl": 0.007903079674390768, "entropy": 0.7485053111488621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.914067240307729, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2820446774053076, "policy_loss": -0.009176637833782782, "vf_loss": 1.2904405931321283, "vf_explained_var": 0.018271584746738276, "kl": 0.009252963779496495, "entropy": 1.0047349462906519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -724.0, "episode_reward_mean": 127.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1494.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 770.0}, "policy_reward_mean": {"prey_policy": 66.57, "predator_policy": 60.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 92.0, 200.0, 200.0, -10.0, 200.0, -64.0, 200.0, 200.0, 62.0, -280.0, 200.0, 152.0, 170.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -106.0, 200.0, 200.0, 200.0, -682.0, 128.0, 2.0, 134.0, 200.0, -160.0, -166.0, -724.0, 140.0, 200.0, 200.0, 146.0, 200.0, 194.0, 194.0, 200.0, 200.0, -250.0, 200.0, 200.0, 200.0, 164.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 188.0, 38.0, 104.0, 194.0, -34.0, 200.0, 200.0, 194.0, 200.0, 200.0, 116.0, 200.0, 200.0, 86.0, 50.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 26.0, -46.0, 62.0, 200.0, 200.0, 32.0, 8.0, 146.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 2.0, 200.0, 200.0, -185.0, 200.0, -284.0, 200.0, 200.0, -53.0, -680.0, 200.0, 112.0, 145.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -361.0, 200.0, 200.0, 200.0, -1417.0, 68.0, -163.0, 79.0, 200.0, -460.0, -471.0, -1494.0, 90.0, 200.0, 200.0, 101.0, 200.0, 189.0, 189.0, 200.0, 200.0, -625.0, 200.0, 200.0, 200.0, 134.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -42.0, 178.0, -97.0, 24.0, 189.0, -229.0, 200.0, 200.0, 189.0, 200.0, 200.0, 46.0, 200.0, 200.0, -9.0, -75.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -119.0, -251.0, -53.0, 200.0, 200.0, -108.0, -152.0, 101.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 90.0, 0.0, 0.0, 175.0, 0.0, 220.0, 0.0, 0.0, 115.0, 400.0, 0.0, 40.0, 25.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 255.0, 0.0, 0.0, 0.0, 735.0, 60.0, 165.0, 55.0, 0.0, 300.0, 305.0, 770.0, 50.0, 0.0, 0.0, 45.0, 0.0, 5.0, 5.0, 0.0, 0.0, 375.0, 0.0, 0.0, 0.0, 30.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 110.0, 10.0, 135.0, 80.0, 5.0, 195.0, 0.0, 0.0, 5.0, 0.0, 0.0, 70.0, 0.0, 0.0, 95.0, 125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 205.0, 115.0, 0.0, 0.0, 140.0, 160.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3356345199829795, "mean_inference_ms": 1.3359762195479277, "mean_action_processing_ms": 0.13603287084620344, "mean_env_wait_ms": 0.10685667482251539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003175973892211914, "StateBufferConnector_ms": 0.0027108192443847656, "ViewRequirementAgentConnector_ms": 0.06634211540222168}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -724.0, "episode_return_mean": 127.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.16509027181854, "num_env_steps_trained_throughput_per_sec": 171.16509027181854, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 23901.699, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23901.505, "sample_time_ms": 1062.489, "learn_time_ms": 22815.509, "learn_throughput": 175.319, "synch_weights_time_ms": 21.789}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 65, "trial_id": "25fa0_00000", "date": "2024-08-12_13-57-29", "timestamp": 1723485449, "time_this_iter_s": 23.404378175735474, "time_total_s": 1787.2490458488464, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1787.2490458488464, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 26.139393939393944, "ram_util_percent": 82.35151515151514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6132523495160664, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9404540566106638, "policy_loss": -0.0036913799432416756, "vf_loss": 1.9441451825201512, "vf_explained_var": 0.0014781509215633073, "kl": 0.016552891412018787, "entropy": 0.6491959632374347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.055075039652487, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9487782730410497, "policy_loss": -0.0072332822863245385, "vf_loss": 1.9552828952049215, "vf_explained_var": 0.013876561758418877, "kl": 0.008635930315769706, "entropy": 0.9549720330784718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -760.0, "episode_reward_mean": 115.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1560.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": 45.12, "predator_policy": 70.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -106.0, 200.0, 200.0, 200.0, -682.0, 128.0, 2.0, 134.0, 200.0, -160.0, -166.0, -724.0, 140.0, 200.0, 200.0, 146.0, 200.0, 194.0, 194.0, 200.0, 200.0, -250.0, 200.0, 200.0, 200.0, 164.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 188.0, 38.0, 104.0, 194.0, -34.0, 200.0, 200.0, 194.0, 200.0, 200.0, 116.0, 200.0, 200.0, 86.0, 50.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 26.0, -46.0, 62.0, 200.0, 200.0, 32.0, 8.0, 146.0, 200.0, 200.0, 140.0, -298.0, 200.0, 74.0, 200.0, 200.0, -328.0, 200.0, 200.0, 68.0, 200.0, 104.0, 200.0, 200.0, -760.0, -40.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -361.0, 200.0, 200.0, 200.0, -1417.0, 68.0, -163.0, 79.0, 200.0, -460.0, -471.0, -1494.0, 90.0, 200.0, 200.0, 101.0, 200.0, 189.0, 189.0, 200.0, 200.0, -625.0, 200.0, 200.0, 200.0, 134.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -42.0, 178.0, -97.0, 24.0, 189.0, -229.0, 200.0, 200.0, 189.0, 200.0, 200.0, 46.0, 200.0, 200.0, -9.0, -75.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -119.0, -251.0, -53.0, 200.0, 200.0, -108.0, -152.0, 101.0, 200.0, 200.0, 90.0, -713.0, 200.0, -31.0, 200.0, 200.0, -768.0, 200.0, 200.0, -42.0, 200.0, 24.0, 200.0, 200.0, -1560.0, -240.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 255.0, 0.0, 0.0, 0.0, 735.0, 60.0, 165.0, 55.0, 0.0, 300.0, 305.0, 770.0, 50.0, 0.0, 0.0, 45.0, 0.0, 5.0, 5.0, 0.0, 0.0, 375.0, 0.0, 0.0, 0.0, 30.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 110.0, 10.0, 135.0, 80.0, 5.0, 195.0, 0.0, 0.0, 5.0, 0.0, 0.0, 70.0, 0.0, 0.0, 95.0, 125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 205.0, 115.0, 0.0, 0.0, 140.0, 160.0, 45.0, 0.0, 0.0, 50.0, 415.0, 0.0, 105.0, 0.0, 0.0, 440.0, 0.0, 0.0, 110.0, 0.0, 80.0, 0.0, 0.0, 800.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33569050774098486, "mean_inference_ms": 1.3359125696815752, "mean_action_processing_ms": 0.13605492522882767, "mean_env_wait_ms": 0.10684599778844944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003226041793823242, "StateBufferConnector_ms": 0.0026845932006835938, "ViewRequirementAgentConnector_ms": 0.06560707092285156}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -760.0, "episode_return_mean": 115.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.32041752871032, "num_env_steps_trained_throughput_per_sec": 175.32041752871032, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 23729.689, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23729.533, "sample_time_ms": 1054.902, "learn_time_ms": 22651.838, "learn_throughput": 176.586, "synch_weights_time_ms": 20.93}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 66, "trial_id": "25fa0_00000", "date": "2024-08-12_13-57-52", "timestamp": 1723485472, "time_this_iter_s": 22.861870050430298, "time_total_s": 1810.1109158992767, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a489a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1810.1109158992767, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 22.572727272727274, "ram_util_percent": 82.43636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7301393625326454, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1749886772284905, "policy_loss": -0.003606397167216831, "vf_loss": 2.1785948667054376, "vf_explained_var": 0.001476738912363847, "kl": 0.011885610659068391, "entropy": 0.7504814993590117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.48979483153671, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1809383112937213, "policy_loss": -0.018260219711131263, "vf_loss": 2.1975651077305276, "vf_explained_var": 0.02717073429375887, "kl": 0.0193590687502769, "entropy": 1.0304596720884243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 116.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 46.33, "predator_policy": 69.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 146.0, 200.0, 194.0, 194.0, 200.0, 200.0, -250.0, 200.0, 200.0, 200.0, 164.0, 146.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 188.0, 38.0, 104.0, 194.0, -34.0, 200.0, 200.0, 194.0, 200.0, 200.0, 116.0, 200.0, 200.0, 86.0, 50.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 26.0, -46.0, 62.0, 200.0, 200.0, 32.0, 8.0, 146.0, 200.0, 200.0, 140.0, -298.0, 200.0, 74.0, 200.0, 200.0, -328.0, 200.0, 200.0, 68.0, 200.0, 104.0, 200.0, 200.0, -760.0, -40.0, 200.0, 164.0, 200.0, 158.0, 194.0, 200.0, 200.0, 200.0, -1000.0, 200.0, 200.0, 26.0, -940.0, 200.0, 200.0, 200.0, 200.0, 200.0, 152.0, -322.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 101.0, 200.0, 189.0, 189.0, 200.0, 200.0, -625.0, 200.0, 200.0, 200.0, 134.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -42.0, 178.0, -97.0, 24.0, 189.0, -229.0, 200.0, 200.0, 189.0, 200.0, 200.0, 46.0, 200.0, 200.0, -9.0, -75.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -119.0, -251.0, -53.0, 200.0, 200.0, -108.0, -152.0, 101.0, 200.0, 200.0, 90.0, -713.0, 200.0, -31.0, 200.0, 200.0, -768.0, 200.0, 200.0, -42.0, 200.0, 24.0, 200.0, 200.0, -1560.0, -240.0, 200.0, 134.0, 200.0, 123.0, 189.0, 200.0, 200.0, 200.0, -2000.0, 200.0, 200.0, -119.0, -1890.0, 200.0, 200.0, 200.0, 200.0, 200.0, 112.0, -757.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 45.0, 0.0, 5.0, 5.0, 0.0, 0.0, 375.0, 0.0, 0.0, 0.0, 30.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 110.0, 10.0, 135.0, 80.0, 5.0, 195.0, 0.0, 0.0, 5.0, 0.0, 0.0, 70.0, 0.0, 0.0, 95.0, 125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 205.0, 115.0, 0.0, 0.0, 140.0, 160.0, 45.0, 0.0, 0.0, 50.0, 415.0, 0.0, 105.0, 0.0, 0.0, 440.0, 0.0, 0.0, 110.0, 0.0, 80.0, 0.0, 0.0, 800.0, 200.0, 0.0, 30.0, 0.0, 35.0, 5.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 0.0, 145.0, 950.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 435.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33653225113574253, "mean_inference_ms": 1.3398253055098501, "mean_action_processing_ms": 0.13646428920079134, "mean_env_wait_ms": 0.10715955529092284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031325817108154297, "StateBufferConnector_ms": 0.002508997917175293, "ViewRequirementAgentConnector_ms": 0.06033146381378174}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 116.18, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.32072175910523, "num_env_steps_trained_throughput_per_sec": 170.32072175910523, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 23766.938, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23766.783, "sample_time_ms": 1052.514, "learn_time_ms": 22691.452, "learn_throughput": 176.278, "synch_weights_time_ms": 20.878}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "training_iteration": 67, "trial_id": "25fa0_00000", "date": "2024-08-12_13-58-15", "timestamp": 1723485495, "time_this_iter_s": 23.52374005317688, "time_total_s": 1833.6346559524536, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4921820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1833.6346559524536, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 27.487878787878785, "ram_util_percent": 82.2939393939394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7108990218335142, "cur_kl_coeff": 1.5449523925781246e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.778198082682987, "policy_loss": -0.004270075002568774, "vf_loss": 1.7824676516155402, "vf_explained_var": 0.0003556117415428162, "kl": 0.03299973141945048, "entropy": 0.7063208957513173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.207247619889676, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.824074741639197, "policy_loss": -0.003230286373582203, "vf_loss": 1.826999528085192, "vf_explained_var": 0.020403333380818366, "kl": 0.0036208046931949845, "entropy": 1.0213713676979144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 91.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 0.68, "predator_policy": 90.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 188.0, 38.0, 104.0, 194.0, -34.0, 200.0, 200.0, 194.0, 200.0, 200.0, 116.0, 200.0, 200.0, 86.0, 50.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 26.0, -46.0, 62.0, 200.0, 200.0, 32.0, 8.0, 146.0, 200.0, 200.0, 140.0, -298.0, 200.0, 74.0, 200.0, 200.0, -328.0, 200.0, 200.0, 68.0, 200.0, 104.0, 200.0, 200.0, -760.0, -40.0, 200.0, 164.0, 200.0, 158.0, 194.0, 200.0, 200.0, 200.0, -1000.0, 200.0, 200.0, 26.0, -940.0, 200.0, 200.0, 200.0, 200.0, 200.0, 152.0, -322.0, 200.0, 200.0, 128.0, 200.0, 62.0, 200.0, 86.0, 200.0, 188.0, -1000.0, 104.0, 146.0, -838.0, 200.0, -52.0, 164.0, 200.0, 200.0, 200.0, 116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -42.0, 178.0, -97.0, 24.0, 189.0, -229.0, 200.0, 200.0, 189.0, 200.0, 200.0, 46.0, 200.0, 200.0, -9.0, -75.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -119.0, -251.0, -53.0, 200.0, 200.0, -108.0, -152.0, 101.0, 200.0, 200.0, 90.0, -713.0, 200.0, -31.0, 200.0, 200.0, -768.0, 200.0, 200.0, -42.0, 200.0, 24.0, 200.0, 200.0, -1560.0, -240.0, 200.0, 134.0, 200.0, 123.0, 189.0, 200.0, 200.0, 200.0, -2000.0, 200.0, 200.0, -119.0, -1890.0, 200.0, 200.0, 200.0, 200.0, 200.0, 112.0, -757.0, 200.0, 200.0, 68.0, 200.0, -53.0, 200.0, -9.0, 200.0, 178.0, -2000.0, 24.0, 101.0, -1703.0, 200.0, -262.0, 134.0, 200.0, 200.0, 200.0, 46.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 110.0, 10.0, 135.0, 80.0, 5.0, 195.0, 0.0, 0.0, 5.0, 0.0, 0.0, 70.0, 0.0, 0.0, 95.0, 125.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 205.0, 115.0, 0.0, 0.0, 140.0, 160.0, 45.0, 0.0, 0.0, 50.0, 415.0, 0.0, 105.0, 0.0, 0.0, 440.0, 0.0, 0.0, 110.0, 0.0, 80.0, 0.0, 0.0, 800.0, 200.0, 0.0, 30.0, 0.0, 35.0, 5.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 0.0, 145.0, 950.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 435.0, 0.0, 0.0, 60.0, 0.0, 115.0, 0.0, 95.0, 0.0, 10.0, 1000.0, 80.0, 45.0, 865.0, 0.0, 210.0, 30.0, 0.0, 0.0, 0.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3357667787726536, "mean_inference_ms": 1.335654428727052, "mean_action_processing_ms": 0.13613069893010393, "mean_env_wait_ms": 0.10698856599352415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028821229934692383, "StateBufferConnector_ms": 0.0022357702255249023, "ViewRequirementAgentConnector_ms": 0.054363250732421875}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 91.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.6336714639946, "num_env_steps_trained_throughput_per_sec": 159.6336714639946, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 23761.973, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23761.719, "sample_time_ms": 953.75, "learn_time_ms": 22785.169, "learn_throughput": 175.553, "synch_weights_time_ms": 20.831}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 68, "trial_id": "25fa0_00000", "date": "2024-08-12_13-58-41", "timestamp": 1723485521, "time_this_iter_s": 25.111509084701538, "time_total_s": 1858.7461650371552, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1858.7461650371552, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 31.563888888888894, "ram_util_percent": 83.08333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.806662878068164, "cur_kl_coeff": 2.3174285888671882e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9999202395478886, "policy_loss": -0.003710427574211887, "vf_loss": 4.00363061465323, "vf_explained_var": 0.0001763933648665746, "kl": 0.004332025845759824, "entropy": 0.2884861824878802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.640988499609133, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.020055122425159, "policy_loss": -0.00915241486703356, "vf_loss": 4.028801426539818, "vf_explained_var": 0.010533894660572212, "kl": 0.00962600041971958, "entropy": 0.9694858726734916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 33.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -104.81, "predator_policy": 138.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 26.0, -46.0, 62.0, 200.0, 200.0, 32.0, 8.0, 146.0, 200.0, 200.0, 140.0, -298.0, 200.0, 74.0, 200.0, 200.0, -328.0, 200.0, 200.0, 68.0, 200.0, 104.0, 200.0, 200.0, -760.0, -40.0, 200.0, 164.0, 200.0, 158.0, 194.0, 200.0, 200.0, 200.0, -1000.0, 200.0, 200.0, 26.0, -940.0, 200.0, 200.0, 200.0, 200.0, 200.0, 152.0, -322.0, 200.0, 200.0, 128.0, 200.0, 62.0, 200.0, 86.0, 200.0, 188.0, -1000.0, 104.0, 146.0, -838.0, 200.0, -52.0, 164.0, 200.0, 200.0, 200.0, 116.0, 200.0, -448.0, -286.0, 14.0, 200.0, 200.0, 200.0, -724.0, -784.0, -244.0, -394.0, 200.0, 188.0, -592.0, -334.0, 158.0, 200.0, 200.0, -772.0, 200.0, 200.0, 68.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -119.0, -251.0, -53.0, 200.0, 200.0, -108.0, -152.0, 101.0, 200.0, 200.0, 90.0, -713.0, 200.0, -31.0, 200.0, 200.0, -768.0, 200.0, 200.0, -42.0, 200.0, 24.0, 200.0, 200.0, -1560.0, -240.0, 200.0, 134.0, 200.0, 123.0, 189.0, 200.0, 200.0, 200.0, -2000.0, 200.0, 200.0, -119.0, -1890.0, 200.0, 200.0, 200.0, 200.0, 200.0, 112.0, -757.0, 200.0, 200.0, 68.0, 200.0, -53.0, 200.0, -9.0, 200.0, 178.0, -2000.0, 24.0, 101.0, -1703.0, 200.0, -262.0, 134.0, 200.0, 200.0, 200.0, 46.0, 200.0, -988.0, -691.0, -141.0, 200.0, 200.0, 200.0, -1494.0, -1604.0, -614.0, -889.0, 200.0, 178.0, -1252.0, -779.0, 123.0, 200.0, 200.0, -1582.0, 200.0, 200.0, -42.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 205.0, 115.0, 0.0, 0.0, 140.0, 160.0, 45.0, 0.0, 0.0, 50.0, 415.0, 0.0, 105.0, 0.0, 0.0, 440.0, 0.0, 0.0, 110.0, 0.0, 80.0, 0.0, 0.0, 800.0, 200.0, 0.0, 30.0, 0.0, 35.0, 5.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 0.0, 145.0, 950.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 435.0, 0.0, 0.0, 60.0, 0.0, 115.0, 0.0, 95.0, 0.0, 10.0, 1000.0, 80.0, 45.0, 865.0, 0.0, 210.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 540.0, 405.0, 155.0, 0.0, 0.0, 0.0, 770.0, 820.0, 370.0, 495.0, 0.0, 10.0, 660.0, 445.0, 35.0, 0.0, 0.0, 810.0, 0.0, 0.0, 110.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3358116139972449, "mean_inference_ms": 1.335671623736238, "mean_action_processing_ms": 0.13622247203841287, "mean_env_wait_ms": 0.10717594947703954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030792951583862305, "StateBufferConnector_ms": 0.0024907588958740234, "ViewRequirementAgentConnector_ms": 0.061226606369018555}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 33.74, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.22650493120463, "num_env_steps_trained_throughput_per_sec": 167.22650493120463, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 23716.833, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23716.582, "sample_time_ms": 949.515, "learn_time_ms": 22745.273, "learn_throughput": 175.861, "synch_weights_time_ms": 19.91}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 69, "trial_id": "25fa0_00000", "date": "2024-08-12_13-59-05", "timestamp": 1723485545, "time_this_iter_s": 23.977460861206055, "time_total_s": 1882.7236258983612, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a485adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1882.7236258983612, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 27.829411764705885, "ram_util_percent": 82.62352941176472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6320784859281654, "cur_kl_coeff": 1.1587142944335941e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.269148926685253, "policy_loss": -0.0023907787202915643, "vf_loss": 4.271539703011513, "vf_explained_var": 0.0007342532897988955, "kl": 0.0026315553862916773, "entropy": 0.2772985491125534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.568362001702189, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2859296875695385, "policy_loss": -0.008791707828640938, "vf_loss": 4.294209522008896, "vf_explained_var": 0.020602715760469438, "kl": 0.012132624440495584, "entropy": 0.9620874709139268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 5.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -157.5, "predator_policy": 162.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [146.0, 200.0, 200.0, 140.0, -298.0, 200.0, 74.0, 200.0, 200.0, -328.0, 200.0, 200.0, 68.0, 200.0, 104.0, 200.0, 200.0, -760.0, -40.0, 200.0, 164.0, 200.0, 158.0, 194.0, 200.0, 200.0, 200.0, -1000.0, 200.0, 200.0, 26.0, -940.0, 200.0, 200.0, 200.0, 200.0, 200.0, 152.0, -322.0, 200.0, 200.0, 128.0, 200.0, 62.0, 200.0, 86.0, 200.0, 188.0, -1000.0, 104.0, 146.0, -838.0, 200.0, -52.0, 164.0, 200.0, 200.0, 200.0, 116.0, 200.0, -448.0, -286.0, 14.0, 200.0, 200.0, 200.0, -724.0, -784.0, -244.0, -394.0, 200.0, 188.0, -592.0, -334.0, 158.0, 200.0, 200.0, -772.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -568.0, 164.0, 200.0, 200.0, 98.0, 200.0, 2.0, -202.0, 200.0, -118.0, -304.0, 200.0, 116.0, 38.0, -88.0, -730.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 200.0, 200.0, 90.0, -713.0, 200.0, -31.0, 200.0, 200.0, -768.0, 200.0, 200.0, -42.0, 200.0, 24.0, 200.0, 200.0, -1560.0, -240.0, 200.0, 134.0, 200.0, 123.0, 189.0, 200.0, 200.0, 200.0, -2000.0, 200.0, 200.0, -119.0, -1890.0, 200.0, 200.0, 200.0, 200.0, 200.0, 112.0, -757.0, 200.0, 200.0, 68.0, 200.0, -53.0, 200.0, -9.0, 200.0, 178.0, -2000.0, 24.0, 101.0, -1703.0, 200.0, -262.0, 134.0, 200.0, 200.0, 200.0, 46.0, 200.0, -988.0, -691.0, -141.0, 200.0, 200.0, 200.0, -1494.0, -1604.0, -614.0, -889.0, 200.0, 178.0, -1252.0, -779.0, 123.0, 200.0, 200.0, -1582.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, -1208.0, 134.0, 200.0, 200.0, 13.0, 200.0, -163.0, -537.0, 200.0, -383.0, -724.0, 200.0, 46.0, -97.0, -328.0, -1505.0], "policy_predator_policy_reward": [45.0, 0.0, 0.0, 50.0, 415.0, 0.0, 105.0, 0.0, 0.0, 440.0, 0.0, 0.0, 110.0, 0.0, 80.0, 0.0, 0.0, 800.0, 200.0, 0.0, 30.0, 0.0, 35.0, 5.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 0.0, 145.0, 950.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 435.0, 0.0, 0.0, 60.0, 0.0, 115.0, 0.0, 95.0, 0.0, 10.0, 1000.0, 80.0, 45.0, 865.0, 0.0, 210.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 540.0, 405.0, 155.0, 0.0, 0.0, 0.0, 770.0, 820.0, 370.0, 495.0, 0.0, 10.0, 660.0, 445.0, 35.0, 0.0, 0.0, 810.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 640.0, 30.0, 0.0, 0.0, 85.0, 0.0, 165.0, 335.0, 0.0, 265.0, 420.0, 0.0, 70.0, 135.0, 240.0, 775.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33573313095873636, "mean_inference_ms": 1.3353540932970847, "mean_action_processing_ms": 0.13625114017594797, "mean_env_wait_ms": 0.10729297044878425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029894113540649414, "StateBufferConnector_ms": 0.0023827552795410156, "ViewRequirementAgentConnector_ms": 0.05843353271484375}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 5.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.21117314050207, "num_env_steps_trained_throughput_per_sec": 177.21117314050207, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 23583.343, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23583.112, "sample_time_ms": 930.663, "learn_time_ms": 22631.232, "learn_throughput": 176.747, "synch_weights_time_ms": 19.411}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 70, "trial_id": "25fa0_00000", "date": "2024-08-12_13-59-27", "timestamp": 1723485567, "time_this_iter_s": 22.577261924743652, "time_total_s": 1905.3008878231049, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a49211f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1905.3008878231049, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 22.540625, "ram_util_percent": 82.490625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6410345902200788, "cur_kl_coeff": 5.793571472167971e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.38871987760067, "policy_loss": -0.0011970566900951476, "vf_loss": 3.389916933203737, "vf_explained_var": 0.0008661034827431043, "kl": 0.002069566527583907, "entropy": 0.2829481636018803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.139053180441261, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.408937501286467, "policy_loss": -0.007102223321029063, "vf_loss": 3.415777137875557, "vf_explained_var": 0.023318142505983512, "kl": 0.006224131126274261, "entropy": 1.0139671596388022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": -12.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -189.73, "predator_policy": 177.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-40.0, 200.0, 164.0, 200.0, 158.0, 194.0, 200.0, 200.0, 200.0, -1000.0, 200.0, 200.0, 26.0, -940.0, 200.0, 200.0, 200.0, 200.0, 200.0, 152.0, -322.0, 200.0, 200.0, 128.0, 200.0, 62.0, 200.0, 86.0, 200.0, 188.0, -1000.0, 104.0, 146.0, -838.0, 200.0, -52.0, 164.0, 200.0, 200.0, 200.0, 116.0, 200.0, -448.0, -286.0, 14.0, 200.0, 200.0, 200.0, -724.0, -784.0, -244.0, -394.0, 200.0, 188.0, -592.0, -334.0, 158.0, 200.0, 200.0, -772.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -568.0, 164.0, 200.0, 200.0, 98.0, 200.0, 2.0, -202.0, 200.0, -118.0, -304.0, 200.0, 116.0, 38.0, -88.0, -730.0, 200.0, 164.0, 200.0, -202.0, -598.0, 200.0, 158.0, -658.0, 14.0, 200.0, 200.0, 200.0, -328.0, 200.0, 200.0, -196.0, 128.0, -694.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.0, 200.0, 134.0, 200.0, 123.0, 189.0, 200.0, 200.0, 200.0, -2000.0, 200.0, 200.0, -119.0, -1890.0, 200.0, 200.0, 200.0, 200.0, 200.0, 112.0, -757.0, 200.0, 200.0, 68.0, 200.0, -53.0, 200.0, -9.0, 200.0, 178.0, -2000.0, 24.0, 101.0, -1703.0, 200.0, -262.0, 134.0, 200.0, 200.0, 200.0, 46.0, 200.0, -988.0, -691.0, -141.0, 200.0, 200.0, 200.0, -1494.0, -1604.0, -614.0, -889.0, 200.0, 178.0, -1252.0, -779.0, 123.0, 200.0, 200.0, -1582.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, -1208.0, 134.0, 200.0, 200.0, 13.0, 200.0, -163.0, -537.0, 200.0, -383.0, -724.0, 200.0, 46.0, -97.0, -328.0, -1505.0, 200.0, 134.0, 200.0, -537.0, -1263.0, 200.0, 123.0, -1373.0, -141.0, 200.0, 200.0, 200.0, -768.0, 200.0, 200.0, -526.0, 68.0, -1439.0], "policy_predator_policy_reward": [200.0, 0.0, 30.0, 0.0, 35.0, 5.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 0.0, 145.0, 950.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 435.0, 0.0, 0.0, 60.0, 0.0, 115.0, 0.0, 95.0, 0.0, 10.0, 1000.0, 80.0, 45.0, 865.0, 0.0, 210.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 540.0, 405.0, 155.0, 0.0, 0.0, 0.0, 770.0, 820.0, 370.0, 495.0, 0.0, 10.0, 660.0, 445.0, 35.0, 0.0, 0.0, 810.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 640.0, 30.0, 0.0, 0.0, 85.0, 0.0, 165.0, 335.0, 0.0, 265.0, 420.0, 0.0, 70.0, 135.0, 240.0, 775.0, 0.0, 30.0, 0.0, 335.0, 665.0, 0.0, 35.0, 715.0, 155.0, 0.0, 0.0, 0.0, 440.0, 0.0, 0.0, 330.0, 60.0, 745.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33561333456444453, "mean_inference_ms": 1.3349178946793763, "mean_action_processing_ms": 0.13629426806101427, "mean_env_wait_ms": 0.10738358496310882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002975940704345703, "StateBufferConnector_ms": 0.002410888671875, "ViewRequirementAgentConnector_ms": 0.06118917465209961}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": -12.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.01450381964497, "num_env_steps_trained_throughput_per_sec": 176.01450381964497, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 23573.162, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23572.934, "sample_time_ms": 930.855, "learn_time_ms": 22621.459, "learn_throughput": 176.823, "synch_weights_time_ms": 18.846}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "training_iteration": 71, "trial_id": "25fa0_00000", "date": "2024-08-12_13-59-50", "timestamp": 1723485590, "time_this_iter_s": 22.7330002784729, "time_total_s": 1928.0338881015778, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1928.0338881015778, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 22.734375, "ram_util_percent": 81.628125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.085473086265847, "cur_kl_coeff": 2.8967857360839853e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8284773893654345, "policy_loss": -0.006734953564106642, "vf_loss": 3.8352123254289228, "vf_explained_var": 0.0038185444350043933, "kl": 0.025161792175923618, "entropy": 0.4267791614557306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.642473235912622, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.004457127054533, "policy_loss": -0.007457625307142735, "vf_loss": 4.011428180336952, "vf_explained_var": 0.01086180272201697, "kl": 0.011533521525699494, "entropy": 1.0640655771518748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": -22.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -207.33, "predator_policy": 185.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 128.0, 200.0, 62.0, 200.0, 86.0, 200.0, 188.0, -1000.0, 104.0, 146.0, -838.0, 200.0, -52.0, 164.0, 200.0, 200.0, 200.0, 116.0, 200.0, -448.0, -286.0, 14.0, 200.0, 200.0, 200.0, -724.0, -784.0, -244.0, -394.0, 200.0, 188.0, -592.0, -334.0, 158.0, 200.0, 200.0, -772.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -568.0, 164.0, 200.0, 200.0, 98.0, 200.0, 2.0, -202.0, 200.0, -118.0, -304.0, 200.0, 116.0, 38.0, -88.0, -730.0, 200.0, 164.0, 200.0, -202.0, -598.0, 200.0, 158.0, -658.0, 14.0, 200.0, 200.0, 200.0, -328.0, 200.0, 200.0, -196.0, 128.0, -694.0, -898.0, -124.0, 200.0, 200.0, 200.0, 200.0, 152.0, 80.0, -832.0, 32.0, 194.0, 200.0, -496.0, -124.0, 200.0, 200.0, 200.0, 56.0, 200.0, -160.0, 152.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 68.0, 200.0, -53.0, 200.0, -9.0, 200.0, 178.0, -2000.0, 24.0, 101.0, -1703.0, 200.0, -262.0, 134.0, 200.0, 200.0, 200.0, 46.0, 200.0, -988.0, -691.0, -141.0, 200.0, 200.0, 200.0, -1494.0, -1604.0, -614.0, -889.0, 200.0, 178.0, -1252.0, -779.0, 123.0, 200.0, 200.0, -1582.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, -1208.0, 134.0, 200.0, 200.0, 13.0, 200.0, -163.0, -537.0, 200.0, -383.0, -724.0, 200.0, 46.0, -97.0, -328.0, -1505.0, 200.0, 134.0, 200.0, -537.0, -1263.0, 200.0, 123.0, -1373.0, -141.0, 200.0, 200.0, 200.0, -768.0, 200.0, 200.0, -526.0, 68.0, -1439.0, -1813.0, -394.0, 200.0, 200.0, 200.0, 200.0, 112.0, -20.0, -1692.0, -108.0, 189.0, 200.0, -1076.0, -394.0, 200.0, 200.0, 200.0, -64.0, 200.0, -460.0, 112.0, 200.0], "policy_predator_policy_reward": [0.0, 60.0, 0.0, 115.0, 0.0, 95.0, 0.0, 10.0, 1000.0, 80.0, 45.0, 865.0, 0.0, 210.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 540.0, 405.0, 155.0, 0.0, 0.0, 0.0, 770.0, 820.0, 370.0, 495.0, 0.0, 10.0, 660.0, 445.0, 35.0, 0.0, 0.0, 810.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 640.0, 30.0, 0.0, 0.0, 85.0, 0.0, 165.0, 335.0, 0.0, 265.0, 420.0, 0.0, 70.0, 135.0, 240.0, 775.0, 0.0, 30.0, 0.0, 335.0, 665.0, 0.0, 35.0, 715.0, 155.0, 0.0, 0.0, 0.0, 440.0, 0.0, 0.0, 330.0, 60.0, 745.0, 915.0, 270.0, 0.0, 0.0, 0.0, 0.0, 40.0, 100.0, 860.0, 140.0, 5.0, 0.0, 580.0, 270.0, 0.0, 0.0, 0.0, 120.0, 0.0, 300.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3353825337526473, "mean_inference_ms": 1.3342205454166, "mean_action_processing_ms": 0.13633968129258978, "mean_env_wait_ms": 0.10747828074106731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030069351196289062, "StateBufferConnector_ms": 0.002419590950012207, "ViewRequirementAgentConnector_ms": 0.06140148639678955}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": -22.18, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.35425635068654, "num_env_steps_trained_throughput_per_sec": 174.35425635068654, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 23570.151, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23569.926, "sample_time_ms": 927.176, "learn_time_ms": 22621.683, "learn_throughput": 176.822, "synch_weights_time_ms": 19.028}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 72, "trial_id": "25fa0_00000", "date": "2024-08-12_14-00-13", "timestamp": 1723485613, "time_this_iter_s": 22.98056411743164, "time_total_s": 1951.0144522190094, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48a9ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1951.0144522190094, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 24.95151515151515, "ram_util_percent": 81.7969696969697}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1384392121806741, "cur_kl_coeff": 4.345178604125976e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.725101340313753, "policy_loss": -0.0017630937514089358, "vf_loss": 8.726864413917065, "vf_explained_var": 0.0004819496845205625, "kl": 0.002613910203592351, "entropy": 0.40241823128114146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5143647540981573, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.737705116470655, "policy_loss": -0.005015977760922397, "vf_loss": 8.74232003291448, "vf_explained_var": 0.005590146034955978, "kl": 0.009506899224766163, "entropy": 1.094454165175557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -898.0, "episode_reward_mean": -86.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1813.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 915.0}, "policy_reward_mean": {"prey_policy": -325.14, "predator_policy": 238.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, -724.0, -784.0, -244.0, -394.0, 200.0, 188.0, -592.0, -334.0, 158.0, 200.0, 200.0, -772.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -568.0, 164.0, 200.0, 200.0, 98.0, 200.0, 2.0, -202.0, 200.0, -118.0, -304.0, 200.0, 116.0, 38.0, -88.0, -730.0, 200.0, 164.0, 200.0, -202.0, -598.0, 200.0, 158.0, -658.0, 14.0, 200.0, 200.0, 200.0, -328.0, 200.0, 200.0, -196.0, 128.0, -694.0, -898.0, -124.0, 200.0, 200.0, 200.0, 200.0, 152.0, 80.0, -832.0, 32.0, 194.0, 200.0, -496.0, -124.0, 200.0, 200.0, 200.0, 56.0, 200.0, -160.0, 152.0, 200.0, -82.0, -376.0, -280.0, -250.0, 14.0, -538.0, -718.0, -322.0, 200.0, -676.0, -118.0, 200.0, -298.0, -382.0, -802.0, -544.0, -430.0, 104.0, -292.0, -82.0, -214.0, 26.0, -382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -1494.0, -1604.0, -614.0, -889.0, 200.0, 178.0, -1252.0, -779.0, 123.0, 200.0, 200.0, -1582.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, -1208.0, 134.0, 200.0, 200.0, 13.0, 200.0, -163.0, -537.0, 200.0, -383.0, -724.0, 200.0, 46.0, -97.0, -328.0, -1505.0, 200.0, 134.0, 200.0, -537.0, -1263.0, 200.0, 123.0, -1373.0, -141.0, 200.0, 200.0, 200.0, -768.0, 200.0, 200.0, -526.0, 68.0, -1439.0, -1813.0, -394.0, 200.0, 200.0, 200.0, 200.0, 112.0, -20.0, -1692.0, -108.0, 189.0, 200.0, -1076.0, -394.0, 200.0, 200.0, 200.0, -64.0, 200.0, -460.0, 112.0, 200.0, -317.0, -856.0, -680.0, -625.0, -141.0, -1153.0, -1483.0, -757.0, 200.0, -1406.0, -383.0, 200.0, -713.0, -867.0, -1637.0, -1164.0, -955.0, 24.0, -702.0, -317.0, -559.0, -119.0, -867.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 770.0, 820.0, 370.0, 495.0, 0.0, 10.0, 660.0, 445.0, 35.0, 0.0, 0.0, 810.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 640.0, 30.0, 0.0, 0.0, 85.0, 0.0, 165.0, 335.0, 0.0, 265.0, 420.0, 0.0, 70.0, 135.0, 240.0, 775.0, 0.0, 30.0, 0.0, 335.0, 665.0, 0.0, 35.0, 715.0, 155.0, 0.0, 0.0, 0.0, 440.0, 0.0, 0.0, 330.0, 60.0, 745.0, 915.0, 270.0, 0.0, 0.0, 0.0, 0.0, 40.0, 100.0, 860.0, 140.0, 5.0, 0.0, 580.0, 270.0, 0.0, 0.0, 0.0, 120.0, 0.0, 300.0, 40.0, 0.0, 235.0, 480.0, 400.0, 375.0, 155.0, 615.0, 765.0, 435.0, 0.0, 730.0, 265.0, 0.0, 415.0, 485.0, 835.0, 620.0, 525.0, 80.0, 410.0, 235.0, 345.0, 145.0, 485.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3353058906695449, "mean_inference_ms": 1.3329945971224388, "mean_action_processing_ms": 0.1363084575810882, "mean_env_wait_ms": 0.10725841912847507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002895832061767578, "StateBufferConnector_ms": 0.0023041963577270508, "ViewRequirementAgentConnector_ms": 0.057906150817871094}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -898.0, "episode_return_mean": -86.44, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.94809865341713, "num_env_steps_trained_throughput_per_sec": 175.94809865341713, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 23404.904, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23404.694, "sample_time_ms": 886.117, "learn_time_ms": 22498.29, "learn_throughput": 177.791, "synch_weights_time_ms": 18.211}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "training_iteration": 73, "trial_id": "25fa0_00000", "date": "2024-08-12_14-00-36", "timestamp": 1723485636, "time_this_iter_s": 22.789571285247803, "time_total_s": 1973.8040235042572, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1973.8040235042572, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 24.496969696969696, "ram_util_percent": 82.50000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0663192732570073, "cur_kl_coeff": 2.172589302062988e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.393266672392686, "policy_loss": -0.0019397628095854695, "vf_loss": 7.395206422607104, "vf_explained_var": 0.0005138210952281951, "kl": 0.003963030278913689, "entropy": 0.37985061177363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.405837963769833, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.412415868043899, "policy_loss": -0.006406775130017195, "vf_loss": 7.418512838085492, "vf_explained_var": 0.006028606370091438, "kl": 0.007343158982515985, "entropy": 1.112559438496828, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -130.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -405.0, "predator_policy": 275.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, -568.0, 164.0, 200.0, 200.0, 98.0, 200.0, 2.0, -202.0, 200.0, -118.0, -304.0, 200.0, 116.0, 38.0, -88.0, -730.0, 200.0, 164.0, 200.0, -202.0, -598.0, 200.0, 158.0, -658.0, 14.0, 200.0, 200.0, 200.0, -328.0, 200.0, 200.0, -196.0, 128.0, -694.0, -898.0, -124.0, 200.0, 200.0, 200.0, 200.0, 152.0, 80.0, -832.0, 32.0, 194.0, 200.0, -496.0, -124.0, 200.0, 200.0, 200.0, 56.0, 200.0, -160.0, 152.0, 200.0, -82.0, -376.0, -280.0, -250.0, 14.0, -538.0, -718.0, -322.0, 200.0, -676.0, -118.0, 200.0, -298.0, -382.0, -802.0, -544.0, -430.0, 104.0, -292.0, -82.0, -214.0, 26.0, -382.0, 32.0, -610.0, 182.0, -214.0, -496.0, 182.0, -766.0, -538.0, 200.0, -808.0, -148.0, -652.0, -484.0, -262.0, 200.0, -970.0, -454.0, -580.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -1208.0, 134.0, 200.0, 200.0, 13.0, 200.0, -163.0, -537.0, 200.0, -383.0, -724.0, 200.0, 46.0, -97.0, -328.0, -1505.0, 200.0, 134.0, 200.0, -537.0, -1263.0, 200.0, 123.0, -1373.0, -141.0, 200.0, 200.0, 200.0, -768.0, 200.0, 200.0, -526.0, 68.0, -1439.0, -1813.0, -394.0, 200.0, 200.0, 200.0, 200.0, 112.0, -20.0, -1692.0, -108.0, 189.0, 200.0, -1076.0, -394.0, 200.0, 200.0, 200.0, -64.0, 200.0, -460.0, 112.0, 200.0, -317.0, -856.0, -680.0, -625.0, -141.0, -1153.0, -1483.0, -757.0, 200.0, -1406.0, -383.0, 200.0, -713.0, -867.0, -1637.0, -1164.0, -955.0, 24.0, -702.0, -317.0, -559.0, -119.0, -867.0, -108.0, -1285.0, 167.0, -559.0, -1076.0, 167.0, -1571.0, -1153.0, 200.0, -1648.0, -438.0, -1362.0, -1054.0, -647.0, 200.0, -1945.0, -999.0, -1230.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 640.0, 30.0, 0.0, 0.0, 85.0, 0.0, 165.0, 335.0, 0.0, 265.0, 420.0, 0.0, 70.0, 135.0, 240.0, 775.0, 0.0, 30.0, 0.0, 335.0, 665.0, 0.0, 35.0, 715.0, 155.0, 0.0, 0.0, 0.0, 440.0, 0.0, 0.0, 330.0, 60.0, 745.0, 915.0, 270.0, 0.0, 0.0, 0.0, 0.0, 40.0, 100.0, 860.0, 140.0, 5.0, 0.0, 580.0, 270.0, 0.0, 0.0, 0.0, 120.0, 0.0, 300.0, 40.0, 0.0, 235.0, 480.0, 400.0, 375.0, 155.0, 615.0, 765.0, 435.0, 0.0, 730.0, 265.0, 0.0, 415.0, 485.0, 835.0, 620.0, 525.0, 80.0, 410.0, 235.0, 345.0, 145.0, 485.0, 140.0, 675.0, 15.0, 345.0, 580.0, 15.0, 805.0, 615.0, 0.0, 840.0, 290.0, 710.0, 570.0, 385.0, 0.0, 975.0, 545.0, 650.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3343692713067386, "mean_inference_ms": 1.3290618357069977, "mean_action_processing_ms": 0.13602634633741048, "mean_env_wait_ms": 0.10708088005548885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002962946891784668, "StateBufferConnector_ms": 0.0019958019256591797, "ViewRequirementAgentConnector_ms": 0.05023372173309326}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -130.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.77113106582865, "num_env_steps_trained_throughput_per_sec": 171.77113106582865, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 23290.678, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23290.469, "sample_time_ms": 876.083, "learn_time_ms": 22395.051, "learn_throughput": 178.611, "synch_weights_time_ms": 17.375}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 74, "trial_id": "25fa0_00000", "date": "2024-08-12_14-00-59", "timestamp": 1723485659, "time_this_iter_s": 23.318482875823975, "time_total_s": 1997.1225063800812, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4921f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1997.1225063800812, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 27.484848484848488, "ram_util_percent": 82.25757575757575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0104583682647597, "cur_kl_coeff": 1.086294651031494e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.448130036890507, "policy_loss": -0.004307282467683156, "vf_loss": 7.452437321841717, "vf_explained_var": 0.0005840913703044256, "kl": 0.006364181107010343, "entropy": 0.4283695780672133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.336731351601581, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4964050754904745, "policy_loss": -0.007498868531062423, "vf_loss": 7.503389036655426, "vf_explained_var": 0.008538538279632727, "kl": 0.012205220070057976, "entropy": 1.0281168467675645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -172.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -482.11, "predator_policy": 310.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.0, 200.0, 164.0, 200.0, -202.0, -598.0, 200.0, 158.0, -658.0, 14.0, 200.0, 200.0, 200.0, -328.0, 200.0, 200.0, -196.0, 128.0, -694.0, -898.0, -124.0, 200.0, 200.0, 200.0, 200.0, 152.0, 80.0, -832.0, 32.0, 194.0, 200.0, -496.0, -124.0, 200.0, 200.0, 200.0, 56.0, 200.0, -160.0, 152.0, 200.0, -82.0, -376.0, -280.0, -250.0, 14.0, -538.0, -718.0, -322.0, 200.0, -676.0, -118.0, 200.0, -298.0, -382.0, -802.0, -544.0, -430.0, 104.0, -292.0, -82.0, -214.0, 26.0, -382.0, 32.0, -610.0, 182.0, -214.0, -496.0, 182.0, -766.0, -538.0, 200.0, -808.0, -148.0, -652.0, -484.0, -262.0, 200.0, -970.0, -454.0, -580.0, -472.0, -220.0, -214.0, 74.0, -76.0, 200.0, -502.0, 122.0, -358.0, -82.0, -640.0, -34.0, -454.0, -10.0, -340.0, -112.0, -472.0, 122.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1505.0, 200.0, 134.0, 200.0, -537.0, -1263.0, 200.0, 123.0, -1373.0, -141.0, 200.0, 200.0, 200.0, -768.0, 200.0, 200.0, -526.0, 68.0, -1439.0, -1813.0, -394.0, 200.0, 200.0, 200.0, 200.0, 112.0, -20.0, -1692.0, -108.0, 189.0, 200.0, -1076.0, -394.0, 200.0, 200.0, 200.0, -64.0, 200.0, -460.0, 112.0, 200.0, -317.0, -856.0, -680.0, -625.0, -141.0, -1153.0, -1483.0, -757.0, 200.0, -1406.0, -383.0, 200.0, -713.0, -867.0, -1637.0, -1164.0, -955.0, 24.0, -702.0, -317.0, -559.0, -119.0, -867.0, -108.0, -1285.0, 167.0, -559.0, -1076.0, 167.0, -1571.0, -1153.0, 200.0, -1648.0, -438.0, -1362.0, -1054.0, -647.0, 200.0, -1945.0, -999.0, -1230.0, -1032.0, -570.0, -559.0, -31.0, -306.0, 200.0, -1087.0, 57.0, -823.0, -317.0, -1340.0, -229.0, -999.0, -185.0, -790.0, -372.0, -1032.0, 57.0], "policy_predator_policy_reward": [775.0, 0.0, 30.0, 0.0, 335.0, 665.0, 0.0, 35.0, 715.0, 155.0, 0.0, 0.0, 0.0, 440.0, 0.0, 0.0, 330.0, 60.0, 745.0, 915.0, 270.0, 0.0, 0.0, 0.0, 0.0, 40.0, 100.0, 860.0, 140.0, 5.0, 0.0, 580.0, 270.0, 0.0, 0.0, 0.0, 120.0, 0.0, 300.0, 40.0, 0.0, 235.0, 480.0, 400.0, 375.0, 155.0, 615.0, 765.0, 435.0, 0.0, 730.0, 265.0, 0.0, 415.0, 485.0, 835.0, 620.0, 525.0, 80.0, 410.0, 235.0, 345.0, 145.0, 485.0, 140.0, 675.0, 15.0, 345.0, 580.0, 15.0, 805.0, 615.0, 0.0, 840.0, 290.0, 710.0, 570.0, 385.0, 0.0, 975.0, 545.0, 650.0, 560.0, 350.0, 345.0, 105.0, 230.0, 0.0, 585.0, 65.0, 465.0, 235.0, 700.0, 195.0, 545.0, 175.0, 450.0, 260.0, 560.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33388186642595696, "mean_inference_ms": 1.3266507586222127, "mean_action_processing_ms": 0.1358683277727221, "mean_env_wait_ms": 0.10690051386529209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029450654983520508, "StateBufferConnector_ms": 0.001994609832763672, "ViewRequirementAgentConnector_ms": 0.05084514617919922}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -172.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.09042330965104, "num_env_steps_trained_throughput_per_sec": 176.09042330965104, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 23225.313, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23225.107, "sample_time_ms": 866.185, "learn_time_ms": 22337.596, "learn_throughput": 179.07, "synch_weights_time_ms": 19.047}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 75, "trial_id": "25fa0_00000", "date": "2024-08-12_14-01-22", "timestamp": 1723485682, "time_this_iter_s": 22.747697830200195, "time_total_s": 2019.8702042102814, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2019.8702042102814, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 23.768750000000004, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9797049082815648, "cur_kl_coeff": 1.086294651031494e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.444646240770817, "policy_loss": -0.0030854780476753754, "vf_loss": 8.44773172835509, "vf_explained_var": -0.0001245146617293358, "kl": 0.0023821647008528584, "entropy": 0.29318097364157436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.06764747928828, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.47267938107252, "policy_loss": -0.012350014618035251, "vf_loss": 8.484623794754347, "vf_explained_var": 0.006341993995010853, "kl": 0.009614236121581769, "entropy": 1.0297610451156893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -216.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -563.73, "predator_policy": 347.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 200.0, 152.0, 80.0, -832.0, 32.0, 194.0, 200.0, -496.0, -124.0, 200.0, 200.0, 200.0, 56.0, 200.0, -160.0, 152.0, 200.0, -82.0, -376.0, -280.0, -250.0, 14.0, -538.0, -718.0, -322.0, 200.0, -676.0, -118.0, 200.0, -298.0, -382.0, -802.0, -544.0, -430.0, 104.0, -292.0, -82.0, -214.0, 26.0, -382.0, 32.0, -610.0, 182.0, -214.0, -496.0, 182.0, -766.0, -538.0, 200.0, -808.0, -148.0, -652.0, -484.0, -262.0, 200.0, -970.0, -454.0, -580.0, -472.0, -220.0, -214.0, 74.0, -76.0, 200.0, -502.0, 122.0, -358.0, -82.0, -640.0, -34.0, -454.0, -10.0, -340.0, -112.0, -472.0, 122.0, -124.0, -166.0, 164.0, -286.0, -112.0, -760.0, -484.0, 20.0, -178.0, -820.0, -706.0, -322.0, -136.0, -208.0, -238.0, -358.0, -208.0, -748.0, -544.0, -190.0, 200.0, -412.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 112.0, -20.0, -1692.0, -108.0, 189.0, 200.0, -1076.0, -394.0, 200.0, 200.0, 200.0, -64.0, 200.0, -460.0, 112.0, 200.0, -317.0, -856.0, -680.0, -625.0, -141.0, -1153.0, -1483.0, -757.0, 200.0, -1406.0, -383.0, 200.0, -713.0, -867.0, -1637.0, -1164.0, -955.0, 24.0, -702.0, -317.0, -559.0, -119.0, -867.0, -108.0, -1285.0, 167.0, -559.0, -1076.0, 167.0, -1571.0, -1153.0, 200.0, -1648.0, -438.0, -1362.0, -1054.0, -647.0, 200.0, -1945.0, -999.0, -1230.0, -1032.0, -570.0, -559.0, -31.0, -306.0, 200.0, -1087.0, 57.0, -823.0, -317.0, -1340.0, -229.0, -999.0, -185.0, -790.0, -372.0, -1032.0, 57.0, -394.0, -471.0, 134.0, -691.0, -372.0, -1560.0, -1054.0, -130.0, -493.0, -1670.0, -1461.0, -757.0, -416.0, -548.0, -603.0, -823.0, -548.0, -1538.0, -1164.0, -515.0, 200.0, -922.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 40.0, 100.0, 860.0, 140.0, 5.0, 0.0, 580.0, 270.0, 0.0, 0.0, 0.0, 120.0, 0.0, 300.0, 40.0, 0.0, 235.0, 480.0, 400.0, 375.0, 155.0, 615.0, 765.0, 435.0, 0.0, 730.0, 265.0, 0.0, 415.0, 485.0, 835.0, 620.0, 525.0, 80.0, 410.0, 235.0, 345.0, 145.0, 485.0, 140.0, 675.0, 15.0, 345.0, 580.0, 15.0, 805.0, 615.0, 0.0, 840.0, 290.0, 710.0, 570.0, 385.0, 0.0, 975.0, 545.0, 650.0, 560.0, 350.0, 345.0, 105.0, 230.0, 0.0, 585.0, 65.0, 465.0, 235.0, 700.0, 195.0, 545.0, 175.0, 450.0, 260.0, 560.0, 65.0, 270.0, 305.0, 30.0, 405.0, 260.0, 800.0, 570.0, 150.0, 315.0, 850.0, 755.0, 435.0, 280.0, 340.0, 365.0, 465.0, 340.0, 790.0, 620.0, 325.0, 0.0, 510.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.334171987584323, "mean_inference_ms": 1.328138018161174, "mean_action_processing_ms": 0.13607797384304163, "mean_env_wait_ms": 0.10707989779845921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029152631759643555, "StateBufferConnector_ms": 0.001971602439880371, "ViewRequirementAgentConnector_ms": 0.04891788959503174}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -216.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.79724627957114, "num_env_steps_trained_throughput_per_sec": 175.79724627957114, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 23219.125, "restore_workers_time_ms": 0.02, "training_step_time_ms": 23218.936, "sample_time_ms": 868.241, "learn_time_ms": 22330.483, "learn_throughput": 179.127, "synch_weights_time_ms": 18.122}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 76, "trial_id": "25fa0_00000", "date": "2024-08-12_14-01-45", "timestamp": 1723485705, "time_this_iter_s": 22.790225982666016, "time_total_s": 2042.6604301929474, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48a91f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2042.6604301929474, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 24.251515151515154, "ram_util_percent": 83.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1052052011247724, "cur_kl_coeff": 5.43147325515747e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.52892118593057, "policy_loss": -0.0018614145902877985, "vf_loss": 6.530782591799895, "vf_explained_var": 0.0009168344860275586, "kl": 0.003020035615403471, "entropy": 0.3589353256393224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.136006660573184, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.585691049695015, "policy_loss": -0.005700083413830726, "vf_loss": 6.591091641287009, "vf_explained_var": 0.01301861157019933, "kl": 0.007099379703014582, "entropy": 1.0255942936365803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -253.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -630.72, "predator_policy": 377.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -82.0, -376.0, -280.0, -250.0, 14.0, -538.0, -718.0, -322.0, 200.0, -676.0, -118.0, 200.0, -298.0, -382.0, -802.0, -544.0, -430.0, 104.0, -292.0, -82.0, -214.0, 26.0, -382.0, 32.0, -610.0, 182.0, -214.0, -496.0, 182.0, -766.0, -538.0, 200.0, -808.0, -148.0, -652.0, -484.0, -262.0, 200.0, -970.0, -454.0, -580.0, -472.0, -220.0, -214.0, 74.0, -76.0, 200.0, -502.0, 122.0, -358.0, -82.0, -640.0, -34.0, -454.0, -10.0, -340.0, -112.0, -472.0, 122.0, -124.0, -166.0, 164.0, -286.0, -112.0, -760.0, -484.0, 20.0, -178.0, -820.0, -706.0, -322.0, -136.0, -208.0, -238.0, -358.0, -208.0, -748.0, -544.0, -190.0, 200.0, -412.0, -766.0, -592.0, -886.0, -538.0, -4.0, 110.0, -16.0, -340.0, -70.0, 62.0, -136.0, 122.0, 182.0, 200.0, -892.0, 164.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -317.0, -856.0, -680.0, -625.0, -141.0, -1153.0, -1483.0, -757.0, 200.0, -1406.0, -383.0, 200.0, -713.0, -867.0, -1637.0, -1164.0, -955.0, 24.0, -702.0, -317.0, -559.0, -119.0, -867.0, -108.0, -1285.0, 167.0, -559.0, -1076.0, 167.0, -1571.0, -1153.0, 200.0, -1648.0, -438.0, -1362.0, -1054.0, -647.0, 200.0, -1945.0, -999.0, -1230.0, -1032.0, -570.0, -559.0, -31.0, -306.0, 200.0, -1087.0, 57.0, -823.0, -317.0, -1340.0, -229.0, -999.0, -185.0, -790.0, -372.0, -1032.0, 57.0, -394.0, -471.0, 134.0, -691.0, -372.0, -1560.0, -1054.0, -130.0, -493.0, -1670.0, -1461.0, -757.0, -416.0, -548.0, -603.0, -823.0, -548.0, -1538.0, -1164.0, -515.0, 200.0, -922.0, -1571.0, -1252.0, -1791.0, -1153.0, -174.0, 35.0, -196.0, -790.0, -295.0, -53.0, -416.0, 57.0, 167.0, 200.0, -1802.0, 134.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 235.0, 480.0, 400.0, 375.0, 155.0, 615.0, 765.0, 435.0, 0.0, 730.0, 265.0, 0.0, 415.0, 485.0, 835.0, 620.0, 525.0, 80.0, 410.0, 235.0, 345.0, 145.0, 485.0, 140.0, 675.0, 15.0, 345.0, 580.0, 15.0, 805.0, 615.0, 0.0, 840.0, 290.0, 710.0, 570.0, 385.0, 0.0, 975.0, 545.0, 650.0, 560.0, 350.0, 345.0, 105.0, 230.0, 0.0, 585.0, 65.0, 465.0, 235.0, 700.0, 195.0, 545.0, 175.0, 450.0, 260.0, 560.0, 65.0, 270.0, 305.0, 30.0, 405.0, 260.0, 800.0, 570.0, 150.0, 315.0, 850.0, 755.0, 435.0, 280.0, 340.0, 365.0, 465.0, 340.0, 790.0, 620.0, 325.0, 0.0, 510.0, 805.0, 660.0, 905.0, 615.0, 170.0, 75.0, 180.0, 450.0, 225.0, 115.0, 280.0, 65.0, 15.0, 0.0, 910.0, 30.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3330737274639287, "mean_inference_ms": 1.3221354249984187, "mean_action_processing_ms": 0.13553786975320775, "mean_env_wait_ms": 0.10659556776243406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002905726432800293, "StateBufferConnector_ms": 0.0019614696502685547, "ViewRequirementAgentConnector_ms": 0.04825139045715332}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -253.12, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.97118429134633, "num_env_steps_trained_throughput_per_sec": 172.97118429134633, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 23183.137, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23182.888, "sample_time_ms": 873.476, "learn_time_ms": 22288.356, "learn_throughput": 179.466, "synch_weights_time_ms": 18.787}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "training_iteration": 77, "trial_id": "25fa0_00000", "date": "2024-08-12_14-02-08", "timestamp": 1723485728, "time_this_iter_s": 23.162090063095093, "time_total_s": 2065.8225202560425, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2065.8225202560425, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 24.454545454545453, "ram_util_percent": 83.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4616273666111133, "cur_kl_coeff": 2.715736627578735e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3419639178862175, "policy_loss": -0.0029989713014704953, "vf_loss": 2.344962892929713, "vf_explained_var": -0.00127776600420475, "kl": 0.0032964478985361106, "entropy": 0.3643499611566464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.59612000044435, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.690377179533243, "policy_loss": -0.008446015193961405, "vf_loss": 2.6984483638157446, "vf_explained_var": 0.014403482526540756, "kl": 0.008884901933688865, "entropy": 1.0365632689247528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -970.0, "episode_reward_mean": -199.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -533.04, "predator_policy": 333.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-382.0, 32.0, -610.0, 182.0, -214.0, -496.0, 182.0, -766.0, -538.0, 200.0, -808.0, -148.0, -652.0, -484.0, -262.0, 200.0, -970.0, -454.0, -580.0, -472.0, -220.0, -214.0, 74.0, -76.0, 200.0, -502.0, 122.0, -358.0, -82.0, -640.0, -34.0, -454.0, -10.0, -340.0, -112.0, -472.0, 122.0, -124.0, -166.0, 164.0, -286.0, -112.0, -760.0, -484.0, 20.0, -178.0, -820.0, -706.0, -322.0, -136.0, -208.0, -238.0, -358.0, -208.0, -748.0, -544.0, -190.0, 200.0, -412.0, -766.0, -592.0, -886.0, -538.0, -4.0, 110.0, -16.0, -340.0, -70.0, 62.0, -136.0, 122.0, 182.0, 200.0, -892.0, 164.0, 200.0, 200.0, -22.0, 200.0, 200.0, 194.0, 200.0, 86.0, 200.0, -454.0, 92.0, 200.0, 86.0, -412.0, -838.0, 188.0, -598.0, 200.0, 200.0, -298.0, 200.0, -160.0, -178.0, 182.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-867.0, -108.0, -1285.0, 167.0, -559.0, -1076.0, 167.0, -1571.0, -1153.0, 200.0, -1648.0, -438.0, -1362.0, -1054.0, -647.0, 200.0, -1945.0, -999.0, -1230.0, -1032.0, -570.0, -559.0, -31.0, -306.0, 200.0, -1087.0, 57.0, -823.0, -317.0, -1340.0, -229.0, -999.0, -185.0, -790.0, -372.0, -1032.0, 57.0, -394.0, -471.0, 134.0, -691.0, -372.0, -1560.0, -1054.0, -130.0, -493.0, -1670.0, -1461.0, -757.0, -416.0, -548.0, -603.0, -823.0, -548.0, -1538.0, -1164.0, -515.0, 200.0, -922.0, -1571.0, -1252.0, -1791.0, -1153.0, -174.0, 35.0, -196.0, -790.0, -295.0, -53.0, -416.0, 57.0, 167.0, 200.0, -1802.0, 134.0, 200.0, 200.0, -207.0, 200.0, 200.0, 189.0, 200.0, -9.0, 200.0, -999.0, 2.0, 200.0, -9.0, -922.0, -1703.0, 178.0, -1263.0, 200.0, 200.0, -713.0, 200.0, -460.0, -493.0, 167.0, 200.0], "policy_predator_policy_reward": [485.0, 140.0, 675.0, 15.0, 345.0, 580.0, 15.0, 805.0, 615.0, 0.0, 840.0, 290.0, 710.0, 570.0, 385.0, 0.0, 975.0, 545.0, 650.0, 560.0, 350.0, 345.0, 105.0, 230.0, 0.0, 585.0, 65.0, 465.0, 235.0, 700.0, 195.0, 545.0, 175.0, 450.0, 260.0, 560.0, 65.0, 270.0, 305.0, 30.0, 405.0, 260.0, 800.0, 570.0, 150.0, 315.0, 850.0, 755.0, 435.0, 280.0, 340.0, 365.0, 465.0, 340.0, 790.0, 620.0, 325.0, 0.0, 510.0, 805.0, 660.0, 905.0, 615.0, 170.0, 75.0, 180.0, 450.0, 225.0, 115.0, 280.0, 65.0, 15.0, 0.0, 910.0, 30.0, 0.0, 0.0, 185.0, 0.0, 0.0, 5.0, 0.0, 95.0, 0.0, 545.0, 90.0, 0.0, 95.0, 510.0, 865.0, 10.0, 665.0, 0.0, 0.0, 415.0, 0.0, 300.0, 315.0, 15.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33257537906492163, "mean_inference_ms": 1.3195742582432672, "mean_action_processing_ms": 0.13535341096621112, "mean_env_wait_ms": 0.10643558099307389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003070235252380371, "StateBufferConnector_ms": 0.001985311508178711, "ViewRequirementAgentConnector_ms": 0.04903578758239746}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -970.0, "episode_return_mean": -199.84, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.32252778573212, "num_env_steps_trained_throughput_per_sec": 176.32252778573212, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 22945.972, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22945.794, "sample_time_ms": 830.202, "learn_time_ms": 22094.552, "learn_throughput": 181.04, "synch_weights_time_ms": 18.778}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 78, "trial_id": "25fa0_00000", "date": "2024-08-12_14-02-31", "timestamp": 1723485751, "time_this_iter_s": 22.731672048568726, "time_total_s": 2088.554192304611, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a482de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2088.554192304611, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 22.978125, "ram_util_percent": 83.234375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8239625110601385, "cur_kl_coeff": 1.3578683137893675e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.590692498162389, "policy_loss": -0.0031326478968063992, "vf_loss": 2.5938251451899608, "vf_explained_var": -0.0005281503001848856, "kl": 0.0025399623797106178, "entropy": 0.2870147663013389, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.154061650050183, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.710564637556672, "policy_loss": -0.010425796747343459, "vf_loss": 2.720544432848692, "vf_explained_var": 0.01843366927156846, "kl": 0.010571962234221076, "entropy": 1.0817954588060579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -892.0, "episode_reward_mean": -141.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -426.34, "predator_policy": 284.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-580.0, -472.0, -220.0, -214.0, 74.0, -76.0, 200.0, -502.0, 122.0, -358.0, -82.0, -640.0, -34.0, -454.0, -10.0, -340.0, -112.0, -472.0, 122.0, -124.0, -166.0, 164.0, -286.0, -112.0, -760.0, -484.0, 20.0, -178.0, -820.0, -706.0, -322.0, -136.0, -208.0, -238.0, -358.0, -208.0, -748.0, -544.0, -190.0, 200.0, -412.0, -766.0, -592.0, -886.0, -538.0, -4.0, 110.0, -16.0, -340.0, -70.0, 62.0, -136.0, 122.0, 182.0, 200.0, -892.0, 164.0, 200.0, 200.0, -22.0, 200.0, 200.0, 194.0, 200.0, 86.0, 200.0, -454.0, 92.0, 200.0, 86.0, -412.0, -838.0, 188.0, -598.0, 200.0, 200.0, -298.0, 200.0, -160.0, -178.0, 182.0, 200.0, -154.0, 116.0, -628.0, -292.0, -298.0, 8.0, 194.0, -490.0, 200.0, 194.0, 200.0, -76.0, 164.0, 116.0, 26.0, 182.0, 200.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1230.0, -1032.0, -570.0, -559.0, -31.0, -306.0, 200.0, -1087.0, 57.0, -823.0, -317.0, -1340.0, -229.0, -999.0, -185.0, -790.0, -372.0, -1032.0, 57.0, -394.0, -471.0, 134.0, -691.0, -372.0, -1560.0, -1054.0, -130.0, -493.0, -1670.0, -1461.0, -757.0, -416.0, -548.0, -603.0, -823.0, -548.0, -1538.0, -1164.0, -515.0, 200.0, -922.0, -1571.0, -1252.0, -1791.0, -1153.0, -174.0, 35.0, -196.0, -790.0, -295.0, -53.0, -416.0, 57.0, 167.0, 200.0, -1802.0, 134.0, 200.0, 200.0, -207.0, 200.0, 200.0, 189.0, 200.0, -9.0, 200.0, -999.0, 2.0, 200.0, -9.0, -922.0, -1703.0, 178.0, -1263.0, 200.0, 200.0, -713.0, 200.0, -460.0, -493.0, 167.0, 200.0, -449.0, 46.0, -1318.0, -702.0, -713.0, -152.0, 189.0, -1065.0, 200.0, 189.0, 200.0, -306.0, 134.0, 46.0, -119.0, 167.0, 200.0, 145.0], "policy_predator_policy_reward": [650.0, 560.0, 350.0, 345.0, 105.0, 230.0, 0.0, 585.0, 65.0, 465.0, 235.0, 700.0, 195.0, 545.0, 175.0, 450.0, 260.0, 560.0, 65.0, 270.0, 305.0, 30.0, 405.0, 260.0, 800.0, 570.0, 150.0, 315.0, 850.0, 755.0, 435.0, 280.0, 340.0, 365.0, 465.0, 340.0, 790.0, 620.0, 325.0, 0.0, 510.0, 805.0, 660.0, 905.0, 615.0, 170.0, 75.0, 180.0, 450.0, 225.0, 115.0, 280.0, 65.0, 15.0, 0.0, 910.0, 30.0, 0.0, 0.0, 185.0, 0.0, 0.0, 5.0, 0.0, 95.0, 0.0, 545.0, 90.0, 0.0, 95.0, 510.0, 865.0, 10.0, 665.0, 0.0, 0.0, 415.0, 0.0, 300.0, 315.0, 15.0, 0.0, 295.0, 70.0, 690.0, 410.0, 415.0, 160.0, 5.0, 575.0, 0.0, 5.0, 0.0, 230.0, 30.0, 70.0, 145.0, 15.0, 0.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33218537386683006, "mean_inference_ms": 1.3176839881785813, "mean_action_processing_ms": 0.13522014795921877, "mean_env_wait_ms": 0.10631610286338247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002652406692504883, "StateBufferConnector_ms": 0.002032041549682617, "ViewRequirementAgentConnector_ms": 0.049746036529541016}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -892.0, "episode_return_mean": -141.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.7903259251296, "num_env_steps_trained_throughput_per_sec": 175.7903259251296, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 22829.444, "restore_workers_time_ms": 0.019, "training_step_time_ms": 22829.268, "sample_time_ms": 822.63, "learn_time_ms": 21985.294, "learn_throughput": 181.94, "synch_weights_time_ms": 19.04}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "training_iteration": 79, "trial_id": "25fa0_00000", "date": "2024-08-12_14-02-54", "timestamp": 1723485774, "time_this_iter_s": 22.797472953796387, "time_total_s": 2111.3516652584076, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4921f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2111.3516652584076, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 24.4375, "ram_util_percent": 83.08125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5476131069085871, "cur_kl_coeff": 6.789341568946838e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6601599197058629, "policy_loss": -0.0010798962258074122, "vf_loss": 0.6612398165404253, "vf_explained_var": 0.002810712344944477, "kl": 0.0038988060177571004, "entropy": 0.2768280660733581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.983282257958005, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6606142461076767, "policy_loss": -0.002002989946049638, "vf_loss": 0.6623309530523935, "vf_explained_var": 0.005440788653989633, "kl": 0.006785942687352318, "entropy": 1.1533584163834651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -892.0, "episode_reward_mean": -71.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -297.09, "predator_policy": 225.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-286.0, -112.0, -760.0, -484.0, 20.0, -178.0, -820.0, -706.0, -322.0, -136.0, -208.0, -238.0, -358.0, -208.0, -748.0, -544.0, -190.0, 200.0, -412.0, -766.0, -592.0, -886.0, -538.0, -4.0, 110.0, -16.0, -340.0, -70.0, 62.0, -136.0, 122.0, 182.0, 200.0, -892.0, 164.0, 200.0, 200.0, -22.0, 200.0, 200.0, 194.0, 200.0, 86.0, 200.0, -454.0, 92.0, 200.0, 86.0, -412.0, -838.0, 188.0, -598.0, 200.0, 200.0, -298.0, 200.0, -160.0, -178.0, 182.0, 200.0, -154.0, 116.0, -628.0, -292.0, -298.0, 8.0, 194.0, -490.0, 200.0, 194.0, 200.0, -76.0, 164.0, 116.0, 26.0, 182.0, 200.0, 170.0, 200.0, 194.0, -838.0, 200.0, 110.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, -124.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-691.0, -372.0, -1560.0, -1054.0, -130.0, -493.0, -1670.0, -1461.0, -757.0, -416.0, -548.0, -603.0, -823.0, -548.0, -1538.0, -1164.0, -515.0, 200.0, -922.0, -1571.0, -1252.0, -1791.0, -1153.0, -174.0, 35.0, -196.0, -790.0, -295.0, -53.0, -416.0, 57.0, 167.0, 200.0, -1802.0, 134.0, 200.0, 200.0, -207.0, 200.0, 200.0, 189.0, 200.0, -9.0, 200.0, -999.0, 2.0, 200.0, -9.0, -922.0, -1703.0, 178.0, -1263.0, 200.0, 200.0, -713.0, 200.0, -460.0, -493.0, 167.0, 200.0, -449.0, 46.0, -1318.0, -702.0, -713.0, -152.0, 189.0, -1065.0, 200.0, 189.0, 200.0, -306.0, 134.0, 46.0, -119.0, 167.0, 200.0, 145.0, 200.0, 189.0, -1703.0, 200.0, 35.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, -394.0, 189.0], "policy_predator_policy_reward": [405.0, 260.0, 800.0, 570.0, 150.0, 315.0, 850.0, 755.0, 435.0, 280.0, 340.0, 365.0, 465.0, 340.0, 790.0, 620.0, 325.0, 0.0, 510.0, 805.0, 660.0, 905.0, 615.0, 170.0, 75.0, 180.0, 450.0, 225.0, 115.0, 280.0, 65.0, 15.0, 0.0, 910.0, 30.0, 0.0, 0.0, 185.0, 0.0, 0.0, 5.0, 0.0, 95.0, 0.0, 545.0, 90.0, 0.0, 95.0, 510.0, 865.0, 10.0, 665.0, 0.0, 0.0, 415.0, 0.0, 300.0, 315.0, 15.0, 0.0, 295.0, 70.0, 690.0, 410.0, 415.0, 160.0, 5.0, 575.0, 0.0, 5.0, 0.0, 230.0, 30.0, 70.0, 145.0, 15.0, 0.0, 25.0, 0.0, 5.0, 865.0, 0.0, 75.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 270.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33259782417912864, "mean_inference_ms": 1.3197594299129523, "mean_action_processing_ms": 0.13548923734454932, "mean_env_wait_ms": 0.10652443063028333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026776790618896484, "StateBufferConnector_ms": 0.002051711082458496, "ViewRequirementAgentConnector_ms": 0.05085635185241699}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -892.0, "episode_return_mean": -71.14, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.0303414665341, "num_env_steps_trained_throughput_per_sec": 170.0303414665341, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 22924.772, "restore_workers_time_ms": 0.019, "training_step_time_ms": 22924.593, "sample_time_ms": 832.742, "learn_time_ms": 22069.648, "learn_throughput": 181.244, "synch_weights_time_ms": 19.88}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 80, "trial_id": "25fa0_00000", "date": "2024-08-12_14-03-17", "timestamp": 1723485797, "time_this_iter_s": 23.53519582748413, "time_total_s": 2134.8868610858917, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4921ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2134.8868610858917, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 26.188235294117643, "ram_util_percent": 83.21176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0924443645868451, "cur_kl_coeff": 3.394670784473419e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.273819118924439, "policy_loss": -0.002314663165695189, "vf_loss": 1.2761337782877187, "vf_explained_var": -0.001220147746304671, "kl": 0.006176401146098935, "entropy": 0.25291634377402566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.840982157333444, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.408737667199845, "policy_loss": -0.00918260781133237, "vf_loss": 1.4175647730318208, "vf_explained_var": 0.01446975531677405, "kl": 0.008426991939692959, "entropy": 1.020058123767376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -892.0, "episode_reward_mean": 15.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -138.47, "predator_policy": 153.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-412.0, -766.0, -592.0, -886.0, -538.0, -4.0, 110.0, -16.0, -340.0, -70.0, 62.0, -136.0, 122.0, 182.0, 200.0, -892.0, 164.0, 200.0, 200.0, -22.0, 200.0, 200.0, 194.0, 200.0, 86.0, 200.0, -454.0, 92.0, 200.0, 86.0, -412.0, -838.0, 188.0, -598.0, 200.0, 200.0, -298.0, 200.0, -160.0, -178.0, 182.0, 200.0, -154.0, 116.0, -628.0, -292.0, -298.0, 8.0, 194.0, -490.0, 200.0, 194.0, 200.0, -76.0, 164.0, 116.0, 26.0, 182.0, 200.0, 170.0, 200.0, 194.0, -838.0, 200.0, 110.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, -124.0, 194.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 14.0, 194.0, 200.0, 188.0, 200.0, 200.0, 200.0, 170.0, 200.0, -280.0, 170.0, -82.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-922.0, -1571.0, -1252.0, -1791.0, -1153.0, -174.0, 35.0, -196.0, -790.0, -295.0, -53.0, -416.0, 57.0, 167.0, 200.0, -1802.0, 134.0, 200.0, 200.0, -207.0, 200.0, 200.0, 189.0, 200.0, -9.0, 200.0, -999.0, 2.0, 200.0, -9.0, -922.0, -1703.0, 178.0, -1263.0, 200.0, 200.0, -713.0, 200.0, -460.0, -493.0, 167.0, 200.0, -449.0, 46.0, -1318.0, -702.0, -713.0, -152.0, 189.0, -1065.0, 200.0, 189.0, 200.0, -306.0, 134.0, 46.0, -119.0, 167.0, 200.0, 145.0, 200.0, 189.0, -1703.0, 200.0, 35.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, -394.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -141.0, 189.0, 200.0, 178.0, 200.0, 200.0, 200.0, 145.0, 200.0, -680.0, 145.0, -317.0], "policy_predator_policy_reward": [510.0, 805.0, 660.0, 905.0, 615.0, 170.0, 75.0, 180.0, 450.0, 225.0, 115.0, 280.0, 65.0, 15.0, 0.0, 910.0, 30.0, 0.0, 0.0, 185.0, 0.0, 0.0, 5.0, 0.0, 95.0, 0.0, 545.0, 90.0, 0.0, 95.0, 510.0, 865.0, 10.0, 665.0, 0.0, 0.0, 415.0, 0.0, 300.0, 315.0, 15.0, 0.0, 295.0, 70.0, 690.0, 410.0, 415.0, 160.0, 5.0, 575.0, 0.0, 5.0, 0.0, 230.0, 30.0, 70.0, 145.0, 15.0, 0.0, 25.0, 0.0, 5.0, 865.0, 0.0, 75.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 270.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 25.0, 0.0, 400.0, 25.0, 235.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3315549929413612, "mean_inference_ms": 1.314117997205257, "mean_action_processing_ms": 0.13498047504119257, "mean_env_wait_ms": 0.10606996889641093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027017593383789062, "StateBufferConnector_ms": 0.0021010637283325195, "ViewRequirementAgentConnector_ms": 0.05249226093292236}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -892.0, "episode_return_mean": 15.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.61306245504895, "num_env_steps_trained_throughput_per_sec": 173.61306245504895, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 22956.207, "restore_workers_time_ms": 0.02, "training_step_time_ms": 22956.027, "sample_time_ms": 835.685, "learn_time_ms": 22098.971, "learn_throughput": 181.004, "synch_weights_time_ms": 18.931}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 81, "trial_id": "25fa0_00000", "date": "2024-08-12_14-03-40", "timestamp": 1723485820, "time_this_iter_s": 23.08495593070984, "time_total_s": 2157.9718170166016, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a23825e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2157.9718170166016, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 24.58787878787879, "ram_util_percent": 83.39393939393939}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7729335518321022, "cur_kl_coeff": 3.394670784473419e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9655706857020656, "policy_loss": -0.00175134755554609, "vf_loss": 1.9673220309428872, "vf_explained_var": -0.00040506087243556975, "kl": 0.005339279874311482, "entropy": 0.26258470946922896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.345483005171021, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0572140281631923, "policy_loss": -0.014041415000489603, "vf_loss": 2.070534277241677, "vf_explained_var": 0.012358697193364302, "kl": 0.01709433727304221, "entropy": 1.122527786840995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -838.0, "episode_reward_mean": 64.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1703.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -48.05, "predator_policy": 112.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 86.0, 200.0, -454.0, 92.0, 200.0, 86.0, -412.0, -838.0, 188.0, -598.0, 200.0, 200.0, -298.0, 200.0, -160.0, -178.0, 182.0, 200.0, -154.0, 116.0, -628.0, -292.0, -298.0, 8.0, 194.0, -490.0, 200.0, 194.0, 200.0, -76.0, 164.0, 116.0, 26.0, 182.0, 200.0, 170.0, 200.0, 194.0, -838.0, 200.0, 110.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, -124.0, 194.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 14.0, 194.0, 200.0, 188.0, 200.0, 200.0, 200.0, 170.0, 200.0, -280.0, 170.0, -82.0, 170.0, 200.0, 200.0, 128.0, 110.0, 44.0, 104.0, 122.0, 194.0, 200.0, -130.0, 200.0, -730.0, 200.0, 116.0, 44.0, 50.0, 200.0, 200.0, 200.0, -130.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -9.0, 200.0, -999.0, 2.0, 200.0, -9.0, -922.0, -1703.0, 178.0, -1263.0, 200.0, 200.0, -713.0, 200.0, -460.0, -493.0, 167.0, 200.0, -449.0, 46.0, -1318.0, -702.0, -713.0, -152.0, 189.0, -1065.0, 200.0, 189.0, 200.0, -306.0, 134.0, 46.0, -119.0, 167.0, 200.0, 145.0, 200.0, 189.0, -1703.0, 200.0, 35.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, -394.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -141.0, 189.0, 200.0, 178.0, 200.0, 200.0, 200.0, 145.0, 200.0, -680.0, 145.0, -317.0, 145.0, 200.0, 200.0, 68.0, 35.0, -86.0, 24.0, 57.0, 189.0, 200.0, -405.0, 200.0, -1505.0, 200.0, 46.0, -86.0, -75.0, 200.0, 200.0, 200.0, -405.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 95.0, 0.0, 545.0, 90.0, 0.0, 95.0, 510.0, 865.0, 10.0, 665.0, 0.0, 0.0, 415.0, 0.0, 300.0, 315.0, 15.0, 0.0, 295.0, 70.0, 690.0, 410.0, 415.0, 160.0, 5.0, 575.0, 0.0, 5.0, 0.0, 230.0, 30.0, 70.0, 145.0, 15.0, 0.0, 25.0, 0.0, 5.0, 865.0, 0.0, 75.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 270.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 25.0, 0.0, 400.0, 25.0, 235.0, 25.0, 0.0, 0.0, 60.0, 75.0, 130.0, 80.0, 65.0, 5.0, 0.0, 275.0, 0.0, 775.0, 0.0, 70.0, 130.0, 125.0, 0.0, 0.0, 0.0, 275.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33170748299348884, "mean_inference_ms": 1.3136016800244203, "mean_action_processing_ms": 0.13496625734348017, "mean_env_wait_ms": 0.10596900709388184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002728700637817383, "StateBufferConnector_ms": 0.0021196603775024414, "ViewRequirementAgentConnector_ms": 0.05336010456085205}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -838.0, "episode_return_mean": 64.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.2847966705041, "num_env_steps_trained_throughput_per_sec": 171.2847966705041, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 22997.322, "restore_workers_time_ms": 0.02, "training_step_time_ms": 22996.882, "sample_time_ms": 841.724, "learn_time_ms": 22130.541, "learn_throughput": 180.746, "synch_weights_time_ms": 21.813}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 82, "trial_id": "25fa0_00000", "date": "2024-08-12_14-04-04", "timestamp": 1723485844, "time_this_iter_s": 23.4344220161438, "time_total_s": 2181.4062390327454, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a49211f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2181.4062390327454, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.484848484848484, "ram_util_percent": 83.23030303030305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4801807880246391, "cur_kl_coeff": 3.394670784473419e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4215976739302278, "policy_loss": -0.002224073661879326, "vf_loss": 1.4238217475513617, "vf_explained_var": 8.436174442370733e-05, "kl": 0.004343435392762492, "entropy": 0.3480530557377885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.177794624430438, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4826078417749764, "policy_loss": -0.008718020567903296, "vf_loss": 1.4908527015397945, "vf_explained_var": 0.008644830311338107, "kl": 0.01121578111424639, "entropy": 1.1202454047898451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -838.0, "episode_reward_mean": 104.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1703.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": 24.0, "predator_policy": 80.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -154.0, 116.0, -628.0, -292.0, -298.0, 8.0, 194.0, -490.0, 200.0, 194.0, 200.0, -76.0, 164.0, 116.0, 26.0, 182.0, 200.0, 170.0, 200.0, 194.0, -838.0, 200.0, 110.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, -124.0, 194.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 14.0, 194.0, 200.0, 188.0, 200.0, 200.0, 200.0, 170.0, 200.0, -280.0, 170.0, -82.0, 170.0, 200.0, 200.0, 128.0, 110.0, 44.0, 104.0, 122.0, 194.0, 200.0, -130.0, 200.0, -730.0, 200.0, 116.0, 44.0, 50.0, 200.0, 200.0, 200.0, -130.0, 200.0, 200.0, 200.0, 164.0, 200.0, 146.0, 176.0, 200.0, 200.0, -34.0, 200.0, 122.0, 200.0, 50.0, 194.0, 200.0, 8.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -449.0, 46.0, -1318.0, -702.0, -713.0, -152.0, 189.0, -1065.0, 200.0, 189.0, 200.0, -306.0, 134.0, 46.0, -119.0, 167.0, 200.0, 145.0, 200.0, 189.0, -1703.0, 200.0, 35.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, -394.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -141.0, 189.0, 200.0, 178.0, 200.0, 200.0, 200.0, 145.0, 200.0, -680.0, 145.0, -317.0, 145.0, 200.0, 200.0, 68.0, 35.0, -86.0, 24.0, 57.0, 189.0, 200.0, -405.0, 200.0, -1505.0, 200.0, 46.0, -86.0, -75.0, 200.0, 200.0, 200.0, -405.0, 200.0, 200.0, 200.0, 134.0, 200.0, 101.0, 156.0, 200.0, 200.0, -229.0, 200.0, 57.0, 200.0, -75.0, 189.0, 200.0, -152.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 295.0, 70.0, 690.0, 410.0, 415.0, 160.0, 5.0, 575.0, 0.0, 5.0, 0.0, 230.0, 30.0, 70.0, 145.0, 15.0, 0.0, 25.0, 0.0, 5.0, 865.0, 0.0, 75.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 270.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 25.0, 0.0, 400.0, 25.0, 235.0, 25.0, 0.0, 0.0, 60.0, 75.0, 130.0, 80.0, 65.0, 5.0, 0.0, 275.0, 0.0, 775.0, 0.0, 70.0, 130.0, 125.0, 0.0, 0.0, 0.0, 275.0, 0.0, 0.0, 0.0, 30.0, 0.0, 45.0, 20.0, 0.0, 0.0, 195.0, 0.0, 65.0, 0.0, 125.0, 5.0, 0.0, 160.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3310498954988902, "mean_inference_ms": 1.3106562397293187, "mean_action_processing_ms": 0.1347334406880075, "mean_env_wait_ms": 0.10587456599785322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026006698608398438, "StateBufferConnector_ms": 0.002101421356201172, "ViewRequirementAgentConnector_ms": 0.052851080894470215}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -838.0, "episode_return_mean": 104.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.95992549346255, "num_env_steps_trained_throughput_per_sec": 175.95992549346255, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 22997.171, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22996.745, "sample_time_ms": 845.675, "learn_time_ms": 22127.312, "learn_throughput": 180.772, "synch_weights_time_ms": 21.133}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "training_iteration": 83, "trial_id": "25fa0_00000", "date": "2024-08-12_14-04-26", "timestamp": 1723485866, "time_this_iter_s": 22.73690915107727, "time_total_s": 2204.1431481838226, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2204.1431481838226, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 22.43125, "ram_util_percent": 83.04374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0531194419988121, "cur_kl_coeff": 1.6973353922367094e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.103312543562303, "policy_loss": -0.004271573594693715, "vf_loss": 1.107584115428229, "vf_explained_var": -9.531887869040171e-05, "kl": 0.004270217310074432, "entropy": 0.3306331388652325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.302098571509123, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1189814180678999, "policy_loss": -0.009584569965469806, "vf_loss": 1.1282415944772461, "vf_explained_var": 0.010969027131795882, "kl": 0.007689323988451258, "entropy": 1.0484380804623166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -838.0, "episode_reward_mean": 131.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1703.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": 75.26, "predator_policy": 56.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 200.0, 194.0, -838.0, 200.0, 110.0, 182.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 158.0, 200.0, 200.0, 200.0, -124.0, 194.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 14.0, 194.0, 200.0, 188.0, 200.0, 200.0, 200.0, 170.0, 200.0, -280.0, 170.0, -82.0, 170.0, 200.0, 200.0, 128.0, 110.0, 44.0, 104.0, 122.0, 194.0, 200.0, -130.0, 200.0, -730.0, 200.0, 116.0, 44.0, 50.0, 200.0, 200.0, 200.0, -130.0, 200.0, 200.0, 200.0, 164.0, 200.0, 146.0, 176.0, 200.0, 200.0, -34.0, 200.0, 122.0, 200.0, 50.0, 194.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 188.0, 164.0, 200.0, 200.0, 200.0, 74.0, 200.0, 170.0, 32.0, 200.0, 194.0, 200.0, -364.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, 200.0, 189.0, -1703.0, 200.0, 35.0, 167.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 123.0, 200.0, 200.0, 200.0, -394.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -141.0, 189.0, 200.0, 178.0, 200.0, 200.0, 200.0, 145.0, 200.0, -680.0, 145.0, -317.0, 145.0, 200.0, 200.0, 68.0, 35.0, -86.0, 24.0, 57.0, 189.0, 200.0, -405.0, 200.0, -1505.0, 200.0, 46.0, -86.0, -75.0, 200.0, 200.0, 200.0, -405.0, 200.0, 200.0, 200.0, 134.0, 200.0, 101.0, 156.0, 200.0, 200.0, -229.0, 200.0, 57.0, 200.0, -75.0, 189.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 178.0, 134.0, 200.0, 200.0, 200.0, -31.0, 200.0, 145.0, -108.0, 200.0, 189.0, 200.0, -834.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [25.0, 0.0, 5.0, 865.0, 0.0, 75.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 0.0, 0.0, 0.0, 270.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 25.0, 0.0, 400.0, 25.0, 235.0, 25.0, 0.0, 0.0, 60.0, 75.0, 130.0, 80.0, 65.0, 5.0, 0.0, 275.0, 0.0, 775.0, 0.0, 70.0, 130.0, 125.0, 0.0, 0.0, 0.0, 275.0, 0.0, 0.0, 0.0, 30.0, 0.0, 45.0, 20.0, 0.0, 0.0, 195.0, 0.0, 65.0, 0.0, 125.0, 5.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 105.0, 0.0, 25.0, 140.0, 0.0, 5.0, 0.0, 470.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3308565576274895, "mean_inference_ms": 1.3091501130910341, "mean_action_processing_ms": 0.13464132946856547, "mean_env_wait_ms": 0.1057657959118055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0026248693466186523, "StateBufferConnector_ms": 0.0020481348037719727, "ViewRequirementAgentConnector_ms": 0.06452703475952148}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -838.0, "episode_return_mean": 131.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.76757194116104, "num_env_steps_trained_throughput_per_sec": 172.76757194116104, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 22983.739, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22983.315, "sample_time_ms": 846.66, "learn_time_ms": 22112.315, "learn_throughput": 180.895, "synch_weights_time_ms": 21.641}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 84, "trial_id": "25fa0_00000", "date": "2024-08-12_14-04-50", "timestamp": 1723485890, "time_this_iter_s": 23.200997829437256, "time_total_s": 2227.34414601326, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48a9280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2227.34414601326, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 23.672727272727272, "ram_util_percent": 82.51212121212122}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5501190881788109, "cur_kl_coeff": 8.486676961183547e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5120737010923524, "policy_loss": -0.0013395179572398773, "vf_loss": 1.5134132205540936, "vf_explained_var": 0.0010214734822511673, "kl": 0.006310824266340799, "entropy": 0.2849483983280758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.810648735736807, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5635044167439143, "policy_loss": -0.005778045614715665, "vf_loss": 1.5688791239634157, "vf_explained_var": 0.006455340112249057, "kl": 0.009560589527297544, "entropy": 1.0814736266930898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -730.0, "episode_reward_mean": 126.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1505.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 775.0}, "policy_reward_mean": {"prey_policy": 65.8, "predator_policy": 61.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 14.0, 194.0, 200.0, 188.0, 200.0, 200.0, 200.0, 170.0, 200.0, -280.0, 170.0, -82.0, 170.0, 200.0, 200.0, 128.0, 110.0, 44.0, 104.0, 122.0, 194.0, 200.0, -130.0, 200.0, -730.0, 200.0, 116.0, 44.0, 50.0, 200.0, 200.0, 200.0, -130.0, 200.0, 200.0, 200.0, 164.0, 200.0, 146.0, 176.0, 200.0, 200.0, -34.0, 200.0, 122.0, 200.0, 50.0, 194.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 188.0, 164.0, 200.0, 200.0, 200.0, 74.0, 200.0, 170.0, 32.0, 200.0, 194.0, 200.0, -364.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, -28.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 116.0, 200.0, 146.0, 98.0, 152.0, 200.0, -82.0, -76.0, 200.0, 170.0, -640.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -141.0, 189.0, 200.0, 178.0, 200.0, 200.0, 200.0, 145.0, 200.0, -680.0, 145.0, -317.0, 145.0, 200.0, 200.0, 68.0, 35.0, -86.0, 24.0, 57.0, 189.0, 200.0, -405.0, 200.0, -1505.0, 200.0, 46.0, -86.0, -75.0, 200.0, 200.0, 200.0, -405.0, 200.0, 200.0, 200.0, 134.0, 200.0, 101.0, 156.0, 200.0, 200.0, -229.0, 200.0, 57.0, 200.0, -75.0, 189.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 178.0, 134.0, 200.0, 200.0, 200.0, -31.0, 200.0, 145.0, -108.0, 200.0, 189.0, 200.0, -834.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, -218.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 46.0, 200.0, 101.0, 13.0, 112.0, 200.0, -317.0, -306.0, 200.0, 145.0, -1340.0], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 10.0, 0.0, 0.0, 0.0, 25.0, 0.0, 400.0, 25.0, 235.0, 25.0, 0.0, 0.0, 60.0, 75.0, 130.0, 80.0, 65.0, 5.0, 0.0, 275.0, 0.0, 775.0, 0.0, 70.0, 130.0, 125.0, 0.0, 0.0, 0.0, 275.0, 0.0, 0.0, 0.0, 30.0, 0.0, 45.0, 20.0, 0.0, 0.0, 195.0, 0.0, 65.0, 0.0, 125.0, 5.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 105.0, 0.0, 25.0, 140.0, 0.0, 5.0, 0.0, 470.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 190.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 70.0, 0.0, 45.0, 85.0, 40.0, 0.0, 235.0, 230.0, 0.0, 25.0, 700.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33063133417844226, "mean_inference_ms": 1.3071869671275769, "mean_action_processing_ms": 0.1345201654121067, "mean_env_wait_ms": 0.10564559335881228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002820253372192383, "StateBufferConnector_ms": 0.002061128616333008, "ViewRequirementAgentConnector_ms": 0.06566345691680908}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -730.0, "episode_return_mean": 126.8, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.63120505396807, "num_env_steps_trained_throughput_per_sec": 175.63120505396807, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 22989.679, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22989.167, "sample_time_ms": 852.517, "learn_time_ms": 22113.413, "learn_throughput": 180.886, "synch_weights_time_ms": 20.733}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 85, "trial_id": "25fa0_00000", "date": "2024-08-12_14-05-13", "timestamp": 1723485913, "time_this_iter_s": 22.817307949066162, "time_total_s": 2250.161453962326, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2394040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2250.161453962326, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 23.896875, "ram_util_percent": 82.8125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5970244379442495, "cur_kl_coeff": 8.486676961183547e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9409432871888082, "policy_loss": -0.002013878250242366, "vf_loss": 0.942957162632941, "vf_explained_var": 0.0006077001492182414, "kl": 0.005094161426757123, "entropy": 0.3205639852210879, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.696468581818044, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.973198264214443, "policy_loss": -0.005832971804678285, "vf_loss": 0.9784658229606672, "vf_explained_var": 0.007451407549281915, "kl": 0.013402338812770285, "entropy": 1.1399720977991818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -730.0, "episode_reward_mean": 121.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1505.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 775.0}, "policy_reward_mean": {"prey_policy": 56.78, "predator_policy": 65.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.0, 170.0, 200.0, 200.0, 128.0, 110.0, 44.0, 104.0, 122.0, 194.0, 200.0, -130.0, 200.0, -730.0, 200.0, 116.0, 44.0, 50.0, 200.0, 200.0, 200.0, -130.0, 200.0, 200.0, 200.0, 164.0, 200.0, 146.0, 176.0, 200.0, 200.0, -34.0, 200.0, 122.0, 200.0, 50.0, 194.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 188.0, 164.0, 200.0, 200.0, 200.0, 74.0, 200.0, 170.0, 32.0, 200.0, 194.0, 200.0, -364.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, -28.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 116.0, 200.0, 146.0, 98.0, 152.0, 200.0, -82.0, -76.0, 200.0, 170.0, -640.0, -94.0, 98.0, 200.0, 194.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, -568.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-317.0, 145.0, 200.0, 200.0, 68.0, 35.0, -86.0, 24.0, 57.0, 189.0, 200.0, -405.0, 200.0, -1505.0, 200.0, 46.0, -86.0, -75.0, 200.0, 200.0, 200.0, -405.0, 200.0, 200.0, 200.0, 134.0, 200.0, 101.0, 156.0, 200.0, 200.0, -229.0, 200.0, 57.0, 200.0, -75.0, 189.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 178.0, 134.0, 200.0, 200.0, 200.0, -31.0, 200.0, 145.0, -108.0, 200.0, 189.0, 200.0, -834.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, -218.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 46.0, 200.0, 101.0, 13.0, 112.0, 200.0, -317.0, -306.0, 200.0, 145.0, -1340.0, -339.0, 13.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, -1208.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [235.0, 25.0, 0.0, 0.0, 60.0, 75.0, 130.0, 80.0, 65.0, 5.0, 0.0, 275.0, 0.0, 775.0, 0.0, 70.0, 130.0, 125.0, 0.0, 0.0, 0.0, 275.0, 0.0, 0.0, 0.0, 30.0, 0.0, 45.0, 20.0, 0.0, 0.0, 195.0, 0.0, 65.0, 0.0, 125.0, 5.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 105.0, 0.0, 25.0, 140.0, 0.0, 5.0, 0.0, 470.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 190.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 70.0, 0.0, 45.0, 85.0, 40.0, 0.0, 235.0, 230.0, 0.0, 25.0, 700.0, 245.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 640.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33045465366899457, "mean_inference_ms": 1.3056434320463859, "mean_action_processing_ms": 0.1344278231003451, "mean_env_wait_ms": 0.10554381822716394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027709007263183594, "StateBufferConnector_ms": 0.0020186901092529297, "ViewRequirementAgentConnector_ms": 0.06314253807067871}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -730.0, "episode_return_mean": 121.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.62934626525973, "num_env_steps_trained_throughput_per_sec": 175.62934626525973, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 22991.854, "restore_workers_time_ms": 0.02, "training_step_time_ms": 22991.34, "sample_time_ms": 853.317, "learn_time_ms": 22114.436, "learn_throughput": 180.877, "synch_weights_time_ms": 21.219}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 86, "trial_id": "25fa0_00000", "date": "2024-08-12_14-05-35", "timestamp": 1723485935, "time_this_iter_s": 22.7811918258667, "time_total_s": 2272.9426457881927, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2394af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2272.9426457881927, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 22.06969696969697, "ram_util_percent": 82.78787878787878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8417961359412099, "cur_kl_coeff": 8.486676961183547e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5805886094768842, "policy_loss": -0.0022278521239059044, "vf_loss": 0.5828164634809535, "vf_explained_var": 0.001663288101553917, "kl": 0.007294968485160872, "entropy": 0.3897785423323512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.467572830120723, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6463014123185228, "policy_loss": -0.0089905711375953, "vf_loss": 0.654879487278716, "vf_explained_var": 0.03053058385848999, "kl": 0.009777692786652874, "entropy": 1.1094409593691428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -640.0, "episode_reward_mean": 142.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 700.0}, "policy_reward_mean": {"prey_policy": 94.84, "predator_policy": 47.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 164.0, 200.0, 146.0, 176.0, 200.0, 200.0, -34.0, 200.0, 122.0, 200.0, 50.0, 194.0, 200.0, 8.0, 200.0, 200.0, 200.0, 200.0, 188.0, 164.0, 200.0, 200.0, 200.0, 74.0, 200.0, 170.0, 32.0, 200.0, 194.0, 200.0, -364.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, -28.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 116.0, 200.0, 146.0, 98.0, 152.0, 200.0, -82.0, -76.0, 200.0, 170.0, -640.0, -94.0, 98.0, 200.0, 194.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, -568.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 74.0, 14.0, 128.0, 200.0, 164.0, 200.0, 194.0, 200.0, 200.0, -10.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 158.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 134.0, 200.0, 101.0, 156.0, 200.0, 200.0, -229.0, 200.0, 57.0, 200.0, -75.0, 189.0, 200.0, -152.0, 200.0, 200.0, 200.0, 200.0, 178.0, 134.0, 200.0, 200.0, 200.0, -31.0, 200.0, 145.0, -108.0, 200.0, 189.0, 200.0, -834.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, -218.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 46.0, 200.0, 101.0, 13.0, 112.0, 200.0, -317.0, -306.0, 200.0, 145.0, -1340.0, -339.0, 13.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, -1208.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -31.0, -141.0, 68.0, 200.0, 134.0, 200.0, 189.0, 200.0, 200.0, -185.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 123.0], "policy_predator_policy_reward": [0.0, 0.0, 30.0, 0.0, 45.0, 20.0, 0.0, 0.0, 195.0, 0.0, 65.0, 0.0, 125.0, 5.0, 0.0, 160.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 105.0, 0.0, 25.0, 140.0, 0.0, 5.0, 0.0, 470.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 190.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 70.0, 0.0, 45.0, 85.0, 40.0, 0.0, 235.0, 230.0, 0.0, 25.0, 700.0, 245.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 640.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 105.0, 155.0, 60.0, 0.0, 30.0, 0.0, 5.0, 0.0, 0.0, 175.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.33014523059818385, "mean_inference_ms": 1.3035083452671556, "mean_action_processing_ms": 0.13429265349162864, "mean_env_wait_ms": 0.10538131842963643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027534961700439453, "StateBufferConnector_ms": 0.0020515918731689453, "ViewRequirementAgentConnector_ms": 0.06306123733520508}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -640.0, "episode_return_mean": 142.64, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.11953982262494, "num_env_steps_trained_throughput_per_sec": 174.11953982262494, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 22976.602, "restore_workers_time_ms": 0.02, "training_step_time_ms": 22976.145, "sample_time_ms": 843.948, "learn_time_ms": 22109.267, "learn_throughput": 180.92, "synch_weights_time_ms": 20.774}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 87, "trial_id": "25fa0_00000", "date": "2024-08-12_14-05-58", "timestamp": 1723485958, "time_this_iter_s": 22.998780965805054, "time_total_s": 2295.941426753998, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48a91f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2295.941426753998, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 23.64375, "ram_util_percent": 82.56875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8704026169531668, "cur_kl_coeff": 8.486676961183547e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4993398855440319, "policy_loss": -0.004092287708287282, "vf_loss": 1.5034321667325419, "vf_explained_var": 0.00014537634948889414, "kl": 0.009729887618672998, "entropy": 0.33130403977508344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.424175445300837, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5080681880625586, "policy_loss": -0.014045880640333052, "vf_loss": 1.5215485212703546, "vf_explained_var": 0.013357528733710449, "kl": 0.013405495919205944, "entropy": 1.035578125094374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -640.0, "episode_reward_mean": 136.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 700.0}, "policy_reward_mean": {"prey_policy": 83.95, "predator_policy": 52.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 188.0, 164.0, 200.0, 200.0, 200.0, 74.0, 200.0, 170.0, 32.0, 200.0, 194.0, 200.0, -364.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 140.0, -28.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 116.0, 200.0, 146.0, 98.0, 152.0, 200.0, -82.0, -76.0, 200.0, 170.0, -640.0, -94.0, 98.0, 200.0, 194.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, -568.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 74.0, 14.0, 128.0, 200.0, 164.0, 200.0, 194.0, 200.0, 200.0, -10.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 158.0, 68.0, 200.0, -118.0, -106.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 194.0, 200.0, 200.0, 200.0, 104.0, 200.0, -196.0, 98.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 178.0, 134.0, 200.0, 200.0, 200.0, -31.0, 200.0, 145.0, -108.0, 200.0, 189.0, 200.0, -834.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 90.0, -218.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 46.0, 200.0, 101.0, 13.0, 112.0, 200.0, -317.0, -306.0, 200.0, 145.0, -1340.0, -339.0, 13.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, -1208.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -31.0, -141.0, 68.0, 200.0, 134.0, 200.0, 189.0, 200.0, 200.0, -185.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 123.0, -42.0, 200.0, -383.0, -361.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 189.0, 200.0, 200.0, 200.0, 24.0, 200.0, -526.0, 13.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 105.0, 0.0, 25.0, 140.0, 0.0, 5.0, 0.0, 470.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 50.0, 190.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 70.0, 0.0, 45.0, 85.0, 40.0, 0.0, 235.0, 230.0, 0.0, 25.0, 700.0, 245.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 640.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 105.0, 155.0, 60.0, 0.0, 30.0, 0.0, 5.0, 0.0, 0.0, 175.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 35.0, 110.0, 0.0, 265.0, 255.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 80.0, 0.0, 330.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32986848684143055, "mean_inference_ms": 1.3017157172008385, "mean_action_processing_ms": 0.13417955202297616, "mean_env_wait_ms": 0.10524238720294321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028302669525146484, "StateBufferConnector_ms": 0.0020369291305541992, "ViewRequirementAgentConnector_ms": 0.0639181137084961}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -640.0, "episode_return_mean": 136.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.30756772711544, "num_env_steps_trained_throughput_per_sec": 177.30756772711544, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 22963.999, "restore_workers_time_ms": 0.019, "training_step_time_ms": 22963.581, "sample_time_ms": 837.249, "learn_time_ms": 22104.806, "learn_throughput": 180.956, "synch_weights_time_ms": 19.589}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 88, "trial_id": "25fa0_00000", "date": "2024-08-12_14-06-21", "timestamp": 1723485981, "time_this_iter_s": 22.565604209899902, "time_total_s": 2318.5070309638977, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a49210d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2318.5070309638977, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 20.975, "ram_util_percent": 82.70625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8618675688824927, "cur_kl_coeff": 8.486676961183547e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2044427551329135, "policy_loss": -0.0028346246166620404, "vf_loss": 1.207277381830939, "vf_explained_var": -0.0004839154581228892, "kl": 0.004443094455319793, "entropy": 0.2558550828602165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.645311830999951, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2657983889415239, "policy_loss": -0.007556704769376666, "vf_loss": 1.2730531271547079, "vf_explained_var": 0.027302449258665245, "kl": 0.00715776059857998, "entropy": 1.087368990605076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -640.0, "episode_reward_mean": 141.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 700.0}, "policy_reward_mean": {"prey_policy": 91.87, "predator_policy": 49.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 116.0, 200.0, 146.0, 98.0, 152.0, 200.0, -82.0, -76.0, 200.0, 170.0, -640.0, -94.0, 98.0, 200.0, 194.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, -568.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 74.0, 14.0, 128.0, 200.0, 164.0, 200.0, 194.0, 200.0, 200.0, -10.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 158.0, 68.0, 200.0, -118.0, -106.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 194.0, 200.0, 200.0, 200.0, 104.0, 200.0, -196.0, 98.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 158.0, 92.0, 200.0, 200.0, 200.0, 104.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, -28.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-218.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 46.0, 200.0, 101.0, 13.0, 112.0, 200.0, -317.0, -306.0, 200.0, 145.0, -1340.0, -339.0, 13.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, -1208.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -31.0, -141.0, 68.0, 200.0, 134.0, 200.0, 189.0, 200.0, 200.0, -185.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 123.0, -42.0, 200.0, -383.0, -361.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 189.0, 200.0, 200.0, 200.0, 24.0, 200.0, -526.0, 13.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 123.0, 2.0, 200.0, 200.0, 200.0, 24.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0], "policy_predator_policy_reward": [190.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 70.0, 0.0, 45.0, 85.0, 40.0, 0.0, 235.0, 230.0, 0.0, 25.0, 700.0, 245.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 640.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 105.0, 155.0, 60.0, 0.0, 30.0, 0.0, 5.0, 0.0, 0.0, 175.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 35.0, 110.0, 0.0, 265.0, 255.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 80.0, 0.0, 330.0, 85.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 35.0, 90.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3302311661759438, "mean_inference_ms": 1.303303892133089, "mean_action_processing_ms": 0.13440310211804132, "mean_env_wait_ms": 0.10542175854603776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027889013290405273, "StateBufferConnector_ms": 0.002068042755126953, "ViewRequirementAgentConnector_ms": 0.05135476589202881}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -640.0, "episode_return_mean": 141.02, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.90665674989168, "num_env_steps_trained_throughput_per_sec": 174.90665674989168, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 22975.494, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22975.079, "sample_time_ms": 831.054, "learn_time_ms": 22121.442, "learn_throughput": 180.82, "synch_weights_time_ms": 20.58}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "training_iteration": 89, "trial_id": "25fa0_00000", "date": "2024-08-12_14-06-44", "timestamp": 1723486004, "time_this_iter_s": 22.90093684196472, "time_total_s": 2341.4079678058624, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2341.4079678058624, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 21.75, "ram_util_percent": 82.734375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7902659189111243, "cur_kl_coeff": 4.2433384805917735e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3148803741981587, "policy_loss": -0.0063295572144852486, "vf_loss": 2.3212099207565187, "vf_explained_var": -3.344025462865829e-05, "kl": 0.01198867875689911, "entropy": 0.3414192056283355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.453743193981548, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.33402198292315, "policy_loss": -0.009505313287081662, "vf_loss": 2.3431125519176326, "vf_explained_var": 0.024303273732463517, "kl": 0.009830712773848022, "entropy": 1.0786332974831263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -946.0, "episode_reward_mean": 126.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": 65.58, "predator_policy": 61.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-640.0, -94.0, 98.0, 200.0, 194.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 200.0, -568.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 200.0, 74.0, 14.0, 128.0, 200.0, 164.0, 200.0, 194.0, 200.0, 200.0, -10.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 158.0, 68.0, 200.0, -118.0, -106.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 194.0, 200.0, 200.0, 200.0, 104.0, 200.0, -196.0, 98.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 158.0, 92.0, 200.0, 200.0, 200.0, 104.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, -28.0, 200.0, -58.0, 200.0, 200.0, -190.0, 200.0, 200.0, 188.0, -184.0, 200.0, 200.0, 104.0, 200.0, 74.0, 200.0, 194.0, -946.0, 200.0, 20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1340.0, -339.0, 13.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 200.0, -1208.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -31.0, -141.0, 68.0, 200.0, 134.0, 200.0, 189.0, 200.0, 200.0, -185.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 123.0, -42.0, 200.0, -383.0, -361.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 189.0, 200.0, 200.0, 200.0, 24.0, 200.0, -526.0, 13.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 123.0, 2.0, 200.0, 200.0, 200.0, 24.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, -273.0, 200.0, 200.0, -515.0, 200.0, 200.0, 178.0, -504.0, 200.0, 200.0, 24.0, 200.0, -31.0, 200.0, 189.0, -1901.0, 200.0, -130.0], "policy_predator_policy_reward": [700.0, 245.0, 85.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 0.0, 640.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 105.0, 155.0, 60.0, 0.0, 30.0, 0.0, 5.0, 0.0, 0.0, 175.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 35.0, 110.0, 0.0, 265.0, 255.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 80.0, 0.0, 330.0, 85.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 35.0, 90.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 0.0, 215.0, 0.0, 0.0, 325.0, 0.0, 0.0, 10.0, 320.0, 0.0, 0.0, 80.0, 0.0, 105.0, 0.0, 5.0, 955.0, 0.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3291223629888158, "mean_inference_ms": 1.2975362804421728, "mean_action_processing_ms": 0.1338812102937802, "mean_env_wait_ms": 0.1049100837549694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002638101577758789, "StateBufferConnector_ms": 0.0020638704299926758, "ViewRequirementAgentConnector_ms": 0.04932403564453125}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -946.0, "episode_return_mean": 126.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.1252082375805, "num_env_steps_trained_throughput_per_sec": 172.1252082375805, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 22946.862, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22946.407, "sample_time_ms": 825.523, "learn_time_ms": 22098.459, "learn_throughput": 181.008, "synch_weights_time_ms": 20.101}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 90, "trial_id": "25fa0_00000", "date": "2024-08-12_14-07-07", "timestamp": 1723486027, "time_this_iter_s": 23.269426822662354, "time_total_s": 2364.677394628525, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2394820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2364.677394628525, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 24.721212121212123, "ram_util_percent": 82.85151515151516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9201300716299253, "cur_kl_coeff": 4.2433384805917735e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.526863285449023, "policy_loss": -0.0016320635428807388, "vf_loss": 0.5284953498182972, "vf_explained_var": -0.004452923871576786, "kl": 0.00287338806291837, "entropy": 0.25525600799980264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.792594447080046, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5592576093491516, "policy_loss": -0.008276600317913108, "vf_loss": 0.567082729995794, "vf_explained_var": 0.05020486519982417, "kl": 0.010701780875476909, "entropy": 1.008964492753148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -946.0, "episode_reward_mean": 132.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": 75.48, "predator_policy": 56.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 74.0, 14.0, 128.0, 200.0, 164.0, 200.0, 194.0, 200.0, 200.0, -10.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 158.0, 68.0, 200.0, -118.0, -106.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 194.0, 200.0, 200.0, 200.0, 104.0, 200.0, -196.0, 98.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 158.0, 92.0, 200.0, 200.0, 200.0, 104.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, -28.0, 200.0, -58.0, 200.0, 200.0, -190.0, 200.0, 200.0, 188.0, -184.0, 200.0, 200.0, 104.0, 200.0, 74.0, 200.0, 194.0, -946.0, 200.0, 20.0, 200.0, 200.0, 50.0, 194.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -742.0, 170.0, 92.0, 200.0, 200.0, 158.0, 200.0, 128.0, 170.0, 200.0, 92.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -31.0, -141.0, 68.0, 200.0, 134.0, 200.0, 189.0, 200.0, 200.0, -185.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 123.0, -42.0, 200.0, -383.0, -361.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 189.0, 200.0, 200.0, 200.0, 24.0, 200.0, -526.0, 13.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 123.0, 2.0, 200.0, 200.0, 200.0, 24.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, -273.0, 200.0, 200.0, -515.0, 200.0, 200.0, 178.0, -504.0, 200.0, 200.0, 24.0, 200.0, -31.0, 200.0, 189.0, -1901.0, 200.0, -130.0, 200.0, 200.0, -75.0, 189.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1527.0, 145.0, 2.0, 200.0, 200.0, 123.0, 200.0, 68.0, 145.0, 200.0, 2.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 105.0, 155.0, 60.0, 0.0, 30.0, 0.0, 5.0, 0.0, 0.0, 175.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 35.0, 110.0, 0.0, 265.0, 255.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 80.0, 0.0, 330.0, 85.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 35.0, 90.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 0.0, 215.0, 0.0, 0.0, 325.0, 0.0, 0.0, 10.0, 320.0, 0.0, 0.0, 80.0, 0.0, 105.0, 0.0, 5.0, 955.0, 0.0, 150.0, 0.0, 0.0, 125.0, 5.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 785.0, 25.0, 90.0, 0.0, 0.0, 35.0, 0.0, 60.0, 25.0, 0.0, 90.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32923186727047765, "mean_inference_ms": 1.2969199006686014, "mean_action_processing_ms": 0.1338266687460961, "mean_env_wait_ms": 0.1047453917281753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003258824348449707, "StateBufferConnector_ms": 0.002139449119567871, "ViewRequirementAgentConnector_ms": 0.04984152317047119}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -946.0, "episode_return_mean": 132.08, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.79827314699256, "num_env_steps_trained_throughput_per_sec": 171.79827314699256, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 22971.2, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22970.745, "sample_time_ms": 824.587, "learn_time_ms": 22123.302, "learn_throughput": 180.805, "synch_weights_time_ms": 20.567}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "training_iteration": 91, "trial_id": "25fa0_00000", "date": "2024-08-12_14-07-30", "timestamp": 1723486050, "time_this_iter_s": 23.32283592224121, "time_total_s": 2388.000230550766, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a229bee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2388.000230550766, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 25.314705882352943, "ram_util_percent": 83.13235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9788449126528576, "cur_kl_coeff": 2.1216692402958867e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7009457111358643, "policy_loss": -0.0031419971070135943, "vf_loss": 2.704087713050346, "vf_explained_var": 0.0015588949744900068, "kl": 0.006210848318426873, "entropy": 0.2516191594923536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.209484467158715, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.802272190277775, "policy_loss": -0.009709436101547907, "vf_loss": 2.811593406647444, "vf_explained_var": 0.015550147804121176, "kl": 0.00920216307398598, "entropy": 0.9614042249818643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -976.0, "episode_reward_mean": 95.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": 8.71, "predator_policy": 86.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [158.0, 68.0, 200.0, -118.0, -106.0, 200.0, 200.0, 200.0, 200.0, 188.0, 200.0, 194.0, 200.0, 200.0, 200.0, 104.0, 200.0, -196.0, 98.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 158.0, 92.0, 200.0, 200.0, 200.0, 104.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, -28.0, 200.0, -58.0, 200.0, 200.0, -190.0, 200.0, 200.0, 188.0, -184.0, 200.0, 200.0, 104.0, 200.0, 74.0, 200.0, 194.0, -946.0, 200.0, 20.0, 200.0, 200.0, 50.0, 194.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -742.0, 170.0, 92.0, 200.0, 200.0, 158.0, 200.0, 128.0, 170.0, 200.0, 92.0, 200.0, 200.0, 128.0, 158.0, -928.0, 200.0, 200.0, 200.0, 200.0, -976.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -766.0, -256.0, -262.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.0, -42.0, 200.0, -383.0, -361.0, 200.0, 200.0, 200.0, 200.0, 178.0, 200.0, 189.0, 200.0, 200.0, 200.0, 24.0, 200.0, -526.0, 13.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 123.0, 2.0, 200.0, 200.0, 200.0, 24.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, -273.0, 200.0, 200.0, -515.0, 200.0, 200.0, 178.0, -504.0, 200.0, 200.0, 24.0, 200.0, -31.0, 200.0, 189.0, -1901.0, 200.0, -130.0, 200.0, 200.0, -75.0, 189.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1527.0, 145.0, 2.0, 200.0, 200.0, 123.0, 200.0, 68.0, 145.0, 200.0, 2.0, 200.0, 200.0, 68.0, 123.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1956.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1571.0, -636.0, -647.0], "policy_predator_policy_reward": [35.0, 110.0, 0.0, 265.0, 255.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 80.0, 0.0, 330.0, 85.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 35.0, 90.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 0.0, 215.0, 0.0, 0.0, 325.0, 0.0, 0.0, 10.0, 320.0, 0.0, 0.0, 80.0, 0.0, 105.0, 0.0, 5.0, 955.0, 0.0, 150.0, 0.0, 0.0, 125.0, 5.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 785.0, 25.0, 90.0, 0.0, 0.0, 35.0, 0.0, 60.0, 25.0, 0.0, 90.0, 0.0, 0.0, 60.0, 35.0, 940.0, 0.0, 0.0, 0.0, 0.0, 980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 805.0, 380.0, 385.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.328461058621193, "mean_inference_ms": 1.2936231768232809, "mean_action_processing_ms": 0.13358709242871566, "mean_env_wait_ms": 0.10459106896540528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003748655319213867, "StateBufferConnector_ms": 0.002081751823425293, "ViewRequirementAgentConnector_ms": 0.04940998554229736}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -976.0, "episode_return_mean": 95.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.09229154232676, "num_env_steps_trained_throughput_per_sec": 167.09229154232676, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 23029.803, "restore_workers_time_ms": 0.018, "training_step_time_ms": 23029.546, "sample_time_ms": 818.148, "learn_time_ms": 22190.355, "learn_throughput": 180.258, "synch_weights_time_ms": 18.416}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 92, "trial_id": "25fa0_00000", "date": "2024-08-12_14-07-54", "timestamp": 1723486074, "time_this_iter_s": 23.975375175476074, "time_total_s": 2411.975605726242, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2411.975605726242, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 26.5264705882353, "ram_util_percent": 82.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4977553555586687, "cur_kl_coeff": 2.1216692402958867e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7110282514244317, "policy_loss": -0.0007130415392263482, "vf_loss": 1.7117412926629185, "vf_explained_var": 0.0014906962091724078, "kl": 0.0022365152361190264, "entropy": 0.23624971811659634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.811247884047528, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8372425216560562, "policy_loss": -0.00805312030618855, "vf_loss": 1.8449217470362782, "vf_explained_var": 0.007963920508821805, "kl": 0.008862702279695137, "entropy": 1.0541306287671128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -976.0, "episode_reward_mean": 89.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -2.95, "predator_policy": 92.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 158.0, 92.0, 200.0, 200.0, 200.0, 104.0, 200.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, -28.0, 200.0, -58.0, 200.0, 200.0, -190.0, 200.0, 200.0, 188.0, -184.0, 200.0, 200.0, 104.0, 200.0, 74.0, 200.0, 194.0, -946.0, 200.0, 20.0, 200.0, 200.0, 50.0, 194.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -742.0, 170.0, 92.0, 200.0, 200.0, 158.0, 200.0, 128.0, 170.0, 200.0, 92.0, 200.0, 200.0, 128.0, 158.0, -928.0, 200.0, 200.0, 200.0, 200.0, -976.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -766.0, -256.0, -262.0, 194.0, 200.0, 200.0, -226.0, 200.0, 146.0, 200.0, 194.0, -670.0, 164.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, -100.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 123.0, 2.0, 200.0, 200.0, 200.0, 24.0, 200.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, -273.0, 200.0, 200.0, -515.0, 200.0, 200.0, 178.0, -504.0, 200.0, 200.0, 24.0, 200.0, -31.0, 200.0, 189.0, -1901.0, 200.0, -130.0, 200.0, 200.0, -75.0, 189.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1527.0, 145.0, 2.0, 200.0, 200.0, 123.0, 200.0, 68.0, 145.0, 200.0, 2.0, 200.0, 200.0, 68.0, 123.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1956.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1571.0, -636.0, -647.0, 189.0, 200.0, 200.0, -581.0, 200.0, 101.0, 200.0, 189.0, -1395.0, 134.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -350.0, -119.0], "policy_predator_policy_reward": [85.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 35.0, 90.0, 0.0, 0.0, 0.0, 80.0, 0.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 190.0, 0.0, 215.0, 0.0, 0.0, 325.0, 0.0, 0.0, 10.0, 320.0, 0.0, 0.0, 80.0, 0.0, 105.0, 0.0, 5.0, 955.0, 0.0, 150.0, 0.0, 0.0, 125.0, 5.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 785.0, 25.0, 90.0, 0.0, 0.0, 35.0, 0.0, 60.0, 25.0, 0.0, 90.0, 0.0, 0.0, 60.0, 35.0, 940.0, 0.0, 0.0, 0.0, 0.0, 980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 805.0, 380.0, 385.0, 5.0, 0.0, 0.0, 355.0, 0.0, 45.0, 0.0, 5.0, 725.0, 30.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 250.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32826201498416496, "mean_inference_ms": 1.2923260633733848, "mean_action_processing_ms": 0.13350362311213035, "mean_env_wait_ms": 0.10450383474946584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004396796226501465, "StateBufferConnector_ms": 0.00219881534576416, "ViewRequirementAgentConnector_ms": 0.050522446632385254}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -976.0, "episode_return_mean": 89.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.44219066806997, "num_env_steps_trained_throughput_per_sec": 145.44219066806997, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 23506.792, "restore_workers_time_ms": 0.018, "training_step_time_ms": 23506.535, "sample_time_ms": 825.595, "learn_time_ms": 22659.472, "learn_throughput": 176.527, "synch_weights_time_ms": 18.795}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 93, "trial_id": "25fa0_00000", "date": "2024-08-12_14-08-22", "timestamp": 1723486102, "time_this_iter_s": 27.54463219642639, "time_total_s": 2439.5202379226685, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a4841700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2439.5202379226685, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 41.21025641025641, "ram_util_percent": 82.47435897435896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.895876670240735, "cur_kl_coeff": 1.0608346201479434e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3525347346439958, "policy_loss": 0.001107582959230058, "vf_loss": 1.3514271488723655, "vf_explained_var": -0.00048149172216653823, "kl": 0.001599544906558409, "entropy": 0.21321740277732412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.1810196014121175, "cur_kl_coeff": 0.04218750000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3479814803771053, "policy_loss": -0.02689065717422636, "vf_loss": 1.373984585205714, "vf_explained_var": 0.003934552768866221, "kl": 0.021038278811783034, "entropy": 1.0778714211036762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -976.0, "episode_reward_mean": 79.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -20.33, "predator_policy": 100.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -58.0, 200.0, 200.0, -190.0, 200.0, 200.0, 188.0, -184.0, 200.0, 200.0, 104.0, 200.0, 74.0, 200.0, 194.0, -946.0, 200.0, 20.0, 200.0, 200.0, 50.0, 194.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -742.0, 170.0, 92.0, 200.0, 200.0, 158.0, 200.0, 128.0, 170.0, 200.0, 92.0, 200.0, 200.0, 128.0, 158.0, -928.0, 200.0, 200.0, 200.0, 200.0, -976.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -766.0, -256.0, -262.0, 194.0, 200.0, 200.0, -226.0, 200.0, 146.0, 200.0, 194.0, -670.0, 164.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, -100.0, 26.0, 200.0, 200.0, 56.0, 134.0, 200.0, 200.0, 200.0, 152.0, -724.0, 200.0, 134.0, 158.0, -46.0, 146.0, 200.0, 200.0, 200.0, 194.0, 200.0, 200.0, 176.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -273.0, 200.0, 200.0, -515.0, 200.0, 200.0, 178.0, -504.0, 200.0, 200.0, 24.0, 200.0, -31.0, 200.0, 189.0, -1901.0, 200.0, -130.0, 200.0, 200.0, -75.0, 189.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1527.0, 145.0, 2.0, 200.0, 200.0, 123.0, 200.0, 68.0, 145.0, 200.0, 2.0, 200.0, 200.0, 68.0, 123.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1956.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1571.0, -636.0, -647.0, 189.0, 200.0, 200.0, -581.0, 200.0, 101.0, 200.0, 189.0, -1395.0, 134.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -350.0, -119.0, 200.0, 200.0, -64.0, 79.0, 200.0, 200.0, 200.0, 112.0, -1494.0, 200.0, 79.0, 123.0, -251.0, 101.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 156.0, 200.0], "policy_predator_policy_reward": [0.0, 215.0, 0.0, 0.0, 325.0, 0.0, 0.0, 10.0, 320.0, 0.0, 0.0, 80.0, 0.0, 105.0, 0.0, 5.0, 955.0, 0.0, 150.0, 0.0, 0.0, 125.0, 5.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 785.0, 25.0, 90.0, 0.0, 0.0, 35.0, 0.0, 60.0, 25.0, 0.0, 90.0, 0.0, 0.0, 60.0, 35.0, 940.0, 0.0, 0.0, 0.0, 0.0, 980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 805.0, 380.0, 385.0, 5.0, 0.0, 0.0, 355.0, 0.0, 45.0, 0.0, 5.0, 725.0, 30.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 250.0, 145.0, 0.0, 0.0, 120.0, 55.0, 0.0, 0.0, 0.0, 40.0, 770.0, 0.0, 55.0, 35.0, 205.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3281280736827843, "mean_inference_ms": 1.2910275611725348, "mean_action_processing_ms": 0.133410635841201, "mean_env_wait_ms": 0.10441835736109009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051964521408081055, "StateBufferConnector_ms": 0.0022220611572265625, "ViewRequirementAgentConnector_ms": 0.051465511322021484}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -976.0, "episode_return_mean": 79.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.92067331239502, "num_env_steps_trained_throughput_per_sec": 164.92067331239502, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 23616.95, "restore_workers_time_ms": 0.018, "training_step_time_ms": 23616.626, "sample_time_ms": 828.816, "learn_time_ms": 22764.603, "learn_throughput": 175.711, "synch_weights_time_ms": 19.742}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 94, "trial_id": "25fa0_00000", "date": "2024-08-12_14-08-46", "timestamp": 1723486126, "time_this_iter_s": 24.297559022903442, "time_total_s": 2463.817796945572, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a48a9ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2463.817796945572, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 27.07058823529412, "ram_util_percent": 82.96764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5908492669385548, "cur_kl_coeff": 5.304173100739717e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8926506120711566, "policy_loss": -0.002999304714467144, "vf_loss": 2.895649915933609, "vf_explained_var": -0.00020175222307443618, "kl": 0.004324654719940561, "entropy": 0.1675537126371637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.049979592859745, "cur_kl_coeff": 0.06328124999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8868086541692417, "policy_loss": -0.006802454183343798, "vf_loss": 2.893296237041553, "vf_explained_var": 0.02051178670177857, "kl": 0.004975801198146852, "entropy": 0.9240992153684299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 84.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -11.31, "predator_policy": 96.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.0, 200.0, 200.0, 50.0, 194.0, 134.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -742.0, 170.0, 92.0, 200.0, 200.0, 158.0, 200.0, 128.0, 170.0, 200.0, 92.0, 200.0, 200.0, 128.0, 158.0, -928.0, 200.0, 200.0, 200.0, 200.0, -976.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -766.0, -256.0, -262.0, 194.0, 200.0, 200.0, -226.0, 200.0, 146.0, 200.0, 194.0, -670.0, 164.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, -100.0, 26.0, 200.0, 200.0, 56.0, 134.0, 200.0, 200.0, 200.0, 152.0, -724.0, 200.0, 134.0, 158.0, -46.0, 146.0, 200.0, 200.0, 200.0, 194.0, 200.0, 200.0, 176.0, 200.0, 98.0, -1000.0, -172.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 98.0, 200.0, 158.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, 200.0, 200.0, -75.0, 189.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1527.0, 145.0, 2.0, 200.0, 200.0, 123.0, 200.0, 68.0, 145.0, 200.0, 2.0, 200.0, 200.0, 68.0, 123.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1956.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1571.0, -636.0, -647.0, 189.0, 200.0, 200.0, -581.0, 200.0, 101.0, 200.0, 189.0, -1395.0, 134.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -350.0, -119.0, 200.0, 200.0, -64.0, 79.0, 200.0, 200.0, 200.0, 112.0, -1494.0, 200.0, 79.0, 123.0, -251.0, 101.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 156.0, 200.0, 13.0, -2000.0, -482.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 13.0, 200.0, 123.0, 200.0, 200.0], "policy_predator_policy_reward": [150.0, 0.0, 0.0, 125.0, 5.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 785.0, 25.0, 90.0, 0.0, 0.0, 35.0, 0.0, 60.0, 25.0, 0.0, 90.0, 0.0, 0.0, 60.0, 35.0, 940.0, 0.0, 0.0, 0.0, 0.0, 980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 805.0, 380.0, 385.0, 5.0, 0.0, 0.0, 355.0, 0.0, 45.0, 0.0, 5.0, 725.0, 30.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 250.0, 145.0, 0.0, 0.0, 120.0, 55.0, 0.0, 0.0, 0.0, 40.0, 770.0, 0.0, 55.0, 35.0, 205.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 20.0, 0.0, 85.0, 1000.0, 310.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 85.0, 0.0, 35.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32812444681822556, "mean_inference_ms": 1.2905701245361538, "mean_action_processing_ms": 0.13340010765414972, "mean_env_wait_ms": 0.1044080604242777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005994677543640137, "StateBufferConnector_ms": 0.0022159814834594727, "ViewRequirementAgentConnector_ms": 0.0523456335067749}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 84.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.4765599648054, "num_env_steps_trained_throughput_per_sec": 156.4765599648054, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 23895.746, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23895.344, "sample_time_ms": 847.851, "learn_time_ms": 23024.608, "learn_throughput": 173.727, "synch_weights_time_ms": 19.414}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 95, "trial_id": "25fa0_00000", "date": "2024-08-12_14-09-12", "timestamp": 1723486152, "time_this_iter_s": 25.587460041046143, "time_total_s": 2489.405256986618, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2383a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2489.405256986618, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.98108108108108, "ram_util_percent": 82.54324324324327}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4651352144777775, "cur_kl_coeff": 2.6520865503698584e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1125488375003139, "policy_loss": -6.760529164845745e-05, "vf_loss": 1.1126164432401613, "vf_explained_var": 0.0023949105913440385, "kl": 0.0033827355909343076, "entropy": 0.17662786638053754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.609813362142692, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.11327004932488, "policy_loss": -0.013898077280706881, "vf_loss": 1.1268079303881677, "vf_explained_var": 0.017115077873071035, "kl": 0.011383970843422731, "entropy": 0.9863504826401671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 67.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -42.55, "predator_policy": 110.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 200.0, 128.0, 158.0, -928.0, 200.0, 200.0, 200.0, 200.0, -976.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -766.0, -256.0, -262.0, 194.0, 200.0, 200.0, -226.0, 200.0, 146.0, 200.0, 194.0, -670.0, 164.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, -100.0, 26.0, 200.0, 200.0, 56.0, 134.0, 200.0, 200.0, 200.0, 152.0, -724.0, 200.0, 134.0, 158.0, -46.0, 146.0, 200.0, 200.0, 200.0, 194.0, 200.0, 200.0, 176.0, 200.0, 98.0, -1000.0, -172.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 98.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -382.0, 200.0, 200.0, -718.0, 170.0, 200.0, 200.0, -112.0, 176.0, -124.0, 170.0, 194.0, -904.0, 200.0, 200.0, 140.0, 200.0, 152.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 68.0, 123.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1956.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1571.0, -636.0, -647.0, 189.0, 200.0, 200.0, -581.0, 200.0, 101.0, 200.0, 189.0, -1395.0, 134.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -350.0, -119.0, 200.0, 200.0, -64.0, 79.0, 200.0, 200.0, 200.0, 112.0, -1494.0, 200.0, 79.0, 123.0, -251.0, 101.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 156.0, 200.0, 13.0, -2000.0, -482.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 13.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -867.0, 200.0, 200.0, -1483.0, 145.0, 200.0, 200.0, -372.0, 156.0, -394.0, 145.0, 189.0, -1824.0, 200.0, 200.0, 90.0, 200.0, 112.0], "policy_predator_policy_reward": [0.0, 0.0, 60.0, 35.0, 940.0, 0.0, 0.0, 0.0, 0.0, 980.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 805.0, 380.0, 385.0, 5.0, 0.0, 0.0, 355.0, 0.0, 45.0, 0.0, 5.0, 725.0, 30.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 250.0, 145.0, 0.0, 0.0, 120.0, 55.0, 0.0, 0.0, 0.0, 40.0, 770.0, 0.0, 55.0, 35.0, 205.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 20.0, 0.0, 85.0, 1000.0, 310.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 85.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 485.0, 0.0, 0.0, 765.0, 25.0, 0.0, 0.0, 260.0, 20.0, 270.0, 25.0, 5.0, 920.0, 0.0, 0.0, 50.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.328224488919584, "mean_inference_ms": 1.2905050361512735, "mean_action_processing_ms": 0.13344836589812245, "mean_env_wait_ms": 0.10445695091176282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005414128303527832, "StateBufferConnector_ms": 0.0021785497665405273, "ViewRequirementAgentConnector_ms": 0.05301070213317871}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 67.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.61433682209528, "num_env_steps_trained_throughput_per_sec": 157.61433682209528, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 24156.062, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24155.664, "sample_time_ms": 864.665, "learn_time_ms": 23267.357, "learn_throughput": 171.915, "synch_weights_time_ms": 19.982}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 96, "trial_id": "25fa0_00000", "date": "2024-08-12_14-09-37", "timestamp": 1723486177, "time_this_iter_s": 25.419209003448486, "time_total_s": 2514.8244659900665, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2379ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2514.8244659900665, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 29.59444444444445, "ram_util_percent": 82.46944444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9737614821254587, "cur_kl_coeff": 1.3260432751849292e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0997229692836603, "policy_loss": -0.0020562857898767106, "vf_loss": 1.1017792539981504, "vf_explained_var": 0.0007941835249463717, "kl": 0.003138895574250711, "entropy": 0.2023614807908113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.711904784136761, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.106785445427522, "policy_loss": -0.015128170550694146, "vf_loss": 1.1216816881671547, "vf_explained_var": 0.019951970440646012, "kl": 0.0073300829754450415, "entropy": 0.9719594406584898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 102.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 21.47, "predator_policy": 81.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-262.0, 194.0, 200.0, 200.0, -226.0, 200.0, 146.0, 200.0, 194.0, -670.0, 164.0, 200.0, 200.0, 128.0, 200.0, 200.0, 200.0, -100.0, 26.0, 200.0, 200.0, 56.0, 134.0, 200.0, 200.0, 200.0, 152.0, -724.0, 200.0, 134.0, 158.0, -46.0, 146.0, 200.0, 200.0, 200.0, 194.0, 200.0, 200.0, 176.0, 200.0, 98.0, -1000.0, -172.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 98.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -382.0, 200.0, 200.0, -718.0, 170.0, 200.0, 200.0, -112.0, 176.0, -124.0, 170.0, 194.0, -904.0, 200.0, 200.0, 140.0, 200.0, 152.0, 200.0, 200.0, 50.0, 200.0, 200.0, 200.0, 200.0, 182.0, 200.0, 50.0, 194.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-647.0, 189.0, 200.0, 200.0, -581.0, 200.0, 101.0, 200.0, 189.0, -1395.0, 134.0, 200.0, 200.0, 68.0, 200.0, 200.0, 200.0, -350.0, -119.0, 200.0, 200.0, -64.0, 79.0, 200.0, 200.0, 200.0, 112.0, -1494.0, 200.0, 79.0, 123.0, -251.0, 101.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 156.0, 200.0, 13.0, -2000.0, -482.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 13.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -867.0, 200.0, 200.0, -1483.0, 145.0, 200.0, 200.0, -372.0, 156.0, -394.0, 145.0, 189.0, -1824.0, 200.0, 200.0, 90.0, 200.0, 112.0, 200.0, 200.0, -75.0, 200.0, 200.0, 200.0, 200.0, 167.0, 200.0, -75.0, 189.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [385.0, 5.0, 0.0, 0.0, 355.0, 0.0, 45.0, 0.0, 5.0, 725.0, 30.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 250.0, 145.0, 0.0, 0.0, 120.0, 55.0, 0.0, 0.0, 0.0, 40.0, 770.0, 0.0, 55.0, 35.0, 205.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 20.0, 0.0, 85.0, 1000.0, 310.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 85.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 485.0, 0.0, 0.0, 765.0, 25.0, 0.0, 0.0, 260.0, 20.0, 270.0, 25.0, 5.0, 920.0, 0.0, 0.0, 50.0, 0.0, 40.0, 0.0, 0.0, 125.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 125.0, 5.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3283689144475435, "mean_inference_ms": 1.2907795658628987, "mean_action_processing_ms": 0.13352569272445983, "mean_env_wait_ms": 0.10449941240086925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004948258399963379, "StateBufferConnector_ms": 0.0022276639938354492, "ViewRequirementAgentConnector_ms": 0.056252360343933105}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 102.62, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 165.17802914164866, "num_env_steps_trained_throughput_per_sec": 165.17802914164866, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 776000, "timers": {"training_iteration_time_ms": 24280.42, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24279.984, "sample_time_ms": 878.906, "learn_time_ms": 23376.291, "learn_throughput": 171.114, "synch_weights_time_ms": 20.776}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 776000, "num_agent_steps_trained": 776000}, "done": false, "training_iteration": 97, "trial_id": "25fa0_00000", "date": "2024-08-12_14-10-02", "timestamp": 1723486202, "time_this_iter_s": 24.235011100769043, "time_total_s": 2539.0594770908356, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a487bc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2539.0594770908356, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 27.16176470588235, "ram_util_percent": 82.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0691838390329698, "cur_kl_coeff": 6.630216375924646e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2625893693281493, "policy_loss": -0.003670006470444302, "vf_loss": 0.26625937602060884, "vf_explained_var": 0.02415815747032563, "kl": 0.007247659961853701, "entropy": 0.1365683586569503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.448428489112606, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28384708449242074, "policy_loss": -0.009902026782704828, "vf_loss": 0.29346576520729284, "vf_explained_var": 0.059350084389249484, "kl": 0.008955121376354364, "entropy": 1.1142656399557989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 119.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 52.93, "predator_policy": 66.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [134.0, 200.0, 200.0, 200.0, 152.0, -724.0, 200.0, 134.0, 158.0, -46.0, 146.0, 200.0, 200.0, 200.0, 194.0, 200.0, 200.0, 176.0, 200.0, 98.0, -1000.0, -172.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 98.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -382.0, 200.0, 200.0, -718.0, 170.0, 200.0, 200.0, -112.0, 176.0, -124.0, 170.0, 194.0, -904.0, 200.0, 200.0, 140.0, 200.0, 152.0, 200.0, 200.0, 50.0, 200.0, 200.0, 200.0, 200.0, 182.0, 200.0, 50.0, 194.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -340.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 104.0, 2.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 200.0, 200.0, 200.0, 112.0, -1494.0, 200.0, 79.0, 123.0, -251.0, 101.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 156.0, 200.0, 13.0, -2000.0, -482.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 13.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -867.0, 200.0, 200.0, -1483.0, 145.0, 200.0, 200.0, -372.0, 156.0, -394.0, 145.0, 189.0, -1824.0, 200.0, 200.0, 90.0, 200.0, 112.0, 200.0, 200.0, -75.0, 200.0, 200.0, 200.0, 200.0, 167.0, 200.0, -75.0, 189.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -790.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 24.0, -163.0, 200.0, 200.0], "policy_predator_policy_reward": [55.0, 0.0, 0.0, 0.0, 40.0, 770.0, 0.0, 55.0, 35.0, 205.0, 45.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 20.0, 0.0, 85.0, 1000.0, 310.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 85.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 485.0, 0.0, 0.0, 765.0, 25.0, 0.0, 0.0, 260.0, 20.0, 270.0, 25.0, 5.0, 920.0, 0.0, 0.0, 50.0, 0.0, 40.0, 0.0, 0.0, 125.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 125.0, 5.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 450.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3293171890762329, "mean_inference_ms": 1.2948881617577706, "mean_action_processing_ms": 0.13397732543531052, "mean_env_wait_ms": 0.10485986567246411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004001736640930176, "StateBufferConnector_ms": 0.0020940303802490234, "ViewRequirementAgentConnector_ms": 0.052764177322387695}, "num_episodes": 22, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 119.78, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.0435928720372, "num_env_steps_trained_throughput_per_sec": 174.0435928720372, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 24322.728, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24322.289, "sample_time_ms": 889.799, "learn_time_ms": 23407.057, "learn_throughput": 170.889, "synch_weights_time_ms": 21.333}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 98, "trial_id": "25fa0_00000", "date": "2024-08-12_14-10-25", "timestamp": 1723486225, "time_this_iter_s": 23.01127815246582, "time_total_s": 2562.0707552433014, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2394ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2562.0707552433014, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 22.41818181818182, "ram_util_percent": 82.77272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9982786360080353, "cur_kl_coeff": 6.630216375924646e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7871760529155533, "policy_loss": -0.003006607622470862, "vf_loss": 0.7901826605891984, "vf_explained_var": 0.0015431846181551616, "kl": 0.0019303252415571847, "entropy": 0.10137429480673746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.295862433283279, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8002179216632309, "policy_loss": -0.007108781830659912, "vf_loss": 0.806822965255075, "vf_explained_var": 0.012935437945028145, "kl": 0.015920588894608324, "entropy": 1.1896468326449394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -1000.0, "episode_reward_mean": 131.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 74.49, "predator_policy": 57.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 98.0, -1000.0, -172.0, 200.0, 200.0, 200.0, 164.0, 200.0, 200.0, 200.0, 200.0, 128.0, 200.0, 98.0, 200.0, 158.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -382.0, 200.0, 200.0, -718.0, 170.0, 200.0, 200.0, -112.0, 176.0, -124.0, 170.0, 194.0, -904.0, 200.0, 200.0, 140.0, 200.0, 152.0, 200.0, 200.0, 50.0, 200.0, 200.0, 200.0, 200.0, 182.0, 200.0, 50.0, 194.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -340.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 104.0, 2.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 170.0, 176.0, 200.0, 68.0, 200.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 13.0, -2000.0, -482.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, 68.0, 200.0, 13.0, 200.0, 123.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -867.0, 200.0, 200.0, -1483.0, 145.0, 200.0, 200.0, -372.0, 156.0, -394.0, 145.0, 189.0, -1824.0, 200.0, 200.0, 90.0, 200.0, 112.0, 200.0, 200.0, -75.0, 200.0, 200.0, 200.0, 200.0, 167.0, 200.0, -75.0, 189.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -790.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 24.0, -163.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 145.0, 156.0, 200.0, -42.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 85.0, 1000.0, 310.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 60.0, 0.0, 85.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 485.0, 0.0, 0.0, 765.0, 25.0, 0.0, 0.0, 260.0, 20.0, 270.0, 25.0, 5.0, 920.0, 0.0, 0.0, 50.0, 0.0, 40.0, 0.0, 0.0, 125.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 125.0, 5.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 450.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 110.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32861194196586735, "mean_inference_ms": 1.291059232769852, "mean_action_processing_ms": 0.1336445365819705, "mean_env_wait_ms": 0.10450365972720504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003371119499206543, "StateBufferConnector_ms": 0.002062201499938965, "ViewRequirementAgentConnector_ms": 0.05249381065368652}, "num_episodes": 18, "episode_return_max": 200.0, "episode_return_min": -1000.0, "episode_return_mean": 131.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.03244762394112, "num_env_steps_trained_throughput_per_sec": 177.03244762394112, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 24295.267, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24294.828, "sample_time_ms": 894.724, "learn_time_ms": 23375.798, "learn_throughput": 171.117, "synch_weights_time_ms": 20.359}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 99, "trial_id": "25fa0_00000", "date": "2024-08-12_14-10-47", "timestamp": 1723486247, "time_this_iter_s": 22.599570989608765, "time_total_s": 2584.67032623291, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2383ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2584.67032623291, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 21.246875, "ram_util_percent": 81.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5967160037796323, "cur_kl_coeff": 3.315108187962323e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2793815203011034, "policy_loss": -0.00412132246492547, "vf_loss": 2.2835028333589436, "vf_explained_var": -0.0001741491879026095, "kl": 0.001979977070752512, "entropy": 0.13167282443027944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.829346261918545, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2819125849753616, "policy_loss": -0.01796075785823632, "vf_loss": 2.299462925766905, "vf_explained_var": 0.013886166984836261, "kl": 0.012971303186069842, "entropy": 1.1462700335929792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 200.0, "episode_reward_min": -904.0, "episode_reward_mean": 123.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": 59.42, "predator_policy": 63.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, -382.0, 200.0, 200.0, -718.0, 170.0, 200.0, 200.0, -112.0, 176.0, -124.0, 170.0, 194.0, -904.0, 200.0, 200.0, 140.0, 200.0, 152.0, 200.0, 200.0, 50.0, 200.0, 200.0, 200.0, 200.0, 182.0, 200.0, 50.0, 194.0, 200.0, 200.0, 200.0, 176.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -340.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 104.0, 2.0, 200.0, 200.0, 140.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 146.0, 200.0, 200.0, 200.0, 170.0, 176.0, 200.0, 68.0, 200.0, 200.0, 200.0, 80.0, 188.0, 194.0, 200.0, -52.0, 200.0, 200.0, 128.0, -550.0, 200.0, 134.0, 200.0, -610.0, 116.0, 200.0, 134.0, 116.0, -142.0, 200.0, 194.0, 122.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -867.0, 200.0, 200.0, -1483.0, 145.0, 200.0, 200.0, -372.0, 156.0, -394.0, 145.0, 189.0, -1824.0, 200.0, 200.0, 90.0, 200.0, 112.0, 200.0, 200.0, -75.0, 200.0, 200.0, 200.0, 200.0, 167.0, 200.0, -75.0, 189.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -790.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 24.0, -163.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 101.0, 200.0, 200.0, 200.0, 145.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -20.0, 178.0, 189.0, 200.0, -262.0, 200.0, 200.0, 68.0, -1175.0, 200.0, 79.0, 200.0, -1285.0, 46.0, 200.0, 79.0, 46.0, -427.0, 200.0, 189.0, 57.0, 200.0], "policy_predator_policy_reward": [0.0, 485.0, 0.0, 0.0, 765.0, 25.0, 0.0, 0.0, 260.0, 20.0, 270.0, 25.0, 5.0, 920.0, 0.0, 0.0, 50.0, 0.0, 40.0, 0.0, 0.0, 125.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 125.0, 5.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 450.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 5.0, 0.0, 210.0, 0.0, 0.0, 60.0, 625.0, 0.0, 55.0, 0.0, 675.0, 70.0, 0.0, 55.0, 70.0, 285.0, 0.0, 5.0, 65.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3289070951050413, "mean_inference_ms": 1.2917903313267016, "mean_action_processing_ms": 0.1337450390622303, "mean_env_wait_ms": 0.10445282929255738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00246274471282959, "StateBufferConnector_ms": 0.002019643783569336, "ViewRequirementAgentConnector_ms": 0.05138683319091797}, "num_episodes": 23, "episode_return_max": 200.0, "episode_return_min": -904.0, "episode_return_mean": 123.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.2896827024852, "num_env_steps_trained_throughput_per_sec": 173.2896827024852, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 24279.651, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24279.255, "sample_time_ms": 885.281, "learn_time_ms": 23369.91, "learn_throughput": 171.16, "synch_weights_time_ms": 20.479}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": true, "training_iteration": 100, "trial_id": "25fa0_00000", "date": "2024-08-12_14-11-11", "timestamp": 1723486271, "time_this_iter_s": 23.128108024597168, "time_total_s": 2607.7984342575073, "pid": 19122, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 1, "num_predators": 1, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a2383f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2607.7984342575073, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 23.860606060606056, "ram_util_percent": 81.43030303030302}}
