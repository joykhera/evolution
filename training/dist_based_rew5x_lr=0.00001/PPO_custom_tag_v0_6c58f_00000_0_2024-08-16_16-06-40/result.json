{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3461449208556029, "cur_kl_coeff": 0.2, "cur_lr": 1e-05, "total_loss": 5.329370352326247, "policy_loss": -0.0030413235814887142, "vf_loss": 5.331239723780799, "vf_explained_var": -0.0005488024502204209, "kl": 0.005859841493330115, "entropy": 1.6035651662362316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0505216771648043, "cur_kl_coeff": 0.2, "cur_lr": 1e-05, "total_loss": 7.5418739848666725, "policy_loss": -0.0018133795777059815, "vf_loss": 7.543225486442526, "vf_explained_var": 0.001547473669052124, "kl": 0.0023094062076998616, "entropy": 1.607129157661761, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 276.6099999999997, "episode_reward_min": -1.1143279527039294, "episode_reward_mean": 78.71220072018183, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -419.7547474662021, "predator_policy": 1.8620362669202302}, "policy_reward_max": {"prey_policy": 155.85175366977424, "predator_policy": 360.8985743329925}, "policy_reward_mean": {"prey_policy": -81.76904811017491, "predator_policy": 121.12514847026569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.1400000000002, -1.1143279527039294, 153.32453775299354, 45.81469178044566, 96.3700000000007, 33.96000000000019, 18.09000000000032, 31.890000000000082, 17.280000000000058, 46.65999999999989, 276.6099999999997, 108.49150813706473, 54.870000000000374, 29.429999999999975, 196.22960700746222, 81.93408927562434, 83.3595069623847, 100.48000000000022], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.05121235439764, -6.850304810165912, -419.7547474662021, -98.121926761748, 57.52029431243846, 9.491365593565137, -101.36191882157574, -218.8839296505502, -6.665177461934862, 16.08141660837142, -110.52283175099676, 15.11885539282811, 0.11796373307977111, -158.49438488955596, -208.43371122821196, -104.5851982792716, -154.4794050927641, -146.70000740987254, -184.77666733031975, -255.4815342354907, 155.85175366977424, -15.411259397272154, -102.36308249031667, -1.6800214550955062, -49.79929363116076, 38.30810638419962, -28.150088116988883, 7.284312818604144, -75.14599640909188, 88.69745971256721, 18.414566459137642, -270.5451262934118, -168.2341981242318, -205.87683133115286, 62.02176137892107, -277.2247332380041], "policy_predator_policy_reward": [61.437338998769505, 31.604178165793794, 360.8985743329925, 155.86377194225375, 37.727913612643704, 48.584964234346124, 229.6676889393723, 136.39285131319883, 8.58517746193482, 78.36858339162855, 111.94283175099665, 17.421144607171858, 1.8620362669202302, 174.60438488955495, 222.87931786698357, 122.02959164049923, 156.62353784536023, 161.83587465727635, 214.37666733031924, 272.54153423548973, 12.662801679352619, 123.50670404814535, 198.01662263779818, 14.517989444679072, 60.4200649310127, 5.941122315948311, 38.216066106184236, 12.079709192200179, 6.744419442630141, 175.93372426135767, 41.995187489527666, 292.0694616203701, 296.4415816988991, 161.02895471887066, 35.7823129134344, 279.9006589456479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7417562088349953, "mean_inference_ms": 1.9018638505265777, "mean_action_processing_ms": 0.33739354320093085, "mean_env_wait_ms": 0.26810596289321065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005982981787787544, "StateBufferConnector_ms": 0.0029702981313069663, "ViewRequirementAgentConnector_ms": 0.14586183759901258}, "num_episodes": 18, "episode_return_max": 276.6099999999997, "episode_return_min": -1.1143279527039294, "episode_return_mean": 78.71220072018183, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.9361906665667, "num_env_steps_trained_throughput_per_sec": 288.9361906665667, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13843.897, "restore_workers_time_ms": 0.017, "training_step_time_ms": 13843.847, "sample_time_ms": 1554.326, "learn_time_ms": 12273.728, "learn_throughput": 325.899, "synch_weights_time_ms": 14.74}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "6c58f_00000", "date": "2024-08-16_16-07-05", "timestamp": 1723804625, "time_this_iter_s": 13.8819580078125, "time_total_s": 13.8819580078125, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.8819580078125, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.50999999999999, "ram_util_percent": 83.065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.113507899468538, "cur_kl_coeff": 0.2, "cur_lr": 1e-05, "total_loss": 5.628689423313848, "policy_loss": -0.002256587180481465, "vf_loss": 5.630312321173451, "vf_explained_var": 0.0016369122046011465, "kl": 0.0031685469480345926, "entropy": 1.6056732937772438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8263596612309653, "cur_kl_coeff": 0.1, "cur_lr": 1e-05, "total_loss": 6.8776569752466115, "policy_loss": -0.004569842395121379, "vf_loss": 6.881475801821108, "vf_explained_var": 0.004911014106538561, "kl": 0.007510023761774539, "entropy": 1.5943424096183172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 276.6099999999997, "episode_reward_min": -4.833340454038904, "episode_reward_mean": 62.24999669511711, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -419.7547474662021, "predator_policy": 1.8620362669202302}, "policy_reward_max": {"prey_policy": 155.85175366977424, "predator_policy": 410.22600861095884}, "policy_reward_mean": {"prey_policy": -73.30392283282693, "predator_policy": 104.42892118038543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.1400000000002, -1.1143279527039294, 153.32453775299354, 45.81469178044566, 96.3700000000007, 33.96000000000019, 18.09000000000032, 31.890000000000082, 17.280000000000058, 46.65999999999989, 276.6099999999997, 108.49150813706473, 54.870000000000374, 29.429999999999975, 196.22960700746222, 81.93408927562434, 83.3595069623847, 100.48000000000022, 45.659999999999535, 37.24000000000004, 123.25000000000001, 57.11999999999988, 42.29999999999996, -4.833340454038904, -0.6211407041194787, 96.36029462718042, 56.10999999999946, 11.019999999999948, 11.79654895357591, 8.30999999999995, 42.900000000000006, 84.31790563834623, 24.499999999999986, 29.43000000000016, 4.34999999999995, 154.9699999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.05121235439764, -6.850304810165912, -419.7547474662021, -98.121926761748, 57.52029431243846, 9.491365593565137, -101.36191882157574, -218.8839296505502, -6.665177461934862, 16.08141660837142, -110.52283175099676, 15.11885539282811, 0.11796373307977111, -158.49438488955596, -208.43371122821196, -104.5851982792716, -154.4794050927641, -146.70000740987254, -184.77666733031975, -255.4815342354907, 155.85175366977424, -15.411259397272154, -102.36308249031667, -1.6800214550955062, -49.79929363116076, 38.30810638419962, -28.150088116988883, 7.284312818604144, -75.14599640909188, 88.69745971256721, 18.414566459137642, -270.5451262934118, -168.2341981242318, -205.87683133115286, 62.02176137892107, -277.2247332380041, 2.453192302515615, -108.13596413088302, -1.437427401333414, -24.129734865120806, -155.0839150568125, 47.39150532457359, -29.770882379321723, -132.52641300742678, -147.00096391849183, -8.953000598971556, -118.9765501900322, -13.452842406781025, -57.632700949934005, -58.57741520518228, 28.437188128569904, -217.95398254004124, 36.69376627323036, -23.435611494307533, -73.45257895597821, -36.25252497990608, -58.48480664225194, -30.834200798092727, 1.3357566626426418, -409.8060086109592, -53.56049062494595, -20.373480652034928, 13.250514575789847, -252.85591965320168, -26.306298408757957, -154.58279402114468, -85.63215698537178, -103.46336293870135, -104.82121479732925, 0.9639427960898481, -18.654634715875027, 61.425298868536814], "policy_predator_policy_reward": [61.437338998769505, 31.604178165793794, 360.8985743329925, 155.86377194225375, 37.727913612643704, 48.584964234346124, 229.6676889393723, 136.39285131319883, 8.58517746193482, 78.36858339162855, 111.94283175099665, 17.421144607171858, 1.8620362669202302, 174.60438488955495, 222.87931786698357, 122.02959164049923, 156.62353784536023, 161.83587465727635, 214.37666733031924, 272.54153423548973, 12.662801679352619, 123.50670404814535, 198.01662263779818, 14.517989444679072, 60.4200649310127, 5.941122315948311, 38.216066106184236, 12.079709192200179, 6.744419442630141, 175.93372426135767, 41.995187489527666, 292.0694616203701, 296.4415816988991, 161.02895471887066, 35.7823129134344, 279.9006589456479, 34.04680769748437, 117.2959641308833, 36.77742740133347, 26.029734865121103, 171.8239150568125, 59.11849467542645, 38.19709831624355, 181.22019707050467, 178.55096391849173, 19.703000598971705, 75.91031456180865, 51.6857375809664, 64.25966285208328, 51.32931259891333, 195.25689436192536, 90.62019467672722, 13.70623372676936, 29.145611494307555, 66.06413406992836, 54.660969865955565, 23.37825779399432, 77.73729859992609, 6.554243337357359, 410.22600861095884, 62.27457403593362, 54.55939724104689, 41.45018009711013, 282.47313061864736, 189.69689320330943, 15.692199226593187, 87.03215698537223, 131.49336293870138, 106.08255529991476, 2.1247167013252883, 15.200513311022139, 96.99882253631584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8560429465342564, "mean_inference_ms": 2.260468223457597, "mean_action_processing_ms": 0.37071060107787235, "mean_env_wait_ms": 0.29167674588134557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006043910980224609, "StateBufferConnector_ms": 0.003074275122748481, "ViewRequirementAgentConnector_ms": 0.20571682188245985}, "num_episodes": 18, "episode_return_max": 276.6099999999997, "episode_return_min": -4.833340454038904, "episode_return_mean": 62.24999669511711, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.96395761744884, "num_env_steps_trained_throughput_per_sec": 289.96395761744884, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13819.476, "restore_workers_time_ms": 0.212, "training_step_time_ms": 13819.017, "sample_time_ms": 2024.428, "learn_time_ms": 11777.445, "learn_throughput": 339.632, "synch_weights_time_ms": 14.41}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "6c58f_00000", "date": "2024-08-16_16-07-22", "timestamp": 1723804642, "time_this_iter_s": 13.837402105331421, "time_total_s": 27.71936011314392, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0477550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.71936011314392, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.568, "ram_util_percent": 82.772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1590166173757068, "cur_kl_coeff": 0.1, "cur_lr": 1e-05, "total_loss": 3.438504791638208, "policy_loss": -0.0035934911863434883, "vf_loss": 3.4411306126407846, "vf_explained_var": -0.0011398090256585015, "kl": 0.009676665587017675, "entropy": 1.59682660866036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9629091952212904, "cur_kl_coeff": 0.1, "cur_lr": 1e-05, "total_loss": 5.21398159297055, "policy_loss": -0.0021011629750429797, "vf_loss": 5.215851749061907, "vf_explained_var": 0.005202780356482854, "kl": 0.0023099567430706694, "entropy": 1.5754269708401312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 276.6099999999997, "episode_reward_min": -57.324046110289295, "episode_reward_mean": 58.0362326395165, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -419.7547474662021, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.85175366977424, "predator_policy": 410.22600861095884}, "policy_reward_mean": {"prey_policy": -71.28424679991701, "predator_policy": 100.30236311967525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.1400000000002, -1.1143279527039294, 153.32453775299354, 45.81469178044566, 96.3700000000007, 33.96000000000019, 18.09000000000032, 31.890000000000082, 17.280000000000058, 46.65999999999989, 276.6099999999997, 108.49150813706473, 54.870000000000374, 29.429999999999975, 196.22960700746222, 81.93408927562434, 83.3595069623847, 100.48000000000022, 45.659999999999535, 37.24000000000004, 123.25000000000001, 57.11999999999988, 42.29999999999996, -4.833340454038904, -0.6211407041194787, 96.36029462718042, 56.10999999999946, 11.019999999999948, 11.79654895357591, 8.30999999999995, 42.900000000000006, 84.31790563834623, 24.499999999999986, 29.43000000000016, 4.34999999999995, 154.9699999999999, 55.720000000000105, 79.21000000000049, 59.73025261614834, -57.324046110289295, 7.009999999999938, 75.24711128477746, 24.475985519630772, 46.85171649815505, 21.506496894221712, -24.65100270815335, 2.93999999999998, 5.2199999999999545, 130.0875669691086, 19.25790991028632, 75.71000000000102, 195.71918184085342, 165.74999999999935, 10.495508794935388], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.05121235439764, -6.850304810165912, -419.7547474662021, -98.121926761748, 57.52029431243846, 9.491365593565137, -101.36191882157574, -218.8839296505502, -6.665177461934862, 16.08141660837142, -110.52283175099676, 15.11885539282811, 0.11796373307977111, -158.49438488955596, -208.43371122821196, -104.5851982792716, -154.4794050927641, -146.70000740987254, -184.77666733031975, -255.4815342354907, 155.85175366977424, -15.411259397272154, -102.36308249031667, -1.6800214550955062, -49.79929363116076, 38.30810638419962, -28.150088116988883, 7.284312818604144, -75.14599640909188, 88.69745971256721, 18.414566459137642, -270.5451262934118, -168.2341981242318, -205.87683133115286, 62.02176137892107, -277.2247332380041, 2.453192302515615, -108.13596413088302, -1.437427401333414, -24.129734865120806, -155.0839150568125, 47.39150532457359, -29.770882379321723, -132.52641300742678, -147.00096391849183, -8.953000598971556, -118.9765501900322, -13.452842406781025, -57.632700949934005, -58.57741520518228, 28.437188128569904, -217.95398254004124, 36.69376627323036, -23.435611494307533, -73.45257895597821, -36.25252497990608, -58.48480664225194, -30.834200798092727, 1.3357566626426418, -409.8060086109592, -53.56049062494595, -20.373480652034928, 13.250514575789847, -252.85591965320168, -26.306298408757957, -154.58279402114468, -85.63215698537178, -103.46336293870135, -104.82121479732925, 0.9639427960898481, -18.654634715875027, 61.425298868536814, -4.125230042902629, -19.844124580656537, -16.685721641754846, -102.19616405289047, -21.410673809708026, -77.53006297477542, -160.14101429489386, -212.5367568807965, -129.81990281220368, -121.36819927791983, 12.047440167162652, -124.76649991078791, -146.01998526227896, -128.1637900561709, 34.04469815385206, -57.943040323286006, 2.208828883147974, -116.81894155567036, -69.81818731474578, -84.72202074216428, -139.8215248506704, -288.7761287445946, -41.38951445013883, -70.94904674675772, -208.38215517642706, -9.346091745299649, -148.935402268795, -115.56267448157327, -76.25080217171391, 58.45768461141176, 31.902991118604437, 107.98406132865212, 72.96950121821357, 13.823727469115227, -55.82703999350137, -5.104447214579862], "policy_predator_policy_reward": [61.437338998769505, 31.604178165793794, 360.8985743329925, 155.86377194225375, 37.727913612643704, 48.584964234346124, 229.6676889393723, 136.39285131319883, 8.58517746193482, 78.36858339162855, 111.94283175099665, 17.421144607171858, 1.8620362669202302, 174.60438488955495, 222.87931786698357, 122.02959164049923, 156.62353784536023, 161.83587465727635, 214.37666733031924, 272.54153423548973, 12.662801679352619, 123.50670404814535, 198.01662263779818, 14.517989444679072, 60.4200649310127, 5.941122315948311, 38.216066106184236, 12.079709192200179, 6.744419442630141, 175.93372426135767, 41.995187489527666, 292.0694616203701, 296.4415816988991, 161.02895471887066, 35.7823129134344, 279.9006589456479, 34.04680769748437, 117.2959641308833, 36.77742740133347, 26.029734865121103, 171.8239150568125, 59.11849467542645, 38.19709831624355, 181.22019707050467, 178.55096391849173, 19.703000598971705, 75.91031456180865, 51.6857375809664, 64.25966285208328, 51.32931259891333, 195.25689436192536, 90.62019467672722, 13.70623372676936, 29.145611494307555, 66.06413406992836, 54.660969865955565, 23.37825779399432, 77.73729859992609, 6.554243337357359, 410.22600861095884, 62.27457403593362, 54.55939724104689, 41.45018009711013, 282.47313061864736, 189.69689320330943, 15.692199226593187, 87.03215698537223, 131.49336293870138, 106.08255529991476, 2.1247167013252883, 15.200513311022139, 96.99882253631584, 33.01885836671927, 46.67049625683985, 89.30008406370762, 108.7918016309386, 158.67098940063258, 0.0, 309.4139320880198, 5.939792977380875, 131.32990281220233, 126.86819927792061, 91.06944618753288, 96.89672484087022, 245.19326641280267, 53.466494425278675, 20.444183811031778, 50.30587485655719, 3.7027979966489784, 132.4138115700954, 9.424044897769074, 120.46516045098859, 142.0615248506694, 289.4761287445942, 44.28506284419502, 73.27349835270181, 93.12501262559182, 254.69080126524332, 50.92629947380698, 232.82968718684782, 51.3088259129972, 42.19429164730542, 54.86700888139564, 0.9651205122030294, 2.2704987817869124, 76.68627253088472, 18.439892938191598, 52.98710306482474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8800375149524451, "mean_inference_ms": 2.3698834182742945, "mean_action_processing_ms": 0.3921138000981909, "mean_env_wait_ms": 0.3034496003251963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005985189367223669, "StateBufferConnector_ms": 0.003060808888188115, "ViewRequirementAgentConnector_ms": 0.1685533258650038}, "num_episodes": 18, "episode_return_max": 276.6099999999997, "episode_return_min": -57.324046110289295, "episode_return_mean": 58.0362326395165, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.3042599014161, "num_env_steps_trained_throughput_per_sec": 284.3042599014161, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13902.798, "restore_workers_time_ms": 0.145, "training_step_time_ms": 13902.475, "sample_time_ms": 2033.281, "learn_time_ms": 11852.673, "learn_throughput": 337.477, "synch_weights_time_ms": 14.069}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "6c58f_00000", "date": "2024-08-16_16-07-36", "timestamp": 1723804656, "time_this_iter_s": 14.12772011756897, "time_total_s": 41.84708023071289, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04da310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.84708023071289, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.61, "ram_util_percent": 82.43999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8669068759395963, "cur_kl_coeff": 0.1, "cur_lr": 1e-05, "total_loss": 5.3508458755634445, "policy_loss": -0.006470199496233984, "vf_loss": 5.355865760959645, "vf_explained_var": -0.0001331314208015563, "kl": 0.01450313271925098, "entropy": 1.5618386392240171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.64249006098225, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 6.684274823072726, "policy_loss": -0.0007459426731137292, "vf_loss": 6.6849320060992365, "vf_explained_var": -9.507196290152414e-05, "kl": 0.0017749204548995901, "entropy": 1.5924105038087835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 276.6099999999997, "episode_reward_min": -251.7179111286011, "episode_reward_mean": 45.617710280081695, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -504.7524815698776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.85175366977424, "predator_policy": 558.0437567044025}, "policy_reward_mean": {"prey_policy": -83.36846741434843, "predator_policy": 106.17732255438926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.1400000000002, -1.1143279527039294, 153.32453775299354, 45.81469178044566, 96.3700000000007, 33.96000000000019, 18.09000000000032, 31.890000000000082, 17.280000000000058, 46.65999999999989, 276.6099999999997, 108.49150813706473, 54.870000000000374, 29.429999999999975, 196.22960700746222, 81.93408927562434, 83.3595069623847, 100.48000000000022, 45.659999999999535, 37.24000000000004, 123.25000000000001, 57.11999999999988, 42.29999999999996, -4.833340454038904, -0.6211407041194787, 96.36029462718042, 56.10999999999946, 11.019999999999948, 11.79654895357591, 8.30999999999995, 42.900000000000006, 84.31790563834623, 24.499999999999986, 29.43000000000016, 4.34999999999995, 154.9699999999999, 55.720000000000105, 79.21000000000049, 59.73025261614834, -57.324046110289295, 7.009999999999938, 75.24711128477746, 24.475985519630772, 46.85171649815505, 21.506496894221712, -24.65100270815335, 2.93999999999998, 5.2199999999999545, 130.0875669691086, 19.25790991028632, 75.71000000000102, 195.71918184085342, 165.74999999999935, 10.495508794935388, 67.9718476190652, -47.536467869708616, 27.150000000000453, -40.59803173177128, 99.08709206550435, -20.245706853801238, 94.19000000000044, 5.109999999999955, 57.979999999999414, -251.7179111286011, 19.373020694743193, 5.899999999999952, 65.11236883469243, 4.079999999999961, 3.199999999999976, 16.56838498697212, -13.590727591695618, 58.48470860659156], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.05121235439764, -6.850304810165912, -419.7547474662021, -98.121926761748, 57.52029431243846, 9.491365593565137, -101.36191882157574, -218.8839296505502, -6.665177461934862, 16.08141660837142, -110.52283175099676, 15.11885539282811, 0.11796373307977111, -158.49438488955596, -208.43371122821196, -104.5851982792716, -154.4794050927641, -146.70000740987254, -184.77666733031975, -255.4815342354907, 155.85175366977424, -15.411259397272154, -102.36308249031667, -1.6800214550955062, -49.79929363116076, 38.30810638419962, -28.150088116988883, 7.284312818604144, -75.14599640909188, 88.69745971256721, 18.414566459137642, -270.5451262934118, -168.2341981242318, -205.87683133115286, 62.02176137892107, -277.2247332380041, 2.453192302515615, -108.13596413088302, -1.437427401333414, -24.129734865120806, -155.0839150568125, 47.39150532457359, -29.770882379321723, -132.52641300742678, -147.00096391849183, -8.953000598971556, -118.9765501900322, -13.452842406781025, -57.632700949934005, -58.57741520518228, 28.437188128569904, -217.95398254004124, 36.69376627323036, -23.435611494307533, -73.45257895597821, -36.25252497990608, -58.48480664225194, -30.834200798092727, 1.3357566626426418, -409.8060086109592, -53.56049062494595, -20.373480652034928, 13.250514575789847, -252.85591965320168, -26.306298408757957, -154.58279402114468, -85.63215698537178, -103.46336293870135, -104.82121479732925, 0.9639427960898481, -18.654634715875027, 61.425298868536814, -4.125230042902629, -19.844124580656537, -16.685721641754846, -102.19616405289047, -21.410673809708026, -77.53006297477542, -160.14101429489386, -212.5367568807965, -129.81990281220368, -121.36819927791983, 12.047440167162652, -124.76649991078791, -146.01998526227896, -128.1637900561709, 34.04469815385206, -57.943040323286006, 2.208828883147974, -116.81894155567036, -69.81818731474578, -84.72202074216428, -139.8215248506704, -288.7761287445946, -41.38951445013883, -70.94904674675772, -208.38215517642706, -9.346091745299649, -148.935402268795, -115.56267448157327, -76.25080217171391, 58.45768461141176, 31.902991118604437, 107.98406132865212, 72.96950121821357, 13.823727469115227, -55.82703999350137, -5.104447214579862, -32.68336411934127, -58.50465011843741, -197.06437224974349, -67.54451756926659, -47.56242081128359, -13.013606760036883, -151.41041379700735, -289.71313057417603, -38.44985770266862, 53.14084591093401, -157.30397782710673, -82.34692464327753, 17.21520378136473, -86.45761882861581, -306.2279150836634, -124.86236959089887, 11.013732366229123, -157.331834772198, -504.7524815698776, -371.43743543692386, -281.99251387930644, -17.990668431315896, -76.76558653643701, -85.99531453545907, -139.2847821126664, 22.983100126443542, -126.68360031864681, -227.21046444253344, -53.76632518803264, -82.54373463838557, -96.03817594015086, -98.59087174648305, -220.49768255571817, -58.4234900965041, 30.64481648171603, -188.90825006566217], "policy_predator_policy_reward": [61.437338998769505, 31.604178165793794, 360.8985743329925, 155.86377194225375, 37.727913612643704, 48.584964234346124, 229.6676889393723, 136.39285131319883, 8.58517746193482, 78.36858339162855, 111.94283175099665, 17.421144607171858, 1.8620362669202302, 174.60438488955495, 222.87931786698357, 122.02959164049923, 156.62353784536023, 161.83587465727635, 214.37666733031924, 272.54153423548973, 12.662801679352619, 123.50670404814535, 198.01662263779818, 14.517989444679072, 60.4200649310127, 5.941122315948311, 38.216066106184236, 12.079709192200179, 6.744419442630141, 175.93372426135767, 41.995187489527666, 292.0694616203701, 296.4415816988991, 161.02895471887066, 35.7823129134344, 279.9006589456479, 34.04680769748437, 117.2959641308833, 36.77742740133347, 26.029734865121103, 171.8239150568125, 59.11849467542645, 38.19709831624355, 181.22019707050467, 178.55096391849173, 19.703000598971705, 75.91031456180865, 51.6857375809664, 64.25966285208328, 51.32931259891333, 195.25689436192536, 90.62019467672722, 13.70623372676936, 29.145611494307555, 66.06413406992836, 54.660969865955565, 23.37825779399432, 77.73729859992609, 6.554243337357359, 410.22600861095884, 62.27457403593362, 54.55939724104689, 41.45018009711013, 282.47313061864736, 189.69689320330943, 15.692199226593187, 87.03215698537223, 131.49336293870138, 106.08255529991476, 2.1247167013252883, 15.200513311022139, 96.99882253631584, 33.01885836671927, 46.67049625683985, 89.30008406370762, 108.7918016309386, 158.67098940063258, 0.0, 309.4139320880198, 5.939792977380875, 131.32990281220233, 126.86819927792061, 91.06944618753288, 96.89672484087022, 245.19326641280267, 53.466494425278675, 20.444183811031778, 50.30587485655719, 3.7027979966489784, 132.4138115700954, 9.424044897769074, 120.46516045098859, 142.0615248506694, 289.4761287445942, 44.28506284419502, 73.27349835270181, 93.12501262559182, 254.69080126524332, 50.92629947380698, 232.82968718684782, 51.3088259129972, 42.19429164730542, 54.86700888139564, 0.9651205122030294, 2.2704987817869124, 76.68627253088472, 18.439892938191598, 52.98710306482474, 138.3438903140346, 20.81597154280815, 215.26718389287652, 1.8052380564254111, 32.09445531617917, 55.63157225514102, 112.25390572860067, 288.27160691081116, 64.93053516986186, 19.46556868737566, 189.24748424751937, 30.15771136906448, 75.42479621863531, 88.00761882861656, 309.92791508366275, 126.27236959089956, 20.576267633770843, 183.72183477219673, 66.42824917379765, 558.0437567044025, 3.3011762508903733, 316.055026754475, 73.78662072742166, 94.87428034447568, 143.84478211266497, 37.569268708249005, 130.03360031864744, 227.9404644425337, 55.36632518803232, 84.14373463838639, 100.98898353037316, 110.20844914323418, 194.80034735116777, 70.53009770935854, 12.030491782832401, 204.71765040770453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8885401123155844, "mean_inference_ms": 2.404185395302217, "mean_action_processing_ms": 0.3976462250293225, "mean_env_wait_ms": 0.30769606167660657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00607222318649292, "StateBufferConnector_ms": 0.005221532450781928, "ViewRequirementAgentConnector_ms": 0.15497969256507027}, "num_episodes": 18, "episode_return_max": 276.6099999999997, "episode_return_min": -251.7179111286011, "episode_return_mean": 45.617710280081695, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.1825442300725, "num_env_steps_trained_throughput_per_sec": 293.1825442300725, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13837.944, "restore_workers_time_ms": 0.113, "training_step_time_ms": 13837.692, "sample_time_ms": 1976.81, "learn_time_ms": 11845.262, "learn_throughput": 337.688, "synch_weights_time_ms": 13.413}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "6c58f_00000", "date": "2024-08-16_16-07-50", "timestamp": 1723804670, "time_this_iter_s": 13.694414138793945, "time_total_s": 55.541494369506836, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04da3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.541494369506836, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.65000000000001, "ram_util_percent": 82.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0062546229315183, "cur_kl_coeff": 0.1, "cur_lr": 1e-05, "total_loss": 8.04740379096339, "policy_loss": -0.001088773086851847, "vf_loss": 8.04832284791129, "vf_explained_var": -0.00026735594032933473, "kl": 0.0016970574297334696, "entropy": 1.5712593684751521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6910632806795615, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 7.9986172799710875, "policy_loss": -0.0072140182459618524, "vf_loss": 8.005574336379924, "vf_explained_var": 0.003092570973451806, "kl": 0.010278381601979667, "entropy": 1.6037446608619084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 304.8149237106149, "episode_reward_min": -251.7179111286011, "episode_reward_mean": 53.45045503350769, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -504.7524815698776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.85175366977424, "predator_policy": 558.0437567044025}, "policy_reward_mean": {"prey_policy": -95.47811297460407, "predator_policy": 122.2033404913579}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.1400000000002, -1.1143279527039294, 153.32453775299354, 45.81469178044566, 96.3700000000007, 33.96000000000019, 18.09000000000032, 31.890000000000082, 17.280000000000058, 46.65999999999989, 276.6099999999997, 108.49150813706473, 54.870000000000374, 29.429999999999975, 196.22960700746222, 81.93408927562434, 83.3595069623847, 100.48000000000022, 45.659999999999535, 37.24000000000004, 123.25000000000001, 57.11999999999988, 42.29999999999996, -4.833340454038904, -0.6211407041194787, 96.36029462718042, 56.10999999999946, 11.019999999999948, 11.79654895357591, 8.30999999999995, 42.900000000000006, 84.31790563834623, 24.499999999999986, 29.43000000000016, 4.34999999999995, 154.9699999999999, 55.720000000000105, 79.21000000000049, 59.73025261614834, -57.324046110289295, 7.009999999999938, 75.24711128477746, 24.475985519630772, 46.85171649815505, 21.506496894221712, -24.65100270815335, 2.93999999999998, 5.2199999999999545, 130.0875669691086, 19.25790991028632, 75.71000000000102, 195.71918184085342, 165.74999999999935, 10.495508794935388, 67.9718476190652, -47.536467869708616, 27.150000000000453, -40.59803173177128, 99.08709206550435, -20.245706853801238, 94.19000000000044, 5.109999999999955, 57.979999999999414, -251.7179111286011, 19.373020694743193, 5.899999999999952, 65.11236883469243, 4.079999999999961, 3.199999999999976, 16.56838498697212, -13.590727591695618, 58.48470860659156, 45.45786111182118, 88.07609919037411, 6.8199999999999426, 6.643709557544529, 67.06893401636198, 37.97577100197404, 2.2199999999999953, 34.694578807059386, 97.42000000000037, 3.6810610053296564, -22.161715097382015, 175.86433330119868, 2.7499999999999845, 21.42679166853857, 193.2806877096416, -6.873027883281875, 176.36949355269462, 16.572889858018865, 97.10000000000052, 141.76769798286756, 113.97786373229869, 72.72117975313557, 304.8149237106149, 87.52731485281957, 3.82999999999997, 134.9734603197478, 103.12000000000066], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-43.05121235439764, -6.850304810165912, -419.7547474662021, -98.121926761748, 57.52029431243846, 9.491365593565137, -101.36191882157574, -218.8839296505502, -6.665177461934862, 16.08141660837142, -110.52283175099676, 15.11885539282811, 0.11796373307977111, -158.49438488955596, -208.43371122821196, -104.5851982792716, -154.4794050927641, -146.70000740987254, -184.77666733031975, -255.4815342354907, 155.85175366977424, -15.411259397272154, -102.36308249031667, -1.6800214550955062, -49.79929363116076, 38.30810638419962, -28.150088116988883, 7.284312818604144, -75.14599640909188, 88.69745971256721, 18.414566459137642, -270.5451262934118, -168.2341981242318, -205.87683133115286, 62.02176137892107, -277.2247332380041, 2.453192302515615, -108.13596413088302, -1.437427401333414, -24.129734865120806, -155.0839150568125, 47.39150532457359, -29.770882379321723, -132.52641300742678, -147.00096391849183, -8.953000598971556, -118.9765501900322, -13.452842406781025, -57.632700949934005, -58.57741520518228, 28.437188128569904, -217.95398254004124, 36.69376627323036, -23.435611494307533, -73.45257895597821, -36.25252497990608, -58.48480664225194, -30.834200798092727, 1.3357566626426418, -409.8060086109592, -53.56049062494595, -20.373480652034928, 13.250514575789847, -252.85591965320168, -26.306298408757957, -154.58279402114468, -85.63215698537178, -103.46336293870135, -104.82121479732925, 0.9639427960898481, -18.654634715875027, 61.425298868536814, -4.125230042902629, -19.844124580656537, -16.685721641754846, -102.19616405289047, -21.410673809708026, -77.53006297477542, -160.14101429489386, -212.5367568807965, -129.81990281220368, -121.36819927791983, 12.047440167162652, -124.76649991078791, -146.01998526227896, -128.1637900561709, 34.04469815385206, -57.943040323286006, 2.208828883147974, -116.81894155567036, -69.81818731474578, -84.72202074216428, -139.8215248506704, -288.7761287445946, -41.38951445013883, -70.94904674675772, -208.38215517642706, -9.346091745299649, -148.935402268795, -115.56267448157327, -76.25080217171391, 58.45768461141176, 31.902991118604437, 107.98406132865212, 72.96950121821357, 13.823727469115227, -55.82703999350137, -5.104447214579862, -32.68336411934127, -58.50465011843741, -197.06437224974349, -67.54451756926659, -47.56242081128359, -13.013606760036883, -151.41041379700735, -289.71313057417603, -38.44985770266862, 53.14084591093401, -157.30397782710673, -82.34692464327753, 17.21520378136473, -86.45761882861581, -306.2279150836634, -124.86236959089887, 11.013732366229123, -157.331834772198, -504.7524815698776, -371.43743543692386, -281.99251387930644, -17.990668431315896, -76.76558653643701, -85.99531453545907, -139.2847821126664, 22.983100126443542, -126.68360031864681, -227.21046444253344, -53.76632518803264, -82.54373463838557, -96.03817594015086, -98.59087174648305, -220.49768255571817, -58.4234900965041, 30.64481648171603, -188.90825006566217, 2.0000000000000013, -139.88569830996386, -182.35336161571385, 26.993074082479502, -214.92940819473645, -16.13412787725633, -111.88024500494204, -213.69289617767092, -196.7166537245949, -59.826630385098184, -182.42341521491508, -51.4281130660157, -2.723987780436338, -415.32569690294287, -194.12682300841303, -55.77982108207027, -63.26963431879167, 75.20148043101254, -440.62718866710685, -186.43793442240315, -163.22295774821592, -115.20130176676817, 35.035170190241516, -307.5305041495133, -176.03567538151918, -43.849842935713, -110.4637937820399, -416.182477100657, -472.4381668221672, 45.76036634484953, -117.43367433247914, -80.75788629354054, 49.586421063519666, -29.654313050323417, -98.84039448227303, -118.97895146947835, 14.338037208188418, -68.36953983392563, -77.03154753045465, -472.2058858540172, -251.87420884881388, -63.64680485347029, -161.71579340040034, 55.45999999999977, -382.13626336665976, 133.91570320074015, 26.438162761595287, -42.16645944633913, -160.82427159611927, -193.4530172131932, -411.50555401721306, -10.770398507901284, -159.95760056197298, 69.4734435101758], "policy_predator_policy_reward": [61.437338998769505, 31.604178165793794, 360.8985743329925, 155.86377194225375, 37.727913612643704, 48.584964234346124, 229.6676889393723, 136.39285131319883, 8.58517746193482, 78.36858339162855, 111.94283175099665, 17.421144607171858, 1.8620362669202302, 174.60438488955495, 222.87931786698357, 122.02959164049923, 156.62353784536023, 161.83587465727635, 214.37666733031924, 272.54153423548973, 12.662801679352619, 123.50670404814535, 198.01662263779818, 14.517989444679072, 60.4200649310127, 5.941122315948311, 38.216066106184236, 12.079709192200179, 6.744419442630141, 175.93372426135767, 41.995187489527666, 292.0694616203701, 296.4415816988991, 161.02895471887066, 35.7823129134344, 279.9006589456479, 34.04680769748437, 117.2959641308833, 36.77742740133347, 26.029734865121103, 171.8239150568125, 59.11849467542645, 38.19709831624355, 181.22019707050467, 178.55096391849173, 19.703000598971705, 75.91031456180865, 51.6857375809664, 64.25966285208328, 51.32931259891333, 195.25689436192536, 90.62019467672722, 13.70623372676936, 29.145611494307555, 66.06413406992836, 54.660969865955565, 23.37825779399432, 77.73729859992609, 6.554243337357359, 410.22600861095884, 62.27457403593362, 54.55939724104689, 41.45018009711013, 282.47313061864736, 189.69689320330943, 15.692199226593187, 87.03215698537223, 131.49336293870138, 106.08255529991476, 2.1247167013252883, 15.200513311022139, 96.99882253631584, 33.01885836671927, 46.67049625683985, 89.30008406370762, 108.7918016309386, 158.67098940063258, 0.0, 309.4139320880198, 5.939792977380875, 131.32990281220233, 126.86819927792061, 91.06944618753288, 96.89672484087022, 245.19326641280267, 53.466494425278675, 20.444183811031778, 50.30587485655719, 3.7027979966489784, 132.4138115700954, 9.424044897769074, 120.46516045098859, 142.0615248506694, 289.4761287445942, 44.28506284419502, 73.27349835270181, 93.12501262559182, 254.69080126524332, 50.92629947380698, 232.82968718684782, 51.3088259129972, 42.19429164730542, 54.86700888139564, 0.9651205122030294, 2.2704987817869124, 76.68627253088472, 18.439892938191598, 52.98710306482474, 138.3438903140346, 20.81597154280815, 215.26718389287652, 1.8052380564254111, 32.09445531617917, 55.63157225514102, 112.25390572860067, 288.27160691081116, 64.93053516986186, 19.46556868737566, 189.24748424751937, 30.15771136906448, 75.42479621863531, 88.00761882861656, 309.92791508366275, 126.27236959089956, 20.576267633770843, 183.72183477219673, 66.42824917379765, 558.0437567044025, 3.3011762508903733, 316.055026754475, 73.78662072742166, 94.87428034447568, 143.84478211266497, 37.569268708249005, 130.03360031864744, 227.9404644425337, 55.36632518803232, 84.14373463838639, 100.98898353037316, 110.20844914323418, 194.80034735116777, 70.53009770935854, 12.030491782832401, 204.71765040770453, 70.37814422030002, 112.96541520148517, 79.70020338530942, 163.73618333829924, 219.90940819473568, 17.974127877256567, 124.81054943393755, 207.40630130621966, 204.08519238131254, 119.52702574474243, 238.40867556321376, 33.41862371969095, 4.673987780436296, 415.5956969029426, 55.746194170633075, 228.855028726909, 80.51963431879143, 4.968519568987477, 73.67663388045253, 557.0695502143864, 169.60558217733097, 86.6569622402707, 270.25817580314487, 178.10149145732578, 177.17567538151857, 45.45984293571269, 291.9632668043032, 256.109795746932, 406.10056225013886, 213.85792593682112, 118.14424814761307, 73.17428459512516, 86.9686508550342, 69.46873468446486, 108.59603417415002, 125.79620163562015, 81.16196279181158, 69.96953983392534, 235.54353475572316, 455.4615966116171, 257.21625566978435, 172.28262176479888, 152.3771479022216, 26.599825251314783, 198.1707367519657, 354.8647471245691, 28.420749480695452, 74.8348620568681, 161.57427159611936, 196.53301721319332, 256.88559192847066, 300.36382091639155, 158.56505585083906, 35.03910120095736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8841407341231832, "mean_inference_ms": 2.390590644530938, "mean_action_processing_ms": 0.3939666399154907, "mean_env_wait_ms": 0.3063916416812344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02038310272525055, "StateBufferConnector_ms": 0.004632304413150055, "ViewRequirementAgentConnector_ms": 0.13925186311355744}, "num_episodes": 27, "episode_return_max": 304.8149237106149, "episode_return_min": -251.7179111286011, "episode_return_mean": 53.45045503350769, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.76862706713274, "num_env_steps_trained_throughput_per_sec": 303.76862706713274, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13703.94, "restore_workers_time_ms": 0.093, "training_step_time_ms": 13703.729, "sample_time_ms": 1858.551, "learn_time_ms": 11829.346, "learn_throughput": 338.142, "synch_weights_time_ms": 13.428}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "6c58f_00000", "date": "2024-08-16_16-08-03", "timestamp": 1723804683, "time_this_iter_s": 13.215492010116577, "time_total_s": 68.75698637962341, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04d6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.75698637962341, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 65.6578947368421, "ram_util_percent": 82.77894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.090308479034396, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 4.421001743134998, "policy_loss": -0.0038199964564579426, "vf_loss": 4.424484816303959, "vf_explained_var": 0.0006480946111931372, "kl": 0.0067383415612496346, "entropy": 1.5888188041707196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9417448938365967, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 7.0715340644594225, "policy_loss": -0.007530691935532977, "vf_loss": 7.078801826951365, "vf_explained_var": 0.011404749829933126, "kl": 0.010517456487487382, "entropy": 1.5961736158088402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 304.8149237106149, "episode_reward_min": -251.7179111286011, "episode_reward_mean": 52.45719350810041, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -504.7524815698776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.95014490808325, "predator_policy": 558.0437567044025}, "policy_reward_mean": {"prey_policy": -94.60634339988346, "predator_policy": 120.83494015393367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.48000000000022, 45.659999999999535, 37.24000000000004, 123.25000000000001, 57.11999999999988, 42.29999999999996, -4.833340454038904, -0.6211407041194787, 96.36029462718042, 56.10999999999946, 11.019999999999948, 11.79654895357591, 8.30999999999995, 42.900000000000006, 84.31790563834623, 24.499999999999986, 29.43000000000016, 4.34999999999995, 154.9699999999999, 55.720000000000105, 79.21000000000049, 59.73025261614834, -57.324046110289295, 7.009999999999938, 75.24711128477746, 24.475985519630772, 46.85171649815505, 21.506496894221712, -24.65100270815335, 2.93999999999998, 5.2199999999999545, 130.0875669691086, 19.25790991028632, 75.71000000000102, 195.71918184085342, 165.74999999999935, 10.495508794935388, 67.9718476190652, -47.536467869708616, 27.150000000000453, -40.59803173177128, 99.08709206550435, -20.245706853801238, 94.19000000000044, 5.109999999999955, 57.979999999999414, -251.7179111286011, 19.373020694743193, 5.899999999999952, 65.11236883469243, 4.079999999999961, 3.199999999999976, 16.56838498697212, -13.590727591695618, 58.48470860659156, 45.45786111182118, 88.07609919037411, 6.8199999999999426, 6.643709557544529, 67.06893401636198, 37.97577100197404, 2.2199999999999953, 34.694578807059386, 97.42000000000037, 3.6810610053296564, -22.161715097382015, 175.86433330119868, 2.7499999999999845, 21.42679166853857, 193.2806877096416, -6.873027883281875, 176.36949355269462, 16.572889858018865, 97.10000000000052, 141.76769798286756, 113.97786373229869, 72.72117975313557, 304.8149237106149, 87.52731485281957, 3.82999999999997, 134.9734603197478, 103.12000000000066, 50.340741541955616, 74.60079095939493, 145.52531787315132, 99.73236971245915, 74.50000000000006, 191.82999999999967, -28.269797533780793, 57.02999999999947, 56.10999999999955, 2.9699999999999775, 85.3271182512293, 18.040000000000177, 149.92999999999998, -9.958776322275423, 58.10565567858778, 151.43999999999988, 110.35221231685033, -17.141717021519028], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.02176137892107, -277.2247332380041, 2.453192302515615, -108.13596413088302, -1.437427401333414, -24.129734865120806, -155.0839150568125, 47.39150532457359, -29.770882379321723, -132.52641300742678, -147.00096391849183, -8.953000598971556, -118.9765501900322, -13.452842406781025, -57.632700949934005, -58.57741520518228, 28.437188128569904, -217.95398254004124, 36.69376627323036, -23.435611494307533, -73.45257895597821, -36.25252497990608, -58.48480664225194, -30.834200798092727, 1.3357566626426418, -409.8060086109592, -53.56049062494595, -20.373480652034928, 13.250514575789847, -252.85591965320168, -26.306298408757957, -154.58279402114468, -85.63215698537178, -103.46336293870135, -104.82121479732925, 0.9639427960898481, -18.654634715875027, 61.425298868536814, -4.125230042902629, -19.844124580656537, -16.685721641754846, -102.19616405289047, -21.410673809708026, -77.53006297477542, -160.14101429489386, -212.5367568807965, -129.81990281220368, -121.36819927791983, 12.047440167162652, -124.76649991078791, -146.01998526227896, -128.1637900561709, 34.04469815385206, -57.943040323286006, 2.208828883147974, -116.81894155567036, -69.81818731474578, -84.72202074216428, -139.8215248506704, -288.7761287445946, -41.38951445013883, -70.94904674675772, -208.38215517642706, -9.346091745299649, -148.935402268795, -115.56267448157327, -76.25080217171391, 58.45768461141176, 31.902991118604437, 107.98406132865212, 72.96950121821357, 13.823727469115227, -55.82703999350137, -5.104447214579862, -32.68336411934127, -58.50465011843741, -197.06437224974349, -67.54451756926659, -47.56242081128359, -13.013606760036883, -151.41041379700735, -289.71313057417603, -38.44985770266862, 53.14084591093401, -157.30397782710673, -82.34692464327753, 17.21520378136473, -86.45761882861581, -306.2279150836634, -124.86236959089887, 11.013732366229123, -157.331834772198, -504.7524815698776, -371.43743543692386, -281.99251387930644, -17.990668431315896, -76.76558653643701, -85.99531453545907, -139.2847821126664, 22.983100126443542, -126.68360031864681, -227.21046444253344, -53.76632518803264, -82.54373463838557, -96.03817594015086, -98.59087174648305, -220.49768255571817, -58.4234900965041, 30.64481648171603, -188.90825006566217, 2.0000000000000013, -139.88569830996386, -182.35336161571385, 26.993074082479502, -214.92940819473645, -16.13412787725633, -111.88024500494204, -213.69289617767092, -196.7166537245949, -59.826630385098184, -182.42341521491508, -51.4281130660157, -2.723987780436338, -415.32569690294287, -194.12682300841303, -55.77982108207027, -63.26963431879167, 75.20148043101254, -440.62718866710685, -186.43793442240315, -163.22295774821592, -115.20130176676817, 35.035170190241516, -307.5305041495133, -176.03567538151918, -43.849842935713, -110.4637937820399, -416.182477100657, -472.4381668221672, 45.76036634484953, -117.43367433247914, -80.75788629354054, 49.586421063519666, -29.654313050323417, -98.84039448227303, -118.97895146947835, 14.338037208188418, -68.36953983392563, -77.03154753045465, -472.2058858540172, -251.87420884881388, -63.64680485347029, -161.71579340040034, 55.45999999999977, -382.13626336665976, 133.91570320074015, 26.438162761595287, -42.16645944633913, -160.82427159611927, -193.4530172131932, -411.50555401721306, -10.770398507901284, -159.95760056197298, 69.4734435101758, -290.71955745729144, -72.7762038584756, 31.28633457028038, -111.32024704447528, -481.2129362886261, 94.1832974663418, 27.930694967762793, -16.848956370193896, -13.950227536439364, -335.46730193313346, 176.95014490808325, -65.33677984787465, -459.0339254242455, -231.37877499614928, 9.173432639929285, -32.922248032979816, 13.04908804117318, -4.092843607814771, 0.3307614746388076, -230.35169617250918, 21.71105994556136, -11.266696621686886, 8.946783477596673, -139.53315093647603, -3.013262070325821, 19.43352075679509, -172.76241674168156, -148.3230868015413, -8.579483308575158, 40.01913908198327, -100.64897596541024, 19.529584287051204, -132.44974569405963, -2.933276403942541, -70.44287503094007, -72.26424458464489], "policy_predator_policy_reward": [35.7823129134344, 279.9006589456479, 34.04680769748437, 117.2959641308833, 36.77742740133347, 26.029734865121103, 171.8239150568125, 59.11849467542645, 38.19709831624355, 181.22019707050467, 178.55096391849173, 19.703000598971705, 75.91031456180865, 51.6857375809664, 64.25966285208328, 51.32931259891333, 195.25689436192536, 90.62019467672722, 13.70623372676936, 29.145611494307555, 66.06413406992836, 54.660969865955565, 23.37825779399432, 77.73729859992609, 6.554243337357359, 410.22600861095884, 62.27457403593362, 54.55939724104689, 41.45018009711013, 282.47313061864736, 189.69689320330943, 15.692199226593187, 87.03215698537223, 131.49336293870138, 106.08255529991476, 2.1247167013252883, 15.200513311022139, 96.99882253631584, 33.01885836671927, 46.67049625683985, 89.30008406370762, 108.7918016309386, 158.67098940063258, 0.0, 309.4139320880198, 5.939792977380875, 131.32990281220233, 126.86819927792061, 91.06944618753288, 96.89672484087022, 245.19326641280267, 53.466494425278675, 20.444183811031778, 50.30587485655719, 3.7027979966489784, 132.4138115700954, 9.424044897769074, 120.46516045098859, 142.0615248506694, 289.4761287445942, 44.28506284419502, 73.27349835270181, 93.12501262559182, 254.69080126524332, 50.92629947380698, 232.82968718684782, 51.3088259129972, 42.19429164730542, 54.86700888139564, 0.9651205122030294, 2.2704987817869124, 76.68627253088472, 18.439892938191598, 52.98710306482474, 138.3438903140346, 20.81597154280815, 215.26718389287652, 1.8052380564254111, 32.09445531617917, 55.63157225514102, 112.25390572860067, 288.27160691081116, 64.93053516986186, 19.46556868737566, 189.24748424751937, 30.15771136906448, 75.42479621863531, 88.00761882861656, 309.92791508366275, 126.27236959089956, 20.576267633770843, 183.72183477219673, 66.42824917379765, 558.0437567044025, 3.3011762508903733, 316.055026754475, 73.78662072742166, 94.87428034447568, 143.84478211266497, 37.569268708249005, 130.03360031864744, 227.9404644425337, 55.36632518803232, 84.14373463838639, 100.98898353037316, 110.20844914323418, 194.80034735116777, 70.53009770935854, 12.030491782832401, 204.71765040770453, 70.37814422030002, 112.96541520148517, 79.70020338530942, 163.73618333829924, 219.90940819473568, 17.974127877256567, 124.81054943393755, 207.40630130621966, 204.08519238131254, 119.52702574474243, 238.40867556321376, 33.41862371969095, 4.673987780436296, 415.5956969029426, 55.746194170633075, 228.855028726909, 80.51963431879143, 4.968519568987477, 73.67663388045253, 557.0695502143864, 169.60558217733097, 86.6569622402707, 270.25817580314487, 178.10149145732578, 177.17567538151857, 45.45984293571269, 291.9632668043032, 256.109795746932, 406.10056225013886, 213.85792593682112, 118.14424814761307, 73.17428459512516, 86.9686508550342, 69.46873468446486, 108.59603417415002, 125.79620163562015, 81.16196279181158, 69.96953983392534, 235.54353475572316, 455.4615966116171, 257.21625566978435, 172.28262176479888, 152.3771479022216, 26.599825251314783, 198.1707367519657, 354.8647471245691, 28.420749480695452, 74.8348620568681, 161.57427159611936, 196.53301721319332, 256.88559192847066, 300.36382091639155, 158.56505585083906, 35.03910120095736, 329.71694634928747, 84.11955650843538, 110.92621477970715, 43.708488653883215, 416.6161066274913, 115.93885006794403, 59.77274312713473, 28.87788798775513, 87.78022753643951, 336.13730193313285, 13.069855091916725, 67.14677984787534, 462.91986642319586, 199.2230364634173, 44.43628070236922, 36.34253469068094, 0.0, 47.15375556664146, 34.753869189953804, 198.2370655079158, 19.531374160880816, 55.35138076647343, 7.823216522403291, 140.8031509364754, 26.583262070325937, 106.926479243205, 184.7072874877404, 126.41943973320728, 25.915943165478502, 0.7500567397013461, 139.64897596540985, 92.91041571294866, 226.68276925421117, 19.052465160640544, 90.41858838791136, 35.14681420615512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.902174793309216, "mean_inference_ms": 2.44922581707355, "mean_action_processing_ms": 0.3990257278589584, "mean_env_wait_ms": 0.3108991736349266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01981508731842041, "StateBufferConnector_ms": 0.004623532295227051, "ViewRequirementAgentConnector_ms": 0.12800157070159912}, "num_episodes": 18, "episode_return_max": 304.8149237106149, "episode_return_min": -251.7179111286011, "episode_return_mean": 52.45719350810041, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.66675162566116, "num_env_steps_trained_throughput_per_sec": 301.66675162566116, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13629.896, "restore_workers_time_ms": 0.081, "training_step_time_ms": 13629.712, "sample_time_ms": 1781.53, "learn_time_ms": 11831.194, "learn_throughput": 338.089, "synch_weights_time_ms": 14.695}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "6c58f_00000", "date": "2024-08-16_16-08-17", "timestamp": 1723804697, "time_this_iter_s": 13.3006272315979, "time_total_s": 82.05761361122131, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04d6e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.05761361122131, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 63.18947368421053, "ram_util_percent": 82.60526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0436696809987542, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 1.907233321351349, "policy_loss": -0.007415440297197728, "vf_loss": 1.9140238846420612, "vf_explained_var": 0.0018880471666023215, "kl": 0.012497477930231366, "entropy": 1.6024343559981653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.93073553353075, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 5.452133638013607, "policy_loss": -0.0028064626933040995, "vf_loss": 5.454833323362643, "vf_explained_var": 0.027029178729133, "kl": 0.004270906526887812, "entropy": 1.6035225085480502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 304.8149237106149, "episode_reward_min": -251.7179111286011, "episode_reward_mean": 61.031904933732115, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -504.7524815698776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.95014490808325, "predator_policy": 558.0437567044025}, "policy_reward_mean": {"prey_policy": -85.44312448217637, "predator_policy": 115.95907694904243}, "custom_metrics": {}, "hist_stats": {"episode_reward": [154.9699999999999, 55.720000000000105, 79.21000000000049, 59.73025261614834, -57.324046110289295, 7.009999999999938, 75.24711128477746, 24.475985519630772, 46.85171649815505, 21.506496894221712, -24.65100270815335, 2.93999999999998, 5.2199999999999545, 130.0875669691086, 19.25790991028632, 75.71000000000102, 195.71918184085342, 165.74999999999935, 10.495508794935388, 67.9718476190652, -47.536467869708616, 27.150000000000453, -40.59803173177128, 99.08709206550435, -20.245706853801238, 94.19000000000044, 5.109999999999955, 57.979999999999414, -251.7179111286011, 19.373020694743193, 5.899999999999952, 65.11236883469243, 4.079999999999961, 3.199999999999976, 16.56838498697212, -13.590727591695618, 58.48470860659156, 45.45786111182118, 88.07609919037411, 6.8199999999999426, 6.643709557544529, 67.06893401636198, 37.97577100197404, 2.2199999999999953, 34.694578807059386, 97.42000000000037, 3.6810610053296564, -22.161715097382015, 175.86433330119868, 2.7499999999999845, 21.42679166853857, 193.2806877096416, -6.873027883281875, 176.36949355269462, 16.572889858018865, 97.10000000000052, 141.76769798286756, 113.97786373229869, 72.72117975313557, 304.8149237106149, 87.52731485281957, 3.82999999999997, 134.9734603197478, 103.12000000000066, 50.340741541955616, 74.60079095939493, 145.52531787315132, 99.73236971245915, 74.50000000000006, 191.82999999999967, -28.269797533780793, 57.02999999999947, 56.10999999999955, 2.9699999999999775, 85.3271182512293, 18.040000000000177, 149.92999999999998, -9.958776322275423, 58.10565567858778, 151.43999999999988, 110.35221231685033, -17.141717021519028, 167.75269971722116, 17.359955990125815, 85.94000000000072, 8.259999999999943, 95.88000000000099, 3.7699999999999636, 21.380000000000454, 4.8799999999999395, 207.4899999999995, 222.7128335946887, 44.53000000000018, 7.179999999999996, 152.10999999999945, 98.12681650740713, 32.931286963420234, 85.5365168314968, 162.46130101975533, 208.8599999999983], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.654634715875027, 61.425298868536814, -4.125230042902629, -19.844124580656537, -16.685721641754846, -102.19616405289047, -21.410673809708026, -77.53006297477542, -160.14101429489386, -212.5367568807965, -129.81990281220368, -121.36819927791983, 12.047440167162652, -124.76649991078791, -146.01998526227896, -128.1637900561709, 34.04469815385206, -57.943040323286006, 2.208828883147974, -116.81894155567036, -69.81818731474578, -84.72202074216428, -139.8215248506704, -288.7761287445946, -41.38951445013883, -70.94904674675772, -208.38215517642706, -9.346091745299649, -148.935402268795, -115.56267448157327, -76.25080217171391, 58.45768461141176, 31.902991118604437, 107.98406132865212, 72.96950121821357, 13.823727469115227, -55.82703999350137, -5.104447214579862, -32.68336411934127, -58.50465011843741, -197.06437224974349, -67.54451756926659, -47.56242081128359, -13.013606760036883, -151.41041379700735, -289.71313057417603, -38.44985770266862, 53.14084591093401, -157.30397782710673, -82.34692464327753, 17.21520378136473, -86.45761882861581, -306.2279150836634, -124.86236959089887, 11.013732366229123, -157.331834772198, -504.7524815698776, -371.43743543692386, -281.99251387930644, -17.990668431315896, -76.76558653643701, -85.99531453545907, -139.2847821126664, 22.983100126443542, -126.68360031864681, -227.21046444253344, -53.76632518803264, -82.54373463838557, -96.03817594015086, -98.59087174648305, -220.49768255571817, -58.4234900965041, 30.64481648171603, -188.90825006566217, 2.0000000000000013, -139.88569830996386, -182.35336161571385, 26.993074082479502, -214.92940819473645, -16.13412787725633, -111.88024500494204, -213.69289617767092, -196.7166537245949, -59.826630385098184, -182.42341521491508, -51.4281130660157, -2.723987780436338, -415.32569690294287, -194.12682300841303, -55.77982108207027, -63.26963431879167, 75.20148043101254, -440.62718866710685, -186.43793442240315, -163.22295774821592, -115.20130176676817, 35.035170190241516, -307.5305041495133, -176.03567538151918, -43.849842935713, -110.4637937820399, -416.182477100657, -472.4381668221672, 45.76036634484953, -117.43367433247914, -80.75788629354054, 49.586421063519666, -29.654313050323417, -98.84039448227303, -118.97895146947835, 14.338037208188418, -68.36953983392563, -77.03154753045465, -472.2058858540172, -251.87420884881388, -63.64680485347029, -161.71579340040034, 55.45999999999977, -382.13626336665976, 133.91570320074015, 26.438162761595287, -42.16645944633913, -160.82427159611927, -193.4530172131932, -411.50555401721306, -10.770398507901284, -159.95760056197298, 69.4734435101758, -290.71955745729144, -72.7762038584756, 31.28633457028038, -111.32024704447528, -481.2129362886261, 94.1832974663418, 27.930694967762793, -16.848956370193896, -13.950227536439364, -335.46730193313346, 176.95014490808325, -65.33677984787465, -459.0339254242455, -231.37877499614928, 9.173432639929285, -32.922248032979816, 13.04908804117318, -4.092843607814771, 0.3307614746388076, -230.35169617250918, 21.71105994556136, -11.266696621686886, 8.946783477596673, -139.53315093647603, -3.013262070325821, 19.43352075679509, -172.76241674168156, -148.3230868015413, -8.579483308575158, 40.01913908198327, -100.64897596541024, 19.529584287051204, -132.44974569405963, -2.933276403942541, -70.44287503094007, -72.26424458464489, 121.13822631978756, -25.885672887102416, -134.51177509278685, -17.53065994748344, 69.73739478473402, -8.223218571783969, -185.72068056456078, -4.951847808349871, -2.968414127761207, 56.803821052117186, -20.3795667714451, -5.330902551057566, -65.66088089933315, -11.76235108886918, -10.9759785855342, -0.7911904075196234, -29.99901917748592, 133.98364027493753, 74.34626798908226, 108.39377399573362, -170.29422256082856, -24.754350364205578, -257.4467232016582, -50.59324465598916, 83.20891868228445, -22.249953668127468, -22.308824478782896, -15.788365180897188, 1.7907277224952283, -120.12387276320813, -200.94858634592677, -75.27974959027817, -67.00870663876637, -56.52449244329197, 66.47332369381574, 132.6105913904767], "policy_predator_policy_reward": [15.200513311022139, 96.99882253631584, 33.01885836671927, 46.67049625683985, 89.30008406370762, 108.7918016309386, 158.67098940063258, 0.0, 309.4139320880198, 5.939792977380875, 131.32990281220233, 126.86819927792061, 91.06944618753288, 96.89672484087022, 245.19326641280267, 53.466494425278675, 20.444183811031778, 50.30587485655719, 3.7027979966489784, 132.4138115700954, 9.424044897769074, 120.46516045098859, 142.0615248506694, 289.4761287445942, 44.28506284419502, 73.27349835270181, 93.12501262559182, 254.69080126524332, 50.92629947380698, 232.82968718684782, 51.3088259129972, 42.19429164730542, 54.86700888139564, 0.9651205122030294, 2.2704987817869124, 76.68627253088472, 18.439892938191598, 52.98710306482474, 138.3438903140346, 20.81597154280815, 215.26718389287652, 1.8052380564254111, 32.09445531617917, 55.63157225514102, 112.25390572860067, 288.27160691081116, 64.93053516986186, 19.46556868737566, 189.24748424751937, 30.15771136906448, 75.42479621863531, 88.00761882861656, 309.92791508366275, 126.27236959089956, 20.576267633770843, 183.72183477219673, 66.42824917379765, 558.0437567044025, 3.3011762508903733, 316.055026754475, 73.78662072742166, 94.87428034447568, 143.84478211266497, 37.569268708249005, 130.03360031864744, 227.9404644425337, 55.36632518803232, 84.14373463838639, 100.98898353037316, 110.20844914323418, 194.80034735116777, 70.53009770935854, 12.030491782832401, 204.71765040770453, 70.37814422030002, 112.96541520148517, 79.70020338530942, 163.73618333829924, 219.90940819473568, 17.974127877256567, 124.81054943393755, 207.40630130621966, 204.08519238131254, 119.52702574474243, 238.40867556321376, 33.41862371969095, 4.673987780436296, 415.5956969029426, 55.746194170633075, 228.855028726909, 80.51963431879143, 4.968519568987477, 73.67663388045253, 557.0695502143864, 169.60558217733097, 86.6569622402707, 270.25817580314487, 178.10149145732578, 177.17567538151857, 45.45984293571269, 291.9632668043032, 256.109795746932, 406.10056225013886, 213.85792593682112, 118.14424814761307, 73.17428459512516, 86.9686508550342, 69.46873468446486, 108.59603417415002, 125.79620163562015, 81.16196279181158, 69.96953983392534, 235.54353475572316, 455.4615966116171, 257.21625566978435, 172.28262176479888, 152.3771479022216, 26.599825251314783, 198.1707367519657, 354.8647471245691, 28.420749480695452, 74.8348620568681, 161.57427159611936, 196.53301721319332, 256.88559192847066, 300.36382091639155, 158.56505585083906, 35.03910120095736, 329.71694634928747, 84.11955650843538, 110.92621477970715, 43.708488653883215, 416.6161066274913, 115.93885006794403, 59.77274312713473, 28.87788798775513, 87.78022753643951, 336.13730193313285, 13.069855091916725, 67.14677984787534, 462.91986642319586, 199.2230364634173, 44.43628070236922, 36.34253469068094, 0.0, 47.15375556664146, 34.753869189953804, 198.2370655079158, 19.531374160880816, 55.35138076647343, 7.823216522403291, 140.8031509364754, 26.583262070325937, 106.926479243205, 184.7072874877404, 126.41943973320728, 25.915943165478502, 0.7500567397013461, 139.64897596540985, 92.91041571294866, 226.68276925421117, 19.052465160640544, 90.41858838791136, 35.14681420615512, 9.29555150268148, 63.20459478185467, 24.941626639447446, 144.46076439094773, 14.30260521526618, 10.123218571783928, 150.2487930408933, 48.68373533201607, 4.90841412776117, 37.13617894788264, 23.033699481936836, 6.446769840565956, 85.14088089933391, 13.662351088869139, 13.87597858553416, 2.771190407519608, 103.5053789025485, 0.0, 2.499588247007334, 37.47320336286561, 196.3042225608277, 43.274350364205816, 258.1067232016579, 57.11324465598888, 10.265012818092215, 80.88602216775162, 73.29322747234889, 62.93077869473767, 10.729995397567684, 140.53443660656524, 348.59065185893485, 13.174200908767352, 136.0765145123172, 149.91798558949642, 8.726676306184814, 1.0494086095227584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8755352533521144, "mean_inference_ms": 2.38148068268919, "mean_action_processing_ms": 0.39217275975819665, "mean_env_wait_ms": 0.3051066809781941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01942598819732666, "StateBufferConnector_ms": 0.004598259925842285, "ViewRequirementAgentConnector_ms": 0.09828400611877441}, "num_episodes": 18, "episode_return_max": 304.8149237106149, "episode_return_min": -251.7179111286011, "episode_return_mean": 61.031904933732115, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.62846329838504, "num_env_steps_trained_throughput_per_sec": 258.62846329838504, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 13892.226, "restore_workers_time_ms": 0.071, "training_step_time_ms": 13892.058, "sample_time_ms": 1749.743, "learn_time_ms": 12125.312, "learn_throughput": 329.888, "synch_weights_time_ms": 14.709}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "6c58f_00000", "date": "2024-08-16_16-08-32", "timestamp": 1723804712, "time_this_iter_s": 15.517833948135376, "time_total_s": 97.57544755935669, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0503790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 97.57544755935669, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.23636363636364, "ram_util_percent": 81.0090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.265432238783786, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 3.7548677984368863, "policy_loss": -0.005463657674882265, "vf_loss": 3.7596877014826213, "vf_explained_var": 0.007153658797501256, "kl": 0.012875226600034562, "entropy": 1.5998204178911037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2946029688315417, "cur_kl_coeff": 0.0125, "cur_lr": 1e-05, "total_loss": 7.363594280475031, "policy_loss": -0.001857663233759542, "vf_loss": 7.365363090000455, "vf_explained_var": 0.023150876085594217, "kl": 0.007110437050838891, "entropy": 1.592986398966855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 304.8149237106149, "episode_reward_min": -251.7179111286011, "episode_reward_mean": 67.3627481699327, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -504.7524815698776, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.95014490808325, "predator_policy": 558.0437567044025}, "policy_reward_mean": {"prey_policy": -79.7065200254221, "predator_policy": 113.3878941103884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.495508794935388, 67.9718476190652, -47.536467869708616, 27.150000000000453, -40.59803173177128, 99.08709206550435, -20.245706853801238, 94.19000000000044, 5.109999999999955, 57.979999999999414, -251.7179111286011, 19.373020694743193, 5.899999999999952, 65.11236883469243, 4.079999999999961, 3.199999999999976, 16.56838498697212, -13.590727591695618, 58.48470860659156, 45.45786111182118, 88.07609919037411, 6.8199999999999426, 6.643709557544529, 67.06893401636198, 37.97577100197404, 2.2199999999999953, 34.694578807059386, 97.42000000000037, 3.6810610053296564, -22.161715097382015, 175.86433330119868, 2.7499999999999845, 21.42679166853857, 193.2806877096416, -6.873027883281875, 176.36949355269462, 16.572889858018865, 97.10000000000052, 141.76769798286756, 113.97786373229869, 72.72117975313557, 304.8149237106149, 87.52731485281957, 3.82999999999997, 134.9734603197478, 103.12000000000066, 50.340741541955616, 74.60079095939493, 145.52531787315132, 99.73236971245915, 74.50000000000006, 191.82999999999967, -28.269797533780793, 57.02999999999947, 56.10999999999955, 2.9699999999999775, 85.3271182512293, 18.040000000000177, 149.92999999999998, -9.958776322275423, 58.10565567858778, 151.43999999999988, 110.35221231685033, -17.141717021519028, 167.75269971722116, 17.359955990125815, 85.94000000000072, 8.259999999999943, 95.88000000000099, 3.7699999999999636, 21.380000000000454, 4.8799999999999395, 207.4899999999995, 222.7128335946887, 44.53000000000018, 7.179999999999996, 152.10999999999945, 98.12681650740713, 32.931286963420234, 85.5365168314968, 162.46130101975533, 208.8599999999983, 172.3500000000004, 120.89000000000033, 71.47591023333959, 172.0299999999997, 36.809999999999995, 46.27999999999996, 60.74661470249764, 132.07999999999976, 31.87245784942603, 115.30000000000081, 11.329999999999968, 207.14999999999998, 12.016520285344367, 80.1755716654859, 123.7335167194107, 10.816821220571557, 144.36808365872128, 121.09000000000029], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.82703999350137, -5.104447214579862, -32.68336411934127, -58.50465011843741, -197.06437224974349, -67.54451756926659, -47.56242081128359, -13.013606760036883, -151.41041379700735, -289.71313057417603, -38.44985770266862, 53.14084591093401, -157.30397782710673, -82.34692464327753, 17.21520378136473, -86.45761882861581, -306.2279150836634, -124.86236959089887, 11.013732366229123, -157.331834772198, -504.7524815698776, -371.43743543692386, -281.99251387930644, -17.990668431315896, -76.76558653643701, -85.99531453545907, -139.2847821126664, 22.983100126443542, -126.68360031864681, -227.21046444253344, -53.76632518803264, -82.54373463838557, -96.03817594015086, -98.59087174648305, -220.49768255571817, -58.4234900965041, 30.64481648171603, -188.90825006566217, 2.0000000000000013, -139.88569830996386, -182.35336161571385, 26.993074082479502, -214.92940819473645, -16.13412787725633, -111.88024500494204, -213.69289617767092, -196.7166537245949, -59.826630385098184, -182.42341521491508, -51.4281130660157, -2.723987780436338, -415.32569690294287, -194.12682300841303, -55.77982108207027, -63.26963431879167, 75.20148043101254, -440.62718866710685, -186.43793442240315, -163.22295774821592, -115.20130176676817, 35.035170190241516, -307.5305041495133, -176.03567538151918, -43.849842935713, -110.4637937820399, -416.182477100657, -472.4381668221672, 45.76036634484953, -117.43367433247914, -80.75788629354054, 49.586421063519666, -29.654313050323417, -98.84039448227303, -118.97895146947835, 14.338037208188418, -68.36953983392563, -77.03154753045465, -472.2058858540172, -251.87420884881388, -63.64680485347029, -161.71579340040034, 55.45999999999977, -382.13626336665976, 133.91570320074015, 26.438162761595287, -42.16645944633913, -160.82427159611927, -193.4530172131932, -411.50555401721306, -10.770398507901284, -159.95760056197298, 69.4734435101758, -290.71955745729144, -72.7762038584756, 31.28633457028038, -111.32024704447528, -481.2129362886261, 94.1832974663418, 27.930694967762793, -16.848956370193896, -13.950227536439364, -335.46730193313346, 176.95014490808325, -65.33677984787465, -459.0339254242455, -231.37877499614928, 9.173432639929285, -32.922248032979816, 13.04908804117318, -4.092843607814771, 0.3307614746388076, -230.35169617250918, 21.71105994556136, -11.266696621686886, 8.946783477596673, -139.53315093647603, -3.013262070325821, 19.43352075679509, -172.76241674168156, -148.3230868015413, -8.579483308575158, 40.01913908198327, -100.64897596541024, 19.529584287051204, -132.44974569405963, -2.933276403942541, -70.44287503094007, -72.26424458464489, 121.13822631978756, -25.885672887102416, -134.51177509278685, -17.53065994748344, 69.73739478473402, -8.223218571783969, -185.72068056456078, -4.951847808349871, -2.968414127761207, 56.803821052117186, -20.3795667714451, -5.330902551057566, -65.66088089933315, -11.76235108886918, -10.9759785855342, -0.7911904075196234, -29.99901917748592, 133.98364027493753, 74.34626798908226, 108.39377399573362, -170.29422256082856, -24.754350364205578, -257.4467232016582, -50.59324465598916, 83.20891868228445, -22.249953668127468, -22.308824478782896, -15.788365180897188, 1.7907277224952283, -120.12387276320813, -200.94858634592677, -75.27974959027817, -67.00870663876637, -56.52449244329197, 66.47332369381574, 132.6105913904767, -77.11905138449771, 118.07155013431831, -60.09957236238448, -18.85316804322444, -293.11402654060987, 32.082741192538, 148.0896314014605, -5.982155335777932, -5.235116777795948, -79.91170279572677, 15.782765638004356, -222.98301520609783, -25.335717346325943, -64.70913038693354, -66.2696851056932, 93.72403185900774, -18.51439534241071, -139.8580991390521, 63.690260086893296, -43.50924141804343, -127.2503321832757, -5.018819540543188, 127.73000000000037, -44.34559700979763, -11.119740048259107, -36.7542763078764, -28.94283781317545, -128.57051211067247, 100.00999999999999, -77.41250090401847, -277.96810125238613, -63.51725951210768, 76.46599682764145, -69.31756886941054, 19.51343613380171, 26.758041746534598], "policy_predator_policy_reward": [18.439892938191598, 52.98710306482474, 138.3438903140346, 20.81597154280815, 215.26718389287652, 1.8052380564254111, 32.09445531617917, 55.63157225514102, 112.25390572860067, 288.27160691081116, 64.93053516986186, 19.46556868737566, 189.24748424751937, 30.15771136906448, 75.42479621863531, 88.00761882861656, 309.92791508366275, 126.27236959089956, 20.576267633770843, 183.72183477219673, 66.42824917379765, 558.0437567044025, 3.3011762508903733, 316.055026754475, 73.78662072742166, 94.87428034447568, 143.84478211266497, 37.569268708249005, 130.03360031864744, 227.9404644425337, 55.36632518803232, 84.14373463838639, 100.98898353037316, 110.20844914323418, 194.80034735116777, 70.53009770935854, 12.030491782832401, 204.71765040770453, 70.37814422030002, 112.96541520148517, 79.70020338530942, 163.73618333829924, 219.90940819473568, 17.974127877256567, 124.81054943393755, 207.40630130621966, 204.08519238131254, 119.52702574474243, 238.40867556321376, 33.41862371969095, 4.673987780436296, 415.5956969029426, 55.746194170633075, 228.855028726909, 80.51963431879143, 4.968519568987477, 73.67663388045253, 557.0695502143864, 169.60558217733097, 86.6569622402707, 270.25817580314487, 178.10149145732578, 177.17567538151857, 45.45984293571269, 291.9632668043032, 256.109795746932, 406.10056225013886, 213.85792593682112, 118.14424814761307, 73.17428459512516, 86.9686508550342, 69.46873468446486, 108.59603417415002, 125.79620163562015, 81.16196279181158, 69.96953983392534, 235.54353475572316, 455.4615966116171, 257.21625566978435, 172.28262176479888, 152.3771479022216, 26.599825251314783, 198.1707367519657, 354.8647471245691, 28.420749480695452, 74.8348620568681, 161.57427159611936, 196.53301721319332, 256.88559192847066, 300.36382091639155, 158.56505585083906, 35.03910120095736, 329.71694634928747, 84.11955650843538, 110.92621477970715, 43.708488653883215, 416.6161066274913, 115.93885006794403, 59.77274312713473, 28.87788798775513, 87.78022753643951, 336.13730193313285, 13.069855091916725, 67.14677984787534, 462.91986642319586, 199.2230364634173, 44.43628070236922, 36.34253469068094, 0.0, 47.15375556664146, 34.753869189953804, 198.2370655079158, 19.531374160880816, 55.35138076647343, 7.823216522403291, 140.8031509364754, 26.583262070325937, 106.926479243205, 184.7072874877404, 126.41943973320728, 25.915943165478502, 0.7500567397013461, 139.64897596540985, 92.91041571294866, 226.68276925421117, 19.052465160640544, 90.41858838791136, 35.14681420615512, 9.29555150268148, 63.20459478185467, 24.941626639447446, 144.46076439094773, 14.30260521526618, 10.123218571783928, 150.2487930408933, 48.68373533201607, 4.90841412776117, 37.13617894788264, 23.033699481936836, 6.446769840565956, 85.14088089933391, 13.662351088869139, 13.87597858553416, 2.771190407519608, 103.5053789025485, 0.0, 2.499588247007334, 37.47320336286561, 196.3042225608277, 43.274350364205816, 258.1067232016579, 57.11324465598888, 10.265012818092215, 80.88602216775162, 73.29322747234889, 62.93077869473767, 10.729995397567684, 140.53443660656524, 348.59065185893485, 13.174200908767352, 136.0765145123172, 149.91798558949642, 8.726676306184814, 1.0494086095227584, 103.0590513844981, 28.33844986568171, 133.77957236238402, 66.06316804322428, 23.38829446527287, 309.11890111613883, 2.169585685970169, 27.752938248347064, 43.251123650789914, 78.70569592273334, 89.35616865171693, 164.12408091637639, 66.12232074241665, 84.66914169334123, 92.5196851056937, 12.105968140992509, 107.01619999947536, 83.22875233141305, 49.9297399131066, 45.189241418043096, 134.69033218327453, 8.90881954054315, 0.0, 123.7655970097978, 51.30773253074404, 8.582804110735559, 199.12492705583026, 38.563994533503035, 12.4745975923055, 88.661420031124, 65.67174429646276, 286.6304376886027, 11.392832892669084, 125.8268228078222, 18.39594714917047, 56.42257497049344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.852307767621588, "mean_inference_ms": 2.3133630466459425, "mean_action_processing_ms": 0.3758072590378997, "mean_env_wait_ms": 0.29632656631775733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019065260887145996, "StateBufferConnector_ms": 0.004673480987548828, "ViewRequirementAgentConnector_ms": 0.10691404342651367}, "num_episodes": 18, "episode_return_max": 304.8149237106149, "episode_return_min": -251.7179111286011, "episode_return_mean": 67.3627481699327, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.29646281160294, "num_env_steps_trained_throughput_per_sec": 254.29646281160294, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 14121.908, "restore_workers_time_ms": 0.064, "training_step_time_ms": 14121.756, "sample_time_ms": 1737.87, "learn_time_ms": 12366.818, "learn_throughput": 323.446, "synch_weights_time_ms": 14.781}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "6c58f_00000", "date": "2024-08-16_16-08-48", "timestamp": 1723804728, "time_this_iter_s": 15.780390977859497, "time_total_s": 113.35583853721619, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04d63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 113.35583853721619, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 62.09090909090909, "ram_util_percent": 82.37272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9780871765323417, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 6.241289648681722, "policy_loss": -0.005072201286669249, "vf_loss": 6.245826960114575, "vf_explained_var": 0.004108472948982602, "kl": 0.010697838521549758, "entropy": 1.5974797146660942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0227372780678765, "cur_kl_coeff": 0.0125, "cur_lr": 1e-05, "total_loss": 8.081434421186094, "policy_loss": -0.0033731374660477278, "vf_loss": 8.084755298574136, "vf_explained_var": 0.013118975093125035, "kl": 0.0041820778482712945, "entropy": 1.596400619499267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 304.8149237106149, "episode_reward_min": -81.25674557315608, "episode_reward_mean": 85.01214458437136, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.2129362886261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.95014490808325, "predator_policy": 557.0695502143864}, "policy_reward_mean": {"prey_policy": -74.8943924921451, "predator_policy": 117.40046478433072}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.643709557544529, 67.06893401636198, 37.97577100197404, 2.2199999999999953, 34.694578807059386, 97.42000000000037, 3.6810610053296564, -22.161715097382015, 175.86433330119868, 2.7499999999999845, 21.42679166853857, 193.2806877096416, -6.873027883281875, 176.36949355269462, 16.572889858018865, 97.10000000000052, 141.76769798286756, 113.97786373229869, 72.72117975313557, 304.8149237106149, 87.52731485281957, 3.82999999999997, 134.9734603197478, 103.12000000000066, 50.340741541955616, 74.60079095939493, 145.52531787315132, 99.73236971245915, 74.50000000000006, 191.82999999999967, -28.269797533780793, 57.02999999999947, 56.10999999999955, 2.9699999999999775, 85.3271182512293, 18.040000000000177, 149.92999999999998, -9.958776322275423, 58.10565567858778, 151.43999999999988, 110.35221231685033, -17.141717021519028, 167.75269971722116, 17.359955990125815, 85.94000000000072, 8.259999999999943, 95.88000000000099, 3.7699999999999636, 21.380000000000454, 4.8799999999999395, 207.4899999999995, 222.7128335946887, 44.53000000000018, 7.179999999999996, 152.10999999999945, 98.12681650740713, 32.931286963420234, 85.5365168314968, 162.46130101975533, 208.8599999999983, 172.3500000000004, 120.89000000000033, 71.47591023333959, 172.0299999999997, 36.809999999999995, 46.27999999999996, 60.74661470249764, 132.07999999999976, 31.87245784942603, 115.30000000000081, 11.329999999999968, 207.14999999999998, 12.016520285344367, 80.1755716654859, 123.7335167194107, 10.816821220571557, 144.36808365872128, 121.09000000000029, 50.899961394787745, 84.19000000000031, 8.46999999999996, 174.82999999999987, 106.35056565573666, 174.65705221106796, 51.84999999999993, 152.59478587417806, 56.022429350830194, 238.24, 96.17712733631636, 85.0913883568158, 180.32442657392085, -5.154107815179384, 115.21000000000043, 102.90000000000012, 16.63999999999998, -81.25674557315608, 229.7476035337691, -4.546798726100134, 231.48000000000016, 1.5899999999999945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-111.88024500494204, -213.69289617767092, -196.7166537245949, -59.826630385098184, -182.42341521491508, -51.4281130660157, -2.723987780436338, -415.32569690294287, -194.12682300841303, -55.77982108207027, -63.26963431879167, 75.20148043101254, -440.62718866710685, -186.43793442240315, -163.22295774821592, -115.20130176676817, 35.035170190241516, -307.5305041495133, -176.03567538151918, -43.849842935713, -110.4637937820399, -416.182477100657, -472.4381668221672, 45.76036634484953, -117.43367433247914, -80.75788629354054, 49.586421063519666, -29.654313050323417, -98.84039448227303, -118.97895146947835, 14.338037208188418, -68.36953983392563, -77.03154753045465, -472.2058858540172, -251.87420884881388, -63.64680485347029, -161.71579340040034, 55.45999999999977, -382.13626336665976, 133.91570320074015, 26.438162761595287, -42.16645944633913, -160.82427159611927, -193.4530172131932, -411.50555401721306, -10.770398507901284, -159.95760056197298, 69.4734435101758, -290.71955745729144, -72.7762038584756, 31.28633457028038, -111.32024704447528, -481.2129362886261, 94.1832974663418, 27.930694967762793, -16.848956370193896, -13.950227536439364, -335.46730193313346, 176.95014490808325, -65.33677984787465, -459.0339254242455, -231.37877499614928, 9.173432639929285, -32.922248032979816, 13.04908804117318, -4.092843607814771, 0.3307614746388076, -230.35169617250918, 21.71105994556136, -11.266696621686886, 8.946783477596673, -139.53315093647603, -3.013262070325821, 19.43352075679509, -172.76241674168156, -148.3230868015413, -8.579483308575158, 40.01913908198327, -100.64897596541024, 19.529584287051204, -132.44974569405963, -2.933276403942541, -70.44287503094007, -72.26424458464489, 121.13822631978756, -25.885672887102416, -134.51177509278685, -17.53065994748344, 69.73739478473402, -8.223218571783969, -185.72068056456078, -4.951847808349871, -2.968414127761207, 56.803821052117186, -20.3795667714451, -5.330902551057566, -65.66088089933315, -11.76235108886918, -10.9759785855342, -0.7911904075196234, -29.99901917748592, 133.98364027493753, 74.34626798908226, 108.39377399573362, -170.29422256082856, -24.754350364205578, -257.4467232016582, -50.59324465598916, 83.20891868228445, -22.249953668127468, -22.308824478782896, -15.788365180897188, 1.7907277224952283, -120.12387276320813, -200.94858634592677, -75.27974959027817, -67.00870663876637, -56.52449244329197, 66.47332369381574, 132.6105913904767, -77.11905138449771, 118.07155013431831, -60.09957236238448, -18.85316804322444, -293.11402654060987, 32.082741192538, 148.0896314014605, -5.982155335777932, -5.235116777795948, -79.91170279572677, 15.782765638004356, -222.98301520609783, -25.335717346325943, -64.70913038693354, -66.2696851056932, 93.72403185900774, -18.51439534241071, -139.8580991390521, 63.690260086893296, -43.50924141804343, -127.2503321832757, -5.018819540543188, 127.73000000000037, -44.34559700979763, -11.119740048259107, -36.7542763078764, -28.94283781317545, -128.57051211067247, 100.00999999999999, -77.41250090401847, -277.96810125238613, -63.51725951210768, 76.46599682764145, -69.31756886941054, 19.51343613380171, 26.758041746534598, -37.05286718169216, 5.849377040797339, -48.59314220019905, 9.235819308137398, -131.02726539144308, -191.71740876395933, 127.8863440054299, -6.463399638375435, -242.64259083837442, -98.82057268407392, -23.80696982597988, -200.18332155373187, -40.55109849699797, -43.24019026853029, 50.26494156589163, -130.886772863739, 33.46473084955493, -146.60240746217568, -18.39161651070627, -10.645854534465833, 69.32000000000012, -153.40452371944244, 1.0107071396486265, -202.9307617248742, -122.7403601872586, -121.07827330120618, -101.98140281692618, -268.3600530303118, 18.27521597401939, -7.321692795391732, 59.41999999999973, -176.6893829915677, -146.01156801023504, -308.91515586230577, -421.0072840913874, -291.30500919262903, -7.281055244836743, 90.87444983521725, -105.07284233518395, -140.68740381247576, 91.24026420467023, 107.59001898585078, -201.05074472271798, -447.1450325990366], "policy_predator_policy_reward": [124.81054943393755, 207.40630130621966, 204.08519238131254, 119.52702574474243, 238.40867556321376, 33.41862371969095, 4.673987780436296, 415.5956969029426, 55.746194170633075, 228.855028726909, 80.51963431879143, 4.968519568987477, 73.67663388045253, 557.0695502143864, 169.60558217733097, 86.6569622402707, 270.25817580314487, 178.10149145732578, 177.17567538151857, 45.45984293571269, 291.9632668043032, 256.109795746932, 406.10056225013886, 213.85792593682112, 118.14424814761307, 73.17428459512516, 86.9686508550342, 69.46873468446486, 108.59603417415002, 125.79620163562015, 81.16196279181158, 69.96953983392534, 235.54353475572316, 455.4615966116171, 257.21625566978435, 172.28262176479888, 152.3771479022216, 26.599825251314783, 198.1707367519657, 354.8647471245691, 28.420749480695452, 74.8348620568681, 161.57427159611936, 196.53301721319332, 256.88559192847066, 300.36382091639155, 158.56505585083906, 35.03910120095736, 329.71694634928747, 84.11955650843538, 110.92621477970715, 43.708488653883215, 416.6161066274913, 115.93885006794403, 59.77274312713473, 28.87788798775513, 87.78022753643951, 336.13730193313285, 13.069855091916725, 67.14677984787534, 462.91986642319586, 199.2230364634173, 44.43628070236922, 36.34253469068094, 0.0, 47.15375556664146, 34.753869189953804, 198.2370655079158, 19.531374160880816, 55.35138076647343, 7.823216522403291, 140.8031509364754, 26.583262070325937, 106.926479243205, 184.7072874877404, 126.41943973320728, 25.915943165478502, 0.7500567397013461, 139.64897596540985, 92.91041571294866, 226.68276925421117, 19.052465160640544, 90.41858838791136, 35.14681420615512, 9.29555150268148, 63.20459478185467, 24.941626639447446, 144.46076439094773, 14.30260521526618, 10.123218571783928, 150.2487930408933, 48.68373533201607, 4.90841412776117, 37.13617894788264, 23.033699481936836, 6.446769840565956, 85.14088089933391, 13.662351088869139, 13.87597858553416, 2.771190407519608, 103.5053789025485, 0.0, 2.499588247007334, 37.47320336286561, 196.3042225608277, 43.274350364205816, 258.1067232016579, 57.11324465598888, 10.265012818092215, 80.88602216775162, 73.29322747234889, 62.93077869473767, 10.729995397567684, 140.53443660656524, 348.59065185893485, 13.174200908767352, 136.0765145123172, 149.91798558949642, 8.726676306184814, 1.0494086095227584, 103.0590513844981, 28.33844986568171, 133.77957236238402, 66.06316804322428, 23.38829446527287, 309.11890111613883, 2.169585685970169, 27.752938248347064, 43.251123650789914, 78.70569592273334, 89.35616865171693, 164.12408091637639, 66.12232074241665, 84.66914169334123, 92.5196851056937, 12.105968140992509, 107.01619999947536, 83.22875233141305, 49.9297399131066, 45.189241418043096, 134.69033218327453, 8.90881954054315, 0.0, 123.7655970097978, 51.30773253074404, 8.582804110735559, 199.12492705583026, 38.563994533503035, 12.4745975923055, 88.661420031124, 65.67174429646276, 286.6304376886027, 11.392832892669084, 125.8268228078222, 18.39594714917047, 56.42257497049344, 75.14988799237547, 6.953563543306598, 97.63790380013799, 25.90941909192365, 325.4152744299705, 5.799399725430577, 13.339211649492064, 40.067843983453244, 300.3231564941109, 147.49057268407432, 201.88768770684052, 196.75965588394004, 63.17109849699765, 72.4701902685301, 195.52047943821742, 37.69613773380712, 95.56618270289287, 73.5939232605578, 159.81269136553516, 107.46477967963686, 69.52541038396488, 110.7362406717932, 51.41084952233944, 235.60059341970165, 233.15163035368232, 190.9914297087027, 65.73119855795639, 299.4561494741031, 12.34512737629331, 91.91134944507901, 0.0, 220.16938299156743, 147.20156801023566, 324.36515586230536, 208.3845190930153, 422.67102861784525, 14.378312186243352, 131.77589675714592, 204.11510726296257, 37.09834015859682, 23.040568100431113, 9.609148709047693, 202.04074472271756, 447.74503259903616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8276739999276697, "mean_inference_ms": 2.2550400893337788, "mean_action_processing_ms": 0.360841244641219, "mean_env_wait_ms": 0.28696389491608454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01849830150604248, "StateBufferConnector_ms": 0.0031316280364990234, "ViewRequirementAgentConnector_ms": 0.10707366466522217}, "num_episodes": 22, "episode_return_max": 304.8149237106149, "episode_return_min": -81.25674557315608, "episode_return_mean": 85.01214458437136, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.9312928279466, "num_env_steps_trained_throughput_per_sec": 257.9312928279466, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14275.919, "restore_workers_time_ms": 0.058, "training_step_time_ms": 14275.78, "sample_time_ms": 1736.193, "learn_time_ms": 12521.554, "learn_throughput": 319.449, "synch_weights_time_ms": 15.888}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "6c58f_00000", "date": "2024-08-16_16-09-04", "timestamp": 1723804744, "time_this_iter_s": 15.594993829727173, "time_total_s": 128.95083236694336, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 128.95083236694336, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 60.140909090909076, "ram_util_percent": 82.29545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3887148933120506, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 6.3723078197903105, "policy_loss": -0.004613823913500974, "vf_loss": 6.376344507711905, "vf_explained_var": 0.0016034102629101466, "kl": 0.011542660975711952, "entropy": 1.5748921780989915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2895882640566145, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.003392673674083, "policy_loss": -0.007360137317689363, "vf_loss": 9.010676991498029, "vf_explained_var": 0.02985675877364224, "kl": 0.012131167885997315, "entropy": 1.5905638497973245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 238.24, "episode_reward_min": -123.98706237381764, "episode_reward_mean": 93.49472127955387, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.2129362886261, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.95014490808325, "predator_policy": 462.91986642319586}, "policy_reward_mean": {"prey_policy": -63.76856960513178, "predator_policy": 110.51593024490863}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.12000000000066, 50.340741541955616, 74.60079095939493, 145.52531787315132, 99.73236971245915, 74.50000000000006, 191.82999999999967, -28.269797533780793, 57.02999999999947, 56.10999999999955, 2.9699999999999775, 85.3271182512293, 18.040000000000177, 149.92999999999998, -9.958776322275423, 58.10565567858778, 151.43999999999988, 110.35221231685033, -17.141717021519028, 167.75269971722116, 17.359955990125815, 85.94000000000072, 8.259999999999943, 95.88000000000099, 3.7699999999999636, 21.380000000000454, 4.8799999999999395, 207.4899999999995, 222.7128335946887, 44.53000000000018, 7.179999999999996, 152.10999999999945, 98.12681650740713, 32.931286963420234, 85.5365168314968, 162.46130101975533, 208.8599999999983, 172.3500000000004, 120.89000000000033, 71.47591023333959, 172.0299999999997, 36.809999999999995, 46.27999999999996, 60.74661470249764, 132.07999999999976, 31.87245784942603, 115.30000000000081, 11.329999999999968, 207.14999999999998, 12.016520285344367, 80.1755716654859, 123.7335167194107, 10.816821220571557, 144.36808365872128, 121.09000000000029, 50.899961394787745, 84.19000000000031, 8.46999999999996, 174.82999999999987, 106.35056565573666, 174.65705221106796, 51.84999999999993, 152.59478587417806, 56.022429350830194, 238.24, 96.17712733631636, 85.0913883568158, 180.32442657392085, -5.154107815179384, 115.21000000000043, 102.90000000000012, 16.63999999999998, -81.25674557315608, 229.7476035337691, -4.546798726100134, 231.48000000000016, 1.5899999999999945, 111.17713447902034, 230.35155896391979, 70.56310758581822, 65.08277390617228, 131.45934200297276, 149.92909457330393, 209.06999999999968, 152.25619161752434, -123.98706237381764, 170.52751745493364, 170.7499999999996, -8.547070557957705, 209.5066712235098, 163.68939467156028, 79.99469971435563, 98.49213118877873, 179.59999999999968, 45.19999999999985, 175.92925572626515, 89.94000000000005, 69.05548354853067, 180.88000000000002, -9.016606357455416], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-159.95760056197298, 69.4734435101758, -290.71955745729144, -72.7762038584756, 31.28633457028038, -111.32024704447528, -481.2129362886261, 94.1832974663418, 27.930694967762793, -16.848956370193896, -13.950227536439364, -335.46730193313346, 176.95014490808325, -65.33677984787465, -459.0339254242455, -231.37877499614928, 9.173432639929285, -32.922248032979816, 13.04908804117318, -4.092843607814771, 0.3307614746388076, -230.35169617250918, 21.71105994556136, -11.266696621686886, 8.946783477596673, -139.53315093647603, -3.013262070325821, 19.43352075679509, -172.76241674168156, -148.3230868015413, -8.579483308575158, 40.01913908198327, -100.64897596541024, 19.529584287051204, -132.44974569405963, -2.933276403942541, -70.44287503094007, -72.26424458464489, 121.13822631978756, -25.885672887102416, -134.51177509278685, -17.53065994748344, 69.73739478473402, -8.223218571783969, -185.72068056456078, -4.951847808349871, -2.968414127761207, 56.803821052117186, -20.3795667714451, -5.330902551057566, -65.66088089933315, -11.76235108886918, -10.9759785855342, -0.7911904075196234, -29.99901917748592, 133.98364027493753, 74.34626798908226, 108.39377399573362, -170.29422256082856, -24.754350364205578, -257.4467232016582, -50.59324465598916, 83.20891868228445, -22.249953668127468, -22.308824478782896, -15.788365180897188, 1.7907277224952283, -120.12387276320813, -200.94858634592677, -75.27974959027817, -67.00870663876637, -56.52449244329197, 66.47332369381574, 132.6105913904767, -77.11905138449771, 118.07155013431831, -60.09957236238448, -18.85316804322444, -293.11402654060987, 32.082741192538, 148.0896314014605, -5.982155335777932, -5.235116777795948, -79.91170279572677, 15.782765638004356, -222.98301520609783, -25.335717346325943, -64.70913038693354, -66.2696851056932, 93.72403185900774, -18.51439534241071, -139.8580991390521, 63.690260086893296, -43.50924141804343, -127.2503321832757, -5.018819540543188, 127.73000000000037, -44.34559700979763, -11.119740048259107, -36.7542763078764, -28.94283781317545, -128.57051211067247, 100.00999999999999, -77.41250090401847, -277.96810125238613, -63.51725951210768, 76.46599682764145, -69.31756886941054, 19.51343613380171, 26.758041746534598, -37.05286718169216, 5.849377040797339, -48.59314220019905, 9.235819308137398, -131.02726539144308, -191.71740876395933, 127.8863440054299, -6.463399638375435, -242.64259083837442, -98.82057268407392, -23.80696982597988, -200.18332155373187, -40.55109849699797, -43.24019026853029, 50.26494156589163, -130.886772863739, 33.46473084955493, -146.60240746217568, -18.39161651070627, -10.645854534465833, 69.32000000000012, -153.40452371944244, 1.0107071396486265, -202.9307617248742, -122.7403601872586, -121.07827330120618, -101.98140281692618, -268.3600530303118, 18.27521597401939, -7.321692795391732, 59.41999999999973, -176.6893829915677, -146.01156801023504, -308.91515586230577, -421.0072840913874, -291.30500919262903, -7.281055244836743, 90.87444983521725, -105.07284233518395, -140.68740381247576, 91.24026420467023, 107.59001898585078, -201.05074472271798, -447.1450325990366, -78.86190019206758, -135.05165178685647, 81.11599226341454, -24.825832137231465, -289.65129545480426, -175.13230869286366, 57.252896931223056, -304.3691455452912, -119.99961281287064, 15.336333192634182, -40.19703195014429, -146.3197118259219, -32.08567324054721, 64.36391191054847, 64.59056213331323, -128.96407278293486, -292.2260446247115, -190.87341204631485, 71.89955353086849, -336.16183847621625, 18.75850440995704, 39.60865501236728, -268.70719774328234, -42.626546526968674, 24.022851790121248, 86.1342404450424, -377.47444223335503, -0.9576760187467812, -289.82659420867276, -33.918408546610344, 68.94286572384169, -218.56825224251872, -28.310798192194028, 121.08794450812714, -196.3958244916101, -15.363707461370549, 4.30458095115599, -41.722679393686505, -1.8817119494846164, -134.03934949498304, -50.51560779104608, -387.2996723823892, -115.75027003114153, 12.77486827106061, -265.1919298048175, -26.572365927804107], "policy_predator_policy_reward": [158.56505585083906, 35.03910120095736, 329.71694634928747, 84.11955650843538, 110.92621477970715, 43.708488653883215, 416.6161066274913, 115.93885006794403, 59.77274312713473, 28.87788798775513, 87.78022753643951, 336.13730193313285, 13.069855091916725, 67.14677984787534, 462.91986642319586, 199.2230364634173, 44.43628070236922, 36.34253469068094, 0.0, 47.15375556664146, 34.753869189953804, 198.2370655079158, 19.531374160880816, 55.35138076647343, 7.823216522403291, 140.8031509364754, 26.583262070325937, 106.926479243205, 184.7072874877404, 126.41943973320728, 25.915943165478502, 0.7500567397013461, 139.64897596540985, 92.91041571294866, 226.68276925421117, 19.052465160640544, 90.41858838791136, 35.14681420615512, 9.29555150268148, 63.20459478185467, 24.941626639447446, 144.46076439094773, 14.30260521526618, 10.123218571783928, 150.2487930408933, 48.68373533201607, 4.90841412776117, 37.13617894788264, 23.033699481936836, 6.446769840565956, 85.14088089933391, 13.662351088869139, 13.87597858553416, 2.771190407519608, 103.5053789025485, 0.0, 2.499588247007334, 37.47320336286561, 196.3042225608277, 43.274350364205816, 258.1067232016579, 57.11324465598888, 10.265012818092215, 80.88602216775162, 73.29322747234889, 62.93077869473767, 10.729995397567684, 140.53443660656524, 348.59065185893485, 13.174200908767352, 136.0765145123172, 149.91798558949642, 8.726676306184814, 1.0494086095227584, 103.0590513844981, 28.33844986568171, 133.77957236238402, 66.06316804322428, 23.38829446527287, 309.11890111613883, 2.169585685970169, 27.752938248347064, 43.251123650789914, 78.70569592273334, 89.35616865171693, 164.12408091637639, 66.12232074241665, 84.66914169334123, 92.5196851056937, 12.105968140992509, 107.01619999947536, 83.22875233141305, 49.9297399131066, 45.189241418043096, 134.69033218327453, 8.90881954054315, 0.0, 123.7655970097978, 51.30773253074404, 8.582804110735559, 199.12492705583026, 38.563994533503035, 12.4745975923055, 88.661420031124, 65.67174429646276, 286.6304376886027, 11.392832892669084, 125.8268228078222, 18.39594714917047, 56.42257497049344, 75.14988799237547, 6.953563543306598, 97.63790380013799, 25.90941909192365, 325.4152744299705, 5.799399725430577, 13.339211649492064, 40.067843983453244, 300.3231564941109, 147.49057268407432, 201.88768770684052, 196.75965588394004, 63.17109849699765, 72.4701902685301, 195.52047943821742, 37.69613773380712, 95.56618270289287, 73.5939232605578, 159.81269136553516, 107.46477967963686, 69.52541038396488, 110.7362406717932, 51.41084952233944, 235.60059341970165, 233.15163035368232, 190.9914297087027, 65.73119855795639, 299.4561494741031, 12.34512737629331, 91.91134944507901, 0.0, 220.16938299156743, 147.20156801023566, 324.36515586230536, 208.3845190930153, 422.67102861784525, 14.378312186243352, 131.77589675714592, 204.11510726296257, 37.09834015859682, 23.040568100431113, 9.609148709047693, 202.04074472271756, 447.74503259903616, 182.7934277013485, 142.2972587565956, 113.12827039463778, 60.93312844309956, 250.13995390387504, 285.20675782961086, 3.719149745896684, 308.4798727743439, 225.38424634185114, 10.738375281357097, 100.90054769764865, 235.54529065172122, 86.98567324054707, 89.80608808945156, 206.69296082571438, 9.936741441431687, 25.551063316936858, 333.5613309802696, 113.14877779751586, 321.6410246027652, 17.721495590043055, 94.66134498763275, 163.02109037871696, 139.76558333357548, 12.530851376110915, 86.81872761223538, 299.4339317030106, 242.68758122065177, 114.78261602865952, 288.9570864409791, 28.445130651791693, 219.6723870556631, 73.34964920953514, 13.473204474531883, 52.375651533928995, 204.5838804190519, 135.72180217277426, 77.6255519960216, 4.821711949484616, 221.03934949498299, 70.57917145707697, 436.2915922648884, 215.6228082068912, 68.23259355319007, 257.25918125564755, 25.488508119518865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8159512348165202, "mean_inference_ms": 2.26365986606106, "mean_action_processing_ms": 0.3543969410032486, "mean_env_wait_ms": 0.28585413046298364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00649106502532959, "StateBufferConnector_ms": 0.0033676624298095703, "ViewRequirementAgentConnector_ms": 0.13078343868255615}, "num_episodes": 23, "episode_return_max": 238.24, "episode_return_min": -123.98706237381764, "episode_return_mean": 93.49472127955387, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.21008121511224, "num_env_steps_trained_throughput_per_sec": 251.21008121511224, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14440.622, "restore_workers_time_ms": 0.058, "training_step_time_ms": 14440.486, "sample_time_ms": 1836.698, "learn_time_ms": 12585.474, "learn_throughput": 317.827, "synch_weights_time_ms": 16.151}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "6c58f_00000", "date": "2024-08-16_16-09-20", "timestamp": 1723804760, "time_this_iter_s": 15.984477281570435, "time_total_s": 144.9353096485138, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04774c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.9353096485138, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 61.769565217391296, "ram_util_percent": 82.06521739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2275389199376736, "cur_kl_coeff": 0.05, "cur_lr": 1e-05, "total_loss": 4.360535997183866, "policy_loss": -0.0017121323258689944, "vf_loss": 4.362040587581655, "vf_explained_var": 0.0013626341781918965, "kl": 0.004150666009865205, "entropy": 1.5815825778971273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3579411731510567, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.690998832763187, "policy_loss": -0.005448412538318841, "vf_loss": 8.696342425371604, "vf_explained_var": 0.07332997003560343, "kl": 0.016768911496074377, "entropy": 1.5839999492206271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 340.21, "episode_reward_min": -123.98706237381764, "episode_reward_mean": 112.28947884442621, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -447.1450325990366, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.18608079005762, "predator_policy": 488.62304942652844}, "policy_reward_mean": {"prey_policy": -51.84232548847104, "predator_policy": 107.98706491068413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.141717021519028, 167.75269971722116, 17.359955990125815, 85.94000000000072, 8.259999999999943, 95.88000000000099, 3.7699999999999636, 21.380000000000454, 4.8799999999999395, 207.4899999999995, 222.7128335946887, 44.53000000000018, 7.179999999999996, 152.10999999999945, 98.12681650740713, 32.931286963420234, 85.5365168314968, 162.46130101975533, 208.8599999999983, 172.3500000000004, 120.89000000000033, 71.47591023333959, 172.0299999999997, 36.809999999999995, 46.27999999999996, 60.74661470249764, 132.07999999999976, 31.87245784942603, 115.30000000000081, 11.329999999999968, 207.14999999999998, 12.016520285344367, 80.1755716654859, 123.7335167194107, 10.816821220571557, 144.36808365872128, 121.09000000000029, 50.899961394787745, 84.19000000000031, 8.46999999999996, 174.82999999999987, 106.35056565573666, 174.65705221106796, 51.84999999999993, 152.59478587417806, 56.022429350830194, 238.24, 96.17712733631636, 85.0913883568158, 180.32442657392085, -5.154107815179384, 115.21000000000043, 102.90000000000012, 16.63999999999998, -81.25674557315608, 229.7476035337691, -4.546798726100134, 231.48000000000016, 1.5899999999999945, 111.17713447902034, 230.35155896391979, 70.56310758581822, 65.08277390617228, 131.45934200297276, 149.92909457330393, 209.06999999999968, 152.25619161752434, -123.98706237381764, 170.52751745493364, 170.7499999999996, -8.547070557957705, 209.5066712235098, 163.68939467156028, 79.99469971435563, 98.49213118877873, 179.59999999999968, 45.19999999999985, 175.92925572626515, 89.94000000000005, 69.05548354853067, 180.88000000000002, -9.016606357455416, 278.28854213499613, 142.12999999999982, -50.25813574255122, 176.35115893583938, 6.543412807449256, 11.543042110760837, 183.53621138328998, 255.00999999999962, 163.20624149660466, 329.52, 207.92015173681705, 340.21, 171.69729884305303, 141.22999999999996, 319.6399999999999, 229.2734652585499, 45.78999999999972, 318.5699999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-70.44287503094007, -72.26424458464489, 121.13822631978756, -25.885672887102416, -134.51177509278685, -17.53065994748344, 69.73739478473402, -8.223218571783969, -185.72068056456078, -4.951847808349871, -2.968414127761207, 56.803821052117186, -20.3795667714451, -5.330902551057566, -65.66088089933315, -11.76235108886918, -10.9759785855342, -0.7911904075196234, -29.99901917748592, 133.98364027493753, 74.34626798908226, 108.39377399573362, -170.29422256082856, -24.754350364205578, -257.4467232016582, -50.59324465598916, 83.20891868228445, -22.249953668127468, -22.308824478782896, -15.788365180897188, 1.7907277224952283, -120.12387276320813, -200.94858634592677, -75.27974959027817, -67.00870663876637, -56.52449244329197, 66.47332369381574, 132.6105913904767, -77.11905138449771, 118.07155013431831, -60.09957236238448, -18.85316804322444, -293.11402654060987, 32.082741192538, 148.0896314014605, -5.982155335777932, -5.235116777795948, -79.91170279572677, 15.782765638004356, -222.98301520609783, -25.335717346325943, -64.70913038693354, -66.2696851056932, 93.72403185900774, -18.51439534241071, -139.8580991390521, 63.690260086893296, -43.50924141804343, -127.2503321832757, -5.018819540543188, 127.73000000000037, -44.34559700979763, -11.119740048259107, -36.7542763078764, -28.94283781317545, -128.57051211067247, 100.00999999999999, -77.41250090401847, -277.96810125238613, -63.51725951210768, 76.46599682764145, -69.31756886941054, 19.51343613380171, 26.758041746534598, -37.05286718169216, 5.849377040797339, -48.59314220019905, 9.235819308137398, -131.02726539144308, -191.71740876395933, 127.8863440054299, -6.463399638375435, -242.64259083837442, -98.82057268407392, -23.80696982597988, -200.18332155373187, -40.55109849699797, -43.24019026853029, 50.26494156589163, -130.886772863739, 33.46473084955493, -146.60240746217568, -18.39161651070627, -10.645854534465833, 69.32000000000012, -153.40452371944244, 1.0107071396486265, -202.9307617248742, -122.7403601872586, -121.07827330120618, -101.98140281692618, -268.3600530303118, 18.27521597401939, -7.321692795391732, 59.41999999999973, -176.6893829915677, -146.01156801023504, -308.91515586230577, -421.0072840913874, -291.30500919262903, -7.281055244836743, 90.87444983521725, -105.07284233518395, -140.68740381247576, 91.24026420467023, 107.59001898585078, -201.05074472271798, -447.1450325990366, -78.86190019206758, -135.05165178685647, 81.11599226341454, -24.825832137231465, -289.65129545480426, -175.13230869286366, 57.252896931223056, -304.3691455452912, -119.99961281287064, 15.336333192634182, -40.19703195014429, -146.3197118259219, -32.08567324054721, 64.36391191054847, 64.59056213331323, -128.96407278293486, -292.2260446247115, -190.87341204631485, 71.89955353086849, -336.16183847621625, 18.75850440995704, 39.60865501236728, -268.70719774328234, -42.626546526968674, 24.022851790121248, 86.1342404450424, -377.47444223335503, -0.9576760187467812, -289.82659420867276, -33.918408546610344, 68.94286572384169, -218.56825224251872, -28.310798192194028, 121.08794450812714, -196.3958244916101, -15.363707461370549, 4.30458095115599, -41.722679393686505, -1.8817119494846164, -134.03934949498304, -50.51560779104608, -387.2996723823892, -115.75027003114153, 12.77486827106061, -265.1919298048175, -26.572365927804107, 91.04275838665146, 68.54177210225816, 75.16612727427251, 12.351478937704176, -426.6839600755458, -400.8398895177506, 141.89951220295745, -287.82039236248403, -133.83978261359405, -378.2054060503898, -74.62739162629032, -163.1940764653573, -64.57387327525753, -42.277709797795744, 116.24075037974089, 73.75018053679571, 90.05269439458907, -151.00378967837037, 136.29447831786283, 171.18608079005762, 25.099281165429105, -82.11761192184876, 128.3920151089978, 128.5584103678745, 19.171921081766563, -78.88532401321712, 74.36564396757329, 20.16443075615326, 129.7386320043117, 165.26647918815837, 105.45747757241458, 8.142927880311479, -88.60653039592832, 15.764360783484596, 128.23778007260165, 140.1772593055016], "policy_predator_policy_reward": [90.41858838791136, 35.14681420615512, 9.29555150268148, 63.20459478185467, 24.941626639447446, 144.46076439094773, 14.30260521526618, 10.123218571783928, 150.2487930408933, 48.68373533201607, 4.90841412776117, 37.13617894788264, 23.033699481936836, 6.446769840565956, 85.14088089933391, 13.662351088869139, 13.87597858553416, 2.771190407519608, 103.5053789025485, 0.0, 2.499588247007334, 37.47320336286561, 196.3042225608277, 43.274350364205816, 258.1067232016579, 57.11324465598888, 10.265012818092215, 80.88602216775162, 73.29322747234889, 62.93077869473767, 10.729995397567684, 140.53443660656524, 348.59065185893485, 13.174200908767352, 136.0765145123172, 149.91798558949642, 8.726676306184814, 1.0494086095227584, 103.0590513844981, 28.33844986568171, 133.77957236238402, 66.06316804322428, 23.38829446527287, 309.11890111613883, 2.169585685970169, 27.752938248347064, 43.251123650789914, 78.70569592273334, 89.35616865171693, 164.12408091637639, 66.12232074241665, 84.66914169334123, 92.5196851056937, 12.105968140992509, 107.01619999947536, 83.22875233141305, 49.9297399131066, 45.189241418043096, 134.69033218327453, 8.90881954054315, 0.0, 123.7655970097978, 51.30773253074404, 8.582804110735559, 199.12492705583026, 38.563994533503035, 12.4745975923055, 88.661420031124, 65.67174429646276, 286.6304376886027, 11.392832892669084, 125.8268228078222, 18.39594714917047, 56.42257497049344, 75.14988799237547, 6.953563543306598, 97.63790380013799, 25.90941909192365, 325.4152744299705, 5.799399725430577, 13.339211649492064, 40.067843983453244, 300.3231564941109, 147.49057268407432, 201.88768770684052, 196.75965588394004, 63.17109849699765, 72.4701902685301, 195.52047943821742, 37.69613773380712, 95.56618270289287, 73.5939232605578, 159.81269136553516, 107.46477967963686, 69.52541038396488, 110.7362406717932, 51.41084952233944, 235.60059341970165, 233.15163035368232, 190.9914297087027, 65.73119855795639, 299.4561494741031, 12.34512737629331, 91.91134944507901, 0.0, 220.16938299156743, 147.20156801023566, 324.36515586230536, 208.3845190930153, 422.67102861784525, 14.378312186243352, 131.77589675714592, 204.11510726296257, 37.09834015859682, 23.040568100431113, 9.609148709047693, 202.04074472271756, 447.74503259903616, 182.7934277013485, 142.2972587565956, 113.12827039463778, 60.93312844309956, 250.13995390387504, 285.20675782961086, 3.719149745896684, 308.4798727743439, 225.38424634185114, 10.738375281357097, 100.90054769764865, 235.54529065172122, 86.98567324054707, 89.80608808945156, 206.69296082571438, 9.936741441431687, 25.551063316936858, 333.5613309802696, 113.14877779751586, 321.6410246027652, 17.721495590043055, 94.66134498763275, 163.02109037871696, 139.76558333357548, 12.530851376110915, 86.81872761223538, 299.4339317030106, 242.68758122065177, 114.78261602865952, 288.9570864409791, 28.445130651791693, 219.6723870556631, 73.34964920953514, 13.473204474531883, 52.375651533928995, 204.5838804190519, 135.72180217277426, 77.6255519960216, 4.821711949484616, 221.03934949498299, 70.57917145707697, 436.2915922648884, 215.6228082068912, 68.23259355319007, 257.25918125564755, 25.488508119518865, 106.78195584863711, 11.922055797449719, 12.064961184003433, 42.547432604020194, 488.62304942652844, 288.64266442421683, 225.906609669909, 96.36542942545704, 241.56167699117194, 277.0269244802596, 217.07845435828256, 32.286055844126665, 158.38170612070147, 132.00608833564215, 9.733312997066115, 55.28575608639743, 122.86742674775486, 101.28991003263077, 15.111268392297816, 6.928172499781732, 216.43580165410884, 48.502680839127734, 41.350911812832976, 41.9086627102947, 78.70089894536923, 152.70980282913433, 12.67435603242669, 34.025569243846775, 21.61136799568832, 3.023520811841607, 61.56745302128209, 54.10560678454206, 94.11427512393487, 24.517894488509615, 46.79221992739831, 3.362740694498478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8116699723779007, "mean_inference_ms": 2.2857328807157886, "mean_action_processing_ms": 0.3504184619984153, "mean_env_wait_ms": 0.28617083816630867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00653839111328125, "StateBufferConnector_ms": 0.003380298614501953, "ViewRequirementAgentConnector_ms": 0.13225138187408447}, "num_episodes": 18, "episode_return_max": 340.21, "episode_return_min": -123.98706237381764, "episode_return_mean": 112.28947884442621, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.78343726221667, "num_env_steps_trained_throughput_per_sec": 255.78343726221667, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14620.056, "restore_workers_time_ms": 0.057, "training_step_time_ms": 14619.92, "sample_time_ms": 1862.985, "learn_time_ms": 12738.348, "learn_throughput": 314.012, "synch_weights_time_ms": 16.329}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "6c58f_00000", "date": "2024-08-16_16-09-36", "timestamp": 1723804776, "time_this_iter_s": 15.68692684173584, "time_total_s": 160.62223649024963, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 160.62223649024963, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.86363636363637, "ram_util_percent": 82.29999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0681434115720174, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 2.153419308750718, "policy_loss": -0.004708765055639324, "vf_loss": 2.1577626979540265, "vf_explained_var": 0.0017608492147354853, "kl": 0.014614944395270899, "entropy": 1.5850922091297373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7729280774240141, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.948930828155033, "policy_loss": -0.0036745294730213506, "vf_loss": 7.952542200542632, "vf_explained_var": 0.0966863369815564, "kl": 0.01010802078875941, "entropy": 1.587789006775649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 340.21, "episode_reward_min": -123.98706237381764, "episode_reward_mean": 123.14568971533132, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -447.1450325990366, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.18608079005762, "predator_policy": 488.62304942652844}, "policy_reward_mean": {"prey_policy": -46.404042973032546, "predator_policy": 107.97688783069817}, "custom_metrics": {}, "hist_stats": {"episode_reward": [208.8599999999983, 172.3500000000004, 120.89000000000033, 71.47591023333959, 172.0299999999997, 36.809999999999995, 46.27999999999996, 60.74661470249764, 132.07999999999976, 31.87245784942603, 115.30000000000081, 11.329999999999968, 207.14999999999998, 12.016520285344367, 80.1755716654859, 123.7335167194107, 10.816821220571557, 144.36808365872128, 121.09000000000029, 50.899961394787745, 84.19000000000031, 8.46999999999996, 174.82999999999987, 106.35056565573666, 174.65705221106796, 51.84999999999993, 152.59478587417806, 56.022429350830194, 238.24, 96.17712733631636, 85.0913883568158, 180.32442657392085, -5.154107815179384, 115.21000000000043, 102.90000000000012, 16.63999999999998, -81.25674557315608, 229.7476035337691, -4.546798726100134, 231.48000000000016, 1.5899999999999945, 111.17713447902034, 230.35155896391979, 70.56310758581822, 65.08277390617228, 131.45934200297276, 149.92909457330393, 209.06999999999968, 152.25619161752434, -123.98706237381764, 170.52751745493364, 170.7499999999996, -8.547070557957705, 209.5066712235098, 163.68939467156028, 79.99469971435563, 98.49213118877873, 179.59999999999968, 45.19999999999985, 175.92925572626515, 89.94000000000005, 69.05548354853067, 180.88000000000002, -9.016606357455416, 278.28854213499613, 142.12999999999982, -50.25813574255122, 176.35115893583938, 6.543412807449256, 11.543042110760837, 183.53621138328998, 255.00999999999962, 163.20624149660466, 329.52, 207.92015173681705, 340.21, 171.69729884305303, 141.22999999999996, 319.6399999999999, 229.2734652585499, 45.78999999999972, 318.5699999999999, 111.17560916417959, 141.98000000000036, 252.69433209580603, 93.80000000000035, 111.84000000000017, 190.11999999999944, 149.09999999999943, 58.249999999999616, 260.37895931688956, 156.13000000000034, 277.68660260318717, 179.54257894573826, 18.31000000000021, 61.85999999999995, 163.24999999999977, 4.349999999999994, 127.03269856730283, 129.28000000000077], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.47332369381574, 132.6105913904767, -77.11905138449771, 118.07155013431831, -60.09957236238448, -18.85316804322444, -293.11402654060987, 32.082741192538, 148.0896314014605, -5.982155335777932, -5.235116777795948, -79.91170279572677, 15.782765638004356, -222.98301520609783, -25.335717346325943, -64.70913038693354, -66.2696851056932, 93.72403185900774, -18.51439534241071, -139.8580991390521, 63.690260086893296, -43.50924141804343, -127.2503321832757, -5.018819540543188, 127.73000000000037, -44.34559700979763, -11.119740048259107, -36.7542763078764, -28.94283781317545, -128.57051211067247, 100.00999999999999, -77.41250090401847, -277.96810125238613, -63.51725951210768, 76.46599682764145, -69.31756886941054, 19.51343613380171, 26.758041746534598, -37.05286718169216, 5.849377040797339, -48.59314220019905, 9.235819308137398, -131.02726539144308, -191.71740876395933, 127.8863440054299, -6.463399638375435, -242.64259083837442, -98.82057268407392, -23.80696982597988, -200.18332155373187, -40.55109849699797, -43.24019026853029, 50.26494156589163, -130.886772863739, 33.46473084955493, -146.60240746217568, -18.39161651070627, -10.645854534465833, 69.32000000000012, -153.40452371944244, 1.0107071396486265, -202.9307617248742, -122.7403601872586, -121.07827330120618, -101.98140281692618, -268.3600530303118, 18.27521597401939, -7.321692795391732, 59.41999999999973, -176.6893829915677, -146.01156801023504, -308.91515586230577, -421.0072840913874, -291.30500919262903, -7.281055244836743, 90.87444983521725, -105.07284233518395, -140.68740381247576, 91.24026420467023, 107.59001898585078, -201.05074472271798, -447.1450325990366, -78.86190019206758, -135.05165178685647, 81.11599226341454, -24.825832137231465, -289.65129545480426, -175.13230869286366, 57.252896931223056, -304.3691455452912, -119.99961281287064, 15.336333192634182, -40.19703195014429, -146.3197118259219, -32.08567324054721, 64.36391191054847, 64.59056213331323, -128.96407278293486, -292.2260446247115, -190.87341204631485, 71.89955353086849, -336.16183847621625, 18.75850440995704, 39.60865501236728, -268.70719774328234, -42.626546526968674, 24.022851790121248, 86.1342404450424, -377.47444223335503, -0.9576760187467812, -289.82659420867276, -33.918408546610344, 68.94286572384169, -218.56825224251872, -28.310798192194028, 121.08794450812714, -196.3958244916101, -15.363707461370549, 4.30458095115599, -41.722679393686505, -1.8817119494846164, -134.03934949498304, -50.51560779104608, -387.2996723823892, -115.75027003114153, 12.77486827106061, -265.1919298048175, -26.572365927804107, 91.04275838665146, 68.54177210225816, 75.16612727427251, 12.351478937704176, -426.6839600755458, -400.8398895177506, 141.89951220295745, -287.82039236248403, -133.83978261359405, -378.2054060503898, -74.62739162629032, -163.1940764653573, -64.57387327525753, -42.277709797795744, 116.24075037974089, 73.75018053679571, 90.05269439458907, -151.00378967837037, 136.29447831786283, 171.18608079005762, 25.099281165429105, -82.11761192184876, 128.3920151089978, 128.5584103678745, 19.171921081766563, -78.88532401321712, 74.36564396757329, 20.16443075615326, 129.7386320043117, 165.26647918815837, 105.45747757241458, 8.142927880311479, -88.60653039592832, 15.764360783484596, 128.23778007260165, 140.1772593055016, 3.7282674168929546, -114.94139974886907, -45.24637137461378, 62.997351167642556, 53.839087085592, 64.27192419537936, 24.08774388131379, -6.699066237833209, -61.038239126569906, -25.827860850321432, 132.68000000000006, 57.43999999999972, 59.298043058219164, -3.2795603393711534, 7.279765865286446, 12.227794606850226, 8.746818053677462, 79.87615938193942, -31.4199471073012, 94.65609100578314, 126.29011137680091, 88.10715861403875, -4.454343452758037, -5.478295711813271, 9.707108207471476, -331.11863996694035, -89.63523180329832, 51.99138941764112, -155.5413240514008, 101.49701131646212, -20.571346928205767, -279.5948999847723, 78.2727774776393, -16.263374230139036, 75.77815210043269, -15.323949394602224], "policy_predator_policy_reward": [8.726676306184814, 1.0494086095227584, 103.0590513844981, 28.33844986568171, 133.77957236238402, 66.06316804322428, 23.38829446527287, 309.11890111613883, 2.169585685970169, 27.752938248347064, 43.251123650789914, 78.70569592273334, 89.35616865171693, 164.12408091637639, 66.12232074241665, 84.66914169334123, 92.5196851056937, 12.105968140992509, 107.01619999947536, 83.22875233141305, 49.9297399131066, 45.189241418043096, 134.69033218327453, 8.90881954054315, 0.0, 123.7655970097978, 51.30773253074404, 8.582804110735559, 199.12492705583026, 38.563994533503035, 12.4745975923055, 88.661420031124, 65.67174429646276, 286.6304376886027, 11.392832892669084, 125.8268228078222, 18.39594714917047, 56.42257497049344, 75.14988799237547, 6.953563543306598, 97.63790380013799, 25.90941909192365, 325.4152744299705, 5.799399725430577, 13.339211649492064, 40.067843983453244, 300.3231564941109, 147.49057268407432, 201.88768770684052, 196.75965588394004, 63.17109849699765, 72.4701902685301, 195.52047943821742, 37.69613773380712, 95.56618270289287, 73.5939232605578, 159.81269136553516, 107.46477967963686, 69.52541038396488, 110.7362406717932, 51.41084952233944, 235.60059341970165, 233.15163035368232, 190.9914297087027, 65.73119855795639, 299.4561494741031, 12.34512737629331, 91.91134944507901, 0.0, 220.16938299156743, 147.20156801023566, 324.36515586230536, 208.3845190930153, 422.67102861784525, 14.378312186243352, 131.77589675714592, 204.11510726296257, 37.09834015859682, 23.040568100431113, 9.609148709047693, 202.04074472271756, 447.74503259903616, 182.7934277013485, 142.2972587565956, 113.12827039463778, 60.93312844309956, 250.13995390387504, 285.20675782961086, 3.719149745896684, 308.4798727743439, 225.38424634185114, 10.738375281357097, 100.90054769764865, 235.54529065172122, 86.98567324054707, 89.80608808945156, 206.69296082571438, 9.936741441431687, 25.551063316936858, 333.5613309802696, 113.14877779751586, 321.6410246027652, 17.721495590043055, 94.66134498763275, 163.02109037871696, 139.76558333357548, 12.530851376110915, 86.81872761223538, 299.4339317030106, 242.68758122065177, 114.78261602865952, 288.9570864409791, 28.445130651791693, 219.6723870556631, 73.34964920953514, 13.473204474531883, 52.375651533928995, 204.5838804190519, 135.72180217277426, 77.6255519960216, 4.821711949484616, 221.03934949498299, 70.57917145707697, 436.2915922648884, 215.6228082068912, 68.23259355319007, 257.25918125564755, 25.488508119518865, 106.78195584863711, 11.922055797449719, 12.064961184003433, 42.547432604020194, 488.62304942652844, 288.64266442421683, 225.906609669909, 96.36542942545704, 241.56167699117194, 277.0269244802596, 217.07845435828256, 32.286055844126665, 158.38170612070147, 132.00608833564215, 9.733312997066115, 55.28575608639743, 122.86742674775486, 101.28991003263077, 15.111268392297816, 6.928172499781732, 216.43580165410884, 48.502680839127734, 41.350911812832976, 41.9086627102947, 78.70089894536923, 152.70980282913433, 12.67435603242669, 34.025569243846775, 21.61136799568832, 3.023520811841607, 61.56745302128209, 54.10560678454206, 94.11427512393487, 24.517894488509615, 46.79221992739831, 3.362740694498478, 142.36317163422578, 80.02556986192994, 96.26637137461421, 27.962648832357253, 27.22474391775288, 107.35857689708233, 14.887050336322485, 61.52427202019679, 138.57439621761796, 60.13170375927361, 0.0, 0.0, 79.01286222595887, 14.068655055193009, 30.230234134713527, 8.512205393149737, 127.40908198161836, 44.346899899654666, 39.18994710730101, 53.70390899421684, 37.98356374353946, 25.305768868808748, 1.2468583238989592, 188.22835978641112, 8.052891792528488, 331.6686399669399, 96.07523180329858, 3.4286105823588406, 179.4513240514, 37.842988683538024, 70.44255277350588, 234.07369413947237, 10.774881638226255, 54.248413681576395, 6.351847899567355, 62.47394939460228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8134796806982658, "mean_inference_ms": 2.325912902316549, "mean_action_processing_ms": 0.3488467737040162, "mean_env_wait_ms": 0.28788680195833627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006641268730163574, "StateBufferConnector_ms": 0.0034722089767456055, "ViewRequirementAgentConnector_ms": 0.14788973331451416}, "num_episodes": 18, "episode_return_max": 340.21, "episode_return_min": -123.98706237381764, "episode_return_mean": 123.14568971533132, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.47529423819466, "num_env_steps_trained_throughput_per_sec": 251.47529423819466, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14831.165, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14831.111, "sample_time_ms": 1817.549, "learn_time_ms": 12994.301, "learn_throughput": 307.827, "synch_weights_time_ms": 16.815}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "6c58f_00000", "date": "2024-08-16_16-09-52", "timestamp": 1723804792, "time_this_iter_s": 15.960546016693115, "time_total_s": 176.58278250694275, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 176.58278250694275, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 59.92608695652175, "ram_util_percent": 82.45652173913044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.094291540980339, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 3.9405139945802237, "policy_loss": -0.0057877217882642985, "vf_loss": 3.945963445668498, "vf_explained_var": 0.0070079251887306335, "kl": 0.013531097055668496, "entropy": 1.5950422120472743, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.608177306633147, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.052783479387799, "policy_loss": -0.0018422445614955255, "vf_loss": 9.054587549381155, "vf_explained_var": 0.04147906334942611, "kl": 0.006107958454749088, "entropy": 1.5655085301273084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 344.2799999999998, "episode_reward_min": -123.98706237381764, "episode_reward_mean": 143.63631952596737, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -447.1450325990366, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.18608079005762, "predator_policy": 488.62304942652844}, "policy_reward_mean": {"prey_policy": -33.61863504018407, "predator_policy": 105.43679480316776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.09000000000029, 50.899961394787745, 84.19000000000031, 8.46999999999996, 174.82999999999987, 106.35056565573666, 174.65705221106796, 51.84999999999993, 152.59478587417806, 56.022429350830194, 238.24, 96.17712733631636, 85.0913883568158, 180.32442657392085, -5.154107815179384, 115.21000000000043, 102.90000000000012, 16.63999999999998, -81.25674557315608, 229.7476035337691, -4.546798726100134, 231.48000000000016, 1.5899999999999945, 111.17713447902034, 230.35155896391979, 70.56310758581822, 65.08277390617228, 131.45934200297276, 149.92909457330393, 209.06999999999968, 152.25619161752434, -123.98706237381764, 170.52751745493364, 170.7499999999996, -8.547070557957705, 209.5066712235098, 163.68939467156028, 79.99469971435563, 98.49213118877873, 179.59999999999968, 45.19999999999985, 175.92925572626515, 89.94000000000005, 69.05548354853067, 180.88000000000002, -9.016606357455416, 278.28854213499613, 142.12999999999982, -50.25813574255122, 176.35115893583938, 6.543412807449256, 11.543042110760837, 183.53621138328998, 255.00999999999962, 163.20624149660466, 329.52, 207.92015173681705, 340.21, 171.69729884305303, 141.22999999999996, 319.6399999999999, 229.2734652585499, 45.78999999999972, 318.5699999999999, 111.17560916417959, 141.98000000000036, 252.69433209580603, 93.80000000000035, 111.84000000000017, 190.11999999999944, 149.09999999999943, 58.249999999999616, 260.37895931688956, 156.13000000000034, 277.68660260318717, 179.54257894573826, 18.31000000000021, 61.85999999999995, 163.24999999999977, 4.349999999999994, 127.03269856730283, 129.28000000000077, 194.45000000000027, 195.6800000000001, 64.03999999999994, 241.80999999999983, 258.37819077727073, 291.3099999999998, 175.06988474542703, 344.2799999999998, 162.95188118510157, 257.5165520812213, 75.56159509914362, 178.51000000000028, 245.64375289905803, 188.1199999999996, 112.53000000000071, 265.95999999999975, 255.97662061118086, 299.55999999999966], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.51343613380171, 26.758041746534598, -37.05286718169216, 5.849377040797339, -48.59314220019905, 9.235819308137398, -131.02726539144308, -191.71740876395933, 127.8863440054299, -6.463399638375435, -242.64259083837442, -98.82057268407392, -23.80696982597988, -200.18332155373187, -40.55109849699797, -43.24019026853029, 50.26494156589163, -130.886772863739, 33.46473084955493, -146.60240746217568, -18.39161651070627, -10.645854534465833, 69.32000000000012, -153.40452371944244, 1.0107071396486265, -202.9307617248742, -122.7403601872586, -121.07827330120618, -101.98140281692618, -268.3600530303118, 18.27521597401939, -7.321692795391732, 59.41999999999973, -176.6893829915677, -146.01156801023504, -308.91515586230577, -421.0072840913874, -291.30500919262903, -7.281055244836743, 90.87444983521725, -105.07284233518395, -140.68740381247576, 91.24026420467023, 107.59001898585078, -201.05074472271798, -447.1450325990366, -78.86190019206758, -135.05165178685647, 81.11599226341454, -24.825832137231465, -289.65129545480426, -175.13230869286366, 57.252896931223056, -304.3691455452912, -119.99961281287064, 15.336333192634182, -40.19703195014429, -146.3197118259219, -32.08567324054721, 64.36391191054847, 64.59056213331323, -128.96407278293486, -292.2260446247115, -190.87341204631485, 71.89955353086849, -336.16183847621625, 18.75850440995704, 39.60865501236728, -268.70719774328234, -42.626546526968674, 24.022851790121248, 86.1342404450424, -377.47444223335503, -0.9576760187467812, -289.82659420867276, -33.918408546610344, 68.94286572384169, -218.56825224251872, -28.310798192194028, 121.08794450812714, -196.3958244916101, -15.363707461370549, 4.30458095115599, -41.722679393686505, -1.8817119494846164, -134.03934949498304, -50.51560779104608, -387.2996723823892, -115.75027003114153, 12.77486827106061, -265.1919298048175, -26.572365927804107, 91.04275838665146, 68.54177210225816, 75.16612727427251, 12.351478937704176, -426.6839600755458, -400.8398895177506, 141.89951220295745, -287.82039236248403, -133.83978261359405, -378.2054060503898, -74.62739162629032, -163.1940764653573, -64.57387327525753, -42.277709797795744, 116.24075037974089, 73.75018053679571, 90.05269439458907, -151.00378967837037, 136.29447831786283, 171.18608079005762, 25.099281165429105, -82.11761192184876, 128.3920151089978, 128.5584103678745, 19.171921081766563, -78.88532401321712, 74.36564396757329, 20.16443075615326, 129.7386320043117, 165.26647918815837, 105.45747757241458, 8.142927880311479, -88.60653039592832, 15.764360783484596, 128.23778007260165, 140.1772593055016, 3.7282674168929546, -114.94139974886907, -45.24637137461378, 62.997351167642556, 53.839087085592, 64.27192419537936, 24.08774388131379, -6.699066237833209, -61.038239126569906, -25.827860850321432, 132.68000000000006, 57.43999999999972, 59.298043058219164, -3.2795603393711534, 7.279765865286446, 12.227794606850226, 8.746818053677462, 79.87615938193942, -31.4199471073012, 94.65609100578314, 126.29011137680091, 88.10715861403875, -4.454343452758037, -5.478295711813271, 9.707108207471476, -331.11863996694035, -89.63523180329832, 51.99138941764112, -155.5413240514008, 101.49701131646212, -20.571346928205767, -279.5948999847723, 78.2727774776393, -16.263374230139036, 75.77815210043269, -15.323949394602224, 29.147136879148043, 25.209986520975228, 99.82122285552005, 51.730113136218876, 47.13671982882583, -50.01813669317616, 88.90428960890725, 44.38200858839643, 68.96889868511492, 140.51298711087333, 122.99722619477969, 31.102648625412744, -404.39150858949733, 78.6080053675689, 166.04353324524118, 124.79407202487297, -3.613037040794868, 64.26253333286772, 14.976961900202213, 41.834446475748145, -11.39145566259399, 9.927270012578425, 97.74568207502219, -42.576524221235374, 102.05033884527515, 111.63910156824547, 81.47507673291332, -81.43738903904051, 26.350617776449724, -7.937753004263119, 107.23449284023387, 75.9755674357921, -38.38595486448071, 106.91106293899443, 119.80932794777539, 100.30128661888409], "policy_predator_policy_reward": [18.39594714917047, 56.42257497049344, 75.14988799237547, 6.953563543306598, 97.63790380013799, 25.90941909192365, 325.4152744299705, 5.799399725430577, 13.339211649492064, 40.067843983453244, 300.3231564941109, 147.49057268407432, 201.88768770684052, 196.75965588394004, 63.17109849699765, 72.4701902685301, 195.52047943821742, 37.69613773380712, 95.56618270289287, 73.5939232605578, 159.81269136553516, 107.46477967963686, 69.52541038396488, 110.7362406717932, 51.41084952233944, 235.60059341970165, 233.15163035368232, 190.9914297087027, 65.73119855795639, 299.4561494741031, 12.34512737629331, 91.91134944507901, 0.0, 220.16938299156743, 147.20156801023566, 324.36515586230536, 208.3845190930153, 422.67102861784525, 14.378312186243352, 131.77589675714592, 204.11510726296257, 37.09834015859682, 23.040568100431113, 9.609148709047693, 202.04074472271756, 447.74503259903616, 182.7934277013485, 142.2972587565956, 113.12827039463778, 60.93312844309956, 250.13995390387504, 285.20675782961086, 3.719149745896684, 308.4798727743439, 225.38424634185114, 10.738375281357097, 100.90054769764865, 235.54529065172122, 86.98567324054707, 89.80608808945156, 206.69296082571438, 9.936741441431687, 25.551063316936858, 333.5613309802696, 113.14877779751586, 321.6410246027652, 17.721495590043055, 94.66134498763275, 163.02109037871696, 139.76558333357548, 12.530851376110915, 86.81872761223538, 299.4339317030106, 242.68758122065177, 114.78261602865952, 288.9570864409791, 28.445130651791693, 219.6723870556631, 73.34964920953514, 13.473204474531883, 52.375651533928995, 204.5838804190519, 135.72180217277426, 77.6255519960216, 4.821711949484616, 221.03934949498299, 70.57917145707697, 436.2915922648884, 215.6228082068912, 68.23259355319007, 257.25918125564755, 25.488508119518865, 106.78195584863711, 11.922055797449719, 12.064961184003433, 42.547432604020194, 488.62304942652844, 288.64266442421683, 225.906609669909, 96.36542942545704, 241.56167699117194, 277.0269244802596, 217.07845435828256, 32.286055844126665, 158.38170612070147, 132.00608833564215, 9.733312997066115, 55.28575608639743, 122.86742674775486, 101.28991003263077, 15.111268392297816, 6.928172499781732, 216.43580165410884, 48.502680839127734, 41.350911812832976, 41.9086627102947, 78.70089894536923, 152.70980282913433, 12.67435603242669, 34.025569243846775, 21.61136799568832, 3.023520811841607, 61.56745302128209, 54.10560678454206, 94.11427512393487, 24.517894488509615, 46.79221992739831, 3.362740694498478, 142.36317163422578, 80.02556986192994, 96.26637137461421, 27.962648832357253, 27.22474391775288, 107.35857689708233, 14.887050336322485, 61.52427202019679, 138.57439621761796, 60.13170375927361, 0.0, 0.0, 79.01286222595887, 14.068655055193009, 30.230234134713527, 8.512205393149737, 127.40908198161836, 44.346899899654666, 39.18994710730101, 53.70390899421684, 37.98356374353946, 25.305768868808748, 1.2468583238989592, 188.22835978641112, 8.052891792528488, 331.6686399669399, 96.07523180329858, 3.4286105823588406, 179.4513240514, 37.842988683538024, 70.44255277350588, 234.07369413947237, 10.774881638226255, 54.248413681576395, 6.351847899567355, 62.47394939460228, 46.74286312085196, 93.35001347902495, 5.088777144480267, 39.03988686378102, 11.203280171174136, 55.71813669317582, 14.60905413670914, 93.9146476659873, 29.622654000589055, 19.273650980695123, 119.00937726090501, 18.200747918902632, 75.23554594945527, 425.61784201790005, 5.196466754758913, 48.24592797512702, 40.807597633077435, 61.49478725995131, 168.9738575101372, 31.73128619513403, 21.286770827116406, 55.7390099220426, 11.416759394004819, 111.92408275220895, 23.39977709343205, 8.554535392106382, 4.609411505032762, 183.47290080109468, 78.30938222355023, 15.807753004263079, 68.76550715976613, 13.984432564207786, 116.25740815024247, 71.19410438642471, 42.35067205222458, 37.0987133811161]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8165021634216153, "mean_inference_ms": 2.3662781662639976, "mean_action_processing_ms": 0.34866252567944256, "mean_env_wait_ms": 0.29043289262964594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006650209426879883, "StateBufferConnector_ms": 0.0034499168395996094, "ViewRequirementAgentConnector_ms": 0.1413947343826294}, "num_episodes": 18, "episode_return_max": 344.2799999999998, "episode_return_min": -123.98706237381764, "episode_return_mean": 143.63631952596737, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.25037964634583, "num_env_steps_trained_throughput_per_sec": 263.25037964634583, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14943.687, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14943.633, "sample_time_ms": 1791.51, "learn_time_ms": 13132.605, "learn_throughput": 304.585, "synch_weights_time_ms": 17.049}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "6c58f_00000", "date": "2024-08-16_16-10-07", "timestamp": 1723804807, "time_this_iter_s": 15.241277933120728, "time_total_s": 191.82406044006348, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 191.82406044006348, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 61.036363636363646, "ram_util_percent": 82.7909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2425227463087707, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 6.412703182836058, "policy_loss": -0.0056252658564262285, "vf_loss": 6.417925569493935, "vf_explained_var": 0.002599854664827781, "kl": 0.016115429187937704, "entropy": 1.565823992976436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8375512718523621, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.877561207927725, "policy_loss": -0.006877167096543841, "vf_loss": 8.884333029752055, "vf_explained_var": 0.040789813465542266, "kl": 0.016856759322400137, "entropy": 1.538277769530261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 344.2799999999998, "episode_reward_min": -123.98706237381764, "episode_reward_mean": 157.50857360528147, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.6839600755458, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.18608079005762, "predator_policy": 488.62304942652844}, "policy_reward_mean": {"prey_policy": -25.469062126608183, "predator_policy": 104.22334892924893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.45934200297276, 149.92909457330393, 209.06999999999968, 152.25619161752434, -123.98706237381764, 170.52751745493364, 170.7499999999996, -8.547070557957705, 209.5066712235098, 163.68939467156028, 79.99469971435563, 98.49213118877873, 179.59999999999968, 45.19999999999985, 175.92925572626515, 89.94000000000005, 69.05548354853067, 180.88000000000002, -9.016606357455416, 278.28854213499613, 142.12999999999982, -50.25813574255122, 176.35115893583938, 6.543412807449256, 11.543042110760837, 183.53621138328998, 255.00999999999962, 163.20624149660466, 329.52, 207.92015173681705, 340.21, 171.69729884305303, 141.22999999999996, 319.6399999999999, 229.2734652585499, 45.78999999999972, 318.5699999999999, 111.17560916417959, 141.98000000000036, 252.69433209580603, 93.80000000000035, 111.84000000000017, 190.11999999999944, 149.09999999999943, 58.249999999999616, 260.37895931688956, 156.13000000000034, 277.68660260318717, 179.54257894573826, 18.31000000000021, 61.85999999999995, 163.24999999999977, 4.349999999999994, 127.03269856730283, 129.28000000000077, 194.45000000000027, 195.6800000000001, 64.03999999999994, 241.80999999999983, 258.37819077727073, 291.3099999999998, 175.06988474542703, 344.2799999999998, 162.95188118510157, 257.5165520812213, 75.56159509914362, 178.51000000000028, 245.64375289905803, 188.1199999999996, 112.53000000000071, 265.95999999999975, 255.97662061118086, 299.55999999999966, 31.050402699522866, 139.5852880012671, 216.35205852248706, 129.82946350467378, 144.15000000000043, 144.79393103080588, 186.8299999999996, 180.7472775137673, 197.80794595583131, 96.68999999999997, 48.23007030304751, 138.0700000000005, 106.72000000000017, 223.1676266982108, 48.129999999999974, 290.0799999999999, 156.78137708012892, 171.61607480005387, 225.86026888789888, 169.25999999999956, 125.78000000000013, 112.51000000000016, 272.3275736860347, 75.91986407178231, 145.44195499062315, 142.25649329319504, 131.81000000000012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-119.99961281287064, 15.336333192634182, -40.19703195014429, -146.3197118259219, -32.08567324054721, 64.36391191054847, 64.59056213331323, -128.96407278293486, -292.2260446247115, -190.87341204631485, 71.89955353086849, -336.16183847621625, 18.75850440995704, 39.60865501236728, -268.70719774328234, -42.626546526968674, 24.022851790121248, 86.1342404450424, -377.47444223335503, -0.9576760187467812, -289.82659420867276, -33.918408546610344, 68.94286572384169, -218.56825224251872, -28.310798192194028, 121.08794450812714, -196.3958244916101, -15.363707461370549, 4.30458095115599, -41.722679393686505, -1.8817119494846164, -134.03934949498304, -50.51560779104608, -387.2996723823892, -115.75027003114153, 12.77486827106061, -265.1919298048175, -26.572365927804107, 91.04275838665146, 68.54177210225816, 75.16612727427251, 12.351478937704176, -426.6839600755458, -400.8398895177506, 141.89951220295745, -287.82039236248403, -133.83978261359405, -378.2054060503898, -74.62739162629032, -163.1940764653573, -64.57387327525753, -42.277709797795744, 116.24075037974089, 73.75018053679571, 90.05269439458907, -151.00378967837037, 136.29447831786283, 171.18608079005762, 25.099281165429105, -82.11761192184876, 128.3920151089978, 128.5584103678745, 19.171921081766563, -78.88532401321712, 74.36564396757329, 20.16443075615326, 129.7386320043117, 165.26647918815837, 105.45747757241458, 8.142927880311479, -88.60653039592832, 15.764360783484596, 128.23778007260165, 140.1772593055016, 3.7282674168929546, -114.94139974886907, -45.24637137461378, 62.997351167642556, 53.839087085592, 64.27192419537936, 24.08774388131379, -6.699066237833209, -61.038239126569906, -25.827860850321432, 132.68000000000006, 57.43999999999972, 59.298043058219164, -3.2795603393711534, 7.279765865286446, 12.227794606850226, 8.746818053677462, 79.87615938193942, -31.4199471073012, 94.65609100578314, 126.29011137680091, 88.10715861403875, -4.454343452758037, -5.478295711813271, 9.707108207471476, -331.11863996694035, -89.63523180329832, 51.99138941764112, -155.5413240514008, 101.49701131646212, -20.571346928205767, -279.5948999847723, 78.2727774776393, -16.263374230139036, 75.77815210043269, -15.323949394602224, 29.147136879148043, 25.209986520975228, 99.82122285552005, 51.730113136218876, 47.13671982882583, -50.01813669317616, 88.90428960890725, 44.38200858839643, 68.96889868511492, 140.51298711087333, 122.99722619477969, 31.102648625412744, -404.39150858949733, 78.6080053675689, 166.04353324524118, 124.79407202487297, -3.613037040794868, 64.26253333286772, 14.976961900202213, 41.834446475748145, -11.39145566259399, 9.927270012578425, 97.74568207502219, -42.576524221235374, 102.05033884527515, 111.63910156824547, 81.47507673291332, -81.43738903904051, 26.350617776449724, -7.937753004263119, 107.23449284023387, 75.9755674357921, -38.38595486448071, 106.91106293899443, 119.80932794777539, 100.30128661888409, -219.56436538742992, -266.1154176084936, -89.05910442137007, -84.56082520649767, -23.931036651871178, 108.53105911179453, -102.80073238419175, -139.32480700534796, -126.43475171694759, -7.782747099003192, 32.30020604516265, -50.192501326527484, -73.96644589290136, -67.85978455984879, -111.28062360438548, -60.642800213162076, -28.391343006810793, -59.1803858339013, -184.4324106752679, -112.3694531222416, -152.00146398856296, -108.80448017860984, -61.42214677168994, 88.62809966174905, -214.87418361347727, 81.63651502615167, -4.82125847356626, 3.510697435509222, -310.6604674097084, -21.96562988192856, 159.5325686930094, 127.60216049409904, -21.27652623404463, -66.73015292470281, 126.86780277238215, -142.51834076741486, 25.77044056915494, 65.99019777921995, 5.225036881329553, -54.75585358835189, 30.86134392415064, -125.38302481458604, -208.01920137880458, 10.933880097810603, 130.5698840955177, 98.49493578488148, -267.33345856249167, -186.28589665731198, -79.36595510070434, 3.185661232860335, -55.029518207860484, -149.5493136915996, 45.4181374618027, -228.88555886694795], "policy_predator_policy_reward": [225.38424634185114, 10.738375281357097, 100.90054769764865, 235.54529065172122, 86.98567324054707, 89.80608808945156, 206.69296082571438, 9.936741441431687, 25.551063316936858, 333.5613309802696, 113.14877779751586, 321.6410246027652, 17.721495590043055, 94.66134498763275, 163.02109037871696, 139.76558333357548, 12.530851376110915, 86.81872761223538, 299.4339317030106, 242.68758122065177, 114.78261602865952, 288.9570864409791, 28.445130651791693, 219.6723870556631, 73.34964920953514, 13.473204474531883, 52.375651533928995, 204.5838804190519, 135.72180217277426, 77.6255519960216, 4.821711949484616, 221.03934949498299, 70.57917145707697, 436.2915922648884, 215.6228082068912, 68.23259355319007, 257.25918125564755, 25.488508119518865, 106.78195584863711, 11.922055797449719, 12.064961184003433, 42.547432604020194, 488.62304942652844, 288.64266442421683, 225.906609669909, 96.36542942545704, 241.56167699117194, 277.0269244802596, 217.07845435828256, 32.286055844126665, 158.38170612070147, 132.00608833564215, 9.733312997066115, 55.28575608639743, 122.86742674775486, 101.28991003263077, 15.111268392297816, 6.928172499781732, 216.43580165410884, 48.502680839127734, 41.350911812832976, 41.9086627102947, 78.70089894536923, 152.70980282913433, 12.67435603242669, 34.025569243846775, 21.61136799568832, 3.023520811841607, 61.56745302128209, 54.10560678454206, 94.11427512393487, 24.517894488509615, 46.79221992739831, 3.362740694498478, 142.36317163422578, 80.02556986192994, 96.26637137461421, 27.962648832357253, 27.22474391775288, 107.35857689708233, 14.887050336322485, 61.52427202019679, 138.57439621761796, 60.13170375927361, 0.0, 0.0, 79.01286222595887, 14.068655055193009, 30.230234134713527, 8.512205393149737, 127.40908198161836, 44.346899899654666, 39.18994710730101, 53.70390899421684, 37.98356374353946, 25.305768868808748, 1.2468583238989592, 188.22835978641112, 8.052891792528488, 331.6686399669399, 96.07523180329858, 3.4286105823588406, 179.4513240514, 37.842988683538024, 70.44255277350588, 234.07369413947237, 10.774881638226255, 54.248413681576395, 6.351847899567355, 62.47394939460228, 46.74286312085196, 93.35001347902495, 5.088777144480267, 39.03988686378102, 11.203280171174136, 55.71813669317582, 14.60905413670914, 93.9146476659873, 29.622654000589055, 19.273650980695123, 119.00937726090501, 18.200747918902632, 75.23554594945527, 425.61784201790005, 5.196466754758913, 48.24592797512702, 40.807597633077435, 61.49478725995131, 168.9738575101372, 31.73128619513403, 21.286770827116406, 55.7390099220426, 11.416759394004819, 111.92408275220895, 23.39977709343205, 8.554535392106382, 4.609411505032762, 183.47290080109468, 78.30938222355023, 15.807753004263079, 68.76550715976613, 13.984432564207786, 116.25740815024247, 71.19410438642471, 42.35067205222458, 37.0987133811161, 67.9155048611357, 448.81468083431076, 227.5273372133095, 85.67788041582534, 75.97316048683913, 55.778875575724385, 183.30902874192594, 188.64597415228764, 173.11475171694752, 105.25274709900313, 150.62196800199226, 12.064258310178808, 189.0464458929013, 139.60978455984917, 155.52086894472615, 197.14983238658868, 35.88423712862723, 249.49543766791618, 205.95241067526769, 187.53945312224178, 252.93721926196505, 56.098795208254415, 76.50131445978238, 34.36273265015838, 35.82880417377539, 204.1288644135504, 111.61071618510839, 112.86747155115954, 356.9804674097082, 23.775629881928786, 0.8574313069905608, 2.0878395059009565, 112.9454190251234, 131.84263721375325, 3.588857147156676, 183.6777556479294, 52.123160764368436, 81.97646977515579, 61.814963118670356, 156.97585358835195, 53.25743297326519, 167.04424791717005, 278.17920137880463, 31.41611990218942, 35.25591256476065, 8.006841240875591, 240.09276710628308, 289.4464521853029, 6.892574785805582, 214.72967407266165, 251.21705552200146, 95.61826967065333, 54.12186253819722, 261.15555886694807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8188968677163636, "mean_inference_ms": 2.4185330478811427, "mean_action_processing_ms": 0.34915377886679755, "mean_env_wait_ms": 0.2929582458953618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006829619407653809, "StateBufferConnector_ms": 0.0034112930297851562, "ViewRequirementAgentConnector_ms": 0.12578153610229492}, "num_episodes": 27, "episode_return_max": 344.2799999999998, "episode_return_min": -123.98706237381764, "episode_return_mean": 157.50857360528147, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.8720495705771, "num_env_steps_trained_throughput_per_sec": 265.8720495705771, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 15083.833, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15083.778, "sample_time_ms": 1794.002, "learn_time_ms": 13269.726, "learn_throughput": 301.438, "synch_weights_time_ms": 17.583}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "6c58f_00000", "date": "2024-08-16_16-10-22", "timestamp": 1723804822, "time_this_iter_s": 15.096848011016846, "time_total_s": 206.92090845108032, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0503b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.92090845108032, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 60.3, "ram_util_percent": 82.28095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.327642396833531, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 4.107059015672673, "policy_loss": -0.004897833996201082, "vf_loss": 4.111592802294979, "vf_explained_var": 0.003166344304564138, "kl": 0.014561771942714784, "entropy": 1.552378488470007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9437680053017128, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.709145365568697, "policy_loss": -0.007080735934026066, "vf_loss": 8.71611979146483, "vf_explained_var": 0.1100842487875116, "kl": 0.01701273194012954, "entropy": 1.5577675152077246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 344.2799999999998, "episode_reward_min": -50.25813574255122, "episode_reward_mean": 170.49573495468084, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.6839600755458, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.18608079005762, "predator_policy": 488.62304942652844}, "policy_reward_mean": {"prey_policy": -7.772262711218315, "predator_policy": 93.02013018855881}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.016606357455416, 278.28854213499613, 142.12999999999982, -50.25813574255122, 176.35115893583938, 6.543412807449256, 11.543042110760837, 183.53621138328998, 255.00999999999962, 163.20624149660466, 329.52, 207.92015173681705, 340.21, 171.69729884305303, 141.22999999999996, 319.6399999999999, 229.2734652585499, 45.78999999999972, 318.5699999999999, 111.17560916417959, 141.98000000000036, 252.69433209580603, 93.80000000000035, 111.84000000000017, 190.11999999999944, 149.09999999999943, 58.249999999999616, 260.37895931688956, 156.13000000000034, 277.68660260318717, 179.54257894573826, 18.31000000000021, 61.85999999999995, 163.24999999999977, 4.349999999999994, 127.03269856730283, 129.28000000000077, 194.45000000000027, 195.6800000000001, 64.03999999999994, 241.80999999999983, 258.37819077727073, 291.3099999999998, 175.06988474542703, 344.2799999999998, 162.95188118510157, 257.5165520812213, 75.56159509914362, 178.51000000000028, 245.64375289905803, 188.1199999999996, 112.53000000000071, 265.95999999999975, 255.97662061118086, 299.55999999999966, 31.050402699522866, 139.5852880012671, 216.35205852248706, 129.82946350467378, 144.15000000000043, 144.79393103080588, 186.8299999999996, 180.7472775137673, 197.80794595583131, 96.68999999999997, 48.23007030304751, 138.0700000000005, 106.72000000000017, 223.1676266982108, 48.129999999999974, 290.0799999999999, 156.78137708012892, 171.61607480005387, 225.86026888789888, 169.25999999999956, 125.78000000000013, 112.51000000000016, 272.3275736860347, 75.91986407178231, 145.44195499062315, 142.25649329319504, 131.81000000000012, 220.23999999999972, 173.9700000000001, 158.5899999999998, 71.12623061243603, 227.54909093202536, 141.27000000000046, 253.58920448392917, 290.4099999999997, 248.4599999999993, 59.82999999999964, 172.92593862935752, 206.81791438771026, 329.35114688311864, 217.72056542354812, 151.04404631259055, 193.6699999999991, 288.566381609367, 37.33126445581846], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-265.1919298048175, -26.572365927804107, 91.04275838665146, 68.54177210225816, 75.16612727427251, 12.351478937704176, -426.6839600755458, -400.8398895177506, 141.89951220295745, -287.82039236248403, -133.83978261359405, -378.2054060503898, -74.62739162629032, -163.1940764653573, -64.57387327525753, -42.277709797795744, 116.24075037974089, 73.75018053679571, 90.05269439458907, -151.00378967837037, 136.29447831786283, 171.18608079005762, 25.099281165429105, -82.11761192184876, 128.3920151089978, 128.5584103678745, 19.171921081766563, -78.88532401321712, 74.36564396757329, 20.16443075615326, 129.7386320043117, 165.26647918815837, 105.45747757241458, 8.142927880311479, -88.60653039592832, 15.764360783484596, 128.23778007260165, 140.1772593055016, 3.7282674168929546, -114.94139974886907, -45.24637137461378, 62.997351167642556, 53.839087085592, 64.27192419537936, 24.08774388131379, -6.699066237833209, -61.038239126569906, -25.827860850321432, 132.68000000000006, 57.43999999999972, 59.298043058219164, -3.2795603393711534, 7.279765865286446, 12.227794606850226, 8.746818053677462, 79.87615938193942, -31.4199471073012, 94.65609100578314, 126.29011137680091, 88.10715861403875, -4.454343452758037, -5.478295711813271, 9.707108207471476, -331.11863996694035, -89.63523180329832, 51.99138941764112, -155.5413240514008, 101.49701131646212, -20.571346928205767, -279.5948999847723, 78.2727774776393, -16.263374230139036, 75.77815210043269, -15.323949394602224, 29.147136879148043, 25.209986520975228, 99.82122285552005, 51.730113136218876, 47.13671982882583, -50.01813669317616, 88.90428960890725, 44.38200858839643, 68.96889868511492, 140.51298711087333, 122.99722619477969, 31.102648625412744, -404.39150858949733, 78.6080053675689, 166.04353324524118, 124.79407202487297, -3.613037040794868, 64.26253333286772, 14.976961900202213, 41.834446475748145, -11.39145566259399, 9.927270012578425, 97.74568207502219, -42.576524221235374, 102.05033884527515, 111.63910156824547, 81.47507673291332, -81.43738903904051, 26.350617776449724, -7.937753004263119, 107.23449284023387, 75.9755674357921, -38.38595486448071, 106.91106293899443, 119.80932794777539, 100.30128661888409, -219.56436538742992, -266.1154176084936, -89.05910442137007, -84.56082520649767, -23.931036651871178, 108.53105911179453, -102.80073238419175, -139.32480700534796, -126.43475171694759, -7.782747099003192, 32.30020604516265, -50.192501326527484, -73.96644589290136, -67.85978455984879, -111.28062360438548, -60.642800213162076, -28.391343006810793, -59.1803858339013, -184.4324106752679, -112.3694531222416, -152.00146398856296, -108.80448017860984, -61.42214677168994, 88.62809966174905, -214.87418361347727, 81.63651502615167, -4.82125847356626, 3.510697435509222, -310.6604674097084, -21.96562988192856, 159.5325686930094, 127.60216049409904, -21.27652623404463, -66.73015292470281, 126.86780277238215, -142.51834076741486, 25.77044056915494, 65.99019777921995, 5.225036881329553, -54.75585358835189, 30.86134392415064, -125.38302481458604, -208.01920137880458, 10.933880097810603, 130.5698840955177, 98.49493578488148, -267.33345856249167, -186.28589665731198, -79.36595510070434, 3.185661232860335, -55.029518207860484, -149.5493136915996, 45.4181374618027, -228.88555886694795, 67.51701394105953, 54.671646168524056, -236.5785395692425, 141.90103809954152, 40.4210872542998, -30.765762464159117, -109.91415453270287, -272.76299888002256, 81.14268320079374, -32.240787398081444, -134.5146597328557, 60.92023153296339, 78.41396244449052, 50.596123196590185, 77.84188754400412, 110.7598079957291, 73.14046877715293, 168.20173715460373, -3.806599432695217, -16.46171443352962, 100.83237143230453, -96.32544338925081, 35.808448775811854, -27.173540193699274, 32.0834865544804, 150.5177937208393, 105.0225473657851, 56.44999999999984, -34.14358013725422, 122.15883094329598, 38.45858595223958, 95.96734564059743, -63.84596897126016, 89.47158495575542, -51.10036132931839, -81.66595369750033], "policy_predator_policy_reward": [257.25918125564755, 25.488508119518865, 106.78195584863711, 11.922055797449719, 12.064961184003433, 42.547432604020194, 488.62304942652844, 288.64266442421683, 225.906609669909, 96.36542942545704, 241.56167699117194, 277.0269244802596, 217.07845435828256, 32.286055844126665, 158.38170612070147, 132.00608833564215, 9.733312997066115, 55.28575608639743, 122.86742674775486, 101.28991003263077, 15.111268392297816, 6.928172499781732, 216.43580165410884, 48.502680839127734, 41.350911812832976, 41.9086627102947, 78.70089894536923, 152.70980282913433, 12.67435603242669, 34.025569243846775, 21.61136799568832, 3.023520811841607, 61.56745302128209, 54.10560678454206, 94.11427512393487, 24.517894488509615, 46.79221992739831, 3.362740694498478, 142.36317163422578, 80.02556986192994, 96.26637137461421, 27.962648832357253, 27.22474391775288, 107.35857689708233, 14.887050336322485, 61.52427202019679, 138.57439621761796, 60.13170375927361, 0.0, 0.0, 79.01286222595887, 14.068655055193009, 30.230234134713527, 8.512205393149737, 127.40908198161836, 44.346899899654666, 39.18994710730101, 53.70390899421684, 37.98356374353946, 25.305768868808748, 1.2468583238989592, 188.22835978641112, 8.052891792528488, 331.6686399669399, 96.07523180329858, 3.4286105823588406, 179.4513240514, 37.842988683538024, 70.44255277350588, 234.07369413947237, 10.774881638226255, 54.248413681576395, 6.351847899567355, 62.47394939460228, 46.74286312085196, 93.35001347902495, 5.088777144480267, 39.03988686378102, 11.203280171174136, 55.71813669317582, 14.60905413670914, 93.9146476659873, 29.622654000589055, 19.273650980695123, 119.00937726090501, 18.200747918902632, 75.23554594945527, 425.61784201790005, 5.196466754758913, 48.24592797512702, 40.807597633077435, 61.49478725995131, 168.9738575101372, 31.73128619513403, 21.286770827116406, 55.7390099220426, 11.416759394004819, 111.92408275220895, 23.39977709343205, 8.554535392106382, 4.609411505032762, 183.47290080109468, 78.30938222355023, 15.807753004263079, 68.76550715976613, 13.984432564207786, 116.25740815024247, 71.19410438642471, 42.35067205222458, 37.0987133811161, 67.9155048611357, 448.81468083431076, 227.5273372133095, 85.67788041582534, 75.97316048683913, 55.778875575724385, 183.30902874192594, 188.64597415228764, 173.11475171694752, 105.25274709900313, 150.62196800199226, 12.064258310178808, 189.0464458929013, 139.60978455984917, 155.52086894472615, 197.14983238658868, 35.88423712862723, 249.49543766791618, 205.95241067526769, 187.53945312224178, 252.93721926196505, 56.098795208254415, 76.50131445978238, 34.36273265015838, 35.82880417377539, 204.1288644135504, 111.61071618510839, 112.86747155115954, 356.9804674097082, 23.775629881928786, 0.8574313069905608, 2.0878395059009565, 112.9454190251234, 131.84263721375325, 3.588857147156676, 183.6777556479294, 52.123160764368436, 81.97646977515579, 61.814963118670356, 156.97585358835195, 53.25743297326519, 167.04424791717005, 278.17920137880463, 31.41611990218942, 35.25591256476065, 8.006841240875591, 240.09276710628308, 289.4464521853029, 6.892574785805582, 214.72967407266165, 251.21705552200146, 95.61826967065333, 54.12186253819722, 261.15555886694807, 24.38298605894031, 73.66835383147603, 240.12730101128588, 28.52020045841422, 6.710573721158466, 142.22410148870102, 227.75375728561679, 226.0496267395454, 64.866407731232, 113.7807873980814, 205.54465973285576, 9.319768467036406, 0.0, 124.57911884284854, 9.957064563725666, 91.85123989654124, 3.079531222847214, 4.038262845396079, 30.401810769295825, 49.69650309692912, 42.08709166239532, 126.33191892390907, 113.26346284815874, 84.9195429574391, 99.50261910991591, 47.24724749788315, 28.772630321103104, 27.47538773666045, 61.86390522703628, 1.1648902795119216, 37.18537918937447, 22.05868921778873, 129.64703498589392, 133.2937306389781, 62.357022339886285, 107.74055714275144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8182956239031539, "mean_inference_ms": 2.4252396659756186, "mean_action_processing_ms": 0.34621678712812914, "mean_env_wait_ms": 0.2920458931756189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004217624664306641, "StateBufferConnector_ms": 0.0032236576080322266, "ViewRequirementAgentConnector_ms": 0.11409211158752441}, "num_episodes": 18, "episode_return_max": 344.2799999999998, "episode_return_min": -50.25813574255122, "episode_return_mean": 170.49573495468084, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.35908317298802, "num_env_steps_trained_throughput_per_sec": 249.35908317298802, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 15371.153, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15371.099, "sample_time_ms": 1836.566, "learn_time_ms": 13513.443, "learn_throughput": 296.002, "synch_weights_time_ms": 17.941}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "6c58f_00000", "date": "2024-08-16_16-10-38", "timestamp": 1723804838, "time_this_iter_s": 16.07369112968445, "time_total_s": 222.99459958076477, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0503550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 222.99459958076477, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 62.15652173913044, "ram_util_percent": 82.32608695652175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4205268596215224, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 6.267484915950311, "policy_loss": -0.0036049612642576295, "vf_loss": 6.270936359173406, "vf_explained_var": 0.0035592141290190357, "kl": 0.00614065032112657, "entropy": 1.5402017012475029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7286831251843267, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.200359397464329, "policy_loss": -0.004843549695353778, "vf_loss": 9.2051062503189, "vf_explained_var": 0.0452691464197068, "kl": 0.015471480755892768, "entropy": 1.5561934126117243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 369.06999999999994, "episode_reward_min": 4.349999999999994, "episode_reward_mean": 177.0484067550016, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -404.39150858949733, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.25810035297854, "predator_policy": 448.81468083431076}, "policy_reward_mean": {"prey_policy": -9.923951778888565, "predator_policy": 98.4481551563894}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.5699999999999, 111.17560916417959, 141.98000000000036, 252.69433209580603, 93.80000000000035, 111.84000000000017, 190.11999999999944, 149.09999999999943, 58.249999999999616, 260.37895931688956, 156.13000000000034, 277.68660260318717, 179.54257894573826, 18.31000000000021, 61.85999999999995, 163.24999999999977, 4.349999999999994, 127.03269856730283, 129.28000000000077, 194.45000000000027, 195.6800000000001, 64.03999999999994, 241.80999999999983, 258.37819077727073, 291.3099999999998, 175.06988474542703, 344.2799999999998, 162.95188118510157, 257.5165520812213, 75.56159509914362, 178.51000000000028, 245.64375289905803, 188.1199999999996, 112.53000000000071, 265.95999999999975, 255.97662061118086, 299.55999999999966, 31.050402699522866, 139.5852880012671, 216.35205852248706, 129.82946350467378, 144.15000000000043, 144.79393103080588, 186.8299999999996, 180.7472775137673, 197.80794595583131, 96.68999999999997, 48.23007030304751, 138.0700000000005, 106.72000000000017, 223.1676266982108, 48.129999999999974, 290.0799999999999, 156.78137708012892, 171.61607480005387, 225.86026888789888, 169.25999999999956, 125.78000000000013, 112.51000000000016, 272.3275736860347, 75.91986407178231, 145.44195499062315, 142.25649329319504, 131.81000000000012, 220.23999999999972, 173.9700000000001, 158.5899999999998, 71.12623061243603, 227.54909093202536, 141.27000000000046, 253.58920448392917, 290.4099999999997, 248.4599999999993, 59.82999999999964, 172.92593862935752, 206.81791438771026, 329.35114688311864, 217.72056542354812, 151.04404631259055, 193.6699999999991, 288.566381609367, 37.33126445581846, 183.3360896826189, 176.20414453680834, 308.10641374866367, 182.32018882939138, 369.06999999999994, 264.34794040286795, 144.30999999999966, 257.8852024762775, 204.7760248010759, 143.12990413621284, 308.0951933964382, 39.639999999999944, 102.80256012278713, 119.81971812687152, 208.32995717958076, 257.55999999999995, 267.7700000000001, 60.37862519982798], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.23778007260165, 140.1772593055016, 3.7282674168929546, -114.94139974886907, -45.24637137461378, 62.997351167642556, 53.839087085592, 64.27192419537936, 24.08774388131379, -6.699066237833209, -61.038239126569906, -25.827860850321432, 132.68000000000006, 57.43999999999972, 59.298043058219164, -3.2795603393711534, 7.279765865286446, 12.227794606850226, 8.746818053677462, 79.87615938193942, -31.4199471073012, 94.65609100578314, 126.29011137680091, 88.10715861403875, -4.454343452758037, -5.478295711813271, 9.707108207471476, -331.11863996694035, -89.63523180329832, 51.99138941764112, -155.5413240514008, 101.49701131646212, -20.571346928205767, -279.5948999847723, 78.2727774776393, -16.263374230139036, 75.77815210043269, -15.323949394602224, 29.147136879148043, 25.209986520975228, 99.82122285552005, 51.730113136218876, 47.13671982882583, -50.01813669317616, 88.90428960890725, 44.38200858839643, 68.96889868511492, 140.51298711087333, 122.99722619477969, 31.102648625412744, -404.39150858949733, 78.6080053675689, 166.04353324524118, 124.79407202487297, -3.613037040794868, 64.26253333286772, 14.976961900202213, 41.834446475748145, -11.39145566259399, 9.927270012578425, 97.74568207502219, -42.576524221235374, 102.05033884527515, 111.63910156824547, 81.47507673291332, -81.43738903904051, 26.350617776449724, -7.937753004263119, 107.23449284023387, 75.9755674357921, -38.38595486448071, 106.91106293899443, 119.80932794777539, 100.30128661888409, -219.56436538742992, -266.1154176084936, -89.05910442137007, -84.56082520649767, -23.931036651871178, 108.53105911179453, -102.80073238419175, -139.32480700534796, -126.43475171694759, -7.782747099003192, 32.30020604516265, -50.192501326527484, -73.96644589290136, -67.85978455984879, -111.28062360438548, -60.642800213162076, -28.391343006810793, -59.1803858339013, -184.4324106752679, -112.3694531222416, -152.00146398856296, -108.80448017860984, -61.42214677168994, 88.62809966174905, -214.87418361347727, 81.63651502615167, -4.82125847356626, 3.510697435509222, -310.6604674097084, -21.96562988192856, 159.5325686930094, 127.60216049409904, -21.27652623404463, -66.73015292470281, 126.86780277238215, -142.51834076741486, 25.77044056915494, 65.99019777921995, 5.225036881329553, -54.75585358835189, 30.86134392415064, -125.38302481458604, -208.01920137880458, 10.933880097810603, 130.5698840955177, 98.49493578488148, -267.33345856249167, -186.28589665731198, -79.36595510070434, 3.185661232860335, -55.029518207860484, -149.5493136915996, 45.4181374618027, -228.88555886694795, 67.51701394105953, 54.671646168524056, -236.5785395692425, 141.90103809954152, 40.4210872542998, -30.765762464159117, -109.91415453270287, -272.76299888002256, 81.14268320079374, -32.240787398081444, -134.5146597328557, 60.92023153296339, 78.41396244449052, 50.596123196590185, 77.84188754400412, 110.7598079957291, 73.14046877715293, 168.20173715460373, -3.806599432695217, -16.46171443352962, 100.83237143230453, -96.32544338925081, 35.808448775811854, -27.173540193699274, 32.0834865544804, 150.5177937208393, 105.0225473657851, 56.44999999999984, -34.14358013725422, 122.15883094329598, 38.45858595223958, 95.96734564059743, -63.84596897126016, 89.47158495575542, -51.10036132931839, -81.66595369750033, -306.37925568798414, 68.25093666654617, -187.66087372707068, 81.49593261644215, -45.792007068110856, 176.05572657310404, 114.222114804905, -245.06428675891328, 191.25810035297854, 146.1745151285251, -363.42455884858015, 115.86253011120291, 62.9325676738897, -94.07331601724904, 24.107338833431125, 35.1222258544573, 86.87394791386494, 11.82723541366432, -61.82401133907421, -130.2797163186612, -40.13892826288728, 52.211275603921344, -63.59577016740227, -97.30739385410259, -6.419488906226002, -232.78401323147364, -45.96613162166013, -207.85745461582252, -379.7345393758129, 39.873481510248034, -16.25890426033828, 151.1028886663478, 55.92975397594076, 81.12190570723136, -221.4430271994659, -46.54923400700185], "policy_predator_policy_reward": [46.79221992739831, 3.362740694498478, 142.36317163422578, 80.02556986192994, 96.26637137461421, 27.962648832357253, 27.22474391775288, 107.35857689708233, 14.887050336322485, 61.52427202019679, 138.57439621761796, 60.13170375927361, 0.0, 0.0, 79.01286222595887, 14.068655055193009, 30.230234134713527, 8.512205393149737, 127.40908198161836, 44.346899899654666, 39.18994710730101, 53.70390899421684, 37.98356374353946, 25.305768868808748, 1.2468583238989592, 188.22835978641112, 8.052891792528488, 331.6686399669399, 96.07523180329858, 3.4286105823588406, 179.4513240514, 37.842988683538024, 70.44255277350588, 234.07369413947237, 10.774881638226255, 54.248413681576395, 6.351847899567355, 62.47394939460228, 46.74286312085196, 93.35001347902495, 5.088777144480267, 39.03988686378102, 11.203280171174136, 55.71813669317582, 14.60905413670914, 93.9146476659873, 29.622654000589055, 19.273650980695123, 119.00937726090501, 18.200747918902632, 75.23554594945527, 425.61784201790005, 5.196466754758913, 48.24592797512702, 40.807597633077435, 61.49478725995131, 168.9738575101372, 31.73128619513403, 21.286770827116406, 55.7390099220426, 11.416759394004819, 111.92408275220895, 23.39977709343205, 8.554535392106382, 4.609411505032762, 183.47290080109468, 78.30938222355023, 15.807753004263079, 68.76550715976613, 13.984432564207786, 116.25740815024247, 71.19410438642471, 42.35067205222458, 37.0987133811161, 67.9155048611357, 448.81468083431076, 227.5273372133095, 85.67788041582534, 75.97316048683913, 55.778875575724385, 183.30902874192594, 188.64597415228764, 173.11475171694752, 105.25274709900313, 150.62196800199226, 12.064258310178808, 189.0464458929013, 139.60978455984917, 155.52086894472615, 197.14983238658868, 35.88423712862723, 249.49543766791618, 205.95241067526769, 187.53945312224178, 252.93721926196505, 56.098795208254415, 76.50131445978238, 34.36273265015838, 35.82880417377539, 204.1288644135504, 111.61071618510839, 112.86747155115954, 356.9804674097082, 23.775629881928786, 0.8574313069905608, 2.0878395059009565, 112.9454190251234, 131.84263721375325, 3.588857147156676, 183.6777556479294, 52.123160764368436, 81.97646977515579, 61.814963118670356, 156.97585358835195, 53.25743297326519, 167.04424791717005, 278.17920137880463, 31.41611990218942, 35.25591256476065, 8.006841240875591, 240.09276710628308, 289.4464521853029, 6.892574785805582, 214.72967407266165, 251.21705552200146, 95.61826967065333, 54.12186253819722, 261.15555886694807, 24.38298605894031, 73.66835383147603, 240.12730101128588, 28.52020045841422, 6.710573721158466, 142.22410148870102, 227.75375728561679, 226.0496267395454, 64.866407731232, 113.7807873980814, 205.54465973285576, 9.319768467036406, 0.0, 124.57911884284854, 9.957064563725666, 91.85123989654124, 3.079531222847214, 4.038262845396079, 30.401810769295825, 49.69650309692912, 42.08709166239532, 126.33191892390907, 113.26346284815874, 84.9195429574391, 99.50261910991591, 47.24724749788315, 28.772630321103104, 27.47538773666045, 61.86390522703628, 1.1648902795119216, 37.18537918937447, 22.05868921778873, 129.64703498589392, 133.2937306389781, 62.357022339886285, 107.74055714275144, 251.09796499409805, 170.36644370995847, 247.08960876694758, 35.27947688048935, 161.84200706811077, 16.000687175559623, 42.98288534686636, 270.1794754365332, 4.741899647021461, 26.895484871474856, 330.42890965750263, 181.48105948274258, 15.45101219048188, 159.99973615287738, 120.08967402411983, 78.56596376426971, 59.25603771937328, 46.81880375417335, 185.2769348439793, 149.9566969499692, 141.0357368121117, 154.98710924329242, 65.23577016740278, 135.30739385410268, 71.58754320345422, 270.41851905703174, 145.2306300152943, 228.41267434905996, 315.37528354109196, 232.81573150405393, 88.8549151748719, 33.861100419118664, 105.3035293677281, 25.414810949099774, 50.56312520650196, 277.80776119979373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8150568091141398, "mean_inference_ms": 2.4336282535429232, "mean_action_processing_ms": 0.34445494952381234, "mean_env_wait_ms": 0.2905923484395951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004357337951660156, "StateBufferConnector_ms": 0.005341529846191406, "ViewRequirementAgentConnector_ms": 0.12691092491149902}, "num_episodes": 18, "episode_return_max": 369.06999999999994, "episode_return_min": 4.349999999999994, "episode_return_mean": 177.0484067550016, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.4860591447743, "num_env_steps_trained_throughput_per_sec": 260.4860591447743, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 15580.778, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15580.719, "sample_time_ms": 1866.133, "learn_time_ms": 13692.688, "learn_throughput": 292.127, "synch_weights_time_ms": 17.847}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "6c58f_00000", "date": "2024-08-16_16-10-54", "timestamp": 1723804854, "time_this_iter_s": 15.404937982559204, "time_total_s": 238.39953756332397, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 238.39953756332397, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.95454545454545, "ram_util_percent": 82.51818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4614978983919455, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 5.6822358335767476, "policy_loss": -0.010003404730866866, "vf_loss": 5.691922467347806, "vf_explained_var": 0.0032306365550510466, "kl": 0.012670797214438605, "entropy": 1.5305487499035224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8831821695048974, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.385834723174888, "policy_loss": -0.002598051112342291, "vf_loss": 9.388337133296583, "vf_explained_var": 0.020545365097661496, "kl": 0.015305535220238605, "entropy": 1.5495848834829986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 369.06999999999994, "episode_reward_min": 24.126542880453368, "episode_reward_mean": 179.14982805497465, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -404.39150858949733, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.25810035297854, "predator_policy": 494.0660657596424}, "policy_reward_mean": {"prey_policy": -20.570639567219143, "predator_policy": 110.14555359470651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.28000000000077, 194.45000000000027, 195.6800000000001, 64.03999999999994, 241.80999999999983, 258.37819077727073, 291.3099999999998, 175.06988474542703, 344.2799999999998, 162.95188118510157, 257.5165520812213, 75.56159509914362, 178.51000000000028, 245.64375289905803, 188.1199999999996, 112.53000000000071, 265.95999999999975, 255.97662061118086, 299.55999999999966, 31.050402699522866, 139.5852880012671, 216.35205852248706, 129.82946350467378, 144.15000000000043, 144.79393103080588, 186.8299999999996, 180.7472775137673, 197.80794595583131, 96.68999999999997, 48.23007030304751, 138.0700000000005, 106.72000000000017, 223.1676266982108, 48.129999999999974, 290.0799999999999, 156.78137708012892, 171.61607480005387, 225.86026888789888, 169.25999999999956, 125.78000000000013, 112.51000000000016, 272.3275736860347, 75.91986407178231, 145.44195499062315, 142.25649329319504, 131.81000000000012, 220.23999999999972, 173.9700000000001, 158.5899999999998, 71.12623061243603, 227.54909093202536, 141.27000000000046, 253.58920448392917, 290.4099999999997, 248.4599999999993, 59.82999999999964, 172.92593862935752, 206.81791438771026, 329.35114688311864, 217.72056542354812, 151.04404631259055, 193.6699999999991, 288.566381609367, 37.33126445581846, 183.3360896826189, 176.20414453680834, 308.10641374866367, 182.32018882939138, 369.06999999999994, 264.34794040286795, 144.30999999999966, 257.8852024762775, 204.7760248010759, 143.12990413621284, 308.0951933964382, 39.639999999999944, 102.80256012278713, 119.81971812687152, 208.32995717958076, 257.55999999999995, 267.7700000000001, 60.37862519982798, 190.7272093342331, 244.5699999999999, 108.48000000000025, 59.16993297102242, 193.1599999999996, 24.126542880453368, 194.6299999999997, 154.0927154986561, 131.29000000000025, 50.288297724232024, 179.98445390998415, 165.53367377159822, 191.9525887232133, 224.01290368724267, 185.95000000000005, 245.10873783374444, 130.10221723447856, 213.03363712155036], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.77815210043269, -15.323949394602224, 29.147136879148043, 25.209986520975228, 99.82122285552005, 51.730113136218876, 47.13671982882583, -50.01813669317616, 88.90428960890725, 44.38200858839643, 68.96889868511492, 140.51298711087333, 122.99722619477969, 31.102648625412744, -404.39150858949733, 78.6080053675689, 166.04353324524118, 124.79407202487297, -3.613037040794868, 64.26253333286772, 14.976961900202213, 41.834446475748145, -11.39145566259399, 9.927270012578425, 97.74568207502219, -42.576524221235374, 102.05033884527515, 111.63910156824547, 81.47507673291332, -81.43738903904051, 26.350617776449724, -7.937753004263119, 107.23449284023387, 75.9755674357921, -38.38595486448071, 106.91106293899443, 119.80932794777539, 100.30128661888409, -219.56436538742992, -266.1154176084936, -89.05910442137007, -84.56082520649767, -23.931036651871178, 108.53105911179453, -102.80073238419175, -139.32480700534796, -126.43475171694759, -7.782747099003192, 32.30020604516265, -50.192501326527484, -73.96644589290136, -67.85978455984879, -111.28062360438548, -60.642800213162076, -28.391343006810793, -59.1803858339013, -184.4324106752679, -112.3694531222416, -152.00146398856296, -108.80448017860984, -61.42214677168994, 88.62809966174905, -214.87418361347727, 81.63651502615167, -4.82125847356626, 3.510697435509222, -310.6604674097084, -21.96562988192856, 159.5325686930094, 127.60216049409904, -21.27652623404463, -66.73015292470281, 126.86780277238215, -142.51834076741486, 25.77044056915494, 65.99019777921995, 5.225036881329553, -54.75585358835189, 30.86134392415064, -125.38302481458604, -208.01920137880458, 10.933880097810603, 130.5698840955177, 98.49493578488148, -267.33345856249167, -186.28589665731198, -79.36595510070434, 3.185661232860335, -55.029518207860484, -149.5493136915996, 45.4181374618027, -228.88555886694795, 67.51701394105953, 54.671646168524056, -236.5785395692425, 141.90103809954152, 40.4210872542998, -30.765762464159117, -109.91415453270287, -272.76299888002256, 81.14268320079374, -32.240787398081444, -134.5146597328557, 60.92023153296339, 78.41396244449052, 50.596123196590185, 77.84188754400412, 110.7598079957291, 73.14046877715293, 168.20173715460373, -3.806599432695217, -16.46171443352962, 100.83237143230453, -96.32544338925081, 35.808448775811854, -27.173540193699274, 32.0834865544804, 150.5177937208393, 105.0225473657851, 56.44999999999984, -34.14358013725422, 122.15883094329598, 38.45858595223958, 95.96734564059743, -63.84596897126016, 89.47158495575542, -51.10036132931839, -81.66595369750033, -306.37925568798414, 68.25093666654617, -187.66087372707068, 81.49593261644215, -45.792007068110856, 176.05572657310404, 114.222114804905, -245.06428675891328, 191.25810035297854, 146.1745151285251, -363.42455884858015, 115.86253011120291, 62.9325676738897, -94.07331601724904, 24.107338833431125, 35.1222258544573, 86.87394791386494, 11.82723541366432, -61.82401133907421, -130.2797163186612, -40.13892826288728, 52.211275603921344, -63.59577016740227, -97.30739385410259, -6.419488906226002, -232.78401323147364, -45.96613162166013, -207.85745461582252, -379.7345393758129, 39.873481510248034, -16.25890426033828, 151.1028886663478, 55.92975397594076, 81.12190570723136, -221.4430271994659, -46.54923400700185, -51.25244277821288, -58.59667022799228, 18.118546269199975, 64.1069114342854, -110.91609684726397, -77.35595818756444, -83.64927844102857, -170.16656295674758, -182.0083195088023, 152.45446839213173, -77.80963740825699, -325.86398455407556, 58.28673377598889, 35.203428357750006, 52.730402604559515, -227.78828055478982, -175.85586510429695, 41.149365386829054, -390.6116097338486, -145.37549951318684, 52.001062683600864, -13.317828972800335, -110.5376312207943, -55.752076526935596, 56.18854197523298, -107.69483532089973, 44.12652447809219, 45.293467227226905, -194.51197343160675, 122.60172113132606, 110.42718541498927, -70.59438901771074, 18.91111366540873, -205.72079721009482, 91.27908785980404, -62.53664021310557], "policy_predator_policy_reward": [6.351847899567355, 62.47394939460228, 46.74286312085196, 93.35001347902495, 5.088777144480267, 39.03988686378102, 11.203280171174136, 55.71813669317582, 14.60905413670914, 93.9146476659873, 29.622654000589055, 19.273650980695123, 119.00937726090501, 18.200747918902632, 75.23554594945527, 425.61784201790005, 5.196466754758913, 48.24592797512702, 40.807597633077435, 61.49478725995131, 168.9738575101372, 31.73128619513403, 21.286770827116406, 55.7390099220426, 11.416759394004819, 111.92408275220895, 23.39977709343205, 8.554535392106382, 4.609411505032762, 183.47290080109468, 78.30938222355023, 15.807753004263079, 68.76550715976613, 13.984432564207786, 116.25740815024247, 71.19410438642471, 42.35067205222458, 37.0987133811161, 67.9155048611357, 448.81468083431076, 227.5273372133095, 85.67788041582534, 75.97316048683913, 55.778875575724385, 183.30902874192594, 188.64597415228764, 173.11475171694752, 105.25274709900313, 150.62196800199226, 12.064258310178808, 189.0464458929013, 139.60978455984917, 155.52086894472615, 197.14983238658868, 35.88423712862723, 249.49543766791618, 205.95241067526769, 187.53945312224178, 252.93721926196505, 56.098795208254415, 76.50131445978238, 34.36273265015838, 35.82880417377539, 204.1288644135504, 111.61071618510839, 112.86747155115954, 356.9804674097082, 23.775629881928786, 0.8574313069905608, 2.0878395059009565, 112.9454190251234, 131.84263721375325, 3.588857147156676, 183.6777556479294, 52.123160764368436, 81.97646977515579, 61.814963118670356, 156.97585358835195, 53.25743297326519, 167.04424791717005, 278.17920137880463, 31.41611990218942, 35.25591256476065, 8.006841240875591, 240.09276710628308, 289.4464521853029, 6.892574785805582, 214.72967407266165, 251.21705552200146, 95.61826967065333, 54.12186253819722, 261.15555886694807, 24.38298605894031, 73.66835383147603, 240.12730101128588, 28.52020045841422, 6.710573721158466, 142.22410148870102, 227.75375728561679, 226.0496267395454, 64.866407731232, 113.7807873980814, 205.54465973285576, 9.319768467036406, 0.0, 124.57911884284854, 9.957064563725666, 91.85123989654124, 3.079531222847214, 4.038262845396079, 30.401810769295825, 49.69650309692912, 42.08709166239532, 126.33191892390907, 113.26346284815874, 84.9195429574391, 99.50261910991591, 47.24724749788315, 28.772630321103104, 27.47538773666045, 61.86390522703628, 1.1648902795119216, 37.18537918937447, 22.05868921778873, 129.64703498589392, 133.2937306389781, 62.357022339886285, 107.74055714275144, 251.09796499409805, 170.36644370995847, 247.08960876694758, 35.27947688048935, 161.84200706811077, 16.000687175559623, 42.98288534686636, 270.1794754365332, 4.741899647021461, 26.895484871474856, 330.42890965750263, 181.48105948274258, 15.45101219048188, 159.99973615287738, 120.08967402411983, 78.56596376426971, 59.25603771937328, 46.81880375417335, 185.2769348439793, 149.9566969499692, 141.0357368121117, 154.98710924329242, 65.23577016740278, 135.30739385410268, 71.58754320345422, 270.41851905703174, 145.2306300152943, 228.41267434905996, 315.37528354109196, 232.81573150405393, 88.8549151748719, 33.861100419118664, 105.3035293677281, 25.414810949099774, 50.56312520650196, 277.80776119979373, 168.50242404879828, 132.07389829164, 41.42020439704461, 120.92433789947002, 198.20609684726398, 98.54595818756495, 271.65203323312613, 41.33374113567195, 195.26611550683188, 27.44773560983767, 10.574362532347124, 417.22580231043895, 1.1232662240110844, 100.01657164225004, 321.4196007044147, 7.730992744472086, 207.45980305609112, 58.536696661376496, 494.0660657596424, 92.20934121162497, 90.43921963219164, 50.86200056699214, 256.61011047936273, 75.21327103996565, 158.36359910482793, 85.09528296405227, 79.28460911897507, 55.308302862948565, 97.91694650245535, 159.9433057978252, 30.26779491796169, 175.00814651850425, 6.20245026744609, 310.70945051171856, 112.69313236633542, 71.59805710851683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8098052953876572, "mean_inference_ms": 2.434751144463768, "mean_action_processing_ms": 0.34247400262351574, "mean_env_wait_ms": 0.28888639258359455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004236936569213867, "StateBufferConnector_ms": 0.0052547454833984375, "ViewRequirementAgentConnector_ms": 0.11957061290740967}, "num_episodes": 18, "episode_return_max": 369.06999999999994, "episode_return_min": 24.126542880453368, "episode_return_mean": 179.14982805497465, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.26171627986656, "num_env_steps_trained_throughput_per_sec": 265.26171627986656, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 15542.102, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15542.046, "sample_time_ms": 1885.49, "learn_time_ms": 13634.758, "learn_throughput": 293.368, "synch_weights_time_ms": 17.755}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "6c58f_00000", "date": "2024-08-16_16-11-09", "timestamp": 1723804869, "time_this_iter_s": 15.130734205245972, "time_total_s": 253.53027176856995, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.53027176856995, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 60.87727272727273, "ram_util_percent": 81.89090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.339470364224343, "cur_kl_coeff": 0.025, "cur_lr": 1e-05, "total_loss": 7.445107286443156, "policy_loss": -0.006875168663947277, "vf_loss": 7.451424141283389, "vf_explained_var": 0.0015286240943525203, "kl": 0.022332176367424857, "entropy": 1.5242984911752127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2530440040997095, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.224070132977117, "policy_loss": -0.0065851908854686865, "vf_loss": 8.230593128557558, "vf_explained_var": -0.09155193699730767, "kl": 0.009956104800392563, "entropy": 1.5452053657915226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 369.06999999999994, "episode_reward_min": -8.396432654276294, "episode_reward_mean": 155.99190847244188, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.6116097338486, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.25810035297854, "predator_policy": 494.0660657596424}, "policy_reward_mean": {"prey_policy": -47.48741422614692, "predator_policy": 125.48336846236789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [129.82946350467378, 144.15000000000043, 144.79393103080588, 186.8299999999996, 180.7472775137673, 197.80794595583131, 96.68999999999997, 48.23007030304751, 138.0700000000005, 106.72000000000017, 223.1676266982108, 48.129999999999974, 290.0799999999999, 156.78137708012892, 171.61607480005387, 225.86026888789888, 169.25999999999956, 125.78000000000013, 112.51000000000016, 272.3275736860347, 75.91986407178231, 145.44195499062315, 142.25649329319504, 131.81000000000012, 220.23999999999972, 173.9700000000001, 158.5899999999998, 71.12623061243603, 227.54909093202536, 141.27000000000046, 253.58920448392917, 290.4099999999997, 248.4599999999993, 59.82999999999964, 172.92593862935752, 206.81791438771026, 329.35114688311864, 217.72056542354812, 151.04404631259055, 193.6699999999991, 288.566381609367, 37.33126445581846, 183.3360896826189, 176.20414453680834, 308.10641374866367, 182.32018882939138, 369.06999999999994, 264.34794040286795, 144.30999999999966, 257.8852024762775, 204.7760248010759, 143.12990413621284, 308.0951933964382, 39.639999999999944, 102.80256012278713, 119.81971812687152, 208.32995717958076, 257.55999999999995, 267.7700000000001, 60.37862519982798, 190.7272093342331, 244.5699999999999, 108.48000000000025, 59.16993297102242, 193.1599999999996, 24.126542880453368, 194.6299999999997, 154.0927154986561, 131.29000000000025, 50.288297724232024, 179.98445390998415, 165.53367377159822, 191.9525887232133, 224.01290368724267, 185.95000000000005, 245.10873783374444, 130.10221723447856, 213.03363712155036, 5.083158447075072, 28.60000000000037, 68.28669424635592, 165.543322512845, -8.396432654276294, 30.810000000000013, 235.78999999999985, 27.662448946882485, 74.56039438684547, 110.5173879112963, 39.435070116065, 24.639179700979025, 179.1111578603719, 65.05685837567059, 149.71781982202285, 48.445929371877575, 216.31999999999942, 101.08000000000072, 174.26384281054206, 64.06710378260662, 200.33027092938835, 6.9000618018581825], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-102.80073238419175, -139.32480700534796, -126.43475171694759, -7.782747099003192, 32.30020604516265, -50.192501326527484, -73.96644589290136, -67.85978455984879, -111.28062360438548, -60.642800213162076, -28.391343006810793, -59.1803858339013, -184.4324106752679, -112.3694531222416, -152.00146398856296, -108.80448017860984, -61.42214677168994, 88.62809966174905, -214.87418361347727, 81.63651502615167, -4.82125847356626, 3.510697435509222, -310.6604674097084, -21.96562988192856, 159.5325686930094, 127.60216049409904, -21.27652623404463, -66.73015292470281, 126.86780277238215, -142.51834076741486, 25.77044056915494, 65.99019777921995, 5.225036881329553, -54.75585358835189, 30.86134392415064, -125.38302481458604, -208.01920137880458, 10.933880097810603, 130.5698840955177, 98.49493578488148, -267.33345856249167, -186.28589665731198, -79.36595510070434, 3.185661232860335, -55.029518207860484, -149.5493136915996, 45.4181374618027, -228.88555886694795, 67.51701394105953, 54.671646168524056, -236.5785395692425, 141.90103809954152, 40.4210872542998, -30.765762464159117, -109.91415453270287, -272.76299888002256, 81.14268320079374, -32.240787398081444, -134.5146597328557, 60.92023153296339, 78.41396244449052, 50.596123196590185, 77.84188754400412, 110.7598079957291, 73.14046877715293, 168.20173715460373, -3.806599432695217, -16.46171443352962, 100.83237143230453, -96.32544338925081, 35.808448775811854, -27.173540193699274, 32.0834865544804, 150.5177937208393, 105.0225473657851, 56.44999999999984, -34.14358013725422, 122.15883094329598, 38.45858595223958, 95.96734564059743, -63.84596897126016, 89.47158495575542, -51.10036132931839, -81.66595369750033, -306.37925568798414, 68.25093666654617, -187.66087372707068, 81.49593261644215, -45.792007068110856, 176.05572657310404, 114.222114804905, -245.06428675891328, 191.25810035297854, 146.1745151285251, -363.42455884858015, 115.86253011120291, 62.9325676738897, -94.07331601724904, 24.107338833431125, 35.1222258544573, 86.87394791386494, 11.82723541366432, -61.82401133907421, -130.2797163186612, -40.13892826288728, 52.211275603921344, -63.59577016740227, -97.30739385410259, -6.419488906226002, -232.78401323147364, -45.96613162166013, -207.85745461582252, -379.7345393758129, 39.873481510248034, -16.25890426033828, 151.1028886663478, 55.92975397594076, 81.12190570723136, -221.4430271994659, -46.54923400700185, -51.25244277821288, -58.59667022799228, 18.118546269199975, 64.1069114342854, -110.91609684726397, -77.35595818756444, -83.64927844102857, -170.16656295674758, -182.0083195088023, 152.45446839213173, -77.80963740825699, -325.86398455407556, 58.28673377598889, 35.203428357750006, 52.730402604559515, -227.78828055478982, -175.85586510429695, 41.149365386829054, -390.6116097338486, -145.37549951318684, 52.001062683600864, -13.317828972800335, -110.5376312207943, -55.752076526935596, 56.18854197523298, -107.69483532089973, 44.12652447809219, 45.293467227226905, -194.51197343160675, 122.60172113132606, 110.42718541498927, -70.59438901771074, 18.91111366540873, -205.72079721009482, 91.27908785980404, -62.53664021310557, -384.52629236463065, -57.4602675309355, -87.44797767243205, -94.35374506907294, -289.95621060228495, -107.78422547661319, -196.86268746868046, 58.33038279168253, -332.79577394830017, -316.0097379015608, -35.82087500016896, -51.35444953135025, 71.52474085534034, -3.2297728470185874, -161.72044925812685, -14.128760869381535, -262.6802468788553, -123.70954208168536, -58.67722968843781, -32.589926371106365, -138.05400673773076, -204.29373189067877, -146.02536157652077, -41.39131960782763, 31.334016880864436, -136.733400509008, -90.39953335037349, -98.02625533242126, -29.944152280462024, 20.196926049671408, 0.7505909760731594, -214.10616849079108, 4.550192933918462, 94.07000000000026, 45.23410962301697, -104.71448229072888, 45.693894302838245, -96.9878394303002, -111.11178693970173, -172.7320065357503, -25.844491826920834, -139.861153061642, -257.9669626217665, -109.88359455597852], "policy_predator_policy_reward": [183.30902874192594, 188.64597415228764, 173.11475171694752, 105.25274709900313, 150.62196800199226, 12.064258310178808, 189.0464458929013, 139.60978455984917, 155.52086894472615, 197.14983238658868, 35.88423712862723, 249.49543766791618, 205.95241067526769, 187.53945312224178, 252.93721926196505, 56.098795208254415, 76.50131445978238, 34.36273265015838, 35.82880417377539, 204.1288644135504, 111.61071618510839, 112.86747155115954, 356.9804674097082, 23.775629881928786, 0.8574313069905608, 2.0878395059009565, 112.9454190251234, 131.84263721375325, 3.588857147156676, 183.6777556479294, 52.123160764368436, 81.97646977515579, 61.814963118670356, 156.97585358835195, 53.25743297326519, 167.04424791717005, 278.17920137880463, 31.41611990218942, 35.25591256476065, 8.006841240875591, 240.09276710628308, 289.4464521853029, 6.892574785805582, 214.72967407266165, 251.21705552200146, 95.61826967065333, 54.12186253819722, 261.15555886694807, 24.38298605894031, 73.66835383147603, 240.12730101128588, 28.52020045841422, 6.710573721158466, 142.22410148870102, 227.75375728561679, 226.0496267395454, 64.866407731232, 113.7807873980814, 205.54465973285576, 9.319768467036406, 0.0, 124.57911884284854, 9.957064563725666, 91.85123989654124, 3.079531222847214, 4.038262845396079, 30.401810769295825, 49.69650309692912, 42.08709166239532, 126.33191892390907, 113.26346284815874, 84.9195429574391, 99.50261910991591, 47.24724749788315, 28.772630321103104, 27.47538773666045, 61.86390522703628, 1.1648902795119216, 37.18537918937447, 22.05868921778873, 129.64703498589392, 133.2937306389781, 62.357022339886285, 107.74055714275144, 251.09796499409805, 170.36644370995847, 247.08960876694758, 35.27947688048935, 161.84200706811077, 16.000687175559623, 42.98288534686636, 270.1794754365332, 4.741899647021461, 26.895484871474856, 330.42890965750263, 181.48105948274258, 15.45101219048188, 159.99973615287738, 120.08967402411983, 78.56596376426971, 59.25603771937328, 46.81880375417335, 185.2769348439793, 149.9566969499692, 141.0357368121117, 154.98710924329242, 65.23577016740278, 135.30739385410268, 71.58754320345422, 270.41851905703174, 145.2306300152943, 228.41267434905996, 315.37528354109196, 232.81573150405393, 88.8549151748719, 33.861100419118664, 105.3035293677281, 25.414810949099774, 50.56312520650196, 277.80776119979373, 168.50242404879828, 132.07389829164, 41.42020439704461, 120.92433789947002, 198.20609684726398, 98.54595818756495, 271.65203323312613, 41.33374113567195, 195.26611550683188, 27.44773560983767, 10.574362532347124, 417.22580231043895, 1.1232662240110844, 100.01657164225004, 321.4196007044147, 7.730992744472086, 207.45980305609112, 58.536696661376496, 494.0660657596424, 92.20934121162497, 90.43921963219164, 50.86200056699214, 256.61011047936273, 75.21327103996565, 158.36359910482793, 85.09528296405227, 79.28460911897507, 55.308302862948565, 97.91694650245535, 159.9433057978252, 30.26779491796169, 175.00814651850425, 6.20245026744609, 310.70945051171856, 112.69313236633542, 71.59805710851683, 0.0, 447.06971834264135, 88.75797767243232, 121.64374506907359, 186.9821923584019, 279.0449379668518, 173.96470614225967, 130.11092104758316, 211.59125983922712, 428.81781935635655, 72.86812579915917, 45.1171987323595, 33.44667898166167, 134.04835301001668, 107.763712189001, 95.74794688538915, 297.83557669332157, 163.1146066540647, 49.28266621464084, 152.50187775619986, 197.20082752486786, 184.5819812196062, 204.42721010978653, 7.628650775539601, 71.23838143592488, 213.272160052591, 159.66912471576273, 93.81352234270214, 132.0059634562422, 27.45908259657193, 192.74287437803284, 69.05863250856282, 117.69980706608156, 0.0, 58.48460297897055, 102.07576968874187, 36.46159280882402, 189.09619512918027, 160.03406368597672, 187.8768335720823, 147.2028885386153, 218.833027279336, 221.06097039570375, 153.68964858389944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8046941389997224, "mean_inference_ms": 2.4295370141429196, "mean_action_processing_ms": 0.3396823044265232, "mean_env_wait_ms": 0.2863452952778706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005091190338134766, "StateBufferConnector_ms": 0.005270719528198242, "ViewRequirementAgentConnector_ms": 0.11310672760009766}, "num_episodes": 22, "episode_return_max": 369.06999999999994, "episode_return_min": -8.396432654276294, "episode_return_mean": 155.99190847244188, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.6541533762476, "num_env_steps_trained_throughput_per_sec": 268.6541533762476, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 15458.038, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15457.981, "sample_time_ms": 1889.779, "learn_time_ms": 13546.277, "learn_throughput": 295.284, "synch_weights_time_ms": 17.75}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "6c58f_00000", "date": "2024-08-16_16-11-24", "timestamp": 1723804884, "time_this_iter_s": 14.949695825576782, "time_total_s": 268.47996759414673, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 268.47996759414673, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.54285714285714, "ram_util_percent": 81.80000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2667939919170248, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 8.280045009037805, "policy_loss": -0.0033015016624063412, "vf_loss": 8.282965149450554, "vf_explained_var": 0.00046954650096792393, "kl": 0.01016988481862334, "entropy": 1.5346275016113564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.044551108596186, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.869036332892362, "policy_loss": -0.003682433637401099, "vf_loss": 8.872667101199035, "vf_explained_var": -0.0027997915391568783, "kl": 0.008269814822266013, "entropy": 1.5424988112121663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 369.06999999999994, "episode_reward_min": -106.02642955705178, "episode_reward_mean": 129.35248514844895, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -420.7909074518159, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.25810035297854, "predator_policy": 494.0660657596424}, "policy_reward_mean": {"prey_policy": -74.45296574737412, "predator_policy": 139.1292083215986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.81000000000012, 220.23999999999972, 173.9700000000001, 158.5899999999998, 71.12623061243603, 227.54909093202536, 141.27000000000046, 253.58920448392917, 290.4099999999997, 248.4599999999993, 59.82999999999964, 172.92593862935752, 206.81791438771026, 329.35114688311864, 217.72056542354812, 151.04404631259055, 193.6699999999991, 288.566381609367, 37.33126445581846, 183.3360896826189, 176.20414453680834, 308.10641374866367, 182.32018882939138, 369.06999999999994, 264.34794040286795, 144.30999999999966, 257.8852024762775, 204.7760248010759, 143.12990413621284, 308.0951933964382, 39.639999999999944, 102.80256012278713, 119.81971812687152, 208.32995717958076, 257.55999999999995, 267.7700000000001, 60.37862519982798, 190.7272093342331, 244.5699999999999, 108.48000000000025, 59.16993297102242, 193.1599999999996, 24.126542880453368, 194.6299999999997, 154.0927154986561, 131.29000000000025, 50.288297724232024, 179.98445390998415, 165.53367377159822, 191.9525887232133, 224.01290368724267, 185.95000000000005, 245.10873783374444, 130.10221723447856, 213.03363712155036, 5.083158447075072, 28.60000000000037, 68.28669424635592, 165.543322512845, -8.396432654276294, 30.810000000000013, 235.78999999999985, 27.662448946882485, 74.56039438684547, 110.5173879112963, 39.435070116065, 24.639179700979025, 179.1111578603719, 65.05685837567059, 149.71781982202285, 48.445929371877575, 216.31999999999942, 101.08000000000072, 174.26384281054206, 64.06710378260662, 200.33027092938835, 6.9000618018581825, 31.660519135907684, 91.75872986483924, -106.02642955705178, -41.165343738908064, 62.918824466549026, -7.493849153564291, 57.37096307642789, 55.51999999999993, 0.397284397712635, 55.46837978791099, 55.112790904251234, 78.98710228949831, 96.29324418198395, 21.089896970770475, 148.81999999999982, 25.441062971026795, -32.93572521718259, -14.195031109245217, 33.84907724689417, 126.79925152869632, 15.276763549740298, 18.280000000000335, 95.83007782050126], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [45.4181374618027, -228.88555886694795, 67.51701394105953, 54.671646168524056, -236.5785395692425, 141.90103809954152, 40.4210872542998, -30.765762464159117, -109.91415453270287, -272.76299888002256, 81.14268320079374, -32.240787398081444, -134.5146597328557, 60.92023153296339, 78.41396244449052, 50.596123196590185, 77.84188754400412, 110.7598079957291, 73.14046877715293, 168.20173715460373, -3.806599432695217, -16.46171443352962, 100.83237143230453, -96.32544338925081, 35.808448775811854, -27.173540193699274, 32.0834865544804, 150.5177937208393, 105.0225473657851, 56.44999999999984, -34.14358013725422, 122.15883094329598, 38.45858595223958, 95.96734564059743, -63.84596897126016, 89.47158495575542, -51.10036132931839, -81.66595369750033, -306.37925568798414, 68.25093666654617, -187.66087372707068, 81.49593261644215, -45.792007068110856, 176.05572657310404, 114.222114804905, -245.06428675891328, 191.25810035297854, 146.1745151285251, -363.42455884858015, 115.86253011120291, 62.9325676738897, -94.07331601724904, 24.107338833431125, 35.1222258544573, 86.87394791386494, 11.82723541366432, -61.82401133907421, -130.2797163186612, -40.13892826288728, 52.211275603921344, -63.59577016740227, -97.30739385410259, -6.419488906226002, -232.78401323147364, -45.96613162166013, -207.85745461582252, -379.7345393758129, 39.873481510248034, -16.25890426033828, 151.1028886663478, 55.92975397594076, 81.12190570723136, -221.4430271994659, -46.54923400700185, -51.25244277821288, -58.59667022799228, 18.118546269199975, 64.1069114342854, -110.91609684726397, -77.35595818756444, -83.64927844102857, -170.16656295674758, -182.0083195088023, 152.45446839213173, -77.80963740825699, -325.86398455407556, 58.28673377598889, 35.203428357750006, 52.730402604559515, -227.78828055478982, -175.85586510429695, 41.149365386829054, -390.6116097338486, -145.37549951318684, 52.001062683600864, -13.317828972800335, -110.5376312207943, -55.752076526935596, 56.18854197523298, -107.69483532089973, 44.12652447809219, 45.293467227226905, -194.51197343160675, 122.60172113132606, 110.42718541498927, -70.59438901771074, 18.91111366540873, -205.72079721009482, 91.27908785980404, -62.53664021310557, -384.52629236463065, -57.4602675309355, -87.44797767243205, -94.35374506907294, -289.95621060228495, -107.78422547661319, -196.86268746868046, 58.33038279168253, -332.79577394830017, -316.0097379015608, -35.82087500016896, -51.35444953135025, 71.52474085534034, -3.2297728470185874, -161.72044925812685, -14.128760869381535, -262.6802468788553, -123.70954208168536, -58.67722968843781, -32.589926371106365, -138.05400673773076, -204.29373189067877, -146.02536157652077, -41.39131960782763, 31.334016880864436, -136.733400509008, -90.39953335037349, -98.02625533242126, -29.944152280462024, 20.196926049671408, 0.7505909760731594, -214.10616849079108, 4.550192933918462, 94.07000000000026, 45.23410962301697, -104.71448229072888, 45.693894302838245, -96.9878394303002, -111.11178693970173, -172.7320065357503, -25.844491826920834, -139.861153061642, -257.9669626217665, -109.88359455597852, -115.97355282045201, -59.34726933165258, -25.16327690976532, -65.02888387060241, -225.05586375843788, -344.29500625567465, -355.7637909517543, -368.9728172840685, -138.04476344542067, -162.35921061179164, -328.6681347320205, -317.73644836816703, -127.35467678319364, -96.14328782650567, -420.7909074518159, -159.98593363876194, -200.26652221886098, -149.69552400580247, -113.13875759897986, -368.0824933313169, -175.66667509098696, -147.16128186977275, -331.5706733324824, 16.833366627574446, 2.8795219187344436, -55.42148197321691, -156.96579354429255, -343.04474666923335, 80.99372835035315, -51.138315137534285, -255.40699124262974, -1.8552894538099458, -162.4180613043137, -291.33245090246896, -157.33603435391393, -258.70728012769393, -69.98470787751235, -68.00269582445625, -111.23282981680336, -252.09635070245446, -291.52187964812555, -382.74826687364595, -60.43244517731465, 0.37460235114577467, -12.261128474439548, -80.36525109406864], "policy_predator_policy_reward": [54.12186253819722, 261.15555886694807, 24.38298605894031, 73.66835383147603, 240.12730101128588, 28.52020045841422, 6.710573721158466, 142.22410148870102, 227.75375728561679, 226.0496267395454, 64.866407731232, 113.7807873980814, 205.54465973285576, 9.319768467036406, 0.0, 124.57911884284854, 9.957064563725666, 91.85123989654124, 3.079531222847214, 4.038262845396079, 30.401810769295825, 49.69650309692912, 42.08709166239532, 126.33191892390907, 113.26346284815874, 84.9195429574391, 99.50261910991591, 47.24724749788315, 28.772630321103104, 27.47538773666045, 61.86390522703628, 1.1648902795119216, 37.18537918937447, 22.05868921778873, 129.64703498589392, 133.2937306389781, 62.357022339886285, 107.74055714275144, 251.09796499409805, 170.36644370995847, 247.08960876694758, 35.27947688048935, 161.84200706811077, 16.000687175559623, 42.98288534686636, 270.1794754365332, 4.741899647021461, 26.895484871474856, 330.42890965750263, 181.48105948274258, 15.45101219048188, 159.99973615287738, 120.08967402411983, 78.56596376426971, 59.25603771937328, 46.81880375417335, 185.2769348439793, 149.9566969499692, 141.0357368121117, 154.98710924329242, 65.23577016740278, 135.30739385410268, 71.58754320345422, 270.41851905703174, 145.2306300152943, 228.41267434905996, 315.37528354109196, 232.81573150405393, 88.8549151748719, 33.861100419118664, 105.3035293677281, 25.414810949099774, 50.56312520650196, 277.80776119979373, 168.50242404879828, 132.07389829164, 41.42020439704461, 120.92433789947002, 198.20609684726398, 98.54595818756495, 271.65203323312613, 41.33374113567195, 195.26611550683188, 27.44773560983767, 10.574362532347124, 417.22580231043895, 1.1232662240110844, 100.01657164225004, 321.4196007044147, 7.730992744472086, 207.45980305609112, 58.536696661376496, 494.0660657596424, 92.20934121162497, 90.43921963219164, 50.86200056699214, 256.61011047936273, 75.21327103996565, 158.36359910482793, 85.09528296405227, 79.28460911897507, 55.308302862948565, 97.91694650245535, 159.9433057978252, 30.26779491796169, 175.00814651850425, 6.20245026744609, 310.70945051171856, 112.69313236633542, 71.59805710851683, 0.0, 447.06971834264135, 88.75797767243232, 121.64374506907359, 186.9821923584019, 279.0449379668518, 173.96470614225967, 130.11092104758316, 211.59125983922712, 428.81781935635655, 72.86812579915917, 45.1171987323595, 33.44667898166167, 134.04835301001668, 107.763712189001, 95.74794688538915, 297.83557669332157, 163.1146066540647, 49.28266621464084, 152.50187775619986, 197.20082752486786, 184.5819812196062, 204.42721010978653, 7.628650775539601, 71.23838143592488, 213.272160052591, 159.66912471576273, 93.81352234270214, 132.0059634562422, 27.45908259657193, 192.74287437803284, 69.05863250856282, 117.69980706608156, 0.0, 58.48460297897055, 102.07576968874187, 36.46159280882402, 189.09619512918027, 160.03406368597672, 187.8768335720823, 147.2028885386153, 218.833027279336, 221.06097039570375, 153.68964858389944, 101.71226180849125, 105.2690794795209, 143.0146949697952, 38.93619567541191, 450.99602321002806, 12.32841724703254, 221.2495091266038, 462.32175537031054, 94.40864725448318, 268.91415126927706, 454.79511623479164, 184.11561771183156, 142.9285244629401, 137.94040322318725, 421.0309074518159, 215.26593363876194, 151.29749641602004, 199.06183420635514, 253.893722532819, 282.79590818538975, 202.56102300883882, 175.37972485617212, 330.6907471067602, 63.03366188764508, 64.8382542609199, 83.99694997554587, 219.99967190198052, 301.1007652823161, 19.836271649647003, 99.12831513753467, 207.19063051241068, 75.51271315505535, 71.62585437127059, 349.188932618329, 172.67023605473938, 229.1780473176228, 143.25047804768917, 28.586002901173515, 350.18609560386875, 139.94233644408556, 397.47371429486935, 292.0731957766425, 72.75632410470904, 5.581518721459821, 75.41308147057057, 113.04337591843871]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7961888345179239, "mean_inference_ms": 2.4314762266103123, "mean_action_processing_ms": 0.3374258796119471, "mean_env_wait_ms": 0.28409445620815055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005681514739990234, "StateBufferConnector_ms": 0.005749940872192383, "ViewRequirementAgentConnector_ms": 0.12263631820678711}, "num_episodes": 23, "episode_return_max": 369.06999999999994, "episode_return_min": -106.02642955705178, "episode_return_mean": 129.35248514844895, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 248.92541851595803, "num_env_steps_trained_throughput_per_sec": 248.92541851595803, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 15514.144, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15514.086, "sample_time_ms": 1895.301, "learn_time_ms": 13597.691, "learn_throughput": 294.168, "synch_weights_time_ms": 16.766}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "6c58f_00000", "date": "2024-08-16_16-11-40", "timestamp": 1723804900, "time_this_iter_s": 16.113194942474365, "time_total_s": 284.5931625366211, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04deca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 284.5931625366211, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 60.98260869565218, "ram_util_percent": 81.95217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4815653771950454, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 7.464828016896727, "policy_loss": -0.004622491555061763, "vf_loss": 7.469000026410219, "vf_explained_var": 0.0012825250940978843, "kl": 0.012012917032590489, "entropy": 1.5536908117551653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0608419172978274, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.791413645769554, "policy_loss": -0.005674011031259344, "vf_loss": 8.797018084450373, "vf_explained_var": 0.007617774684593161, "kl": 0.011134927788326343, "entropy": 1.5357136947137338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 369.06999999999994, "episode_reward_min": -209.75988930236463, "episode_reward_mean": 98.04462532680861, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -679.0006156007797, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.25810035297854, "predator_policy": 625.7653236641835}, "policy_reward_mean": {"prey_policy": -108.82676997242255, "predator_policy": 157.8490826358268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.33126445581846, 183.3360896826189, 176.20414453680834, 308.10641374866367, 182.32018882939138, 369.06999999999994, 264.34794040286795, 144.30999999999966, 257.8852024762775, 204.7760248010759, 143.12990413621284, 308.0951933964382, 39.639999999999944, 102.80256012278713, 119.81971812687152, 208.32995717958076, 257.55999999999995, 267.7700000000001, 60.37862519982798, 190.7272093342331, 244.5699999999999, 108.48000000000025, 59.16993297102242, 193.1599999999996, 24.126542880453368, 194.6299999999997, 154.0927154986561, 131.29000000000025, 50.288297724232024, 179.98445390998415, 165.53367377159822, 191.9525887232133, 224.01290368724267, 185.95000000000005, 245.10873783374444, 130.10221723447856, 213.03363712155036, 5.083158447075072, 28.60000000000037, 68.28669424635592, 165.543322512845, -8.396432654276294, 30.810000000000013, 235.78999999999985, 27.662448946882485, 74.56039438684547, 110.5173879112963, 39.435070116065, 24.639179700979025, 179.1111578603719, 65.05685837567059, 149.71781982202285, 48.445929371877575, 216.31999999999942, 101.08000000000072, 174.26384281054206, 64.06710378260662, 200.33027092938835, 6.9000618018581825, 31.660519135907684, 91.75872986483924, -106.02642955705178, -41.165343738908064, 62.918824466549026, -7.493849153564291, 57.37096307642789, 55.51999999999993, 0.397284397712635, 55.46837978791099, 55.112790904251234, 78.98710228949831, 96.29324418198395, 21.089896970770475, 148.81999999999982, 25.441062971026795, -32.93572521718259, -14.195031109245217, 33.84907724689417, 126.79925152869632, 15.276763549740298, 18.280000000000335, 95.83007782050126, -209.75988930236463, 41.05940807094049, 108.62801931695901, 42.420108992935035, 103.46922390000434, 30.25666900169107, -8.172288970930323, 81.61155630933192, 74.7344859608375, 24.494421137674337, -196.67273300052895, -16.179217141737794, 31.407072741017334, 54.97200232878717, 22.571310167931962, 112.79136733068097, 75.05999999999995, 33.463020266816905], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-51.10036132931839, -81.66595369750033, -306.37925568798414, 68.25093666654617, -187.66087372707068, 81.49593261644215, -45.792007068110856, 176.05572657310404, 114.222114804905, -245.06428675891328, 191.25810035297854, 146.1745151285251, -363.42455884858015, 115.86253011120291, 62.9325676738897, -94.07331601724904, 24.107338833431125, 35.1222258544573, 86.87394791386494, 11.82723541366432, -61.82401133907421, -130.2797163186612, -40.13892826288728, 52.211275603921344, -63.59577016740227, -97.30739385410259, -6.419488906226002, -232.78401323147364, -45.96613162166013, -207.85745461582252, -379.7345393758129, 39.873481510248034, -16.25890426033828, 151.1028886663478, 55.92975397594076, 81.12190570723136, -221.4430271994659, -46.54923400700185, -51.25244277821288, -58.59667022799228, 18.118546269199975, 64.1069114342854, -110.91609684726397, -77.35595818756444, -83.64927844102857, -170.16656295674758, -182.0083195088023, 152.45446839213173, -77.80963740825699, -325.86398455407556, 58.28673377598889, 35.203428357750006, 52.730402604559515, -227.78828055478982, -175.85586510429695, 41.149365386829054, -390.6116097338486, -145.37549951318684, 52.001062683600864, -13.317828972800335, -110.5376312207943, -55.752076526935596, 56.18854197523298, -107.69483532089973, 44.12652447809219, 45.293467227226905, -194.51197343160675, 122.60172113132606, 110.42718541498927, -70.59438901771074, 18.91111366540873, -205.72079721009482, 91.27908785980404, -62.53664021310557, -384.52629236463065, -57.4602675309355, -87.44797767243205, -94.35374506907294, -289.95621060228495, -107.78422547661319, -196.86268746868046, 58.33038279168253, -332.79577394830017, -316.0097379015608, -35.82087500016896, -51.35444953135025, 71.52474085534034, -3.2297728470185874, -161.72044925812685, -14.128760869381535, -262.6802468788553, -123.70954208168536, -58.67722968843781, -32.589926371106365, -138.05400673773076, -204.29373189067877, -146.02536157652077, -41.39131960782763, 31.334016880864436, -136.733400509008, -90.39953335037349, -98.02625533242126, -29.944152280462024, 20.196926049671408, 0.7505909760731594, -214.10616849079108, 4.550192933918462, 94.07000000000026, 45.23410962301697, -104.71448229072888, 45.693894302838245, -96.9878394303002, -111.11178693970173, -172.7320065357503, -25.844491826920834, -139.861153061642, -257.9669626217665, -109.88359455597852, -115.97355282045201, -59.34726933165258, -25.16327690976532, -65.02888387060241, -225.05586375843788, -344.29500625567465, -355.7637909517543, -368.9728172840685, -138.04476344542067, -162.35921061179164, -328.6681347320205, -317.73644836816703, -127.35467678319364, -96.14328782650567, -420.7909074518159, -159.98593363876194, -200.26652221886098, -149.69552400580247, -113.13875759897986, -368.0824933313169, -175.66667509098696, -147.16128186977275, -331.5706733324824, 16.833366627574446, 2.8795219187344436, -55.42148197321691, -156.96579354429255, -343.04474666923335, 80.99372835035315, -51.138315137534285, -255.40699124262974, -1.8552894538099458, -162.4180613043137, -291.33245090246896, -157.33603435391393, -258.70728012769393, -69.98470787751235, -68.00269582445625, -111.23282981680336, -252.09635070245446, -291.52187964812555, -382.74826687364595, -60.43244517731465, 0.37460235114577467, -12.261128474439548, -80.36525109406864, -531.2246917401916, -351.8513340261332, -94.14285252779014, -194.81719380381392, 42.48695154577195, -63.041812684678156, -9.848372199992363, -219.54934333694544, -229.61488405659136, -59.70979915386087, -78.939345830978, -209.9669099174428, -293.86690515709915, -99.69232031389576, -361.60989736229124, -149.8312113067502, 54.5521791405313, -398.7878056473872, -132.2782352101641, -134.5116971000297, -679.0006156007797, -552.6313365135118, -139.56684106409108, -119.93685309583519, -172.57119097711734, -26.910298045335157, -23.918528707083798, -73.31099139574631, -221.65800174935265, -175.31587152631505, 20.93709692424097, -148.1504503632892, -438.1521107317623, 9.078380276867227, -21.767652620465107, -5.34258701940873], "policy_predator_policy_reward": [62.357022339886285, 107.74055714275144, 251.09796499409805, 170.36644370995847, 247.08960876694758, 35.27947688048935, 161.84200706811077, 16.000687175559623, 42.98288534686636, 270.1794754365332, 4.741899647021461, 26.895484871474856, 330.42890965750263, 181.48105948274258, 15.45101219048188, 159.99973615287738, 120.08967402411983, 78.56596376426971, 59.25603771937328, 46.81880375417335, 185.2769348439793, 149.9566969499692, 141.0357368121117, 154.98710924329242, 65.23577016740278, 135.30739385410268, 71.58754320345422, 270.41851905703174, 145.2306300152943, 228.41267434905996, 315.37528354109196, 232.81573150405393, 88.8549151748719, 33.861100419118664, 105.3035293677281, 25.414810949099774, 50.56312520650196, 277.80776119979373, 168.50242404879828, 132.07389829164, 41.42020439704461, 120.92433789947002, 198.20609684726398, 98.54595818756495, 271.65203323312613, 41.33374113567195, 195.26611550683188, 27.44773560983767, 10.574362532347124, 417.22580231043895, 1.1232662240110844, 100.01657164225004, 321.4196007044147, 7.730992744472086, 207.45980305609112, 58.536696661376496, 494.0660657596424, 92.20934121162497, 90.43921963219164, 50.86200056699214, 256.61011047936273, 75.21327103996565, 158.36359910482793, 85.09528296405227, 79.28460911897507, 55.308302862948565, 97.91694650245535, 159.9433057978252, 30.26779491796169, 175.00814651850425, 6.20245026744609, 310.70945051171856, 112.69313236633542, 71.59805710851683, 0.0, 447.06971834264135, 88.75797767243232, 121.64374506907359, 186.9821923584019, 279.0449379668518, 173.96470614225967, 130.11092104758316, 211.59125983922712, 428.81781935635655, 72.86812579915917, 45.1171987323595, 33.44667898166167, 134.04835301001668, 107.763712189001, 95.74794688538915, 297.83557669332157, 163.1146066540647, 49.28266621464084, 152.50187775619986, 197.20082752486786, 184.5819812196062, 204.42721010978653, 7.628650775539601, 71.23838143592488, 213.272160052591, 159.66912471576273, 93.81352234270214, 132.0059634562422, 27.45908259657193, 192.74287437803284, 69.05863250856282, 117.69980706608156, 0.0, 58.48460297897055, 102.07576968874187, 36.46159280882402, 189.09619512918027, 160.03406368597672, 187.8768335720823, 147.2028885386153, 218.833027279336, 221.06097039570375, 153.68964858389944, 101.71226180849125, 105.2690794795209, 143.0146949697952, 38.93619567541191, 450.99602321002806, 12.32841724703254, 221.2495091266038, 462.32175537031054, 94.40864725448318, 268.91415126927706, 454.79511623479164, 184.11561771183156, 142.9285244629401, 137.94040322318725, 421.0309074518159, 215.26593363876194, 151.29749641602004, 199.06183420635514, 253.893722532819, 282.79590818538975, 202.56102300883882, 175.37972485617212, 330.6907471067602, 63.03366188764508, 64.8382542609199, 83.99694997554587, 219.99967190198052, 301.1007652823161, 19.836271649647003, 99.12831513753467, 207.19063051241068, 75.51271315505535, 71.62585437127059, 349.188932618329, 172.67023605473938, 229.1780473176228, 143.25047804768917, 28.586002901173515, 350.18609560386875, 139.94233644408556, 397.47371429486935, 292.0731957766425, 72.75632410470904, 5.581518721459821, 75.41308147057057, 113.04337591843871, 137.4297504818968, 535.8863859820638, 194.47030459761186, 135.5491498049326, 75.94980203585696, 53.2330784200082, 31.831111864608207, 239.98671266526412, 187.37017621531623, 205.42373089513967, 59.87414339853582, 259.28878135157646, 223.31351189833327, 162.07342460173143, 252.38734459260777, 340.66532038576497, 26.131884275429623, 392.8382281922629, 107.53714166443028, 183.74721178343788, 409.19389544957966, 625.7653236641835, 138.72526781984791, 104.59920919834025, 74.55882538162167, 156.3297363818477, 62.48727013257398, 89.71425229904447, 369.52352285315266, 50.02166059044642, 126.79078422329039, 113.21393654643828, 438.3021107317622, 65.83161972313279, 51.75378932435591, 8.819470582335075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7912323012086664, "mean_inference_ms": 2.429492997395501, "mean_action_processing_ms": 0.3356248204704032, "mean_env_wait_ms": 0.2825207609813004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005765438079833984, "StateBufferConnector_ms": 0.005826354026794434, "ViewRequirementAgentConnector_ms": 0.1275334358215332}, "num_episodes": 18, "episode_return_max": 369.06999999999994, "episode_return_min": -209.75988930236463, "episode_return_mean": 98.04462532680861, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.9918152277705, "num_env_steps_trained_throughput_per_sec": 257.9918152277705, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 15472.288, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15472.233, "sample_time_ms": 1793.882, "learn_time_ms": 13657.104, "learn_throughput": 292.888, "synch_weights_time_ms": 16.927}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "6c58f_00000", "date": "2024-08-16_16-11-56", "timestamp": 1723804916, "time_this_iter_s": 15.543613195419312, "time_total_s": 300.1367757320404, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04d6a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 300.1367757320404, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 60.845454545454544, "ram_util_percent": 82.04545454545456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1943165134500575, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 8.412970458136664, "policy_loss": -0.0071259888415052385, "vf_loss": 8.419452947283547, "vf_explained_var": 0.003797057034477355, "kl": 0.01716011695826717, "entropy": 1.5400808621335913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.010976963604569, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.263983496408613, "policy_loss": -0.008543983523280571, "vf_loss": 9.272418371331755, "vf_explained_var": 0.013800674235379255, "kl": 0.01745613728163591, "entropy": 1.5178353305846926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 271.06205393615284, "episode_reward_min": -209.75988930236463, "episode_reward_mean": 79.1920746124285, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -679.0006156007797, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.45446839213173, "predator_policy": 625.7653236641835}, "policy_reward_mean": {"prey_policy": -132.80990426539572, "predator_policy": 172.4059415716099}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.37862519982798, 190.7272093342331, 244.5699999999999, 108.48000000000025, 59.16993297102242, 193.1599999999996, 24.126542880453368, 194.6299999999997, 154.0927154986561, 131.29000000000025, 50.288297724232024, 179.98445390998415, 165.53367377159822, 191.9525887232133, 224.01290368724267, 185.95000000000005, 245.10873783374444, 130.10221723447856, 213.03363712155036, 5.083158447075072, 28.60000000000037, 68.28669424635592, 165.543322512845, -8.396432654276294, 30.810000000000013, 235.78999999999985, 27.662448946882485, 74.56039438684547, 110.5173879112963, 39.435070116065, 24.639179700979025, 179.1111578603719, 65.05685837567059, 149.71781982202285, 48.445929371877575, 216.31999999999942, 101.08000000000072, 174.26384281054206, 64.06710378260662, 200.33027092938835, 6.9000618018581825, 31.660519135907684, 91.75872986483924, -106.02642955705178, -41.165343738908064, 62.918824466549026, -7.493849153564291, 57.37096307642789, 55.51999999999993, 0.397284397712635, 55.46837978791099, 55.112790904251234, 78.98710228949831, 96.29324418198395, 21.089896970770475, 148.81999999999982, 25.441062971026795, -32.93572521718259, -14.195031109245217, 33.84907724689417, 126.79925152869632, 15.276763549740298, 18.280000000000335, 95.83007782050126, -209.75988930236463, 41.05940807094049, 108.62801931695901, 42.420108992935035, 103.46922390000434, 30.25666900169107, -8.172288970930323, 81.61155630933192, 74.7344859608375, 24.494421137674337, -196.67273300052895, -16.179217141737794, 31.407072741017334, 54.97200232878717, 22.571310167931962, 112.79136733068097, 75.05999999999995, 33.463020266816905, 61.349441946297205, 103.91016781240626, 45.36874369649214, 72.96925970533188, 123.65749943169615, 85.38969488557001, 84.68314616429487, 92.15692065567403, 171.53406484284125, -14.4368187173573, 271.06205393615284, 110.628479066898, 64.51939561111784, 173.9559783118811, 24.323084680402314, -22.49548755015029, 73.42136014736802, 167.58254583048506], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-221.4430271994659, -46.54923400700185, -51.25244277821288, -58.59667022799228, 18.118546269199975, 64.1069114342854, -110.91609684726397, -77.35595818756444, -83.64927844102857, -170.16656295674758, -182.0083195088023, 152.45446839213173, -77.80963740825699, -325.86398455407556, 58.28673377598889, 35.203428357750006, 52.730402604559515, -227.78828055478982, -175.85586510429695, 41.149365386829054, -390.6116097338486, -145.37549951318684, 52.001062683600864, -13.317828972800335, -110.5376312207943, -55.752076526935596, 56.18854197523298, -107.69483532089973, 44.12652447809219, 45.293467227226905, -194.51197343160675, 122.60172113132606, 110.42718541498927, -70.59438901771074, 18.91111366540873, -205.72079721009482, 91.27908785980404, -62.53664021310557, -384.52629236463065, -57.4602675309355, -87.44797767243205, -94.35374506907294, -289.95621060228495, -107.78422547661319, -196.86268746868046, 58.33038279168253, -332.79577394830017, -316.0097379015608, -35.82087500016896, -51.35444953135025, 71.52474085534034, -3.2297728470185874, -161.72044925812685, -14.128760869381535, -262.6802468788553, -123.70954208168536, -58.67722968843781, -32.589926371106365, -138.05400673773076, -204.29373189067877, -146.02536157652077, -41.39131960782763, 31.334016880864436, -136.733400509008, -90.39953335037349, -98.02625533242126, -29.944152280462024, 20.196926049671408, 0.7505909760731594, -214.10616849079108, 4.550192933918462, 94.07000000000026, 45.23410962301697, -104.71448229072888, 45.693894302838245, -96.9878394303002, -111.11178693970173, -172.7320065357503, -25.844491826920834, -139.861153061642, -257.9669626217665, -109.88359455597852, -115.97355282045201, -59.34726933165258, -25.16327690976532, -65.02888387060241, -225.05586375843788, -344.29500625567465, -355.7637909517543, -368.9728172840685, -138.04476344542067, -162.35921061179164, -328.6681347320205, -317.73644836816703, -127.35467678319364, -96.14328782650567, -420.7909074518159, -159.98593363876194, -200.26652221886098, -149.69552400580247, -113.13875759897986, -368.0824933313169, -175.66667509098696, -147.16128186977275, -331.5706733324824, 16.833366627574446, 2.8795219187344436, -55.42148197321691, -156.96579354429255, -343.04474666923335, 80.99372835035315, -51.138315137534285, -255.40699124262974, -1.8552894538099458, -162.4180613043137, -291.33245090246896, -157.33603435391393, -258.70728012769393, -69.98470787751235, -68.00269582445625, -111.23282981680336, -252.09635070245446, -291.52187964812555, -382.74826687364595, -60.43244517731465, 0.37460235114577467, -12.261128474439548, -80.36525109406864, -531.2246917401916, -351.8513340261332, -94.14285252779014, -194.81719380381392, 42.48695154577195, -63.041812684678156, -9.848372199992363, -219.54934333694544, -229.61488405659136, -59.70979915386087, -78.939345830978, -209.9669099174428, -293.86690515709915, -99.69232031389576, -361.60989736229124, -149.8312113067502, 54.5521791405313, -398.7878056473872, -132.2782352101641, -134.5116971000297, -679.0006156007797, -552.6313365135118, -139.56684106409108, -119.93685309583519, -172.57119097711734, -26.910298045335157, -23.918528707083798, -73.31099139574631, -221.65800174935265, -175.31587152631505, 20.93709692424097, -148.1504503632892, -438.1521107317623, 9.078380276867227, -21.767652620465107, -5.34258701940873, -186.59004467192622, -98.31647957197814, -405.03238760983726, -26.246547918069126, -209.92473902864998, -242.34145002391463, 4.282678550264713, -86.94956749365248, -124.98011006422925, 11.32205369463543, -658.8547097291889, -238.48128998865317, -143.01611445634663, -182.37273783433793, -242.24444826474056, -83.0391219701853, -85.74346948655393, -264.42563328865543, -375.33809736612415, -181.06233199985607, -194.55668312320398, -75.14601291245626, -228.16653562260822, 70.48229508218269, -165.5248010990953, -54.31967499822637, -191.2313410873835, 109.46160120879604, -69.68141950611776, -66.27411596327437, -369.88946714226074, -110.13985990418885, -141.32376460368664, -168.2849519153796, -392.99515775222164, -92.58690841499651], "policy_predator_policy_reward": [50.56312520650196, 277.80776119979373, 168.50242404879828, 132.07389829164, 41.42020439704461, 120.92433789947002, 198.20609684726398, 98.54595818756495, 271.65203323312613, 41.33374113567195, 195.26611550683188, 27.44773560983767, 10.574362532347124, 417.22580231043895, 1.1232662240110844, 100.01657164225004, 321.4196007044147, 7.730992744472086, 207.45980305609112, 58.536696661376496, 494.0660657596424, 92.20934121162497, 90.43921963219164, 50.86200056699214, 256.61011047936273, 75.21327103996565, 158.36359910482793, 85.09528296405227, 79.28460911897507, 55.308302862948565, 97.91694650245535, 159.9433057978252, 30.26779491796169, 175.00814651850425, 6.20245026744609, 310.70945051171856, 112.69313236633542, 71.59805710851683, 0.0, 447.06971834264135, 88.75797767243232, 121.64374506907359, 186.9821923584019, 279.0449379668518, 173.96470614225967, 130.11092104758316, 211.59125983922712, 428.81781935635655, 72.86812579915917, 45.1171987323595, 33.44667898166167, 134.04835301001668, 107.763712189001, 95.74794688538915, 297.83557669332157, 163.1146066540647, 49.28266621464084, 152.50187775619986, 197.20082752486786, 184.5819812196062, 204.42721010978653, 7.628650775539601, 71.23838143592488, 213.272160052591, 159.66912471576273, 93.81352234270214, 132.0059634562422, 27.45908259657193, 192.74287437803284, 69.05863250856282, 117.69980706608156, 0.0, 58.48460297897055, 102.07576968874187, 36.46159280882402, 189.09619512918027, 160.03406368597672, 187.8768335720823, 147.2028885386153, 218.833027279336, 221.06097039570375, 153.68964858389944, 101.71226180849125, 105.2690794795209, 143.0146949697952, 38.93619567541191, 450.99602321002806, 12.32841724703254, 221.2495091266038, 462.32175537031054, 94.40864725448318, 268.91415126927706, 454.79511623479164, 184.11561771183156, 142.9285244629401, 137.94040322318725, 421.0309074518159, 215.26593363876194, 151.29749641602004, 199.06183420635514, 253.893722532819, 282.79590818538975, 202.56102300883882, 175.37972485617212, 330.6907471067602, 63.03366188764508, 64.8382542609199, 83.99694997554587, 219.99967190198052, 301.1007652823161, 19.836271649647003, 99.12831513753467, 207.19063051241068, 75.51271315505535, 71.62585437127059, 349.188932618329, 172.67023605473938, 229.1780473176228, 143.25047804768917, 28.586002901173515, 350.18609560386875, 139.94233644408556, 397.47371429486935, 292.0731957766425, 72.75632410470904, 5.581518721459821, 75.41308147057057, 113.04337591843871, 137.4297504818968, 535.8863859820638, 194.47030459761186, 135.5491498049326, 75.94980203585696, 53.2330784200082, 31.831111864608207, 239.98671266526412, 187.37017621531623, 205.42373089513967, 59.87414339853582, 259.28878135157646, 223.31351189833327, 162.07342460173143, 252.38734459260777, 340.66532038576497, 26.131884275429623, 392.8382281922629, 107.53714166443028, 183.74721178343788, 409.19389544957966, 625.7653236641835, 138.72526781984791, 104.59920919834025, 74.55882538162167, 156.3297363818477, 62.48727013257398, 89.71425229904447, 369.52352285315266, 50.02166059044642, 126.79078422329039, 113.21393654643828, 438.3021107317622, 65.83161972313279, 51.75378932435591, 8.819470582335075, 186.27721588011352, 159.9787503100887, 369.4311203114439, 165.7579830288677, 142.03647122963378, 355.598461519423, 5.107975205465527, 150.52817344325416, 49.79738168653241, 187.51817411475673, 591.5022168617468, 391.22347774166514, 172.6908114298673, 237.38118702511164, 201.31541096205973, 216.1250799285399, 195.8353783797535, 325.8677892382972, 293.0040356411656, 248.95957500745635, 262.81694279488215, 277.94780717693124, 224.45127383006724, 43.861445777256016, 152.18891515195375, 132.17495655648628, 181.89707851745285, 73.82863967301601, 128.9536408806899, 31.32497926910504, 329.46072772367796, 128.07311177262193, 156.51831862223236, 226.5117580442009, 337.37103879974325, 315.7935731979602]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7879868772692055, "mean_inference_ms": 2.4310679226635665, "mean_action_processing_ms": 0.33449634898523456, "mean_env_wait_ms": 0.28156526603806076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00577092170715332, "StateBufferConnector_ms": 0.003807544708251953, "ViewRequirementAgentConnector_ms": 0.12090563774108887}, "num_episodes": 18, "episode_return_max": 271.06205393615284, "episode_return_min": -209.75988930236463, "episode_return_mean": 79.1920746124285, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.98354489665007, "num_env_steps_trained_throughput_per_sec": 252.98354489665007, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 15489.595, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15489.541, "sample_time_ms": 1822.996, "learn_time_ms": 13641.919, "learn_throughput": 293.214, "synch_weights_time_ms": 20.387}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "6c58f_00000", "date": "2024-08-16_16-12-11", "timestamp": 1723804931, "time_this_iter_s": 15.890794038772583, "time_total_s": 316.027569770813, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0481e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 316.027569770813, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 59.56363636363637, "ram_util_percent": 82.18636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4676910674130474, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 3.635918778591055, "policy_loss": -0.005215235300135439, "vf_loss": 3.6407524861986675, "vf_explained_var": 0.0023024879120014333, "kl": 0.010174194396973682, "entropy": 1.5598773263118886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.962225445900014, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.466500581509221, "policy_loss": -0.0022324926414522073, "vf_loss": 9.468663263068628, "vf_explained_var": 0.023995727710622958, "kl": 0.01116942716774045, "entropy": 1.4492081638997194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 328.2792481984748, "episode_reward_min": -209.75988930236463, "episode_reward_mean": 83.94987896886796, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -679.0006156007797, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 167.12054014450592, "predator_policy": 625.7653236641835}, "policy_reward_mean": {"prey_policy": -132.068726274655, "predator_policy": 174.04366575908898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [213.03363712155036, 5.083158447075072, 28.60000000000037, 68.28669424635592, 165.543322512845, -8.396432654276294, 30.810000000000013, 235.78999999999985, 27.662448946882485, 74.56039438684547, 110.5173879112963, 39.435070116065, 24.639179700979025, 179.1111578603719, 65.05685837567059, 149.71781982202285, 48.445929371877575, 216.31999999999942, 101.08000000000072, 174.26384281054206, 64.06710378260662, 200.33027092938835, 6.9000618018581825, 31.660519135907684, 91.75872986483924, -106.02642955705178, -41.165343738908064, 62.918824466549026, -7.493849153564291, 57.37096307642789, 55.51999999999993, 0.397284397712635, 55.46837978791099, 55.112790904251234, 78.98710228949831, 96.29324418198395, 21.089896970770475, 148.81999999999982, 25.441062971026795, -32.93572521718259, -14.195031109245217, 33.84907724689417, 126.79925152869632, 15.276763549740298, 18.280000000000335, 95.83007782050126, -209.75988930236463, 41.05940807094049, 108.62801931695901, 42.420108992935035, 103.46922390000434, 30.25666900169107, -8.172288970930323, 81.61155630933192, 74.7344859608375, 24.494421137674337, -196.67273300052895, -16.179217141737794, 31.407072741017334, 54.97200232878717, 22.571310167931962, 112.79136733068097, 75.05999999999995, 33.463020266816905, 61.349441946297205, 103.91016781240626, 45.36874369649214, 72.96925970533188, 123.65749943169615, 85.38969488557001, 84.68314616429487, 92.15692065567403, 171.53406484284125, -14.4368187173573, 271.06205393615284, 110.628479066898, 64.51939561111784, 173.9559783118811, 24.323084680402314, -22.49548755015029, 73.42136014736802, 167.58254583048506, 109.41736147601694, 169.8422193972192, 199.90554631030858, 141.78875672616016, 132.34842003126454, 246.86999999999983, 32.78591619009694, 256.05, 143.7919073244317, 277.7512281895862, 134.22671746136626, 267.89999999999986, 82.49014530832724, 328.2792481984748, 79.28893467017402, 230.21092255456443, 87.39101057464349, 288.9999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [91.27908785980404, -62.53664021310557, -384.52629236463065, -57.4602675309355, -87.44797767243205, -94.35374506907294, -289.95621060228495, -107.78422547661319, -196.86268746868046, 58.33038279168253, -332.79577394830017, -316.0097379015608, -35.82087500016896, -51.35444953135025, 71.52474085534034, -3.2297728470185874, -161.72044925812685, -14.128760869381535, -262.6802468788553, -123.70954208168536, -58.67722968843781, -32.589926371106365, -138.05400673773076, -204.29373189067877, -146.02536157652077, -41.39131960782763, 31.334016880864436, -136.733400509008, -90.39953335037349, -98.02625533242126, -29.944152280462024, 20.196926049671408, 0.7505909760731594, -214.10616849079108, 4.550192933918462, 94.07000000000026, 45.23410962301697, -104.71448229072888, 45.693894302838245, -96.9878394303002, -111.11178693970173, -172.7320065357503, -25.844491826920834, -139.861153061642, -257.9669626217665, -109.88359455597852, -115.97355282045201, -59.34726933165258, -25.16327690976532, -65.02888387060241, -225.05586375843788, -344.29500625567465, -355.7637909517543, -368.9728172840685, -138.04476344542067, -162.35921061179164, -328.6681347320205, -317.73644836816703, -127.35467678319364, -96.14328782650567, -420.7909074518159, -159.98593363876194, -200.26652221886098, -149.69552400580247, -113.13875759897986, -368.0824933313169, -175.66667509098696, -147.16128186977275, -331.5706733324824, 16.833366627574446, 2.8795219187344436, -55.42148197321691, -156.96579354429255, -343.04474666923335, 80.99372835035315, -51.138315137534285, -255.40699124262974, -1.8552894538099458, -162.4180613043137, -291.33245090246896, -157.33603435391393, -258.70728012769393, -69.98470787751235, -68.00269582445625, -111.23282981680336, -252.09635070245446, -291.52187964812555, -382.74826687364595, -60.43244517731465, 0.37460235114577467, -12.261128474439548, -80.36525109406864, -531.2246917401916, -351.8513340261332, -94.14285252779014, -194.81719380381392, 42.48695154577195, -63.041812684678156, -9.848372199992363, -219.54934333694544, -229.61488405659136, -59.70979915386087, -78.939345830978, -209.9669099174428, -293.86690515709915, -99.69232031389576, -361.60989736229124, -149.8312113067502, 54.5521791405313, -398.7878056473872, -132.2782352101641, -134.5116971000297, -679.0006156007797, -552.6313365135118, -139.56684106409108, -119.93685309583519, -172.57119097711734, -26.910298045335157, -23.918528707083798, -73.31099139574631, -221.65800174935265, -175.31587152631505, 20.93709692424097, -148.1504503632892, -438.1521107317623, 9.078380276867227, -21.767652620465107, -5.34258701940873, -186.59004467192622, -98.31647957197814, -405.03238760983726, -26.246547918069126, -209.92473902864998, -242.34145002391463, 4.282678550264713, -86.94956749365248, -124.98011006422925, 11.32205369463543, -658.8547097291889, -238.48128998865317, -143.01611445634663, -182.37273783433793, -242.24444826474056, -83.0391219701853, -85.74346948655393, -264.42563328865543, -375.33809736612415, -181.06233199985607, -194.55668312320398, -75.14601291245626, -228.16653562260822, 70.48229508218269, -165.5248010990953, -54.31967499822637, -191.2313410873835, 109.46160120879604, -69.68141950611776, -66.27411596327437, -369.88946714226074, -110.13985990418885, -141.32376460368664, -168.2849519153796, -392.99515775222164, -92.58690841499651, -286.3706137105096, 37.13471358414949, -45.10291019813282, 17.07651669771807, 41.95701209555668, 72.23519448899003, -239.92079715035675, -84.97399766572074, -381.72102165230376, -158.64364911790946, 102.73778244671212, 54.97327185598348, -207.42907481967688, -326.2862357617964, 114.03524941736694, 64.10370020803522, -91.75998892456596, -267.78010110095784, 117.32687991299396, 117.07136563387473, 25.62466329808904, -116.47797624025966, 122.48811006564824, 95.60704038845708, 27.721046142910183, -198.57041962441332, -27.11877656065788, 167.12054014450592, -339.3910966545386, -302.66876818273283, -75.69915760013411, 121.2120512334097, -274.48488259860784, -230.9541516760656, 150.28158605659746, 123.1099677897244], "policy_predator_policy_reward": [112.69313236633542, 71.59805710851683, 0.0, 447.06971834264135, 88.75797767243232, 121.64374506907359, 186.9821923584019, 279.0449379668518, 173.96470614225967, 130.11092104758316, 211.59125983922712, 428.81781935635655, 72.86812579915917, 45.1171987323595, 33.44667898166167, 134.04835301001668, 107.763712189001, 95.74794688538915, 297.83557669332157, 163.1146066540647, 49.28266621464084, 152.50187775619986, 197.20082752486786, 184.5819812196062, 204.42721010978653, 7.628650775539601, 71.23838143592488, 213.272160052591, 159.66912471576273, 93.81352234270214, 132.0059634562422, 27.45908259657193, 192.74287437803284, 69.05863250856282, 117.69980706608156, 0.0, 58.48460297897055, 102.07576968874187, 36.46159280882402, 189.09619512918027, 160.03406368597672, 187.8768335720823, 147.2028885386153, 218.833027279336, 221.06097039570375, 153.68964858389944, 101.71226180849125, 105.2690794795209, 143.0146949697952, 38.93619567541191, 450.99602321002806, 12.32841724703254, 221.2495091266038, 462.32175537031054, 94.40864725448318, 268.91415126927706, 454.79511623479164, 184.11561771183156, 142.9285244629401, 137.94040322318725, 421.0309074518159, 215.26593363876194, 151.29749641602004, 199.06183420635514, 253.893722532819, 282.79590818538975, 202.56102300883882, 175.37972485617212, 330.6907471067602, 63.03366188764508, 64.8382542609199, 83.99694997554587, 219.99967190198052, 301.1007652823161, 19.836271649647003, 99.12831513753467, 207.19063051241068, 75.51271315505535, 71.62585437127059, 349.188932618329, 172.67023605473938, 229.1780473176228, 143.25047804768917, 28.586002901173515, 350.18609560386875, 139.94233644408556, 397.47371429486935, 292.0731957766425, 72.75632410470904, 5.581518721459821, 75.41308147057057, 113.04337591843871, 137.4297504818968, 535.8863859820638, 194.47030459761186, 135.5491498049326, 75.94980203585696, 53.2330784200082, 31.831111864608207, 239.98671266526412, 187.37017621531623, 205.42373089513967, 59.87414339853582, 259.28878135157646, 223.31351189833327, 162.07342460173143, 252.38734459260777, 340.66532038576497, 26.131884275429623, 392.8382281922629, 107.53714166443028, 183.74721178343788, 409.19389544957966, 625.7653236641835, 138.72526781984791, 104.59920919834025, 74.55882538162167, 156.3297363818477, 62.48727013257398, 89.71425229904447, 369.52352285315266, 50.02166059044642, 126.79078422329039, 113.21393654643828, 438.3021107317622, 65.83161972313279, 51.75378932435591, 8.819470582335075, 186.27721588011352, 159.9787503100887, 369.4311203114439, 165.7579830288677, 142.03647122963378, 355.598461519423, 5.107975205465527, 150.52817344325416, 49.79738168653241, 187.51817411475673, 591.5022168617468, 391.22347774166514, 172.6908114298673, 237.38118702511164, 201.31541096205973, 216.1250799285399, 195.8353783797535, 325.8677892382972, 293.0040356411656, 248.95957500745635, 262.81694279488215, 277.94780717693124, 224.45127383006724, 43.861445777256016, 152.18891515195375, 132.17495655648628, 181.89707851745285, 73.82863967301601, 128.9536408806899, 31.32497926910504, 329.46072772367796, 128.07311177262193, 156.51831862223236, 226.5117580442009, 337.37103879974325, 315.7935731979602, 159.32904093102215, 199.3242206713546, 52.3311105563362, 145.537502341298, 20.26789473553475, 65.44544499022723, 312.9523431600404, 153.73120838219683, 315.20319069506706, 357.5099001064104, 37.50221755328789, 51.656728144016505, 201.50918526555245, 364.9920415060169, 42.23475058263302, 35.676299791964766, 336.7413937644509, 166.59060358550457, 40.341808675936186, 3.011173966781638, 27.698331323392054, 197.38169908014487, 9.489171126703713, 40.31567841919116, 173.46113784368632, 79.87838094614403, 85.71070958272931, 102.56677503189779, 387.15078654487957, 334.1980129625648, 86.93161419785744, 97.76641472343172, 269.9581548252662, 322.8718900240507, 11.028413943402434, 4.580032210275607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7879649129893721, "mean_inference_ms": 2.4419832457650754, "mean_action_processing_ms": 0.33507023562656923, "mean_env_wait_ms": 0.2822906813114133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006081700325012207, "StateBufferConnector_ms": 0.0038552284240722656, "ViewRequirementAgentConnector_ms": 0.1456308364868164}, "num_episodes": 18, "episode_return_max": 328.2792481984748, "episode_return_min": -209.75988930236463, "episode_return_mean": 83.94987896886796, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.8839065701548, "num_env_steps_trained_throughput_per_sec": 251.8839065701548, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 15487.015, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15486.961, "sample_time_ms": 1883.338, "learn_time_ms": 13577.04, "learn_throughput": 294.615, "synch_weights_time_ms": 22.693}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "6c58f_00000", "date": "2024-08-16_16-12-27", "timestamp": 1723804947, "time_this_iter_s": 15.925734758377075, "time_total_s": 331.95330452919006, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 331.95330452919006, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 61.44782608695652, "ram_util_percent": 81.98695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4117529205544286, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 3.7042373358257232, "policy_loss": -0.008733850391335273, "vf_loss": 3.7123306234046898, "vf_explained_var": 0.003825755756368082, "kl": 0.01708134490591468, "entropy": 1.5564426808130174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7353509782325653, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.359913433922662, "policy_loss": -0.007594748947981292, "vf_loss": 9.367421756724202, "vf_explained_var": 0.025753752264396225, "kl": 0.01382752161453233, "entropy": 1.4759048912260266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 356.21999999999986, "episode_reward_min": -209.75988930236463, "episode_reward_mean": 125.95520914558381, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -679.0006156007797, "predator_policy": 0.7956921398945732}, "policy_reward_max": {"prey_policy": 167.12054014450592, "predator_policy": 625.7653236641835}, "policy_reward_mean": {"prey_policy": -94.86348537584767, "predator_policy": 157.84108994863954}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.918824466549026, -7.493849153564291, 57.37096307642789, 55.51999999999993, 0.397284397712635, 55.46837978791099, 55.112790904251234, 78.98710228949831, 96.29324418198395, 21.089896970770475, 148.81999999999982, 25.441062971026795, -32.93572521718259, -14.195031109245217, 33.84907724689417, 126.79925152869632, 15.276763549740298, 18.280000000000335, 95.83007782050126, -209.75988930236463, 41.05940807094049, 108.62801931695901, 42.420108992935035, 103.46922390000434, 30.25666900169107, -8.172288970930323, 81.61155630933192, 74.7344859608375, 24.494421137674337, -196.67273300052895, -16.179217141737794, 31.407072741017334, 54.97200232878717, 22.571310167931962, 112.79136733068097, 75.05999999999995, 33.463020266816905, 61.349441946297205, 103.91016781240626, 45.36874369649214, 72.96925970533188, 123.65749943169615, 85.38969488557001, 84.68314616429487, 92.15692065567403, 171.53406484284125, -14.4368187173573, 271.06205393615284, 110.628479066898, 64.51939561111784, 173.9559783118811, 24.323084680402314, -22.49548755015029, 73.42136014736802, 167.58254583048506, 109.41736147601694, 169.8422193972192, 199.90554631030858, 141.78875672616016, 132.34842003126454, 246.86999999999983, 32.78591619009694, 256.05, 143.7919073244317, 277.7512281895862, 134.22671746136626, 267.89999999999986, 82.49014530832724, 328.2792481984748, 79.28893467017402, 230.21092255456443, 87.39101057464349, 288.9999999999998, 227.81153228645076, 230.67999999999995, 325.71709831151156, 196.03253990720262, 213.097596021529, 268.03999999999996, 53.93764842167135, 169.4700000000002, 285.9534656891112, 161.9366273271383, 255.03000000000003, 123.97879706879436, 316.0049592016145, 129.72365092352294, 230.3557144558269, 275.39, 332.5861243477327, 167.55037200010116, 167.73000000000013, 305.3999999999998, 267.6999999999999, 278.5269826556478, 257.83000000000015, 241.54590703053276, 248.15938321794155, 356.21999999999986, 311.2099999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-138.04476344542067, -162.35921061179164, -328.6681347320205, -317.73644836816703, -127.35467678319364, -96.14328782650567, -420.7909074518159, -159.98593363876194, -200.26652221886098, -149.69552400580247, -113.13875759897986, -368.0824933313169, -175.66667509098696, -147.16128186977275, -331.5706733324824, 16.833366627574446, 2.8795219187344436, -55.42148197321691, -156.96579354429255, -343.04474666923335, 80.99372835035315, -51.138315137534285, -255.40699124262974, -1.8552894538099458, -162.4180613043137, -291.33245090246896, -157.33603435391393, -258.70728012769393, -69.98470787751235, -68.00269582445625, -111.23282981680336, -252.09635070245446, -291.52187964812555, -382.74826687364595, -60.43244517731465, 0.37460235114577467, -12.261128474439548, -80.36525109406864, -531.2246917401916, -351.8513340261332, -94.14285252779014, -194.81719380381392, 42.48695154577195, -63.041812684678156, -9.848372199992363, -219.54934333694544, -229.61488405659136, -59.70979915386087, -78.939345830978, -209.9669099174428, -293.86690515709915, -99.69232031389576, -361.60989736229124, -149.8312113067502, 54.5521791405313, -398.7878056473872, -132.2782352101641, -134.5116971000297, -679.0006156007797, -552.6313365135118, -139.56684106409108, -119.93685309583519, -172.57119097711734, -26.910298045335157, -23.918528707083798, -73.31099139574631, -221.65800174935265, -175.31587152631505, 20.93709692424097, -148.1504503632892, -438.1521107317623, 9.078380276867227, -21.767652620465107, -5.34258701940873, -186.59004467192622, -98.31647957197814, -405.03238760983726, -26.246547918069126, -209.92473902864998, -242.34145002391463, 4.282678550264713, -86.94956749365248, -124.98011006422925, 11.32205369463543, -658.8547097291889, -238.48128998865317, -143.01611445634663, -182.37273783433793, -242.24444826474056, -83.0391219701853, -85.74346948655393, -264.42563328865543, -375.33809736612415, -181.06233199985607, -194.55668312320398, -75.14601291245626, -228.16653562260822, 70.48229508218269, -165.5248010990953, -54.31967499822637, -191.2313410873835, 109.46160120879604, -69.68141950611776, -66.27411596327437, -369.88946714226074, -110.13985990418885, -141.32376460368664, -168.2849519153796, -392.99515775222164, -92.58690841499651, -286.3706137105096, 37.13471358414949, -45.10291019813282, 17.07651669771807, 41.95701209555668, 72.23519448899003, -239.92079715035675, -84.97399766572074, -381.72102165230376, -158.64364911790946, 102.73778244671212, 54.97327185598348, -207.42907481967688, -326.2862357617964, 114.03524941736694, 64.10370020803522, -91.75998892456596, -267.78010110095784, 117.32687991299396, 117.07136563387473, 25.62466329808904, -116.47797624025966, 122.48811006564824, 95.60704038845708, 27.721046142910183, -198.57041962441332, -27.11877656065788, 167.12054014450592, -339.3910966545386, -302.66876818273283, -75.69915760013411, 121.2120512334097, -274.48488259860784, -230.9541516760656, 150.28158605659746, 123.1099677897244, 129.96955657831109, 18.483935380049015, -47.91346425102722, 104.98372252489872, 137.45178439564518, 162.21520486452746, 97.74271179603137, 3.721778454480737, 23.3981321262601, 22.631153686386043, 94.15840402231572, 128.92132205290426, -114.14047926698694, -227.26957274762998, 26.768355257265945, -19.432766627540325, 141.6354139718302, -35.623907960135654, 21.56542155165155, -346.2253737517469, -156.38430840958304, 88.02412217356118, 9.237113737993106, -344.51005751088263, 87.25199134858988, 153.47597143177347, 7.230768524098032, -18.640274193214058, 151.4304049989101, -481.0055633697966, -2.599904694602671, 118.05089161308362, 127.75337039602269, 145.80375678577036, -31.183971448856717, 32.6328023091961, 15.457014358656574, 66.57431326511617, 163.66411264252977, 24.154016617329418, 111.28994537188977, 80.4670170889811, 139.80104323367362, 96.24751970549107, 95.94548366860255, 79.59294755384238, -72.59287587534891, 23.885750379071837, 126.52478889140883, -112.7919082620522, 164.20058891315472, 159.61934016007413, 69.912722046794, 111.13033753115448], "policy_predator_policy_reward": [94.40864725448318, 268.91415126927706, 454.79511623479164, 184.11561771183156, 142.9285244629401, 137.94040322318725, 421.0309074518159, 215.26593363876194, 151.29749641602004, 199.06183420635514, 253.893722532819, 282.79590818538975, 202.56102300883882, 175.37972485617212, 330.6907471067602, 63.03366188764508, 64.8382542609199, 83.99694997554587, 219.99967190198052, 301.1007652823161, 19.836271649647003, 99.12831513753467, 207.19063051241068, 75.51271315505535, 71.62585437127059, 349.188932618329, 172.67023605473938, 229.1780473176228, 143.25047804768917, 28.586002901173515, 350.18609560386875, 139.94233644408556, 397.47371429486935, 292.0731957766425, 72.75632410470904, 5.581518721459821, 75.41308147057057, 113.04337591843871, 137.4297504818968, 535.8863859820638, 194.47030459761186, 135.5491498049326, 75.94980203585696, 53.2330784200082, 31.831111864608207, 239.98671266526412, 187.37017621531623, 205.42373089513967, 59.87414339853582, 259.28878135157646, 223.31351189833327, 162.07342460173143, 252.38734459260777, 340.66532038576497, 26.131884275429623, 392.8382281922629, 107.53714166443028, 183.74721178343788, 409.19389544957966, 625.7653236641835, 138.72526781984791, 104.59920919834025, 74.55882538162167, 156.3297363818477, 62.48727013257398, 89.71425229904447, 369.52352285315266, 50.02166059044642, 126.79078422329039, 113.21393654643828, 438.3021107317622, 65.83161972313279, 51.75378932435591, 8.819470582335075, 186.27721588011352, 159.9787503100887, 369.4311203114439, 165.7579830288677, 142.03647122963378, 355.598461519423, 5.107975205465527, 150.52817344325416, 49.79738168653241, 187.51817411475673, 591.5022168617468, 391.22347774166514, 172.6908114298673, 237.38118702511164, 201.31541096205973, 216.1250799285399, 195.8353783797535, 325.8677892382972, 293.0040356411656, 248.95957500745635, 262.81694279488215, 277.94780717693124, 224.45127383006724, 43.861445777256016, 152.18891515195375, 132.17495655648628, 181.89707851745285, 73.82863967301601, 128.9536408806899, 31.32497926910504, 329.46072772367796, 128.07311177262193, 156.51831862223236, 226.5117580442009, 337.37103879974325, 315.7935731979602, 159.32904093102215, 199.3242206713546, 52.3311105563362, 145.537502341298, 20.26789473553475, 65.44544499022723, 312.9523431600404, 153.73120838219683, 315.20319069506706, 357.5099001064104, 37.50221755328789, 51.656728144016505, 201.50918526555245, 364.9920415060169, 42.23475058263302, 35.676299791964766, 336.7413937644509, 166.59060358550457, 40.341808675936186, 3.011173966781638, 27.698331323392054, 197.38169908014487, 9.489171126703713, 40.31567841919116, 173.46113784368632, 79.87838094614403, 85.71070958272931, 102.56677503189779, 387.15078654487957, 334.1980129625648, 86.93161419785744, 97.76641472343172, 269.9581548252662, 322.8718900240507, 11.028413943402434, 4.580032210275607, 78.56234818819638, 0.7956921398945732, 12.729502307769536, 160.8802394183591, 2.9557286926382, 23.094380358700796, 32.83976764200398, 61.728282014686485, 81.77884789014158, 85.28946231874104, 31.411595977684364, 13.54867794709574, 39.580755099740315, 355.7669453365477, 38.37164474273408, 123.76276662754053, 25.090636644757232, 154.8513230326594, 367.0713035994462, 119.52527592778732, 246.41430840958301, 76.9758778264388, 250.0003021670181, 209.25143867466613, 51.605213175135546, 23.671783246115545, 45.901072705667964, 95.23208388697103, 84.89767263988344, 475.03320018683013, 11.569208656522463, 148.36980442499654, 45.3366296039773, 13.692367561962588, 141.44397144885684, 24.657569690905135, 54.996739437779276, 30.70193293844818, 11.286262208973069, 106.29560853116777, 57.49640577448782, 18.446631764641364, 9.16483000029146, 33.31358971619189, 51.92595113752513, 30.365617640030077, 252.20995093226531, 38.0430815945445, 129.59864953828665, 104.82785305029842, 21.799411086845296, 10.60065983992571, 65.42314085801857, 64.74379956403295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7879552574501133, "mean_inference_ms": 2.4600875593066722, "mean_action_processing_ms": 0.33649522629425943, "mean_env_wait_ms": 0.2835839892403211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00565946102142334, "StateBufferConnector_ms": 0.003932476043701172, "ViewRequirementAgentConnector_ms": 0.1467902660369873}, "num_episodes": 27, "episode_return_max": 356.21999999999986, "episode_return_min": -209.75988930236463, "episode_return_mean": 125.95520914558381, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.81516743511804, "num_env_steps_trained_throughput_per_sec": 251.81516743511804, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 15556.016, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15555.962, "sample_time_ms": 1881.237, "learn_time_ms": 13648.663, "learn_throughput": 293.069, "synch_weights_time_ms": 22.239}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "6c58f_00000", "date": "2024-08-16_16-12-43", "timestamp": 1723804963, "time_this_iter_s": 15.950401067733765, "time_total_s": 347.9037055969238, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04ddca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 347.9037055969238, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.917391304347824, "ram_util_percent": 81.96521739130434}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6727744879072937, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 1e-05, "total_loss": 6.800855399944164, "policy_loss": -0.01123231480972319, "vf_loss": 6.811169527447412, "vf_explained_var": 0.0062964934205252026, "kl": 0.024485070270361377, "entropy": 1.5460982803314451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9588387454312945, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.339277388052965, "policy_loss": -0.003821870278094023, "vf_loss": 9.343030124240451, "vf_explained_var": 0.025759785295163512, "kl": 0.011063225812241168, "entropy": 1.453147928866129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 356.21999999999986, "episode_reward_min": -209.75988930236463, "episode_reward_mean": 152.2714348603155, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -679.0006156007797, "predator_policy": 0.7956921398945732}, "policy_reward_max": {"prey_policy": 167.12054014450592, "predator_policy": 625.7653236641835}, "policy_reward_mean": {"prey_policy": -69.05672213920344, "predator_policy": 145.19243956936117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.83007782050126, -209.75988930236463, 41.05940807094049, 108.62801931695901, 42.420108992935035, 103.46922390000434, 30.25666900169107, -8.172288970930323, 81.61155630933192, 74.7344859608375, 24.494421137674337, -196.67273300052895, -16.179217141737794, 31.407072741017334, 54.97200232878717, 22.571310167931962, 112.79136733068097, 75.05999999999995, 33.463020266816905, 61.349441946297205, 103.91016781240626, 45.36874369649214, 72.96925970533188, 123.65749943169615, 85.38969488557001, 84.68314616429487, 92.15692065567403, 171.53406484284125, -14.4368187173573, 271.06205393615284, 110.628479066898, 64.51939561111784, 173.9559783118811, 24.323084680402314, -22.49548755015029, 73.42136014736802, 167.58254583048506, 109.41736147601694, 169.8422193972192, 199.90554631030858, 141.78875672616016, 132.34842003126454, 246.86999999999983, 32.78591619009694, 256.05, 143.7919073244317, 277.7512281895862, 134.22671746136626, 267.89999999999986, 82.49014530832724, 328.2792481984748, 79.28893467017402, 230.21092255456443, 87.39101057464349, 288.9999999999998, 227.81153228645076, 230.67999999999995, 325.71709831151156, 196.03253990720262, 213.097596021529, 268.03999999999996, 53.93764842167135, 169.4700000000002, 285.9534656891112, 161.9366273271383, 255.03000000000003, 123.97879706879436, 316.0049592016145, 129.72365092352294, 230.3557144558269, 275.39, 332.5861243477327, 167.55037200010116, 167.73000000000013, 305.3999999999998, 267.6999999999999, 278.5269826556478, 257.83000000000015, 241.54590703053276, 248.15938321794155, 356.21999999999986, 311.2099999999999, 246.6005416481599, 114.34244424386118, 250.9809980340638, 243.08851085297061, 163.44914136314964, 147.5484575954849, 223.5512103762142, 186.95084183149453, 213.2707465574322, 205.91052515226545, 278.89583971486246, 120.91279373276365, 228.13904482835878, 238.88340855302732, 89.64422377005594, 240.47999999999996, -22.387514730847272, 258.36139384132434], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.261128474439548, -80.36525109406864, -531.2246917401916, -351.8513340261332, -94.14285252779014, -194.81719380381392, 42.48695154577195, -63.041812684678156, -9.848372199992363, -219.54934333694544, -229.61488405659136, -59.70979915386087, -78.939345830978, -209.9669099174428, -293.86690515709915, -99.69232031389576, -361.60989736229124, -149.8312113067502, 54.5521791405313, -398.7878056473872, -132.2782352101641, -134.5116971000297, -679.0006156007797, -552.6313365135118, -139.56684106409108, -119.93685309583519, -172.57119097711734, -26.910298045335157, -23.918528707083798, -73.31099139574631, -221.65800174935265, -175.31587152631505, 20.93709692424097, -148.1504503632892, -438.1521107317623, 9.078380276867227, -21.767652620465107, -5.34258701940873, -186.59004467192622, -98.31647957197814, -405.03238760983726, -26.246547918069126, -209.92473902864998, -242.34145002391463, 4.282678550264713, -86.94956749365248, -124.98011006422925, 11.32205369463543, -658.8547097291889, -238.48128998865317, -143.01611445634663, -182.37273783433793, -242.24444826474056, -83.0391219701853, -85.74346948655393, -264.42563328865543, -375.33809736612415, -181.06233199985607, -194.55668312320398, -75.14601291245626, -228.16653562260822, 70.48229508218269, -165.5248010990953, -54.31967499822637, -191.2313410873835, 109.46160120879604, -69.68141950611776, -66.27411596327437, -369.88946714226074, -110.13985990418885, -141.32376460368664, -168.2849519153796, -392.99515775222164, -92.58690841499651, -286.3706137105096, 37.13471358414949, -45.10291019813282, 17.07651669771807, 41.95701209555668, 72.23519448899003, -239.92079715035675, -84.97399766572074, -381.72102165230376, -158.64364911790946, 102.73778244671212, 54.97327185598348, -207.42907481967688, -326.2862357617964, 114.03524941736694, 64.10370020803522, -91.75998892456596, -267.78010110095784, 117.32687991299396, 117.07136563387473, 25.62466329808904, -116.47797624025966, 122.48811006564824, 95.60704038845708, 27.721046142910183, -198.57041962441332, -27.11877656065788, 167.12054014450592, -339.3910966545386, -302.66876818273283, -75.69915760013411, 121.2120512334097, -274.48488259860784, -230.9541516760656, 150.28158605659746, 123.1099677897244, 129.96955657831109, 18.483935380049015, -47.91346425102722, 104.98372252489872, 137.45178439564518, 162.21520486452746, 97.74271179603137, 3.721778454480737, 23.3981321262601, 22.631153686386043, 94.15840402231572, 128.92132205290426, -114.14047926698694, -227.26957274762998, 26.768355257265945, -19.432766627540325, 141.6354139718302, -35.623907960135654, 21.56542155165155, -346.2253737517469, -156.38430840958304, 88.02412217356118, 9.237113737993106, -344.51005751088263, 87.25199134858988, 153.47597143177347, 7.230768524098032, -18.640274193214058, 151.4304049989101, -481.0055633697966, -2.599904694602671, 118.05089161308362, 127.75337039602269, 145.80375678577036, -31.183971448856717, 32.6328023091961, 15.457014358656574, 66.57431326511617, 163.66411264252977, 24.154016617329418, 111.28994537188977, 80.4670170889811, 139.80104323367362, 96.24751970549107, 95.94548366860255, 79.59294755384238, -72.59287587534891, 23.885750379071837, 126.52478889140883, -112.7919082620522, 164.20058891315472, 159.61934016007413, 69.912722046794, 111.13033753115448, 66.46268009871488, 60.46595778054437, -10.791174856002376, -263.01786280753845, 34.421032282810096, -228.22333520680775, 54.63663572916789, 98.59969649125651, -85.72890948713251, 36.03355073138017, -45.94552557532929, -62.26392292167021, -24.908650356279722, -73.75934765383248, -41.73460281449412, 119.23036962918107, -3.725526433972326, -45.324460705725244, 73.29654312679473, -197.43497672895614, -322.46234524382265, 149.1470478485415, -29.713248620299613, 25.802214851285065, 59.61857248907286, 66.68580240684051, 113.99069895264078, -37.05570987445106, -39.54992356749559, -18.971743482483976, -37.18184199898516, 89.38687595711448, -355.0194899831077, -153.41229640266135, -76.37968443019294, 160.94985641724796], "policy_predator_policy_reward": [75.41308147057057, 113.04337591843871, 137.4297504818968, 535.8863859820638, 194.47030459761186, 135.5491498049326, 75.94980203585696, 53.2330784200082, 31.831111864608207, 239.98671266526412, 187.37017621531623, 205.42373089513967, 59.87414339853582, 259.28878135157646, 223.31351189833327, 162.07342460173143, 252.38734459260777, 340.66532038576497, 26.131884275429623, 392.8382281922629, 107.53714166443028, 183.74721178343788, 409.19389544957966, 625.7653236641835, 138.72526781984791, 104.59920919834025, 74.55882538162167, 156.3297363818477, 62.48727013257398, 89.71425229904447, 369.52352285315266, 50.02166059044642, 126.79078422329039, 113.21393654643828, 438.3021107317622, 65.83161972313279, 51.75378932435591, 8.819470582335075, 186.27721588011352, 159.9787503100887, 369.4311203114439, 165.7579830288677, 142.03647122963378, 355.598461519423, 5.107975205465527, 150.52817344325416, 49.79738168653241, 187.51817411475673, 591.5022168617468, 391.22347774166514, 172.6908114298673, 237.38118702511164, 201.31541096205973, 216.1250799285399, 195.8353783797535, 325.8677892382972, 293.0040356411656, 248.95957500745635, 262.81694279488215, 277.94780717693124, 224.45127383006724, 43.861445777256016, 152.18891515195375, 132.17495655648628, 181.89707851745285, 73.82863967301601, 128.9536408806899, 31.32497926910504, 329.46072772367796, 128.07311177262193, 156.51831862223236, 226.5117580442009, 337.37103879974325, 315.7935731979602, 159.32904093102215, 199.3242206713546, 52.3311105563362, 145.537502341298, 20.26789473553475, 65.44544499022723, 312.9523431600404, 153.73120838219683, 315.20319069506706, 357.5099001064104, 37.50221755328789, 51.656728144016505, 201.50918526555245, 364.9920415060169, 42.23475058263302, 35.676299791964766, 336.7413937644509, 166.59060358550457, 40.341808675936186, 3.011173966781638, 27.698331323392054, 197.38169908014487, 9.489171126703713, 40.31567841919116, 173.46113784368632, 79.87838094614403, 85.71070958272931, 102.56677503189779, 387.15078654487957, 334.1980129625648, 86.93161419785744, 97.76641472343172, 269.9581548252662, 322.8718900240507, 11.028413943402434, 4.580032210275607, 78.56234818819638, 0.7956921398945732, 12.729502307769536, 160.8802394183591, 2.9557286926382, 23.094380358700796, 32.83976764200398, 61.728282014686485, 81.77884789014158, 85.28946231874104, 31.411595977684364, 13.54867794709574, 39.580755099740315, 355.7669453365477, 38.37164474273408, 123.76276662754053, 25.090636644757232, 154.8513230326594, 367.0713035994462, 119.52527592778732, 246.41430840958301, 76.9758778264388, 250.0003021670181, 209.25143867466613, 51.605213175135546, 23.671783246115545, 45.901072705667964, 95.23208388697103, 84.89767263988344, 475.03320018683013, 11.569208656522463, 148.36980442499654, 45.3366296039773, 13.692367561962588, 141.44397144885684, 24.657569690905135, 54.996739437779276, 30.70193293844818, 11.286262208973069, 106.29560853116777, 57.49640577448782, 18.446631764641364, 9.16483000029146, 33.31358971619189, 51.92595113752513, 30.365617640030077, 252.20995093226531, 38.0430815945445, 129.59864953828665, 104.82785305029842, 21.799411086845296, 10.60065983992571, 65.42314085801857, 64.74379956403295, 72.61715339476513, 47.05475037413547, 343.72946702653815, 44.422014880863536, 283.77912998154136, 161.0041709765203, 46.741377538939794, 43.110801093606426, 86.5354845894236, 126.60901552947833, 218.4700809594143, 37.28782513307036, 144.57848757987875, 177.64072080644772, 82.83514941151074, 26.619925605296505, 56.29359823942474, 206.027135457705, 118.50870298048252, 211.54025577394438, 296.6265423073367, 155.58459480280683, 56.87765502712145, 67.94617247465635, 27.53923942968854, 74.29543050275689, 51.701695299531245, 110.24672417530614, 66.39374972221368, 81.7721410978217, 131.47184199898518, 56.803124042885486, 410.38384326871414, 75.6604283862076, 162.44968443019286, 11.341537424076417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.791052695683292, "mean_inference_ms": 2.4699080000694402, "mean_action_processing_ms": 0.3372388004234849, "mean_env_wait_ms": 0.2847151224457392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054520368576049805, "StateBufferConnector_ms": 0.003435373306274414, "ViewRequirementAgentConnector_ms": 0.13766467571258545}, "num_episodes": 18, "episode_return_max": 356.21999999999986, "episode_return_min": -209.75988930236463, "episode_return_mean": 152.2714348603155, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.0050095029689, "num_env_steps_trained_throughput_per_sec": 251.0050095029689, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 15645.126, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15645.073, "sample_time_ms": 1877.775, "learn_time_ms": 13741.146, "learn_throughput": 291.097, "synch_weights_time_ms": 22.118}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "6c58f_00000", "date": "2024-08-16_16-12-59", "timestamp": 1723804979, "time_this_iter_s": 15.989858150482178, "time_total_s": 363.893563747406, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04ddee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 363.893563747406, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 59.26363636363636, "ram_util_percent": 82.04090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6799942102224108, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 1e-05, "total_loss": 5.81887064686528, "policy_loss": -0.007604406928155749, "vf_loss": 5.825877443697086, "vf_explained_var": 0.004772744292304629, "kl": 0.010623973987934139, "entropy": 1.5371359639697604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4680625808302055, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.024304720712086, "policy_loss": -0.004698921084679939, "vf_loss": 9.028943910548296, "vf_explained_var": -0.003114492174178835, "kl": 0.009559378918802696, "entropy": 1.4412615296701905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 356.21999999999986, "episode_reward_min": -22.49548755015029, "episode_reward_mean": 171.55346003336018, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -658.8547097291889, "predator_policy": 0.7956921398945732}, "policy_reward_max": {"prey_policy": 167.12054014450592, "predator_policy": 591.5022168617468}, "policy_reward_mean": {"prey_policy": -46.81160586582893, "predator_policy": 132.58833588250903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.463020266816905, 61.349441946297205, 103.91016781240626, 45.36874369649214, 72.96925970533188, 123.65749943169615, 85.38969488557001, 84.68314616429487, 92.15692065567403, 171.53406484284125, -14.4368187173573, 271.06205393615284, 110.628479066898, 64.51939561111784, 173.9559783118811, 24.323084680402314, -22.49548755015029, 73.42136014736802, 167.58254583048506, 109.41736147601694, 169.8422193972192, 199.90554631030858, 141.78875672616016, 132.34842003126454, 246.86999999999983, 32.78591619009694, 256.05, 143.7919073244317, 277.7512281895862, 134.22671746136626, 267.89999999999986, 82.49014530832724, 328.2792481984748, 79.28893467017402, 230.21092255456443, 87.39101057464349, 288.9999999999998, 227.81153228645076, 230.67999999999995, 325.71709831151156, 196.03253990720262, 213.097596021529, 268.03999999999996, 53.93764842167135, 169.4700000000002, 285.9534656891112, 161.9366273271383, 255.03000000000003, 123.97879706879436, 316.0049592016145, 129.72365092352294, 230.3557144558269, 275.39, 332.5861243477327, 167.55037200010116, 167.73000000000013, 305.3999999999998, 267.6999999999999, 278.5269826556478, 257.83000000000015, 241.54590703053276, 248.15938321794155, 356.21999999999986, 311.2099999999999, 246.6005416481599, 114.34244424386118, 250.9809980340638, 243.08851085297061, 163.44914136314964, 147.5484575954849, 223.5512103762142, 186.95084183149453, 213.2707465574322, 205.91052515226545, 278.89583971486246, 120.91279373276365, 228.13904482835878, 238.88340855302732, 89.64422377005594, 240.47999999999996, -22.387514730847272, 258.36139384132434, 82.61744517744708, 221.9899999999995, 203.94953434179422, 85.35000000000008, -20.225220006657732, 180.97426486182815, 164.99292601041424, 189.6065004033706, 105.7946219691822, 139.24362490455619, 182.1900129760472, 5.545573399849664, 134.79000000000008, 179.1699999999999, 201.97308371532893, 149.57224843704034, 103.7170729283142, 85.47242284967933], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.767652620465107, -5.34258701940873, -186.59004467192622, -98.31647957197814, -405.03238760983726, -26.246547918069126, -209.92473902864998, -242.34145002391463, 4.282678550264713, -86.94956749365248, -124.98011006422925, 11.32205369463543, -658.8547097291889, -238.48128998865317, -143.01611445634663, -182.37273783433793, -242.24444826474056, -83.0391219701853, -85.74346948655393, -264.42563328865543, -375.33809736612415, -181.06233199985607, -194.55668312320398, -75.14601291245626, -228.16653562260822, 70.48229508218269, -165.5248010990953, -54.31967499822637, -191.2313410873835, 109.46160120879604, -69.68141950611776, -66.27411596327437, -369.88946714226074, -110.13985990418885, -141.32376460368664, -168.2849519153796, -392.99515775222164, -92.58690841499651, -286.3706137105096, 37.13471358414949, -45.10291019813282, 17.07651669771807, 41.95701209555668, 72.23519448899003, -239.92079715035675, -84.97399766572074, -381.72102165230376, -158.64364911790946, 102.73778244671212, 54.97327185598348, -207.42907481967688, -326.2862357617964, 114.03524941736694, 64.10370020803522, -91.75998892456596, -267.78010110095784, 117.32687991299396, 117.07136563387473, 25.62466329808904, -116.47797624025966, 122.48811006564824, 95.60704038845708, 27.721046142910183, -198.57041962441332, -27.11877656065788, 167.12054014450592, -339.3910966545386, -302.66876818273283, -75.69915760013411, 121.2120512334097, -274.48488259860784, -230.9541516760656, 150.28158605659746, 123.1099677897244, 129.96955657831109, 18.483935380049015, -47.91346425102722, 104.98372252489872, 137.45178439564518, 162.21520486452746, 97.74271179603137, 3.721778454480737, 23.3981321262601, 22.631153686386043, 94.15840402231572, 128.92132205290426, -114.14047926698694, -227.26957274762998, 26.768355257265945, -19.432766627540325, 141.6354139718302, -35.623907960135654, 21.56542155165155, -346.2253737517469, -156.38430840958304, 88.02412217356118, 9.237113737993106, -344.51005751088263, 87.25199134858988, 153.47597143177347, 7.230768524098032, -18.640274193214058, 151.4304049989101, -481.0055633697966, -2.599904694602671, 118.05089161308362, 127.75337039602269, 145.80375678577036, -31.183971448856717, 32.6328023091961, 15.457014358656574, 66.57431326511617, 163.66411264252977, 24.154016617329418, 111.28994537188977, 80.4670170889811, 139.80104323367362, 96.24751970549107, 95.94548366860255, 79.59294755384238, -72.59287587534891, 23.885750379071837, 126.52478889140883, -112.7919082620522, 164.20058891315472, 159.61934016007413, 69.912722046794, 111.13033753115448, 66.46268009871488, 60.46595778054437, -10.791174856002376, -263.01786280753845, 34.421032282810096, -228.22333520680775, 54.63663572916789, 98.59969649125651, -85.72890948713251, 36.03355073138017, -45.94552557532929, -62.26392292167021, -24.908650356279722, -73.75934765383248, -41.73460281449412, 119.23036962918107, -3.725526433972326, -45.324460705725244, 73.29654312679473, -197.43497672895614, -322.46234524382265, 149.1470478485415, -29.713248620299613, 25.802214851285065, 59.61857248907286, 66.68580240684051, 113.99069895264078, -37.05570987445106, -39.54992356749559, -18.971743482483976, -37.18184199898516, 89.38687595711448, -355.0194899831077, -153.41229640266135, -76.37968443019294, 160.94985641724796, -148.09160289077985, -45.950682566605295, 12.50916956227719, 125.46194726982472, -35.322043725398274, 14.007407289563828, 75.21285970545549, -187.73172781438188, -244.84531369844228, -95.71222140688901, 85.18207436541059, 31.184501362976683, 57.962405414382225, -34.64232399041367, -192.37600539192863, 61.59250590988646, -188.39171213348857, -20.49566466557969, -148.11499940264198, -12.121943719235386, 12.957998466160452, -79.71849671348703, -144.60782662269781, -90.18340973153133, 5.120072355359181, -58.916580920859154, 41.58460402580576, -2.504063234111986, 67.03148483544777, -14.10330305173807, -23.37402853278817, -104.35844579555915, -217.3749968159553, -141.23409839399662, -103.02004824995704, -157.571709246535], "policy_predator_policy_reward": [51.75378932435591, 8.819470582335075, 186.27721588011352, 159.9787503100887, 369.4311203114439, 165.7579830288677, 142.03647122963378, 355.598461519423, 5.107975205465527, 150.52817344325416, 49.79738168653241, 187.51817411475673, 591.5022168617468, 391.22347774166514, 172.6908114298673, 237.38118702511164, 201.31541096205973, 216.1250799285399, 195.8353783797535, 325.8677892382972, 293.0040356411656, 248.95957500745635, 262.81694279488215, 277.94780717693124, 224.45127383006724, 43.861445777256016, 152.18891515195375, 132.17495655648628, 181.89707851745285, 73.82863967301601, 128.9536408806899, 31.32497926910504, 329.46072772367796, 128.07311177262193, 156.51831862223236, 226.5117580442009, 337.37103879974325, 315.7935731979602, 159.32904093102215, 199.3242206713546, 52.3311105563362, 145.537502341298, 20.26789473553475, 65.44544499022723, 312.9523431600404, 153.73120838219683, 315.20319069506706, 357.5099001064104, 37.50221755328789, 51.656728144016505, 201.50918526555245, 364.9920415060169, 42.23475058263302, 35.676299791964766, 336.7413937644509, 166.59060358550457, 40.341808675936186, 3.011173966781638, 27.698331323392054, 197.38169908014487, 9.489171126703713, 40.31567841919116, 173.46113784368632, 79.87838094614403, 85.71070958272931, 102.56677503189779, 387.15078654487957, 334.1980129625648, 86.93161419785744, 97.76641472343172, 269.9581548252662, 322.8718900240507, 11.028413943402434, 4.580032210275607, 78.56234818819638, 0.7956921398945732, 12.729502307769536, 160.8802394183591, 2.9557286926382, 23.094380358700796, 32.83976764200398, 61.728282014686485, 81.77884789014158, 85.28946231874104, 31.411595977684364, 13.54867794709574, 39.580755099740315, 355.7669453365477, 38.37164474273408, 123.76276662754053, 25.090636644757232, 154.8513230326594, 367.0713035994462, 119.52527592778732, 246.41430840958301, 76.9758778264388, 250.0003021670181, 209.25143867466613, 51.605213175135546, 23.671783246115545, 45.901072705667964, 95.23208388697103, 84.89767263988344, 475.03320018683013, 11.569208656522463, 148.36980442499654, 45.3366296039773, 13.692367561962588, 141.44397144885684, 24.657569690905135, 54.996739437779276, 30.70193293844818, 11.286262208973069, 106.29560853116777, 57.49640577448782, 18.446631764641364, 9.16483000029146, 33.31358971619189, 51.92595113752513, 30.365617640030077, 252.20995093226531, 38.0430815945445, 129.59864953828665, 104.82785305029842, 21.799411086845296, 10.60065983992571, 65.42314085801857, 64.74379956403295, 72.61715339476513, 47.05475037413547, 343.72946702653815, 44.422014880863536, 283.77912998154136, 161.0041709765203, 46.741377538939794, 43.110801093606426, 86.5354845894236, 126.60901552947833, 218.4700809594143, 37.28782513307036, 144.57848757987875, 177.64072080644772, 82.83514941151074, 26.619925605296505, 56.29359823942474, 206.027135457705, 118.50870298048252, 211.54025577394438, 296.6265423073367, 155.58459480280683, 56.87765502712145, 67.94617247465635, 27.53923942968854, 74.29543050275689, 51.701695299531245, 110.24672417530614, 66.39374972221368, 81.7721410978217, 131.47184199898518, 56.803124042885486, 410.38384326871414, 75.6604283862076, 162.44968443019286, 11.341537424076417, 59.456996767478365, 217.20273386735363, 72.59753820227792, 11.421344965620268, 53.73083173582858, 171.53333904180005, 9.951907584399912, 187.91696052452562, 284.7777633154504, 35.554551783223154, 5.39822956816878, 59.20945956527126, 39.75324339037142, 101.91960119607485, 66.91575006638094, 253.4742498190318, 233.04617245613062, 81.63582631211962, 235.40300488495873, 64.07756314147454, 127.53523340942054, 121.41527781395418, 125.83160782699063, 114.50520192708728, 127.844339911924, 60.7421686535766, 61.28488019261362, 78.80457901569268, 108.54018646482372, 40.50471546679559, 105.48729775710856, 171.81742500828003, 204.362911937221, 257.96325620104477, 96.4345130957069, 249.62966725046437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7927632567437358, "mean_inference_ms": 2.4812011635001983, "mean_action_processing_ms": 0.34574048541750996, "mean_env_wait_ms": 0.2862167407016616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009388923645019531, "StateBufferConnector_ms": 0.0037832260131835938, "ViewRequirementAgentConnector_ms": 0.13592302799224854}, "num_episodes": 18, "episode_return_max": 356.21999999999986, "episode_return_min": -22.49548755015029, "episode_return_mean": 171.55346003336018, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.1580663205916, "num_env_steps_trained_throughput_per_sec": 245.1580663205916, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 15672.614, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15672.562, "sample_time_ms": 1930.293, "learn_time_ms": 13716.506, "learn_throughput": 291.619, "synch_weights_time_ms": 22.216}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "6c58f_00000", "date": "2024-08-16_16-13-16", "timestamp": 1723804996, "time_this_iter_s": 16.356227159500122, "time_total_s": 380.2497909069061, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05039d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 380.2497909069061, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 60.45217391304348, "ram_util_percent": 81.75217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5826622784926148, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 1e-05, "total_loss": 7.375730083859156, "policy_loss": -0.011658250766180494, "vf_loss": 7.385967084591981, "vf_explained_var": 0.006023437037039055, "kl": 0.02526626669827805, "entropy": 1.5132210385862481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.790837489360224, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.10677847988391, "policy_loss": -0.0032641613922481027, "vf_loss": 9.10996975015711, "vf_explained_var": -0.0018980036021540405, "kl": 0.011665077760089392, "entropy": 1.4980629197504154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 356.21999999999986, "episode_reward_min": -86.60018997784474, "episode_reward_mean": 168.66465854798628, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.0055633697966, "predator_policy": 0.7956921398945732}, "policy_reward_max": {"prey_policy": 167.12054014450592, "predator_policy": 475.03320018683013}, "policy_reward_mean": {"prey_policy": -43.720675819835805, "predator_policy": 128.05300509382892}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.58254583048506, 109.41736147601694, 169.8422193972192, 199.90554631030858, 141.78875672616016, 132.34842003126454, 246.86999999999983, 32.78591619009694, 256.05, 143.7919073244317, 277.7512281895862, 134.22671746136626, 267.89999999999986, 82.49014530832724, 328.2792481984748, 79.28893467017402, 230.21092255456443, 87.39101057464349, 288.9999999999998, 227.81153228645076, 230.67999999999995, 325.71709831151156, 196.03253990720262, 213.097596021529, 268.03999999999996, 53.93764842167135, 169.4700000000002, 285.9534656891112, 161.9366273271383, 255.03000000000003, 123.97879706879436, 316.0049592016145, 129.72365092352294, 230.3557144558269, 275.39, 332.5861243477327, 167.55037200010116, 167.73000000000013, 305.3999999999998, 267.6999999999999, 278.5269826556478, 257.83000000000015, 241.54590703053276, 248.15938321794155, 356.21999999999986, 311.2099999999999, 246.6005416481599, 114.34244424386118, 250.9809980340638, 243.08851085297061, 163.44914136314964, 147.5484575954849, 223.5512103762142, 186.95084183149453, 213.2707465574322, 205.91052515226545, 278.89583971486246, 120.91279373276365, 228.13904482835878, 238.88340855302732, 89.64422377005594, 240.47999999999996, -22.387514730847272, 258.36139384132434, 82.61744517744708, 221.9899999999995, 203.94953434179422, 85.35000000000008, -20.225220006657732, 180.97426486182815, 164.99292601041424, 189.6065004033706, 105.7946219691822, 139.24362490455619, 182.1900129760472, 5.545573399849664, 134.79000000000008, 179.1699999999999, 201.97308371532893, 149.57224843704034, 103.7170729283142, 85.47242284967933, 90.07540624045349, -86.60018997784474, 242.2315752259439, -83.16935615674258, 115.50729153144206, 139.30602924868424, 178.26999999999958, -66.83037390131403, 102.06063678093797, 64.36857229219777, 235.22642549124106, -25.48516147908937, 8.71698435606529, 19.1948867873658, 115.26342017020491, 23.590350281811265, 82.22000000000035, 112.63335946498438], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-392.99515775222164, -92.58690841499651, -286.3706137105096, 37.13471358414949, -45.10291019813282, 17.07651669771807, 41.95701209555668, 72.23519448899003, -239.92079715035675, -84.97399766572074, -381.72102165230376, -158.64364911790946, 102.73778244671212, 54.97327185598348, -207.42907481967688, -326.2862357617964, 114.03524941736694, 64.10370020803522, -91.75998892456596, -267.78010110095784, 117.32687991299396, 117.07136563387473, 25.62466329808904, -116.47797624025966, 122.48811006564824, 95.60704038845708, 27.721046142910183, -198.57041962441332, -27.11877656065788, 167.12054014450592, -339.3910966545386, -302.66876818273283, -75.69915760013411, 121.2120512334097, -274.48488259860784, -230.9541516760656, 150.28158605659746, 123.1099677897244, 129.96955657831109, 18.483935380049015, -47.91346425102722, 104.98372252489872, 137.45178439564518, 162.21520486452746, 97.74271179603137, 3.721778454480737, 23.3981321262601, 22.631153686386043, 94.15840402231572, 128.92132205290426, -114.14047926698694, -227.26957274762998, 26.768355257265945, -19.432766627540325, 141.6354139718302, -35.623907960135654, 21.56542155165155, -346.2253737517469, -156.38430840958304, 88.02412217356118, 9.237113737993106, -344.51005751088263, 87.25199134858988, 153.47597143177347, 7.230768524098032, -18.640274193214058, 151.4304049989101, -481.0055633697966, -2.599904694602671, 118.05089161308362, 127.75337039602269, 145.80375678577036, -31.183971448856717, 32.6328023091961, 15.457014358656574, 66.57431326511617, 163.66411264252977, 24.154016617329418, 111.28994537188977, 80.4670170889811, 139.80104323367362, 96.24751970549107, 95.94548366860255, 79.59294755384238, -72.59287587534891, 23.885750379071837, 126.52478889140883, -112.7919082620522, 164.20058891315472, 159.61934016007413, 69.912722046794, 111.13033753115448, 66.46268009871488, 60.46595778054437, -10.791174856002376, -263.01786280753845, 34.421032282810096, -228.22333520680775, 54.63663572916789, 98.59969649125651, -85.72890948713251, 36.03355073138017, -45.94552557532929, -62.26392292167021, -24.908650356279722, -73.75934765383248, -41.73460281449412, 119.23036962918107, -3.725526433972326, -45.324460705725244, 73.29654312679473, -197.43497672895614, -322.46234524382265, 149.1470478485415, -29.713248620299613, 25.802214851285065, 59.61857248907286, 66.68580240684051, 113.99069895264078, -37.05570987445106, -39.54992356749559, -18.971743482483976, -37.18184199898516, 89.38687595711448, -355.0194899831077, -153.41229640266135, -76.37968443019294, 160.94985641724796, -148.09160289077985, -45.950682566605295, 12.50916956227719, 125.46194726982472, -35.322043725398274, 14.007407289563828, 75.21285970545549, -187.73172781438188, -244.84531369844228, -95.71222140688901, 85.18207436541059, 31.184501362976683, 57.962405414382225, -34.64232399041367, -192.37600539192863, 61.59250590988646, -188.39171213348857, -20.49566466557969, -148.11499940264198, -12.121943719235386, 12.957998466160452, -79.71849671348703, -144.60782662269781, -90.18340973153133, 5.120072355359181, -58.916580920859154, 41.58460402580576, -2.504063234111986, 67.03148483544777, -14.10330305173807, -23.37402853278817, -104.35844579555915, -217.3749968159553, -141.23409839399662, -103.02004824995704, -157.571709246535, -13.528028954503686, -172.2137061238161, -188.15574076821247, -252.42756190806898, -10.454288629345607, 45.420707070588335, -226.3203142055865, -324.882964734168, -190.87572529963293, -174.03662335029196, -216.77638531953426, -108.24913544086571, -45.021538132749775, 37.65012526786353, -382.4347397309401, -331.48204642316205, -302.5057400499575, 10.187204766068282, -165.1284493944049, -98.59082838969469, -222.82897177342574, -23.993641832572013, -273.41193813213954, -253.17322566612336, -210.61442488539728, -150.05116741616666, -70.3867428175282, -170.36113390240794, -26.01430802232571, 14.485334361879007, -79.65918511032253, -40.22242842575884, -10.029551137467886, -125.25911219944535, -16.755187706144454, -114.7720461343868], "policy_predator_policy_reward": [337.37103879974325, 315.7935731979602, 159.32904093102215, 199.3242206713546, 52.3311105563362, 145.537502341298, 20.26789473553475, 65.44544499022723, 312.9523431600404, 153.73120838219683, 315.20319069506706, 357.5099001064104, 37.50221755328789, 51.656728144016505, 201.50918526555245, 364.9920415060169, 42.23475058263302, 35.676299791964766, 336.7413937644509, 166.59060358550457, 40.341808675936186, 3.011173966781638, 27.698331323392054, 197.38169908014487, 9.489171126703713, 40.31567841919116, 173.46113784368632, 79.87838094614403, 85.71070958272931, 102.56677503189779, 387.15078654487957, 334.1980129625648, 86.93161419785744, 97.76641472343172, 269.9581548252662, 322.8718900240507, 11.028413943402434, 4.580032210275607, 78.56234818819638, 0.7956921398945732, 12.729502307769536, 160.8802394183591, 2.9557286926382, 23.094380358700796, 32.83976764200398, 61.728282014686485, 81.77884789014158, 85.28946231874104, 31.411595977684364, 13.54867794709574, 39.580755099740315, 355.7669453365477, 38.37164474273408, 123.76276662754053, 25.090636644757232, 154.8513230326594, 367.0713035994462, 119.52527592778732, 246.41430840958301, 76.9758778264388, 250.0003021670181, 209.25143867466613, 51.605213175135546, 23.671783246115545, 45.901072705667964, 95.23208388697103, 84.89767263988344, 475.03320018683013, 11.569208656522463, 148.36980442499654, 45.3366296039773, 13.692367561962588, 141.44397144885684, 24.657569690905135, 54.996739437779276, 30.70193293844818, 11.286262208973069, 106.29560853116777, 57.49640577448782, 18.446631764641364, 9.16483000029146, 33.31358971619189, 51.92595113752513, 30.365617640030077, 252.20995093226531, 38.0430815945445, 129.59864953828665, 104.82785305029842, 21.799411086845296, 10.60065983992571, 65.42314085801857, 64.74379956403295, 72.61715339476513, 47.05475037413547, 343.72946702653815, 44.422014880863536, 283.77912998154136, 161.0041709765203, 46.741377538939794, 43.110801093606426, 86.5354845894236, 126.60901552947833, 218.4700809594143, 37.28782513307036, 144.57848757987875, 177.64072080644772, 82.83514941151074, 26.619925605296505, 56.29359823942474, 206.027135457705, 118.50870298048252, 211.54025577394438, 296.6265423073367, 155.58459480280683, 56.87765502712145, 67.94617247465635, 27.53923942968854, 74.29543050275689, 51.701695299531245, 110.24672417530614, 66.39374972221368, 81.7721410978217, 131.47184199898518, 56.803124042885486, 410.38384326871414, 75.6604283862076, 162.44968443019286, 11.341537424076417, 59.456996767478365, 217.20273386735363, 72.59753820227792, 11.421344965620268, 53.73083173582858, 171.53333904180005, 9.951907584399912, 187.91696052452562, 284.7777633154504, 35.554551783223154, 5.39822956816878, 59.20945956527126, 39.75324339037142, 101.91960119607485, 66.91575006638094, 253.4742498190318, 233.04617245613062, 81.63582631211962, 235.40300488495873, 64.07756314147454, 127.53523340942054, 121.41527781395418, 125.83160782699063, 114.50520192708728, 127.844339911924, 60.7421686535766, 61.28488019261362, 78.80457901569268, 108.54018646482372, 40.50471546679559, 105.48729775710856, 171.81742500828003, 204.362911937221, 257.96325620104477, 96.4345130957069, 249.62966725046437, 144.63546426037988, 131.1816770583938, 5.760316550060553, 348.22279614837583, 51.38198601535911, 155.88317076934246, 392.72344608529215, 75.31047669771955, 245.4498988374073, 234.9697413439594, 219.34359026603292, 244.98795974305116, 137.48153813274988, 48.15987473213639, 424.1711255902597, 222.91528666252788, 309.24059432059613, 85.13857774423084, 157.33352169718194, 170.75432837911512, 259.1148000053613, 222.93423909187783, 260.8765315859049, 240.22347073326767, 289.8087625092663, 79.57381414836163, 66.56610710299411, 193.3766564043081, 72.38334271635367, 54.40905111429753, 80.4302608732104, 63.041702944682804, 54.07982884046887, 163.42883449644407, 77.73236520251082, 166.42822810300464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7930634817759548, "mean_inference_ms": 2.4880055845618316, "mean_action_processing_ms": 0.35326015285554285, "mean_env_wait_ms": 0.2873456392301026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009782075881958008, "StateBufferConnector_ms": 0.0037456750869750977, "ViewRequirementAgentConnector_ms": 0.13074016571044922}, "num_episodes": 18, "episode_return_max": 356.21999999999986, "episode_return_min": -86.60018997784474, "episode_return_mean": 168.66465854798628, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.9533127756864, "num_env_steps_trained_throughput_per_sec": 262.9533127756864, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 15658.206, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15658.157, "sample_time_ms": 1928.51, "learn_time_ms": 13705.3, "learn_throughput": 291.858, "synch_weights_time_ms": 21.557}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "6c58f_00000", "date": "2024-08-16_16-13-31", "timestamp": 1723805011, "time_this_iter_s": 15.262979745864868, "time_total_s": 395.512770652771, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b042f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 395.512770652771, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 61.01818181818182, "ram_util_percent": 82.33636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1118206614539736, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 9.007122407640729, "policy_loss": -0.004215745428310973, "vf_loss": 9.01074291814572, "vf_explained_var": 0.0020524488555060494, "kl": 0.007055071659273055, "entropy": 1.5370295192829515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.055759956139736, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.660560180522777, "policy_loss": -0.005068906888405167, "vf_loss": 9.665582012499451, "vf_explained_var": -0.020284339738270592, "kl": 0.007531926852323859, "entropy": 1.5067147283327011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 356.21999999999986, "episode_reward_min": -86.60018997784474, "episode_reward_mean": 140.46675903673375, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -481.0055633697966, "predator_policy": 2.6938216311856564}, "policy_reward_max": {"prey_policy": 164.20058891315472, "predator_policy": 567.6541344943083}, "policy_reward_mean": {"prey_policy": -77.7807645174988, "predator_policy": 148.01414403586563}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.03253990720262, 213.097596021529, 268.03999999999996, 53.93764842167135, 169.4700000000002, 285.9534656891112, 161.9366273271383, 255.03000000000003, 123.97879706879436, 316.0049592016145, 129.72365092352294, 230.3557144558269, 275.39, 332.5861243477327, 167.55037200010116, 167.73000000000013, 305.3999999999998, 267.6999999999999, 278.5269826556478, 257.83000000000015, 241.54590703053276, 248.15938321794155, 356.21999999999986, 311.2099999999999, 246.6005416481599, 114.34244424386118, 250.9809980340638, 243.08851085297061, 163.44914136314964, 147.5484575954849, 223.5512103762142, 186.95084183149453, 213.2707465574322, 205.91052515226545, 278.89583971486246, 120.91279373276365, 228.13904482835878, 238.88340855302732, 89.64422377005594, 240.47999999999996, -22.387514730847272, 258.36139384132434, 82.61744517744708, 221.9899999999995, 203.94953434179422, 85.35000000000008, -20.225220006657732, 180.97426486182815, 164.99292601041424, 189.6065004033706, 105.7946219691822, 139.24362490455619, 182.1900129760472, 5.545573399849664, 134.79000000000008, 179.1699999999999, 201.97308371532893, 149.57224843704034, 103.7170729283142, 85.47242284967933, 90.07540624045349, -86.60018997784474, 242.2315752259439, -83.16935615674258, 115.50729153144206, 139.30602924868424, 178.26999999999958, -66.83037390131403, 102.06063678093797, 64.36857229219777, 235.22642549124106, -25.48516147908937, 8.71698435606529, 19.1948867873658, 115.26342017020491, 23.590350281811265, 82.22000000000035, 112.63335946498438, 114.98341399360069, 77.1810304640559, 51.513118817131456, -44.767835814674825, 21.96756214497026, 40.62843359861348, 133.09516082352025, 124.50724394383474, -5.945851749206699, 76.28090381326814, 28.30261321516671, 47.442858412034894, 77.82024389603272, 101.95216779285688, 95.41183046984214, -48.92266206212908, 72.30237488827672, 191.4954789737742, 56.47224920368369, 15.551916949279423, 64.98457615970769, 49.08273178219194], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [97.74271179603137, 3.721778454480737, 23.3981321262601, 22.631153686386043, 94.15840402231572, 128.92132205290426, -114.14047926698694, -227.26957274762998, 26.768355257265945, -19.432766627540325, 141.6354139718302, -35.623907960135654, 21.56542155165155, -346.2253737517469, -156.38430840958304, 88.02412217356118, 9.237113737993106, -344.51005751088263, 87.25199134858988, 153.47597143177347, 7.230768524098032, -18.640274193214058, 151.4304049989101, -481.0055633697966, -2.599904694602671, 118.05089161308362, 127.75337039602269, 145.80375678577036, -31.183971448856717, 32.6328023091961, 15.457014358656574, 66.57431326511617, 163.66411264252977, 24.154016617329418, 111.28994537188977, 80.4670170889811, 139.80104323367362, 96.24751970549107, 95.94548366860255, 79.59294755384238, -72.59287587534891, 23.885750379071837, 126.52478889140883, -112.7919082620522, 164.20058891315472, 159.61934016007413, 69.912722046794, 111.13033753115448, 66.46268009871488, 60.46595778054437, -10.791174856002376, -263.01786280753845, 34.421032282810096, -228.22333520680775, 54.63663572916789, 98.59969649125651, -85.72890948713251, 36.03355073138017, -45.94552557532929, -62.26392292167021, -24.908650356279722, -73.75934765383248, -41.73460281449412, 119.23036962918107, -3.725526433972326, -45.324460705725244, 73.29654312679473, -197.43497672895614, -322.46234524382265, 149.1470478485415, -29.713248620299613, 25.802214851285065, 59.61857248907286, 66.68580240684051, 113.99069895264078, -37.05570987445106, -39.54992356749559, -18.971743482483976, -37.18184199898516, 89.38687595711448, -355.0194899831077, -153.41229640266135, -76.37968443019294, 160.94985641724796, -148.09160289077985, -45.950682566605295, 12.50916956227719, 125.46194726982472, -35.322043725398274, 14.007407289563828, 75.21285970545549, -187.73172781438188, -244.84531369844228, -95.71222140688901, 85.18207436541059, 31.184501362976683, 57.962405414382225, -34.64232399041367, -192.37600539192863, 61.59250590988646, -188.39171213348857, -20.49566466557969, -148.11499940264198, -12.121943719235386, 12.957998466160452, -79.71849671348703, -144.60782662269781, -90.18340973153133, 5.120072355359181, -58.916580920859154, 41.58460402580576, -2.504063234111986, 67.03148483544777, -14.10330305173807, -23.37402853278817, -104.35844579555915, -217.3749968159553, -141.23409839399662, -103.02004824995704, -157.571709246535, -13.528028954503686, -172.2137061238161, -188.15574076821247, -252.42756190806898, -10.454288629345607, 45.420707070588335, -226.3203142055865, -324.882964734168, -190.87572529963293, -174.03662335029196, -216.77638531953426, -108.24913544086571, -45.021538132749775, 37.65012526786353, -382.4347397309401, -331.48204642316205, -302.5057400499575, 10.187204766068282, -165.1284493944049, -98.59082838969469, -222.82897177342574, -23.993641832572013, -273.41193813213954, -253.17322566612336, -210.61442488539728, -150.05116741616666, -70.3867428175282, -170.36113390240794, -26.01430802232571, 14.485334361879007, -79.65918511032253, -40.22242842575884, -10.029551137467886, -125.25911219944535, -16.755187706144454, -114.7720461343868, -200.71347775070288, -33.459244226713, -211.62515587585227, -76.10082028663696, -137.3428265041496, -121.914242432494, -90.02443692844847, -181.98873693280788, -290.6221338864482, -457.37677181401847, -145.5047043811687, -445.3916555090048, -314.06820943029516, -77.52425504408963, -421.0671523081229, -441.9769926733718, -301.9011531094018, -200.5457952601376, -103.92346010344579, -230.51791186691545, -374.988092798791, -315.3352285948526, -216.83544223395626, -0.8642753520927402, -210.2079266245744, -137.49588950864919, -35.652820037871514, -159.5056358841325, -15.222834980785212, -137.87756835728945, -181.7991928432987, -283.21277737935213, -253.4709720655927, -73.08819712950134, -110.77072737636999, -474.43308118076436, -57.504344488213675, -323.9171993251458, -280.5890289939399, -121.25335974110375, -124.98387118556406, -140.1796568782843, -105.99097927783785, -257.17775542384294], "policy_predator_policy_reward": [32.83976764200398, 61.728282014686485, 81.77884789014158, 85.28946231874104, 31.411595977684364, 13.54867794709574, 39.580755099740315, 355.7669453365477, 38.37164474273408, 123.76276662754053, 25.090636644757232, 154.8513230326594, 367.0713035994462, 119.52527592778732, 246.41430840958301, 76.9758778264388, 250.0003021670181, 209.25143867466613, 51.605213175135546, 23.671783246115545, 45.901072705667964, 95.23208388697103, 84.89767263988344, 475.03320018683013, 11.569208656522463, 148.36980442499654, 45.3366296039773, 13.692367561962588, 141.44397144885684, 24.657569690905135, 54.996739437779276, 30.70193293844818, 11.286262208973069, 106.29560853116777, 57.49640577448782, 18.446631764641364, 9.16483000029146, 33.31358971619189, 51.92595113752513, 30.365617640030077, 252.20995093226531, 38.0430815945445, 129.59864953828665, 104.82785305029842, 21.799411086845296, 10.60065983992571, 65.42314085801857, 64.74379956403295, 72.61715339476513, 47.05475037413547, 343.72946702653815, 44.422014880863536, 283.77912998154136, 161.0041709765203, 46.741377538939794, 43.110801093606426, 86.5354845894236, 126.60901552947833, 218.4700809594143, 37.28782513307036, 144.57848757987875, 177.64072080644772, 82.83514941151074, 26.619925605296505, 56.29359823942474, 206.027135457705, 118.50870298048252, 211.54025577394438, 296.6265423073367, 155.58459480280683, 56.87765502712145, 67.94617247465635, 27.53923942968854, 74.29543050275689, 51.701695299531245, 110.24672417530614, 66.39374972221368, 81.7721410978217, 131.47184199898518, 56.803124042885486, 410.38384326871414, 75.6604283862076, 162.44968443019286, 11.341537424076417, 59.456996767478365, 217.20273386735363, 72.59753820227792, 11.421344965620268, 53.73083173582858, 171.53333904180005, 9.951907584399912, 187.91696052452562, 284.7777633154504, 35.554551783223154, 5.39822956816878, 59.20945956527126, 39.75324339037142, 101.91960119607485, 66.91575006638094, 253.4742498190318, 233.04617245613062, 81.63582631211962, 235.40300488495873, 64.07756314147454, 127.53523340942054, 121.41527781395418, 125.83160782699063, 114.50520192708728, 127.844339911924, 60.7421686535766, 61.28488019261362, 78.80457901569268, 108.54018646482372, 40.50471546679559, 105.48729775710856, 171.81742500828003, 204.362911937221, 257.96325620104477, 96.4345130957069, 249.62966725046437, 144.63546426037988, 131.1816770583938, 5.760316550060553, 348.22279614837583, 51.38198601535911, 155.88317076934246, 392.72344608529215, 75.31047669771955, 245.4498988374073, 234.9697413439594, 219.34359026603292, 244.98795974305116, 137.48153813274988, 48.15987473213639, 424.1711255902597, 222.91528666252788, 309.24059432059613, 85.13857774423084, 157.33352169718194, 170.75432837911512, 259.1148000053613, 222.93423909187783, 260.8765315859049, 240.22347073326767, 289.8087625092663, 79.57381414836163, 66.56610710299411, 193.3766564043081, 72.38334271635367, 54.40905111429753, 80.4302608732104, 63.041702944682804, 54.07982884046887, 163.42883449644407, 77.73236520251082, 166.42822810300464, 155.12290739904444, 194.03322857197196, 237.9599324031268, 126.94707422341797, 175.9860472957167, 134.78414045805874, 24.34189965270766, 202.90343839387356, 463.4338076328954, 306.53266021254177, 429.1126035921157, 202.41218989667075, 182.23434487120267, 342.4532804267018, 419.89725443102054, 567.6541344943083, 126.16259086722923, 370.3385057531031, 179.19403327807652, 231.52824250555236, 406.7541508452506, 311.87178376355945, 262.448754366898, 2.6938216311856564, 190.15975050345727, 235.36430952579886, 153.8643296663187, 143.24629404854215, 50.835680204696004, 197.67655360322064, 222.44385729675162, 193.64545086376955, 173.12954139279543, 225.73200269057514, 354.86750559368465, 421.8317819372248, 98.73760014006525, 339.1561928769781, 104.47548393024934, 312.9188217540742, 87.79979564037032, 242.34830858318546, 202.63475991381324, 209.6167065700595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7906965207554636, "mean_inference_ms": 2.4815102036114673, "mean_action_processing_ms": 0.3603479861504141, "mean_env_wait_ms": 0.28698748850922806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010290265083312988, "StateBufferConnector_ms": 0.003733396530151367, "ViewRequirementAgentConnector_ms": 0.10468876361846924}, "num_episodes": 22, "episode_return_max": 356.21999999999986, "episode_return_min": -86.60018997784474, "episode_return_mean": 140.46675903673375, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.20455720150613, "num_env_steps_trained_throughput_per_sec": 260.20455720150613, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 15687.513, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15687.465, "sample_time_ms": 1929.389, "learn_time_ms": 13733.78, "learn_throughput": 291.253, "synch_weights_time_ms": 21.562}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "6c58f_00000", "date": "2024-08-16_16-13-47", "timestamp": 1723805027, "time_this_iter_s": 15.40966796875, "time_total_s": 410.922438621521, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 410.922438621521, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 63.0, "ram_util_percent": 82.56818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4857800192618495, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 8.24045929883523, "policy_loss": -0.01107402255009643, "vf_loss": 8.249934313789247, "vf_explained_var": 0.009302287757712066, "kl": 0.018951105176323084, "entropy": 1.5452235979377908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3862522055547704, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.441620277727722, "policy_loss": -0.004874134702095516, "vf_loss": 9.446437662114542, "vf_explained_var": -0.02583569076956895, "kl": 0.009077643394297473, "entropy": 1.4959414878850261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 311.2099999999999, "episode_reward_min": -86.60018997784474, "episode_reward_mean": 99.06626550577431, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.99060512172645, "predator_policy": 2.6938216311856564}, "policy_reward_max": {"prey_policy": 160.94985641724796, "predator_policy": 567.6541344943083}, "policy_reward_mean": {"prey_policy": -128.80654349600678, "predator_policy": 178.3396762488939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.2099999999999, 246.6005416481599, 114.34244424386118, 250.9809980340638, 243.08851085297061, 163.44914136314964, 147.5484575954849, 223.5512103762142, 186.95084183149453, 213.2707465574322, 205.91052515226545, 278.89583971486246, 120.91279373276365, 228.13904482835878, 238.88340855302732, 89.64422377005594, 240.47999999999996, -22.387514730847272, 258.36139384132434, 82.61744517744708, 221.9899999999995, 203.94953434179422, 85.35000000000008, -20.225220006657732, 180.97426486182815, 164.99292601041424, 189.6065004033706, 105.7946219691822, 139.24362490455619, 182.1900129760472, 5.545573399849664, 134.79000000000008, 179.1699999999999, 201.97308371532893, 149.57224843704034, 103.7170729283142, 85.47242284967933, 90.07540624045349, -86.60018997784474, 242.2315752259439, -83.16935615674258, 115.50729153144206, 139.30602924868424, 178.26999999999958, -66.83037390131403, 102.06063678093797, 64.36857229219777, 235.22642549124106, -25.48516147908937, 8.71698435606529, 19.1948867873658, 115.26342017020491, 23.590350281811265, 82.22000000000035, 112.63335946498438, 114.98341399360069, 77.1810304640559, 51.513118817131456, -44.767835814674825, 21.96756214497026, 40.62843359861348, 133.09516082352025, 124.50724394383474, -5.945851749206699, 76.28090381326814, 28.30261321516671, 47.442858412034894, 77.82024389603272, 101.95216779285688, 95.41183046984214, -48.92266206212908, 72.30237488827672, 191.4954789737742, 56.47224920368369, 15.551916949279423, 64.98457615970769, 49.08273178219194, 4.9612264670888635, 12.494454472732661, 107.60534318114537, -71.25912956431706, -31.86125191322652, 125.81838067279256, 27.509253291990085, 26.55785507424269, 5.752781832813058, 174.24908238227113, 125.59787031270102, -78.34509669162453, 161.93745882571721, 42.314999414949305, 179.83387609746876, 37.662760898446564, 143.59014697236265, -0.20826297109268943, 28.893963420659663, 36.825471107337165, -13.558907841093816, -0.8429253495512083, 116.62106507860994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [69.912722046794, 111.13033753115448, 66.46268009871488, 60.46595778054437, -10.791174856002376, -263.01786280753845, 34.421032282810096, -228.22333520680775, 54.63663572916789, 98.59969649125651, -85.72890948713251, 36.03355073138017, -45.94552557532929, -62.26392292167021, -24.908650356279722, -73.75934765383248, -41.73460281449412, 119.23036962918107, -3.725526433972326, -45.324460705725244, 73.29654312679473, -197.43497672895614, -322.46234524382265, 149.1470478485415, -29.713248620299613, 25.802214851285065, 59.61857248907286, 66.68580240684051, 113.99069895264078, -37.05570987445106, -39.54992356749559, -18.971743482483976, -37.18184199898516, 89.38687595711448, -355.0194899831077, -153.41229640266135, -76.37968443019294, 160.94985641724796, -148.09160289077985, -45.950682566605295, 12.50916956227719, 125.46194726982472, -35.322043725398274, 14.007407289563828, 75.21285970545549, -187.73172781438188, -244.84531369844228, -95.71222140688901, 85.18207436541059, 31.184501362976683, 57.962405414382225, -34.64232399041367, -192.37600539192863, 61.59250590988646, -188.39171213348857, -20.49566466557969, -148.11499940264198, -12.121943719235386, 12.957998466160452, -79.71849671348703, -144.60782662269781, -90.18340973153133, 5.120072355359181, -58.916580920859154, 41.58460402580576, -2.504063234111986, 67.03148483544777, -14.10330305173807, -23.37402853278817, -104.35844579555915, -217.3749968159553, -141.23409839399662, -103.02004824995704, -157.571709246535, -13.528028954503686, -172.2137061238161, -188.15574076821247, -252.42756190806898, -10.454288629345607, 45.420707070588335, -226.3203142055865, -324.882964734168, -190.87572529963293, -174.03662335029196, -216.77638531953426, -108.24913544086571, -45.021538132749775, 37.65012526786353, -382.4347397309401, -331.48204642316205, -302.5057400499575, 10.187204766068282, -165.1284493944049, -98.59082838969469, -222.82897177342574, -23.993641832572013, -273.41193813213954, -253.17322566612336, -210.61442488539728, -150.05116741616666, -70.3867428175282, -170.36113390240794, -26.01430802232571, 14.485334361879007, -79.65918511032253, -40.22242842575884, -10.029551137467886, -125.25911219944535, -16.755187706144454, -114.7720461343868, -200.71347775070288, -33.459244226713, -211.62515587585227, -76.10082028663696, -137.3428265041496, -121.914242432494, -90.02443692844847, -181.98873693280788, -290.6221338864482, -457.37677181401847, -145.5047043811687, -445.3916555090048, -314.06820943029516, -77.52425504408963, -421.0671523081229, -441.9769926733718, -301.9011531094018, -200.5457952601376, -103.92346010344579, -230.51791186691545, -374.988092798791, -315.3352285948526, -216.83544223395626, -0.8642753520927402, -210.2079266245744, -137.49588950864919, -35.652820037871514, -159.5056358841325, -15.222834980785212, -137.87756835728945, -181.7991928432987, -283.21277737935213, -253.4709720655927, -73.08819712950134, -110.77072737636999, -474.43308118076436, -57.504344488213675, -323.9171993251458, -280.5890289939399, -121.25335974110375, -124.98387118556406, -140.1796568782843, -105.99097927783785, -257.17775542384294, -183.82621048971836, -156.58825209188197, -75.74677337016513, -241.5886661560575, -95.78901419752003, -89.70351999613334, -190.7283943643363, -206.1394096595511, -345.45863411374, -454.4443897972749, -85.16135995367372, 49.84601706518955, -136.25743333631385, -47.28270116663512, -226.89813058049785, -308.69109352712894, -285.3583249980601, -442.129902466044, -119.94386470487466, 23.16094530148827, -97.90256785653473, -150.48851791528705, -422.16270043106834, -489.99060512172645, -187.74151035506998, 13.942456338192573, -209.5685816624207, -109.91713568191365, -423.0405643453877, 14.299756439321582, -141.846579753046, -37.719678249658635, -174.31608585825492, -291.43729811150706, -367.78509092559835, -262.91048597788125, -321.979623037931, -234.46596447038, -145.9061498436299, -156.95413322430306, -363.7553504065221, -126.82851130737203, -450.14876674936784, -479.69492983563714, 16.830708675670223, -118.48196946178638], "policy_predator_policy_reward": [65.42314085801857, 64.74379956403295, 72.61715339476513, 47.05475037413547, 343.72946702653815, 44.422014880863536, 283.77912998154136, 161.0041709765203, 46.741377538939794, 43.110801093606426, 86.5354845894236, 126.60901552947833, 218.4700809594143, 37.28782513307036, 144.57848757987875, 177.64072080644772, 82.83514941151074, 26.619925605296505, 56.29359823942474, 206.027135457705, 118.50870298048252, 211.54025577394438, 296.6265423073367, 155.58459480280683, 56.87765502712145, 67.94617247465635, 27.53923942968854, 74.29543050275689, 51.701695299531245, 110.24672417530614, 66.39374972221368, 81.7721410978217, 131.47184199898518, 56.803124042885486, 410.38384326871414, 75.6604283862076, 162.44968443019286, 11.341537424076417, 59.456996767478365, 217.20273386735363, 72.59753820227792, 11.421344965620268, 53.73083173582858, 171.53333904180005, 9.951907584399912, 187.91696052452562, 284.7777633154504, 35.554551783223154, 5.39822956816878, 59.20945956527126, 39.75324339037142, 101.91960119607485, 66.91575006638094, 253.4742498190318, 233.04617245613062, 81.63582631211962, 235.40300488495873, 64.07756314147454, 127.53523340942054, 121.41527781395418, 125.83160782699063, 114.50520192708728, 127.844339911924, 60.7421686535766, 61.28488019261362, 78.80457901569268, 108.54018646482372, 40.50471546679559, 105.48729775710856, 171.81742500828003, 204.362911937221, 257.96325620104477, 96.4345130957069, 249.62966725046437, 144.63546426037988, 131.1816770583938, 5.760316550060553, 348.22279614837583, 51.38198601535911, 155.88317076934246, 392.72344608529215, 75.31047669771955, 245.4498988374073, 234.9697413439594, 219.34359026603292, 244.98795974305116, 137.48153813274988, 48.15987473213639, 424.1711255902597, 222.91528666252788, 309.24059432059613, 85.13857774423084, 157.33352169718194, 170.75432837911512, 259.1148000053613, 222.93423909187783, 260.8765315859049, 240.22347073326767, 289.8087625092663, 79.57381414836163, 66.56610710299411, 193.3766564043081, 72.38334271635367, 54.40905111429753, 80.4302608732104, 63.041702944682804, 54.07982884046887, 163.42883449644407, 77.73236520251082, 166.42822810300464, 155.12290739904444, 194.03322857197196, 237.9599324031268, 126.94707422341797, 175.9860472957167, 134.78414045805874, 24.34189965270766, 202.90343839387356, 463.4338076328954, 306.53266021254177, 429.1126035921157, 202.41218989667075, 182.23434487120267, 342.4532804267018, 419.89725443102054, 567.6541344943083, 126.16259086722923, 370.3385057531031, 179.19403327807652, 231.52824250555236, 406.7541508452506, 311.87178376355945, 262.448754366898, 2.6938216311856564, 190.15975050345727, 235.36430952579886, 153.8643296663187, 143.24629404854215, 50.835680204696004, 197.67655360322064, 222.44385729675162, 193.64545086376955, 173.12954139279543, 225.73200269057514, 354.86750559368465, 421.8317819372248, 98.73760014006525, 339.1561928769781, 104.47548393024934, 312.9188217540742, 87.79979564037032, 242.34830858318546, 202.63475991381324, 209.6167065700595, 143.8757805309037, 201.49990851778492, 265.7777633836679, 64.05213061528688, 176.01762348687245, 117.08025388792603, 122.11004327824008, 203.49863118133027, 394.541681945571, 373.5000900522169, 140.9575039855558, 20.176219575721206, 157.958310883636, 53.09107691130247, 290.7912741003691, 271.3558050815001, 394.0360618918276, 339.2049474050896, 111.52484531008984, 159.50715647556765, 239.73095016922025, 134.2580059153023, 424.0296530832863, 409.77855577788364, 167.42993749948795, 168.30657534310652, 220.4809898647579, 141.31972689452567, 201.5292997301961, 387.04538427333915, 86.5313877268701, 130.6976311742804, 392.2267682144613, 217.11676272766346, 448.20867832222694, 182.27863561015994, 404.33905497216546, 181.00049595680554, 78.60576214927262, 261.07999202599774, 304.0733113868806, 172.95164248591982, 541.4452813458105, 387.55548988964375, 159.29971753960697, 58.97260832511916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7876847902357375, "mean_inference_ms": 2.481798081565225, "mean_action_processing_ms": 0.367579172352708, "mean_env_wait_ms": 0.28643488585850646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014001727104187012, "StateBufferConnector_ms": 0.0036935806274414062, "ViewRequirementAgentConnector_ms": 0.13770294189453125}, "num_episodes": 23, "episode_return_max": 311.2099999999999, "episode_return_min": -86.60018997784474, "episode_return_mean": 99.06626550577431, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.3389378934057, "num_env_steps_trained_throughput_per_sec": 258.3389378934057, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 15746.963, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15746.916, "sample_time_ms": 1938.206, "learn_time_ms": 13783.997, "learn_throughput": 290.192, "synch_weights_time_ms": 21.969}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "6c58f_00000", "date": "2024-08-16_16-14-02", "timestamp": 1723805042, "time_this_iter_s": 15.519788980484009, "time_total_s": 426.442227602005, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 426.442227602005, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 64.20454545454545, "ram_util_percent": 82.38636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.478231240186111, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 8.636426599946603, "policy_loss": -0.008493772957094565, "vf_loss": 8.643888756837795, "vf_explained_var": 0.002120353588982234, "kl": 0.01222644028228405, "entropy": 1.5090468728983844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.588226448133509, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.00794456951202, "policy_loss": -0.006158139752519745, "vf_loss": 9.014021072185859, "vf_explained_var": -0.06783600985688507, "kl": 0.013061924488734689, "entropy": 1.4531934507309445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 258.36139384132434, "episode_reward_min": -86.60018997784474, "episode_reward_mean": 76.67277996684079, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.99060512172645, "predator_policy": 2.6938216311856564}, "policy_reward_max": {"prey_policy": 160.94985641724796, "predator_policy": 567.6541344943083}, "policy_reward_mean": {"prey_policy": -155.3656721093116, "predator_policy": 193.70206209273195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.36139384132434, 82.61744517744708, 221.9899999999995, 203.94953434179422, 85.35000000000008, -20.225220006657732, 180.97426486182815, 164.99292601041424, 189.6065004033706, 105.7946219691822, 139.24362490455619, 182.1900129760472, 5.545573399849664, 134.79000000000008, 179.1699999999999, 201.97308371532893, 149.57224843704034, 103.7170729283142, 85.47242284967933, 90.07540624045349, -86.60018997784474, 242.2315752259439, -83.16935615674258, 115.50729153144206, 139.30602924868424, 178.26999999999958, -66.83037390131403, 102.06063678093797, 64.36857229219777, 235.22642549124106, -25.48516147908937, 8.71698435606529, 19.1948867873658, 115.26342017020491, 23.590350281811265, 82.22000000000035, 112.63335946498438, 114.98341399360069, 77.1810304640559, 51.513118817131456, -44.767835814674825, 21.96756214497026, 40.62843359861348, 133.09516082352025, 124.50724394383474, -5.945851749206699, 76.28090381326814, 28.30261321516671, 47.442858412034894, 77.82024389603272, 101.95216779285688, 95.41183046984214, -48.92266206212908, 72.30237488827672, 191.4954789737742, 56.47224920368369, 15.551916949279423, 64.98457615970769, 49.08273178219194, 4.9612264670888635, 12.494454472732661, 107.60534318114537, -71.25912956431706, -31.86125191322652, 125.81838067279256, 27.509253291990085, 26.55785507424269, 5.752781832813058, 174.24908238227113, 125.59787031270102, -78.34509669162453, 161.93745882571721, 42.314999414949305, 179.83387609746876, 37.662760898446564, 143.59014697236265, -0.20826297109268943, 28.893963420659663, 36.825471107337165, -13.558907841093816, -0.8429253495512083, 116.62106507860994, 51.83833553903166, 111.21308520071624, 99.08901952890464, 77.51845834624909, 87.77956687665704, 60.76523927098452, -38.00823541617588, 80.74932669389005, 167.948297641074, 177.51337846049205, 24.810171056178294, 25.254926305270942, 78.05905863216675, 88.65743102409185, -47.30089260174777, 130.74760991126476, 3.958076019975607, 61.52980714094167], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-76.37968443019294, 160.94985641724796, -148.09160289077985, -45.950682566605295, 12.50916956227719, 125.46194726982472, -35.322043725398274, 14.007407289563828, 75.21285970545549, -187.73172781438188, -244.84531369844228, -95.71222140688901, 85.18207436541059, 31.184501362976683, 57.962405414382225, -34.64232399041367, -192.37600539192863, 61.59250590988646, -188.39171213348857, -20.49566466557969, -148.11499940264198, -12.121943719235386, 12.957998466160452, -79.71849671348703, -144.60782662269781, -90.18340973153133, 5.120072355359181, -58.916580920859154, 41.58460402580576, -2.504063234111986, 67.03148483544777, -14.10330305173807, -23.37402853278817, -104.35844579555915, -217.3749968159553, -141.23409839399662, -103.02004824995704, -157.571709246535, -13.528028954503686, -172.2137061238161, -188.15574076821247, -252.42756190806898, -10.454288629345607, 45.420707070588335, -226.3203142055865, -324.882964734168, -190.87572529963293, -174.03662335029196, -216.77638531953426, -108.24913544086571, -45.021538132749775, 37.65012526786353, -382.4347397309401, -331.48204642316205, -302.5057400499575, 10.187204766068282, -165.1284493944049, -98.59082838969469, -222.82897177342574, -23.993641832572013, -273.41193813213954, -253.17322566612336, -210.61442488539728, -150.05116741616666, -70.3867428175282, -170.36113390240794, -26.01430802232571, 14.485334361879007, -79.65918511032253, -40.22242842575884, -10.029551137467886, -125.25911219944535, -16.755187706144454, -114.7720461343868, -200.71347775070288, -33.459244226713, -211.62515587585227, -76.10082028663696, -137.3428265041496, -121.914242432494, -90.02443692844847, -181.98873693280788, -290.6221338864482, -457.37677181401847, -145.5047043811687, -445.3916555090048, -314.06820943029516, -77.52425504408963, -421.0671523081229, -441.9769926733718, -301.9011531094018, -200.5457952601376, -103.92346010344579, -230.51791186691545, -374.988092798791, -315.3352285948526, -216.83544223395626, -0.8642753520927402, -210.2079266245744, -137.49588950864919, -35.652820037871514, -159.5056358841325, -15.222834980785212, -137.87756835728945, -181.7991928432987, -283.21277737935213, -253.4709720655927, -73.08819712950134, -110.77072737636999, -474.43308118076436, -57.504344488213675, -323.9171993251458, -280.5890289939399, -121.25335974110375, -124.98387118556406, -140.1796568782843, -105.99097927783785, -257.17775542384294, -183.82621048971836, -156.58825209188197, -75.74677337016513, -241.5886661560575, -95.78901419752003, -89.70351999613334, -190.7283943643363, -206.1394096595511, -345.45863411374, -454.4443897972749, -85.16135995367372, 49.84601706518955, -136.25743333631385, -47.28270116663512, -226.89813058049785, -308.69109352712894, -285.3583249980601, -442.129902466044, -119.94386470487466, 23.16094530148827, -97.90256785653473, -150.48851791528705, -422.16270043106834, -489.99060512172645, -187.74151035506998, 13.942456338192573, -209.5685816624207, -109.91713568191365, -423.0405643453877, 14.299756439321582, -141.846579753046, -37.719678249658635, -174.31608585825492, -291.43729811150706, -367.78509092559835, -262.91048597788125, -321.979623037931, -234.46596447038, -145.9061498436299, -156.95413322430306, -363.7553504065221, -126.82851130737203, -450.14876674936784, -479.69492983563714, 16.830708675670223, -118.48196946178638, -133.89472784327546, -243.4763085877924, -43.57770123390204, -148.42646805297986, -54.24484073761149, -147.2777661867033, -21.945049706856608, -124.30099098005321, -303.37035579344365, -78.72488579444546, -177.78404757174695, -159.29912767785024, -426.70183935601125, -274.8293500297292, -213.33884778131852, -2.4435299143376774, -26.720881218523793, -429.883305170992, 69.1409144295738, -152.99792494819775, -198.98926362130925, -91.60594930991226, -247.74066741103042, -201.0090581144773, -202.92243223501814, -53.08194962530037, -237.41242228325106, -254.50052666584736, -326.70222875341875, -272.08638922319614, -2.779299461448196, -126.65963632938701, -328.6121119690988, -236.25027923014966, -55.24567251717301, -229.5349585224997], "policy_predator_policy_reward": [162.44968443019286, 11.341537424076417, 59.456996767478365, 217.20273386735363, 72.59753820227792, 11.421344965620268, 53.73083173582858, 171.53333904180005, 9.951907584399912, 187.91696052452562, 284.7777633154504, 35.554551783223154, 5.39822956816878, 59.20945956527126, 39.75324339037142, 101.91960119607485, 66.91575006638094, 253.4742498190318, 233.04617245613062, 81.63582631211962, 235.40300488495873, 64.07756314147454, 127.53523340942054, 121.41527781395418, 125.83160782699063, 114.50520192708728, 127.844339911924, 60.7421686535766, 61.28488019261362, 78.80457901569268, 108.54018646482372, 40.50471546679559, 105.48729775710856, 171.81742500828003, 204.362911937221, 257.96325620104477, 96.4345130957069, 249.62966725046437, 144.63546426037988, 131.1816770583938, 5.760316550060553, 348.22279614837583, 51.38198601535911, 155.88317076934246, 392.72344608529215, 75.31047669771955, 245.4498988374073, 234.9697413439594, 219.34359026603292, 244.98795974305116, 137.48153813274988, 48.15987473213639, 424.1711255902597, 222.91528666252788, 309.24059432059613, 85.13857774423084, 157.33352169718194, 170.75432837911512, 259.1148000053613, 222.93423909187783, 260.8765315859049, 240.22347073326767, 289.8087625092663, 79.57381414836163, 66.56610710299411, 193.3766564043081, 72.38334271635367, 54.40905111429753, 80.4302608732104, 63.041702944682804, 54.07982884046887, 163.42883449644407, 77.73236520251082, 166.42822810300464, 155.12290739904444, 194.03322857197196, 237.9599324031268, 126.94707422341797, 175.9860472957167, 134.78414045805874, 24.34189965270766, 202.90343839387356, 463.4338076328954, 306.53266021254177, 429.1126035921157, 202.41218989667075, 182.23434487120267, 342.4532804267018, 419.89725443102054, 567.6541344943083, 126.16259086722923, 370.3385057531031, 179.19403327807652, 231.52824250555236, 406.7541508452506, 311.87178376355945, 262.448754366898, 2.6938216311856564, 190.15975050345727, 235.36430952579886, 153.8643296663187, 143.24629404854215, 50.835680204696004, 197.67655360322064, 222.44385729675162, 193.64545086376955, 173.12954139279543, 225.73200269057514, 354.86750559368465, 421.8317819372248, 98.73760014006525, 339.1561928769781, 104.47548393024934, 312.9188217540742, 87.79979564037032, 242.34830858318546, 202.63475991381324, 209.6167065700595, 143.8757805309037, 201.49990851778492, 265.7777633836679, 64.05213061528688, 176.01762348687245, 117.08025388792603, 122.11004327824008, 203.49863118133027, 394.541681945571, 373.5000900522169, 140.9575039855558, 20.176219575721206, 157.958310883636, 53.09107691130247, 290.7912741003691, 271.3558050815001, 394.0360618918276, 339.2049474050896, 111.52484531008984, 159.50715647556765, 239.73095016922025, 134.2580059153023, 424.0296530832863, 409.77855577788364, 167.42993749948795, 168.30657534310652, 220.4809898647579, 141.31972689452567, 201.5292997301961, 387.04538427333915, 86.5313877268701, 130.6976311742804, 392.2267682144613, 217.11676272766346, 448.20867832222694, 182.27863561015994, 404.33905497216546, 181.00049595680554, 78.60576214927262, 261.07999202599774, 304.0733113868806, 172.95164248591982, 541.4452813458105, 387.55548988964375, 159.29971753960697, 58.97260832511916, 155.06816733167818, 274.14120463842147, 197.98244570032264, 105.23480878727523, 197.3934027441699, 103.21822370904891, 137.40847900077551, 86.3560200323836, 251.82059499639354, 218.0542134681529, 115.86638468665127, 281.98202983392935, 223.52022148068153, 440.0027324888833, 163.57406035248673, 132.9576440370598, 324.2465911255156, 300.30589290507515, 158.51014907279773, 102.86023990631843, 258.15208674154104, 57.25329724585832, 214.83928009617284, 259.1653717346058, 231.9921988976161, 102.0712415948686, 257.6039167844706, 322.966463188719, 191.53066180415186, 359.9570635707153, 172.84094270978252, 87.34560299231677, 228.53776669204754, 340.282700527177, 121.29470167729632, 225.0157365033183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7857426460863643, "mean_inference_ms": 2.4779283723654766, "mean_action_processing_ms": 0.372661254200162, "mean_env_wait_ms": 0.2858806574637863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013608813285827637, "StateBufferConnector_ms": 0.0037963390350341797, "ViewRequirementAgentConnector_ms": 0.14695775508880615}, "num_episodes": 18, "episode_return_max": 258.36139384132434, "episode_return_min": -86.60018997784474, "episode_return_mean": 76.67277996684079, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.7356539079433, "num_env_steps_trained_throughput_per_sec": 259.7356539079433, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 15680.084, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15680.036, "sample_time_ms": 1924.605, "learn_time_ms": 13729.678, "learn_throughput": 291.34, "synch_weights_time_ms": 22.373}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "6c58f_00000", "date": "2024-08-16_16-14-18", "timestamp": 1723805058, "time_this_iter_s": 15.425829887390137, "time_total_s": 441.86805748939514, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04fa1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 441.86805748939514, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.04545454545455, "ram_util_percent": 82.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.352919957435951, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 8.693950434084291, "policy_loss": -0.006340764707851189, "vf_loss": 8.698877200878487, "vf_explained_var": -0.0002688733358231802, "kl": 0.01675849141317264, "entropy": 1.472598145500062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2975975895369496, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.753811233510415, "policy_loss": -0.004570954173517527, "vf_loss": 8.758309923404108, "vf_explained_var": -0.08941206913145762, "kl": 0.011561962293267064, "entropy": 1.5097489930965282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 242.2315752259439, "episode_reward_min": -86.60018997784474, "episode_reward_mean": 59.63213585312652, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.99060512172645, "predator_policy": 2.6938216311856564}, "policy_reward_max": {"prey_policy": 69.1409144295738, "predator_policy": 567.6541344943083}, "policy_reward_mean": {"prey_policy": -180.54508507877293, "predator_policy": 210.36115300533612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.47242284967933, 90.07540624045349, -86.60018997784474, 242.2315752259439, -83.16935615674258, 115.50729153144206, 139.30602924868424, 178.26999999999958, -66.83037390131403, 102.06063678093797, 64.36857229219777, 235.22642549124106, -25.48516147908937, 8.71698435606529, 19.1948867873658, 115.26342017020491, 23.590350281811265, 82.22000000000035, 112.63335946498438, 114.98341399360069, 77.1810304640559, 51.513118817131456, -44.767835814674825, 21.96756214497026, 40.62843359861348, 133.09516082352025, 124.50724394383474, -5.945851749206699, 76.28090381326814, 28.30261321516671, 47.442858412034894, 77.82024389603272, 101.95216779285688, 95.41183046984214, -48.92266206212908, 72.30237488827672, 191.4954789737742, 56.47224920368369, 15.551916949279423, 64.98457615970769, 49.08273178219194, 4.9612264670888635, 12.494454472732661, 107.60534318114537, -71.25912956431706, -31.86125191322652, 125.81838067279256, 27.509253291990085, 26.55785507424269, 5.752781832813058, 174.24908238227113, 125.59787031270102, -78.34509669162453, 161.93745882571721, 42.314999414949305, 179.83387609746876, 37.662760898446564, 143.59014697236265, -0.20826297109268943, 28.893963420659663, 36.825471107337165, -13.558907841093816, -0.8429253495512083, 116.62106507860994, 51.83833553903166, 111.21308520071624, 99.08901952890464, 77.51845834624909, 87.77956687665704, 60.76523927098452, -38.00823541617588, 80.74932669389005, 167.948297641074, 177.51337846049205, 24.810171056178294, 25.254926305270942, 78.05905863216675, 88.65743102409185, -47.30089260174777, 130.74760991126476, 3.958076019975607, 61.52980714094167, -51.25164105891204, 171.9914443324603, 155.46538944057664, -47.63585928804066, 66.16755190517895, 7.1645926007085325, 58.81057695459687, 44.26081733885574, 57.659567882585954, 85.23663029274104, -43.646150837889564, 25.362222130468833, 79.60265240456938, 48.58518565657371, 55.18691566181891, -0.38863495047061614, 34.24844505792403, 118.72896606466632], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.02004824995704, -157.571709246535, -13.528028954503686, -172.2137061238161, -188.15574076821247, -252.42756190806898, -10.454288629345607, 45.420707070588335, -226.3203142055865, -324.882964734168, -190.87572529963293, -174.03662335029196, -216.77638531953426, -108.24913544086571, -45.021538132749775, 37.65012526786353, -382.4347397309401, -331.48204642316205, -302.5057400499575, 10.187204766068282, -165.1284493944049, -98.59082838969469, -222.82897177342574, -23.993641832572013, -273.41193813213954, -253.17322566612336, -210.61442488539728, -150.05116741616666, -70.3867428175282, -170.36113390240794, -26.01430802232571, 14.485334361879007, -79.65918511032253, -40.22242842575884, -10.029551137467886, -125.25911219944535, -16.755187706144454, -114.7720461343868, -200.71347775070288, -33.459244226713, -211.62515587585227, -76.10082028663696, -137.3428265041496, -121.914242432494, -90.02443692844847, -181.98873693280788, -290.6221338864482, -457.37677181401847, -145.5047043811687, -445.3916555090048, -314.06820943029516, -77.52425504408963, -421.0671523081229, -441.9769926733718, -301.9011531094018, -200.5457952601376, -103.92346010344579, -230.51791186691545, -374.988092798791, -315.3352285948526, -216.83544223395626, -0.8642753520927402, -210.2079266245744, -137.49588950864919, -35.652820037871514, -159.5056358841325, -15.222834980785212, -137.87756835728945, -181.7991928432987, -283.21277737935213, -253.4709720655927, -73.08819712950134, -110.77072737636999, -474.43308118076436, -57.504344488213675, -323.9171993251458, -280.5890289939399, -121.25335974110375, -124.98387118556406, -140.1796568782843, -105.99097927783785, -257.17775542384294, -183.82621048971836, -156.58825209188197, -75.74677337016513, -241.5886661560575, -95.78901419752003, -89.70351999613334, -190.7283943643363, -206.1394096595511, -345.45863411374, -454.4443897972749, -85.16135995367372, 49.84601706518955, -136.25743333631385, -47.28270116663512, -226.89813058049785, -308.69109352712894, -285.3583249980601, -442.129902466044, -119.94386470487466, 23.16094530148827, -97.90256785653473, -150.48851791528705, -422.16270043106834, -489.99060512172645, -187.74151035506998, 13.942456338192573, -209.5685816624207, -109.91713568191365, -423.0405643453877, 14.299756439321582, -141.846579753046, -37.719678249658635, -174.31608585825492, -291.43729811150706, -367.78509092559835, -262.91048597788125, -321.979623037931, -234.46596447038, -145.9061498436299, -156.95413322430306, -363.7553504065221, -126.82851130737203, -450.14876674936784, -479.69492983563714, 16.830708675670223, -118.48196946178638, -133.89472784327546, -243.4763085877924, -43.57770123390204, -148.42646805297986, -54.24484073761149, -147.2777661867033, -21.945049706856608, -124.30099098005321, -303.37035579344365, -78.72488579444546, -177.78404757174695, -159.29912767785024, -426.70183935601125, -274.8293500297292, -213.33884778131852, -2.4435299143376774, -26.720881218523793, -429.883305170992, 69.1409144295738, -152.99792494819775, -198.98926362130925, -91.60594930991226, -247.74066741103042, -201.0090581144773, -202.92243223501814, -53.08194962530037, -237.41242228325106, -254.50052666584736, -326.70222875341875, -272.08638922319614, -2.779299461448196, -126.65963632938701, -328.6121119690988, -236.25027923014966, -55.24567251717301, -229.5349585224997, -109.41948973134416, -122.09927540949546, -253.55696919842714, -89.1097734157325, -219.8516741853007, -123.5741517488917, -340.89365067697486, -357.3820780445368, -141.41575227643548, -242.36565952857535, -111.97274916690387, -240.14703857619173, -133.23727286601775, -49.464047192252394, -94.78001045741273, -136.41229226490344, -79.90026164102234, -266.61639577950535, -300.6174005836194, -298.4131852245655, -196.31865655094768, -174.53258534564134, -241.7435395740936, -225.72702836501674, -439.3980659337797, -149.7701575476889, 0.862475879396813, -225.90871244548566, -234.05291729603326, -67.61329390127935, -204.86836814766448, -133.69101062277966, -58.18100561373782, -250.6116142851415, -87.1656094008503, -191.72766544231933], "policy_predator_policy_reward": [96.4345130957069, 249.62966725046437, 144.63546426037988, 131.1816770583938, 5.760316550060553, 348.22279614837583, 51.38198601535911, 155.88317076934246, 392.72344608529215, 75.31047669771955, 245.4498988374073, 234.9697413439594, 219.34359026603292, 244.98795974305116, 137.48153813274988, 48.15987473213639, 424.1711255902597, 222.91528666252788, 309.24059432059613, 85.13857774423084, 157.33352169718194, 170.75432837911512, 259.1148000053613, 222.93423909187783, 260.8765315859049, 240.22347073326767, 289.8087625092663, 79.57381414836163, 66.56610710299411, 193.3766564043081, 72.38334271635367, 54.40905111429753, 80.4302608732104, 63.041702944682804, 54.07982884046887, 163.42883449644407, 77.73236520251082, 166.42822810300464, 155.12290739904444, 194.03322857197196, 237.9599324031268, 126.94707422341797, 175.9860472957167, 134.78414045805874, 24.34189965270766, 202.90343839387356, 463.4338076328954, 306.53266021254177, 429.1126035921157, 202.41218989667075, 182.23434487120267, 342.4532804267018, 419.89725443102054, 567.6541344943083, 126.16259086722923, 370.3385057531031, 179.19403327807652, 231.52824250555236, 406.7541508452506, 311.87178376355945, 262.448754366898, 2.6938216311856564, 190.15975050345727, 235.36430952579886, 153.8643296663187, 143.24629404854215, 50.835680204696004, 197.67655360322064, 222.44385729675162, 193.64545086376955, 173.12954139279543, 225.73200269057514, 354.86750559368465, 421.8317819372248, 98.73760014006525, 339.1561928769781, 104.47548393024934, 312.9188217540742, 87.79979564037032, 242.34830858318546, 202.63475991381324, 209.6167065700595, 143.8757805309037, 201.49990851778492, 265.7777633836679, 64.05213061528688, 176.01762348687245, 117.08025388792603, 122.11004327824008, 203.49863118133027, 394.541681945571, 373.5000900522169, 140.9575039855558, 20.176219575721206, 157.958310883636, 53.09107691130247, 290.7912741003691, 271.3558050815001, 394.0360618918276, 339.2049474050896, 111.52484531008984, 159.50715647556765, 239.73095016922025, 134.2580059153023, 424.0296530832863, 409.77855577788364, 167.42993749948795, 168.30657534310652, 220.4809898647579, 141.31972689452567, 201.5292997301961, 387.04538427333915, 86.5313877268701, 130.6976311742804, 392.2267682144613, 217.11676272766346, 448.20867832222694, 182.27863561015994, 404.33905497216546, 181.00049595680554, 78.60576214927262, 261.07999202599774, 304.0733113868806, 172.95164248591982, 541.4452813458105, 387.55548988964375, 159.29971753960697, 58.97260832511916, 155.06816733167818, 274.14120463842147, 197.98244570032264, 105.23480878727523, 197.3934027441699, 103.21822370904891, 137.40847900077551, 86.3560200323836, 251.82059499639354, 218.0542134681529, 115.86638468665127, 281.98202983392935, 223.52022148068153, 440.0027324888833, 163.57406035248673, 132.9576440370598, 324.2465911255156, 300.30589290507515, 158.51014907279773, 102.86023990631843, 258.15208674154104, 57.25329724585832, 214.83928009617284, 259.1653717346058, 231.9921988976161, 102.0712415948686, 257.6039167844706, 322.966463188719, 191.53066180415186, 359.9570635707153, 172.84094270978252, 87.34560299231677, 228.53776669204754, 340.282700527177, 121.29470167729632, 225.0157365033183, 157.98140005711772, 22.285724024811632, 252.24837705713796, 262.40980988948337, 286.48762131847275, 212.40359405629533, 342.39191320446, 308.24795622901064, 162.66103161278454, 287.2879320974051, 258.40646546758654, 100.87791487621735, 70.75467958946493, 170.75721742340156, 86.60450601704838, 188.8486140441239, 73.5780243740423, 330.5982009290715, 267.1146151217881, 417.1526009791369, 150.53653376202593, 176.6685572966726, 341.546332967616, 151.28645710196272, 364.54015229140697, 304.23072359463094, 191.76525274564145, 81.86616947702105, 219.89112858229663, 136.96199827683446, 84.88233399171166, 253.28840982826136, 277.0189797054148, 66.02208525138785, 180.59023836957576, 217.03200253826006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7833904715424675, "mean_inference_ms": 2.4735813800222655, "mean_action_processing_ms": 0.37086979557181654, "mean_env_wait_ms": 0.28539126035269463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009514808654785156, "StateBufferConnector_ms": 0.0033884048461914062, "ViewRequirementAgentConnector_ms": 0.15111708641052246}, "num_episodes": 18, "episode_return_max": 242.2315752259439, "episode_return_min": -86.60018997784474, "episode_return_mean": 59.63213585312652, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.2463205645099, "num_env_steps_trained_throughput_per_sec": 258.2463205645099, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 15678.556, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15678.509, "sample_time_ms": 1935.506, "learn_time_ms": 13717.046, "learn_throughput": 291.608, "synch_weights_time_ms": 22.233}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "6c58f_00000", "date": "2024-08-16_16-14-33", "timestamp": 1723805073, "time_this_iter_s": 15.540892839431763, "time_total_s": 457.4089503288269, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0502c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 457.4089503288269, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 60.16363636363637, "ram_util_percent": 81.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0392247746388117, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 8.800211847900714, "policy_loss": -0.005462169473764127, "vf_loss": 8.804563267521127, "vf_explained_var": 0.0024689848145479877, "kl": 0.013164216064491877, "entropy": 1.4525907776343128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8044039285845226, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.776901966175705, "policy_loss": -0.0075806306065281945, "vf_loss": 8.784411597630335, "vf_explained_var": -0.023428174522187976, "kl": 0.011361685628089051, "entropy": 1.527432429727423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 191.4954789737742, "episode_reward_min": -78.34509669162453, "episode_reward_mean": 55.59256567054926, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.99060512172645, "predator_policy": 2.6938216311856564}, "policy_reward_max": {"prey_policy": 69.1409144295738, "predator_policy": 567.6541344943083}, "policy_reward_mean": {"prey_policy": -194.51891159399787, "predator_policy": 222.31519442927245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [112.63335946498438, 114.98341399360069, 77.1810304640559, 51.513118817131456, -44.767835814674825, 21.96756214497026, 40.62843359861348, 133.09516082352025, 124.50724394383474, -5.945851749206699, 76.28090381326814, 28.30261321516671, 47.442858412034894, 77.82024389603272, 101.95216779285688, 95.41183046984214, -48.92266206212908, 72.30237488827672, 191.4954789737742, 56.47224920368369, 15.551916949279423, 64.98457615970769, 49.08273178219194, 4.9612264670888635, 12.494454472732661, 107.60534318114537, -71.25912956431706, -31.86125191322652, 125.81838067279256, 27.509253291990085, 26.55785507424269, 5.752781832813058, 174.24908238227113, 125.59787031270102, -78.34509669162453, 161.93745882571721, 42.314999414949305, 179.83387609746876, 37.662760898446564, 143.59014697236265, -0.20826297109268943, 28.893963420659663, 36.825471107337165, -13.558907841093816, -0.8429253495512083, 116.62106507860994, 51.83833553903166, 111.21308520071624, 99.08901952890464, 77.51845834624909, 87.77956687665704, 60.76523927098452, -38.00823541617588, 80.74932669389005, 167.948297641074, 177.51337846049205, 24.810171056178294, 25.254926305270942, 78.05905863216675, 88.65743102409185, -47.30089260174777, 130.74760991126476, 3.958076019975607, 61.52980714094167, -51.25164105891204, 171.9914443324603, 155.46538944057664, -47.63585928804066, 66.16755190517895, 7.1645926007085325, 58.81057695459687, 44.26081733885574, 57.659567882585954, 85.23663029274104, -43.646150837889564, 25.362222130468833, 79.60265240456938, 48.58518565657371, 55.18691566181891, -0.38863495047061614, 34.24844505792403, 118.72896606466632, 56.41784000746424, 76.35433388701978, 1.6547155074998692, 101.80285269322161, 49.1377660370631, 88.628483042992, 125.58368907275165, 73.3813617046141, 54.57948139084164, 64.57852562140003, -33.456243730351304, 176.82366900057852, 47.8999870872712, -59.57680193066456, -63.09919664095088, 55.93549062608099, 24.01254447932137, -5.196596372843872], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.755187706144454, -114.7720461343868, -200.71347775070288, -33.459244226713, -211.62515587585227, -76.10082028663696, -137.3428265041496, -121.914242432494, -90.02443692844847, -181.98873693280788, -290.6221338864482, -457.37677181401847, -145.5047043811687, -445.3916555090048, -314.06820943029516, -77.52425504408963, -421.0671523081229, -441.9769926733718, -301.9011531094018, -200.5457952601376, -103.92346010344579, -230.51791186691545, -374.988092798791, -315.3352285948526, -216.83544223395626, -0.8642753520927402, -210.2079266245744, -137.49588950864919, -35.652820037871514, -159.5056358841325, -15.222834980785212, -137.87756835728945, -181.7991928432987, -283.21277737935213, -253.4709720655927, -73.08819712950134, -110.77072737636999, -474.43308118076436, -57.504344488213675, -323.9171993251458, -280.5890289939399, -121.25335974110375, -124.98387118556406, -140.1796568782843, -105.99097927783785, -257.17775542384294, -183.82621048971836, -156.58825209188197, -75.74677337016513, -241.5886661560575, -95.78901419752003, -89.70351999613334, -190.7283943643363, -206.1394096595511, -345.45863411374, -454.4443897972749, -85.16135995367372, 49.84601706518955, -136.25743333631385, -47.28270116663512, -226.89813058049785, -308.69109352712894, -285.3583249980601, -442.129902466044, -119.94386470487466, 23.16094530148827, -97.90256785653473, -150.48851791528705, -422.16270043106834, -489.99060512172645, -187.74151035506998, 13.942456338192573, -209.5685816624207, -109.91713568191365, -423.0405643453877, 14.299756439321582, -141.846579753046, -37.719678249658635, -174.31608585825492, -291.43729811150706, -367.78509092559835, -262.91048597788125, -321.979623037931, -234.46596447038, -145.9061498436299, -156.95413322430306, -363.7553504065221, -126.82851130737203, -450.14876674936784, -479.69492983563714, 16.830708675670223, -118.48196946178638, -133.89472784327546, -243.4763085877924, -43.57770123390204, -148.42646805297986, -54.24484073761149, -147.2777661867033, -21.945049706856608, -124.30099098005321, -303.37035579344365, -78.72488579444546, -177.78404757174695, -159.29912767785024, -426.70183935601125, -274.8293500297292, -213.33884778131852, -2.4435299143376774, -26.720881218523793, -429.883305170992, 69.1409144295738, -152.99792494819775, -198.98926362130925, -91.60594930991226, -247.74066741103042, -201.0090581144773, -202.92243223501814, -53.08194962530037, -237.41242228325106, -254.50052666584736, -326.70222875341875, -272.08638922319614, -2.779299461448196, -126.65963632938701, -328.6121119690988, -236.25027923014966, -55.24567251717301, -229.5349585224997, -109.41948973134416, -122.09927540949546, -253.55696919842714, -89.1097734157325, -219.8516741853007, -123.5741517488917, -340.89365067697486, -357.3820780445368, -141.41575227643548, -242.36565952857535, -111.97274916690387, -240.14703857619173, -133.23727286601775, -49.464047192252394, -94.78001045741273, -136.41229226490344, -79.90026164102234, -266.61639577950535, -300.6174005836194, -298.4131852245655, -196.31865655094768, -174.53258534564134, -241.7435395740936, -225.72702836501674, -439.3980659337797, -149.7701575476889, 0.862475879396813, -225.90871244548566, -234.05291729603326, -67.61329390127935, -204.86836814766448, -133.69101062277966, -58.18100561373782, -250.6116142851415, -87.1656094008503, -191.72766544231933, -192.94001903004053, -193.18636231200156, -240.92267374703215, -5.481062561509965, -263.7184123111436, -206.2874013152775, -142.25938211997038, -179.38679476796514, -209.41410414420466, -362.83632826618634, -28.38897303705553, -76.65851746401385, -105.72269958640514, -248.36197728352096, -165.79184067779227, -135.29474784474021, -29.097934624485898, -219.09849397151106, -211.81042559300786, -10.92920703900247, -336.1463086987045, -340.23621835756984, -388.06320585685927, -242.2632167109798, -74.15373245746012, -98.58190631078004, -475.2570013505196, -338.89168945311843, -329.5287794946036, -203.22341301917916, -289.82729947872974, -395.4996880845366, -374.4099431962901, -87.88783621393813, -277.91269985061393, -327.23304102034797], "policy_predator_policy_reward": [77.73236520251082, 166.42822810300464, 155.12290739904444, 194.03322857197196, 237.9599324031268, 126.94707422341797, 175.9860472957167, 134.78414045805874, 24.34189965270766, 202.90343839387356, 463.4338076328954, 306.53266021254177, 429.1126035921157, 202.41218989667075, 182.23434487120267, 342.4532804267018, 419.89725443102054, 567.6541344943083, 126.16259086722923, 370.3385057531031, 179.19403327807652, 231.52824250555236, 406.7541508452506, 311.87178376355945, 262.448754366898, 2.6938216311856564, 190.15975050345727, 235.36430952579886, 153.8643296663187, 143.24629404854215, 50.835680204696004, 197.67655360322064, 222.44385729675162, 193.64545086376955, 173.12954139279543, 225.73200269057514, 354.86750559368465, 421.8317819372248, 98.73760014006525, 339.1561928769781, 104.47548393024934, 312.9188217540742, 87.79979564037032, 242.34830858318546, 202.63475991381324, 209.6167065700595, 143.8757805309037, 201.49990851778492, 265.7777633836679, 64.05213061528688, 176.01762348687245, 117.08025388792603, 122.11004327824008, 203.49863118133027, 394.541681945571, 373.5000900522169, 140.9575039855558, 20.176219575721206, 157.958310883636, 53.09107691130247, 290.7912741003691, 271.3558050815001, 394.0360618918276, 339.2049474050896, 111.52484531008984, 159.50715647556765, 239.73095016922025, 134.2580059153023, 424.0296530832863, 409.77855577788364, 167.42993749948795, 168.30657534310652, 220.4809898647579, 141.31972689452567, 201.5292997301961, 387.04538427333915, 86.5313877268701, 130.6976311742804, 392.2267682144613, 217.11676272766346, 448.20867832222694, 182.27863561015994, 404.33905497216546, 181.00049595680554, 78.60576214927262, 261.07999202599774, 304.0733113868806, 172.95164248591982, 541.4452813458105, 387.55548988964375, 159.29971753960697, 58.97260832511916, 155.06816733167818, 274.14120463842147, 197.98244570032264, 105.23480878727523, 197.3934027441699, 103.21822370904891, 137.40847900077551, 86.3560200323836, 251.82059499639354, 218.0542134681529, 115.86638468665127, 281.98202983392935, 223.52022148068153, 440.0027324888833, 163.57406035248673, 132.9576440370598, 324.2465911255156, 300.30589290507515, 158.51014907279773, 102.86023990631843, 258.15208674154104, 57.25329724585832, 214.83928009617284, 259.1653717346058, 231.9921988976161, 102.0712415948686, 257.6039167844706, 322.966463188719, 191.53066180415186, 359.9570635707153, 172.84094270978252, 87.34560299231677, 228.53776669204754, 340.282700527177, 121.29470167729632, 225.0157365033183, 157.98140005711772, 22.285724024811632, 252.24837705713796, 262.40980988948337, 286.48762131847275, 212.40359405629533, 342.39191320446, 308.24795622901064, 162.66103161278454, 287.2879320974051, 258.40646546758654, 100.87791487621735, 70.75467958946493, 170.75721742340156, 86.60450601704838, 188.8486140441239, 73.5780243740423, 330.5982009290715, 267.1146151217881, 417.1526009791369, 150.53653376202593, 176.6685572966726, 341.546332967616, 151.28645710196272, 364.54015229140697, 304.23072359463094, 191.76525274564145, 81.86616947702105, 219.89112858229663, 136.96199827683446, 84.88233399171166, 253.28840982826136, 277.0189797054148, 66.02208525138785, 180.59023836957576, 217.03200253826006, 172.35929403497195, 270.18492731453426, 137.394761761502, 185.3633084340596, 277.25567881380215, 194.40485032011765, 148.1652276787674, 275.2838019023894, 301.00047413908567, 320.3877243083678, 166.7429974560576, 26.932976088002643, 254.23269337695658, 225.43567256572152, 106.15324221279892, 268.3147080143479, 100.81134333953376, 201.96456664730457, 196.21966231317393, 91.0984959402355, 305.92918377908745, 336.99709954683533, 366.41451033042046, 440.7355812379969, 96.3782743850363, 124.25735147047544, 341.6019968638179, 412.96989200915544, 153.3747943369613, 316.27820153587055, 406.1416068837495, 335.12087130559837, 281.5596289710894, 204.7506949184601, 369.1645635507233, 230.78458094739437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7849012860764089, "mean_inference_ms": 2.480399225022595, "mean_action_processing_ms": 0.37051784845713165, "mean_env_wait_ms": 0.28642030437193056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01677417755126953, "StateBufferConnector_ms": 0.00334775447845459, "ViewRequirementAgentConnector_ms": 0.15128874778747559}, "num_episodes": 18, "episode_return_max": 191.4954789737742, "episode_return_min": -78.34509669162453, "episode_return_mean": 55.59256567054926, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.41539158044185, "num_env_steps_trained_throughput_per_sec": 234.41539158044185, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 15803.798, "restore_workers_time_ms": 0.013, "training_step_time_ms": 15803.751, "sample_time_ms": 2049.966, "learn_time_ms": 13731.739, "learn_throughput": 291.296, "synch_weights_time_ms": 18.355}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "6c58f_00000", "date": "2024-08-16_16-14-50", "timestamp": 1723805090, "time_this_iter_s": 17.099241971969604, "time_total_s": 474.5081923007965, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04d61f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 474.5081923007965, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 64.87200000000001, "ram_util_percent": 81.556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.404847128649868, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 5.8759065123462175, "policy_loss": -0.009265287707574548, "vf_loss": 5.883662439275671, "vf_explained_var": 0.002258835520063128, "kl": 0.017888547176303914, "entropy": 1.497684969536211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6409667100855914, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.75700048946199, "policy_loss": -0.011981604531008218, "vf_loss": 7.7688889851645815, "vf_explained_var": 0.03633112879026504, "kl": 0.014896681392906565, "entropy": 1.4652010455333366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 277.6068484493842, "episode_reward_min": -78.34509669162453, "episode_reward_mean": 74.01002478573099, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.4411753615132, "predator_policy": 4.387257868196112}, "policy_reward_max": {"prey_policy": 162.35826260952288, "predator_policy": 791.6265350335564}, "policy_reward_mean": {"prey_policy": -179.52328820800471, "predator_policy": 216.52830060087012}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-31.86125191322652, 125.81838067279256, 27.509253291990085, 26.55785507424269, 5.752781832813058, 174.24908238227113, 125.59787031270102, -78.34509669162453, 161.93745882571721, 42.314999414949305, 179.83387609746876, 37.662760898446564, 143.59014697236265, -0.20826297109268943, 28.893963420659663, 36.825471107337165, -13.558907841093816, -0.8429253495512083, 116.62106507860994, 51.83833553903166, 111.21308520071624, 99.08901952890464, 77.51845834624909, 87.77956687665704, 60.76523927098452, -38.00823541617588, 80.74932669389005, 167.948297641074, 177.51337846049205, 24.810171056178294, 25.254926305270942, 78.05905863216675, 88.65743102409185, -47.30089260174777, 130.74760991126476, 3.958076019975607, 61.52980714094167, -51.25164105891204, 171.9914443324603, 155.46538944057664, -47.63585928804066, 66.16755190517895, 7.1645926007085325, 58.81057695459687, 44.26081733885574, 57.659567882585954, 85.23663029274104, -43.646150837889564, 25.362222130468833, 79.60265240456938, 48.58518565657371, 55.18691566181891, -0.38863495047061614, 34.24844505792403, 118.72896606466632, 56.41784000746424, 76.35433388701978, 1.6547155074998692, 101.80285269322161, 49.1377660370631, 88.628483042992, 125.58368907275165, 73.3813617046141, 54.57948139084164, 64.57852562140003, -33.456243730351304, 176.82366900057852, 47.8999870872712, -59.57680193066456, -63.09919664095088, 55.93549062608099, 24.01254447932137, -5.196596372843872, 47.98716973219193, 207.74419511741826, 113.88871018184719, -25.153921074792322, 228.2176853950242, 257.8161933487562, 29.68482527800571, 51.85194242677576, 106.73304717616182, 150.59000000000026, 161.11043129646166, 79.33189266135304, 201.75321682736276, 83.14658125426247, 121.61000000000034, -35.55562064956222, 103.7500000000005, 179.61854169261846, 277.6068484493842, 248.30649227946967, 88.60843354293702, -51.030899507160576, 123.78268297399998, 225.3993957632598, 79.78824028659486, 174.3518482616721, 118.58279254159406], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-345.45863411374, -454.4443897972749, -85.16135995367372, 49.84601706518955, -136.25743333631385, -47.28270116663512, -226.89813058049785, -308.69109352712894, -285.3583249980601, -442.129902466044, -119.94386470487466, 23.16094530148827, -97.90256785653473, -150.48851791528705, -422.16270043106834, -489.99060512172645, -187.74151035506998, 13.942456338192573, -209.5685816624207, -109.91713568191365, -423.0405643453877, 14.299756439321582, -141.846579753046, -37.719678249658635, -174.31608585825492, -291.43729811150706, -367.78509092559835, -262.91048597788125, -321.979623037931, -234.46596447038, -145.9061498436299, -156.95413322430306, -363.7553504065221, -126.82851130737203, -450.14876674936784, -479.69492983563714, 16.830708675670223, -118.48196946178638, -133.89472784327546, -243.4763085877924, -43.57770123390204, -148.42646805297986, -54.24484073761149, -147.2777661867033, -21.945049706856608, -124.30099098005321, -303.37035579344365, -78.72488579444546, -177.78404757174695, -159.29912767785024, -426.70183935601125, -274.8293500297292, -213.33884778131852, -2.4435299143376774, -26.720881218523793, -429.883305170992, 69.1409144295738, -152.99792494819775, -198.98926362130925, -91.60594930991226, -247.74066741103042, -201.0090581144773, -202.92243223501814, -53.08194962530037, -237.41242228325106, -254.50052666584736, -326.70222875341875, -272.08638922319614, -2.779299461448196, -126.65963632938701, -328.6121119690988, -236.25027923014966, -55.24567251717301, -229.5349585224997, -109.41948973134416, -122.09927540949546, -253.55696919842714, -89.1097734157325, -219.8516741853007, -123.5741517488917, -340.89365067697486, -357.3820780445368, -141.41575227643548, -242.36565952857535, -111.97274916690387, -240.14703857619173, -133.23727286601775, -49.464047192252394, -94.78001045741273, -136.41229226490344, -79.90026164102234, -266.61639577950535, -300.6174005836194, -298.4131852245655, -196.31865655094768, -174.53258534564134, -241.7435395740936, -225.72702836501674, -439.3980659337797, -149.7701575476889, 0.862475879396813, -225.90871244548566, -234.05291729603326, -67.61329390127935, -204.86836814766448, -133.69101062277966, -58.18100561373782, -250.6116142851415, -87.1656094008503, -191.72766544231933, -192.94001903004053, -193.18636231200156, -240.92267374703215, -5.481062561509965, -263.7184123111436, -206.2874013152775, -142.25938211997038, -179.38679476796514, -209.41410414420466, -362.83632826618634, -28.38897303705553, -76.65851746401385, -105.72269958640514, -248.36197728352096, -165.79184067779227, -135.29474784474021, -29.097934624485898, -219.09849397151106, -211.81042559300786, -10.92920703900247, -336.1463086987045, -340.23621835756984, -388.06320585685927, -242.2632167109798, -74.15373245746012, -98.58190631078004, -475.2570013505196, -338.89168945311843, -329.5287794946036, -203.22341301917916, -289.82729947872974, -395.4996880845366, -374.4099431962901, -87.88783621393813, -277.91269985061393, -327.23304102034797, -356.1883430631016, -610.9725406601567, 20.015047875494687, 162.35826260952288, 70.81148947475737, -109.67550958940068, -303.4419695285899, -332.5247526256851, -291.3547045133625, 142.91457651912106, 43.320140254188225, -151.67363365522326, -117.00337698162127, -24.35730302225361, -169.63084527169303, -42.110247083460635, -100.13918541139853, -4.632422174552594, 141.79137425190268, -146.45474133733086, 104.660484270099, -116.88338038664094, -86.73863472385966, -295.3984365373704, -423.2231221751678, -19.27531823898427, -78.3282601680332, -40.290047852707026, -9.533031159000368, 104.70938376525223, -356.6029694008644, -387.4911183951942, 32.138199144387116, -120.34934836274721, -44.85156585921165, 81.44883246971895, 50.54554818171607, -490.25577332662596, 136.60884728536718, 50.60522988727051, -87.3649352380421, -79.55285984695811, -717.4411753615132, -600.8652947156135, -241.92177025428325, -10.80276297911604, -236.5104415577736, -63.225242968303164, -442.9301399994916, -207.52288230105674, -163.15740015096006, -7.072939642918069, -175.64827424931931, -126.98950617250821], "policy_predator_policy_reward": [394.541681945571, 373.5000900522169, 140.9575039855558, 20.176219575721206, 157.958310883636, 53.09107691130247, 290.7912741003691, 271.3558050815001, 394.0360618918276, 339.2049474050896, 111.52484531008984, 159.50715647556765, 239.73095016922025, 134.2580059153023, 424.0296530832863, 409.77855577788364, 167.42993749948795, 168.30657534310652, 220.4809898647579, 141.31972689452567, 201.5292997301961, 387.04538427333915, 86.5313877268701, 130.6976311742804, 392.2267682144613, 217.11676272766346, 448.20867832222694, 182.27863561015994, 404.33905497216546, 181.00049595680554, 78.60576214927262, 261.07999202599774, 304.0733113868806, 172.95164248591982, 541.4452813458105, 387.55548988964375, 159.29971753960697, 58.97260832511916, 155.06816733167818, 274.14120463842147, 197.98244570032264, 105.23480878727523, 197.3934027441699, 103.21822370904891, 137.40847900077551, 86.3560200323836, 251.82059499639354, 218.0542134681529, 115.86638468665127, 281.98202983392935, 223.52022148068153, 440.0027324888833, 163.57406035248673, 132.9576440370598, 324.2465911255156, 300.30589290507515, 158.51014907279773, 102.86023990631843, 258.15208674154104, 57.25329724585832, 214.83928009617284, 259.1653717346058, 231.9921988976161, 102.0712415948686, 257.6039167844706, 322.966463188719, 191.53066180415186, 359.9570635707153, 172.84094270978252, 87.34560299231677, 228.53776669204754, 340.282700527177, 121.29470167729632, 225.0157365033183, 157.98140005711772, 22.285724024811632, 252.24837705713796, 262.40980988948337, 286.48762131847275, 212.40359405629533, 342.39191320446, 308.24795622901064, 162.66103161278454, 287.2879320974051, 258.40646546758654, 100.87791487621735, 70.75467958946493, 170.75721742340156, 86.60450601704838, 188.8486140441239, 73.5780243740423, 330.5982009290715, 267.1146151217881, 417.1526009791369, 150.53653376202593, 176.6685572966726, 341.546332967616, 151.28645710196272, 364.54015229140697, 304.23072359463094, 191.76525274564145, 81.86616947702105, 219.89112858229663, 136.96199827683446, 84.88233399171166, 253.28840982826136, 277.0189797054148, 66.02208525138785, 180.59023836957576, 217.03200253826006, 172.35929403497195, 270.18492731453426, 137.394761761502, 185.3633084340596, 277.25567881380215, 194.40485032011765, 148.1652276787674, 275.2838019023894, 301.00047413908567, 320.3877243083678, 166.7429974560576, 26.932976088002643, 254.23269337695658, 225.43567256572152, 106.15324221279892, 268.3147080143479, 100.81134333953376, 201.96456664730457, 196.21966231317393, 91.0984959402355, 305.92918377908745, 336.99709954683533, 366.41451033042046, 440.7355812379969, 96.3782743850363, 124.25735147047544, 341.6019968638179, 412.96989200915544, 153.3747943369613, 316.27820153587055, 406.1416068837495, 335.12087130559837, 281.5596289710894, 204.7506949184601, 369.1645635507233, 230.78458094739437, 457.317455916285, 557.8305975391648, 8.844052001748109, 16.52683263065243, 69.69260919077324, 83.06012110571741, 248.51594715952615, 362.2968539199548, 132.65327124974883, 244.00454213951681, 214.02596295557706, 152.14372379421445, 106.94555211389026, 64.09995316799082, 181.79185732007363, 81.80117746185543, 207.1173968939167, 4.387257868196112, 7.628625748097424, 147.62474133732997, 50.796223500229566, 122.53710391277494, 189.72525914794505, 271.7437047746372, 306.4738436238089, 337.77781361770633, 87.91237907472306, 113.8525102002799, 11.423031159000328, 15.010616234747776, 304.5121272358147, 404.0263399106813, 71.07468340660267, 120.88646581175814, 97.70143800621065, 45.31983707590089, 395.1595142956587, 322.1575592986353, 47.69866374967619, 13.393751357156422, 44.311425476155165, 211.21480315178303, 791.6265350335564, 475.64903553640846, 144.5080568792976, 231.99915932810092, 226.87336812634268, 298.2617121629941, 308.2197536260812, 422.02150896106093, 119.80858341224878, 224.77360464330096, 166.08087798563005, 255.1396949777905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7851183999370641, "mean_inference_ms": 2.4902148485742783, "mean_action_processing_ms": 0.369599186238759, "mean_env_wait_ms": 0.2876011853437906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016044139862060547, "StateBufferConnector_ms": 0.0035114288330078125, "ViewRequirementAgentConnector_ms": 0.15590929985046387}, "num_episodes": 27, "episode_return_max": 277.6068484493842, "episode_return_min": -78.34509669162453, "episode_return_mean": 74.01002478573099, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.95448276910102, "num_env_steps_trained_throughput_per_sec": 254.95448276910102, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 15784.672, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15784.623, "sample_time_ms": 1953.528, "learn_time_ms": 13811.943, "learn_throughput": 289.604, "synch_weights_time_ms": 15.475}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "6c58f_00000", "date": "2024-08-16_16-15-06", "timestamp": 1723805106, "time_this_iter_s": 15.736868858337402, "time_total_s": 490.2450611591339, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 490.2450611591339, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 60.48636363636364, "ram_util_percent": 81.49545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3341305613360077, "cur_kl_coeff": 0.084375, "cur_lr": 1e-05, "total_loss": 7.692054428373065, "policy_loss": -0.012532230666912501, "vf_loss": 7.702855533266824, "vf_explained_var": 0.00139092553860296, "kl": 0.020517206277492275, "entropy": 1.4679178685738297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1663102244573924, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.220124565104328, "policy_loss": -0.005628381734566083, "vf_loss": 9.225687359502075, "vf_explained_var": -0.008715730937069685, "kl": 0.010494352452415574, "entropy": 1.367205430023254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 329.75048828807445, "episode_reward_min": -80.68148832435575, "episode_reward_mean": 94.34244633231226, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.4411753615132, "predator_policy": 4.387257868196112}, "policy_reward_max": {"prey_policy": 170.74446977758265, "predator_policy": 791.6265350335564}, "policy_reward_mean": {"prey_policy": -163.1515427764285, "predator_policy": 210.3227659425846}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.62106507860994, 51.83833553903166, 111.21308520071624, 99.08901952890464, 77.51845834624909, 87.77956687665704, 60.76523927098452, -38.00823541617588, 80.74932669389005, 167.948297641074, 177.51337846049205, 24.810171056178294, 25.254926305270942, 78.05905863216675, 88.65743102409185, -47.30089260174777, 130.74760991126476, 3.958076019975607, 61.52980714094167, -51.25164105891204, 171.9914443324603, 155.46538944057664, -47.63585928804066, 66.16755190517895, 7.1645926007085325, 58.81057695459687, 44.26081733885574, 57.659567882585954, 85.23663029274104, -43.646150837889564, 25.362222130468833, 79.60265240456938, 48.58518565657371, 55.18691566181891, -0.38863495047061614, 34.24844505792403, 118.72896606466632, 56.41784000746424, 76.35433388701978, 1.6547155074998692, 101.80285269322161, 49.1377660370631, 88.628483042992, 125.58368907275165, 73.3813617046141, 54.57948139084164, 64.57852562140003, -33.456243730351304, 176.82366900057852, 47.8999870872712, -59.57680193066456, -63.09919664095088, 55.93549062608099, 24.01254447932137, -5.196596372843872, 47.98716973219193, 207.74419511741826, 113.88871018184719, -25.153921074792322, 228.2176853950242, 257.8161933487562, 29.68482527800571, 51.85194242677576, 106.73304717616182, 150.59000000000026, 161.11043129646166, 79.33189266135304, 201.75321682736276, 83.14658125426247, 121.61000000000034, -35.55562064956222, 103.7500000000005, 179.61854169261846, 277.6068484493842, 248.30649227946967, 88.60843354293702, -51.030899507160576, 123.78268297399998, 225.3993957632598, 79.78824028659486, 174.3518482616721, 118.58279254159406, 125.56406473061476, 147.89867705642877, 190.1322836780557, -1.4420148073690384, 329.75048828807445, 299.09665544331597, -73.42016560605879, -80.68148832435575, 273.85473347231334, 305.66328031287577, 144.24080685718056, 163.88469887282747, 160.10858649685818, 174.4249629207466, 241.8068415763652, 316.91253219867866, 34.58221092375833, 272.5924561049818], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [16.830708675670223, -118.48196946178638, -133.89472784327546, -243.4763085877924, -43.57770123390204, -148.42646805297986, -54.24484073761149, -147.2777661867033, -21.945049706856608, -124.30099098005321, -303.37035579344365, -78.72488579444546, -177.78404757174695, -159.29912767785024, -426.70183935601125, -274.8293500297292, -213.33884778131852, -2.4435299143376774, -26.720881218523793, -429.883305170992, 69.1409144295738, -152.99792494819775, -198.98926362130925, -91.60594930991226, -247.74066741103042, -201.0090581144773, -202.92243223501814, -53.08194962530037, -237.41242228325106, -254.50052666584736, -326.70222875341875, -272.08638922319614, -2.779299461448196, -126.65963632938701, -328.6121119690988, -236.25027923014966, -55.24567251717301, -229.5349585224997, -109.41948973134416, -122.09927540949546, -253.55696919842714, -89.1097734157325, -219.8516741853007, -123.5741517488917, -340.89365067697486, -357.3820780445368, -141.41575227643548, -242.36565952857535, -111.97274916690387, -240.14703857619173, -133.23727286601775, -49.464047192252394, -94.78001045741273, -136.41229226490344, -79.90026164102234, -266.61639577950535, -300.6174005836194, -298.4131852245655, -196.31865655094768, -174.53258534564134, -241.7435395740936, -225.72702836501674, -439.3980659337797, -149.7701575476889, 0.862475879396813, -225.90871244548566, -234.05291729603326, -67.61329390127935, -204.86836814766448, -133.69101062277966, -58.18100561373782, -250.6116142851415, -87.1656094008503, -191.72766544231933, -192.94001903004053, -193.18636231200156, -240.92267374703215, -5.481062561509965, -263.7184123111436, -206.2874013152775, -142.25938211997038, -179.38679476796514, -209.41410414420466, -362.83632826618634, -28.38897303705553, -76.65851746401385, -105.72269958640514, -248.36197728352096, -165.79184067779227, -135.29474784474021, -29.097934624485898, -219.09849397151106, -211.81042559300786, -10.92920703900247, -336.1463086987045, -340.23621835756984, -388.06320585685927, -242.2632167109798, -74.15373245746012, -98.58190631078004, -475.2570013505196, -338.89168945311843, -329.5287794946036, -203.22341301917916, -289.82729947872974, -395.4996880845366, -374.4099431962901, -87.88783621393813, -277.91269985061393, -327.23304102034797, -356.1883430631016, -610.9725406601567, 20.015047875494687, 162.35826260952288, 70.81148947475737, -109.67550958940068, -303.4419695285899, -332.5247526256851, -291.3547045133625, 142.91457651912106, 43.320140254188225, -151.67363365522326, -117.00337698162127, -24.35730302225361, -169.63084527169303, -42.110247083460635, -100.13918541139853, -4.632422174552594, 141.79137425190268, -146.45474133733086, 104.660484270099, -116.88338038664094, -86.73863472385966, -295.3984365373704, -423.2231221751678, -19.27531823898427, -78.3282601680332, -40.290047852707026, -9.533031159000368, 104.70938376525223, -356.6029694008644, -387.4911183951942, 32.138199144387116, -120.34934836274721, -44.85156585921165, 81.44883246971895, 50.54554818171607, -490.25577332662596, 136.60884728536718, 50.60522988727051, -87.3649352380421, -79.55285984695811, -717.4411753615132, -600.8652947156135, -241.92177025428325, -10.80276297911604, -236.5104415577736, -63.225242968303164, -442.9301399994916, -207.52288230105674, -163.15740015096006, -7.072939642918069, -175.64827424931931, -126.98950617250821, -15.600167263101635, -33.401339018163576, -87.57286569962525, -226.9658355713192, -118.53857774499318, -38.02356225874696, -333.8939546409815, -519.3679687404936, 133.0594998508393, 142.0923266224431, 57.000088364812456, 133.67000000000002, -423.0074677786141, -470.45119026660535, -611.3396282528793, -659.1409632204666, 130.57923780664586, 100.66738793862227, 170.74446977758265, -92.77587552005963, 7.091646998262617, -207.14078104201639, -34.26506273722982, -27.28903533610773, -28.805820398488976, -510.0596085591367, -103.5041745488734, -126.88036103733869, -189.31534477850974, 2.20893595306849, -559.1582810535112, 128.22502211573487, -368.6140923145085, -84.93349226958529, 66.27606255143925, 75.84236776659904], "policy_predator_policy_reward": [159.29971753960697, 58.97260832511916, 155.06816733167818, 274.14120463842147, 197.98244570032264, 105.23480878727523, 197.3934027441699, 103.21822370904891, 137.40847900077551, 86.3560200323836, 251.82059499639354, 218.0542134681529, 115.86638468665127, 281.98202983392935, 223.52022148068153, 440.0027324888833, 163.57406035248673, 132.9576440370598, 324.2465911255156, 300.30589290507515, 158.51014907279773, 102.86023990631843, 258.15208674154104, 57.25329724585832, 214.83928009617284, 259.1653717346058, 231.9921988976161, 102.0712415948686, 257.6039167844706, 322.966463188719, 191.53066180415186, 359.9570635707153, 172.84094270978252, 87.34560299231677, 228.53776669204754, 340.282700527177, 121.29470167729632, 225.0157365033183, 157.98140005711772, 22.285724024811632, 252.24837705713796, 262.40980988948337, 286.48762131847275, 212.40359405629533, 342.39191320446, 308.24795622901064, 162.66103161278454, 287.2879320974051, 258.40646546758654, 100.87791487621735, 70.75467958946493, 170.75721742340156, 86.60450601704838, 188.8486140441239, 73.5780243740423, 330.5982009290715, 267.1146151217881, 417.1526009791369, 150.53653376202593, 176.6685572966726, 341.546332967616, 151.28645710196272, 364.54015229140697, 304.23072359463094, 191.76525274564145, 81.86616947702105, 219.89112858229663, 136.96199827683446, 84.88233399171166, 253.28840982826136, 277.0189797054148, 66.02208525138785, 180.59023836957576, 217.03200253826006, 172.35929403497195, 270.18492731453426, 137.394761761502, 185.3633084340596, 277.25567881380215, 194.40485032011765, 148.1652276787674, 275.2838019023894, 301.00047413908567, 320.3877243083678, 166.7429974560576, 26.932976088002643, 254.23269337695658, 225.43567256572152, 106.15324221279892, 268.3147080143479, 100.81134333953376, 201.96456664730457, 196.21966231317393, 91.0984959402355, 305.92918377908745, 336.99709954683533, 366.41451033042046, 440.7355812379969, 96.3782743850363, 124.25735147047544, 341.6019968638179, 412.96989200915544, 153.3747943369613, 316.27820153587055, 406.1416068837495, 335.12087130559837, 281.5596289710894, 204.7506949184601, 369.1645635507233, 230.78458094739437, 457.317455916285, 557.8305975391648, 8.844052001748109, 16.52683263065243, 69.69260919077324, 83.06012110571741, 248.51594715952615, 362.2968539199548, 132.65327124974883, 244.00454213951681, 214.02596295557706, 152.14372379421445, 106.94555211389026, 64.09995316799082, 181.79185732007363, 81.80117746185543, 207.1173968939167, 4.387257868196112, 7.628625748097424, 147.62474133732997, 50.796223500229566, 122.53710391277494, 189.72525914794505, 271.7437047746372, 306.4738436238089, 337.77781361770633, 87.91237907472306, 113.8525102002799, 11.423031159000328, 15.010616234747776, 304.5121272358147, 404.0263399106813, 71.07468340660267, 120.88646581175814, 97.70143800621065, 45.31983707590089, 395.1595142956587, 322.1575592986353, 47.69866374967619, 13.393751357156422, 44.311425476155165, 211.21480315178303, 791.6265350335564, 475.64903553640846, 144.5080568792976, 231.99915932810092, 226.87336812634268, 298.2617121629941, 308.2197536260812, 422.02150896106093, 119.80858341224878, 224.77360464330096, 166.08087798563005, 255.1396949777905, 69.18650068242717, 105.37907032945253, 218.80163710284606, 243.6357412245276, 47.511134574479726, 299.18328910731606, 354.72961830085166, 497.0902902732542, 12.79907897489609, 41.79958283989617, 26.54337850574361, 81.88318857276, 427.8331571250783, 392.2053353140821, 616.654252104257, 573.1448510447328, 6.521615522702831, 36.086492204342335, 138.883988637274, 88.81069741807875, 245.50824073867318, 98.78170016226031, 134.73585440057954, 90.70294254558527, 245.19055221717392, 453.7834632373103, 190.3268459054881, 214.48265260147076, 224.20135752303858, 204.7118928787679, 464.7635334600677, 283.0822576763877, 119.72545330252413, 368.4043422053282, 54.834673776927346, 75.63935201001615]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7873155967198915, "mean_inference_ms": 2.4960397799396365, "mean_action_processing_ms": 0.3692941004859324, "mean_env_wait_ms": 0.2889098722915246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934041976928711, "StateBufferConnector_ms": 0.0034350156784057617, "ViewRequirementAgentConnector_ms": 0.11787927150726318}, "num_episodes": 18, "episode_return_max": 329.75048828807445, "episode_return_min": -80.68148832435575, "episode_return_mean": 94.34244633231226, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.6792062509857, "num_env_steps_trained_throughput_per_sec": 258.6792062509857, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 15742.522, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15742.474, "sample_time_ms": 1957.202, "learn_time_ms": 13765.941, "learn_throughput": 290.572, "synch_weights_time_ms": 15.651}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "6c58f_00000", "date": "2024-08-16_16-15-22", "timestamp": 1723805122, "time_this_iter_s": 15.511868953704834, "time_total_s": 505.75693011283875, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04ddca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 505.75693011283875, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 60.42272727272727, "ram_util_percent": 81.40909090909089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5425491690793365, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 1e-05, "total_loss": 7.637356389010394, "policy_loss": -0.006152846642508709, "vf_loss": 7.641735903422037, "vf_explained_var": -0.0006422470801721805, "kl": 0.0140114785999032, "entropy": 1.4737490134895164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.359869378300571, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.865799915727484, "policy_loss": -0.00810237603099455, "vf_loss": 8.873811822215085, "vf_explained_var": -0.026217853108411113, "kl": 0.014474834491955415, "entropy": 1.4065629896032747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 329.75048828807445, "episode_reward_min": -80.68148832435575, "episode_reward_mean": 105.99658390765806, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.4411753615132, "predator_policy": 4.387257868196112}, "policy_reward_max": {"prey_policy": 170.74446977758265, "predator_policy": 791.6265350335564}, "policy_reward_mean": {"prey_policy": -148.1295823423963, "predator_policy": 201.1278742962253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.52980714094167, -51.25164105891204, 171.9914443324603, 155.46538944057664, -47.63585928804066, 66.16755190517895, 7.1645926007085325, 58.81057695459687, 44.26081733885574, 57.659567882585954, 85.23663029274104, -43.646150837889564, 25.362222130468833, 79.60265240456938, 48.58518565657371, 55.18691566181891, -0.38863495047061614, 34.24844505792403, 118.72896606466632, 56.41784000746424, 76.35433388701978, 1.6547155074998692, 101.80285269322161, 49.1377660370631, 88.628483042992, 125.58368907275165, 73.3813617046141, 54.57948139084164, 64.57852562140003, -33.456243730351304, 176.82366900057852, 47.8999870872712, -59.57680193066456, -63.09919664095088, 55.93549062608099, 24.01254447932137, -5.196596372843872, 47.98716973219193, 207.74419511741826, 113.88871018184719, -25.153921074792322, 228.2176853950242, 257.8161933487562, 29.68482527800571, 51.85194242677576, 106.73304717616182, 150.59000000000026, 161.11043129646166, 79.33189266135304, 201.75321682736276, 83.14658125426247, 121.61000000000034, -35.55562064956222, 103.7500000000005, 179.61854169261846, 277.6068484493842, 248.30649227946967, 88.60843354293702, -51.030899507160576, 123.78268297399998, 225.3993957632598, 79.78824028659486, 174.3518482616721, 118.58279254159406, 125.56406473061476, 147.89867705642877, 190.1322836780557, -1.4420148073690384, 329.75048828807445, 299.09665544331597, -73.42016560605879, -80.68148832435575, 273.85473347231334, 305.66328031287577, 144.24080685718056, 163.88469887282747, 160.10858649685818, 174.4249629207466, 241.8068415763652, 316.91253219867866, 34.58221092375833, 272.5924561049818, 170.2695518612802, 256.89415142481096, 138.07828205642002, 24.395775567687313, 264.27180451461334, 114.53090843471867, 75.05069219148122, 5.920047258895416, 171.7339486057455, 147.36666510248148, 79.48345915007589, 232.27844614431416, 58.50436627611234, 173.82123254704416, -33.640752193478654, 201.31361301204853, 258.98917731366475, 123.3663058342978], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.24567251717301, -229.5349585224997, -109.41948973134416, -122.09927540949546, -253.55696919842714, -89.1097734157325, -219.8516741853007, -123.5741517488917, -340.89365067697486, -357.3820780445368, -141.41575227643548, -242.36565952857535, -111.97274916690387, -240.14703857619173, -133.23727286601775, -49.464047192252394, -94.78001045741273, -136.41229226490344, -79.90026164102234, -266.61639577950535, -300.6174005836194, -298.4131852245655, -196.31865655094768, -174.53258534564134, -241.7435395740936, -225.72702836501674, -439.3980659337797, -149.7701575476889, 0.862475879396813, -225.90871244548566, -234.05291729603326, -67.61329390127935, -204.86836814766448, -133.69101062277966, -58.18100561373782, -250.6116142851415, -87.1656094008503, -191.72766544231933, -192.94001903004053, -193.18636231200156, -240.92267374703215, -5.481062561509965, -263.7184123111436, -206.2874013152775, -142.25938211997038, -179.38679476796514, -209.41410414420466, -362.83632826618634, -28.38897303705553, -76.65851746401385, -105.72269958640514, -248.36197728352096, -165.79184067779227, -135.29474784474021, -29.097934624485898, -219.09849397151106, -211.81042559300786, -10.92920703900247, -336.1463086987045, -340.23621835756984, -388.06320585685927, -242.2632167109798, -74.15373245746012, -98.58190631078004, -475.2570013505196, -338.89168945311843, -329.5287794946036, -203.22341301917916, -289.82729947872974, -395.4996880845366, -374.4099431962901, -87.88783621393813, -277.91269985061393, -327.23304102034797, -356.1883430631016, -610.9725406601567, 20.015047875494687, 162.35826260952288, 70.81148947475737, -109.67550958940068, -303.4419695285899, -332.5247526256851, -291.3547045133625, 142.91457651912106, 43.320140254188225, -151.67363365522326, -117.00337698162127, -24.35730302225361, -169.63084527169303, -42.110247083460635, -100.13918541139853, -4.632422174552594, 141.79137425190268, -146.45474133733086, 104.660484270099, -116.88338038664094, -86.73863472385966, -295.3984365373704, -423.2231221751678, -19.27531823898427, -78.3282601680332, -40.290047852707026, -9.533031159000368, 104.70938376525223, -356.6029694008644, -387.4911183951942, 32.138199144387116, -120.34934836274721, -44.85156585921165, 81.44883246971895, 50.54554818171607, -490.25577332662596, 136.60884728536718, 50.60522988727051, -87.3649352380421, -79.55285984695811, -717.4411753615132, -600.8652947156135, -241.92177025428325, -10.80276297911604, -236.5104415577736, -63.225242968303164, -442.9301399994916, -207.52288230105674, -163.15740015096006, -7.072939642918069, -175.64827424931931, -126.98950617250821, -15.600167263101635, -33.401339018163576, -87.57286569962525, -226.9658355713192, -118.53857774499318, -38.02356225874696, -333.8939546409815, -519.3679687404936, 133.0594998508393, 142.0923266224431, 57.000088364812456, 133.67000000000002, -423.0074677786141, -470.45119026660535, -611.3396282528793, -659.1409632204666, 130.57923780664586, 100.66738793862227, 170.74446977758265, -92.77587552005963, 7.091646998262617, -207.14078104201639, -34.26506273722982, -27.28903533610773, -28.805820398488976, -510.0596085591367, -103.5041745488734, -126.88036103733869, -189.31534477850974, 2.20893595306849, -559.1582810535112, 128.22502211573487, -368.6140923145085, -84.93349226958529, 66.27606255143925, 75.84236776659904, 28.10988935059285, -156.21984187014658, -5.427428464531543, -465.80915355115445, -288.29441744104537, -8.738530903383506, -143.4216078279321, -181.8898871956941, -19.70756773468452, 135.03155736502052, -48.76196684251437, -153.99349903805253, -87.23954460883101, -261.93883570417523, -7.903088356640929, -24.733532295196568, -6.520385691972954, -106.98004165529198, 51.653382662413975, -40.46020389786274, -111.41695657761669, -210.20571808077563, -65.29754502081694, -94.38167360544115, -16.73252533370814, -465.17381887824956, 0.09777017373639563, 89.03206937409269, -316.14656576286933, -163.02129255096585, 99.55004258933766, 31.845564105946945, 12.797959385575258, 65.83525616179753, 0.1889446683344289, -35.43522931601425], "policy_predator_policy_reward": [121.29470167729632, 225.0157365033183, 157.98140005711772, 22.285724024811632, 252.24837705713796, 262.40980988948337, 286.48762131847275, 212.40359405629533, 342.39191320446, 308.24795622901064, 162.66103161278454, 287.2879320974051, 258.40646546758654, 100.87791487621735, 70.75467958946493, 170.75721742340156, 86.60450601704838, 188.8486140441239, 73.5780243740423, 330.5982009290715, 267.1146151217881, 417.1526009791369, 150.53653376202593, 176.6685572966726, 341.546332967616, 151.28645710196272, 364.54015229140697, 304.23072359463094, 191.76525274564145, 81.86616947702105, 219.89112858229663, 136.96199827683446, 84.88233399171166, 253.28840982826136, 277.0189797054148, 66.02208525138785, 180.59023836957576, 217.03200253826006, 172.35929403497195, 270.18492731453426, 137.394761761502, 185.3633084340596, 277.25567881380215, 194.40485032011765, 148.1652276787674, 275.2838019023894, 301.00047413908567, 320.3877243083678, 166.7429974560576, 26.932976088002643, 254.23269337695658, 225.43567256572152, 106.15324221279892, 268.3147080143479, 100.81134333953376, 201.96456664730457, 196.21966231317393, 91.0984959402355, 305.92918377908745, 336.99709954683533, 366.41451033042046, 440.7355812379969, 96.3782743850363, 124.25735147047544, 341.6019968638179, 412.96989200915544, 153.3747943369613, 316.27820153587055, 406.1416068837495, 335.12087130559837, 281.5596289710894, 204.7506949184601, 369.1645635507233, 230.78458094739437, 457.317455916285, 557.8305975391648, 8.844052001748109, 16.52683263065243, 69.69260919077324, 83.06012110571741, 248.51594715952615, 362.2968539199548, 132.65327124974883, 244.00454213951681, 214.02596295557706, 152.14372379421445, 106.94555211389026, 64.09995316799082, 181.79185732007363, 81.80117746185543, 207.1173968939167, 4.387257868196112, 7.628625748097424, 147.62474133732997, 50.796223500229566, 122.53710391277494, 189.72525914794505, 271.7437047746372, 306.4738436238089, 337.77781361770633, 87.91237907472306, 113.8525102002799, 11.423031159000328, 15.010616234747776, 304.5121272358147, 404.0263399106813, 71.07468340660267, 120.88646581175814, 97.70143800621065, 45.31983707590089, 395.1595142956587, 322.1575592986353, 47.69866374967619, 13.393751357156422, 44.311425476155165, 211.21480315178303, 791.6265350335564, 475.64903553640846, 144.5080568792976, 231.99915932810092, 226.87336812634268, 298.2617121629941, 308.2197536260812, 422.02150896106093, 119.80858341224878, 224.77360464330096, 166.08087798563005, 255.1396949777905, 69.18650068242717, 105.37907032945253, 218.80163710284606, 243.6357412245276, 47.511134574479726, 299.18328910731606, 354.72961830085166, 497.0902902732542, 12.79907897489609, 41.79958283989617, 26.54337850574361, 81.88318857276, 427.8331571250783, 392.2053353140821, 616.654252104257, 573.1448510447328, 6.521615522702831, 36.086492204342335, 138.883988637274, 88.81069741807875, 245.50824073867318, 98.78170016226031, 134.73585440057954, 90.70294254558527, 245.19055221717392, 453.7834632373103, 190.3268459054881, 214.48265260147076, 224.20135752303858, 204.7118928787679, 464.7635334600677, 283.0822576763877, 119.72545330252413, 368.4043422053282, 54.834673776927346, 75.63935201001615, 98.69349510287616, 199.68600927795794, 354.6294592148086, 373.5012742256885, 171.7409673876681, 263.37026301318065, 64.0918611345694, 285.61540945674346, 101.4526472515527, 47.4951676327252, 88.02754783452541, 229.25882648076004, 105.57811533697291, 318.6509571675148, 17.058032116582964, 21.49863579415026, 170.35843955047645, 114.87593640253394, 126.53231120017107, 9.641175137759006, 222.23256385608147, 178.87356995238676, 98.97328421307316, 292.9843805574998, 57.738914636980034, 482.67179585108994, 38.47644469874925, 46.214948300465906, 237.23858886326653, 208.2885172570897, 31.875782707536654, 38.04222360922769, 94.91420523039947, 85.44175653589255, 126.83574061708406, 31.776849864893528]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.787960306855181, "mean_inference_ms": 2.5024613512681593, "mean_action_processing_ms": 0.3689390752468327, "mean_env_wait_ms": 0.289821980144344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012196898460388184, "StateBufferConnector_ms": 0.003387928009033203, "ViewRequirementAgentConnector_ms": 0.1114051342010498}, "num_episodes": 18, "episode_return_max": 329.75048828807445, "episode_return_min": -80.68148832435575, "episode_return_mean": 105.99658390765806, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.46251055949415, "num_env_steps_trained_throughput_per_sec": 262.46251055949415, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 15672.958, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15672.893, "sample_time_ms": 1940.28, "learn_time_ms": 13712.552, "learn_throughput": 291.704, "synch_weights_time_ms": 16.346}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "6c58f_00000", "date": "2024-08-16_16-15-37", "timestamp": 1723805137, "time_this_iter_s": 15.288151979446411, "time_total_s": 521.0450820922852, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04faaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 521.0450820922852, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 61.06363636363637, "ram_util_percent": 81.47272727272728}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6618904165805333, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 1e-05, "total_loss": 6.81511453245052, "policy_loss": -0.013631469144722417, "vf_loss": 6.825982638010903, "vf_explained_var": 0.0014550587172230715, "kl": 0.021833999171607617, "entropy": 1.4881871994210298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1040318399825426, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.773402057375226, "policy_loss": -0.004278245884259897, "vf_loss": 7.777618032788474, "vf_explained_var": -0.09740032771277049, "kl": 0.009961840639901966, "entropy": 1.447159147704089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 329.75048828807445, "episode_reward_min": -80.68148832435575, "episode_reward_mean": 123.48513929448458, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.4411753615132, "predator_policy": 4.387257868196112}, "policy_reward_max": {"prey_policy": 170.74446977758265, "predator_policy": 791.6265350335564}, "policy_reward_mean": {"prey_policy": -131.26932130271925, "predator_policy": 193.0118909499615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.72896606466632, 56.41784000746424, 76.35433388701978, 1.6547155074998692, 101.80285269322161, 49.1377660370631, 88.628483042992, 125.58368907275165, 73.3813617046141, 54.57948139084164, 64.57852562140003, -33.456243730351304, 176.82366900057852, 47.8999870872712, -59.57680193066456, -63.09919664095088, 55.93549062608099, 24.01254447932137, -5.196596372843872, 47.98716973219193, 207.74419511741826, 113.88871018184719, -25.153921074792322, 228.2176853950242, 257.8161933487562, 29.68482527800571, 51.85194242677576, 106.73304717616182, 150.59000000000026, 161.11043129646166, 79.33189266135304, 201.75321682736276, 83.14658125426247, 121.61000000000034, -35.55562064956222, 103.7500000000005, 179.61854169261846, 277.6068484493842, 248.30649227946967, 88.60843354293702, -51.030899507160576, 123.78268297399998, 225.3993957632598, 79.78824028659486, 174.3518482616721, 118.58279254159406, 125.56406473061476, 147.89867705642877, 190.1322836780557, -1.4420148073690384, 329.75048828807445, 299.09665544331597, -73.42016560605879, -80.68148832435575, 273.85473347231334, 305.66328031287577, 144.24080685718056, 163.88469887282747, 160.10858649685818, 174.4249629207466, 241.8068415763652, 316.91253219867866, 34.58221092375833, 272.5924561049818, 170.2695518612802, 256.89415142481096, 138.07828205642002, 24.395775567687313, 264.27180451461334, 114.53090843471867, 75.05069219148122, 5.920047258895416, 171.7339486057455, 147.36666510248148, 79.48345915007589, 232.27844614431416, 58.50436627611234, 173.82123254704416, -33.640752193478654, 201.31361301204853, 258.98917731366475, 123.3663058342978, 195.7987064136688, 45.50471992678369, 142.99952762020106, 180.35441745372606, 108.50851964992616, 97.34494330135257, 198.52819267848497, 18.81000000000027, 24.98000000000008, 72.81000000000013, 218.10966811885513, 153.45867462400412, 112.61851523270501, 277.36474113328995, 250.48392048215933, 177.45918038768528, 115.56174260395066, 166.5095817205475], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-87.1656094008503, -191.72766544231933, -192.94001903004053, -193.18636231200156, -240.92267374703215, -5.481062561509965, -263.7184123111436, -206.2874013152775, -142.25938211997038, -179.38679476796514, -209.41410414420466, -362.83632826618634, -28.38897303705553, -76.65851746401385, -105.72269958640514, -248.36197728352096, -165.79184067779227, -135.29474784474021, -29.097934624485898, -219.09849397151106, -211.81042559300786, -10.92920703900247, -336.1463086987045, -340.23621835756984, -388.06320585685927, -242.2632167109798, -74.15373245746012, -98.58190631078004, -475.2570013505196, -338.89168945311843, -329.5287794946036, -203.22341301917916, -289.82729947872974, -395.4996880845366, -374.4099431962901, -87.88783621393813, -277.91269985061393, -327.23304102034797, -356.1883430631016, -610.9725406601567, 20.015047875494687, 162.35826260952288, 70.81148947475737, -109.67550958940068, -303.4419695285899, -332.5247526256851, -291.3547045133625, 142.91457651912106, 43.320140254188225, -151.67363365522326, -117.00337698162127, -24.35730302225361, -169.63084527169303, -42.110247083460635, -100.13918541139853, -4.632422174552594, 141.79137425190268, -146.45474133733086, 104.660484270099, -116.88338038664094, -86.73863472385966, -295.3984365373704, -423.2231221751678, -19.27531823898427, -78.3282601680332, -40.290047852707026, -9.533031159000368, 104.70938376525223, -356.6029694008644, -387.4911183951942, 32.138199144387116, -120.34934836274721, -44.85156585921165, 81.44883246971895, 50.54554818171607, -490.25577332662596, 136.60884728536718, 50.60522988727051, -87.3649352380421, -79.55285984695811, -717.4411753615132, -600.8652947156135, -241.92177025428325, -10.80276297911604, -236.5104415577736, -63.225242968303164, -442.9301399994916, -207.52288230105674, -163.15740015096006, -7.072939642918069, -175.64827424931931, -126.98950617250821, -15.600167263101635, -33.401339018163576, -87.57286569962525, -226.9658355713192, -118.53857774499318, -38.02356225874696, -333.8939546409815, -519.3679687404936, 133.0594998508393, 142.0923266224431, 57.000088364812456, 133.67000000000002, -423.0074677786141, -470.45119026660535, -611.3396282528793, -659.1409632204666, 130.57923780664586, 100.66738793862227, 170.74446977758265, -92.77587552005963, 7.091646998262617, -207.14078104201639, -34.26506273722982, -27.28903533610773, -28.805820398488976, -510.0596085591367, -103.5041745488734, -126.88036103733869, -189.31534477850974, 2.20893595306849, -559.1582810535112, 128.22502211573487, -368.6140923145085, -84.93349226958529, 66.27606255143925, 75.84236776659904, 28.10988935059285, -156.21984187014658, -5.427428464531543, -465.80915355115445, -288.29441744104537, -8.738530903383506, -143.4216078279321, -181.8898871956941, -19.70756773468452, 135.03155736502052, -48.76196684251437, -153.99349903805253, -87.23954460883101, -261.93883570417523, -7.903088356640929, -24.733532295196568, -6.520385691972954, -106.98004165529198, 51.653382662413975, -40.46020389786274, -111.41695657761669, -210.20571808077563, -65.29754502081694, -94.38167360544115, -16.73252533370814, -465.17381887824956, 0.09777017373639563, 89.03206937409269, -316.14656576286933, -163.02129255096585, 99.55004258933766, 31.845564105946945, 12.797959385575258, 65.83525616179753, 0.1889446683344289, -35.43522931601425, -102.24740403801573, -85.72825585652605, -73.64707740837429, -30.164291342596584, 34.736812300017384, -70.57475578894821, 31.73379758055457, -336.3831343444471, -108.81553658249187, 18.23125391496295, 19.285632039723275, -11.99541405961966, -48.28998654500359, -466.33850588167695, -167.19834070457705, -2.6767615227572596, -20.314578839572423, -117.049720277905, 8.92837203177543, -0.29195665592695685, 53.085065354877635, -456.57619902995, 53.36387232601466, -1.6014533450771022, -67.64434590861744, -84.22970328252966, -524.1886724938136, -48.820384051787926, -306.9441199047811, 72.19810551027552, -357.9329430206704, -2.502733461922791, -56.950207277843944, 27.37101354094226, 30.275910794399472, -25.615384590367828], "policy_predator_policy_reward": [180.59023836957576, 217.03200253826006, 172.35929403497195, 270.18492731453426, 137.394761761502, 185.3633084340596, 277.25567881380215, 194.40485032011765, 148.1652276787674, 275.2838019023894, 301.00047413908567, 320.3877243083678, 166.7429974560576, 26.932976088002643, 254.23269337695658, 225.43567256572152, 106.15324221279892, 268.3147080143479, 100.81134333953376, 201.96456664730457, 196.21966231317393, 91.0984959402355, 305.92918377908745, 336.99709954683533, 366.41451033042046, 440.7355812379969, 96.3782743850363, 124.25735147047544, 341.6019968638179, 412.96989200915544, 153.3747943369613, 316.27820153587055, 406.1416068837495, 335.12087130559837, 281.5596289710894, 204.7506949184601, 369.1645635507233, 230.78458094739437, 457.317455916285, 557.8305975391648, 8.844052001748109, 16.52683263065243, 69.69260919077324, 83.06012110571741, 248.51594715952615, 362.2968539199548, 132.65327124974883, 244.00454213951681, 214.02596295557706, 152.14372379421445, 106.94555211389026, 64.09995316799082, 181.79185732007363, 81.80117746185543, 207.1173968939167, 4.387257868196112, 7.628625748097424, 147.62474133732997, 50.796223500229566, 122.53710391277494, 189.72525914794505, 271.7437047746372, 306.4738436238089, 337.77781361770633, 87.91237907472306, 113.8525102002799, 11.423031159000328, 15.010616234747776, 304.5121272358147, 404.0263399106813, 71.07468340660267, 120.88646581175814, 97.70143800621065, 45.31983707590089, 395.1595142956587, 322.1575592986353, 47.69866374967619, 13.393751357156422, 44.311425476155165, 211.21480315178303, 791.6265350335564, 475.64903553640846, 144.5080568792976, 231.99915932810092, 226.87336812634268, 298.2617121629941, 308.2197536260812, 422.02150896106093, 119.80858341224878, 224.77360464330096, 166.08087798563005, 255.1396949777905, 69.18650068242717, 105.37907032945253, 218.80163710284606, 243.6357412245276, 47.511134574479726, 299.18328910731606, 354.72961830085166, 497.0902902732542, 12.79907897489609, 41.79958283989617, 26.54337850574361, 81.88318857276, 427.8331571250783, 392.2053353140821, 616.654252104257, 573.1448510447328, 6.521615522702831, 36.086492204342335, 138.883988637274, 88.81069741807875, 245.50824073867318, 98.78170016226031, 134.73585440057954, 90.70294254558527, 245.19055221717392, 453.7834632373103, 190.3268459054881, 214.48265260147076, 224.20135752303858, 204.7118928787679, 464.7635334600677, 283.0822576763877, 119.72545330252413, 368.4043422053282, 54.834673776927346, 75.63935201001615, 98.69349510287616, 199.68600927795794, 354.6294592148086, 373.5012742256885, 171.7409673876681, 263.37026301318065, 64.0918611345694, 285.61540945674346, 101.4526472515527, 47.4951676327252, 88.02754783452541, 229.25882648076004, 105.57811533697291, 318.6509571675148, 17.058032116582964, 21.49863579415026, 170.35843955047645, 114.87593640253394, 126.53231120017107, 9.641175137759006, 222.23256385608147, 178.87356995238676, 98.97328421307316, 292.9843805574998, 57.738914636980034, 482.67179585108994, 38.47644469874925, 46.214948300465906, 237.23858886326653, 208.2885172570897, 31.875782707536654, 38.04222360922769, 94.91420523039947, 85.44175653589255, 126.83574061708406, 31.776849864893528, 80.5266707622475, 303.24769554596384, 36.25178397380943, 113.0643047039457, 23.522740577172957, 155.31473053195975, 256.01637331033004, 228.98738090728895, 114.95397318187742, 84.13882913557767, 67.33417483222006, 22.7205504890286, 377.0655603813087, 336.0911247238571, 173.46192708077263, 15.223175146560902, 43.84457883957227, 118.49972027790574, 39.97979078160108, 24.193793842550434, 390.3777231390042, 231.22307865492377, 13.404875835944974, 88.29137980712268, 113.08212679393552, 151.41043762991623, 459.86829607613373, 390.5055016027575, 267.2353448631166, 217.9945900135487, 281.0641986272251, 256.83065824305385, 103.21520227435201, 41.92573406650002, 49.0814471792103, 112.76760833730543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7891685039565433, "mean_inference_ms": 2.5099306795041767, "mean_action_processing_ms": 0.3687297454632416, "mean_env_wait_ms": 0.2905615735484855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012262105941772461, "StateBufferConnector_ms": 0.0033992528915405273, "ViewRequirementAgentConnector_ms": 0.11061358451843262}, "num_episodes": 18, "episode_return_max": 329.75048828807445, "episode_return_min": -80.68148832435575, "episode_return_mean": 123.48513929448458, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.93380046036847, "num_env_steps_trained_throughput_per_sec": 253.93380046036847, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 15616.572, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15616.506, "sample_time_ms": 1900.545, "learn_time_ms": 13696.376, "learn_throughput": 292.048, "synch_weights_time_ms": 16.109}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "6c58f_00000", "date": "2024-08-16_16-15-53", "timestamp": 1723805153, "time_this_iter_s": 15.800585985183716, "time_total_s": 536.8456680774689, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0503dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 536.8456680774689, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 60.404545454545456, "ram_util_percent": 81.80454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5563972131442771, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 1e-05, "total_loss": 5.800579301642363, "policy_loss": -0.012312053234153797, "vf_loss": 5.809368244050041, "vf_explained_var": -0.0012146726802543357, "kl": 0.01855802025401983, "entropy": 1.5024072166473146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7445450829450415, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.972523811885289, "policy_loss": -0.009447655293144404, "vf_loss": 7.981905524945133, "vf_explained_var": -0.06145948316685106, "kl": 0.010547898342465618, "entropy": 1.467682785268814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 329.75048828807445, "episode_reward_min": -80.68148832435575, "episode_reward_mean": 134.62359991218875, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -717.4411753615132, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.74446977758265, "predator_policy": 791.6265350335564}, "policy_reward_mean": {"prey_policy": -95.57027998874725, "predator_policy": 162.88207994484162}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-25.153921074792322, 228.2176853950242, 257.8161933487562, 29.68482527800571, 51.85194242677576, 106.73304717616182, 150.59000000000026, 161.11043129646166, 79.33189266135304, 201.75321682736276, 83.14658125426247, 121.61000000000034, -35.55562064956222, 103.7500000000005, 179.61854169261846, 277.6068484493842, 248.30649227946967, 88.60843354293702, -51.030899507160576, 123.78268297399998, 225.3993957632598, 79.78824028659486, 174.3518482616721, 118.58279254159406, 125.56406473061476, 147.89867705642877, 190.1322836780557, -1.4420148073690384, 329.75048828807445, 299.09665544331597, -73.42016560605879, -80.68148832435575, 273.85473347231334, 305.66328031287577, 144.24080685718056, 163.88469887282747, 160.10858649685818, 174.4249629207466, 241.8068415763652, 316.91253219867866, 34.58221092375833, 272.5924561049818, 170.2695518612802, 256.89415142481096, 138.07828205642002, 24.395775567687313, 264.27180451461334, 114.53090843471867, 75.05069219148122, 5.920047258895416, 171.7339486057455, 147.36666510248148, 79.48345915007589, 232.27844614431416, 58.50436627611234, 173.82123254704416, -33.640752193478654, 201.31361301204853, 258.98917731366475, 123.3663058342978, 195.7987064136688, 45.50471992678369, 142.99952762020106, 180.35441745372606, 108.50851964992616, 97.34494330135257, 198.52819267848497, 18.81000000000027, 24.98000000000008, 72.81000000000013, 218.10966811885513, 153.45867462400412, 112.61851523270501, 277.36474113328995, 250.48392048215933, 177.45918038768528, 115.56174260395066, 166.5095817205475, 143.73716613580984, 101.64737887845402, 153.22999999999996, 135.36780407217984, 142.1577699488434, 43.447998628945186, 210.00005999194556, 0.04943271709765811, 51.34586713485542, 58.60493640446607, 59.1100000000003, 71.39566172661155, 35.35462367648188, 183.96201023326415, 92.06202457671718, 133.981572160668, 127.8198726366513, 120.90917732741289, 165.12315469011975, 168.6923752912757, 117.95811811804882, 121.70000000000009], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-303.4419695285899, -332.5247526256851, -291.3547045133625, 142.91457651912106, 43.320140254188225, -151.67363365522326, -117.00337698162127, -24.35730302225361, -169.63084527169303, -42.110247083460635, -100.13918541139853, -4.632422174552594, 141.79137425190268, -146.45474133733086, 104.660484270099, -116.88338038664094, -86.73863472385966, -295.3984365373704, -423.2231221751678, -19.27531823898427, -78.3282601680332, -40.290047852707026, -9.533031159000368, 104.70938376525223, -356.6029694008644, -387.4911183951942, 32.138199144387116, -120.34934836274721, -44.85156585921165, 81.44883246971895, 50.54554818171607, -490.25577332662596, 136.60884728536718, 50.60522988727051, -87.3649352380421, -79.55285984695811, -717.4411753615132, -600.8652947156135, -241.92177025428325, -10.80276297911604, -236.5104415577736, -63.225242968303164, -442.9301399994916, -207.52288230105674, -163.15740015096006, -7.072939642918069, -175.64827424931931, -126.98950617250821, -15.600167263101635, -33.401339018163576, -87.57286569962525, -226.9658355713192, -118.53857774499318, -38.02356225874696, -333.8939546409815, -519.3679687404936, 133.0594998508393, 142.0923266224431, 57.000088364812456, 133.67000000000002, -423.0074677786141, -470.45119026660535, -611.3396282528793, -659.1409632204666, 130.57923780664586, 100.66738793862227, 170.74446977758265, -92.77587552005963, 7.091646998262617, -207.14078104201639, -34.26506273722982, -27.28903533610773, -28.805820398488976, -510.0596085591367, -103.5041745488734, -126.88036103733869, -189.31534477850974, 2.20893595306849, -559.1582810535112, 128.22502211573487, -368.6140923145085, -84.93349226958529, 66.27606255143925, 75.84236776659904, 28.10988935059285, -156.21984187014658, -5.427428464531543, -465.80915355115445, -288.29441744104537, -8.738530903383506, -143.4216078279321, -181.8898871956941, -19.70756773468452, 135.03155736502052, -48.76196684251437, -153.99349903805253, -87.23954460883101, -261.93883570417523, -7.903088356640929, -24.733532295196568, -6.520385691972954, -106.98004165529198, 51.653382662413975, -40.46020389786274, -111.41695657761669, -210.20571808077563, -65.29754502081694, -94.38167360544115, -16.73252533370814, -465.17381887824956, 0.09777017373639563, 89.03206937409269, -316.14656576286933, -163.02129255096585, 99.55004258933766, 31.845564105946945, 12.797959385575258, 65.83525616179753, 0.1889446683344289, -35.43522931601425, -102.24740403801573, -85.72825585652605, -73.64707740837429, -30.164291342596584, 34.736812300017384, -70.57475578894821, 31.73379758055457, -336.3831343444471, -108.81553658249187, 18.23125391496295, 19.285632039723275, -11.99541405961966, -48.28998654500359, -466.33850588167695, -167.19834070457705, -2.6767615227572596, -20.314578839572423, -117.049720277905, 8.92837203177543, -0.29195665592695685, 53.085065354877635, -456.57619902995, 53.36387232601466, -1.6014533450771022, -67.64434590861744, -84.22970328252966, -524.1886724938136, -48.820384051787926, -306.9441199047811, 72.19810551027552, -357.9329430206704, -2.502733461922791, -56.950207277843944, 27.37101354094226, 30.275910794399472, -25.615384590367828, -68.21740453027063, -7.169785731652719, 1.2100851353786624, 2.0000000000000013, 111.49160426429447, 15.853899975914663, -56.39972492515058, -395.37082580304894, 96.92652334369394, -22.30705369665963, -153.36835058130984, -9.57828296829682, 17.703710847821, 108.65946761077518, -18.471282351973738, -60.47494279455401, -145.7211061341634, -2.5856886481055588, -12.224707960898268, 43.41828592018504, 33.79372883244619, -44.27203556602165, -260.6084758151657, -88.457886830566, -28.238196804979733, -48.67160593759104, -91.34940869890586, 27.30432117713388, -145.98368496308586, -136.96756017716427, -55.77418013509218, 61.54184896267561, -12.46003274096616, 93.44995984739076, -262.1266518403073, 43.07522467492173, 56.04093009098693, -38.27410866808943, -155.0975508813647, -133.6915918829534, -41.42905600066669, -97.09084778418821, 22.770504158260536, 87.70199335855885], "policy_predator_policy_reward": [248.51594715952615, 362.2968539199548, 132.65327124974883, 244.00454213951681, 214.02596295557706, 152.14372379421445, 106.94555211389026, 64.09995316799082, 181.79185732007363, 81.80117746185543, 207.1173968939167, 4.387257868196112, 7.628625748097424, 147.62474133732997, 50.796223500229566, 122.53710391277494, 189.72525914794505, 271.7437047746372, 306.4738436238089, 337.77781361770633, 87.91237907472306, 113.8525102002799, 11.423031159000328, 15.010616234747776, 304.5121272358147, 404.0263399106813, 71.07468340660267, 120.88646581175814, 97.70143800621065, 45.31983707590089, 395.1595142956587, 322.1575592986353, 47.69866374967619, 13.393751357156422, 44.311425476155165, 211.21480315178303, 791.6265350335564, 475.64903553640846, 144.5080568792976, 231.99915932810092, 226.87336812634268, 298.2617121629941, 308.2197536260812, 422.02150896106093, 119.80858341224878, 224.77360464330096, 166.08087798563005, 255.1396949777905, 69.18650068242717, 105.37907032945253, 218.80163710284606, 243.6357412245276, 47.511134574479726, 299.18328910731606, 354.72961830085166, 497.0902902732542, 12.79907897489609, 41.79958283989617, 26.54337850574361, 81.88318857276, 427.8331571250783, 392.2053353140821, 616.654252104257, 573.1448510447328, 6.521615522702831, 36.086492204342335, 138.883988637274, 88.81069741807875, 245.50824073867318, 98.78170016226031, 134.73585440057954, 90.70294254558527, 245.19055221717392, 453.7834632373103, 190.3268459054881, 214.48265260147076, 224.20135752303858, 204.7118928787679, 464.7635334600677, 283.0822576763877, 119.72545330252413, 368.4043422053282, 54.834673776927346, 75.63935201001615, 98.69349510287616, 199.68600927795794, 354.6294592148086, 373.5012742256885, 171.7409673876681, 263.37026301318065, 64.0918611345694, 285.61540945674346, 101.4526472515527, 47.4951676327252, 88.02754783452541, 229.25882648076004, 105.57811533697291, 318.6509571675148, 17.058032116582964, 21.49863579415026, 170.35843955047645, 114.87593640253394, 126.53231120017107, 9.641175137759006, 222.23256385608147, 178.87356995238676, 98.97328421307316, 292.9843805574998, 57.738914636980034, 482.67179585108994, 38.47644469874925, 46.214948300465906, 237.23858886326653, 208.2885172570897, 31.875782707536654, 38.04222360922769, 94.91420523039947, 85.44175653589255, 126.83574061708406, 31.776849864893528, 80.5266707622475, 303.24769554596384, 36.25178397380943, 113.0643047039457, 23.522740577172957, 155.31473053195975, 256.01637331033004, 228.98738090728895, 114.95397318187742, 84.13882913557767, 67.33417483222006, 22.7205504890286, 377.0655603813087, 336.0911247238571, 173.46192708077263, 15.223175146560902, 43.84457883957227, 118.49972027790574, 39.97979078160108, 24.193793842550434, 390.3777231390042, 231.22307865492377, 13.404875835944974, 88.29137980712268, 113.08212679393552, 151.41043762991623, 459.86829607613373, 390.5055016027575, 267.2353448631166, 217.9945900135487, 281.0641986272251, 256.83065824305385, 103.21520227435201, 41.92573406650002, 49.0814471792103, 112.76760833730543, 76.32640135076687, 142.79795504696668, 74.82208870754536, 23.615205035529996, 21.30857995254186, 4.57591580724899, 253.3471930839027, 333.7911617164764, 2.799061459477527, 64.73923884233106, 102.72621968122581, 103.66841249732592, 37.874475364288834, 45.76240616906099, 16.250340127052297, 62.7453177365731, 181.15610112808494, 18.49656078903916, 27.411358445179413, 0.0, 3.6453916518501064, 65.942915081725, 238.38389623185458, 182.07812814048825, 14.331377893474405, 97.93304852557796, 168.85757024075474, 79.1495275142824, 110.018971929875, 264.99429778709236, 40.1304189903045, 88.08348434278008, 21.976570637680517, 24.853374892545308, 90.76807916483237, 249.19252532796617, 97.64412515088051, 49.712208116341884, 242.1686401102647, 215.3128779453294, 175.5250546560655, 80.95296724683806, 2.7062497591542316, 8.521252724026478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7872899049559198, "mean_inference_ms": 2.5040596423819594, "mean_action_processing_ms": 0.36611590703944585, "mean_env_wait_ms": 0.28980941494852874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044907331466674805, "StateBufferConnector_ms": 0.0071974992752075195, "ViewRequirementAgentConnector_ms": 0.11315560340881348}, "num_episodes": 22, "episode_return_max": 329.75048828807445, "episode_return_min": -80.68148832435575, "episode_return_mean": 134.62359991218875, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.63785984973077, "num_env_steps_trained_throughput_per_sec": 251.63785984973077, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 15684.975, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15684.909, "sample_time_ms": 1909.936, "learn_time_ms": 13752.31, "learn_throughput": 290.86, "synch_weights_time_ms": 18.412}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "6c58f_00000", "date": "2024-08-16_16-16-09", "timestamp": 1723805169, "time_this_iter_s": 15.974949836730957, "time_total_s": 552.8206179141998, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 552.8206179141998, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 60.22173913043478, "ram_util_percent": 81.69565217391305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5620799609277614, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 1e-05, "total_loss": 1.8032658608186813, "policy_loss": -0.004686844244441658, "vf_loss": 1.8067364284285792, "vf_explained_var": 0.004232665628352493, "kl": 0.0064067014541846126, "entropy": 1.5320623772484916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.742283400656685, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 4.82650987723517, "policy_loss": -0.007548492710308108, "vf_loss": 4.834017784633334, "vf_explained_var": 0.24362939078971824, "kl": 0.006493434863447316, "entropy": 1.5013354886145818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 329.75048828807445, "episode_reward_min": -80.68148832435575, "episode_reward_mean": 125.90701430976821, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -659.1409632204666, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 170.74446977758265, "predator_policy": 616.654252104257}, "policy_reward_mean": {"prey_policy": -68.22526916013054, "predator_policy": 131.17877631501466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.58279254159406, 125.56406473061476, 147.89867705642877, 190.1322836780557, -1.4420148073690384, 329.75048828807445, 299.09665544331597, -73.42016560605879, -80.68148832435575, 273.85473347231334, 305.66328031287577, 144.24080685718056, 163.88469887282747, 160.10858649685818, 174.4249629207466, 241.8068415763652, 316.91253219867866, 34.58221092375833, 272.5924561049818, 170.2695518612802, 256.89415142481096, 138.07828205642002, 24.395775567687313, 264.27180451461334, 114.53090843471867, 75.05069219148122, 5.920047258895416, 171.7339486057455, 147.36666510248148, 79.48345915007589, 232.27844614431416, 58.50436627611234, 173.82123254704416, -33.640752193478654, 201.31361301204853, 258.98917731366475, 123.3663058342978, 195.7987064136688, 45.50471992678369, 142.99952762020106, 180.35441745372606, 108.50851964992616, 97.34494330135257, 198.52819267848497, 18.81000000000027, 24.98000000000008, 72.81000000000013, 218.10966811885513, 153.45867462400412, 112.61851523270501, 277.36474113328995, 250.48392048215933, 177.45918038768528, 115.56174260395066, 166.5095817205475, 143.73716613580984, 101.64737887845402, 153.22999999999996, 135.36780407217984, 142.1577699488434, 43.447998628945186, 210.00005999194556, 0.04943271709765811, 51.34586713485542, 58.60493640446607, 59.1100000000003, 71.39566172661155, 35.35462367648188, 183.96201023326415, 92.06202457671718, 133.981572160668, 127.8198726366513, 120.90917732741289, 165.12315469011975, 168.6923752912757, 117.95811811804882, 121.70000000000009, 3.9299999999999597, 94.18354767754211, 3.93999999999996, 69.04000000000103, 108.69000000000057, 53.83999999999967, 150.25257736908554, 177.52489794842768, 168.87163505114262, 64.87368289727478, 72.90000000000093, -18.00336473363732, 255.9843542250921, 3.849999999999962, 90.19004385822927, 107.16963312966112, 9.899999999999924, 270.5195191893113, 28.850000000000012, 21.650000000000425, 68.96983605225475, 8.492934776148358, 174.03999999999945], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-175.64827424931931, -126.98950617250821, -15.600167263101635, -33.401339018163576, -87.57286569962525, -226.9658355713192, -118.53857774499318, -38.02356225874696, -333.8939546409815, -519.3679687404936, 133.0594998508393, 142.0923266224431, 57.000088364812456, 133.67000000000002, -423.0074677786141, -470.45119026660535, -611.3396282528793, -659.1409632204666, 130.57923780664586, 100.66738793862227, 170.74446977758265, -92.77587552005963, 7.091646998262617, -207.14078104201639, -34.26506273722982, -27.28903533610773, -28.805820398488976, -510.0596085591367, -103.5041745488734, -126.88036103733869, -189.31534477850974, 2.20893595306849, -559.1582810535112, 128.22502211573487, -368.6140923145085, -84.93349226958529, 66.27606255143925, 75.84236776659904, 28.10988935059285, -156.21984187014658, -5.427428464531543, -465.80915355115445, -288.29441744104537, -8.738530903383506, -143.4216078279321, -181.8898871956941, -19.70756773468452, 135.03155736502052, -48.76196684251437, -153.99349903805253, -87.23954460883101, -261.93883570417523, -7.903088356640929, -24.733532295196568, -6.520385691972954, -106.98004165529198, 51.653382662413975, -40.46020389786274, -111.41695657761669, -210.20571808077563, -65.29754502081694, -94.38167360544115, -16.73252533370814, -465.17381887824956, 0.09777017373639563, 89.03206937409269, -316.14656576286933, -163.02129255096585, 99.55004258933766, 31.845564105946945, 12.797959385575258, 65.83525616179753, 0.1889446683344289, -35.43522931601425, -102.24740403801573, -85.72825585652605, -73.64707740837429, -30.164291342596584, 34.736812300017384, -70.57475578894821, 31.73379758055457, -336.3831343444471, -108.81553658249187, 18.23125391496295, 19.285632039723275, -11.99541405961966, -48.28998654500359, -466.33850588167695, -167.19834070457705, -2.6767615227572596, -20.314578839572423, -117.049720277905, 8.92837203177543, -0.29195665592695685, 53.085065354877635, -456.57619902995, 53.36387232601466, -1.6014533450771022, -67.64434590861744, -84.22970328252966, -524.1886724938136, -48.820384051787926, -306.9441199047811, 72.19810551027552, -357.9329430206704, -2.502733461922791, -56.950207277843944, 27.37101354094226, 30.275910794399472, -25.615384590367828, -68.21740453027063, -7.169785731652719, 1.2100851353786624, 2.0000000000000013, 111.49160426429447, 15.853899975914663, -56.39972492515058, -395.37082580304894, 96.92652334369394, -22.30705369665963, -153.36835058130984, -9.57828296829682, 17.703710847821, 108.65946761077518, -18.471282351973738, -60.47494279455401, -145.7211061341634, -2.5856886481055588, -12.224707960898268, 43.41828592018504, 33.79372883244619, -44.27203556602165, -260.6084758151657, -88.457886830566, -28.238196804979733, -48.67160593759104, -91.34940869890586, 27.30432117713388, -145.98368496308586, -136.96756017716427, -55.77418013509218, 61.54184896267561, -12.46003274096616, 93.44995984739076, -262.1266518403073, 43.07522467492173, 56.04093009098693, -38.27410866808943, -155.0975508813647, -133.6915918829534, -41.42905600066669, -97.09084778418821, 22.770504158260536, 87.70199335855885, 0.7589178674581877, -9.196279798149542, -0.1072477998653607, 30.926841180468053, -2.049208869999152, -0.16100754142529095, 27.644735690499846, 7.939999999999964, 58.88943134165741, 0.856366474464553, 23.555122808728672, -101.12978161831205, 34.87838608084006, -18.850903892207864, 67.66358317853371, -79.3016855034959, 56.159183588138816, 19.256767042602526, -24.626324342079837, 44.96964594657102, 64.02008112178945, -85.42718263786436, -219.2354177960285, -258.8694789224665, 42.82692590931964, 67.44513600086623, -3.6116820793486877, -14.65137925439391, -112.0980485671479, 70.05004593618345, 10.3790403831022, -0.6590928573613322, 5.423237134637765, -1.0487687823796215, 112.25227309660823, -16.76248325975778, -12.302026082341392, -141.725996549135, -8.85521767288883, 9.208202118585257, -107.06016601073594, -314.96185377325185, -5.828265866731426, -13.058828502806458, 6.361655016847187, 136.94549860702932], "policy_predator_policy_reward": [166.08087798563005, 255.1396949777905, 69.18650068242717, 105.37907032945253, 218.80163710284606, 243.6357412245276, 47.511134574479726, 299.18328910731606, 354.72961830085166, 497.0902902732542, 12.79907897489609, 41.79958283989617, 26.54337850574361, 81.88318857276, 427.8331571250783, 392.2053353140821, 616.654252104257, 573.1448510447328, 6.521615522702831, 36.086492204342335, 138.883988637274, 88.81069741807875, 245.50824073867318, 98.78170016226031, 134.73585440057954, 90.70294254558527, 245.19055221717392, 453.7834632373103, 190.3268459054881, 214.48265260147076, 224.20135752303858, 204.7118928787679, 464.7635334600677, 283.0822576763877, 119.72545330252413, 368.4043422053282, 54.834673776927346, 75.63935201001615, 98.69349510287616, 199.68600927795794, 354.6294592148086, 373.5012742256885, 171.7409673876681, 263.37026301318065, 64.0918611345694, 285.61540945674346, 101.4526472515527, 47.4951676327252, 88.02754783452541, 229.25882648076004, 105.57811533697291, 318.6509571675148, 17.058032116582964, 21.49863579415026, 170.35843955047645, 114.87593640253394, 126.53231120017107, 9.641175137759006, 222.23256385608147, 178.87356995238676, 98.97328421307316, 292.9843805574998, 57.738914636980034, 482.67179585108994, 38.47644469874925, 46.214948300465906, 237.23858886326653, 208.2885172570897, 31.875782707536654, 38.04222360922769, 94.91420523039947, 85.44175653589255, 126.83574061708406, 31.776849864893528, 80.5266707622475, 303.24769554596384, 36.25178397380943, 113.0643047039457, 23.522740577172957, 155.31473053195975, 256.01637331033004, 228.98738090728895, 114.95397318187742, 84.13882913557767, 67.33417483222006, 22.7205504890286, 377.0655603813087, 336.0911247238571, 173.46192708077263, 15.223175146560902, 43.84457883957227, 118.49972027790574, 39.97979078160108, 24.193793842550434, 390.3777231390042, 231.22307865492377, 13.404875835944974, 88.29137980712268, 113.08212679393552, 151.41043762991623, 459.86829607613373, 390.5055016027575, 267.2353448631166, 217.9945900135487, 281.0641986272251, 256.83065824305385, 103.21520227435201, 41.92573406650002, 49.0814471792103, 112.76760833730543, 76.32640135076687, 142.79795504696668, 74.82208870754536, 23.615205035529996, 21.30857995254186, 4.57591580724899, 253.3471930839027, 333.7911617164764, 2.799061459477527, 64.73923884233106, 102.72621968122581, 103.66841249732592, 37.874475364288834, 45.76240616906099, 16.250340127052297, 62.7453177365731, 181.15610112808494, 18.49656078903916, 27.411358445179413, 0.0, 3.6453916518501064, 65.942915081725, 238.38389623185458, 182.07812814048825, 14.331377893474405, 97.93304852557796, 168.85757024075474, 79.1495275142824, 110.018971929875, 264.99429778709236, 40.1304189903045, 88.08348434278008, 21.976570637680517, 24.853374892545308, 90.76807916483237, 249.19252532796617, 97.64412515088051, 49.712208116341884, 242.1686401102647, 215.3128779453294, 175.5250546560655, 80.95296724683806, 2.7062497591542316, 8.521252724026478, 1.2310821325418138, 11.1362797981495, 46.696368869534155, 16.66758542740497, 4.009208869999113, 2.1410075414252905, 33.455264309500315, 0.0, 47.810568658342504, 1.1336335255354484, 22.88935306517609, 108.5253057444082, 38.632979390557104, 95.59211578989752, 112.970862628649, 76.19213764474054, 33.3945770022755, 60.06110741812689, 30.076056572270296, 14.454304720513198, 7.229918878210357, 87.0771826378652, 198.4224547284385, 261.6790772564189, 89.74954803022719, 55.96274428467918, 5.551682079348646, 16.56137925439397, 55.526179810032104, 76.71186667916174, 33.41999878182436, 64.02968682209467, 2.4967628653621943, 3.0287687823796006, 126.16735166613134, 48.86237768632985, 39.8120260823411, 143.06599654913384, 10.76521767288879, 10.531797881414706, 280.77162304633396, 210.22023278990758, 15.710123175958133, 11.669905969728106, 16.308344983152832, 14.424501392970676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7853691948029546, "mean_inference_ms": 2.5066007496109943, "mean_action_processing_ms": 0.3645898315990864, "mean_env_wait_ms": 0.2890723112353163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004491209983825684, "StateBufferConnector_ms": 0.007022380828857422, "ViewRequirementAgentConnector_ms": 0.1081686019897461}, "num_episodes": 23, "episode_return_max": 329.75048828807445, "episode_return_min": -80.68148832435575, "episode_return_mean": 125.90701430976821, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.16259930371757, "num_env_steps_trained_throughput_per_sec": 256.16259930371757, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 15709.231, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15709.165, "sample_time_ms": 1910.234, "learn_time_ms": 13775.731, "learn_throughput": 290.366, "synch_weights_time_ms": 18.978}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "6c58f_00000", "date": "2024-08-16_16-16-25", "timestamp": 1723805185, "time_this_iter_s": 15.679076194763184, "time_total_s": 568.499694108963, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05028b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 568.499694108963, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 62.13636363636363, "ram_util_percent": 81.70454545454547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8066757242988658, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 1e-05, "total_loss": 3.4819461193034256, "policy_loss": -0.005566089986035078, "vf_loss": 3.4856264325046036, "vf_explained_var": 0.002287959579437498, "kl": 0.009933289381349238, "entropy": 1.531504319963001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.229103246630815, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.809539813843984, "policy_loss": -0.0056234539705747495, "vf_loss": 7.815081608232367, "vf_explained_var": 0.14635977029169678, "kl": 0.013068131576896055, "entropy": 1.40474092096248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 294.54382075771514, "episode_reward_min": -33.640752193478654, "episode_reward_mean": 128.17415811447756, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -524.1886724938136, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.19259426734868, "predator_policy": 482.67179585108994}, "policy_reward_mean": {"prey_policy": -34.69095590100946, "predator_policy": 98.77803495824824}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.5924561049818, 170.2695518612802, 256.89415142481096, 138.07828205642002, 24.395775567687313, 264.27180451461334, 114.53090843471867, 75.05069219148122, 5.920047258895416, 171.7339486057455, 147.36666510248148, 79.48345915007589, 232.27844614431416, 58.50436627611234, 173.82123254704416, -33.640752193478654, 201.31361301204853, 258.98917731366475, 123.3663058342978, 195.7987064136688, 45.50471992678369, 142.99952762020106, 180.35441745372606, 108.50851964992616, 97.34494330135257, 198.52819267848497, 18.81000000000027, 24.98000000000008, 72.81000000000013, 218.10966811885513, 153.45867462400412, 112.61851523270501, 277.36474113328995, 250.48392048215933, 177.45918038768528, 115.56174260395066, 166.5095817205475, 143.73716613580984, 101.64737887845402, 153.22999999999996, 135.36780407217984, 142.1577699488434, 43.447998628945186, 210.00005999194556, 0.04943271709765811, 51.34586713485542, 58.60493640446607, 59.1100000000003, 71.39566172661155, 35.35462367648188, 183.96201023326415, 92.06202457671718, 133.981572160668, 127.8198726366513, 120.90917732741289, 165.12315469011975, 168.6923752912757, 117.95811811804882, 121.70000000000009, 3.9299999999999597, 94.18354767754211, 3.93999999999996, 69.04000000000103, 108.69000000000057, 53.83999999999967, 150.25257736908554, 177.52489794842768, 168.87163505114262, 64.87368289727478, 72.90000000000093, -18.00336473363732, 255.9843542250921, 3.849999999999962, 90.19004385822927, 107.16963312966112, 9.899999999999924, 270.5195191893113, 28.850000000000012, 21.650000000000425, 68.96983605225475, 8.492934776148358, 174.03999999999945, 173.42999999999978, 294.54382075771514, 280.95999999999987, 184.88000000000008, 235.44999999999965, 182.65093692652474, 3.819999999999963, 289.6559100504112, 95.90000000000002, 122.19000000000062, 112.24004805230057, 270.086459666078, 23.60576192736864, 146.06, 3.3499999999999717, 289.18517709283884, 163.93440242622603, 225.7318102033733], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [66.27606255143925, 75.84236776659904, 28.10988935059285, -156.21984187014658, -5.427428464531543, -465.80915355115445, -288.29441744104537, -8.738530903383506, -143.4216078279321, -181.8898871956941, -19.70756773468452, 135.03155736502052, -48.76196684251437, -153.99349903805253, -87.23954460883101, -261.93883570417523, -7.903088356640929, -24.733532295196568, -6.520385691972954, -106.98004165529198, 51.653382662413975, -40.46020389786274, -111.41695657761669, -210.20571808077563, -65.29754502081694, -94.38167360544115, -16.73252533370814, -465.17381887824956, 0.09777017373639563, 89.03206937409269, -316.14656576286933, -163.02129255096585, 99.55004258933766, 31.845564105946945, 12.797959385575258, 65.83525616179753, 0.1889446683344289, -35.43522931601425, -102.24740403801573, -85.72825585652605, -73.64707740837429, -30.164291342596584, 34.736812300017384, -70.57475578894821, 31.73379758055457, -336.3831343444471, -108.81553658249187, 18.23125391496295, 19.285632039723275, -11.99541405961966, -48.28998654500359, -466.33850588167695, -167.19834070457705, -2.6767615227572596, -20.314578839572423, -117.049720277905, 8.92837203177543, -0.29195665592695685, 53.085065354877635, -456.57619902995, 53.36387232601466, -1.6014533450771022, -67.64434590861744, -84.22970328252966, -524.1886724938136, -48.820384051787926, -306.9441199047811, 72.19810551027552, -357.9329430206704, -2.502733461922791, -56.950207277843944, 27.37101354094226, 30.275910794399472, -25.615384590367828, -68.21740453027063, -7.169785731652719, 1.2100851353786624, 2.0000000000000013, 111.49160426429447, 15.853899975914663, -56.39972492515058, -395.37082580304894, 96.92652334369394, -22.30705369665963, -153.36835058130984, -9.57828296829682, 17.703710847821, 108.65946761077518, -18.471282351973738, -60.47494279455401, -145.7211061341634, -2.5856886481055588, -12.224707960898268, 43.41828592018504, 33.79372883244619, -44.27203556602165, -260.6084758151657, -88.457886830566, -28.238196804979733, -48.67160593759104, -91.34940869890586, 27.30432117713388, -145.98368496308586, -136.96756017716427, -55.77418013509218, 61.54184896267561, -12.46003274096616, 93.44995984739076, -262.1266518403073, 43.07522467492173, 56.04093009098693, -38.27410866808943, -155.0975508813647, -133.6915918829534, -41.42905600066669, -97.09084778418821, 22.770504158260536, 87.70199335855885, 0.7589178674581877, -9.196279798149542, -0.1072477998653607, 30.926841180468053, -2.049208869999152, -0.16100754142529095, 27.644735690499846, 7.939999999999964, 58.88943134165741, 0.856366474464553, 23.555122808728672, -101.12978161831205, 34.87838608084006, -18.850903892207864, 67.66358317853371, -79.3016855034959, 56.159183588138816, 19.256767042602526, -24.626324342079837, 44.96964594657102, 64.02008112178945, -85.42718263786436, -219.2354177960285, -258.8694789224665, 42.82692590931964, 67.44513600086623, -3.6116820793486877, -14.65137925439391, -112.0980485671479, 70.05004593618345, 10.3790403831022, -0.6590928573613322, 5.423237134637765, -1.0487687823796215, 112.25227309660823, -16.76248325975778, -12.302026082341392, -141.725996549135, -8.85521767288883, 9.208202118585257, -107.06016601073594, -314.96185377325185, -5.828265866731426, -13.058828502806458, 6.361655016847187, 136.94549860702932, -40.29205320305355, 113.2716922657795, 148.95411988700084, 121.38232531534138, 133.67, 120.4738505583852, 134.30783986234798, 20.93713592102386, 78.25152277624682, 134.88917053366842, 129.04166460512, -25.78057669859539, -7.9794441076194325, -9.680076322745402, 107.24458629417731, 136.11154049607907, 64.36090087878365, 8.749980217831407, 34.27543303087467, -43.83997117027652, 11.142158412149431, -96.10408019385288, 73.23814592404003, 111.84233096808117, 2.0000000000000013, -41.663240854049455, 106.71626116964313, -20.918456976806755, -57.37420937692671, -27.748537632773456, 110.86381371708632, 16.344751224087616, -104.91490579290766, 150.19259426734868, -199.47747026337854, 147.02924104693346], "policy_predator_policy_reward": [54.834673776927346, 75.63935201001615, 98.69349510287616, 199.68600927795794, 354.6294592148086, 373.5012742256885, 171.7409673876681, 263.37026301318065, 64.0918611345694, 285.61540945674346, 101.4526472515527, 47.4951676327252, 88.02754783452541, 229.25882648076004, 105.57811533697291, 318.6509571675148, 17.058032116582964, 21.49863579415026, 170.35843955047645, 114.87593640253394, 126.53231120017107, 9.641175137759006, 222.23256385608147, 178.87356995238676, 98.97328421307316, 292.9843805574998, 57.738914636980034, 482.67179585108994, 38.47644469874925, 46.214948300465906, 237.23858886326653, 208.2885172570897, 31.875782707536654, 38.04222360922769, 94.91420523039947, 85.44175653589255, 126.83574061708406, 31.776849864893528, 80.5266707622475, 303.24769554596384, 36.25178397380943, 113.0643047039457, 23.522740577172957, 155.31473053195975, 256.01637331033004, 228.98738090728895, 114.95397318187742, 84.13882913557767, 67.33417483222006, 22.7205504890286, 377.0655603813087, 336.0911247238571, 173.46192708077263, 15.223175146560902, 43.84457883957227, 118.49972027790574, 39.97979078160108, 24.193793842550434, 390.3777231390042, 231.22307865492377, 13.404875835944974, 88.29137980712268, 113.08212679393552, 151.41043762991623, 459.86829607613373, 390.5055016027575, 267.2353448631166, 217.9945900135487, 281.0641986272251, 256.83065824305385, 103.21520227435201, 41.92573406650002, 49.0814471792103, 112.76760833730543, 76.32640135076687, 142.79795504696668, 74.82208870754536, 23.615205035529996, 21.30857995254186, 4.57591580724899, 253.3471930839027, 333.7911617164764, 2.799061459477527, 64.73923884233106, 102.72621968122581, 103.66841249732592, 37.874475364288834, 45.76240616906099, 16.250340127052297, 62.7453177365731, 181.15610112808494, 18.49656078903916, 27.411358445179413, 0.0, 3.6453916518501064, 65.942915081725, 238.38389623185458, 182.07812814048825, 14.331377893474405, 97.93304852557796, 168.85757024075474, 79.1495275142824, 110.018971929875, 264.99429778709236, 40.1304189903045, 88.08348434278008, 21.976570637680517, 24.853374892545308, 90.76807916483237, 249.19252532796617, 97.64412515088051, 49.712208116341884, 242.1686401102647, 215.3128779453294, 175.5250546560655, 80.95296724683806, 2.7062497591542316, 8.521252724026478, 1.2310821325418138, 11.1362797981495, 46.696368869534155, 16.66758542740497, 4.009208869999113, 2.1410075414252905, 33.455264309500315, 0.0, 47.810568658342504, 1.1336335255354484, 22.88935306517609, 108.5253057444082, 38.632979390557104, 95.59211578989752, 112.970862628649, 76.19213764474054, 33.3945770022755, 60.06110741812689, 30.076056572270296, 14.454304720513198, 7.229918878210357, 87.0771826378652, 198.4224547284385, 261.6790772564189, 89.74954803022719, 55.96274428467918, 5.551682079348646, 16.56137925439397, 55.526179810032104, 76.71186667916174, 33.41999878182436, 64.02968682209467, 2.4967628653621943, 3.0287687823796006, 126.16735166613134, 48.86237768632985, 39.8120260823411, 143.06599654913384, 10.76521767288879, 10.531797881414706, 280.77162304633396, 210.22023278990758, 15.710123175958133, 11.669905969728106, 16.308344983152832, 14.424501392970676, 21.487307591000285, 78.96305334627368, 9.001410525708371, 15.205965029664803, 15.150170479755591, 11.66597896185926, 6.726860333940632, 22.908163882687738, 10.37221586364088, 11.937090826443974, 10.859354254891699, 68.5304947651085, 9.889444107619392, 11.590076322745361, 29.307006568756123, 16.992776691398994, 1.3175722851491467, 21.471546618235774, 18.417379078941575, 113.33715906045984, 38.31632091411413, 158.8856489198901, 66.49045693446679, 18.515525839490483, 31.066520119489326, 32.202482661927924, 2.771279350814059, 57.490916456349474, 51.79905107642427, 36.673695933275866, 69.0274987338507, 92.94911341781513, 107.13313128684845, 11.523582664937276, 122.57531416315727, 155.6047252566611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7840306535690192, "mean_inference_ms": 2.504768599967633, "mean_action_processing_ms": 0.36292649722813075, "mean_env_wait_ms": 0.2883065376545239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004642486572265625, "StateBufferConnector_ms": 0.007086634635925293, "ViewRequirementAgentConnector_ms": 0.11418843269348145}, "num_episodes": 18, "episode_return_max": 294.54382075771514, "episode_return_min": -33.640752193478654, "episode_return_mean": 128.17415811447756, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 250.0624179178855, "num_env_steps_trained_throughput_per_sec": 250.0624179178855, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 15760.478, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15760.412, "sample_time_ms": 1899.406, "learn_time_ms": 13835.866, "learn_throughput": 289.104, "synch_weights_time_ms": 21.182}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "6c58f_00000", "date": "2024-08-16_16-16-41", "timestamp": 1723805201, "time_this_iter_s": 16.07962703704834, "time_total_s": 584.5793211460114, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0502f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.5793211460114, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 63.7695652173913, "ram_util_percent": 81.86086956521737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.350301643985289, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 1e-05, "total_loss": 3.678501212659967, "policy_loss": -0.010534645722829122, "vf_loss": 3.6868279710648553, "vf_explained_var": 0.003171602758780989, "kl": 0.01162997868494909, "entropy": 1.5435878886116876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4915077314490364, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.772333484225803, "policy_loss": -0.005673776265657532, "vf_loss": 7.777950369617926, "vf_explained_var": 0.13328355803060785, "kl": 0.00910144272958864, "entropy": 1.4010191397061424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 294.54382075771514, "episode_reward_min": -18.00336473363732, "episode_reward_mean": 134.6421740707547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -524.1886724938136, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.19259426734868, "predator_policy": 459.86829607613373}, "policy_reward_mean": {"prey_policy": -18.586529510069045, "predator_policy": 85.90761654544642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.3663058342978, 195.7987064136688, 45.50471992678369, 142.99952762020106, 180.35441745372606, 108.50851964992616, 97.34494330135257, 198.52819267848497, 18.81000000000027, 24.98000000000008, 72.81000000000013, 218.10966811885513, 153.45867462400412, 112.61851523270501, 277.36474113328995, 250.48392048215933, 177.45918038768528, 115.56174260395066, 166.5095817205475, 143.73716613580984, 101.64737887845402, 153.22999999999996, 135.36780407217984, 142.1577699488434, 43.447998628945186, 210.00005999194556, 0.04943271709765811, 51.34586713485542, 58.60493640446607, 59.1100000000003, 71.39566172661155, 35.35462367648188, 183.96201023326415, 92.06202457671718, 133.981572160668, 127.8198726366513, 120.90917732741289, 165.12315469011975, 168.6923752912757, 117.95811811804882, 121.70000000000009, 3.9299999999999597, 94.18354767754211, 3.93999999999996, 69.04000000000103, 108.69000000000057, 53.83999999999967, 150.25257736908554, 177.52489794842768, 168.87163505114262, 64.87368289727478, 72.90000000000093, -18.00336473363732, 255.9843542250921, 3.849999999999962, 90.19004385822927, 107.16963312966112, 9.899999999999924, 270.5195191893113, 28.850000000000012, 21.650000000000425, 68.96983605225475, 8.492934776148358, 174.03999999999945, 173.42999999999978, 294.54382075771514, 280.95999999999987, 184.88000000000008, 235.44999999999965, 182.65093692652474, 3.819999999999963, 289.6559100504112, 95.90000000000002, 122.19000000000062, 112.24004805230057, 270.086459666078, 23.60576192736864, 146.06, 3.3499999999999717, 289.18517709283884, 163.93440242622603, 225.7318102033733, 277.8301848237585, 117.34000000000026, 183.7238165333619, 236.63569460852912, 265.02999999999946, 105.48429885208982, 235.8915464219528, 250.007812601154, 255.65493412275652, 94.60255120788901, 215.62246475543486, 17.75999999999997, 251.4733283365939, 182.75999999999982, 88.95000000000005, 219.43999999999915, 96.0200000000003, 164.42878873709338], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.1889446683344289, -35.43522931601425, -102.24740403801573, -85.72825585652605, -73.64707740837429, -30.164291342596584, 34.736812300017384, -70.57475578894821, 31.73379758055457, -336.3831343444471, -108.81553658249187, 18.23125391496295, 19.285632039723275, -11.99541405961966, -48.28998654500359, -466.33850588167695, -167.19834070457705, -2.6767615227572596, -20.314578839572423, -117.049720277905, 8.92837203177543, -0.29195665592695685, 53.085065354877635, -456.57619902995, 53.36387232601466, -1.6014533450771022, -67.64434590861744, -84.22970328252966, -524.1886724938136, -48.820384051787926, -306.9441199047811, 72.19810551027552, -357.9329430206704, -2.502733461922791, -56.950207277843944, 27.37101354094226, 30.275910794399472, -25.615384590367828, -68.21740453027063, -7.169785731652719, 1.2100851353786624, 2.0000000000000013, 111.49160426429447, 15.853899975914663, -56.39972492515058, -395.37082580304894, 96.92652334369394, -22.30705369665963, -153.36835058130984, -9.57828296829682, 17.703710847821, 108.65946761077518, -18.471282351973738, -60.47494279455401, -145.7211061341634, -2.5856886481055588, -12.224707960898268, 43.41828592018504, 33.79372883244619, -44.27203556602165, -260.6084758151657, -88.457886830566, -28.238196804979733, -48.67160593759104, -91.34940869890586, 27.30432117713388, -145.98368496308586, -136.96756017716427, -55.77418013509218, 61.54184896267561, -12.46003274096616, 93.44995984739076, -262.1266518403073, 43.07522467492173, 56.04093009098693, -38.27410866808943, -155.0975508813647, -133.6915918829534, -41.42905600066669, -97.09084778418821, 22.770504158260536, 87.70199335855885, 0.7589178674581877, -9.196279798149542, -0.1072477998653607, 30.926841180468053, -2.049208869999152, -0.16100754142529095, 27.644735690499846, 7.939999999999964, 58.88943134165741, 0.856366474464553, 23.555122808728672, -101.12978161831205, 34.87838608084006, -18.850903892207864, 67.66358317853371, -79.3016855034959, 56.159183588138816, 19.256767042602526, -24.626324342079837, 44.96964594657102, 64.02008112178945, -85.42718263786436, -219.2354177960285, -258.8694789224665, 42.82692590931964, 67.44513600086623, -3.6116820793486877, -14.65137925439391, -112.0980485671479, 70.05004593618345, 10.3790403831022, -0.6590928573613322, 5.423237134637765, -1.0487687823796215, 112.25227309660823, -16.76248325975778, -12.302026082341392, -141.725996549135, -8.85521767288883, 9.208202118585257, -107.06016601073594, -314.96185377325185, -5.828265866731426, -13.058828502806458, 6.361655016847187, 136.94549860702932, -40.29205320305355, 113.2716922657795, 148.95411988700084, 121.38232531534138, 133.67, 120.4738505583852, 134.30783986234798, 20.93713592102386, 78.25152277624682, 134.88917053366842, 129.04166460512, -25.78057669859539, -7.9794441076194325, -9.680076322745402, 107.24458629417731, 136.11154049607907, 64.36090087878365, 8.749980217831407, 34.27543303087467, -43.83997117027652, 11.142158412149431, -96.10408019385288, 73.23814592404003, 111.84233096808117, 2.0000000000000013, -41.663240854049455, 106.71626116964313, -20.918456976806755, -57.37420937692671, -27.748537632773456, 110.86381371708632, 16.344751224087616, -104.91490579290766, 150.19259426734868, -199.47747026337854, 147.02924104693346, 95.34347494781639, 60.8518159172238, -162.97184725495245, -72.17835112528078, 115.65276739919577, -209.6778497991578, 18.065708876968806, -28.114982688345787, 100.62429594249765, 121.41829821553132, 2.0000000000000013, -174.93295718631, 72.34027031114796, 48.95328069839274, 61.24297804594435, 66.61693324726517, 46.98194778603387, 66.37932499245892, -1.5198434778790773, -14.119184561876473, 87.17709147429947, -204.79881425460502, 10.696213216439476, -3.780065738640933, 115.60308333314816, 62.017488634098896, 76.03979230553745, -13.188769420914056, -99.23269425287538, -8.989074199072212, 99.10505703966687, 82.63993839704531, 88.64804276774373, 0.8885676498361775, -138.06106366971903, 58.82069721641855], "policy_predator_policy_reward": [126.83574061708406, 31.776849864893528, 80.5266707622475, 303.24769554596384, 36.25178397380943, 113.0643047039457, 23.522740577172957, 155.31473053195975, 256.01637331033004, 228.98738090728895, 114.95397318187742, 84.13882913557767, 67.33417483222006, 22.7205504890286, 377.0655603813087, 336.0911247238571, 173.46192708077263, 15.223175146560902, 43.84457883957227, 118.49972027790574, 39.97979078160108, 24.193793842550434, 390.3777231390042, 231.22307865492377, 13.404875835944974, 88.29137980712268, 113.08212679393552, 151.41043762991623, 459.86829607613373, 390.5055016027575, 267.2353448631166, 217.9945900135487, 281.0641986272251, 256.83065824305385, 103.21520227435201, 41.92573406650002, 49.0814471792103, 112.76760833730543, 76.32640135076687, 142.79795504696668, 74.82208870754536, 23.615205035529996, 21.30857995254186, 4.57591580724899, 253.3471930839027, 333.7911617164764, 2.799061459477527, 64.73923884233106, 102.72621968122581, 103.66841249732592, 37.874475364288834, 45.76240616906099, 16.250340127052297, 62.7453177365731, 181.15610112808494, 18.49656078903916, 27.411358445179413, 0.0, 3.6453916518501064, 65.942915081725, 238.38389623185458, 182.07812814048825, 14.331377893474405, 97.93304852557796, 168.85757024075474, 79.1495275142824, 110.018971929875, 264.99429778709236, 40.1304189903045, 88.08348434278008, 21.976570637680517, 24.853374892545308, 90.76807916483237, 249.19252532796617, 97.64412515088051, 49.712208116341884, 242.1686401102647, 215.3128779453294, 175.5250546560655, 80.95296724683806, 2.7062497591542316, 8.521252724026478, 1.2310821325418138, 11.1362797981495, 46.696368869534155, 16.66758542740497, 4.009208869999113, 2.1410075414252905, 33.455264309500315, 0.0, 47.810568658342504, 1.1336335255354484, 22.88935306517609, 108.5253057444082, 38.632979390557104, 95.59211578989752, 112.970862628649, 76.19213764474054, 33.3945770022755, 60.06110741812689, 30.076056572270296, 14.454304720513198, 7.229918878210357, 87.0771826378652, 198.4224547284385, 261.6790772564189, 89.74954803022719, 55.96274428467918, 5.551682079348646, 16.56137925439397, 55.526179810032104, 76.71186667916174, 33.41999878182436, 64.02968682209467, 2.4967628653621943, 3.0287687823796006, 126.16735166613134, 48.86237768632985, 39.8120260823411, 143.06599654913384, 10.76521767288879, 10.531797881414706, 280.77162304633396, 210.22023278990758, 15.710123175958133, 11.669905969728106, 16.308344983152832, 14.424501392970676, 21.487307591000285, 78.96305334627368, 9.001410525708371, 15.205965029664803, 15.150170479755591, 11.66597896185926, 6.726860333940632, 22.908163882687738, 10.37221586364088, 11.937090826443974, 10.859354254891699, 68.5304947651085, 9.889444107619392, 11.590076322745361, 29.307006568756123, 16.992776691398994, 1.3175722851491467, 21.471546618235774, 18.417379078941575, 113.33715906045984, 38.31632091411413, 158.8856489198901, 66.49045693446679, 18.515525839490483, 31.066520119489326, 32.202482661927924, 2.771279350814059, 57.490916456349474, 51.79905107642427, 36.673695933275866, 69.0274987338507, 92.94911341781513, 107.13313128684845, 11.523582664937276, 122.57531416315727, 155.6047252566611, 48.23797562143349, 73.39691833728527, 157.26853248180237, 195.22166589843062, 33.59602727746373, 244.15287165586068, 100.54628308992055, 146.1386853299857, 7.5487728385770465, 35.438633003394195, 101.89421532144482, 176.5230407169543, 24.891278999853682, 89.70671641255846, 40.97646961524506, 81.17143169269954, 66.86994929707308, 75.42371204719075, 30.5794629448575, 79.66211630278661, 141.76029759383988, 191.48388994190043, 5.123786783560486, 5.7200657386408915, 35.512599391620064, 38.34015697772742, 38.71020769446267, 81.19876942091437, 182.99375433794438, 14.178014114003274, 1.874942960333613, 35.820061602954674, 5.381957232256237, 1.101432350163824, 207.4105866484696, 36.25856854192425]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7839101873569467, "mean_inference_ms": 2.508124949982399, "mean_action_processing_ms": 0.36192177701583544, "mean_env_wait_ms": 0.28808345621951464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004318833351135254, "StateBufferConnector_ms": 0.007057666778564453, "ViewRequirementAgentConnector_ms": 0.11583733558654785}, "num_episodes": 18, "episode_return_max": 294.54382075771514, "episode_return_min": -18.00336473363732, "episode_return_mean": 134.6421740707547, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.6050098874445, "num_env_steps_trained_throughput_per_sec": 246.6050098874445, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 15842.478, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15842.412, "sample_time_ms": 1966.583, "learn_time_ms": 13851.75, "learn_throughput": 288.772, "synch_weights_time_ms": 20.751}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "6c58f_00000", "date": "2024-08-16_16-16-57", "timestamp": 1723805217, "time_this_iter_s": 16.273542165756226, "time_total_s": 600.8528633117676, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3356550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 600.8528633117676, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 63.50869565217393, "ram_util_percent": 81.72173913043477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4938905931339062, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 1e-05, "total_loss": 4.202324645859854, "policy_loss": -0.012050996042748608, "vf_loss": 4.210452758950531, "vf_explained_var": 0.0037994918999848543, "kl": 0.020663845911448764, "entropy": 1.5513645799702438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.813623084876903, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.489937781530713, "policy_loss": -0.0060811232736028694, "vf_loss": 7.495920816804997, "vf_explained_var": 0.07048061023313533, "kl": 0.01569213842970519, "entropy": 1.394349710398881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 294.54382075771514, "episode_reward_min": -18.00336473363732, "episode_reward_mean": 134.4003984715734, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -395.37082580304894, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55123772239781, "predator_policy": 333.7911617164764}, "policy_reward_mean": {"prey_policy": -0.6632417968751702, "predator_policy": 67.8634410326619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.36780407217984, 142.1577699488434, 43.447998628945186, 210.00005999194556, 0.04943271709765811, 51.34586713485542, 58.60493640446607, 59.1100000000003, 71.39566172661155, 35.35462367648188, 183.96201023326415, 92.06202457671718, 133.981572160668, 127.8198726366513, 120.90917732741289, 165.12315469011975, 168.6923752912757, 117.95811811804882, 121.70000000000009, 3.9299999999999597, 94.18354767754211, 3.93999999999996, 69.04000000000103, 108.69000000000057, 53.83999999999967, 150.25257736908554, 177.52489794842768, 168.87163505114262, 64.87368289727478, 72.90000000000093, -18.00336473363732, 255.9843542250921, 3.849999999999962, 90.19004385822927, 107.16963312966112, 9.899999999999924, 270.5195191893113, 28.850000000000012, 21.650000000000425, 68.96983605225475, 8.492934776148358, 174.03999999999945, 173.42999999999978, 294.54382075771514, 280.95999999999987, 184.88000000000008, 235.44999999999965, 182.65093692652474, 3.819999999999963, 289.6559100504112, 95.90000000000002, 122.19000000000062, 112.24004805230057, 270.086459666078, 23.60576192736864, 146.06, 3.3499999999999717, 289.18517709283884, 163.93440242622603, 225.7318102033733, 277.8301848237585, 117.34000000000026, 183.7238165333619, 236.63569460852912, 265.02999999999946, 105.48429885208982, 235.8915464219528, 250.007812601154, 255.65493412275652, 94.60255120788901, 215.62246475543486, 17.75999999999997, 251.4733283365939, 182.75999999999982, 88.95000000000005, 219.43999999999915, 96.0200000000003, 164.42878873709338, 239.14999999999898, 117.12412877162538, 116.48825168823274, 264.16999999999985, 149.42135843153216, 75.34981777927855, 163.69724753870491, 137.93372060141428, 221.0050930690363, 242.83522865648843, 148.4207593608671, 273.1225998792024, 32.36000000000018, 227.1987205526121, 126.2200000000007, 24.520000000000458, 171.23306842776236, 8.09868759948514, 38.61612620776716, 130.67302351403143, 135.9482082153883, 11.422301984343585], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-56.39972492515058, -395.37082580304894, 96.92652334369394, -22.30705369665963, -153.36835058130984, -9.57828296829682, 17.703710847821, 108.65946761077518, -18.471282351973738, -60.47494279455401, -145.7211061341634, -2.5856886481055588, -12.224707960898268, 43.41828592018504, 33.79372883244619, -44.27203556602165, -260.6084758151657, -88.457886830566, -28.238196804979733, -48.67160593759104, -91.34940869890586, 27.30432117713388, -145.98368496308586, -136.96756017716427, -55.77418013509218, 61.54184896267561, -12.46003274096616, 93.44995984739076, -262.1266518403073, 43.07522467492173, 56.04093009098693, -38.27410866808943, -155.0975508813647, -133.6915918829534, -41.42905600066669, -97.09084778418821, 22.770504158260536, 87.70199335855885, 0.7589178674581877, -9.196279798149542, -0.1072477998653607, 30.926841180468053, -2.049208869999152, -0.16100754142529095, 27.644735690499846, 7.939999999999964, 58.88943134165741, 0.856366474464553, 23.555122808728672, -101.12978161831205, 34.87838608084006, -18.850903892207864, 67.66358317853371, -79.3016855034959, 56.159183588138816, 19.256767042602526, -24.626324342079837, 44.96964594657102, 64.02008112178945, -85.42718263786436, -219.2354177960285, -258.8694789224665, 42.82692590931964, 67.44513600086623, -3.6116820793486877, -14.65137925439391, -112.0980485671479, 70.05004593618345, 10.3790403831022, -0.6590928573613322, 5.423237134637765, -1.0487687823796215, 112.25227309660823, -16.76248325975778, -12.302026082341392, -141.725996549135, -8.85521767288883, 9.208202118585257, -107.06016601073594, -314.96185377325185, -5.828265866731426, -13.058828502806458, 6.361655016847187, 136.94549860702932, -40.29205320305355, 113.2716922657795, 148.95411988700084, 121.38232531534138, 133.67, 120.4738505583852, 134.30783986234798, 20.93713592102386, 78.25152277624682, 134.88917053366842, 129.04166460512, -25.78057669859539, -7.9794441076194325, -9.680076322745402, 107.24458629417731, 136.11154049607907, 64.36090087878365, 8.749980217831407, 34.27543303087467, -43.83997117027652, 11.142158412149431, -96.10408019385288, 73.23814592404003, 111.84233096808117, 2.0000000000000013, -41.663240854049455, 106.71626116964313, -20.918456976806755, -57.37420937692671, -27.748537632773456, 110.86381371708632, 16.344751224087616, -104.91490579290766, 150.19259426734868, -199.47747026337854, 147.02924104693346, 95.34347494781639, 60.8518159172238, -162.97184725495245, -72.17835112528078, 115.65276739919577, -209.6778497991578, 18.065708876968806, -28.114982688345787, 100.62429594249765, 121.41829821553132, 2.0000000000000013, -174.93295718631, 72.34027031114796, 48.95328069839274, 61.24297804594435, 66.61693324726517, 46.98194778603387, 66.37932499245892, -1.5198434778790773, -14.119184561876473, 87.17709147429947, -204.79881425460502, 10.696213216439476, -3.780065738640933, 115.60308333314816, 62.017488634098896, 76.03979230553745, -13.188769420914056, -99.23269425287538, -8.989074199072212, 99.10505703966687, 82.63993839704531, 88.64804276774373, 0.8885676498361775, -138.06106366971903, 58.82069721641855, 101.17955928631365, 73.37716935187879, -6.495950358060798, -119.06691920376747, -62.96170908673474, 1.5190072865135857, 155.55123772239781, 83.50499843539195, -64.55419223966743, 2.250054556370686, 21.49384917189055, -65.07934646677528, 25.7859812365641, 65.87897515411595, -44.084201427847745, 2.495547863884914, 45.62072572513347, 92.60256659555773, -24.680101889020648, 141.64319210325297, -5.045829978076332, 27.507296677401428, 143.82292030639258, 92.9063599730699, -13.340072924420022, -5.391282596272562, 56.06631004704349, 43.35686745369944, -23.857668266737523, 76.01979079361816, -7.743001750709318, -28.25541414628033, -81.87341904367332, 75.88984412261966, -12.306721655968198, -5.287181901668642, 29.271241465691855, -22.158233389392226, 34.758386926613895, -178.50436635396352, 17.528315579565113, -22.149072098202268, -124.3458985890451, -113.78198818619575], "policy_predator_policy_reward": [253.3471930839027, 333.7911617164764, 2.799061459477527, 64.73923884233106, 102.72621968122581, 103.66841249732592, 37.874475364288834, 45.76240616906099, 16.250340127052297, 62.7453177365731, 181.15610112808494, 18.49656078903916, 27.411358445179413, 0.0, 3.6453916518501064, 65.942915081725, 238.38389623185458, 182.07812814048825, 14.331377893474405, 97.93304852557796, 168.85757024075474, 79.1495275142824, 110.018971929875, 264.99429778709236, 40.1304189903045, 88.08348434278008, 21.976570637680517, 24.853374892545308, 90.76807916483237, 249.19252532796617, 97.64412515088051, 49.712208116341884, 242.1686401102647, 215.3128779453294, 175.5250546560655, 80.95296724683806, 2.7062497591542316, 8.521252724026478, 1.2310821325418138, 11.1362797981495, 46.696368869534155, 16.66758542740497, 4.009208869999113, 2.1410075414252905, 33.455264309500315, 0.0, 47.810568658342504, 1.1336335255354484, 22.88935306517609, 108.5253057444082, 38.632979390557104, 95.59211578989752, 112.970862628649, 76.19213764474054, 33.3945770022755, 60.06110741812689, 30.076056572270296, 14.454304720513198, 7.229918878210357, 87.0771826378652, 198.4224547284385, 261.6790772564189, 89.74954803022719, 55.96274428467918, 5.551682079348646, 16.56137925439397, 55.526179810032104, 76.71186667916174, 33.41999878182436, 64.02968682209467, 2.4967628653621943, 3.0287687823796006, 126.16735166613134, 48.86237768632985, 39.8120260823411, 143.06599654913384, 10.76521767288879, 10.531797881414706, 280.77162304633396, 210.22023278990758, 15.710123175958133, 11.669905969728106, 16.308344983152832, 14.424501392970676, 21.487307591000285, 78.96305334627368, 9.001410525708371, 15.205965029664803, 15.150170479755591, 11.66597896185926, 6.726860333940632, 22.908163882687738, 10.37221586364088, 11.937090826443974, 10.859354254891699, 68.5304947651085, 9.889444107619392, 11.590076322745361, 29.307006568756123, 16.992776691398994, 1.3175722851491467, 21.471546618235774, 18.417379078941575, 113.33715906045984, 38.31632091411413, 158.8856489198901, 66.49045693446679, 18.515525839490483, 31.066520119489326, 32.202482661927924, 2.771279350814059, 57.490916456349474, 51.79905107642427, 36.673695933275866, 69.0274987338507, 92.94911341781513, 107.13313128684845, 11.523582664937276, 122.57531416315727, 155.6047252566611, 48.23797562143349, 73.39691833728527, 157.26853248180237, 195.22166589843062, 33.59602727746373, 244.15287165586068, 100.54628308992055, 146.1386853299857, 7.5487728385770465, 35.438633003394195, 101.89421532144482, 176.5230407169543, 24.891278999853682, 89.70671641255846, 40.97646961524506, 81.17143169269954, 66.86994929707308, 75.42371204719075, 30.5794629448575, 79.66211630278661, 141.76029759383988, 191.48388994190043, 5.123786783560486, 5.7200657386408915, 35.512599391620064, 38.34015697772742, 38.71020769446267, 81.19876942091437, 182.99375433794438, 14.178014114003274, 1.874942960333613, 35.820061602954674, 5.381957232256237, 1.101432350163824, 207.4105866484696, 36.25856854192425, 36.160440713686455, 28.43283064812155, 75.94643535146905, 166.74056298198445, 121.50341013946931, 56.427543348984415, 7.794239860069683, 17.319523982140797, 141.2479708690914, 70.47752524573833, 72.18413883432716, 46.751176239836056, 15.481187162891132, 56.55110398513387, 159.04353246173895, 20.478841703638313, 62.384355320529984, 20.397445427815597, 79.00762556176859, 46.864512880488206, 20.611299902145657, 105.34799275939652, 33.472257466630715, 2.921062133109923, 41.46766459008173, 9.623690930610767, 115.61725981929723, 12.158283232572524, 53.9791747304423, 20.078702742677404, 30.353001750709314, 30.16541414628063, 47.57605527965362, 129.6405880691624, 13.355224837744611, 12.337366319377368, 0.0, 31.503118131468486, 72.91901113437203, 201.49999180700863, 64.7256576647923, 75.84330706923294, 203.50989936180565, 46.04028939777868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7835563780982722, "mean_inference_ms": 2.5061794738220313, "mean_action_processing_ms": 0.3598621575343136, "mean_env_wait_ms": 0.2874487292095776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004273772239685059, "StateBufferConnector_ms": 0.007047414779663086, "ViewRequirementAgentConnector_ms": 0.12288951873779297}, "num_episodes": 22, "episode_return_max": 294.54382075771514, "episode_return_min": -18.00336473363732, "episode_return_mean": 134.4003984715734, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.5188091016624, "num_env_steps_trained_throughput_per_sec": 259.5188091016624, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 15834.883, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15834.819, "sample_time_ms": 1949.697, "learn_time_ms": 13861.416, "learn_throughput": 288.571, "synch_weights_time_ms": 20.716}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "6c58f_00000", "date": "2024-08-16_16-17-13", "timestamp": 1723805233, "time_this_iter_s": 15.452483892440796, "time_total_s": 616.3053472042084, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04fa160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 616.3053472042084, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.368181818181824, "ram_util_percent": 81.9590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2611984731974426, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 1e-05, "total_loss": 7.623220811319099, "policy_loss": -0.00509453295439324, "vf_loss": 7.626506422184132, "vf_explained_var": 0.0017423986442505366, "kl": 0.006352375944985793, "entropy": 1.5379892529003203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2580657256974113, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 6.109670940782658, "policy_loss": -0.00388092539425959, "vf_loss": 6.11349809813121, "vf_explained_var": -0.13301431779508238, "kl": 0.008603716381869487, "entropy": 1.4166392152271574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 294.54382075771514, "episode_reward_min": -56.05261650346077, "episode_reward_mean": 132.9231172779391, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -426.5275898257512, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55123772239781, "predator_policy": 426.94758982575115}, "policy_reward_mean": {"prey_policy": -16.806451487361617, "predator_policy": 83.26801012633119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.69000000000057, 53.83999999999967, 150.25257736908554, 177.52489794842768, 168.87163505114262, 64.87368289727478, 72.90000000000093, -18.00336473363732, 255.9843542250921, 3.849999999999962, 90.19004385822927, 107.16963312966112, 9.899999999999924, 270.5195191893113, 28.850000000000012, 21.650000000000425, 68.96983605225475, 8.492934776148358, 174.03999999999945, 173.42999999999978, 294.54382075771514, 280.95999999999987, 184.88000000000008, 235.44999999999965, 182.65093692652474, 3.819999999999963, 289.6559100504112, 95.90000000000002, 122.19000000000062, 112.24004805230057, 270.086459666078, 23.60576192736864, 146.06, 3.3499999999999717, 289.18517709283884, 163.93440242622603, 225.7318102033733, 277.8301848237585, 117.34000000000026, 183.7238165333619, 236.63569460852912, 265.02999999999946, 105.48429885208982, 235.8915464219528, 250.007812601154, 255.65493412275652, 94.60255120788901, 215.62246475543486, 17.75999999999997, 251.4733283365939, 182.75999999999982, 88.95000000000005, 219.43999999999915, 96.0200000000003, 164.42878873709338, 239.14999999999898, 117.12412877162538, 116.48825168823274, 264.16999999999985, 149.42135843153216, 75.34981777927855, 163.69724753870491, 137.93372060141428, 221.0050930690363, 242.83522865648843, 148.4207593608671, 273.1225998792024, 32.36000000000018, 227.1987205526121, 126.2200000000007, 24.520000000000458, 171.23306842776236, 8.09868759948514, 38.61612620776716, 130.67302351403143, 135.9482082153883, 11.422301984343585, 56.796898327743776, -56.05261650346077, 108.934135298538, 118.2548910236576, 106.95417365161391, 90.96279622016364, 55.9399999999999, 88.58142203131747, 217.29999999999947, 91.01832313816628, 9.429999999999946, 29.70184653418024, 28.504631285215027, 68.3719991990973, 196.7742064575177, 206.5834812834848, 72.16067124432324, 138.78476073788954, 101.94457587517364, 73.8473413339894, 143.74895547961296, 47.55745640175784, 66.3079386297161], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [58.88943134165741, 0.856366474464553, 23.555122808728672, -101.12978161831205, 34.87838608084006, -18.850903892207864, 67.66358317853371, -79.3016855034959, 56.159183588138816, 19.256767042602526, -24.626324342079837, 44.96964594657102, 64.02008112178945, -85.42718263786436, -219.2354177960285, -258.8694789224665, 42.82692590931964, 67.44513600086623, -3.6116820793486877, -14.65137925439391, -112.0980485671479, 70.05004593618345, 10.3790403831022, -0.6590928573613322, 5.423237134637765, -1.0487687823796215, 112.25227309660823, -16.76248325975778, -12.302026082341392, -141.725996549135, -8.85521767288883, 9.208202118585257, -107.06016601073594, -314.96185377325185, -5.828265866731426, -13.058828502806458, 6.361655016847187, 136.94549860702932, -40.29205320305355, 113.2716922657795, 148.95411988700084, 121.38232531534138, 133.67, 120.4738505583852, 134.30783986234798, 20.93713592102386, 78.25152277624682, 134.88917053366842, 129.04166460512, -25.78057669859539, -7.9794441076194325, -9.680076322745402, 107.24458629417731, 136.11154049607907, 64.36090087878365, 8.749980217831407, 34.27543303087467, -43.83997117027652, 11.142158412149431, -96.10408019385288, 73.23814592404003, 111.84233096808117, 2.0000000000000013, -41.663240854049455, 106.71626116964313, -20.918456976806755, -57.37420937692671, -27.748537632773456, 110.86381371708632, 16.344751224087616, -104.91490579290766, 150.19259426734868, -199.47747026337854, 147.02924104693346, 95.34347494781639, 60.8518159172238, -162.97184725495245, -72.17835112528078, 115.65276739919577, -209.6778497991578, 18.065708876968806, -28.114982688345787, 100.62429594249765, 121.41829821553132, 2.0000000000000013, -174.93295718631, 72.34027031114796, 48.95328069839274, 61.24297804594435, 66.61693324726517, 46.98194778603387, 66.37932499245892, -1.5198434778790773, -14.119184561876473, 87.17709147429947, -204.79881425460502, 10.696213216439476, -3.780065738640933, 115.60308333314816, 62.017488634098896, 76.03979230553745, -13.188769420914056, -99.23269425287538, -8.989074199072212, 99.10505703966687, 82.63993839704531, 88.64804276774373, 0.8885676498361775, -138.06106366971903, 58.82069721641855, 101.17955928631365, 73.37716935187879, -6.495950358060798, -119.06691920376747, -62.96170908673474, 1.5190072865135857, 155.55123772239781, 83.50499843539195, -64.55419223966743, 2.250054556370686, 21.49384917189055, -65.07934646677528, 25.7859812365641, 65.87897515411595, -44.084201427847745, 2.495547863884914, 45.62072572513347, 92.60256659555773, -24.680101889020648, 141.64319210325297, -5.045829978076332, 27.507296677401428, 143.82292030639258, 92.9063599730699, -13.340072924420022, -5.391282596272562, 56.06631004704349, 43.35686745369944, -23.857668266737523, 76.01979079361816, -7.743001750709318, -28.25541414628033, -81.87341904367332, 75.88984412261966, -12.306721655968198, -5.287181901668642, 29.271241465691855, -22.158233389392226, 34.758386926613895, -178.50436635396352, 17.528315579565113, -22.149072098202268, -124.3458985890451, -113.78198818619575, -91.76618080414363, 0.4749940584120211, -264.4230748466959, -357.0365434029908, -290.88710666065134, -61.35783821665841, -102.68144500521193, -14.73819244442784, -192.9212354937591, -2.062734924411883, -7.268026241196964, -135.38246513395367, -426.5275898257512, -68.47307928670686, -3.00962087128673, -234.59088918414972, 45.196744488699494, 84.13901522662893, -21.53572528318963, -283.3355764941005, -6.14627809666271, -49.06592163796576, -270.39155653898973, -198.55750200535215, -34.595080284921, -171.28743578449124, 13.09939899351965, -284.16138445373474, -29.113809756778046, 124.00556171414257, 5.480695861709396, -385.82170974728695, -157.26923770946013, -189.66014107395412, -31.48358934529658, 13.55258072554823, -224.2438317941641, -43.86308532132445, -6.351782983436429, -220.6375458864406, -210.05111884999698, 62.09454991823162, -19.729293334262646, -83.97679045455004, -150.5355805807975, -20.59707036246254], "policy_predator_policy_reward": [47.810568658342504, 1.1336335255354484, 22.88935306517609, 108.5253057444082, 38.632979390557104, 95.59211578989752, 112.970862628649, 76.19213764474054, 33.3945770022755, 60.06110741812689, 30.076056572270296, 14.454304720513198, 7.229918878210357, 87.0771826378652, 198.4224547284385, 261.6790772564189, 89.74954803022719, 55.96274428467918, 5.551682079348646, 16.56137925439397, 55.526179810032104, 76.71186667916174, 33.41999878182436, 64.02968682209467, 2.4967628653621943, 3.0287687823796006, 126.16735166613134, 48.86237768632985, 39.8120260823411, 143.06599654913384, 10.76521767288879, 10.531797881414706, 280.77162304633396, 210.22023278990758, 15.710123175958133, 11.669905969728106, 16.308344983152832, 14.424501392970676, 21.487307591000285, 78.96305334627368, 9.001410525708371, 15.205965029664803, 15.150170479755591, 11.66597896185926, 6.726860333940632, 22.908163882687738, 10.37221586364088, 11.937090826443974, 10.859354254891699, 68.5304947651085, 9.889444107619392, 11.590076322745361, 29.307006568756123, 16.992776691398994, 1.3175722851491467, 21.471546618235774, 18.417379078941575, 113.33715906045984, 38.31632091411413, 158.8856489198901, 66.49045693446679, 18.515525839490483, 31.066520119489326, 32.202482661927924, 2.771279350814059, 57.490916456349474, 51.79905107642427, 36.673695933275866, 69.0274987338507, 92.94911341781513, 107.13313128684845, 11.523582664937276, 122.57531416315727, 155.6047252566611, 48.23797562143349, 73.39691833728527, 157.26853248180237, 195.22166589843062, 33.59602727746373, 244.15287165586068, 100.54628308992055, 146.1386853299857, 7.5487728385770465, 35.438633003394195, 101.89421532144482, 176.5230407169543, 24.891278999853682, 89.70671641255846, 40.97646961524506, 81.17143169269954, 66.86994929707308, 75.42371204719075, 30.5794629448575, 79.66211630278661, 141.76029759383988, 191.48388994190043, 5.123786783560486, 5.7200657386408915, 35.512599391620064, 38.34015697772742, 38.71020769446267, 81.19876942091437, 182.99375433794438, 14.178014114003274, 1.874942960333613, 35.820061602954674, 5.381957232256237, 1.101432350163824, 207.4105866484696, 36.25856854192425, 36.160440713686455, 28.43283064812155, 75.94643535146905, 166.74056298198445, 121.50341013946931, 56.427543348984415, 7.794239860069683, 17.319523982140797, 141.2479708690914, 70.47752524573833, 72.18413883432716, 46.751176239836056, 15.481187162891132, 56.55110398513387, 159.04353246173895, 20.478841703638313, 62.384355320529984, 20.397445427815597, 79.00762556176859, 46.864512880488206, 20.611299902145657, 105.34799275939652, 33.472257466630715, 2.921062133109923, 41.46766459008173, 9.623690930610767, 115.61725981929723, 12.158283232572524, 53.9791747304423, 20.078702742677404, 30.353001750709314, 30.16541414628063, 47.57605527965362, 129.6405880691624, 13.355224837744611, 12.337366319377368, 0.0, 31.503118131468486, 72.91901113437203, 201.49999180700863, 64.7256576647923, 75.84330706923294, 203.50989936180565, 46.04028939777868, 72.02154700985761, 76.06653806361909, 351.3869030509695, 214.02009869525625, 184.03310350676395, 277.1459766690829, 59.10311105924002, 176.57141741405724, 223.48812928192328, 78.45001478786125, 58.44635402733364, 175.16693356798044, 426.94758982575115, 123.9930792867069, 238.12680201454845, 88.05513007220442, 83.51378222416811, 4.450458060503474, 249.15860490754892, 146.73102000790746, 2.391737117553159, 62.25046261707501, 376.52657650642794, 122.12432857209322, 83.32577207737509, 151.06137527725105, 50.349134694203784, 289.08484996510816, 20.98359430875478, 80.89886019139857, 281.923578308156, 305.000916860907, 219.07628053256767, 200.013769495169, 97.81556673142741, 58.900202626210714, 106.51594260880336, 263.5355503818581, 140.93164315443124, 159.9050270494351, 197.89950912949678, 93.8060152818813, 57.171645194424784, 94.09189499614602, 140.94775420161307, 96.49283537136333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.781478094831063, "mean_inference_ms": 2.5118036912322013, "mean_action_processing_ms": 0.3589229940225392, "mean_env_wait_ms": 0.2866416050096522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004293203353881836, "StateBufferConnector_ms": 0.00803220272064209, "ViewRequirementAgentConnector_ms": 0.12027919292449951}, "num_episodes": 23, "episode_return_max": 294.54382075771514, "episode_return_min": -56.05261650346077, "episode_return_mean": 132.9231172779391, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.25807843229552, "num_env_steps_trained_throughput_per_sec": 254.25807843229552, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 15701.716, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15701.651, "sample_time_ms": 1795.786, "learn_time_ms": 13881.647, "learn_throughput": 288.15, "synch_weights_time_ms": 21.192}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "6c58f_00000", "date": "2024-08-16_16-17-28", "timestamp": 1723805248, "time_this_iter_s": 15.802848100662231, "time_total_s": 632.1081953048706, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 632.1081953048706, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 60.50434782608696, "ram_util_percent": 82.15652173913043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2186785200758585, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 1e-05, "total_loss": 6.527802324799634, "policy_loss": -0.006691367293969191, "vf_loss": 6.532368988460965, "vf_explained_var": 0.0017120965574153517, "kl": 0.0074612665026475514, "entropy": 1.5375732352493932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9664092129185087, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 5.746654392676379, "policy_loss": -0.002196932915676996, "vf_loss": 5.748804558648003, "vf_explained_var": -0.074650672314659, "kl": 0.007485713422734705, "entropy": 1.466157463051024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 294.54382075771514, "episode_reward_min": -395.3110830666049, "episode_reward_mean": 119.77624102633264, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -583.249760229908, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55123772239781, "predator_policy": 742.9264962541547}, "policy_reward_mean": {"prey_policy": -36.96600194136981, "predator_policy": 96.85412245453615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [174.03999999999945, 173.42999999999978, 294.54382075771514, 280.95999999999987, 184.88000000000008, 235.44999999999965, 182.65093692652474, 3.819999999999963, 289.6559100504112, 95.90000000000002, 122.19000000000062, 112.24004805230057, 270.086459666078, 23.60576192736864, 146.06, 3.3499999999999717, 289.18517709283884, 163.93440242622603, 225.7318102033733, 277.8301848237585, 117.34000000000026, 183.7238165333619, 236.63569460852912, 265.02999999999946, 105.48429885208982, 235.8915464219528, 250.007812601154, 255.65493412275652, 94.60255120788901, 215.62246475543486, 17.75999999999997, 251.4733283365939, 182.75999999999982, 88.95000000000005, 219.43999999999915, 96.0200000000003, 164.42878873709338, 239.14999999999898, 117.12412877162538, 116.48825168823274, 264.16999999999985, 149.42135843153216, 75.34981777927855, 163.69724753870491, 137.93372060141428, 221.0050930690363, 242.83522865648843, 148.4207593608671, 273.1225998792024, 32.36000000000018, 227.1987205526121, 126.2200000000007, 24.520000000000458, 171.23306842776236, 8.09868759948514, 38.61612620776716, 130.67302351403143, 135.9482082153883, 11.422301984343585, 56.796898327743776, -56.05261650346077, 108.934135298538, 118.2548910236576, 106.95417365161391, 90.96279622016364, 55.9399999999999, 88.58142203131747, 217.29999999999947, 91.01832313816628, 9.429999999999946, 29.70184653418024, 28.504631285215027, 68.3719991990973, 196.7742064575177, 206.5834812834848, 72.16067124432324, 138.78476073788954, 101.94457587517364, 73.8473413339894, 143.74895547961296, 47.55745640175784, 66.3079386297161, 21.81205940338808, -43.28933055827222, 84.0483883834496, 74.3099880085937, 40.86538621038135, 71.64987902056652, 40.0598835350121, 34.51936054016309, -10.103830694682253, 20.710280437678733, 40.967657980869085, -395.3110830666049, 77.22192333038868, 35.71331922270177, 84.38262517604304, 6.521743548575477, 52.869999999999514, 92.88987412409543], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.361655016847187, 136.94549860702932, -40.29205320305355, 113.2716922657795, 148.95411988700084, 121.38232531534138, 133.67, 120.4738505583852, 134.30783986234798, 20.93713592102386, 78.25152277624682, 134.88917053366842, 129.04166460512, -25.78057669859539, -7.9794441076194325, -9.680076322745402, 107.24458629417731, 136.11154049607907, 64.36090087878365, 8.749980217831407, 34.27543303087467, -43.83997117027652, 11.142158412149431, -96.10408019385288, 73.23814592404003, 111.84233096808117, 2.0000000000000013, -41.663240854049455, 106.71626116964313, -20.918456976806755, -57.37420937692671, -27.748537632773456, 110.86381371708632, 16.344751224087616, -104.91490579290766, 150.19259426734868, -199.47747026337854, 147.02924104693346, 95.34347494781639, 60.8518159172238, -162.97184725495245, -72.17835112528078, 115.65276739919577, -209.6778497991578, 18.065708876968806, -28.114982688345787, 100.62429594249765, 121.41829821553132, 2.0000000000000013, -174.93295718631, 72.34027031114796, 48.95328069839274, 61.24297804594435, 66.61693324726517, 46.98194778603387, 66.37932499245892, -1.5198434778790773, -14.119184561876473, 87.17709147429947, -204.79881425460502, 10.696213216439476, -3.780065738640933, 115.60308333314816, 62.017488634098896, 76.03979230553745, -13.188769420914056, -99.23269425287538, -8.989074199072212, 99.10505703966687, 82.63993839704531, 88.64804276774373, 0.8885676498361775, -138.06106366971903, 58.82069721641855, 101.17955928631365, 73.37716935187879, -6.495950358060798, -119.06691920376747, -62.96170908673474, 1.5190072865135857, 155.55123772239781, 83.50499843539195, -64.55419223966743, 2.250054556370686, 21.49384917189055, -65.07934646677528, 25.7859812365641, 65.87897515411595, -44.084201427847745, 2.495547863884914, 45.62072572513347, 92.60256659555773, -24.680101889020648, 141.64319210325297, -5.045829978076332, 27.507296677401428, 143.82292030639258, 92.9063599730699, -13.340072924420022, -5.391282596272562, 56.06631004704349, 43.35686745369944, -23.857668266737523, 76.01979079361816, -7.743001750709318, -28.25541414628033, -81.87341904367332, 75.88984412261966, -12.306721655968198, -5.287181901668642, 29.271241465691855, -22.158233389392226, 34.758386926613895, -178.50436635396352, 17.528315579565113, -22.149072098202268, -124.3458985890451, -113.78198818619575, -91.76618080414363, 0.4749940584120211, -264.4230748466959, -357.0365434029908, -290.88710666065134, -61.35783821665841, -102.68144500521193, -14.73819244442784, -192.9212354937591, -2.062734924411883, -7.268026241196964, -135.38246513395367, -426.5275898257512, -68.47307928670686, -3.00962087128673, -234.59088918414972, 45.196744488699494, 84.13901522662893, -21.53572528318963, -283.3355764941005, -6.14627809666271, -49.06592163796576, -270.39155653898973, -198.55750200535215, -34.595080284921, -171.28743578449124, 13.09939899351965, -284.16138445373474, -29.113809756778046, 124.00556171414257, 5.480695861709396, -385.82170974728695, -157.26923770946013, -189.66014107395412, -31.48358934529658, 13.55258072554823, -224.2438317941641, -43.86308532132445, -6.351782983436429, -220.6375458864406, -210.05111884999698, 62.09454991823162, -19.729293334262646, -83.97679045455004, -150.5355805807975, -20.59707036246254, -0.6953177441181764, -194.55157732116422, -242.43624584868482, -92.28067164739802, 43.022044647882524, -220.3099743839674, -9.284352855463993, -262.1329605598911, -127.32688401807516, -5.659923322195355, -115.41536360923726, -187.9812435838792, -62.411735789356456, -42.41923081586219, -212.81862633317905, -45.44731009187223, -40.929959063598034, -26.554740806205142, -100.34595999249765, -171.302985479017, -262.5484946334451, -54.10494179324339, -583.249760229908, -554.98781909085, -168.9351202982773, -1.3353148796321979, -141.2660982637988, -35.909668674868826, -291.3481356309065, -59.4569273241444, -26.630658283577706, -98.09078688685013, 12.188971728417052, -88.78610014040997, -97.86049926257047, -314.5368743278998], "policy_predator_policy_reward": [16.308344983152832, 14.424501392970676, 21.487307591000285, 78.96305334627368, 9.001410525708371, 15.205965029664803, 15.150170479755591, 11.66597896185926, 6.726860333940632, 22.908163882687738, 10.37221586364088, 11.937090826443974, 10.859354254891699, 68.5304947651085, 9.889444107619392, 11.590076322745361, 29.307006568756123, 16.992776691398994, 1.3175722851491467, 21.471546618235774, 18.417379078941575, 113.33715906045984, 38.31632091411413, 158.8856489198901, 66.49045693446679, 18.515525839490483, 31.066520119489326, 32.202482661927924, 2.771279350814059, 57.490916456349474, 51.79905107642427, 36.673695933275866, 69.0274987338507, 92.94911341781513, 107.13313128684845, 11.523582664937276, 122.57531416315727, 155.6047252566611, 48.23797562143349, 73.39691833728527, 157.26853248180237, 195.22166589843062, 33.59602727746373, 244.15287165586068, 100.54628308992055, 146.1386853299857, 7.5487728385770465, 35.438633003394195, 101.89421532144482, 176.5230407169543, 24.891278999853682, 89.70671641255846, 40.97646961524506, 81.17143169269954, 66.86994929707308, 75.42371204719075, 30.5794629448575, 79.66211630278661, 141.76029759383988, 191.48388994190043, 5.123786783560486, 5.7200657386408915, 35.512599391620064, 38.34015697772742, 38.71020769446267, 81.19876942091437, 182.99375433794438, 14.178014114003274, 1.874942960333613, 35.820061602954674, 5.381957232256237, 1.101432350163824, 207.4105866484696, 36.25856854192425, 36.160440713686455, 28.43283064812155, 75.94643535146905, 166.74056298198445, 121.50341013946931, 56.427543348984415, 7.794239860069683, 17.319523982140797, 141.2479708690914, 70.47752524573833, 72.18413883432716, 46.751176239836056, 15.481187162891132, 56.55110398513387, 159.04353246173895, 20.478841703638313, 62.384355320529984, 20.397445427815597, 79.00762556176859, 46.864512880488206, 20.611299902145657, 105.34799275939652, 33.472257466630715, 2.921062133109923, 41.46766459008173, 9.623690930610767, 115.61725981929723, 12.158283232572524, 53.9791747304423, 20.078702742677404, 30.353001750709314, 30.16541414628063, 47.57605527965362, 129.6405880691624, 13.355224837744611, 12.337366319377368, 0.0, 31.503118131468486, 72.91901113437203, 201.49999180700863, 64.7256576647923, 75.84330706923294, 203.50989936180565, 46.04028939777868, 72.02154700985761, 76.06653806361909, 351.3869030509695, 214.02009869525625, 184.03310350676395, 277.1459766690829, 59.10311105924002, 176.57141741405724, 223.48812928192328, 78.45001478786125, 58.44635402733364, 175.16693356798044, 426.94758982575115, 123.9930792867069, 238.12680201454845, 88.05513007220442, 83.51378222416811, 4.450458060503474, 249.15860490754892, 146.73102000790746, 2.391737117553159, 62.25046261707501, 376.52657650642794, 122.12432857209322, 83.32577207737509, 151.06137527725105, 50.349134694203784, 289.08484996510816, 20.98359430875478, 80.89886019139857, 281.923578308156, 305.000916860907, 219.07628053256767, 200.013769495169, 97.81556673142741, 58.900202626210714, 106.51594260880336, 263.5355503818581, 140.93164315443124, 159.9050270494351, 197.89950912949678, 93.8060152818813, 57.171645194424784, 94.09189499614602, 140.94775420161307, 96.49283537136333, 92.59369653430831, 124.46525793436106, 241.32473064239377, 50.10285629541679, 202.00303323390446, 59.33328488562914, 103.79187610962398, 241.9354253143245, 72.55949034321382, 101.29270320743858, 214.29767473064862, 160.74881148303405, 67.89940766866229, 76.9914424715684, 82.53328898253163, 210.25200798268187, 41.982698333070175, 15.398170842050725, 147.34559399403102, 145.01363191516305, 268.7090626318572, 88.91203177569963, 742.9264962541547, 0.0, 86.05241247533085, 161.4399460329671, 137.63111639813548, 75.25796976323329, 139.34899292326833, 295.83869520782486, 100.76291141334099, 30.48027730566321, 39.041028271582924, 90.42610014041081, 256.6593416877409, 248.62790602682523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.782474396646196, "mean_inference_ms": 2.5128240089410077, "mean_action_processing_ms": 0.357753981498139, "mean_env_wait_ms": 0.2866944189312511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004186511039733887, "StateBufferConnector_ms": 0.008078336715698242, "ViewRequirementAgentConnector_ms": 0.12401854991912842}, "num_episodes": 18, "episode_return_max": 294.54382075771514, "episode_return_min": -395.3110830666049, "episode_return_mean": 119.77624102633264, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.47685854362254, "num_env_steps_trained_throughput_per_sec": 251.47685854362254, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 15723.412, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15723.349, "sample_time_ms": 1828.702, "learn_time_ms": 13870.298, "learn_throughput": 288.386, "synch_weights_time_ms": 21.473}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "6c58f_00000", "date": "2024-08-16_16-17-44", "timestamp": 1723805264, "time_this_iter_s": 15.954724073410034, "time_total_s": 648.0629193782806, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 648.0629193782806, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.3409090909091, "ram_util_percent": 82.42727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2536459479855482, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 1e-05, "total_loss": 6.345156592414493, "policy_loss": -0.010053353978286463, "vf_loss": 6.351743099676869, "vf_explained_var": 0.002332782429992837, "kl": 0.012174439830454516, "entropy": 1.5177135927336556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3912298652072432, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 6.895458044324602, "policy_loss": -0.0018616864891358154, "vf_loss": 6.8972766086538, "vf_explained_var": -0.007147493942704781, "kl": 0.006896778489445321, "entropy": 1.4745474367545395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 277.8301848237585, "episode_reward_min": -467.6007590601181, "episode_reward_mean": 83.3301323681375, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -627.4817077480404, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55123772239781, "predator_policy": 757.7105514149423}, "policy_reward_mean": {"prey_policy": -83.98935539549109, "predator_policy": 125.65442157955982}, "custom_metrics": {}, "hist_stats": {"episode_reward": [225.7318102033733, 277.8301848237585, 117.34000000000026, 183.7238165333619, 236.63569460852912, 265.02999999999946, 105.48429885208982, 235.8915464219528, 250.007812601154, 255.65493412275652, 94.60255120788901, 215.62246475543486, 17.75999999999997, 251.4733283365939, 182.75999999999982, 88.95000000000005, 219.43999999999915, 96.0200000000003, 164.42878873709338, 239.14999999999898, 117.12412877162538, 116.48825168823274, 264.16999999999985, 149.42135843153216, 75.34981777927855, 163.69724753870491, 137.93372060141428, 221.0050930690363, 242.83522865648843, 148.4207593608671, 273.1225998792024, 32.36000000000018, 227.1987205526121, 126.2200000000007, 24.520000000000458, 171.23306842776236, 8.09868759948514, 38.61612620776716, 130.67302351403143, 135.9482082153883, 11.422301984343585, 56.796898327743776, -56.05261650346077, 108.934135298538, 118.2548910236576, 106.95417365161391, 90.96279622016364, 55.9399999999999, 88.58142203131747, 217.29999999999947, 91.01832313816628, 9.429999999999946, 29.70184653418024, 28.504631285215027, 68.3719991990973, 196.7742064575177, 206.5834812834848, 72.16067124432324, 138.78476073788954, 101.94457587517364, 73.8473413339894, 143.74895547961296, 47.55745640175784, 66.3079386297161, 21.81205940338808, -43.28933055827222, 84.0483883834496, 74.3099880085937, 40.86538621038135, 71.64987902056652, 40.0598835350121, 34.51936054016309, -10.103830694682253, 20.710280437678733, 40.967657980869085, -395.3110830666049, 77.22192333038868, 35.71331922270177, 84.38262517604304, 6.521743548575477, 52.869999999999514, 92.88987412409543, 72.62588753382408, 96.31714179757066, 16.58414215263442, -205.36644615534382, 40.28640695687451, 75.5380811144445, -65.12386797986208, 5.571415048418967, -0.4564250892539654, -251.14351220785082, -6.634067908367288, -467.6007590601181, -8.083689904840723, 11.240868877376396, 9.461328082984197, 1.020358192725444, 15.503555248811839, 61.631234379919576], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-199.47747026337854, 147.02924104693346, 95.34347494781639, 60.8518159172238, -162.97184725495245, -72.17835112528078, 115.65276739919577, -209.6778497991578, 18.065708876968806, -28.114982688345787, 100.62429594249765, 121.41829821553132, 2.0000000000000013, -174.93295718631, 72.34027031114796, 48.95328069839274, 61.24297804594435, 66.61693324726517, 46.98194778603387, 66.37932499245892, -1.5198434778790773, -14.119184561876473, 87.17709147429947, -204.79881425460502, 10.696213216439476, -3.780065738640933, 115.60308333314816, 62.017488634098896, 76.03979230553745, -13.188769420914056, -99.23269425287538, -8.989074199072212, 99.10505703966687, 82.63993839704531, 88.64804276774373, 0.8885676498361775, -138.06106366971903, 58.82069721641855, 101.17955928631365, 73.37716935187879, -6.495950358060798, -119.06691920376747, -62.96170908673474, 1.5190072865135857, 155.55123772239781, 83.50499843539195, -64.55419223966743, 2.250054556370686, 21.49384917189055, -65.07934646677528, 25.7859812365641, 65.87897515411595, -44.084201427847745, 2.495547863884914, 45.62072572513347, 92.60256659555773, -24.680101889020648, 141.64319210325297, -5.045829978076332, 27.507296677401428, 143.82292030639258, 92.9063599730699, -13.340072924420022, -5.391282596272562, 56.06631004704349, 43.35686745369944, -23.857668266737523, 76.01979079361816, -7.743001750709318, -28.25541414628033, -81.87341904367332, 75.88984412261966, -12.306721655968198, -5.287181901668642, 29.271241465691855, -22.158233389392226, 34.758386926613895, -178.50436635396352, 17.528315579565113, -22.149072098202268, -124.3458985890451, -113.78198818619575, -91.76618080414363, 0.4749940584120211, -264.4230748466959, -357.0365434029908, -290.88710666065134, -61.35783821665841, -102.68144500521193, -14.73819244442784, -192.9212354937591, -2.062734924411883, -7.268026241196964, -135.38246513395367, -426.5275898257512, -68.47307928670686, -3.00962087128673, -234.59088918414972, 45.196744488699494, 84.13901522662893, -21.53572528318963, -283.3355764941005, -6.14627809666271, -49.06592163796576, -270.39155653898973, -198.55750200535215, -34.595080284921, -171.28743578449124, 13.09939899351965, -284.16138445373474, -29.113809756778046, 124.00556171414257, 5.480695861709396, -385.82170974728695, -157.26923770946013, -189.66014107395412, -31.48358934529658, 13.55258072554823, -224.2438317941641, -43.86308532132445, -6.351782983436429, -220.6375458864406, -210.05111884999698, 62.09454991823162, -19.729293334262646, -83.97679045455004, -150.5355805807975, -20.59707036246254, -0.6953177441181764, -194.55157732116422, -242.43624584868482, -92.28067164739802, 43.022044647882524, -220.3099743839674, -9.284352855463993, -262.1329605598911, -127.32688401807516, -5.659923322195355, -115.41536360923726, -187.9812435838792, -62.411735789356456, -42.41923081586219, -212.81862633317905, -45.44731009187223, -40.929959063598034, -26.554740806205142, -100.34595999249765, -171.302985479017, -262.5484946334451, -54.10494179324339, -583.249760229908, -554.98781909085, -168.9351202982773, -1.3353148796321979, -141.2660982637988, -35.909668674868826, -291.3481356309065, -59.4569273241444, -26.630658283577706, -98.09078688685013, 12.188971728417052, -88.78610014040997, -97.86049926257047, -314.5368743278998, -16.961360299101223, -62.04635679495185, 1.9937094162359374, -169.2670166464497, -113.70219222459184, -205.90887800668793, -578.8663256537466, -349.1898669592577, -148.01591515773293, 2.0000000000000013, -96.55811730132224, -100.3356453418611, -284.5264080399959, -113.67170908455827, -337.52768136344747, -389.37281255517075, -223.3769523928357, -78.15875751112263, -506.1529634477977, -474.19362886317083, -365.6045593838691, -193.63405802633886, -597.8296027270205, -627.4817077480404, -234.1389921595249, -291.63317273428555, -212.3985635374485, -257.9457794423819, -134.24920094004185, -55.90267632785678, -59.24688186167363, -15.572247093708036, -73.6384835646236, -3.876273887084256, -42.912089425569185, -259.4941041178575], "policy_predator_policy_reward": [122.57531416315727, 155.6047252566611, 48.23797562143349, 73.39691833728527, 157.26853248180237, 195.22166589843062, 33.59602727746373, 244.15287165586068, 100.54628308992055, 146.1386853299857, 7.5487728385770465, 35.438633003394195, 101.89421532144482, 176.5230407169543, 24.891278999853682, 89.70671641255846, 40.97646961524506, 81.17143169269954, 66.86994929707308, 75.42371204719075, 30.5794629448575, 79.66211630278661, 141.76029759383988, 191.48388994190043, 5.123786783560486, 5.7200657386408915, 35.512599391620064, 38.34015697772742, 38.71020769446267, 81.19876942091437, 182.99375433794438, 14.178014114003274, 1.874942960333613, 35.820061602954674, 5.381957232256237, 1.101432350163824, 207.4105866484696, 36.25856854192425, 36.160440713686455, 28.43283064812155, 75.94643535146905, 166.74056298198445, 121.50341013946931, 56.427543348984415, 7.794239860069683, 17.319523982140797, 141.2479708690914, 70.47752524573833, 72.18413883432716, 46.751176239836056, 15.481187162891132, 56.55110398513387, 159.04353246173895, 20.478841703638313, 62.384355320529984, 20.397445427815597, 79.00762556176859, 46.864512880488206, 20.611299902145657, 105.34799275939652, 33.472257466630715, 2.921062133109923, 41.46766459008173, 9.623690930610767, 115.61725981929723, 12.158283232572524, 53.9791747304423, 20.078702742677404, 30.353001750709314, 30.16541414628063, 47.57605527965362, 129.6405880691624, 13.355224837744611, 12.337366319377368, 0.0, 31.503118131468486, 72.91901113437203, 201.49999180700863, 64.7256576647923, 75.84330706923294, 203.50989936180565, 46.04028939777868, 72.02154700985761, 76.06653806361909, 351.3869030509695, 214.02009869525625, 184.03310350676395, 277.1459766690829, 59.10311105924002, 176.57141741405724, 223.48812928192328, 78.45001478786125, 58.44635402733364, 175.16693356798044, 426.94758982575115, 123.9930792867069, 238.12680201454845, 88.05513007220442, 83.51378222416811, 4.450458060503474, 249.15860490754892, 146.73102000790746, 2.391737117553159, 62.25046261707501, 376.52657650642794, 122.12432857209322, 83.32577207737509, 151.06137527725105, 50.349134694203784, 289.08484996510816, 20.98359430875478, 80.89886019139857, 281.923578308156, 305.000916860907, 219.07628053256767, 200.013769495169, 97.81556673142741, 58.900202626210714, 106.51594260880336, 263.5355503818581, 140.93164315443124, 159.9050270494351, 197.89950912949678, 93.8060152818813, 57.171645194424784, 94.09189499614602, 140.94775420161307, 96.49283537136333, 92.59369653430831, 124.46525793436106, 241.32473064239377, 50.10285629541679, 202.00303323390446, 59.33328488562914, 103.79187610962398, 241.9354253143245, 72.55949034321382, 101.29270320743858, 214.29767473064862, 160.74881148303405, 67.89940766866229, 76.9914424715684, 82.53328898253163, 210.25200798268187, 41.982698333070175, 15.398170842050725, 147.34559399403102, 145.01363191516305, 268.7090626318572, 88.91203177569963, 742.9264962541547, 0.0, 86.05241247533085, 161.4399460329671, 137.63111639813548, 75.25796976323329, 139.34899292326833, 295.83869520782486, 100.76291141334099, 30.48027730566321, 39.041028271582924, 90.42610014041081, 256.6593416877409, 248.62790602682523, 92.45162299186472, 59.18198163601175, 109.94147524846645, 153.64897377931558, 161.6486571726997, 174.54655521121424, 122.76749223324882, 599.9222542244115, 61.054692088819706, 125.24763002578736, 133.6309377179467, 138.80090603968125, 32.157141872344674, 300.91710727234727, 420.309375939903, 312.16253302713415, 220.74246552012363, 80.33681929458137, 226.86401770891825, 502.33906239419997, 299.93498328488647, 252.66956621695394, 0.0, 757.7105514149423, 350.80991258499904, 166.87856240396974, 249.61731593359167, 231.9678959236132, 128.50096432797937, 71.11224102290247, 23.14514770285859, 52.69433944524823, 76.11540243387988, 16.90291026664036, 250.38838936019138, 113.64903856315406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7852259496387769, "mean_inference_ms": 2.520023032827312, "mean_action_processing_ms": 0.357654731365275, "mean_env_wait_ms": 0.2870216281056818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004182696342468262, "StateBufferConnector_ms": 0.0081404447555542, "ViewRequirementAgentConnector_ms": 0.19593322277069092}, "num_episodes": 18, "episode_return_max": 277.8301848237585, "episode_return_min": -467.6007590601181, "episode_return_mean": 83.3301323681375, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.76353352296246, "num_env_steps_trained_throughput_per_sec": 247.76353352296246, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 15791.537, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15791.474, "sample_time_ms": 1945.714, "learn_time_ms": 13818.734, "learn_throughput": 289.462, "synch_weights_time_ms": 24.077}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "6c58f_00000", "date": "2024-08-16_16-18-01", "timestamp": 1723805281, "time_this_iter_s": 16.190797090530396, "time_total_s": 664.253716468811, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 664.253716468811, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 58.08260869565219, "ram_util_percent": 82.05217391304348}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8857065374258334, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 1e-05, "total_loss": 9.07521855742843, "policy_loss": -0.012384032472603456, "vf_loss": 9.083167190148085, "vf_explained_var": 0.0015144244703666242, "kl": 0.015575630946475112, "entropy": 1.4611289662028115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6283011112657805, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.973434452783493, "policy_loss": -0.0024407113007905465, "vf_loss": 9.975809373805133, "vf_explained_var": 0.0014200807248473798, "kl": 0.010528743064720956, "entropy": 1.4738451231093634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 331.9377088161812, "episode_reward_min": -467.6007590601181, "episode_reward_mean": 31.635351717758986, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1261.9229510421615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 155.55123772239781, "predator_policy": 1162.3948000170499}, "policy_reward_mean": {"prey_policy": -190.75521757483497, "predator_policy": 206.57289343371443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [164.42878873709338, 239.14999999999898, 117.12412877162538, 116.48825168823274, 264.16999999999985, 149.42135843153216, 75.34981777927855, 163.69724753870491, 137.93372060141428, 221.0050930690363, 242.83522865648843, 148.4207593608671, 273.1225998792024, 32.36000000000018, 227.1987205526121, 126.2200000000007, 24.520000000000458, 171.23306842776236, 8.09868759948514, 38.61612620776716, 130.67302351403143, 135.9482082153883, 11.422301984343585, 56.796898327743776, -56.05261650346077, 108.934135298538, 118.2548910236576, 106.95417365161391, 90.96279622016364, 55.9399999999999, 88.58142203131747, 217.29999999999947, 91.01832313816628, 9.429999999999946, 29.70184653418024, 28.504631285215027, 68.3719991990973, 196.7742064575177, 206.5834812834848, 72.16067124432324, 138.78476073788954, 101.94457587517364, 73.8473413339894, 143.74895547961296, 47.55745640175784, 66.3079386297161, 21.81205940338808, -43.28933055827222, 84.0483883834496, 74.3099880085937, 40.86538621038135, 71.64987902056652, 40.0598835350121, 34.51936054016309, -10.103830694682253, 20.710280437678733, 40.967657980869085, -395.3110830666049, 77.22192333038868, 35.71331922270177, 84.38262517604304, 6.521743548575477, 52.869999999999514, 92.88987412409543, 72.62588753382408, 96.31714179757066, 16.58414215263442, -205.36644615534382, 40.28640695687451, 75.5380811144445, -65.12386797986208, 5.571415048418967, -0.4564250892539654, -251.14351220785082, -6.634067908367288, -467.6007590601181, -8.083689904840723, 11.240868877376396, 9.461328082984197, 1.020358192725444, 15.503555248811839, 61.631234379919576, -265.9281918773124, -394.39750022927205, -27.341063160681266, -126.59193998186794, -152.54842405874413, -157.14405014617014, -46.476310759956476, -11.575372887750703, -220.00245044312436, -96.53293689305411, 112.80195951550859, 331.9377088161812, -85.61006054123496, -374.98189260638054, -65.28456193503908, 25.291729387741757, -119.81766766345422, -175.31859710634728], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-138.06106366971903, 58.82069721641855, 101.17955928631365, 73.37716935187879, -6.495950358060798, -119.06691920376747, -62.96170908673474, 1.5190072865135857, 155.55123772239781, 83.50499843539195, -64.55419223966743, 2.250054556370686, 21.49384917189055, -65.07934646677528, 25.7859812365641, 65.87897515411595, -44.084201427847745, 2.495547863884914, 45.62072572513347, 92.60256659555773, -24.680101889020648, 141.64319210325297, -5.045829978076332, 27.507296677401428, 143.82292030639258, 92.9063599730699, -13.340072924420022, -5.391282596272562, 56.06631004704349, 43.35686745369944, -23.857668266737523, 76.01979079361816, -7.743001750709318, -28.25541414628033, -81.87341904367332, 75.88984412261966, -12.306721655968198, -5.287181901668642, 29.271241465691855, -22.158233389392226, 34.758386926613895, -178.50436635396352, 17.528315579565113, -22.149072098202268, -124.3458985890451, -113.78198818619575, -91.76618080414363, 0.4749940584120211, -264.4230748466959, -357.0365434029908, -290.88710666065134, -61.35783821665841, -102.68144500521193, -14.73819244442784, -192.9212354937591, -2.062734924411883, -7.268026241196964, -135.38246513395367, -426.5275898257512, -68.47307928670686, -3.00962087128673, -234.59088918414972, 45.196744488699494, 84.13901522662893, -21.53572528318963, -283.3355764941005, -6.14627809666271, -49.06592163796576, -270.39155653898973, -198.55750200535215, -34.595080284921, -171.28743578449124, 13.09939899351965, -284.16138445373474, -29.113809756778046, 124.00556171414257, 5.480695861709396, -385.82170974728695, -157.26923770946013, -189.66014107395412, -31.48358934529658, 13.55258072554823, -224.2438317941641, -43.86308532132445, -6.351782983436429, -220.6375458864406, -210.05111884999698, 62.09454991823162, -19.729293334262646, -83.97679045455004, -150.5355805807975, -20.59707036246254, -0.6953177441181764, -194.55157732116422, -242.43624584868482, -92.28067164739802, 43.022044647882524, -220.3099743839674, -9.284352855463993, -262.1329605598911, -127.32688401807516, -5.659923322195355, -115.41536360923726, -187.9812435838792, -62.411735789356456, -42.41923081586219, -212.81862633317905, -45.44731009187223, -40.929959063598034, -26.554740806205142, -100.34595999249765, -171.302985479017, -262.5484946334451, -54.10494179324339, -583.249760229908, -554.98781909085, -168.9351202982773, -1.3353148796321979, -141.2660982637988, -35.909668674868826, -291.3481356309065, -59.4569273241444, -26.630658283577706, -98.09078688685013, 12.188971728417052, -88.78610014040997, -97.86049926257047, -314.5368743278998, -16.961360299101223, -62.04635679495185, 1.9937094162359374, -169.2670166464497, -113.70219222459184, -205.90887800668793, -578.8663256537466, -349.1898669592577, -148.01591515773293, 2.0000000000000013, -96.55811730132224, -100.3356453418611, -284.5264080399959, -113.67170908455827, -337.52768136344747, -389.37281255517075, -223.3769523928357, -78.15875751112263, -506.1529634477977, -474.19362886317083, -365.6045593838691, -193.63405802633886, -597.8296027270205, -627.4817077480404, -234.1389921595249, -291.63317273428555, -212.3985635374485, -257.9457794423819, -134.24920094004185, -55.90267632785678, -59.24688186167363, -15.572247093708036, -73.6384835646236, -3.876273887084256, -42.912089425569185, -259.4941041178575, -366.51186575031056, -496.8798615896679, -1261.9229510421615, -1074.8888252644956, -181.0018635306659, -569.3617813548996, -508.5392737286124, -386.6295358845643, -313.59861712640327, -224.2116067655083, -1002.1479613196299, -880.6889323450727, -956.5567075530407, -649.0464087722673, -551.7578604775829, -825.3236058420031, -439.3508731613362, -406.2608375333851, -419.87715883536873, -507.5892990784083, -722.3371204985364, -531.5234520448613, -110.38133698129538, -691.9642889386545, -401.74338485874836, -358.7588352559218, -602.9006044292719, -595.7920719576365, -533.9826979111153, -612.0108487437767, -668.8365896130383, -996.7702276277334, -602.5570729784877, -345.2154232265126, -525.2468051320984, -577.6721406937668], "policy_predator_policy_reward": [207.4105866484696, 36.25856854192425, 36.160440713686455, 28.43283064812155, 75.94643535146905, 166.74056298198445, 121.50341013946931, 56.427543348984415, 7.794239860069683, 17.319523982140797, 141.2479708690914, 70.47752524573833, 72.18413883432716, 46.751176239836056, 15.481187162891132, 56.55110398513387, 159.04353246173895, 20.478841703638313, 62.384355320529984, 20.397445427815597, 79.00762556176859, 46.864512880488206, 20.611299902145657, 105.34799275939652, 33.472257466630715, 2.921062133109923, 41.46766459008173, 9.623690930610767, 115.61725981929723, 12.158283232572524, 53.9791747304423, 20.078702742677404, 30.353001750709314, 30.16541414628063, 47.57605527965362, 129.6405880691624, 13.355224837744611, 12.337366319377368, 0.0, 31.503118131468486, 72.91901113437203, 201.49999180700863, 64.7256576647923, 75.84330706923294, 203.50989936180565, 46.04028939777868, 72.02154700985761, 76.06653806361909, 351.3869030509695, 214.02009869525625, 184.03310350676395, 277.1459766690829, 59.10311105924002, 176.57141741405724, 223.48812928192328, 78.45001478786125, 58.44635402733364, 175.16693356798044, 426.94758982575115, 123.9930792867069, 238.12680201454845, 88.05513007220442, 83.51378222416811, 4.450458060503474, 249.15860490754892, 146.73102000790746, 2.391737117553159, 62.25046261707501, 376.52657650642794, 122.12432857209322, 83.32577207737509, 151.06137527725105, 50.349134694203784, 289.08484996510816, 20.98359430875478, 80.89886019139857, 281.923578308156, 305.000916860907, 219.07628053256767, 200.013769495169, 97.81556673142741, 58.900202626210714, 106.51594260880336, 263.5355503818581, 140.93164315443124, 159.9050270494351, 197.89950912949678, 93.8060152818813, 57.171645194424784, 94.09189499614602, 140.94775420161307, 96.49283537136333, 92.59369653430831, 124.46525793436106, 241.32473064239377, 50.10285629541679, 202.00303323390446, 59.33328488562914, 103.79187610962398, 241.9354253143245, 72.55949034321382, 101.29270320743858, 214.29767473064862, 160.74881148303405, 67.89940766866229, 76.9914424715684, 82.53328898253163, 210.25200798268187, 41.982698333070175, 15.398170842050725, 147.34559399403102, 145.01363191516305, 268.7090626318572, 88.91203177569963, 742.9264962541547, 0.0, 86.05241247533085, 161.4399460329671, 137.63111639813548, 75.25796976323329, 139.34899292326833, 295.83869520782486, 100.76291141334099, 30.48027730566321, 39.041028271582924, 90.42610014041081, 256.6593416877409, 248.62790602682523, 92.45162299186472, 59.18198163601175, 109.94147524846645, 153.64897377931558, 161.6486571726997, 174.54655521121424, 122.76749223324882, 599.9222542244115, 61.054692088819706, 125.24763002578736, 133.6309377179467, 138.80090603968125, 32.157141872344674, 300.91710727234727, 420.309375939903, 312.16253302713415, 220.74246552012363, 80.33681929458137, 226.86401770891825, 502.33906239419997, 299.93498328488647, 252.66956621695394, 0.0, 757.7105514149423, 350.80991258499904, 166.87856240396974, 249.61731593359167, 231.9678959236132, 128.50096432797937, 71.11224102290247, 23.14514770285859, 52.69433944524823, 76.11540243387988, 16.90291026664036, 250.38838936019138, 113.64903856315406, 2.2511007033395796, 595.2124347593268, 1162.3948000170499, 780.0194760603354, 546.895047284129, 176.1275344407544, 628.1698806122689, 140.40698901904028, 8.012110542736446, 377.2496892904304, 737.8945841516312, 987.7982593669008, 1008.681765935656, 550.4450396296954, 559.9865583368262, 805.5195350950088, 575.2029598145449, 50.40630043705267, 442.24228472581405, 388.69123629490906, 785.6602559666934, 581.0022760922127, 549.9909013702431, 584.2924333658887, 396.2569367464253, 278.63522282701035, 777.2630886439484, 46.447695136579156, 595.5473901597018, 485.1615945601513, 924.6507759823586, 766.2477706461553, 655.5734094069716, 172.38141913457417, 444.16652962359325, 483.43381909592466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.788606989934352, "mean_inference_ms": 2.5279947185760507, "mean_action_processing_ms": 0.35807556788714656, "mean_env_wait_ms": 0.2878309646316657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004292845726013184, "StateBufferConnector_ms": 0.008253812789916992, "ViewRequirementAgentConnector_ms": 0.21419060230255127}, "num_episodes": 18, "episode_return_max": 331.9377088161812, "episode_return_min": -467.6007590601181, "episode_return_mean": 31.635351717758986, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.1326690934741, "num_env_steps_trained_throughput_per_sec": 257.1326690934741, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 15823.126, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15823.076, "sample_time_ms": 2044.681, "learn_time_ms": 13747.695, "learn_throughput": 290.958, "synch_weights_time_ms": 28.028}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "6c58f_00000", "date": "2024-08-16_16-18-16", "timestamp": 1723805296, "time_this_iter_s": 15.64824891090393, "time_total_s": 679.901965379715, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04f50d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 679.901965379715, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 60.20869565217392, "ram_util_percent": 82.04347826086956}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8305249263685216, "cur_kl_coeff": 0.28476562499999986, "cur_lr": 1e-05, "total_loss": 9.806468363161441, "policy_loss": -0.004342943516673235, "vf_loss": 9.8097935807768, "vf_explained_var": 0.0002690631245809888, "kl": 0.003573934544078683, "entropy": 1.4470860185446563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9555842171585749, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.789174316547536, "policy_loss": -0.007045208910731451, "vf_loss": 9.796149988023062, "vf_explained_var": 0.007980987918439996, "kl": 0.011128079244266289, "entropy": 1.4713082246679479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 374.0816862084281, "episode_reward_min": -560.7227787456584, "episode_reward_mean": 5.204754601033357, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1261.9229510421615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.00556171414257, "predator_policy": 1162.3948000170499}, "policy_reward_mean": {"prey_policy": -348.44706611947, "predator_policy": 351.0494434199866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.422301984343585, 56.796898327743776, -56.05261650346077, 108.934135298538, 118.2548910236576, 106.95417365161391, 90.96279622016364, 55.9399999999999, 88.58142203131747, 217.29999999999947, 91.01832313816628, 9.429999999999946, 29.70184653418024, 28.504631285215027, 68.3719991990973, 196.7742064575177, 206.5834812834848, 72.16067124432324, 138.78476073788954, 101.94457587517364, 73.8473413339894, 143.74895547961296, 47.55745640175784, 66.3079386297161, 21.81205940338808, -43.28933055827222, 84.0483883834496, 74.3099880085937, 40.86538621038135, 71.64987902056652, 40.0598835350121, 34.51936054016309, -10.103830694682253, 20.710280437678733, 40.967657980869085, -395.3110830666049, 77.22192333038868, 35.71331922270177, 84.38262517604304, 6.521743548575477, 52.869999999999514, 92.88987412409543, 72.62588753382408, 96.31714179757066, 16.58414215263442, -205.36644615534382, 40.28640695687451, 75.5380811144445, -65.12386797986208, 5.571415048418967, -0.4564250892539654, -251.14351220785082, -6.634067908367288, -467.6007590601181, -8.083689904840723, 11.240868877376396, 9.461328082984197, 1.020358192725444, 15.503555248811839, 61.631234379919576, -265.9281918773124, -394.39750022927205, -27.341063160681266, -126.59193998186794, -152.54842405874413, -157.14405014617014, -46.476310759956476, -11.575372887750703, -220.00245044312436, -96.53293689305411, 112.80195951550859, 331.9377088161812, -85.61006054123496, -374.98189260638054, -65.28456193503908, 25.291729387741757, -119.81766766345422, -175.31859710634728, -324.09972503677244, -4.255990914218188, 374.0816862084281, -560.7227787456584, 121.52474980554992, 123.94904500295446, -170.76154770102582, 57.47304393598268, 224.9702103559687, -363.50591345697393, 346.9802233666758, 292.0181850492299, -35.40212220662944, -94.2531207882587, 94.69299129610812, 156.5240748851801, -34.07807583658957, 249.10949242860588, -380.98058529750534, 305.89964573944263, -106.17890750494192, 291.9705367724061], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-124.3458985890451, -113.78198818619575, -91.76618080414363, 0.4749940584120211, -264.4230748466959, -357.0365434029908, -290.88710666065134, -61.35783821665841, -102.68144500521193, -14.73819244442784, -192.9212354937591, -2.062734924411883, -7.268026241196964, -135.38246513395367, -426.5275898257512, -68.47307928670686, -3.00962087128673, -234.59088918414972, 45.196744488699494, 84.13901522662893, -21.53572528318963, -283.3355764941005, -6.14627809666271, -49.06592163796576, -270.39155653898973, -198.55750200535215, -34.595080284921, -171.28743578449124, 13.09939899351965, -284.16138445373474, -29.113809756778046, 124.00556171414257, 5.480695861709396, -385.82170974728695, -157.26923770946013, -189.66014107395412, -31.48358934529658, 13.55258072554823, -224.2438317941641, -43.86308532132445, -6.351782983436429, -220.6375458864406, -210.05111884999698, 62.09454991823162, -19.729293334262646, -83.97679045455004, -150.5355805807975, -20.59707036246254, -0.6953177441181764, -194.55157732116422, -242.43624584868482, -92.28067164739802, 43.022044647882524, -220.3099743839674, -9.284352855463993, -262.1329605598911, -127.32688401807516, -5.659923322195355, -115.41536360923726, -187.9812435838792, -62.411735789356456, -42.41923081586219, -212.81862633317905, -45.44731009187223, -40.929959063598034, -26.554740806205142, -100.34595999249765, -171.302985479017, -262.5484946334451, -54.10494179324339, -583.249760229908, -554.98781909085, -168.9351202982773, -1.3353148796321979, -141.2660982637988, -35.909668674868826, -291.3481356309065, -59.4569273241444, -26.630658283577706, -98.09078688685013, 12.188971728417052, -88.78610014040997, -97.86049926257047, -314.5368743278998, -16.961360299101223, -62.04635679495185, 1.9937094162359374, -169.2670166464497, -113.70219222459184, -205.90887800668793, -578.8663256537466, -349.1898669592577, -148.01591515773293, 2.0000000000000013, -96.55811730132224, -100.3356453418611, -284.5264080399959, -113.67170908455827, -337.52768136344747, -389.37281255517075, -223.3769523928357, -78.15875751112263, -506.1529634477977, -474.19362886317083, -365.6045593838691, -193.63405802633886, -597.8296027270205, -627.4817077480404, -234.1389921595249, -291.63317273428555, -212.3985635374485, -257.9457794423819, -134.24920094004185, -55.90267632785678, -59.24688186167363, -15.572247093708036, -73.6384835646236, -3.876273887084256, -42.912089425569185, -259.4941041178575, -366.51186575031056, -496.8798615896679, -1261.9229510421615, -1074.8888252644956, -181.0018635306659, -569.3617813548996, -508.5392737286124, -386.6295358845643, -313.59861712640327, -224.2116067655083, -1002.1479613196299, -880.6889323450727, -956.5567075530407, -649.0464087722673, -551.7578604775829, -825.3236058420031, -439.3508731613362, -406.2608375333851, -419.87715883536873, -507.5892990784083, -722.3371204985364, -531.5234520448613, -110.38133698129538, -691.9642889386545, -401.74338485874836, -358.7588352559218, -602.9006044292719, -595.7920719576365, -533.9826979111153, -612.0108487437767, -668.8365896130383, -996.7702276277334, -602.5570729784877, -345.2154232265126, -525.2468051320984, -577.6721406937668, -648.6944442991255, -756.5428514171828, -1060.767361479062, -1118.8950483627636, -1079.5209937379195, -292.6554376152067, -831.9427655428887, -835.0838994970046, -112.2854177453307, -548.1960237265482, -919.8435726710544, -659.6036562391686, -847.3614216915245, -647.392026336985, -462.0368673456144, -913.9902314939653, -769.0737900359021, -1112.0275307584736, -509.4350094302807, -683.4170905051751, -808.2028343694853, -401.8495910763736, -828.1081663825299, -503.84127472456726, -810.3456721183617, -1001.2022224088686, -819.050463333264, -732.8371635206089, -441.8647855249527, -392.8312970120631, -721.1900015145102, -1138.1341237864717, -674.2047447497401, -821.0423450327103, -958.8070610813152, -280.110799390389, -746.9325780352342, -578.9008434796241, -710.849845042925, -360.72599340198417, -617.4317780460915, -540.8885349174462, -385.1830455601118, -917.1139578817484], "policy_predator_policy_reward": [203.50989936180565, 46.04028939777868, 72.02154700985761, 76.06653806361909, 351.3869030509695, 214.02009869525625, 184.03310350676395, 277.1459766690829, 59.10311105924002, 176.57141741405724, 223.48812928192328, 78.45001478786125, 58.44635402733364, 175.16693356798044, 426.94758982575115, 123.9930792867069, 238.12680201454845, 88.05513007220442, 83.51378222416811, 4.450458060503474, 249.15860490754892, 146.73102000790746, 2.391737117553159, 62.25046261707501, 376.52657650642794, 122.12432857209322, 83.32577207737509, 151.06137527725105, 50.349134694203784, 289.08484996510816, 20.98359430875478, 80.89886019139857, 281.923578308156, 305.000916860907, 219.07628053256767, 200.013769495169, 97.81556673142741, 58.900202626210714, 106.51594260880336, 263.5355503818581, 140.93164315443124, 159.9050270494351, 197.89950912949678, 93.8060152818813, 57.171645194424784, 94.09189499614602, 140.94775420161307, 96.49283537136333, 92.59369653430831, 124.46525793436106, 241.32473064239377, 50.10285629541679, 202.00303323390446, 59.33328488562914, 103.79187610962398, 241.9354253143245, 72.55949034321382, 101.29270320743858, 214.29767473064862, 160.74881148303405, 67.89940766866229, 76.9914424715684, 82.53328898253163, 210.25200798268187, 41.982698333070175, 15.398170842050725, 147.34559399403102, 145.01363191516305, 268.7090626318572, 88.91203177569963, 742.9264962541547, 0.0, 86.05241247533085, 161.4399460329671, 137.63111639813548, 75.25796976323329, 139.34899292326833, 295.83869520782486, 100.76291141334099, 30.48027730566321, 39.041028271582924, 90.42610014041081, 256.6593416877409, 248.62790602682523, 92.45162299186472, 59.18198163601175, 109.94147524846645, 153.64897377931558, 161.6486571726997, 174.54655521121424, 122.76749223324882, 599.9222542244115, 61.054692088819706, 125.24763002578736, 133.6309377179467, 138.80090603968125, 32.157141872344674, 300.91710727234727, 420.309375939903, 312.16253302713415, 220.74246552012363, 80.33681929458137, 226.86401770891825, 502.33906239419997, 299.93498328488647, 252.66956621695394, 0.0, 757.7105514149423, 350.80991258499904, 166.87856240396974, 249.61731593359167, 231.9678959236132, 128.50096432797937, 71.11224102290247, 23.14514770285859, 52.69433944524823, 76.11540243387988, 16.90291026664036, 250.38838936019138, 113.64903856315406, 2.2511007033395796, 595.2124347593268, 1162.3948000170499, 780.0194760603354, 546.895047284129, 176.1275344407544, 628.1698806122689, 140.40698901904028, 8.012110542736446, 377.2496892904304, 737.8945841516312, 987.7982593669008, 1008.681765935656, 550.4450396296954, 559.9865583368262, 805.5195350950088, 575.2029598145449, 50.40630043705267, 442.24228472581405, 388.69123629490906, 785.6602559666934, 581.0022760922127, 549.9909013702431, 584.2924333658887, 396.2569367464253, 278.63522282701035, 777.2630886439484, 46.447695136579156, 595.5473901597018, 485.1615945601513, 924.6507759823586, 766.2477706461553, 655.5734094069716, 172.38141913457417, 444.16652962359325, 483.43381909592466, 926.518904972, 154.6186657075362, 1119.0887085434208, 1056.3177103841865, 846.2037078366038, 900.0544097249515, 25.59503673721011, 1080.708849557024, 379.5220552540382, 402.4841360233909, 813.4135845482479, 889.9826893649298, 951.3474065170668, 372.6444938104163, 515.4045307400845, 918.095612035478, 1065.9657549713497, 1040.105776178995, 742.3880774347533, 86.9581090437288, 773.6570694979772, 783.3755793145577, 834.2814359035611, 789.6861902527662, 879.6500128869684, 896.4957594336324, 712.4719882590853, 745.1625178065293, 546.778747435185, 382.6103263979394, 991.083721036146, 1024.764479150016, 598.650851296542, 862.518162649319, 865.155829099698, 622.8715238006114, 837.8520875525428, 107.00074866480986, 635.6586405553363, 741.8168436290148, 309.7617530727819, 742.3796523858143, 898.8333610079283, 695.4341792063385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7956923511616744, "mean_inference_ms": 2.550079275774379, "mean_action_processing_ms": 0.3597740647603463, "mean_env_wait_ms": 0.2911448550057466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00442957878112793, "StateBufferConnector_ms": 0.00935971736907959, "ViewRequirementAgentConnector_ms": 0.2106478214263916}, "num_episodes": 22, "episode_return_max": 374.0816862084281, "episode_return_min": -560.7227787456584, "episode_return_mean": 5.204754601033357, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.3361592645921, "num_env_steps_trained_throughput_per_sec": 227.3361592645921, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 16007.422, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16007.368, "sample_time_ms": 2205.873, "learn_time_ms": 13770.873, "learn_throughput": 290.468, "synch_weights_time_ms": 27.89}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "6c58f_00000", "date": "2024-08-16_16-18-34", "timestamp": 1723805314, "time_this_iter_s": 17.700841426849365, "time_total_s": 697.6028068065643, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0424ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 697.6028068065643, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 71.86, "ram_util_percent": 82.456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2319055871042626, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 9.542890178841889, "policy_loss": -0.0029182190723500397, "vf_loss": 9.545015148889451, "vf_explained_var": 0.0016587213549033675, "kl": 0.005571206446998863, "entropy": 1.461160610907923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8361899357308786, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 9.322843516314471, "policy_loss": -0.008927819080818345, "vf_loss": 9.331692532130651, "vf_explained_var": 0.02188631737673724, "kl": 0.01261017361855828, "entropy": 1.4606134344661046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 582.7095850833052, "episode_reward_min": -560.7227787456584, "episode_reward_mean": 44.596808650889216, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1261.9229510421615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 110.99405094671036, "predator_policy": 1164.9063642451674}, "policy_reward_mean": {"prey_policy": -427.27213203570733, "predator_policy": 449.5705363611519}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.3079386297161, 21.81205940338808, -43.28933055827222, 84.0483883834496, 74.3099880085937, 40.86538621038135, 71.64987902056652, 40.0598835350121, 34.51936054016309, -10.103830694682253, 20.710280437678733, 40.967657980869085, -395.3110830666049, 77.22192333038868, 35.71331922270177, 84.38262517604304, 6.521743548575477, 52.869999999999514, 92.88987412409543, 72.62588753382408, 96.31714179757066, 16.58414215263442, -205.36644615534382, 40.28640695687451, 75.5380811144445, -65.12386797986208, 5.571415048418967, -0.4564250892539654, -251.14351220785082, -6.634067908367288, -467.6007590601181, -8.083689904840723, 11.240868877376396, 9.461328082984197, 1.020358192725444, 15.503555248811839, 61.631234379919576, -265.9281918773124, -394.39750022927205, -27.341063160681266, -126.59193998186794, -152.54842405874413, -157.14405014617014, -46.476310759956476, -11.575372887750703, -220.00245044312436, -96.53293689305411, 112.80195951550859, 331.9377088161812, -85.61006054123496, -374.98189260638054, -65.28456193503908, 25.291729387741757, -119.81766766345422, -175.31859710634728, -324.09972503677244, -4.255990914218188, 374.0816862084281, -560.7227787456584, 121.52474980554992, 123.94904500295446, -170.76154770102582, 57.47304393598268, 224.9702103559687, -363.50591345697393, 346.9802233666758, 292.0181850492299, -35.40212220662944, -94.2531207882587, 94.69299129610812, 156.5240748851801, -34.07807583658957, 249.10949242860588, -380.98058529750534, 305.89964573944263, -106.17890750494192, 291.9705367724061, 99.01439598332236, 73.5799688391837, 238.93394388865926, 137.02492858834827, 404.55260305951396, 369.0989238716631, 582.7095850833052, 3.8649991424090295, 99.8813052253768, 155.51231020316013, 423.90215679401535, 13.484435932119297, 276.61524738478033, 445.0131856479421, 107.22588146083397, 292.61264039311516, 372.1858440719304, 252.0807890063937, 197.0126464258181, 393.9531906993413, 364.009155733224, 508.0150224378055, 136.44449611764986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-150.5355805807975, -20.59707036246254, -0.6953177441181764, -194.55157732116422, -242.43624584868482, -92.28067164739802, 43.022044647882524, -220.3099743839674, -9.284352855463993, -262.1329605598911, -127.32688401807516, -5.659923322195355, -115.41536360923726, -187.9812435838792, -62.411735789356456, -42.41923081586219, -212.81862633317905, -45.44731009187223, -40.929959063598034, -26.554740806205142, -100.34595999249765, -171.302985479017, -262.5484946334451, -54.10494179324339, -583.249760229908, -554.98781909085, -168.9351202982773, -1.3353148796321979, -141.2660982637988, -35.909668674868826, -291.3481356309065, -59.4569273241444, -26.630658283577706, -98.09078688685013, 12.188971728417052, -88.78610014040997, -97.86049926257047, -314.5368743278998, -16.961360299101223, -62.04635679495185, 1.9937094162359374, -169.2670166464497, -113.70219222459184, -205.90887800668793, -578.8663256537466, -349.1898669592577, -148.01591515773293, 2.0000000000000013, -96.55811730132224, -100.3356453418611, -284.5264080399959, -113.67170908455827, -337.52768136344747, -389.37281255517075, -223.3769523928357, -78.15875751112263, -506.1529634477977, -474.19362886317083, -365.6045593838691, -193.63405802633886, -597.8296027270205, -627.4817077480404, -234.1389921595249, -291.63317273428555, -212.3985635374485, -257.9457794423819, -134.24920094004185, -55.90267632785678, -59.24688186167363, -15.572247093708036, -73.6384835646236, -3.876273887084256, -42.912089425569185, -259.4941041178575, -366.51186575031056, -496.8798615896679, -1261.9229510421615, -1074.8888252644956, -181.0018635306659, -569.3617813548996, -508.5392737286124, -386.6295358845643, -313.59861712640327, -224.2116067655083, -1002.1479613196299, -880.6889323450727, -956.5567075530407, -649.0464087722673, -551.7578604775829, -825.3236058420031, -439.3508731613362, -406.2608375333851, -419.87715883536873, -507.5892990784083, -722.3371204985364, -531.5234520448613, -110.38133698129538, -691.9642889386545, -401.74338485874836, -358.7588352559218, -602.9006044292719, -595.7920719576365, -533.9826979111153, -612.0108487437767, -668.8365896130383, -996.7702276277334, -602.5570729784877, -345.2154232265126, -525.2468051320984, -577.6721406937668, -648.6944442991255, -756.5428514171828, -1060.767361479062, -1118.8950483627636, -1079.5209937379195, -292.6554376152067, -831.9427655428887, -835.0838994970046, -112.2854177453307, -548.1960237265482, -919.8435726710544, -659.6036562391686, -847.3614216915245, -647.392026336985, -462.0368673456144, -913.9902314939653, -769.0737900359021, -1112.0275307584736, -509.4350094302807, -683.4170905051751, -808.2028343694853, -401.8495910763736, -828.1081663825299, -503.84127472456726, -810.3456721183617, -1001.2022224088686, -819.050463333264, -732.8371635206089, -441.8647855249527, -392.8312970120631, -721.1900015145102, -1138.1341237864717, -674.2047447497401, -821.0423450327103, -958.8070610813152, -280.110799390389, -746.9325780352342, -578.9008434796241, -710.849845042925, -360.72599340198417, -617.4317780460915, -540.8885349174462, -385.1830455601118, -917.1139578817484, -301.362698017635, -43.839500198026364, -17.567439616918882, -6.563367526687729, -503.35092618016273, -310.68285132820614, -408.6284372733701, -578.6870783442778, 68.53184572814695, -504.8422808367049, -17.762013241380707, -834.4953825062648, 110.99405094671036, -762.9739314210976, -826.7362099642796, -492.4477489968603, -953.1280591223256, -1004.1951209146674, -518.9817186122289, -271.1038152082442, 4.7162130833169424, -735.0454341520442, -672.3110398940344, -543.001605566914, -839.2392550295167, -483.65503059553396, 2.0000000000000013, -743.2414465524687, -734.6779424361457, -591.4456529877274, -658.6671082803513, 25.31886091466961, -367.4345166748916, -958.7175996689022, -478.093359733153, -859.7557114210971, -234.62968807042697, -745.989071407316, -856.1764103220661, -161.27957539810293, -56.09596293582699, -989.4484091575357, -25.513861906244372, -857.5051972748804, -23.50693965653044, -68.28352045596925], "policy_predator_policy_reward": [140.94775420161307, 96.49283537136333, 92.59369653430831, 124.46525793436106, 241.32473064239377, 50.10285629541679, 202.00303323390446, 59.33328488562914, 103.79187610962398, 241.9354253143245, 72.55949034321382, 101.29270320743858, 214.29767473064862, 160.74881148303405, 67.89940766866229, 76.9914424715684, 82.53328898253163, 210.25200798268187, 41.982698333070175, 15.398170842050725, 147.34559399403102, 145.01363191516305, 268.7090626318572, 88.91203177569963, 742.9264962541547, 0.0, 86.05241247533085, 161.4399460329671, 137.63111639813548, 75.25796976323329, 139.34899292326833, 295.83869520782486, 100.76291141334099, 30.48027730566321, 39.041028271582924, 90.42610014041081, 256.6593416877409, 248.62790602682523, 92.45162299186472, 59.18198163601175, 109.94147524846645, 153.64897377931558, 161.6486571726997, 174.54655521121424, 122.76749223324882, 599.9222542244115, 61.054692088819706, 125.24763002578736, 133.6309377179467, 138.80090603968125, 32.157141872344674, 300.91710727234727, 420.309375939903, 312.16253302713415, 220.74246552012363, 80.33681929458137, 226.86401770891825, 502.33906239419997, 299.93498328488647, 252.66956621695394, 0.0, 757.7105514149423, 350.80991258499904, 166.87856240396974, 249.61731593359167, 231.9678959236132, 128.50096432797937, 71.11224102290247, 23.14514770285859, 52.69433944524823, 76.11540243387988, 16.90291026664036, 250.38838936019138, 113.64903856315406, 2.2511007033395796, 595.2124347593268, 1162.3948000170499, 780.0194760603354, 546.895047284129, 176.1275344407544, 628.1698806122689, 140.40698901904028, 8.012110542736446, 377.2496892904304, 737.8945841516312, 987.7982593669008, 1008.681765935656, 550.4450396296954, 559.9865583368262, 805.5195350950088, 575.2029598145449, 50.40630043705267, 442.24228472581405, 388.69123629490906, 785.6602559666934, 581.0022760922127, 549.9909013702431, 584.2924333658887, 396.2569367464253, 278.63522282701035, 777.2630886439484, 46.447695136579156, 595.5473901597018, 485.1615945601513, 924.6507759823586, 766.2477706461553, 655.5734094069716, 172.38141913457417, 444.16652962359325, 483.43381909592466, 926.518904972, 154.6186657075362, 1119.0887085434208, 1056.3177103841865, 846.2037078366038, 900.0544097249515, 25.59503673721011, 1080.708849557024, 379.5220552540382, 402.4841360233909, 813.4135845482479, 889.9826893649298, 951.3474065170668, 372.6444938104163, 515.4045307400845, 918.095612035478, 1065.9657549713497, 1040.105776178995, 742.3880774347533, 86.9581090437288, 773.6570694979772, 783.3755793145577, 834.2814359035611, 789.6861902527662, 879.6500128869684, 896.4957594336324, 712.4719882590853, 745.1625178065293, 546.778747435185, 382.6103263979394, 991.083721036146, 1024.764479150016, 598.650851296542, 862.518162649319, 865.155829099698, 622.8715238006114, 837.8520875525428, 107.00074866480986, 635.6586405553363, 741.8168436290148, 309.7617530727819, 742.3796523858143, 898.8333610079283, 695.4341792063385, 275.51599748360206, 168.7005967153817, 25.14599216756841, 72.56478381522197, 463.25332785364776, 589.7143935433805, 551.4604446255305, 572.8799995804657, 458.35019148289894, 382.51284668517314, 561.645558134005, 659.7107614853038, 624.1638959606272, 610.5255695970656, 644.1341445945235, 678.9148135090239, 1164.9063642451674, 892.298121017202, 505.21244074010764, 440.385403283525, 519.5687540314278, 634.6626238313152, 571.5399132084018, 657.257168184666, 735.329497345425, 864.1800356644062, 590.3592156364892, 595.8954165639227, 676.2548139206318, 757.0946629640753, 595.6805409260103, 330.2803468327872, 765.9909437343799, 932.3470166813453, 731.5446650544402, 858.3851951062034, 478.0206405104574, 699.6107653931036, 744.4127528884742, 666.9964235310368, 570.1210576118609, 839.4324702147262, 700.7259198206455, 690.3081617982865, 139.76206609853722, 88.4728901316124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8069446487533648, "mean_inference_ms": 2.585914497561293, "mean_action_processing_ms": 0.3636474828112737, "mean_env_wait_ms": 0.2963067439425345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012562155723571777, "StateBufferConnector_ms": 0.008041977882385254, "ViewRequirementAgentConnector_ms": 0.26114964485168457}, "num_episodes": 23, "episode_return_max": 582.7095850833052, "episode_return_min": -560.7227787456584, "episode_return_mean": 44.596808650889216, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.44444982458572, "num_env_steps_trained_throughput_per_sec": 243.44444982458572, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 16060.921, "restore_workers_time_ms": 0.019, "training_step_time_ms": 16060.868, "sample_time_ms": 2393.507, "learn_time_ms": 13638.793, "learn_throughput": 293.281, "synch_weights_time_ms": 26.85}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "6c58f_00000", "date": "2024-08-16_16-18-51", "timestamp": 1723805331, "time_this_iter_s": 16.49618101119995, "time_total_s": 714.0989878177643, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b053e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 714.0989878177643, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.7, "ram_util_percent": 81.98260869565217}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8023624259801139, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.202966690315772, "policy_loss": -0.0030927744038678983, "vf_loss": 7.2047024363563175, "vf_explained_var": 0.0004739040735537413, "kl": 0.009530901093150863, "entropy": 1.4615360824519363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9622066959502205, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.359606555151561, "policy_loss": -0.009923162301953035, "vf_loss": 8.369426771194215, "vf_explained_var": 0.028323758783794586, "kl": 0.016474230012313264, "entropy": 1.4628300311073423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 582.7095850833052, "episode_reward_min": -560.7227787456584, "episode_reward_mean": 79.47522991182623, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1261.9229510421615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 110.99405094671036, "predator_policy": 1164.9063642451674}, "policy_reward_mean": {"prey_policy": -444.6359199311951, "predator_policy": 484.37353488710835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.88987412409543, 72.62588753382408, 96.31714179757066, 16.58414215263442, -205.36644615534382, 40.28640695687451, 75.5380811144445, -65.12386797986208, 5.571415048418967, -0.4564250892539654, -251.14351220785082, -6.634067908367288, -467.6007590601181, -8.083689904840723, 11.240868877376396, 9.461328082984197, 1.020358192725444, 15.503555248811839, 61.631234379919576, -265.9281918773124, -394.39750022927205, -27.341063160681266, -126.59193998186794, -152.54842405874413, -157.14405014617014, -46.476310759956476, -11.575372887750703, -220.00245044312436, -96.53293689305411, 112.80195951550859, 331.9377088161812, -85.61006054123496, -374.98189260638054, -65.28456193503908, 25.291729387741757, -119.81766766345422, -175.31859710634728, -324.09972503677244, -4.255990914218188, 374.0816862084281, -560.7227787456584, 121.52474980554992, 123.94904500295446, -170.76154770102582, 57.47304393598268, 224.9702103559687, -363.50591345697393, 346.9802233666758, 292.0181850492299, -35.40212220662944, -94.2531207882587, 94.69299129610812, 156.5240748851801, -34.07807583658957, 249.10949242860588, -380.98058529750534, 305.89964573944263, -106.17890750494192, 291.9705367724061, 99.01439598332236, 73.5799688391837, 238.93394388865926, 137.02492858834827, 404.55260305951396, 369.0989238716631, 582.7095850833052, 3.8649991424090295, 99.8813052253768, 155.51231020316013, 423.90215679401535, 13.484435932119297, 276.61524738478033, 445.0131856479421, 107.22588146083397, 292.61264039311516, 372.1858440719304, 252.0807890063937, 197.0126464258181, 393.9531906993413, 364.009155733224, 508.0150224378055, 136.44449611764986, 353.0157513420814, 314.3132314489896, 153.3343146904187, 150.29136348751376, 151.62580706179705, 323.2394765263783, 291.1609354699519, 94.72228107255431, 60.49012310060131, 335.0351327638329, 189.480633797688, 523.3081784429147, 58.79903969010713, 157.47000000000025, 76.3752186329028, 199.05890756607948, 94.90019074882589, 264.4777293590318], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.86049926257047, -314.5368743278998, -16.961360299101223, -62.04635679495185, 1.9937094162359374, -169.2670166464497, -113.70219222459184, -205.90887800668793, -578.8663256537466, -349.1898669592577, -148.01591515773293, 2.0000000000000013, -96.55811730132224, -100.3356453418611, -284.5264080399959, -113.67170908455827, -337.52768136344747, -389.37281255517075, -223.3769523928357, -78.15875751112263, -506.1529634477977, -474.19362886317083, -365.6045593838691, -193.63405802633886, -597.8296027270205, -627.4817077480404, -234.1389921595249, -291.63317273428555, -212.3985635374485, -257.9457794423819, -134.24920094004185, -55.90267632785678, -59.24688186167363, -15.572247093708036, -73.6384835646236, -3.876273887084256, -42.912089425569185, -259.4941041178575, -366.51186575031056, -496.8798615896679, -1261.9229510421615, -1074.8888252644956, -181.0018635306659, -569.3617813548996, -508.5392737286124, -386.6295358845643, -313.59861712640327, -224.2116067655083, -1002.1479613196299, -880.6889323450727, -956.5567075530407, -649.0464087722673, -551.7578604775829, -825.3236058420031, -439.3508731613362, -406.2608375333851, -419.87715883536873, -507.5892990784083, -722.3371204985364, -531.5234520448613, -110.38133698129538, -691.9642889386545, -401.74338485874836, -358.7588352559218, -602.9006044292719, -595.7920719576365, -533.9826979111153, -612.0108487437767, -668.8365896130383, -996.7702276277334, -602.5570729784877, -345.2154232265126, -525.2468051320984, -577.6721406937668, -648.6944442991255, -756.5428514171828, -1060.767361479062, -1118.8950483627636, -1079.5209937379195, -292.6554376152067, -831.9427655428887, -835.0838994970046, -112.2854177453307, -548.1960237265482, -919.8435726710544, -659.6036562391686, -847.3614216915245, -647.392026336985, -462.0368673456144, -913.9902314939653, -769.0737900359021, -1112.0275307584736, -509.4350094302807, -683.4170905051751, -808.2028343694853, -401.8495910763736, -828.1081663825299, -503.84127472456726, -810.3456721183617, -1001.2022224088686, -819.050463333264, -732.8371635206089, -441.8647855249527, -392.8312970120631, -721.1900015145102, -1138.1341237864717, -674.2047447497401, -821.0423450327103, -958.8070610813152, -280.110799390389, -746.9325780352342, -578.9008434796241, -710.849845042925, -360.72599340198417, -617.4317780460915, -540.8885349174462, -385.1830455601118, -917.1139578817484, -301.362698017635, -43.839500198026364, -17.567439616918882, -6.563367526687729, -503.35092618016273, -310.68285132820614, -408.6284372733701, -578.6870783442778, 68.53184572814695, -504.8422808367049, -17.762013241380707, -834.4953825062648, 110.99405094671036, -762.9739314210976, -826.7362099642796, -492.4477489968603, -953.1280591223256, -1004.1951209146674, -518.9817186122289, -271.1038152082442, 4.7162130833169424, -735.0454341520442, -672.3110398940344, -543.001605566914, -839.2392550295167, -483.65503059553396, 2.0000000000000013, -743.2414465524687, -734.6779424361457, -591.4456529877274, -658.6671082803513, 25.31886091466961, -367.4345166748916, -958.7175996689022, -478.093359733153, -859.7557114210971, -234.62968807042697, -745.989071407316, -856.1764103220661, -161.27957539810293, -56.09596293582699, -989.4484091575357, -25.513861906244372, -857.5051972748804, -23.50693965653044, -68.28352045596925, -816.7076865529594, 2.309247091025149, -16.323612832273266, -596.2653297214863, 11.14587554414837, 23.97025590403841, -385.709331017838, -415.26894164904195, 7.613151857811179, -264.09790390812583, -2.209994336124428, -707.431962475806, -556.1935553897199, 17.602319634213252, -55.17428937120046, -60.85064222866717, -20.451767784948395, -126.05857246359122, -736.1487981802708, -44.25843164558249, -596.0118528028547, -119.07629277419787, -152.27470698925478, -992.1985314157761, -353.8535019938212, -275.0652240729174, -41.68100269417153, 57.46924766309557, -31.49499552354487, -49.22500757806735, -269.46079207000815, 47.90156851868561, -118.8791496529341, 3.1458333760969506, 34.98133549998173, -519.4010610240149], "policy_predator_policy_reward": [256.6593416877409, 248.62790602682523, 92.45162299186472, 59.18198163601175, 109.94147524846645, 153.64897377931558, 161.6486571726997, 174.54655521121424, 122.76749223324882, 599.9222542244115, 61.054692088819706, 125.24763002578736, 133.6309377179467, 138.80090603968125, 32.157141872344674, 300.91710727234727, 420.309375939903, 312.16253302713415, 220.74246552012363, 80.33681929458137, 226.86401770891825, 502.33906239419997, 299.93498328488647, 252.66956621695394, 0.0, 757.7105514149423, 350.80991258499904, 166.87856240396974, 249.61731593359167, 231.9678959236132, 128.50096432797937, 71.11224102290247, 23.14514770285859, 52.69433944524823, 76.11540243387988, 16.90291026664036, 250.38838936019138, 113.64903856315406, 2.2511007033395796, 595.2124347593268, 1162.3948000170499, 780.0194760603354, 546.895047284129, 176.1275344407544, 628.1698806122689, 140.40698901904028, 8.012110542736446, 377.2496892904304, 737.8945841516312, 987.7982593669008, 1008.681765935656, 550.4450396296954, 559.9865583368262, 805.5195350950088, 575.2029598145449, 50.40630043705267, 442.24228472581405, 388.69123629490906, 785.6602559666934, 581.0022760922127, 549.9909013702431, 584.2924333658887, 396.2569367464253, 278.63522282701035, 777.2630886439484, 46.447695136579156, 595.5473901597018, 485.1615945601513, 924.6507759823586, 766.2477706461553, 655.5734094069716, 172.38141913457417, 444.16652962359325, 483.43381909592466, 926.518904972, 154.6186657075362, 1119.0887085434208, 1056.3177103841865, 846.2037078366038, 900.0544097249515, 25.59503673721011, 1080.708849557024, 379.5220552540382, 402.4841360233909, 813.4135845482479, 889.9826893649298, 951.3474065170668, 372.6444938104163, 515.4045307400845, 918.095612035478, 1065.9657549713497, 1040.105776178995, 742.3880774347533, 86.9581090437288, 773.6570694979772, 783.3755793145577, 834.2814359035611, 789.6861902527662, 879.6500128869684, 896.4957594336324, 712.4719882590853, 745.1625178065293, 546.778747435185, 382.6103263979394, 991.083721036146, 1024.764479150016, 598.650851296542, 862.518162649319, 865.155829099698, 622.8715238006114, 837.8520875525428, 107.00074866480986, 635.6586405553363, 741.8168436290148, 309.7617530727819, 742.3796523858143, 898.8333610079283, 695.4341792063385, 275.51599748360206, 168.7005967153817, 25.14599216756841, 72.56478381522197, 463.25332785364776, 589.7143935433805, 551.4604446255305, 572.8799995804657, 458.35019148289894, 382.51284668517314, 561.645558134005, 659.7107614853038, 624.1638959606272, 610.5255695970656, 644.1341445945235, 678.9148135090239, 1164.9063642451674, 892.298121017202, 505.21244074010764, 440.385403283525, 519.5687540314278, 634.6626238313152, 571.5399132084018, 657.257168184666, 735.329497345425, 864.1800356644062, 590.3592156364892, 595.8954165639227, 676.2548139206318, 757.0946629640753, 595.6805409260103, 330.2803468327872, 765.9909437343799, 932.3470166813453, 731.5446650544402, 858.3851951062034, 478.0206405104574, 699.6107653931036, 744.4127528884742, 666.9964235310368, 570.1210576118609, 839.4324702147262, 700.7259198206455, 690.3081617982865, 139.76206609853722, 88.4728901316124, 732.6151358247395, 434.79905497927626, 431.67205977834357, 495.23011422440607, 115.11632056672852, 3.1018626755035585, 409.1443657751154, 542.125270379277, 190.83957142954017, 217.2709876825714, 504.9211343232175, 527.9602990150922, 466.377386572573, 363.37478465288507, 50.28162531900438, 160.46558735341824, 103.50914119357942, 103.49132215556236, 581.4166467967095, 534.0257157929783, 565.5345604595001, 339.0342189152412, 735.6185336724507, 932.1628831754954, 290.59191473728373, 397.12585101956205, 66.56412725905534, 75.1176277720209, 102.07314883735408, 55.02207289716095, 229.14438093005575, 191.4737501873464, 105.8177312881896, 104.81577573747317, 336.04192246998036, 412.85553241308554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8151148863854882, "mean_inference_ms": 2.614013106709475, "mean_action_processing_ms": 0.3666913375804072, "mean_env_wait_ms": 0.30027410974473656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013397812843322754, "StateBufferConnector_ms": 0.008067488670349121, "ViewRequirementAgentConnector_ms": 0.2610785961151123}, "num_episodes": 18, "episode_return_max": 582.7095850833052, "episode_return_min": -560.7227787456584, "episode_return_mean": 79.47522991182623, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.3217016446069, "num_env_steps_trained_throughput_per_sec": 280.3217016446069, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 15926.345, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15926.29, "sample_time_ms": 2392.502, "learn_time_ms": 13503.211, "learn_throughput": 296.226, "synch_weights_time_ms": 28.928}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "6c58f_00000", "date": "2024-08-16_16-19-05", "timestamp": 1723805345, "time_this_iter_s": 14.327339172363281, "time_total_s": 728.4263269901276, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05028b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.4263269901276, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 62.4952380952381, "ram_util_percent": 81.43809523809523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.010236327436866, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.0001669611880386, "policy_loss": -0.004897389507473067, "vf_loss": 2.0041494039946763, "vf_explained_var": -0.011271513265276712, "kl": 0.006425955986974202, "entropy": 1.5049253261278546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.242183985092022, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 6.568915151162122, "policy_loss": -0.0028824095821215045, "vf_loss": 6.571712093756943, "vf_explained_var": 0.10100038266055798, "kl": 0.013673683025460594, "entropy": 1.45940210522798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 582.7095850833052, "episode_reward_min": -560.7227787456584, "episode_reward_mean": 106.33376359357537, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1261.9229510421615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 128.7200000000002, "predator_policy": 1164.9063642451674}, "policy_reward_mean": {"prey_policy": -408.82237794817496, "predator_policy": 461.9892597449627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.631234379919576, -265.9281918773124, -394.39750022927205, -27.341063160681266, -126.59193998186794, -152.54842405874413, -157.14405014617014, -46.476310759956476, -11.575372887750703, -220.00245044312436, -96.53293689305411, 112.80195951550859, 331.9377088161812, -85.61006054123496, -374.98189260638054, -65.28456193503908, 25.291729387741757, -119.81766766345422, -175.31859710634728, -324.09972503677244, -4.255990914218188, 374.0816862084281, -560.7227787456584, 121.52474980554992, 123.94904500295446, -170.76154770102582, 57.47304393598268, 224.9702103559687, -363.50591345697393, 346.9802233666758, 292.0181850492299, -35.40212220662944, -94.2531207882587, 94.69299129610812, 156.5240748851801, -34.07807583658957, 249.10949242860588, -380.98058529750534, 305.89964573944263, -106.17890750494192, 291.9705367724061, 99.01439598332236, 73.5799688391837, 238.93394388865926, 137.02492858834827, 404.55260305951396, 369.0989238716631, 582.7095850833052, 3.8649991424090295, 99.8813052253768, 155.51231020316013, 423.90215679401535, 13.484435932119297, 276.61524738478033, 445.0131856479421, 107.22588146083397, 292.61264039311516, 372.1858440719304, 252.0807890063937, 197.0126464258181, 393.9531906993413, 364.009155733224, 508.0150224378055, 136.44449611764986, 353.0157513420814, 314.3132314489896, 153.3343146904187, 150.29136348751376, 151.62580706179705, 323.2394765263783, 291.1609354699519, 94.72228107255431, 60.49012310060131, 335.0351327638329, 189.480633797688, 523.3081784429147, 58.79903969010713, 157.47000000000025, 76.3752186329028, 199.05890756607948, 94.90019074882589, 264.4777293590318, 76.0499999999999, 37.10999999999965, 89.9499999999997, 93.23000000000044, 55.63082266267399, 30.390000000000374, 307.8879284542428, 221.41999999999967, 130.31000000000063, 113.11000000000058, 195.99728463387453, 30.460000000000395, 107.37473444920084, 184.75817543178505, 71.72000000000017, 67.84471336725765, 125.50000000000051, 179.74000000000046], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.912089425569185, -259.4941041178575, -366.51186575031056, -496.8798615896679, -1261.9229510421615, -1074.8888252644956, -181.0018635306659, -569.3617813548996, -508.5392737286124, -386.6295358845643, -313.59861712640327, -224.2116067655083, -1002.1479613196299, -880.6889323450727, -956.5567075530407, -649.0464087722673, -551.7578604775829, -825.3236058420031, -439.3508731613362, -406.2608375333851, -419.87715883536873, -507.5892990784083, -722.3371204985364, -531.5234520448613, -110.38133698129538, -691.9642889386545, -401.74338485874836, -358.7588352559218, -602.9006044292719, -595.7920719576365, -533.9826979111153, -612.0108487437767, -668.8365896130383, -996.7702276277334, -602.5570729784877, -345.2154232265126, -525.2468051320984, -577.6721406937668, -648.6944442991255, -756.5428514171828, -1060.767361479062, -1118.8950483627636, -1079.5209937379195, -292.6554376152067, -831.9427655428887, -835.0838994970046, -112.2854177453307, -548.1960237265482, -919.8435726710544, -659.6036562391686, -847.3614216915245, -647.392026336985, -462.0368673456144, -913.9902314939653, -769.0737900359021, -1112.0275307584736, -509.4350094302807, -683.4170905051751, -808.2028343694853, -401.8495910763736, -828.1081663825299, -503.84127472456726, -810.3456721183617, -1001.2022224088686, -819.050463333264, -732.8371635206089, -441.8647855249527, -392.8312970120631, -721.1900015145102, -1138.1341237864717, -674.2047447497401, -821.0423450327103, -958.8070610813152, -280.110799390389, -746.9325780352342, -578.9008434796241, -710.849845042925, -360.72599340198417, -617.4317780460915, -540.8885349174462, -385.1830455601118, -917.1139578817484, -301.362698017635, -43.839500198026364, -17.567439616918882, -6.563367526687729, -503.35092618016273, -310.68285132820614, -408.6284372733701, -578.6870783442778, 68.53184572814695, -504.8422808367049, -17.762013241380707, -834.4953825062648, 110.99405094671036, -762.9739314210976, -826.7362099642796, -492.4477489968603, -953.1280591223256, -1004.1951209146674, -518.9817186122289, -271.1038152082442, 4.7162130833169424, -735.0454341520442, -672.3110398940344, -543.001605566914, -839.2392550295167, -483.65503059553396, 2.0000000000000013, -743.2414465524687, -734.6779424361457, -591.4456529877274, -658.6671082803513, 25.31886091466961, -367.4345166748916, -958.7175996689022, -478.093359733153, -859.7557114210971, -234.62968807042697, -745.989071407316, -856.1764103220661, -161.27957539810293, -56.09596293582699, -989.4484091575357, -25.513861906244372, -857.5051972748804, -23.50693965653044, -68.28352045596925, -816.7076865529594, 2.309247091025149, -16.323612832273266, -596.2653297214863, 11.14587554414837, 23.97025590403841, -385.709331017838, -415.26894164904195, 7.613151857811179, -264.09790390812583, -2.209994336124428, -707.431962475806, -556.1935553897199, 17.602319634213252, -55.17428937120046, -60.85064222866717, -20.451767784948395, -126.05857246359122, -736.1487981802708, -44.25843164558249, -596.0118528028547, -119.07629277419787, -152.27470698925478, -992.1985314157761, -353.8535019938212, -275.0652240729174, -41.68100269417153, 57.46924766309557, -31.49499552354487, -49.22500757806735, -269.46079207000815, 47.90156851868561, -118.8791496529341, 3.1458333760969506, 34.98133549998173, -519.4010610240149, 41.11752710292764, -0.6007595528618572, -80.58480024489596, -19.51896156314611, 32.361660158052345, 35.77015037347123, -41.879443201159184, -59.613045523999666, -97.84485298383314, -32.83957884572329, -6.751703464537918, -9.280544192509966, 51.26446022300532, -559.9429397605106, 110.90000000000038, -2.2122380561401833, 128.7200000000002, -115.63274751647636, 62.85644128198635, -118.44803308397908, 55.03059780292361, 36.407399459930026, -45.46601924384919, 27.718697948989572, 50.693167350862005, -8.010562431674993, 8.95463068098144, 16.134616734259865, -4.29938214114021, 0.7574577274155485, -143.53669897016584, -103.92040337436302, 72.90586973852469, 7.811980347952048, 85.90895181980028, 8.389050751995601], "policy_predator_policy_reward": [250.38838936019138, 113.64903856315406, 2.2511007033395796, 595.2124347593268, 1162.3948000170499, 780.0194760603354, 546.895047284129, 176.1275344407544, 628.1698806122689, 140.40698901904028, 8.012110542736446, 377.2496892904304, 737.8945841516312, 987.7982593669008, 1008.681765935656, 550.4450396296954, 559.9865583368262, 805.5195350950088, 575.2029598145449, 50.40630043705267, 442.24228472581405, 388.69123629490906, 785.6602559666934, 581.0022760922127, 549.9909013702431, 584.2924333658887, 396.2569367464253, 278.63522282701035, 777.2630886439484, 46.447695136579156, 595.5473901597018, 485.1615945601513, 924.6507759823586, 766.2477706461553, 655.5734094069716, 172.38141913457417, 444.16652962359325, 483.43381909592466, 926.518904972, 154.6186657075362, 1119.0887085434208, 1056.3177103841865, 846.2037078366038, 900.0544097249515, 25.59503673721011, 1080.708849557024, 379.5220552540382, 402.4841360233909, 813.4135845482479, 889.9826893649298, 951.3474065170668, 372.6444938104163, 515.4045307400845, 918.095612035478, 1065.9657549713497, 1040.105776178995, 742.3880774347533, 86.9581090437288, 773.6570694979772, 783.3755793145577, 834.2814359035611, 789.6861902527662, 879.6500128869684, 896.4957594336324, 712.4719882590853, 745.1625178065293, 546.778747435185, 382.6103263979394, 991.083721036146, 1024.764479150016, 598.650851296542, 862.518162649319, 865.155829099698, 622.8715238006114, 837.8520875525428, 107.00074866480986, 635.6586405553363, 741.8168436290148, 309.7617530727819, 742.3796523858143, 898.8333610079283, 695.4341792063385, 275.51599748360206, 168.7005967153817, 25.14599216756841, 72.56478381522197, 463.25332785364776, 589.7143935433805, 551.4604446255305, 572.8799995804657, 458.35019148289894, 382.51284668517314, 561.645558134005, 659.7107614853038, 624.1638959606272, 610.5255695970656, 644.1341445945235, 678.9148135090239, 1164.9063642451674, 892.298121017202, 505.21244074010764, 440.385403283525, 519.5687540314278, 634.6626238313152, 571.5399132084018, 657.257168184666, 735.329497345425, 864.1800356644062, 590.3592156364892, 595.8954165639227, 676.2548139206318, 757.0946629640753, 595.6805409260103, 330.2803468327872, 765.9909437343799, 932.3470166813453, 731.5446650544402, 858.3851951062034, 478.0206405104574, 699.6107653931036, 744.4127528884742, 666.9964235310368, 570.1210576118609, 839.4324702147262, 700.7259198206455, 690.3081617982865, 139.76206609853722, 88.4728901316124, 732.6151358247395, 434.79905497927626, 431.67205977834357, 495.23011422440607, 115.11632056672852, 3.1018626755035585, 409.1443657751154, 542.125270379277, 190.83957142954017, 217.2709876825714, 504.9211343232175, 527.9602990150922, 466.377386572573, 363.37478465288507, 50.28162531900438, 160.46558735341824, 103.50914119357942, 103.49132215556236, 581.4166467967095, 534.0257157929783, 565.5345604595001, 339.0342189152412, 735.6185336724507, 932.1628831754954, 290.59191473728373, 397.12585101956205, 66.56412725905534, 75.1176277720209, 102.07314883735408, 55.02207289716095, 229.14438093005575, 191.4737501873464, 105.8177312881896, 104.81577573747317, 336.04192246998036, 412.85553241308554, 0.0, 35.53323244993425, 115.85480024489661, 21.358961563146398, 20.948339841947842, 0.8698496265287702, 106.502275122836, 88.2202136023227, 58.92180564588326, 127.39344884634669, 8.691703464537877, 37.730544192509925, 311.6705390722492, 504.8958689194993, 0.0, 112.73223805614026, 0.0, 117.22274751647716, 89.1017210681298, 79.59987073386266, 0.0, 104.55928737102131, 47.20601924384884, 1.0013020510106203, 36.109248985946884, 28.582880544066384, 23.301604465915062, 136.36732355062918, 6.249382141140169, 69.01254227258444, 78.72505762510696, 236.57675808667872, 20.064130261475285, 24.718019652047925, 60.99365550049416, 24.44834192770983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8208191500868139, "mean_inference_ms": 2.638524276734222, "mean_action_processing_ms": 0.36924894851650025, "mean_env_wait_ms": 0.3035390761780434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013684630393981934, "StateBufferConnector_ms": 0.007932066917419434, "ViewRequirementAgentConnector_ms": 0.18660187721252441}, "num_episodes": 18, "episode_return_max": 582.7095850833052, "episode_return_min": -560.7227787456584, "episode_return_mean": 106.33376359357537, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.03706917313946, "num_env_steps_trained_throughput_per_sec": 280.03706917313946, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 15755.126, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15755.073, "sample_time_ms": 2439.714, "learn_time_ms": 13287.061, "learn_throughput": 301.045, "synch_weights_time_ms": 26.672}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "6c58f_00000", "date": "2024-08-16_16-19-19", "timestamp": 1723805359, "time_this_iter_s": 14.304476976394653, "time_total_s": 742.7308039665222, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04fa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 742.7308039665222, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 62.589999999999996, "ram_util_percent": 80.305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4332211002470956, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.528497838154041, "policy_loss": -0.006836421253583419, "vf_loss": 2.533884846091901, "vf_explained_var": 0.0019384599236584215, "kl": 0.010179682996097762, "entropy": 1.5240744899820398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.935039909775295, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 7.9494302050777215, "policy_loss": -0.004603175362128587, "vf_loss": 7.953951446089165, "vf_explained_var": 0.03661641718218566, "kl": 0.01311326823417599, "entropy": 1.3982466506579565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 582.7095850833052, "episode_reward_min": -560.7227787456584, "episode_reward_mean": 161.2718593638313, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1138.1341237864717, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.08513010328335, "predator_policy": 1164.9063642451674}, "policy_reward_mean": {"prey_policy": -275.90109049379123, "predator_policy": 356.537020175707}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.7227787456584, 121.52474980554992, 123.94904500295446, -170.76154770102582, 57.47304393598268, 224.9702103559687, -363.50591345697393, 346.9802233666758, 292.0181850492299, -35.40212220662944, -94.2531207882587, 94.69299129610812, 156.5240748851801, -34.07807583658957, 249.10949242860588, -380.98058529750534, 305.89964573944263, -106.17890750494192, 291.9705367724061, 99.01439598332236, 73.5799688391837, 238.93394388865926, 137.02492858834827, 404.55260305951396, 369.0989238716631, 582.7095850833052, 3.8649991424090295, 99.8813052253768, 155.51231020316013, 423.90215679401535, 13.484435932119297, 276.61524738478033, 445.0131856479421, 107.22588146083397, 292.61264039311516, 372.1858440719304, 252.0807890063937, 197.0126464258181, 393.9531906993413, 364.009155733224, 508.0150224378055, 136.44449611764986, 353.0157513420814, 314.3132314489896, 153.3343146904187, 150.29136348751376, 151.62580706179705, 323.2394765263783, 291.1609354699519, 94.72228107255431, 60.49012310060131, 335.0351327638329, 189.480633797688, 523.3081784429147, 58.79903969010713, 157.47000000000025, 76.3752186329028, 199.05890756607948, 94.90019074882589, 264.4777293590318, 76.0499999999999, 37.10999999999965, 89.9499999999997, 93.23000000000044, 55.63082266267399, 30.390000000000374, 307.8879284542428, 221.41999999999967, 130.31000000000063, 113.11000000000058, 195.99728463387453, 30.460000000000395, 107.37473444920084, 184.75817543178505, 71.72000000000017, 67.84471336725765, 125.50000000000051, 179.74000000000046, 61.78403420282284, 297.89243281155547, 214.60999999999967, 99.55000000000028, 248.82777912237088, 203.28994354412492, 217.40598394908153, 237.7660985353208, 152.41000000000008, 117.24000000000045, 65.3899999999999, 211.77143007608237, 300.95407981365804, 106.05000000000035, 160.12999999999994, 33.346727350712456, 211.29429098652753, 304.5699999999997, 242.87424143602078, 146.4628612563709, 14.777256007342421, 103.25000000000043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-831.9427655428887, -835.0838994970046, -112.2854177453307, -548.1960237265482, -919.8435726710544, -659.6036562391686, -847.3614216915245, -647.392026336985, -462.0368673456144, -913.9902314939653, -769.0737900359021, -1112.0275307584736, -509.4350094302807, -683.4170905051751, -808.2028343694853, -401.8495910763736, -828.1081663825299, -503.84127472456726, -810.3456721183617, -1001.2022224088686, -819.050463333264, -732.8371635206089, -441.8647855249527, -392.8312970120631, -721.1900015145102, -1138.1341237864717, -674.2047447497401, -821.0423450327103, -958.8070610813152, -280.110799390389, -746.9325780352342, -578.9008434796241, -710.849845042925, -360.72599340198417, -617.4317780460915, -540.8885349174462, -385.1830455601118, -917.1139578817484, -301.362698017635, -43.839500198026364, -17.567439616918882, -6.563367526687729, -503.35092618016273, -310.68285132820614, -408.6284372733701, -578.6870783442778, 68.53184572814695, -504.8422808367049, -17.762013241380707, -834.4953825062648, 110.99405094671036, -762.9739314210976, -826.7362099642796, -492.4477489968603, -953.1280591223256, -1004.1951209146674, -518.9817186122289, -271.1038152082442, 4.7162130833169424, -735.0454341520442, -672.3110398940344, -543.001605566914, -839.2392550295167, -483.65503059553396, 2.0000000000000013, -743.2414465524687, -734.6779424361457, -591.4456529877274, -658.6671082803513, 25.31886091466961, -367.4345166748916, -958.7175996689022, -478.093359733153, -859.7557114210971, -234.62968807042697, -745.989071407316, -856.1764103220661, -161.27957539810293, -56.09596293582699, -989.4484091575357, -25.513861906244372, -857.5051972748804, -23.50693965653044, -68.28352045596925, -816.7076865529594, 2.309247091025149, -16.323612832273266, -596.2653297214863, 11.14587554414837, 23.97025590403841, -385.709331017838, -415.26894164904195, 7.613151857811179, -264.09790390812583, -2.209994336124428, -707.431962475806, -556.1935553897199, 17.602319634213252, -55.17428937120046, -60.85064222866717, -20.451767784948395, -126.05857246359122, -736.1487981802708, -44.25843164558249, -596.0118528028547, -119.07629277419787, -152.27470698925478, -992.1985314157761, -353.8535019938212, -275.0652240729174, -41.68100269417153, 57.46924766309557, -31.49499552354487, -49.22500757806735, -269.46079207000815, 47.90156851868561, -118.8791496529341, 3.1458333760969506, 34.98133549998173, -519.4010610240149, 41.11752710292764, -0.6007595528618572, -80.58480024489596, -19.51896156314611, 32.361660158052345, 35.77015037347123, -41.879443201159184, -59.613045523999666, -97.84485298383314, -32.83957884572329, -6.751703464537918, -9.280544192509966, 51.26446022300532, -559.9429397605106, 110.90000000000038, -2.2122380561401833, 128.7200000000002, -115.63274751647636, 62.85644128198635, -118.44803308397908, 55.03059780292361, 36.407399459930026, -45.46601924384919, 27.718697948989572, 50.693167350862005, -8.010562431674993, 8.95463068098144, 16.134616734259865, -4.29938214114021, 0.7574577274155485, -143.53669897016584, -103.92040337436302, 72.90586973852469, 7.811980347952048, 85.90895181980028, 8.389050751995601, 2.6357782199729485, 44.149443427583364, 146.66815259988311, 143.53642810350334, 48.88860809716936, 131.15905901692346, 60.56970465444881, -36.29128193993897, -78.8843618141654, 90.58971787799861, -40.261937754292276, -45.82981607068519, 7.94096122384939, 45.53179384726318, 60.21785217474972, 68.93137043828258, -3.4987461026814906, 146.84198564229874, 64.34644089383224, -43.80302030863906, -3.2164378153354356, -136.22003266182048, -134.3013888823958, 17.191862838104726, 141.26097132525356, 102.41033469370838, -113.14774528022511, -4.1444625865720015, -31.344171838581318, 143.92462215452198, -19.195349060926183, -397.0264896258138, -17.510969828669786, 75.26510839432657, 152.08513010328335, 71.00738004641178, 32.39919063234055, 80.47230821245455, -75.6618535376756, 3.7300908626312266, -212.97767671370124, -4.064693147722876, -23.4894572804144, -35.94797065533289], "policy_predator_policy_reward": [25.59503673721011, 1080.708849557024, 379.5220552540382, 402.4841360233909, 813.4135845482479, 889.9826893649298, 951.3474065170668, 372.6444938104163, 515.4045307400845, 918.095612035478, 1065.9657549713497, 1040.105776178995, 742.3880774347533, 86.9581090437288, 773.6570694979772, 783.3755793145577, 834.2814359035611, 789.6861902527662, 879.6500128869684, 896.4957594336324, 712.4719882590853, 745.1625178065293, 546.778747435185, 382.6103263979394, 991.083721036146, 1024.764479150016, 598.650851296542, 862.518162649319, 865.155829099698, 622.8715238006114, 837.8520875525428, 107.00074866480986, 635.6586405553363, 741.8168436290148, 309.7617530727819, 742.3796523858143, 898.8333610079283, 695.4341792063385, 275.51599748360206, 168.7005967153817, 25.14599216756841, 72.56478381522197, 463.25332785364776, 589.7143935433805, 551.4604446255305, 572.8799995804657, 458.35019148289894, 382.51284668517314, 561.645558134005, 659.7107614853038, 624.1638959606272, 610.5255695970656, 644.1341445945235, 678.9148135090239, 1164.9063642451674, 892.298121017202, 505.21244074010764, 440.385403283525, 519.5687540314278, 634.6626238313152, 571.5399132084018, 657.257168184666, 735.329497345425, 864.1800356644062, 590.3592156364892, 595.8954165639227, 676.2548139206318, 757.0946629640753, 595.6805409260103, 330.2803468327872, 765.9909437343799, 932.3470166813453, 731.5446650544402, 858.3851951062034, 478.0206405104574, 699.6107653931036, 744.4127528884742, 666.9964235310368, 570.1210576118609, 839.4324702147262, 700.7259198206455, 690.3081617982865, 139.76206609853722, 88.4728901316124, 732.6151358247395, 434.79905497927626, 431.67205977834357, 495.23011422440607, 115.11632056672852, 3.1018626755035585, 409.1443657751154, 542.125270379277, 190.83957142954017, 217.2709876825714, 504.9211343232175, 527.9602990150922, 466.377386572573, 363.37478465288507, 50.28162531900438, 160.46558735341824, 103.50914119357942, 103.49132215556236, 581.4166467967095, 534.0257157929783, 565.5345604595001, 339.0342189152412, 735.6185336724507, 932.1628831754954, 290.59191473728373, 397.12585101956205, 66.56412725905534, 75.1176277720209, 102.07314883735408, 55.02207289716095, 229.14438093005575, 191.4737501873464, 105.8177312881896, 104.81577573747317, 336.04192246998036, 412.85553241308554, 0.0, 35.53323244993425, 115.85480024489661, 21.358961563146398, 20.948339841947842, 0.8698496265287702, 106.502275122836, 88.2202136023227, 58.92180564588326, 127.39344884634669, 8.691703464537877, 37.730544192509925, 311.6705390722492, 504.8958689194993, 0.0, 112.73223805614026, 0.0, 117.22274751647716, 89.1017210681298, 79.59987073386266, 0.0, 104.55928737102131, 47.20601924384884, 1.0013020510106203, 36.109248985946884, 28.582880544066384, 23.301604465915062, 136.36732355062918, 6.249382141140169, 69.01254227258444, 78.72505762510696, 236.57675808667872, 20.064130261475285, 24.718019652047925, 60.99365550049416, 24.44834192770983, 9.5159071755938, 5.4829053796729745, 5.914768771900974, 1.7730833362684795, 17.331391902830628, 17.230940983076625, 37.21029534555115, 38.061281939938624, 112.17275409565528, 124.94966896288247, 221.79753708468755, 67.584160284415, 33.54988555272944, 130.38334332523934, 38.82001983395173, 69.79685608833682, 5.448746102681454, 3.618014357701282, 51.23355910616771, 45.46302030863873, 0.0, 204.8264704771557, 246.28529310407902, 82.5956630162945, 31.60845458740547, 25.674319207290942, 32.32075185230473, 191.0214560144923, 34.32421364586707, 13.225336038192191, 399.4370292339619, 50.13153680349064, 140.8509698286699, 12.6891825922009, 11.194869896716687, 70.28261995358821, 31.910734704206064, 98.09200788701963, 22.894555795709323, 195.50006813570621, 5.538956131465724, 226.28066973730049, 145.6403362254144, 17.04709171033322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8255849641904262, "mean_inference_ms": 2.6557213571233054, "mean_action_processing_ms": 0.3705251633834989, "mean_env_wait_ms": 0.3059633501124656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014134526252746582, "StateBufferConnector_ms": 0.0077741146087646484, "ViewRequirementAgentConnector_ms": 0.1619873046875}, "num_episodes": 22, "episode_return_max": 582.7095850833052, "episode_return_min": -560.7227787456584, "episode_return_mean": 161.2718593638313, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.3295988866508, "num_env_steps_trained_throughput_per_sec": 283.3295988866508, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 15544.882, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15544.83, "sample_time_ms": 2371.689, "learn_time_ms": 13144.71, "learn_throughput": 304.305, "synch_weights_time_ms": 26.962}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "6c58f_00000", "date": "2024-08-16_16-19-34", "timestamp": 1723805374, "time_this_iter_s": 14.12597393989563, "time_total_s": 756.8567779064178, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0521310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 756.8567779064178, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 62.71, "ram_util_percent": 79.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3233662660948182, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.569749171897848, "policy_loss": -0.0036919322076731575, "vf_loss": 5.572458110032258, "vf_explained_var": 0.010593243944581854, "kl": 0.006903857152519201, "entropy": 1.5230417756807237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6423264767600114, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.653440799158087, "policy_loss": -0.004189799651971688, "vf_loss": 8.65754224661166, "vf_explained_var": -0.0026604014098959624, "kl": 0.014137573576979277, "entropy": 1.3348564130288583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 582.7095850833052, "episode_reward_min": -59.177491784012894, "episode_reward_mean": 186.07324455731407, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1004.1951209146674, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.64167042371292, "predator_policy": 1164.9063642451674}, "policy_reward_mean": {"prey_policy": -162.4850488583936, "predator_policy": 255.5216711370507}, "custom_metrics": {}, "hist_stats": {"episode_reward": [404.55260305951396, 369.0989238716631, 582.7095850833052, 3.8649991424090295, 99.8813052253768, 155.51231020316013, 423.90215679401535, 13.484435932119297, 276.61524738478033, 445.0131856479421, 107.22588146083397, 292.61264039311516, 372.1858440719304, 252.0807890063937, 197.0126464258181, 393.9531906993413, 364.009155733224, 508.0150224378055, 136.44449611764986, 353.0157513420814, 314.3132314489896, 153.3343146904187, 150.29136348751376, 151.62580706179705, 323.2394765263783, 291.1609354699519, 94.72228107255431, 60.49012310060131, 335.0351327638329, 189.480633797688, 523.3081784429147, 58.79903969010713, 157.47000000000025, 76.3752186329028, 199.05890756607948, 94.90019074882589, 264.4777293590318, 76.0499999999999, 37.10999999999965, 89.9499999999997, 93.23000000000044, 55.63082266267399, 30.390000000000374, 307.8879284542428, 221.41999999999967, 130.31000000000063, 113.11000000000058, 195.99728463387453, 30.460000000000395, 107.37473444920084, 184.75817543178505, 71.72000000000017, 67.84471336725765, 125.50000000000051, 179.74000000000046, 61.78403420282284, 297.89243281155547, 214.60999999999967, 99.55000000000028, 248.82777912237088, 203.28994354412492, 217.40598394908153, 237.7660985353208, 152.41000000000008, 117.24000000000045, 65.3899999999999, 211.77143007608237, 300.95407981365804, 106.05000000000035, 160.12999999999994, 33.346727350712456, 211.29429098652753, 304.5699999999997, 242.87424143602078, 146.4628612563709, 14.777256007342421, 103.25000000000043, 122.34293339439147, 93.11011685187185, 79.96634783588244, 175.38231795988472, 31.400758397253288, 106.83564810137803, 221.51491169072855, 169.53999999999985, 142.7800000000003, 136.04000000000025, 160.58999999999983, 341.39999999999986, 142.51067284028906, 317.4201686189502, 118.90000000000033, 175.784259946203, 139.4830895285454, 208.1036182295352, 228.2386872509546, 109.80743410421387, 339.5799999999998, -59.177491784012894, 46.367430782241364], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.53184572814695, -504.8422808367049, -17.762013241380707, -834.4953825062648, 110.99405094671036, -762.9739314210976, -826.7362099642796, -492.4477489968603, -953.1280591223256, -1004.1951209146674, -518.9817186122289, -271.1038152082442, 4.7162130833169424, -735.0454341520442, -672.3110398940344, -543.001605566914, -839.2392550295167, -483.65503059553396, 2.0000000000000013, -743.2414465524687, -734.6779424361457, -591.4456529877274, -658.6671082803513, 25.31886091466961, -367.4345166748916, -958.7175996689022, -478.093359733153, -859.7557114210971, -234.62968807042697, -745.989071407316, -856.1764103220661, -161.27957539810293, -56.09596293582699, -989.4484091575357, -25.513861906244372, -857.5051972748804, -23.50693965653044, -68.28352045596925, -816.7076865529594, 2.309247091025149, -16.323612832273266, -596.2653297214863, 11.14587554414837, 23.97025590403841, -385.709331017838, -415.26894164904195, 7.613151857811179, -264.09790390812583, -2.209994336124428, -707.431962475806, -556.1935553897199, 17.602319634213252, -55.17428937120046, -60.85064222866717, -20.451767784948395, -126.05857246359122, -736.1487981802708, -44.25843164558249, -596.0118528028547, -119.07629277419787, -152.27470698925478, -992.1985314157761, -353.8535019938212, -275.0652240729174, -41.68100269417153, 57.46924766309557, -31.49499552354487, -49.22500757806735, -269.46079207000815, 47.90156851868561, -118.8791496529341, 3.1458333760969506, 34.98133549998173, -519.4010610240149, 41.11752710292764, -0.6007595528618572, -80.58480024489596, -19.51896156314611, 32.361660158052345, 35.77015037347123, -41.879443201159184, -59.613045523999666, -97.84485298383314, -32.83957884572329, -6.751703464537918, -9.280544192509966, 51.26446022300532, -559.9429397605106, 110.90000000000038, -2.2122380561401833, 128.7200000000002, -115.63274751647636, 62.85644128198635, -118.44803308397908, 55.03059780292361, 36.407399459930026, -45.46601924384919, 27.718697948989572, 50.693167350862005, -8.010562431674993, 8.95463068098144, 16.134616734259865, -4.29938214114021, 0.7574577274155485, -143.53669897016584, -103.92040337436302, 72.90586973852469, 7.811980347952048, 85.90895181980028, 8.389050751995601, 2.6357782199729485, 44.149443427583364, 146.66815259988311, 143.53642810350334, 48.88860809716936, 131.15905901692346, 60.56970465444881, -36.29128193993897, -78.8843618141654, 90.58971787799861, -40.261937754292276, -45.82981607068519, 7.94096122384939, 45.53179384726318, 60.21785217474972, 68.93137043828258, -3.4987461026814906, 146.84198564229874, 64.34644089383224, -43.80302030863906, -3.2164378153354356, -136.22003266182048, -134.3013888823958, 17.191862838104726, 141.26097132525356, 102.41033469370838, -113.14774528022511, -4.1444625865720015, -31.344171838581318, 143.92462215452198, -19.195349060926183, -397.0264896258138, -17.510969828669786, 75.26510839432657, 152.08513010328335, 71.00738004641178, 32.39919063234055, 80.47230821245455, -75.6618535376756, 3.7300908626312266, -212.97767671370124, -4.064693147722876, -23.4894572804144, -35.94797065533289, -52.834342610257615, -94.65373376725411, -137.21491459374593, -149.4982185585467, -585.9016033875141, -125.89168347163135, -89.0447059906709, -211.73911483675897, -188.28748598201926, -511.4171730510218, 71.19215515214867, -386.34286063293223, -27.95177832152936, 63.134971726445556, -90.21543721548069, 121.0407748500881, -53.80710606161677, 8.037269255178455, 38.40195128385822, -14.252108147374862, -408.6335152885932, 87.30328342263923, 172.64167042371292, 144.19488743457833, -462.1797092889417, 97.86080620058887, 131.39201657642332, 143.36721453927368, -0.9268328233860144, -82.44908913943047, -17.452195180025324, -283.0112865027062, 2.0000000000000013, -398.5931933768253, -53.40129833115566, 16.398623892317794, -61.40234074277522, 73.36165572212836, -542.6022267483047, -273.75656675623804, 166.58337455169124, 169.30999999999995, -415.63529480266817, -444.3833322098219, -552.9479953640853, -320.60590866480914], "policy_predator_policy_reward": [458.35019148289894, 382.51284668517314, 561.645558134005, 659.7107614853038, 624.1638959606272, 610.5255695970656, 644.1341445945235, 678.9148135090239, 1164.9063642451674, 892.298121017202, 505.21244074010764, 440.385403283525, 519.5687540314278, 634.6626238313152, 571.5399132084018, 657.257168184666, 735.329497345425, 864.1800356644062, 590.3592156364892, 595.8954165639227, 676.2548139206318, 757.0946629640753, 595.6805409260103, 330.2803468327872, 765.9909437343799, 932.3470166813453, 731.5446650544402, 858.3851951062034, 478.0206405104574, 699.6107653931036, 744.4127528884742, 666.9964235310368, 570.1210576118609, 839.4324702147262, 700.7259198206455, 690.3081617982865, 139.76206609853722, 88.4728901316124, 732.6151358247395, 434.79905497927626, 431.67205977834357, 495.23011422440607, 115.11632056672852, 3.1018626755035585, 409.1443657751154, 542.125270379277, 190.83957142954017, 217.2709876825714, 504.9211343232175, 527.9602990150922, 466.377386572573, 363.37478465288507, 50.28162531900438, 160.46558735341824, 103.50914119357942, 103.49132215556236, 581.4166467967095, 534.0257157929783, 565.5345604595001, 339.0342189152412, 735.6185336724507, 932.1628831754954, 290.59191473728373, 397.12585101956205, 66.56412725905534, 75.1176277720209, 102.07314883735408, 55.02207289716095, 229.14438093005575, 191.4737501873464, 105.8177312881896, 104.81577573747317, 336.04192246998036, 412.85553241308554, 0.0, 35.53323244993425, 115.85480024489661, 21.358961563146398, 20.948339841947842, 0.8698496265287702, 106.502275122836, 88.2202136023227, 58.92180564588326, 127.39344884634669, 8.691703464537877, 37.730544192509925, 311.6705390722492, 504.8958689194993, 0.0, 112.73223805614026, 0.0, 117.22274751647716, 89.1017210681298, 79.59987073386266, 0.0, 104.55928737102131, 47.20601924384884, 1.0013020510106203, 36.109248985946884, 28.582880544066384, 23.301604465915062, 136.36732355062918, 6.249382141140169, 69.01254227258444, 78.72505762510696, 236.57675808667872, 20.064130261475285, 24.718019652047925, 60.99365550049416, 24.44834192770983, 9.5159071755938, 5.4829053796729745, 5.914768771900974, 1.7730833362684795, 17.331391902830628, 17.230940983076625, 37.21029534555115, 38.061281939938624, 112.17275409565528, 124.94966896288247, 221.79753708468755, 67.584160284415, 33.54988555272944, 130.38334332523934, 38.82001983395173, 69.79685608833682, 5.448746102681454, 3.618014357701282, 51.23355910616771, 45.46302030863873, 0.0, 204.8264704771557, 246.28529310407902, 82.5956630162945, 31.60845458740547, 25.674319207290942, 32.32075185230473, 191.0214560144923, 34.32421364586707, 13.225336038192191, 399.4370292339619, 50.13153680349064, 140.8509698286699, 12.6891825922009, 11.194869896716687, 70.28261995358821, 31.910734704206064, 98.09200788701963, 22.894555795709323, 195.50006813570621, 5.538956131465724, 226.28066973730049, 145.6403362254144, 17.04709171033322, 260.0424482800149, 9.788561491888263, 221.96939548622285, 157.8538545179408, 346.6881423851015, 445.07149230992655, 266.577353639261, 209.58878514805386, 199.1279234819923, 531.977493948302, 15.643492949229202, 406.34286063293223, 87.77171042811337, 98.56000785769912, 91.69543721548138, 47.01922514991191, 179.53290002839813, 9.016936778040177, 95.77804871614178, 16.112108147374823, 409.073515288593, 72.84671657736078, 4.538329576287064, 20.025112565421693, 496.86032778901415, 9.969248139628034, 12.509753326157215, 30.151184177096084, 118.156832823386, 84.11908913943132, 210.3728922800954, 265.8748493488399, 328.58126868644405, 207.4950142189265, 53.29360973807258, 191.81268293030038, 181.9532726143158, 34.32609965728579, 419.0741277626539, 507.09209984610254, 3.6866254483087597, 0.0, 523.6423162407084, 277.19881898776885, 567.9332782603329, 351.9880565508031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263018087031009, "mean_inference_ms": 2.668246127937323, "mean_action_processing_ms": 0.37195092343062425, "mean_env_wait_ms": 0.3060846021316064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014295458793640137, "StateBufferConnector_ms": 0.006921887397766113, "ViewRequirementAgentConnector_ms": 0.1203845739364624}, "num_episodes": 23, "episode_return_max": 582.7095850833052, "episode_return_min": -59.177491784012894, "episode_return_mean": 186.07324455731407, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.531149349219, "num_env_steps_trained_throughput_per_sec": 267.531149349219, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 15498.721, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15498.669, "sample_time_ms": 2399.646, "learn_time_ms": 13071.189, "learn_throughput": 306.017, "synch_weights_time_ms": 26.283}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "6c58f_00000", "date": "2024-08-16_16-19-49", "timestamp": 1723805389, "time_this_iter_s": 14.994118213653564, "time_total_s": 771.8508961200714, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 771.8508961200714, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 64.02857142857144, "ram_util_percent": 80.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.317803370873764, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.136679933941553, "policy_loss": -0.005858958384918946, "vf_loss": 7.14143892091418, "vf_explained_var": 0.009113306721682271, "kl": 0.007725316484879359, "entropy": 1.5303365361753596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.678344995587591, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.749047041443921, "policy_loss": -0.003846013773893001, "vf_loss": 8.75284476305442, "vf_explained_var": 0.03689800403105519, "kl": 0.007723062797317765, "entropy": 1.355754645413192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 523.3081784429147, "episode_reward_min": -59.177491784012894, "episode_reward_mean": 157.39234890767014, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -992.1985314157761, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.64167042371292, "predator_policy": 932.1628831754954}, "policy_reward_mean": {"prey_policy": -103.91003958595552, "predator_policy": 182.60621403979061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.44449611764986, 353.0157513420814, 314.3132314489896, 153.3343146904187, 150.29136348751376, 151.62580706179705, 323.2394765263783, 291.1609354699519, 94.72228107255431, 60.49012310060131, 335.0351327638329, 189.480633797688, 523.3081784429147, 58.79903969010713, 157.47000000000025, 76.3752186329028, 199.05890756607948, 94.90019074882589, 264.4777293590318, 76.0499999999999, 37.10999999999965, 89.9499999999997, 93.23000000000044, 55.63082266267399, 30.390000000000374, 307.8879284542428, 221.41999999999967, 130.31000000000063, 113.11000000000058, 195.99728463387453, 30.460000000000395, 107.37473444920084, 184.75817543178505, 71.72000000000017, 67.84471336725765, 125.50000000000051, 179.74000000000046, 61.78403420282284, 297.89243281155547, 214.60999999999967, 99.55000000000028, 248.82777912237088, 203.28994354412492, 217.40598394908153, 237.7660985353208, 152.41000000000008, 117.24000000000045, 65.3899999999999, 211.77143007608237, 300.95407981365804, 106.05000000000035, 160.12999999999994, 33.346727350712456, 211.29429098652753, 304.5699999999997, 242.87424143602078, 146.4628612563709, 14.777256007342421, 103.25000000000043, 122.34293339439147, 93.11011685187185, 79.96634783588244, 175.38231795988472, 31.400758397253288, 106.83564810137803, 221.51491169072855, 169.53999999999985, 142.7800000000003, 136.04000000000025, 160.58999999999983, 341.39999999999986, 142.51067284028906, 317.4201686189502, 118.90000000000033, 175.784259946203, 139.4830895285454, 208.1036182295352, 228.2386872509546, 109.80743410421387, 339.5799999999998, -59.177491784012894, 46.367430782241364, -6.167179535367289, 118.6103211902082, 200.82679067341732, 169.56866198327293, 33.49000000000001, 97.47999999999996, 84.22067696720526, 32.85817943124968, 341.11305760378326, 183.5590730947805, 73.03999999999995, 92.37934066111079, 47.50934559613274, 40.48000000000003, 276.623246527152, 291.0230222289881, 7.895906876339783, 309.1299143100822], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.50693965653044, -68.28352045596925, -816.7076865529594, 2.309247091025149, -16.323612832273266, -596.2653297214863, 11.14587554414837, 23.97025590403841, -385.709331017838, -415.26894164904195, 7.613151857811179, -264.09790390812583, -2.209994336124428, -707.431962475806, -556.1935553897199, 17.602319634213252, -55.17428937120046, -60.85064222866717, -20.451767784948395, -126.05857246359122, -736.1487981802708, -44.25843164558249, -596.0118528028547, -119.07629277419787, -152.27470698925478, -992.1985314157761, -353.8535019938212, -275.0652240729174, -41.68100269417153, 57.46924766309557, -31.49499552354487, -49.22500757806735, -269.46079207000815, 47.90156851868561, -118.8791496529341, 3.1458333760969506, 34.98133549998173, -519.4010610240149, 41.11752710292764, -0.6007595528618572, -80.58480024489596, -19.51896156314611, 32.361660158052345, 35.77015037347123, -41.879443201159184, -59.613045523999666, -97.84485298383314, -32.83957884572329, -6.751703464537918, -9.280544192509966, 51.26446022300532, -559.9429397605106, 110.90000000000038, -2.2122380561401833, 128.7200000000002, -115.63274751647636, 62.85644128198635, -118.44803308397908, 55.03059780292361, 36.407399459930026, -45.46601924384919, 27.718697948989572, 50.693167350862005, -8.010562431674993, 8.95463068098144, 16.134616734259865, -4.29938214114021, 0.7574577274155485, -143.53669897016584, -103.92040337436302, 72.90586973852469, 7.811980347952048, 85.90895181980028, 8.389050751995601, 2.6357782199729485, 44.149443427583364, 146.66815259988311, 143.53642810350334, 48.88860809716936, 131.15905901692346, 60.56970465444881, -36.29128193993897, -78.8843618141654, 90.58971787799861, -40.261937754292276, -45.82981607068519, 7.94096122384939, 45.53179384726318, 60.21785217474972, 68.93137043828258, -3.4987461026814906, 146.84198564229874, 64.34644089383224, -43.80302030863906, -3.2164378153354356, -136.22003266182048, -134.3013888823958, 17.191862838104726, 141.26097132525356, 102.41033469370838, -113.14774528022511, -4.1444625865720015, -31.344171838581318, 143.92462215452198, -19.195349060926183, -397.0264896258138, -17.510969828669786, 75.26510839432657, 152.08513010328335, 71.00738004641178, 32.39919063234055, 80.47230821245455, -75.6618535376756, 3.7300908626312266, -212.97767671370124, -4.064693147722876, -23.4894572804144, -35.94797065533289, -52.834342610257615, -94.65373376725411, -137.21491459374593, -149.4982185585467, -585.9016033875141, -125.89168347163135, -89.0447059906709, -211.73911483675897, -188.28748598201926, -511.4171730510218, 71.19215515214867, -386.34286063293223, -27.95177832152936, 63.134971726445556, -90.21543721548069, 121.0407748500881, -53.80710606161677, 8.037269255178455, 38.40195128385822, -14.252108147374862, -408.6335152885932, 87.30328342263923, 172.64167042371292, 144.19488743457833, -462.1797092889417, 97.86080620058887, 131.39201657642332, 143.36721453927368, -0.9268328233860144, -82.44908913943047, -17.452195180025324, -283.0112865027062, 2.0000000000000013, -398.5931933768253, -53.40129833115566, 16.398623892317794, -61.40234074277522, 73.36165572212836, -542.6022267483047, -273.75656675623804, 166.58337455169124, 169.30999999999995, -415.63529480266817, -444.3833322098219, -552.9479953640853, -320.60590866480914, -280.1451949649752, -230.67118138734327, -35.139138732793874, -12.459940424442285, -611.1758851740352, -9.682973486014703, -217.53429795780582, 57.06487165208319, -386.98382278392955, -367.93784346677717, -50.75984418518217, -340.82549602292914, -231.93719004810018, -186.03253789175477, -297.4426785849859, -215.10294183794284, 94.40083987425062, -531.3694608839278, -355.8537321771145, 163.37000000000006, 2.0000000000000013, -157.49114344629498, -200.12820251733598, -186.13981159719793, -293.3880156553434, -95.37019013764645, -308.3689065219371, -341.67201264568604, -370.7308455400578, -30.55848510210329, 164.16221832192315, -368.5631411894055, -370.7151446487642, -492.29638020476955, 115.09973867854535, 128.35143556102466], "policy_predator_policy_reward": [139.76206609853722, 88.4728901316124, 732.6151358247395, 434.79905497927626, 431.67205977834357, 495.23011422440607, 115.11632056672852, 3.1018626755035585, 409.1443657751154, 542.125270379277, 190.83957142954017, 217.2709876825714, 504.9211343232175, 527.9602990150922, 466.377386572573, 363.37478465288507, 50.28162531900438, 160.46558735341824, 103.50914119357942, 103.49132215556236, 581.4166467967095, 534.0257157929783, 565.5345604595001, 339.0342189152412, 735.6185336724507, 932.1628831754954, 290.59191473728373, 397.12585101956205, 66.56412725905534, 75.1176277720209, 102.07314883735408, 55.02207289716095, 229.14438093005575, 191.4737501873464, 105.8177312881896, 104.81577573747317, 336.04192246998036, 412.85553241308554, 0.0, 35.53323244993425, 115.85480024489661, 21.358961563146398, 20.948339841947842, 0.8698496265287702, 106.502275122836, 88.2202136023227, 58.92180564588326, 127.39344884634669, 8.691703464537877, 37.730544192509925, 311.6705390722492, 504.8958689194993, 0.0, 112.73223805614026, 0.0, 117.22274751647716, 89.1017210681298, 79.59987073386266, 0.0, 104.55928737102131, 47.20601924384884, 1.0013020510106203, 36.109248985946884, 28.582880544066384, 23.301604465915062, 136.36732355062918, 6.249382141140169, 69.01254227258444, 78.72505762510696, 236.57675808667872, 20.064130261475285, 24.718019652047925, 60.99365550049416, 24.44834192770983, 9.5159071755938, 5.4829053796729745, 5.914768771900974, 1.7730833362684795, 17.331391902830628, 17.230940983076625, 37.21029534555115, 38.061281939938624, 112.17275409565528, 124.94966896288247, 221.79753708468755, 67.584160284415, 33.54988555272944, 130.38334332523934, 38.82001983395173, 69.79685608833682, 5.448746102681454, 3.618014357701282, 51.23355910616771, 45.46302030863873, 0.0, 204.8264704771557, 246.28529310407902, 82.5956630162945, 31.60845458740547, 25.674319207290942, 32.32075185230473, 191.0214560144923, 34.32421364586707, 13.225336038192191, 399.4370292339619, 50.13153680349064, 140.8509698286699, 12.6891825922009, 11.194869896716687, 70.28261995358821, 31.910734704206064, 98.09200788701963, 22.894555795709323, 195.50006813570621, 5.538956131465724, 226.28066973730049, 145.6403362254144, 17.04709171033322, 260.0424482800149, 9.788561491888263, 221.96939548622285, 157.8538545179408, 346.6881423851015, 445.07149230992655, 266.577353639261, 209.58878514805386, 199.1279234819923, 531.977493948302, 15.643492949229202, 406.34286063293223, 87.77171042811337, 98.56000785769912, 91.69543721548138, 47.01922514991191, 179.53290002839813, 9.016936778040177, 95.77804871614178, 16.112108147374823, 409.073515288593, 72.84671657736078, 4.538329576287064, 20.025112565421693, 496.86032778901415, 9.969248139628034, 12.509753326157215, 30.151184177096084, 118.156832823386, 84.11908913943132, 210.3728922800954, 265.8748493488399, 328.58126868644405, 207.4950142189265, 53.29360973807258, 191.81268293030038, 181.9532726143158, 34.32609965728579, 419.0741277626539, 507.09209984610254, 3.6866254483087597, 0.0, 523.6423162407084, 277.19881898776885, 567.9332782603329, 351.9880565508031, 449.37705210442186, 55.272144712529766, 142.0791897418262, 24.130210605617805, 327.76278216894764, 493.9228671645195, 28.73160736903369, 301.30648091996187, 387.4538227839292, 400.9578434667772, 147.78984418518215, 341.27549602292896, 82.2971629226459, 419.89324198441443, 354.9717285106729, 190.43207134350547, 332.6598864905601, 445.4217921229003, 274.2352503914599, 101.80755488043509, 223.4965040434423, 5.034639402852736, 328.8097289953261, 149.8376257803187, 213.4116980269079, 222.85585336221445, 348.4589065219371, 342.0620126456857, 285.4754416096896, 392.4371355596233, 173.1290877200656, 322.2948573764051, 375.24147316690926, 495.66595856296414, 30.896490772565127, 34.78224929794727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263043227475668, "mean_inference_ms": 2.668876551240054, "mean_action_processing_ms": 0.37073033067509686, "mean_env_wait_ms": 0.3057250957428822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006388425827026367, "StateBufferConnector_ms": 0.0033931732177734375, "ViewRequirementAgentConnector_ms": 0.11090636253356934}, "num_episodes": 18, "episode_return_max": 523.3081784429147, "episode_return_min": -59.177491784012894, "episode_return_mean": 157.39234890767014, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.53004945273545, "num_env_steps_trained_throughput_per_sec": 274.53004945273545, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 15382.552, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15382.5, "sample_time_ms": 2419.265, "learn_time_ms": 12935.498, "learn_throughput": 309.227, "synch_weights_time_ms": 26.214}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "6c58f_00000", "date": "2024-08-16_16-20-03", "timestamp": 1723805403, "time_this_iter_s": 14.577331066131592, "time_total_s": 786.428227186203, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0521160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 786.428227186203, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 61.38000000000001, "ram_util_percent": 80.085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1676233186923637, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.159866146057371, "policy_loss": -0.0034287667530219232, "vf_loss": 7.162313530684779, "vf_explained_var": 0.012078531110097492, "kl": 0.006892571211887275, "entropy": 1.518055743515176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.773683975187559, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.439455208954987, "policy_loss": -0.0036931221288377565, "vf_loss": 8.44307890064502, "vf_explained_var": -0.05651133703807044, "kl": 0.011108206259647053, "entropy": 1.3890368356906548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 377.67972064434855, "episode_reward_min": -169.6193921148538, "episode_reward_mean": 132.6832675142022, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -628.9952596227995, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.04846351269447, "predator_policy": 609.1189421791997}, "policy_reward_mean": {"prey_policy": -111.91106737722612, "predator_policy": 178.25270113432722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.4777293590318, 76.0499999999999, 37.10999999999965, 89.9499999999997, 93.23000000000044, 55.63082266267399, 30.390000000000374, 307.8879284542428, 221.41999999999967, 130.31000000000063, 113.11000000000058, 195.99728463387453, 30.460000000000395, 107.37473444920084, 184.75817543178505, 71.72000000000017, 67.84471336725765, 125.50000000000051, 179.74000000000046, 61.78403420282284, 297.89243281155547, 214.60999999999967, 99.55000000000028, 248.82777912237088, 203.28994354412492, 217.40598394908153, 237.7660985353208, 152.41000000000008, 117.24000000000045, 65.3899999999999, 211.77143007608237, 300.95407981365804, 106.05000000000035, 160.12999999999994, 33.346727350712456, 211.29429098652753, 304.5699999999997, 242.87424143602078, 146.4628612563709, 14.777256007342421, 103.25000000000043, 122.34293339439147, 93.11011685187185, 79.96634783588244, 175.38231795988472, 31.400758397253288, 106.83564810137803, 221.51491169072855, 169.53999999999985, 142.7800000000003, 136.04000000000025, 160.58999999999983, 341.39999999999986, 142.51067284028906, 317.4201686189502, 118.90000000000033, 175.784259946203, 139.4830895285454, 208.1036182295352, 228.2386872509546, 109.80743410421387, 339.5799999999998, -59.177491784012894, 46.367430782241364, -6.167179535367289, 118.6103211902082, 200.82679067341732, 169.56866198327293, 33.49000000000001, 97.47999999999996, 84.22067696720526, 32.85817943124968, 341.11305760378326, 183.5590730947805, 73.03999999999995, 92.37934066111079, 47.50934559613274, 40.48000000000003, 276.623246527152, 291.0230222289881, 7.895906876339783, 309.1299143100822, 239.49257068422676, 32.27423327169297, 74.97727056008222, -40.821463737933115, -26.072724671885872, 57.538194717405005, -58.724314539274246, -17.784349043016032, 107.87133126033375, 3.489999999999971, 279.51712778826925, 93.53856396236974, -169.6193921148538, 38.62864899542277, 125.73476987826074, 47.76675495804639, 377.67972064434855, 26.67000000000008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [34.98133549998173, -519.4010610240149, 41.11752710292764, -0.6007595528618572, -80.58480024489596, -19.51896156314611, 32.361660158052345, 35.77015037347123, -41.879443201159184, -59.613045523999666, -97.84485298383314, -32.83957884572329, -6.751703464537918, -9.280544192509966, 51.26446022300532, -559.9429397605106, 110.90000000000038, -2.2122380561401833, 128.7200000000002, -115.63274751647636, 62.85644128198635, -118.44803308397908, 55.03059780292361, 36.407399459930026, -45.46601924384919, 27.718697948989572, 50.693167350862005, -8.010562431674993, 8.95463068098144, 16.134616734259865, -4.29938214114021, 0.7574577274155485, -143.53669897016584, -103.92040337436302, 72.90586973852469, 7.811980347952048, 85.90895181980028, 8.389050751995601, 2.6357782199729485, 44.149443427583364, 146.66815259988311, 143.53642810350334, 48.88860809716936, 131.15905901692346, 60.56970465444881, -36.29128193993897, -78.8843618141654, 90.58971787799861, -40.261937754292276, -45.82981607068519, 7.94096122384939, 45.53179384726318, 60.21785217474972, 68.93137043828258, -3.4987461026814906, 146.84198564229874, 64.34644089383224, -43.80302030863906, -3.2164378153354356, -136.22003266182048, -134.3013888823958, 17.191862838104726, 141.26097132525356, 102.41033469370838, -113.14774528022511, -4.1444625865720015, -31.344171838581318, 143.92462215452198, -19.195349060926183, -397.0264896258138, -17.510969828669786, 75.26510839432657, 152.08513010328335, 71.00738004641178, 32.39919063234055, 80.47230821245455, -75.6618535376756, 3.7300908626312266, -212.97767671370124, -4.064693147722876, -23.4894572804144, -35.94797065533289, -52.834342610257615, -94.65373376725411, -137.21491459374593, -149.4982185585467, -585.9016033875141, -125.89168347163135, -89.0447059906709, -211.73911483675897, -188.28748598201926, -511.4171730510218, 71.19215515214867, -386.34286063293223, -27.95177832152936, 63.134971726445556, -90.21543721548069, 121.0407748500881, -53.80710606161677, 8.037269255178455, 38.40195128385822, -14.252108147374862, -408.6335152885932, 87.30328342263923, 172.64167042371292, 144.19488743457833, -462.1797092889417, 97.86080620058887, 131.39201657642332, 143.36721453927368, -0.9268328233860144, -82.44908913943047, -17.452195180025324, -283.0112865027062, 2.0000000000000013, -398.5931933768253, -53.40129833115566, 16.398623892317794, -61.40234074277522, 73.36165572212836, -542.6022267483047, -273.75656675623804, 166.58337455169124, 169.30999999999995, -415.63529480266817, -444.3833322098219, -552.9479953640853, -320.60590866480914, -280.1451949649752, -230.67118138734327, -35.139138732793874, -12.459940424442285, -611.1758851740352, -9.682973486014703, -217.53429795780582, 57.06487165208319, -386.98382278392955, -367.93784346677717, -50.75984418518217, -340.82549602292914, -231.93719004810018, -186.03253789175477, -297.4426785849859, -215.10294183794284, 94.40083987425062, -531.3694608839278, -355.8537321771145, 163.37000000000006, 2.0000000000000013, -157.49114344629498, -200.12820251733598, -186.13981159719793, -293.3880156553434, -95.37019013764645, -308.3689065219371, -341.67201264568604, -370.7308455400578, -30.55848510210329, 164.16221832192315, -368.5631411894055, -370.7151446487642, -492.29638020476955, 115.09973867854535, 128.35143556102466, -386.6922538912097, -177.4414633617549, 1.0407407364114907, -432.0337342007278, -387.24642212327836, -236.1651564629291, -146.4569998869565, -444.4779767533615, -209.4071216470535, -108.20871404876105, -23.911634739173355, -297.05840088306263, -166.55109482443268, -463.080495891488, -406.2516394677125, -290.01828603317443, -41.1304933341634, -64.87938207599747, -31.819334175427468, -66.77614452489215, -540.3294625108452, -27.715413534254502, -405.20645798148047, -77.28438043944496, -551.2843225824695, -563.5758187218164, -518.9977426234411, -365.53876998526647, -203.0734156450936, -582.1097552133164, -628.9952596227995, -184.77401928017883, 185.04846351269447, 153.9558400787879, -287.6272487273667, -347.13662503725146], "policy_predator_policy_reward": [336.04192246998036, 412.85553241308554, 0.0, 35.53323244993425, 115.85480024489661, 21.358961563146398, 20.948339841947842, 0.8698496265287702, 106.502275122836, 88.2202136023227, 58.92180564588326, 127.39344884634669, 8.691703464537877, 37.730544192509925, 311.6705390722492, 504.8958689194993, 0.0, 112.73223805614026, 0.0, 117.22274751647716, 89.1017210681298, 79.59987073386266, 0.0, 104.55928737102131, 47.20601924384884, 1.0013020510106203, 36.109248985946884, 28.582880544066384, 23.301604465915062, 136.36732355062918, 6.249382141140169, 69.01254227258444, 78.72505762510696, 236.57675808667872, 20.064130261475285, 24.718019652047925, 60.99365550049416, 24.44834192770983, 9.5159071755938, 5.4829053796729745, 5.914768771900974, 1.7730833362684795, 17.331391902830628, 17.230940983076625, 37.21029534555115, 38.061281939938624, 112.17275409565528, 124.94966896288247, 221.79753708468755, 67.584160284415, 33.54988555272944, 130.38334332523934, 38.82001983395173, 69.79685608833682, 5.448746102681454, 3.618014357701282, 51.23355910616771, 45.46302030863873, 0.0, 204.8264704771557, 246.28529310407902, 82.5956630162945, 31.60845458740547, 25.674319207290942, 32.32075185230473, 191.0214560144923, 34.32421364586707, 13.225336038192191, 399.4370292339619, 50.13153680349064, 140.8509698286699, 12.6891825922009, 11.194869896716687, 70.28261995358821, 31.910734704206064, 98.09200788701963, 22.894555795709323, 195.50006813570621, 5.538956131465724, 226.28066973730049, 145.6403362254144, 17.04709171033322, 260.0424482800149, 9.788561491888263, 221.96939548622285, 157.8538545179408, 346.6881423851015, 445.07149230992655, 266.577353639261, 209.58878514805386, 199.1279234819923, 531.977493948302, 15.643492949229202, 406.34286063293223, 87.77171042811337, 98.56000785769912, 91.69543721548138, 47.01922514991191, 179.53290002839813, 9.016936778040177, 95.77804871614178, 16.112108147374823, 409.073515288593, 72.84671657736078, 4.538329576287064, 20.025112565421693, 496.86032778901415, 9.969248139628034, 12.509753326157215, 30.151184177096084, 118.156832823386, 84.11908913943132, 210.3728922800954, 265.8748493488399, 328.58126868644405, 207.4950142189265, 53.29360973807258, 191.81268293030038, 181.9532726143158, 34.32609965728579, 419.0741277626539, 507.09209984610254, 3.6866254483087597, 0.0, 523.6423162407084, 277.19881898776885, 567.9332782603329, 351.9880565508031, 449.37705210442186, 55.272144712529766, 142.0791897418262, 24.130210605617805, 327.76278216894764, 493.9228671645195, 28.73160736903369, 301.30648091996187, 387.4538227839292, 400.9578434667772, 147.78984418518215, 341.27549602292896, 82.2971629226459, 419.89324198441443, 354.9717285106729, 190.43207134350547, 332.6598864905601, 445.4217921229003, 274.2352503914599, 101.80755488043509, 223.4965040434423, 5.034639402852736, 328.8097289953261, 149.8376257803187, 213.4116980269079, 222.85585336221445, 348.4589065219371, 342.0620126456857, 285.4754416096896, 392.4371355596233, 173.1290877200656, 322.2948573764051, 375.24147316690926, 495.66595856296414, 30.896490772565127, 34.78224929794727, 313.7134934131484, 489.91279452404245, 16.26588053888318, 447.0013461971262, 253.6186960844392, 444.7701530618505, 550.1135129023844, 0.0, 284.98240711189277, 6.560703912036213, 110.74371288992839, 267.76451744971274, 515.4887634071608, 55.418512769485545, 418.82109583893276, 259.6644806189377, 115.30471607475677, 98.57649059573785, 32.800385044295346, 69.28509365602471, 433.67828908745344, 413.88371474591673, 322.7162413557721, 253.31316102752285, 430.54555477162455, 514.6951944178086, 441.70887993231975, 481.45628167181053, 447.7688657182459, 463.1490750184262, 609.1189421791997, 252.41709168182481, 19.270298275104714, 19.405118777761565, 313.6972487273668, 347.7366250372517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8257641294087412, "mean_inference_ms": 2.6678401722064113, "mean_action_processing_ms": 0.3698984102033303, "mean_env_wait_ms": 0.30501393883841466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057048797607421875, "StateBufferConnector_ms": 0.0034415721893310547, "ViewRequirementAgentConnector_ms": 0.11855447292327881}, "num_episodes": 18, "episode_return_max": 377.67972064434855, "episode_return_min": -169.6193921148538, "episode_return_mean": 132.6832675142022, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.6489106128182, "num_env_steps_trained_throughput_per_sec": 269.6489106128182, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 15275.359, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15275.308, "sample_time_ms": 2394.988, "learn_time_ms": 12852.523, "learn_throughput": 311.223, "synch_weights_time_ms": 26.319}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "6c58f_00000", "date": "2024-08-16_16-20-18", "timestamp": 1723805418, "time_this_iter_s": 14.840647220611572, "time_total_s": 801.2688744068146, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0502c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 801.2688744068146, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 61.07142857142856, "ram_util_percent": 80.12380952380951}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2213130821942022, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 8.431261394894312, "policy_loss": -0.0051836198762492845, "vf_loss": 8.435563398290563, "vf_explained_var": 0.011040786775962385, "kl": 0.0061919945090442635, "entropy": 1.5172240969365236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4165564361545775, "cur_kl_coeff": 0.00625, "cur_lr": 1e-05, "total_loss": 8.566947867882945, "policy_loss": -0.0027633227999248203, "vf_loss": 8.569680468745963, "vf_explained_var": -0.02876678569607003, "kl": 0.004910497489824916, "entropy": 1.3946837203843252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 377.67972064434855, "episode_reward_min": -181.24967936536157, "episode_reward_mean": 125.14783813642174, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -718.8749495116963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.04846351269447, "predator_policy": 682.8622535910789}, "policy_reward_mean": {"prey_policy": -154.9143864302812, "predator_policy": 217.4883054984921}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.74000000000046, 61.78403420282284, 297.89243281155547, 214.60999999999967, 99.55000000000028, 248.82777912237088, 203.28994354412492, 217.40598394908153, 237.7660985353208, 152.41000000000008, 117.24000000000045, 65.3899999999999, 211.77143007608237, 300.95407981365804, 106.05000000000035, 160.12999999999994, 33.346727350712456, 211.29429098652753, 304.5699999999997, 242.87424143602078, 146.4628612563709, 14.777256007342421, 103.25000000000043, 122.34293339439147, 93.11011685187185, 79.96634783588244, 175.38231795988472, 31.400758397253288, 106.83564810137803, 221.51491169072855, 169.53999999999985, 142.7800000000003, 136.04000000000025, 160.58999999999983, 341.39999999999986, 142.51067284028906, 317.4201686189502, 118.90000000000033, 175.784259946203, 139.4830895285454, 208.1036182295352, 228.2386872509546, 109.80743410421387, 339.5799999999998, -59.177491784012894, 46.367430782241364, -6.167179535367289, 118.6103211902082, 200.82679067341732, 169.56866198327293, 33.49000000000001, 97.47999999999996, 84.22067696720526, 32.85817943124968, 341.11305760378326, 183.5590730947805, 73.03999999999995, 92.37934066111079, 47.50934559613274, 40.48000000000003, 276.623246527152, 291.0230222289881, 7.895906876339783, 309.1299143100822, 239.49257068422676, 32.27423327169297, 74.97727056008222, -40.821463737933115, -26.072724671885872, 57.538194717405005, -58.724314539274246, -17.784349043016032, 107.87133126033375, 3.489999999999971, 279.51712778826925, 93.53856396236974, -169.6193921148538, 38.62864899542277, 125.73476987826074, 47.76675495804639, 377.67972064434855, 26.67000000000008, 160.1499999999998, 33.05361751402089, 148.93999999999988, 49.341748904905714, 113.33020162600799, 77.97000042673618, 124.14334990713066, 24.8016259493458, 107.72739885575491, 54.014021774165776, 163.39397979080542, 266.2404527729127, 6.891327256180334, 105.7646657112484, 68.33086468437247, 93.54487477179417, 33.29000000000018, -181.24967936536157], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.90895181980028, 8.389050751995601, 2.6357782199729485, 44.149443427583364, 146.66815259988311, 143.53642810350334, 48.88860809716936, 131.15905901692346, 60.56970465444881, -36.29128193993897, -78.8843618141654, 90.58971787799861, -40.261937754292276, -45.82981607068519, 7.94096122384939, 45.53179384726318, 60.21785217474972, 68.93137043828258, -3.4987461026814906, 146.84198564229874, 64.34644089383224, -43.80302030863906, -3.2164378153354356, -136.22003266182048, -134.3013888823958, 17.191862838104726, 141.26097132525356, 102.41033469370838, -113.14774528022511, -4.1444625865720015, -31.344171838581318, 143.92462215452198, -19.195349060926183, -397.0264896258138, -17.510969828669786, 75.26510839432657, 152.08513010328335, 71.00738004641178, 32.39919063234055, 80.47230821245455, -75.6618535376756, 3.7300908626312266, -212.97767671370124, -4.064693147722876, -23.4894572804144, -35.94797065533289, -52.834342610257615, -94.65373376725411, -137.21491459374593, -149.4982185585467, -585.9016033875141, -125.89168347163135, -89.0447059906709, -211.73911483675897, -188.28748598201926, -511.4171730510218, 71.19215515214867, -386.34286063293223, -27.95177832152936, 63.134971726445556, -90.21543721548069, 121.0407748500881, -53.80710606161677, 8.037269255178455, 38.40195128385822, -14.252108147374862, -408.6335152885932, 87.30328342263923, 172.64167042371292, 144.19488743457833, -462.1797092889417, 97.86080620058887, 131.39201657642332, 143.36721453927368, -0.9268328233860144, -82.44908913943047, -17.452195180025324, -283.0112865027062, 2.0000000000000013, -398.5931933768253, -53.40129833115566, 16.398623892317794, -61.40234074277522, 73.36165572212836, -542.6022267483047, -273.75656675623804, 166.58337455169124, 169.30999999999995, -415.63529480266817, -444.3833322098219, -552.9479953640853, -320.60590866480914, -280.1451949649752, -230.67118138734327, -35.139138732793874, -12.459940424442285, -611.1758851740352, -9.682973486014703, -217.53429795780582, 57.06487165208319, -386.98382278392955, -367.93784346677717, -50.75984418518217, -340.82549602292914, -231.93719004810018, -186.03253789175477, -297.4426785849859, -215.10294183794284, 94.40083987425062, -531.3694608839278, -355.8537321771145, 163.37000000000006, 2.0000000000000013, -157.49114344629498, -200.12820251733598, -186.13981159719793, -293.3880156553434, -95.37019013764645, -308.3689065219371, -341.67201264568604, -370.7308455400578, -30.55848510210329, 164.16221832192315, -368.5631411894055, -370.7151446487642, -492.29638020476955, 115.09973867854535, 128.35143556102466, -386.6922538912097, -177.4414633617549, 1.0407407364114907, -432.0337342007278, -387.24642212327836, -236.1651564629291, -146.4569998869565, -444.4779767533615, -209.4071216470535, -108.20871404876105, -23.911634739173355, -297.05840088306263, -166.55109482443268, -463.080495891488, -406.2516394677125, -290.01828603317443, -41.1304933341634, -64.87938207599747, -31.819334175427468, -66.77614452489215, -540.3294625108452, -27.715413534254502, -405.20645798148047, -77.28438043944496, -551.2843225824695, -563.5758187218164, -518.9977426234411, -365.53876998526647, -203.0734156450936, -582.1097552133164, -628.9952596227995, -184.77401928017883, 185.04846351269447, 153.9558400787879, -287.6272487273667, -347.13662503725146, -15.668719936833025, 133.31223632658276, -521.6429801103744, -685.0764622835494, -215.73931560992833, -9.989386886660157, -552.6568172253392, -606.1542153335624, -28.731101663423225, -32.913823170038505, -337.6929903341208, -4.645133891721519, -675.390211010107, -269.40384587572504, -575.0843020194586, -505.8307459398215, -7.282653516588828, -27.02001587301902, -223.068581933602, -64.8645476276208, -144.15943927913997, -459.39103858953035, -37.11974509671348, -718.8749495116963, -388.86276763989065, -361.5308083179427, -185.2359118855472, -87.02362041155459, -0.8706686679051376, -265.2627215557421, -512.7275235680212, -19.948552617584525, -283.05805094982634, -7.182090489477465, -479.2535859331811, -620.0165049260788], "policy_predator_policy_reward": [60.99365550049416, 24.44834192770983, 9.5159071755938, 5.4829053796729745, 5.914768771900974, 1.7730833362684795, 17.331391902830628, 17.230940983076625, 37.21029534555115, 38.061281939938624, 112.17275409565528, 124.94966896288247, 221.79753708468755, 67.584160284415, 33.54988555272944, 130.38334332523934, 38.82001983395173, 69.79685608833682, 5.448746102681454, 3.618014357701282, 51.23355910616771, 45.46302030863873, 0.0, 204.8264704771557, 246.28529310407902, 82.5956630162945, 31.60845458740547, 25.674319207290942, 32.32075185230473, 191.0214560144923, 34.32421364586707, 13.225336038192191, 399.4370292339619, 50.13153680349064, 140.8509698286699, 12.6891825922009, 11.194869896716687, 70.28261995358821, 31.910734704206064, 98.09200788701963, 22.894555795709323, 195.50006813570621, 5.538956131465724, 226.28066973730049, 145.6403362254144, 17.04709171033322, 260.0424482800149, 9.788561491888263, 221.96939548622285, 157.8538545179408, 346.6881423851015, 445.07149230992655, 266.577353639261, 209.58878514805386, 199.1279234819923, 531.977493948302, 15.643492949229202, 406.34286063293223, 87.77171042811337, 98.56000785769912, 91.69543721548138, 47.01922514991191, 179.53290002839813, 9.016936778040177, 95.77804871614178, 16.112108147374823, 409.073515288593, 72.84671657736078, 4.538329576287064, 20.025112565421693, 496.86032778901415, 9.969248139628034, 12.509753326157215, 30.151184177096084, 118.156832823386, 84.11908913943132, 210.3728922800954, 265.8748493488399, 328.58126868644405, 207.4950142189265, 53.29360973807258, 191.81268293030038, 181.9532726143158, 34.32609965728579, 419.0741277626539, 507.09209984610254, 3.6866254483087597, 0.0, 523.6423162407084, 277.19881898776885, 567.9332782603329, 351.9880565508031, 449.37705210442186, 55.272144712529766, 142.0791897418262, 24.130210605617805, 327.76278216894764, 493.9228671645195, 28.73160736903369, 301.30648091996187, 387.4538227839292, 400.9578434667772, 147.78984418518215, 341.27549602292896, 82.2971629226459, 419.89324198441443, 354.9717285106729, 190.43207134350547, 332.6598864905601, 445.4217921229003, 274.2352503914599, 101.80755488043509, 223.4965040434423, 5.034639402852736, 328.8097289953261, 149.8376257803187, 213.4116980269079, 222.85585336221445, 348.4589065219371, 342.0620126456857, 285.4754416096896, 392.4371355596233, 173.1290877200656, 322.2948573764051, 375.24147316690926, 495.66595856296414, 30.896490772565127, 34.78224929794727, 313.7134934131484, 489.91279452404245, 16.26588053888318, 447.0013461971262, 253.6186960844392, 444.7701530618505, 550.1135129023844, 0.0, 284.98240711189277, 6.560703912036213, 110.74371288992839, 267.76451744971274, 515.4887634071608, 55.418512769485545, 418.82109583893276, 259.6644806189377, 115.30471607475677, 98.57649059573785, 32.800385044295346, 69.28509365602471, 433.67828908745344, 413.88371474591673, 322.7162413557721, 253.31316102752285, 430.54555477162455, 514.6951944178086, 441.70887993231975, 481.45628167181053, 447.7688657182459, 463.1490750184262, 609.1189421791997, 252.41709168182481, 19.270298275104714, 19.405118777761565, 313.6972487273668, 347.7366250372517, 17.508719936833046, 24.99776367341722, 682.8622535910789, 556.9108063168667, 215.5112816211784, 159.15742087541, 584.1137828970559, 624.0389985667509, 145.90646311706723, 29.06866334240217, 132.67697526186285, 287.6311493907152, 538.532547458673, 530.4048593342894, 678.3768195400962, 427.33985436853, 85.42600668546919, 56.6040615598931, 182.66045719964498, 159.28669413574332, 267.61502999288234, 499.32942766659363, 493.56915376606565, 528.6659936152561, 460.6484527450004, 296.63645046901354, 146.31372356829644, 231.71047444005353, 14.05153335227774, 320.41272155574194, 276.3000354168933, 349.9209155405069, 44.04467622247819, 279.4854652168255, 307.40273764555815, 610.6176738483408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8250616335863913, "mean_inference_ms": 2.665369606643675, "mean_action_processing_ms": 0.36906113413357117, "mean_env_wait_ms": 0.3044223234015553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005416154861450195, "StateBufferConnector_ms": 0.0035877227783203125, "ViewRequirementAgentConnector_ms": 0.11535060405731201}, "num_episodes": 18, "episode_return_max": 377.67972064434855, "episode_return_min": -181.24967936536157, "episode_return_mean": 125.14783813642174, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.0279151661328, "num_env_steps_trained_throughput_per_sec": 276.0279151661328, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 15110.045, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15109.995, "sample_time_ms": 2303.16, "learn_time_ms": 12780.402, "learn_throughput": 312.979, "synch_weights_time_ms": 25.024}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "6c58f_00000", "date": "2024-08-16_16-20-33", "timestamp": 1723805433, "time_this_iter_s": 14.50559401512146, "time_total_s": 815.774468421936, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 815.774468421936, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 61.085714285714296, "ram_util_percent": 80.1047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1989537667029748, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 9.17232129283683, "policy_loss": -0.0017591948648076998, "vf_loss": 9.173221679465481, "vf_explained_var": 0.013834269273848761, "kl": 0.00603144382306915, "entropy": 1.5061098505580237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7534207012602891, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 8.802643856169686, "policy_loss": -0.00628962568376982, "vf_loss": 8.808905921158967, "vf_explained_var": -0.01841807207733235, "kl": 0.008811775808391174, "entropy": 1.345726701506862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 377.67972064434855, "episode_reward_min": -264.66337114959606, "episode_reward_mean": 93.56493349806098, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.7571303915119, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.04846351269447, "predator_policy": 725.6708643660545}, "policy_reward_mean": {"prey_policy": -242.01205669861338, "predator_policy": 288.79452344764394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.25000000000043, 122.34293339439147, 93.11011685187185, 79.96634783588244, 175.38231795988472, 31.400758397253288, 106.83564810137803, 221.51491169072855, 169.53999999999985, 142.7800000000003, 136.04000000000025, 160.58999999999983, 341.39999999999986, 142.51067284028906, 317.4201686189502, 118.90000000000033, 175.784259946203, 139.4830895285454, 208.1036182295352, 228.2386872509546, 109.80743410421387, 339.5799999999998, -59.177491784012894, 46.367430782241364, -6.167179535367289, 118.6103211902082, 200.82679067341732, 169.56866198327293, 33.49000000000001, 97.47999999999996, 84.22067696720526, 32.85817943124968, 341.11305760378326, 183.5590730947805, 73.03999999999995, 92.37934066111079, 47.50934559613274, 40.48000000000003, 276.623246527152, 291.0230222289881, 7.895906876339783, 309.1299143100822, 239.49257068422676, 32.27423327169297, 74.97727056008222, -40.821463737933115, -26.072724671885872, 57.538194717405005, -58.724314539274246, -17.784349043016032, 107.87133126033375, 3.489999999999971, 279.51712778826925, 93.53856396236974, -169.6193921148538, 38.62864899542277, 125.73476987826074, 47.76675495804639, 377.67972064434855, 26.67000000000008, 160.1499999999998, 33.05361751402089, 148.93999999999988, 49.341748904905714, 113.33020162600799, 77.97000042673618, 124.14334990713066, 24.8016259493458, 107.72739885575491, 54.014021774165776, 163.39397979080542, 266.2404527729127, 6.891327256180334, 105.7646657112484, 68.33086468437247, 93.54487477179417, 33.29000000000018, -181.24967936536157, -151.9960470471718, 224.12579553377145, 287.36399293646747, -264.66337114959606, -254.53422084260183, 63.080770523366645, -157.13583526363402, 202.57279276469671, 183.90384965103354, 105.64585065406128, -49.65295668694306, -177.3206574412094, 302.9166444205094, 64.04681888803725, 276.9496457831378, 48.17181713716482, 21.520000000000117, -21.815009189993123, -61.81863697226125, 11.542823472616996, 153.41764673232504, -136.47501864786182], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.4894572804144, -35.94797065533289, -52.834342610257615, -94.65373376725411, -137.21491459374593, -149.4982185585467, -585.9016033875141, -125.89168347163135, -89.0447059906709, -211.73911483675897, -188.28748598201926, -511.4171730510218, 71.19215515214867, -386.34286063293223, -27.95177832152936, 63.134971726445556, -90.21543721548069, 121.0407748500881, -53.80710606161677, 8.037269255178455, 38.40195128385822, -14.252108147374862, -408.6335152885932, 87.30328342263923, 172.64167042371292, 144.19488743457833, -462.1797092889417, 97.86080620058887, 131.39201657642332, 143.36721453927368, -0.9268328233860144, -82.44908913943047, -17.452195180025324, -283.0112865027062, 2.0000000000000013, -398.5931933768253, -53.40129833115566, 16.398623892317794, -61.40234074277522, 73.36165572212836, -542.6022267483047, -273.75656675623804, 166.58337455169124, 169.30999999999995, -415.63529480266817, -444.3833322098219, -552.9479953640853, -320.60590866480914, -280.1451949649752, -230.67118138734327, -35.139138732793874, -12.459940424442285, -611.1758851740352, -9.682973486014703, -217.53429795780582, 57.06487165208319, -386.98382278392955, -367.93784346677717, -50.75984418518217, -340.82549602292914, -231.93719004810018, -186.03253789175477, -297.4426785849859, -215.10294183794284, 94.40083987425062, -531.3694608839278, -355.8537321771145, 163.37000000000006, 2.0000000000000013, -157.49114344629498, -200.12820251733598, -186.13981159719793, -293.3880156553434, -95.37019013764645, -308.3689065219371, -341.67201264568604, -370.7308455400578, -30.55848510210329, 164.16221832192315, -368.5631411894055, -370.7151446487642, -492.29638020476955, 115.09973867854535, 128.35143556102466, -386.6922538912097, -177.4414633617549, 1.0407407364114907, -432.0337342007278, -387.24642212327836, -236.1651564629291, -146.4569998869565, -444.4779767533615, -209.4071216470535, -108.20871404876105, -23.911634739173355, -297.05840088306263, -166.55109482443268, -463.080495891488, -406.2516394677125, -290.01828603317443, -41.1304933341634, -64.87938207599747, -31.819334175427468, -66.77614452489215, -540.3294625108452, -27.715413534254502, -405.20645798148047, -77.28438043944496, -551.2843225824695, -563.5758187218164, -518.9977426234411, -365.53876998526647, -203.0734156450936, -582.1097552133164, -628.9952596227995, -184.77401928017883, 185.04846351269447, 153.9558400787879, -287.6272487273667, -347.13662503725146, -15.668719936833025, 133.31223632658276, -521.6429801103744, -685.0764622835494, -215.73931560992833, -9.989386886660157, -552.6568172253392, -606.1542153335624, -28.731101663423225, -32.913823170038505, -337.6929903341208, -4.645133891721519, -675.390211010107, -269.40384587572504, -575.0843020194586, -505.8307459398215, -7.282653516588828, -27.02001587301902, -223.068581933602, -64.8645476276208, -144.15943927913997, -459.39103858953035, -37.11974509671348, -718.8749495116963, -388.86276763989065, -361.5308083179427, -185.2359118855472, -87.02362041155459, -0.8706686679051376, -265.2627215557421, -512.7275235680212, -19.948552617584525, -283.05805094982634, -7.182090489477465, -479.2535859331811, -620.0165049260788, -406.2792751574334, -470.57349570180946, -12.831519961010452, -403.7284581749662, -669.0659856017062, -1.3983407689703868, -519.3348256363328, -525.1448083927586, -446.98247612700027, -594.630985056015, -17.116091750922465, -466.79170604564325, -652.7983311384063, -502.40068367781686, -43.58522378677038, -355.8642768429481, -31.260788869296526, -391.469482153937, -103.10462898743164, -139.55161299144945, -403.60995118913866, -315.7275976725454, -353.3461115522378, -327.1716750836529, -51.047734383548196, -654.7101653097985, -725.6098926009909, -523.3258150240184, -6.211932292792019, -772.7571303915119, -61.423005707775054, -325.9961466379611, -147.2408162632701, -331.82665910975885, -605.0412833623284, -591.647194468702, -657.7007321803187, -653.7873269600187, -470.5892267879263, -485.00750735865347, 2.0000000000000013, -578.6587844411185, -546.0886313870785, -500.4238735959041], "policy_predator_policy_reward": [145.6403362254144, 17.04709171033322, 260.0424482800149, 9.788561491888263, 221.96939548622285, 157.8538545179408, 346.6881423851015, 445.07149230992655, 266.577353639261, 209.58878514805386, 199.1279234819923, 531.977493948302, 15.643492949229202, 406.34286063293223, 87.77171042811337, 98.56000785769912, 91.69543721548138, 47.01922514991191, 179.53290002839813, 9.016936778040177, 95.77804871614178, 16.112108147374823, 409.073515288593, 72.84671657736078, 4.538329576287064, 20.025112565421693, 496.86032778901415, 9.969248139628034, 12.509753326157215, 30.151184177096084, 118.156832823386, 84.11908913943132, 210.3728922800954, 265.8748493488399, 328.58126868644405, 207.4950142189265, 53.29360973807258, 191.81268293030038, 181.9532726143158, 34.32609965728579, 419.0741277626539, 507.09209984610254, 3.6866254483087597, 0.0, 523.6423162407084, 277.19881898776885, 567.9332782603329, 351.9880565508031, 449.37705210442186, 55.272144712529766, 142.0791897418262, 24.130210605617805, 327.76278216894764, 493.9228671645195, 28.73160736903369, 301.30648091996187, 387.4538227839292, 400.9578434667772, 147.78984418518215, 341.27549602292896, 82.2971629226459, 419.89324198441443, 354.9717285106729, 190.43207134350547, 332.6598864905601, 445.4217921229003, 274.2352503914599, 101.80755488043509, 223.4965040434423, 5.034639402852736, 328.8097289953261, 149.8376257803187, 213.4116980269079, 222.85585336221445, 348.4589065219371, 342.0620126456857, 285.4754416096896, 392.4371355596233, 173.1290877200656, 322.2948573764051, 375.24147316690926, 495.66595856296414, 30.896490772565127, 34.78224929794727, 313.7134934131484, 489.91279452404245, 16.26588053888318, 447.0013461971262, 253.6186960844392, 444.7701530618505, 550.1135129023844, 0.0, 284.98240711189277, 6.560703912036213, 110.74371288992839, 267.76451744971274, 515.4887634071608, 55.418512769485545, 418.82109583893276, 259.6644806189377, 115.30471607475677, 98.57649059573785, 32.800385044295346, 69.28509365602471, 433.67828908745344, 413.88371474591673, 322.7162413557721, 253.31316102752285, 430.54555477162455, 514.6951944178086, 441.70887993231975, 481.45628167181053, 447.7688657182459, 463.1490750184262, 609.1189421791997, 252.41709168182481, 19.270298275104714, 19.405118777761565, 313.6972487273668, 347.7366250372517, 17.508719936833046, 24.99776367341722, 682.8622535910789, 556.9108063168667, 215.5112816211784, 159.15742087541, 584.1137828970559, 624.0389985667509, 145.90646311706723, 29.06866334240217, 132.67697526186285, 287.6311493907152, 538.532547458673, 530.4048593342894, 678.3768195400962, 427.33985436853, 85.42600668546919, 56.6040615598931, 182.66045719964498, 159.28669413574332, 267.61502999288234, 499.32942766659363, 493.56915376606565, 528.6659936152561, 460.6484527450004, 296.63645046901354, 146.31372356829644, 231.71047444005353, 14.05153335227774, 320.41272155574194, 276.3000354168933, 349.9209155405069, 44.04467622247819, 279.4854652168255, 307.40273764555815, 610.6176738483408, 518.6406287033396, 206.2160951087317, 308.47833892015035, 332.2074347495986, 495.5469920277509, 462.28132727939374, 182.27725285093643, 597.5390100285586, 717.6564924209605, 69.42274791945269, 100.26242560284699, 446.72614271708534, 725.6708643660545, 272.39231518653537, 308.11545718889, 293.9068362055249, 363.5430992418555, 243.0910214324112, 259.62771944322895, 88.67437318971328, 232.43943520108996, 437.24515697365115, 17.940387802096794, 485.2567413925841, 418.09766054102363, 590.5768835728321, 698.5472556276937, 614.4352708853529, 507.6816172909059, 548.2370911765373, 126.10954984770696, 309.48141963519384, 148.7208162632691, 351.8666591097589, 531.0273752363416, 643.8460934046957, 685.6923410839007, 563.9770810841762, 464.1416128410631, 502.99794477813333, 176.4928163199792, 553.5836148534643, 369.8560116246577, 540.1814747104626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8263360267927475, "mean_inference_ms": 2.6685348038794854, "mean_action_processing_ms": 0.36909637056539274, "mean_env_wait_ms": 0.3044117555318907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004924178123474121, "StateBufferConnector_ms": 0.003694772720336914, "ViewRequirementAgentConnector_ms": 0.1341344118118286}, "num_episodes": 22, "episode_return_max": 377.67972064434855, "episode_return_min": -264.66337114959606, "episode_return_mean": 93.56493349806098, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.97844228096682, "num_env_steps_trained_throughput_per_sec": 253.97844228096682, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 15129.364, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15129.317, "sample_time_ms": 2318.093, "learn_time_ms": 12789.395, "learn_throughput": 312.759, "synch_weights_time_ms": 20.39}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "6c58f_00000", "date": "2024-08-16_16-20-49", "timestamp": 1723805449, "time_this_iter_s": 15.764401912689209, "time_total_s": 831.5388703346252, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3356310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 831.5388703346252, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 65.76818181818183, "ram_util_percent": 80.60454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5325285194569795, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 8.615234729978773, "policy_loss": -0.0062768466595718, "vf_loss": 8.619678468552847, "vf_explained_var": 0.00324161620367141, "kl": 0.01287448780682818, "entropy": 1.46119190795081, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8799592718403175, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 9.117199882123836, "policy_loss": -0.00401062835328202, "vf_loss": 9.12117922394364, "vf_explained_var": 0.0026154112563562142, "kl": 0.010012008945098431, "entropy": 1.3183293258071576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 396.70360142300336, "episode_reward_min": -264.66337114959606, "episode_reward_mean": 81.63732009676036, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.7571303915119, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.04846351269447, "predator_policy": 725.6708643660545}, "policy_reward_mean": {"prey_policy": -278.38175000351083, "predator_policy": 319.200410051891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.367430782241364, -6.167179535367289, 118.6103211902082, 200.82679067341732, 169.56866198327293, 33.49000000000001, 97.47999999999996, 84.22067696720526, 32.85817943124968, 341.11305760378326, 183.5590730947805, 73.03999999999995, 92.37934066111079, 47.50934559613274, 40.48000000000003, 276.623246527152, 291.0230222289881, 7.895906876339783, 309.1299143100822, 239.49257068422676, 32.27423327169297, 74.97727056008222, -40.821463737933115, -26.072724671885872, 57.538194717405005, -58.724314539274246, -17.784349043016032, 107.87133126033375, 3.489999999999971, 279.51712778826925, 93.53856396236974, -169.6193921148538, 38.62864899542277, 125.73476987826074, 47.76675495804639, 377.67972064434855, 26.67000000000008, 160.1499999999998, 33.05361751402089, 148.93999999999988, 49.341748904905714, 113.33020162600799, 77.97000042673618, 124.14334990713066, 24.8016259493458, 107.72739885575491, 54.014021774165776, 163.39397979080542, 266.2404527729127, 6.891327256180334, 105.7646657112484, 68.33086468437247, 93.54487477179417, 33.29000000000018, -181.24967936536157, -151.9960470471718, 224.12579553377145, 287.36399293646747, -264.66337114959606, -254.53422084260183, 63.080770523366645, -157.13583526363402, 202.57279276469671, 183.90384965103354, 105.64585065406128, -49.65295668694306, -177.3206574412094, 302.9166444205094, 64.04681888803725, 276.9496457831378, 48.17181713716482, 21.520000000000117, -21.815009189993123, -61.81863697226125, 11.542823472616996, 153.41764673232504, -136.47501864786182, 92.34261315513923, 396.70360142300336, -47.095429826639695, 91.78458140902775, 256.92380182274263, 100.72030654843883, 12.780384009001033, 246.127682015882, 193.236617225023, 19.976441012995362, 77.32486009312069, -159.35371274936384, 245.52071506037177, -31.867614004160615, 94.92000000000002, 135.90166505944015, 11.68100318831728, 198.89934380989155, 141.7371775246922, -108.98022477260521, 244.76524985709375, 183.71307097459675, 14.280000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-552.9479953640853, -320.60590866480914, -280.1451949649752, -230.67118138734327, -35.139138732793874, -12.459940424442285, -611.1758851740352, -9.682973486014703, -217.53429795780582, 57.06487165208319, -386.98382278392955, -367.93784346677717, -50.75984418518217, -340.82549602292914, -231.93719004810018, -186.03253789175477, -297.4426785849859, -215.10294183794284, 94.40083987425062, -531.3694608839278, -355.8537321771145, 163.37000000000006, 2.0000000000000013, -157.49114344629498, -200.12820251733598, -186.13981159719793, -293.3880156553434, -95.37019013764645, -308.3689065219371, -341.67201264568604, -370.7308455400578, -30.55848510210329, 164.16221832192315, -368.5631411894055, -370.7151446487642, -492.29638020476955, 115.09973867854535, 128.35143556102466, -386.6922538912097, -177.4414633617549, 1.0407407364114907, -432.0337342007278, -387.24642212327836, -236.1651564629291, -146.4569998869565, -444.4779767533615, -209.4071216470535, -108.20871404876105, -23.911634739173355, -297.05840088306263, -166.55109482443268, -463.080495891488, -406.2516394677125, -290.01828603317443, -41.1304933341634, -64.87938207599747, -31.819334175427468, -66.77614452489215, -540.3294625108452, -27.715413534254502, -405.20645798148047, -77.28438043944496, -551.2843225824695, -563.5758187218164, -518.9977426234411, -365.53876998526647, -203.0734156450936, -582.1097552133164, -628.9952596227995, -184.77401928017883, 185.04846351269447, 153.9558400787879, -287.6272487273667, -347.13662503725146, -15.668719936833025, 133.31223632658276, -521.6429801103744, -685.0764622835494, -215.73931560992833, -9.989386886660157, -552.6568172253392, -606.1542153335624, -28.731101663423225, -32.913823170038505, -337.6929903341208, -4.645133891721519, -675.390211010107, -269.40384587572504, -575.0843020194586, -505.8307459398215, -7.282653516588828, -27.02001587301902, -223.068581933602, -64.8645476276208, -144.15943927913997, -459.39103858953035, -37.11974509671348, -718.8749495116963, -388.86276763989065, -361.5308083179427, -185.2359118855472, -87.02362041155459, -0.8706686679051376, -265.2627215557421, -512.7275235680212, -19.948552617584525, -283.05805094982634, -7.182090489477465, -479.2535859331811, -620.0165049260788, -406.2792751574334, -470.57349570180946, -12.831519961010452, -403.7284581749662, -669.0659856017062, -1.3983407689703868, -519.3348256363328, -525.1448083927586, -446.98247612700027, -594.630985056015, -17.116091750922465, -466.79170604564325, -652.7983311384063, -502.40068367781686, -43.58522378677038, -355.8642768429481, -31.260788869296526, -391.469482153937, -103.10462898743164, -139.55161299144945, -403.60995118913866, -315.7275976725454, -353.3461115522378, -327.1716750836529, -51.047734383548196, -654.7101653097985, -725.6098926009909, -523.3258150240184, -6.211932292792019, -772.7571303915119, -61.423005707775054, -325.9961466379611, -147.2408162632701, -331.82665910975885, -605.0412833623284, -591.647194468702, -657.7007321803187, -653.7873269600187, -470.5892267879263, -485.00750735865347, 2.0000000000000013, -578.6587844411185, -546.0886313870785, -500.4238735959041, -498.19323868436396, -346.3574480886521, 68.99448913305437, -619.7514778593849, -226.17019594696134, -319.4588103306416, -196.04248075024068, -509.63993660297393, -485.9970434559671, -49.71831540366053, -20.806559718754535, -5.345687053835001, -228.4717514281052, -410.76088877101796, -484.18780729150296, 161.47656211297559, 140.0079978769695, -508.4673070582711, -175.6847987073339, -222.44558441684705, -168.1025377165118, -2.291874862405253, -389.977878665267, -576.514520045324, -572.2283413623861, -21.956761123280543, -425.37817206636515, -529.3642266195691, -180.6670998325281, -328.75324685263513, -154.01760140797614, 30.799349504970948, -117.92617569213363, -517.2583412738113, -266.55153108215666, -217.60389900086096, -177.70203903515034, 36.362996331659495, -381.29632417760394, -733.6891606696648, -184.337144558191, -115.13541757271884, 38.107868221750856, -170.0942476674637, -476.676360117364, -451.36161191490356], "policy_predator_policy_reward": [567.9332782603329, 351.9880565508031, 449.37705210442186, 55.272144712529766, 142.0791897418262, 24.130210605617805, 327.76278216894764, 493.9228671645195, 28.73160736903369, 301.30648091996187, 387.4538227839292, 400.9578434667772, 147.78984418518215, 341.27549602292896, 82.2971629226459, 419.89324198441443, 354.9717285106729, 190.43207134350547, 332.6598864905601, 445.4217921229003, 274.2352503914599, 101.80755488043509, 223.4965040434423, 5.034639402852736, 328.8097289953261, 149.8376257803187, 213.4116980269079, 222.85585336221445, 348.4589065219371, 342.0620126456857, 285.4754416096896, 392.4371355596233, 173.1290877200656, 322.2948573764051, 375.24147316690926, 495.66595856296414, 30.896490772565127, 34.78224929794727, 313.7134934131484, 489.91279452404245, 16.26588053888318, 447.0013461971262, 253.6186960844392, 444.7701530618505, 550.1135129023844, 0.0, 284.98240711189277, 6.560703912036213, 110.74371288992839, 267.76451744971274, 515.4887634071608, 55.418512769485545, 418.82109583893276, 259.6644806189377, 115.30471607475677, 98.57649059573785, 32.800385044295346, 69.28509365602471, 433.67828908745344, 413.88371474591673, 322.7162413557721, 253.31316102752285, 430.54555477162455, 514.6951944178086, 441.70887993231975, 481.45628167181053, 447.7688657182459, 463.1490750184262, 609.1189421791997, 252.41709168182481, 19.270298275104714, 19.405118777761565, 313.6972487273668, 347.7366250372517, 17.508719936833046, 24.99776367341722, 682.8622535910789, 556.9108063168667, 215.5112816211784, 159.15742087541, 584.1137828970559, 624.0389985667509, 145.90646311706723, 29.06866334240217, 132.67697526186285, 287.6311493907152, 538.532547458673, 530.4048593342894, 678.3768195400962, 427.33985436853, 85.42600668546919, 56.6040615598931, 182.66045719964498, 159.28669413574332, 267.61502999288234, 499.32942766659363, 493.56915376606565, 528.6659936152561, 460.6484527450004, 296.63645046901354, 146.31372356829644, 231.71047444005353, 14.05153335227774, 320.41272155574194, 276.3000354168933, 349.9209155405069, 44.04467622247819, 279.4854652168255, 307.40273764555815, 610.6176738483408, 518.6406287033396, 206.2160951087317, 308.47833892015035, 332.2074347495986, 495.5469920277509, 462.28132727939374, 182.27725285093643, 597.5390100285586, 717.6564924209605, 69.42274791945269, 100.26242560284699, 446.72614271708534, 725.6708643660545, 272.39231518653537, 308.11545718889, 293.9068362055249, 363.5430992418555, 243.0910214324112, 259.62771944322895, 88.67437318971328, 232.43943520108996, 437.24515697365115, 17.940387802096794, 485.2567413925841, 418.09766054102363, 590.5768835728321, 698.5472556276937, 614.4352708853529, 507.6816172909059, 548.2370911765373, 126.10954984770696, 309.48141963519384, 148.7208162632691, 351.8666591097589, 531.0273752363416, 643.8460934046957, 685.6923410839007, 563.9770810841762, 464.1416128410631, 502.99794477813333, 176.4928163199792, 553.5836148534643, 369.8560116246577, 540.1814747104626, 503.3074795177356, 433.58582041041956, 577.8557388808481, 369.60485126848596, 369.29002615217513, 129.2435502987884, 419.97510928258396, 377.4918894796588, 396.08687389173025, 396.5522867906395, 101.88488316806237, 24.987670152965592, 447.45224336038285, 204.56078084774103, 206.1844294166094, 362.65449777780026, 116.42992691933142, 445.26599948699305, 281.0459411565455, 137.06088298063005, 26.3467349555258, 221.37253771651157, 566.8835831122333, 240.25510284899386, 426.78190951614687, 412.92390802989115, 415.08169532294283, 507.79308935883023, 274.8370998325281, 329.50324685263513, 110.2955065151919, 148.8244104472534, 27.751326405863786, 619.1141937483989, 305.3712252557833, 377.68354863712574, 32.759278376624465, 250.31694185155828, 644.481307253447, 361.52395282121614, 258.8103871274688, 285.427424860535, 155.4123215357864, 160.28712888452324, 490.686360117364, 451.63161191490343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8268701332861508, "mean_inference_ms": 2.670907992316527, "mean_action_processing_ms": 0.36902272815260057, "mean_env_wait_ms": 0.304295087940504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004465699195861816, "StateBufferConnector_ms": 0.0034993886947631836, "ViewRequirementAgentConnector_ms": 0.1307140588760376}, "num_episodes": 23, "episode_return_max": 396.70360142300336, "episode_return_min": -264.66337114959606, "episode_return_mean": 81.63732009676036, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.4635414423186, "num_env_steps_trained_throughput_per_sec": 276.4635414423186, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 14816.7, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14816.658, "sample_time_ms": 2138.511, "learn_time_ms": 12656.384, "learn_throughput": 316.046, "synch_weights_time_ms": 20.592}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "6c58f_00000", "date": "2024-08-16_16-21-03", "timestamp": 1723805463, "time_this_iter_s": 14.47403597831726, "time_total_s": 846.0129063129425, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 846.0129063129425, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 61.338095238095235, "ram_util_percent": 80.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3659718867332216, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 8.313847755502772, "policy_loss": -0.00314846170743405, "vf_loss": 8.315907448057144, "vf_explained_var": 0.007205478791837339, "kl": 0.007646742160646806, "entropy": 1.460694595871779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4466249996707552, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 7.569588096053512, "policy_loss": -0.004021098866699037, "vf_loss": 7.573568575722831, "vf_explained_var": -0.020125733513049977, "kl": 0.012994203175941958, "entropy": 1.3396077940072963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 396.70360142300336, "episode_reward_min": -264.66337114959606, "episode_reward_mean": 72.6128587323393, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.7571303915119, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.04846351269447, "predator_policy": 737.2243368167332}, "policy_reward_mean": {"prey_policy": -293.670232677818, "predator_policy": 329.9766620439877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [309.1299143100822, 239.49257068422676, 32.27423327169297, 74.97727056008222, -40.821463737933115, -26.072724671885872, 57.538194717405005, -58.724314539274246, -17.784349043016032, 107.87133126033375, 3.489999999999971, 279.51712778826925, 93.53856396236974, -169.6193921148538, 38.62864899542277, 125.73476987826074, 47.76675495804639, 377.67972064434855, 26.67000000000008, 160.1499999999998, 33.05361751402089, 148.93999999999988, 49.341748904905714, 113.33020162600799, 77.97000042673618, 124.14334990713066, 24.8016259493458, 107.72739885575491, 54.014021774165776, 163.39397979080542, 266.2404527729127, 6.891327256180334, 105.7646657112484, 68.33086468437247, 93.54487477179417, 33.29000000000018, -181.24967936536157, -151.9960470471718, 224.12579553377145, 287.36399293646747, -264.66337114959606, -254.53422084260183, 63.080770523366645, -157.13583526363402, 202.57279276469671, 183.90384965103354, 105.64585065406128, -49.65295668694306, -177.3206574412094, 302.9166444205094, 64.04681888803725, 276.9496457831378, 48.17181713716482, 21.520000000000117, -21.815009189993123, -61.81863697226125, 11.542823472616996, 153.41764673232504, -136.47501864786182, 92.34261315513923, 396.70360142300336, -47.095429826639695, 91.78458140902775, 256.92380182274263, 100.72030654843883, 12.780384009001033, 246.127682015882, 193.236617225023, 19.976441012995362, 77.32486009312069, -159.35371274936384, 245.52071506037177, -31.867614004160615, 94.92000000000002, 135.90166505944015, 11.68100318831728, 198.89934380989155, 141.7371775246922, -108.98022477260521, 244.76524985709375, 183.71307097459675, 14.280000000000001, 74.16000000000003, 0.14000000000000212, 28.41031584854978, -195.3693598812269, 225.75793439574767, 25.487149930775125, -15.909773866872591, -55.00802561843946, 189.75929360508252, -38.24439869939413, 2.489999999999995, 93.34916339516903, 104.34784574133168, 162.13039583097975, 173.17163170129692, 105.92275858898043, 229.65213313537095, 118.18467353105862], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [115.09973867854535, 128.35143556102466, -386.6922538912097, -177.4414633617549, 1.0407407364114907, -432.0337342007278, -387.24642212327836, -236.1651564629291, -146.4569998869565, -444.4779767533615, -209.4071216470535, -108.20871404876105, -23.911634739173355, -297.05840088306263, -166.55109482443268, -463.080495891488, -406.2516394677125, -290.01828603317443, -41.1304933341634, -64.87938207599747, -31.819334175427468, -66.77614452489215, -540.3294625108452, -27.715413534254502, -405.20645798148047, -77.28438043944496, -551.2843225824695, -563.5758187218164, -518.9977426234411, -365.53876998526647, -203.0734156450936, -582.1097552133164, -628.9952596227995, -184.77401928017883, 185.04846351269447, 153.9558400787879, -287.6272487273667, -347.13662503725146, -15.668719936833025, 133.31223632658276, -521.6429801103744, -685.0764622835494, -215.73931560992833, -9.989386886660157, -552.6568172253392, -606.1542153335624, -28.731101663423225, -32.913823170038505, -337.6929903341208, -4.645133891721519, -675.390211010107, -269.40384587572504, -575.0843020194586, -505.8307459398215, -7.282653516588828, -27.02001587301902, -223.068581933602, -64.8645476276208, -144.15943927913997, -459.39103858953035, -37.11974509671348, -718.8749495116963, -388.86276763989065, -361.5308083179427, -185.2359118855472, -87.02362041155459, -0.8706686679051376, -265.2627215557421, -512.7275235680212, -19.948552617584525, -283.05805094982634, -7.182090489477465, -479.2535859331811, -620.0165049260788, -406.2792751574334, -470.57349570180946, -12.831519961010452, -403.7284581749662, -669.0659856017062, -1.3983407689703868, -519.3348256363328, -525.1448083927586, -446.98247612700027, -594.630985056015, -17.116091750922465, -466.79170604564325, -652.7983311384063, -502.40068367781686, -43.58522378677038, -355.8642768429481, -31.260788869296526, -391.469482153937, -103.10462898743164, -139.55161299144945, -403.60995118913866, -315.7275976725454, -353.3461115522378, -327.1716750836529, -51.047734383548196, -654.7101653097985, -725.6098926009909, -523.3258150240184, -6.211932292792019, -772.7571303915119, -61.423005707775054, -325.9961466379611, -147.2408162632701, -331.82665910975885, -605.0412833623284, -591.647194468702, -657.7007321803187, -653.7873269600187, -470.5892267879263, -485.00750735865347, 2.0000000000000013, -578.6587844411185, -546.0886313870785, -500.4238735959041, -498.19323868436396, -346.3574480886521, 68.99448913305437, -619.7514778593849, -226.17019594696134, -319.4588103306416, -196.04248075024068, -509.63993660297393, -485.9970434559671, -49.71831540366053, -20.806559718754535, -5.345687053835001, -228.4717514281052, -410.76088877101796, -484.18780729150296, 161.47656211297559, 140.0079978769695, -508.4673070582711, -175.6847987073339, -222.44558441684705, -168.1025377165118, -2.291874862405253, -389.977878665267, -576.514520045324, -572.2283413623861, -21.956761123280543, -425.37817206636515, -529.3642266195691, -180.6670998325281, -328.75324685263513, -154.01760140797614, 30.799349504970948, -117.92617569213363, -517.2583412738113, -266.55153108215666, -217.60389900086096, -177.70203903515034, 36.362996331659495, -381.29632417760394, -733.6891606696648, -184.337144558191, -115.13541757271884, 38.107868221750856, -170.0942476674637, -476.676360117364, -451.36161191490356, -411.34950664478737, -217.93005054715744, -626.0024310342598, -469.05322614093586, -715.6092568265788, -615.1202430239045, -304.40192262029535, -558.1231863228099, -669.9155055730746, -101.94034133780367, -51.57059191354731, -13.05447220814267, -67.05424757445431, -66.04398088703246, -348.0067611639467, -224.226664313048, -36.009541113864266, -487.2685123561657, -605.2100664856652, -155.4548118450415, -445.3573849628046, -414.62442943151785, -101.11089447225692, -266.9649948158358, -216.5282071885567, -23.26428190014971, 21.959977483464428, -379.3521160645683, 2.0000000000000013, -583.3556450819993, -340.47719315319284, -318.83026562061997, -2.135203192322125, -636.1238086033122, -512.6315031261283, -66.58767819634406], "policy_predator_policy_reward": [30.896490772565127, 34.78224929794727, 313.7134934131484, 489.91279452404245, 16.26588053888318, 447.0013461971262, 253.6186960844392, 444.7701530618505, 550.1135129023844, 0.0, 284.98240711189277, 6.560703912036213, 110.74371288992839, 267.76451744971274, 515.4887634071608, 55.418512769485545, 418.82109583893276, 259.6644806189377, 115.30471607475677, 98.57649059573785, 32.800385044295346, 69.28509365602471, 433.67828908745344, 413.88371474591673, 322.7162413557721, 253.31316102752285, 430.54555477162455, 514.6951944178086, 441.70887993231975, 481.45628167181053, 447.7688657182459, 463.1490750184262, 609.1189421791997, 252.41709168182481, 19.270298275104714, 19.405118777761565, 313.6972487273668, 347.7366250372517, 17.508719936833046, 24.99776367341722, 682.8622535910789, 556.9108063168667, 215.5112816211784, 159.15742087541, 584.1137828970559, 624.0389985667509, 145.90646311706723, 29.06866334240217, 132.67697526186285, 287.6311493907152, 538.532547458673, 530.4048593342894, 678.3768195400962, 427.33985436853, 85.42600668546919, 56.6040615598931, 182.66045719964498, 159.28669413574332, 267.61502999288234, 499.32942766659363, 493.56915376606565, 528.6659936152561, 460.6484527450004, 296.63645046901354, 146.31372356829644, 231.71047444005353, 14.05153335227774, 320.41272155574194, 276.3000354168933, 349.9209155405069, 44.04467622247819, 279.4854652168255, 307.40273764555815, 610.6176738483408, 518.6406287033396, 206.2160951087317, 308.47833892015035, 332.2074347495986, 495.5469920277509, 462.28132727939374, 182.27725285093643, 597.5390100285586, 717.6564924209605, 69.42274791945269, 100.26242560284699, 446.72614271708534, 725.6708643660545, 272.39231518653537, 308.11545718889, 293.9068362055249, 363.5430992418555, 243.0910214324112, 259.62771944322895, 88.67437318971328, 232.43943520108996, 437.24515697365115, 17.940387802096794, 485.2567413925841, 418.09766054102363, 590.5768835728321, 698.5472556276937, 614.4352708853529, 507.6816172909059, 548.2370911765373, 126.10954984770696, 309.48141963519384, 148.7208162632691, 351.8666591097589, 531.0273752363416, 643.8460934046957, 685.6923410839007, 563.9770810841762, 464.1416128410631, 502.99794477813333, 176.4928163199792, 553.5836148534643, 369.8560116246577, 540.1814747104626, 503.3074795177356, 433.58582041041956, 577.8557388808481, 369.60485126848596, 369.29002615217513, 129.2435502987884, 419.97510928258396, 377.4918894796588, 396.08687389173025, 396.5522867906395, 101.88488316806237, 24.987670152965592, 447.45224336038285, 204.56078084774103, 206.1844294166094, 362.65449777780026, 116.42992691933142, 445.26599948699305, 281.0459411565455, 137.06088298063005, 26.3467349555258, 221.37253771651157, 566.8835831122333, 240.25510284899386, 426.78190951614687, 412.92390802989115, 415.08169532294283, 507.79308935883023, 274.8370998325281, 329.50324685263513, 110.2955065151919, 148.8244104472534, 27.751326405863786, 619.1141937483989, 305.3712252557833, 377.68354863712574, 32.759278376624465, 250.31694185155828, 644.481307253447, 361.52395282121614, 258.8103871274688, 285.427424860535, 155.4123215357864, 160.28712888452324, 490.686360117364, 451.63161191490343, 411.4495066447873, 291.9900505471573, 626.0024310342598, 469.19322614093574, 737.2243368167332, 621.9154788822999, 14.545649899811366, 652.6100991620676, 550.7512648769656, 446.86251642966135, 32.30940635062134, 57.80280770184283, 22.808746176746066, 94.37970841786924, 306.3495330333516, 210.87586682520353, 381.1363698841741, 331.9009771909394, 651.0595049944553, 71.36097463685716, 447.3573849628046, 415.11442943151775, 441.24170518522396, 20.18334749803794, 233.5009068163521, 110.63942801368553, 226.8310231673634, 292.69151124472063, 377.49014382762886, 377.0371329556677, 549.2071548996336, 216.0230624631598, 553.7401648834755, 314.17098004753075, 372.4099720673349, 324.993882786196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8271079565629605, "mean_inference_ms": 2.672540581051365, "mean_action_processing_ms": 0.3691641185655196, "mean_env_wait_ms": 0.3042118635851739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004565238952636719, "StateBufferConnector_ms": 0.0035724639892578125, "ViewRequirementAgentConnector_ms": 0.13737213611602783}, "num_episodes": 18, "episode_return_max": 396.70360142300336, "episode_return_min": -264.66337114959606, "episode_return_mean": 72.6128587323393, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.23500484771563, "num_env_steps_trained_throughput_per_sec": 271.23500484771563, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 14648.35, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14648.309, "sample_time_ms": 1952.66, "learn_time_ms": 12674.848, "learn_throughput": 315.586, "synch_weights_time_ms": 19.604}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "6c58f_00000", "date": "2024-08-16_16-21-18", "timestamp": 1723805478, "time_this_iter_s": 14.801092147827148, "time_total_s": 860.8139984607697, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334a9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 860.8139984607697, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 64.51500000000001, "ram_util_percent": 80.49500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2683986151186877, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 8.372519082367106, "policy_loss": -0.005147963376203306, "vf_loss": 8.37679277803532, "vf_explained_var": 0.007503769069752365, "kl": 0.006140372372074169, "entropy": 1.4404463986871103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.645248972013514, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 8.066173133900557, "policy_loss": -0.00458533699924826, "vf_loss": 8.070706919009092, "vf_explained_var": 0.00047519279535485325, "kl": 0.01649779331732093, "entropy": 1.288614847546532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 396.70360142300336, "episode_reward_min": -264.66337114959606, "episode_reward_mean": 69.59205400713077, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.7571303915119, "predator_policy": 1.8627835705431481}, "policy_reward_max": {"prey_policy": 161.47656211297559, "predator_policy": 737.2243368167332}, "policy_reward_mean": {"prey_policy": -300.94313328543933, "predator_policy": 335.7391602890047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.67000000000008, 160.1499999999998, 33.05361751402089, 148.93999999999988, 49.341748904905714, 113.33020162600799, 77.97000042673618, 124.14334990713066, 24.8016259493458, 107.72739885575491, 54.014021774165776, 163.39397979080542, 266.2404527729127, 6.891327256180334, 105.7646657112484, 68.33086468437247, 93.54487477179417, 33.29000000000018, -181.24967936536157, -151.9960470471718, 224.12579553377145, 287.36399293646747, -264.66337114959606, -254.53422084260183, 63.080770523366645, -157.13583526363402, 202.57279276469671, 183.90384965103354, 105.64585065406128, -49.65295668694306, -177.3206574412094, 302.9166444205094, 64.04681888803725, 276.9496457831378, 48.17181713716482, 21.520000000000117, -21.815009189993123, -61.81863697226125, 11.542823472616996, 153.41764673232504, -136.47501864786182, 92.34261315513923, 396.70360142300336, -47.095429826639695, 91.78458140902775, 256.92380182274263, 100.72030654843883, 12.780384009001033, 246.127682015882, 193.236617225023, 19.976441012995362, 77.32486009312069, -159.35371274936384, 245.52071506037177, -31.867614004160615, 94.92000000000002, 135.90166505944015, 11.68100318831728, 198.89934380989155, 141.7371775246922, -108.98022477260521, 244.76524985709375, 183.71307097459675, 14.280000000000001, 74.16000000000003, 0.14000000000000212, 28.41031584854978, -195.3693598812269, 225.75793439574767, 25.487149930775125, -15.909773866872591, -55.00802561843946, 189.75929360508252, -38.24439869939413, 2.489999999999995, 93.34916339516903, 104.34784574133168, 162.13039583097975, 173.17163170129692, 105.92275858898043, 229.65213313537095, 118.18467353105862, -8.618591868410338, 106.54999999999988, 79.39171198404878, 227.10041541791634, 11.993719683608203, 127.6742839564434, 193.51164856935497, 9.141577026366384, 30.79000000000007, -66.34597660247476, -128.0010658270946, -20.72697962426126, 105.66534486811577, 53.30479658522446, 206.9466724594014, 116.16400441956257, 47.61000000000003, 80.38482335492344], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-287.6272487273667, -347.13662503725146, -15.668719936833025, 133.31223632658276, -521.6429801103744, -685.0764622835494, -215.73931560992833, -9.989386886660157, -552.6568172253392, -606.1542153335624, -28.731101663423225, -32.913823170038505, -337.6929903341208, -4.645133891721519, -675.390211010107, -269.40384587572504, -575.0843020194586, -505.8307459398215, -7.282653516588828, -27.02001587301902, -223.068581933602, -64.8645476276208, -144.15943927913997, -459.39103858953035, -37.11974509671348, -718.8749495116963, -388.86276763989065, -361.5308083179427, -185.2359118855472, -87.02362041155459, -0.8706686679051376, -265.2627215557421, -512.7275235680212, -19.948552617584525, -283.05805094982634, -7.182090489477465, -479.2535859331811, -620.0165049260788, -406.2792751574334, -470.57349570180946, -12.831519961010452, -403.7284581749662, -669.0659856017062, -1.3983407689703868, -519.3348256363328, -525.1448083927586, -446.98247612700027, -594.630985056015, -17.116091750922465, -466.79170604564325, -652.7983311384063, -502.40068367781686, -43.58522378677038, -355.8642768429481, -31.260788869296526, -391.469482153937, -103.10462898743164, -139.55161299144945, -403.60995118913866, -315.7275976725454, -353.3461115522378, -327.1716750836529, -51.047734383548196, -654.7101653097985, -725.6098926009909, -523.3258150240184, -6.211932292792019, -772.7571303915119, -61.423005707775054, -325.9961466379611, -147.2408162632701, -331.82665910975885, -605.0412833623284, -591.647194468702, -657.7007321803187, -653.7873269600187, -470.5892267879263, -485.00750735865347, 2.0000000000000013, -578.6587844411185, -546.0886313870785, -500.4238735959041, -498.19323868436396, -346.3574480886521, 68.99448913305437, -619.7514778593849, -226.17019594696134, -319.4588103306416, -196.04248075024068, -509.63993660297393, -485.9970434559671, -49.71831540366053, -20.806559718754535, -5.345687053835001, -228.4717514281052, -410.76088877101796, -484.18780729150296, 161.47656211297559, 140.0079978769695, -508.4673070582711, -175.6847987073339, -222.44558441684705, -168.1025377165118, -2.291874862405253, -389.977878665267, -576.514520045324, -572.2283413623861, -21.956761123280543, -425.37817206636515, -529.3642266195691, -180.6670998325281, -328.75324685263513, -154.01760140797614, 30.799349504970948, -117.92617569213363, -517.2583412738113, -266.55153108215666, -217.60389900086096, -177.70203903515034, 36.362996331659495, -381.29632417760394, -733.6891606696648, -184.337144558191, -115.13541757271884, 38.107868221750856, -170.0942476674637, -476.676360117364, -451.36161191490356, -411.34950664478737, -217.93005054715744, -626.0024310342598, -469.05322614093586, -715.6092568265788, -615.1202430239045, -304.40192262029535, -558.1231863228099, -669.9155055730746, -101.94034133780367, -51.57059191354731, -13.05447220814267, -67.05424757445431, -66.04398088703246, -348.0067611639467, -224.226664313048, -36.009541113864266, -487.2685123561657, -605.2100664856652, -155.4548118450415, -445.3573849628046, -414.62442943151785, -101.11089447225692, -266.9649948158358, -216.5282071885567, -23.26428190014971, 21.959977483464428, -379.3521160645683, 2.0000000000000013, -583.3556450819993, -340.47719315319284, -318.83026562061997, -2.135203192322125, -636.1238086033122, -512.6315031261283, -66.58767819634406, -22.103709188273182, -19.91033952490026, 103.07721642945671, -84.0788210070172, -494.8599654115443, -331.7037834035437, -510.9256458069935, -9.199221586025908, -451.59222012834323, -83.98393772780095, -53.693734534440395, -113.3701003471902, -505.29839882792174, 6.475595806792796, -463.0558950803242, -535.6185739121244, -290.481905378158, -289.0256910507758, -155.04552732228382, -272.1719173048975, -589.4133218631019, -526.4444749950136, -349.01081223564796, -75.99931922691756, -23.177744593988958, -511.6287075287618, -225.83653342274573, -364.86593213457047, -551.7012169896266, -108.24372114943363, -316.7150954181038, -470.59688989124305, -292.2080147230108, -276.9050279378471, -360.6626607335923, -279.5994212728546], "policy_predator_policy_reward": [313.6972487273668, 347.7366250372517, 17.508719936833046, 24.99776367341722, 682.8622535910789, 556.9108063168667, 215.5112816211784, 159.15742087541, 584.1137828970559, 624.0389985667509, 145.90646311706723, 29.06866334240217, 132.67697526186285, 287.6311493907152, 538.532547458673, 530.4048593342894, 678.3768195400962, 427.33985436853, 85.42600668546919, 56.6040615598931, 182.66045719964498, 159.28669413574332, 267.61502999288234, 499.32942766659363, 493.56915376606565, 528.6659936152561, 460.6484527450004, 296.63645046901354, 146.31372356829644, 231.71047444005353, 14.05153335227774, 320.41272155574194, 276.3000354168933, 349.9209155405069, 44.04467622247819, 279.4854652168255, 307.40273764555815, 610.6176738483408, 518.6406287033396, 206.2160951087317, 308.47833892015035, 332.2074347495986, 495.5469920277509, 462.28132727939374, 182.27725285093643, 597.5390100285586, 717.6564924209605, 69.42274791945269, 100.26242560284699, 446.72614271708534, 725.6708643660545, 272.39231518653537, 308.11545718889, 293.9068362055249, 363.5430992418555, 243.0910214324112, 259.62771944322895, 88.67437318971328, 232.43943520108996, 437.24515697365115, 17.940387802096794, 485.2567413925841, 418.09766054102363, 590.5768835728321, 698.5472556276937, 614.4352708853529, 507.6816172909059, 548.2370911765373, 126.10954984770696, 309.48141963519384, 148.7208162632691, 351.8666591097589, 531.0273752363416, 643.8460934046957, 685.6923410839007, 563.9770810841762, 464.1416128410631, 502.99794477813333, 176.4928163199792, 553.5836148534643, 369.8560116246577, 540.1814747104626, 503.3074795177356, 433.58582041041956, 577.8557388808481, 369.60485126848596, 369.29002615217513, 129.2435502987884, 419.97510928258396, 377.4918894796588, 396.08687389173025, 396.5522867906395, 101.88488316806237, 24.987670152965592, 447.45224336038285, 204.56078084774103, 206.1844294166094, 362.65449777780026, 116.42992691933142, 445.26599948699305, 281.0459411565455, 137.06088298063005, 26.3467349555258, 221.37253771651157, 566.8835831122333, 240.25510284899386, 426.78190951614687, 412.92390802989115, 415.08169532294283, 507.79308935883023, 274.8370998325281, 329.50324685263513, 110.2955065151919, 148.8244104472534, 27.751326405863786, 619.1141937483989, 305.3712252557833, 377.68354863712574, 32.759278376624465, 250.31694185155828, 644.481307253447, 361.52395282121614, 258.8103871274688, 285.427424860535, 155.4123215357864, 160.28712888452324, 490.686360117364, 451.63161191490343, 411.4495066447873, 291.9900505471573, 626.0024310342598, 469.19322614093574, 737.2243368167332, 621.9154788822999, 14.545649899811366, 652.6100991620676, 550.7512648769656, 446.86251642966135, 32.30940635062134, 57.80280770184283, 22.808746176746066, 94.37970841786924, 306.3495330333516, 210.87586682520353, 381.1363698841741, 331.9009771909394, 651.0595049944553, 71.36097463685716, 447.3573849628046, 415.11442943151775, 441.24170518522396, 20.18334749803794, 233.5009068163521, 110.63942801368553, 226.8310231673634, 292.69151124472063, 377.49014382762886, 377.0371329556677, 549.2071548996336, 216.0230624631598, 553.7401648834755, 314.17098004753075, 372.4099720673349, 324.993882786196, 29.593707190638465, 3.8017496541252913, 1.8627835705431481, 85.68882100701803, 490.44216315712345, 415.5132976420133, 482.2514153490538, 264.9738674618819, 258.52133677166097, 289.04854076809164, 163.2375649506657, 131.5005538874081, 472.7624606425111, 219.57199094797238, 406.82847810322176, 600.9875679155921, 291.2719053781578, 319.02569105077566, 10.102250761251764, 350.76921726345375, 638.8499063541683, 349.0068246768528, 351.0238627808827, 53.259289057421356, 386.94945130800977, 253.5223456828571, 275.83653342274573, 368.17072871979457, 534.2346800233429, 332.6569305751199, 437.8873590504072, 465.58863067850206, 292.7380147230105, 323.985027937847, 401.73190022835644, 318.91500513301384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8274438554795687, "mean_inference_ms": 2.674426592973516, "mean_action_processing_ms": 0.36933589344799456, "mean_env_wait_ms": 0.30420590919263896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00449061393737793, "StateBufferConnector_ms": 0.0035254955291748047, "ViewRequirementAgentConnector_ms": 0.13047122955322266}, "num_episodes": 18, "episode_return_max": 396.70360142300336, "episode_return_min": -264.66337114959606, "episode_return_mean": 69.59205400713077, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.4775667110618, "num_env_steps_trained_throughput_per_sec": 269.4775667110618, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 14705.771, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14705.732, "sample_time_ms": 1960.471, "learn_time_ms": 12726.834, "learn_throughput": 314.297, "synch_weights_time_ms": 17.195}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "6c58f_00000", "date": "2024-08-16_16-21-33", "timestamp": 1723805493, "time_this_iter_s": 14.89310097694397, "time_total_s": 875.7070994377136, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b3356940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 875.7070994377136, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 60.47727272727272, "ram_util_percent": 80.42272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2907799329391862, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 8.457985779343458, "policy_loss": -0.008172100950673064, "vf_loss": 8.46439951437491, "vf_explained_var": 0.00878946301798341, "kl": 0.012349570271796794, "entropy": 1.4218530352784213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5128051028049811, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 7.0364929012520605, "policy_loss": -0.006997812898686678, "vf_loss": 7.043450680990068, "vf_explained_var": 0.006018121627272752, "kl": 0.012813597292698075, "entropy": 1.2321476795055248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 396.70360142300336, "episode_reward_min": -264.66337114959606, "episode_reward_mean": 70.85481269853412, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.7571303915119, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 161.47656211297559, "predator_policy": 737.2243368167332}, "policy_reward_mean": {"prey_policy": -288.66018067554774, "predator_policy": 324.0875870248147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-264.66337114959606, -254.53422084260183, 63.080770523366645, -157.13583526363402, 202.57279276469671, 183.90384965103354, 105.64585065406128, -49.65295668694306, -177.3206574412094, 302.9166444205094, 64.04681888803725, 276.9496457831378, 48.17181713716482, 21.520000000000117, -21.815009189993123, -61.81863697226125, 11.542823472616996, 153.41764673232504, -136.47501864786182, 92.34261315513923, 396.70360142300336, -47.095429826639695, 91.78458140902775, 256.92380182274263, 100.72030654843883, 12.780384009001033, 246.127682015882, 193.236617225023, 19.976441012995362, 77.32486009312069, -159.35371274936384, 245.52071506037177, -31.867614004160615, 94.92000000000002, 135.90166505944015, 11.68100318831728, 198.89934380989155, 141.7371775246922, -108.98022477260521, 244.76524985709375, 183.71307097459675, 14.280000000000001, 74.16000000000003, 0.14000000000000212, 28.41031584854978, -195.3693598812269, 225.75793439574767, 25.487149930775125, -15.909773866872591, -55.00802561843946, 189.75929360508252, -38.24439869939413, 2.489999999999995, 93.34916339516903, 104.34784574133168, 162.13039583097975, 173.17163170129692, 105.92275858898043, 229.65213313537095, 118.18467353105862, -8.618591868410338, 106.54999999999988, 79.39171198404878, 227.10041541791634, 11.993719683608203, 127.6742839564434, 193.51164856935497, 9.141577026366384, 30.79000000000007, -66.34597660247476, -128.0010658270946, -20.72697962426126, 105.66534486811577, 53.30479658522446, 206.9466724594014, 116.16400441956257, 47.61000000000003, 80.38482335492344, 94.39947740899093, 228.13014352081274, 14.109999999999975, -20.474661429587837, 147.6457589885282, 68.95067445471122, -54.86657598900304, 53.099999999999824, 146.56844680538538, 185.66534223349643, 38.18505952014693, 116.53684286876582, 212.02647807697033, 99.26743415489737, 7.545778927230292, 157.04707952362853, 54.854472135401124, 135.45493382090186, 240.1395255717989, -6.555012069968255, -54.54752477729734, 98.934387397612], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-519.3348256363328, -525.1448083927586, -446.98247612700027, -594.630985056015, -17.116091750922465, -466.79170604564325, -652.7983311384063, -502.40068367781686, -43.58522378677038, -355.8642768429481, -31.260788869296526, -391.469482153937, -103.10462898743164, -139.55161299144945, -403.60995118913866, -315.7275976725454, -353.3461115522378, -327.1716750836529, -51.047734383548196, -654.7101653097985, -725.6098926009909, -523.3258150240184, -6.211932292792019, -772.7571303915119, -61.423005707775054, -325.9961466379611, -147.2408162632701, -331.82665910975885, -605.0412833623284, -591.647194468702, -657.7007321803187, -653.7873269600187, -470.5892267879263, -485.00750735865347, 2.0000000000000013, -578.6587844411185, -546.0886313870785, -500.4238735959041, -498.19323868436396, -346.3574480886521, 68.99448913305437, -619.7514778593849, -226.17019594696134, -319.4588103306416, -196.04248075024068, -509.63993660297393, -485.9970434559671, -49.71831540366053, -20.806559718754535, -5.345687053835001, -228.4717514281052, -410.76088877101796, -484.18780729150296, 161.47656211297559, 140.0079978769695, -508.4673070582711, -175.6847987073339, -222.44558441684705, -168.1025377165118, -2.291874862405253, -389.977878665267, -576.514520045324, -572.2283413623861, -21.956761123280543, -425.37817206636515, -529.3642266195691, -180.6670998325281, -328.75324685263513, -154.01760140797614, 30.799349504970948, -117.92617569213363, -517.2583412738113, -266.55153108215666, -217.60389900086096, -177.70203903515034, 36.362996331659495, -381.29632417760394, -733.6891606696648, -184.337144558191, -115.13541757271884, 38.107868221750856, -170.0942476674637, -476.676360117364, -451.36161191490356, -411.34950664478737, -217.93005054715744, -626.0024310342598, -469.05322614093586, -715.6092568265788, -615.1202430239045, -304.40192262029535, -558.1231863228099, -669.9155055730746, -101.94034133780367, -51.57059191354731, -13.05447220814267, -67.05424757445431, -66.04398088703246, -348.0067611639467, -224.226664313048, -36.009541113864266, -487.2685123561657, -605.2100664856652, -155.4548118450415, -445.3573849628046, -414.62442943151785, -101.11089447225692, -266.9649948158358, -216.5282071885567, -23.26428190014971, 21.959977483464428, -379.3521160645683, 2.0000000000000013, -583.3556450819993, -340.47719315319284, -318.83026562061997, -2.135203192322125, -636.1238086033122, -512.6315031261283, -66.58767819634406, -22.103709188273182, -19.91033952490026, 103.07721642945671, -84.0788210070172, -494.8599654115443, -331.7037834035437, -510.9256458069935, -9.199221586025908, -451.59222012834323, -83.98393772780095, -53.693734534440395, -113.3701003471902, -505.29839882792174, 6.475595806792796, -463.0558950803242, -535.6185739121244, -290.481905378158, -289.0256910507758, -155.04552732228382, -272.1719173048975, -589.4133218631019, -526.4444749950136, -349.01081223564796, -75.99931922691756, -23.177744593988958, -511.6287075287618, -225.83653342274573, -364.86593213457047, -551.7012169896266, -108.24372114943363, -316.7150954181038, -470.59688989124305, -292.2080147230108, -276.9050279378471, -360.6626607335923, -279.5994212728546, -160.34704848512803, -191.2476522221523, -399.0991683044313, -109.83363376800797, -347.91839884831836, 2.0000000000000013, -146.06891269679335, -478.3605443846336, 89.96261528115589, -482.8235166009464, -30.525619194291025, -3.037180138479412, -247.6277923346849, -324.8681918712299, -207.82995857817258, -270.07339092213476, -40.83562560603717, -412.2977652993935, -3.296924027081305, -554.2309895371549, -207.05545959967668, -6.257526164869377, -3.777771706150965, -262.9184074809481, -25.095322921619776, -586.1575126216572, -129.75029486604794, -320.3208938306072, -377.18062737893825, -153.34752663198844, -337.1900286469069, -225.94511680920832, 0.8405862658890012, -510.44732957571165, -147.7544870617079, -122.83048109567778, -6.588378750786054, -614.5327752308057, -29.024309852294426, -69.28167634249034, -467.16680917556323, -567.9549104810164, -366.49876523527695, -83.51649777495047], "policy_predator_policy_reward": [182.27725285093643, 597.5390100285586, 717.6564924209605, 69.42274791945269, 100.26242560284699, 446.72614271708534, 725.6708643660545, 272.39231518653537, 308.11545718889, 293.9068362055249, 363.5430992418555, 243.0910214324112, 259.62771944322895, 88.67437318971328, 232.43943520108996, 437.24515697365115, 17.940387802096794, 485.2567413925841, 418.09766054102363, 590.5768835728321, 698.5472556276937, 614.4352708853529, 507.6816172909059, 548.2370911765373, 126.10954984770696, 309.48141963519384, 148.7208162632691, 351.8666591097589, 531.0273752363416, 643.8460934046957, 685.6923410839007, 563.9770810841762, 464.1416128410631, 502.99794477813333, 176.4928163199792, 553.5836148534643, 369.8560116246577, 540.1814747104626, 503.3074795177356, 433.58582041041956, 577.8557388808481, 369.60485126848596, 369.29002615217513, 129.2435502987884, 419.97510928258396, 377.4918894796588, 396.08687389173025, 396.5522867906395, 101.88488316806237, 24.987670152965592, 447.45224336038285, 204.56078084774103, 206.1844294166094, 362.65449777780026, 116.42992691933142, 445.26599948699305, 281.0459411565455, 137.06088298063005, 26.3467349555258, 221.37253771651157, 566.8835831122333, 240.25510284899386, 426.78190951614687, 412.92390802989115, 415.08169532294283, 507.79308935883023, 274.8370998325281, 329.50324685263513, 110.2955065151919, 148.8244104472534, 27.751326405863786, 619.1141937483989, 305.3712252557833, 377.68354863712574, 32.759278376624465, 250.31694185155828, 644.481307253447, 361.52395282121614, 258.8103871274688, 285.427424860535, 155.4123215357864, 160.28712888452324, 490.686360117364, 451.63161191490343, 411.4495066447873, 291.9900505471573, 626.0024310342598, 469.19322614093574, 737.2243368167332, 621.9154788822999, 14.545649899811366, 652.6100991620676, 550.7512648769656, 446.86251642966135, 32.30940635062134, 57.80280770184283, 22.808746176746066, 94.37970841786924, 306.3495330333516, 210.87586682520353, 381.1363698841741, 331.9009771909394, 651.0595049944553, 71.36097463685716, 447.3573849628046, 415.11442943151775, 441.24170518522396, 20.18334749803794, 233.5009068163521, 110.63942801368553, 226.8310231673634, 292.69151124472063, 377.49014382762886, 377.0371329556677, 549.2071548996336, 216.0230624631598, 553.7401648834755, 314.17098004753075, 372.4099720673349, 324.993882786196, 29.593707190638465, 3.8017496541252913, 1.8627835705431481, 85.68882100701803, 490.44216315712345, 415.5132976420133, 482.2514153490538, 264.9738674618819, 258.52133677166097, 289.04854076809164, 163.2375649506657, 131.5005538874081, 472.7624606425111, 219.57199094797238, 406.82847810322176, 600.9875679155921, 291.2719053781578, 319.02569105077566, 10.102250761251764, 350.76921726345375, 638.8499063541683, 349.0068246768528, 351.0238627808827, 53.259289057421356, 386.94945130800977, 253.5223456828571, 275.83653342274573, 368.17072871979457, 534.2346800233429, 332.6569305751199, 437.8873590504072, 465.58863067850206, 292.7380147230105, 323.985027937847, 401.73190022835644, 318.91500513301384, 195.74863281963624, 250.24554529663513, 361.39887394680204, 375.6640716464509, 360.0283988483183, 0.0, 95.36954168933873, 508.5852539625004, 502.80544487063094, 37.70121543768763, 69.98805401363055, 32.52541977385067, 201.29649571630338, 316.33291250060864, 259.8299585781725, 271.17339092213376, 243.92403234726044, 355.77780536355533, 474.892096621963, 268.30115917576876, 50.29333458280736, 201.20471070188526, 217.97090237918553, 165.26211967667808, 364.8153320258005, 458.4639815944467, 289.3592098277403, 259.9794130238124, 392.61578585709384, 145.45814708106323, 443.6731971789025, 276.5090278008406, 255.39747165277512, 309.06374379244824, 165.6595335144419, 240.38036846384566, 390.0693966136887, 471.19128293970357, 44.85923215755166, 46.8917419672661, 599.6408549304124, 380.9333399488701, 326.3467194850144, 222.60293092282552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.827620496797882, "mean_inference_ms": 2.6715860770675373, "mean_action_processing_ms": 0.3687180766694884, "mean_env_wait_ms": 0.30396219553183584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004414081573486328, "StateBufferConnector_ms": 0.0034290552139282227, "ViewRequirementAgentConnector_ms": 0.12508726119995117}, "num_episodes": 22, "episode_return_max": 396.70360142300336, "episode_return_min": -264.66337114959606, "episode_return_mean": 70.85481269853412, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.43767651646016, "num_env_steps_trained_throughput_per_sec": 268.43767651646016, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 14767.493, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14767.453, "sample_time_ms": 1921.543, "learn_time_ms": 12827.311, "learn_throughput": 311.835, "synch_weights_time_ms": 16.921}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "6c58f_00000", "date": "2024-08-16_16-21-48", "timestamp": 1723805508, "time_this_iter_s": 14.929414987564087, "time_total_s": 890.6365144252777, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0502ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 890.6365144252777, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 62.219047619047615, "ram_util_percent": 80.76190476190474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5561343627947348, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 6.764315435621474, "policy_loss": -0.005696364785495298, "vf_loss": 6.768391084671021, "vf_explained_var": 0.0051777180540498605, "kl": 0.011382895303577525, "entropy": 1.3910505623413771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7718602158089793, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 6.789516639204883, "policy_loss": -0.00930543817584674, "vf_loss": 6.79878386139239, "vf_explained_var": 0.007761842390847585, "kl": 0.012227380392826923, "entropy": 1.174962052151009, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 396.70360142300336, "episode_reward_min": -195.3693598812269, "episode_reward_mean": 87.4796120265613, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -733.6891606696648, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 161.47656211297559, "predator_policy": 737.2243368167332}, "policy_reward_mean": {"prey_policy": -244.64293829369942, "predator_policy": 288.3827443069801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.47501864786182, 92.34261315513923, 396.70360142300336, -47.095429826639695, 91.78458140902775, 256.92380182274263, 100.72030654843883, 12.780384009001033, 246.127682015882, 193.236617225023, 19.976441012995362, 77.32486009312069, -159.35371274936384, 245.52071506037177, -31.867614004160615, 94.92000000000002, 135.90166505944015, 11.68100318831728, 198.89934380989155, 141.7371775246922, -108.98022477260521, 244.76524985709375, 183.71307097459675, 14.280000000000001, 74.16000000000003, 0.14000000000000212, 28.41031584854978, -195.3693598812269, 225.75793439574767, 25.487149930775125, -15.909773866872591, -55.00802561843946, 189.75929360508252, -38.24439869939413, 2.489999999999995, 93.34916339516903, 104.34784574133168, 162.13039583097975, 173.17163170129692, 105.92275858898043, 229.65213313537095, 118.18467353105862, -8.618591868410338, 106.54999999999988, 79.39171198404878, 227.10041541791634, 11.993719683608203, 127.6742839564434, 193.51164856935497, 9.141577026366384, 30.79000000000007, -66.34597660247476, -128.0010658270946, -20.72697962426126, 105.66534486811577, 53.30479658522446, 206.9466724594014, 116.16400441956257, 47.61000000000003, 80.38482335492344, 94.39947740899093, 228.13014352081274, 14.109999999999975, -20.474661429587837, 147.6457589885282, 68.95067445471122, -54.86657598900304, 53.099999999999824, 146.56844680538538, 185.66534223349643, 38.18505952014693, 116.53684286876582, 212.02647807697033, 99.26743415489737, 7.545778927230292, 157.04707952362853, 54.854472135401124, 135.45493382090186, 240.1395255717989, -6.555012069968255, -54.54752477729734, 98.934387397612, 131.57000000000022, 17.452409838214137, 138.8084462973971, 96.61717511059729, 84.79375180498002, -11.586369953594899, 168.11999999999995, 101.54000000000083, 146.67771655438824, 118.26304264902323, 200.75332957199572, 23.878298407384367, 74.82000000000035, 63.43297386893145, 25.63000000000021, 244.81247592860095, 165.3842519829734, 318.3404032225351], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-546.0886313870785, -500.4238735959041, -498.19323868436396, -346.3574480886521, 68.99448913305437, -619.7514778593849, -226.17019594696134, -319.4588103306416, -196.04248075024068, -509.63993660297393, -485.9970434559671, -49.71831540366053, -20.806559718754535, -5.345687053835001, -228.4717514281052, -410.76088877101796, -484.18780729150296, 161.47656211297559, 140.0079978769695, -508.4673070582711, -175.6847987073339, -222.44558441684705, -168.1025377165118, -2.291874862405253, -389.977878665267, -576.514520045324, -572.2283413623861, -21.956761123280543, -425.37817206636515, -529.3642266195691, -180.6670998325281, -328.75324685263513, -154.01760140797614, 30.799349504970948, -117.92617569213363, -517.2583412738113, -266.55153108215666, -217.60389900086096, -177.70203903515034, 36.362996331659495, -381.29632417760394, -733.6891606696648, -184.337144558191, -115.13541757271884, 38.107868221750856, -170.0942476674637, -476.676360117364, -451.36161191490356, -411.34950664478737, -217.93005054715744, -626.0024310342598, -469.05322614093586, -715.6092568265788, -615.1202430239045, -304.40192262029535, -558.1231863228099, -669.9155055730746, -101.94034133780367, -51.57059191354731, -13.05447220814267, -67.05424757445431, -66.04398088703246, -348.0067611639467, -224.226664313048, -36.009541113864266, -487.2685123561657, -605.2100664856652, -155.4548118450415, -445.3573849628046, -414.62442943151785, -101.11089447225692, -266.9649948158358, -216.5282071885567, -23.26428190014971, 21.959977483464428, -379.3521160645683, 2.0000000000000013, -583.3556450819993, -340.47719315319284, -318.83026562061997, -2.135203192322125, -636.1238086033122, -512.6315031261283, -66.58767819634406, -22.103709188273182, -19.91033952490026, 103.07721642945671, -84.0788210070172, -494.8599654115443, -331.7037834035437, -510.9256458069935, -9.199221586025908, -451.59222012834323, -83.98393772780095, -53.693734534440395, -113.3701003471902, -505.29839882792174, 6.475595806792796, -463.0558950803242, -535.6185739121244, -290.481905378158, -289.0256910507758, -155.04552732228382, -272.1719173048975, -589.4133218631019, -526.4444749950136, -349.01081223564796, -75.99931922691756, -23.177744593988958, -511.6287075287618, -225.83653342274573, -364.86593213457047, -551.7012169896266, -108.24372114943363, -316.7150954181038, -470.59688989124305, -292.2080147230108, -276.9050279378471, -360.6626607335923, -279.5994212728546, -160.34704848512803, -191.2476522221523, -399.0991683044313, -109.83363376800797, -347.91839884831836, 2.0000000000000013, -146.06891269679335, -478.3605443846336, 89.96261528115589, -482.8235166009464, -30.525619194291025, -3.037180138479412, -247.6277923346849, -324.8681918712299, -207.82995857817258, -270.07339092213476, -40.83562560603717, -412.2977652993935, -3.296924027081305, -554.2309895371549, -207.05545959967668, -6.257526164869377, -3.777771706150965, -262.9184074809481, -25.095322921619776, -586.1575126216572, -129.75029486604794, -320.3208938306072, -377.18062737893825, -153.34752663198844, -337.1900286469069, -225.94511680920832, 0.8405862658890012, -510.44732957571165, -147.7544870617079, -122.83048109567778, -6.588378750786054, -614.5327752308057, -29.024309852294426, -69.28167634249034, -467.16680917556323, -567.9549104810164, -366.49876523527695, -83.51649777495047, -127.52950870882793, 58.96069748683844, -14.966783825265448, -106.72413581263469, -323.35966982804484, -122.99171358178972, -129.54307929041317, -1.4761968180221323, -301.0910207253739, -104.17658614020998, -195.6218140168323, -20.597344833937864, -14.074979398273816, 158.85212525871572, 53.87775161660503, -8.1219781316345, -428.5753138313013, -177.64524647869086, -119.45630505000969, -3.9282417212023724, -295.7508536426108, -397.3475284285658, 2.0000000000000013, -403.78932741857324, -160.06195174414964, -43.40066518816249, -96.18221861657405, -241.24247295393894, -451.8234147907699, -11.104472776136499, 17.689508971360198, -184.55041476209692, -504.87814900447785, -52.84457043275282, -319.41249881822085, 43.86423957082695], "policy_predator_policy_reward": [369.8560116246577, 540.1814747104626, 503.3074795177356, 433.58582041041956, 577.8557388808481, 369.60485126848596, 369.29002615217513, 129.2435502987884, 419.97510928258396, 377.4918894796588, 396.08687389173025, 396.5522867906395, 101.88488316806237, 24.987670152965592, 447.45224336038285, 204.56078084774103, 206.1844294166094, 362.65449777780026, 116.42992691933142, 445.26599948699305, 281.0459411565455, 137.06088298063005, 26.3467349555258, 221.37253771651157, 566.8835831122333, 240.25510284899386, 426.78190951614687, 412.92390802989115, 415.08169532294283, 507.79308935883023, 274.8370998325281, 329.50324685263513, 110.2955065151919, 148.8244104472534, 27.751326405863786, 619.1141937483989, 305.3712252557833, 377.68354863712574, 32.759278376624465, 250.31694185155828, 644.481307253447, 361.52395282121614, 258.8103871274688, 285.427424860535, 155.4123215357864, 160.28712888452324, 490.686360117364, 451.63161191490343, 411.4495066447873, 291.9900505471573, 626.0024310342598, 469.19322614093574, 737.2243368167332, 621.9154788822999, 14.545649899811366, 652.6100991620676, 550.7512648769656, 446.86251642966135, 32.30940635062134, 57.80280770184283, 22.808746176746066, 94.37970841786924, 306.3495330333516, 210.87586682520353, 381.1363698841741, 331.9009771909394, 651.0595049944553, 71.36097463685716, 447.3573849628046, 415.11442943151775, 441.24170518522396, 20.18334749803794, 233.5009068163521, 110.63942801368553, 226.8310231673634, 292.69151124472063, 377.49014382762886, 377.0371329556677, 549.2071548996336, 216.0230624631598, 553.7401648834755, 314.17098004753075, 372.4099720673349, 324.993882786196, 29.593707190638465, 3.8017496541252913, 1.8627835705431481, 85.68882100701803, 490.44216315712345, 415.5132976420133, 482.2514153490538, 264.9738674618819, 258.52133677166097, 289.04854076809164, 163.2375649506657, 131.5005538874081, 472.7624606425111, 219.57199094797238, 406.82847810322176, 600.9875679155921, 291.2719053781578, 319.02569105077566, 10.102250761251764, 350.76921726345375, 638.8499063541683, 349.0068246768528, 351.0238627808827, 53.259289057421356, 386.94945130800977, 253.5223456828571, 275.83653342274573, 368.17072871979457, 534.2346800233429, 332.6569305751199, 437.8873590504072, 465.58863067850206, 292.7380147230105, 323.985027937847, 401.73190022835644, 318.91500513301384, 195.74863281963624, 250.24554529663513, 361.39887394680204, 375.6640716464509, 360.0283988483183, 0.0, 95.36954168933873, 508.5852539625004, 502.80544487063094, 37.70121543768763, 69.98805401363055, 32.52541977385067, 201.29649571630338, 316.33291250060864, 259.8299585781725, 271.17339092213376, 243.92403234726044, 355.77780536355533, 474.892096621963, 268.30115917576876, 50.29333458280736, 201.20471070188526, 217.97090237918553, 165.26211967667808, 364.8153320258005, 458.4639815944467, 289.3592098277403, 259.9794130238124, 392.61578585709384, 145.45814708106323, 443.6731971789025, 276.5090278008406, 255.39747165277512, 309.06374379244824, 165.6595335144419, 240.38036846384566, 390.0693966136887, 471.19128293970357, 44.85923215755166, 46.8917419672661, 599.6408549304124, 380.9333399488701, 326.3467194850144, 222.60293092282552, 56.928356592795396, 143.21045462919366, 115.21927538334573, 23.924054092769143, 187.6453391128691, 397.5144905943618, 91.76250903014491, 135.87394218888662, 202.8184415830896, 287.24291708747546, 200.32491262084807, 4.307876276326555, 18.460787515499756, 4.882066624058297, 24.110851318464512, 31.673375196565118, 369.18482476811914, 383.71345209625986, 143.71628135705652, 97.93130806317863, 344.3900681625924, 549.4616434805798, 7.498298407384229, 418.1693274185729, 233.06195174414952, 45.2206651881625, 203.86518472658804, 196.9924807128567, 456.88341479076985, 31.674472776136465, 183.13877012531856, 228.53461159401988, 481.58450756019914, 241.52246386000462, 311.67386508445173, 282.21479738547725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8256049617622594, "mean_inference_ms": 2.672155736505726, "mean_action_processing_ms": 0.36826403283898546, "mean_env_wait_ms": 0.3033990857659051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004398345947265625, "StateBufferConnector_ms": 0.003425002098083496, "ViewRequirementAgentConnector_ms": 0.12278091907501221}, "num_episodes": 18, "episode_return_max": 396.70360142300336, "episode_return_min": -195.3693598812269, "episode_return_mean": 87.4796120265613, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.48727416012736, "num_env_steps_trained_throughput_per_sec": 276.48727416012736, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 14802.431, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14802.39, "sample_time_ms": 1930.311, "learn_time_ms": 12853.589, "learn_throughput": 311.197, "synch_weights_time_ms": 16.777}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "6c58f_00000", "date": "2024-08-16_16-22-02", "timestamp": 1723805522, "time_this_iter_s": 14.473877906799316, "time_total_s": 905.110392332077, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04fa3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 905.110392332077, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 80.29}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.808107980297356, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 6.118004478727069, "policy_loss": -0.009242601909246, "vf_loss": 6.125292535812136, "vf_explained_var": 0.010864073195785442, "kl": 0.013727317736010968, "entropy": 1.3807081789566726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.048273889286808, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 7.466036135052878, "policy_loss": -0.010273370160056012, "vf_loss": 7.476268264982435, "vf_explained_var": 0.03615476993656663, "kl": 0.013196167314505, "entropy": 1.128398044084115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 341.2761978015187, "episode_reward_min": -195.3693598812269, "episode_reward_mean": 108.36787447236885, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -715.6092568265788, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.85212525871572, "predator_policy": 737.2243368167332}, "policy_reward_mean": {"prey_policy": -187.3271281406357, "predator_policy": 241.51106537682008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.280000000000001, 74.16000000000003, 0.14000000000000212, 28.41031584854978, -195.3693598812269, 225.75793439574767, 25.487149930775125, -15.909773866872591, -55.00802561843946, 189.75929360508252, -38.24439869939413, 2.489999999999995, 93.34916339516903, 104.34784574133168, 162.13039583097975, 173.17163170129692, 105.92275858898043, 229.65213313537095, 118.18467353105862, -8.618591868410338, 106.54999999999988, 79.39171198404878, 227.10041541791634, 11.993719683608203, 127.6742839564434, 193.51164856935497, 9.141577026366384, 30.79000000000007, -66.34597660247476, -128.0010658270946, -20.72697962426126, 105.66534486811577, 53.30479658522446, 206.9466724594014, 116.16400441956257, 47.61000000000003, 80.38482335492344, 94.39947740899093, 228.13014352081274, 14.109999999999975, -20.474661429587837, 147.6457589885282, 68.95067445471122, -54.86657598900304, 53.099999999999824, 146.56844680538538, 185.66534223349643, 38.18505952014693, 116.53684286876582, 212.02647807697033, 99.26743415489737, 7.545778927230292, 157.04707952362853, 54.854472135401124, 135.45493382090186, 240.1395255717989, -6.555012069968255, -54.54752477729734, 98.934387397612, 131.57000000000022, 17.452409838214137, 138.8084462973971, 96.61717511059729, 84.79375180498002, -11.586369953594899, 168.11999999999995, 101.54000000000083, 146.67771655438824, 118.26304264902323, 200.75332957199572, 23.878298407384367, 74.82000000000035, 63.43297386893145, 25.63000000000021, 244.81247592860095, 165.3842519829734, 318.3404032225351, 202.4711701908285, 131.072812518997, 99.60599976995235, 221.8105083202165, 272.02468976081013, 148.7700000000001, 341.2761978015187, 67.27432387706266, 99.07749383959506, 257.1022695613665, 325.76258629434113, 295.57654849229925, 134.76000000000062, 256.56161981349834, 132.63999999999987, 167.20177260986597, 237.06115951212047, 205.1115249056029, 247.37162268966972, 171.87999999999988, 27.2987335109873, 158.7123253001709, 149.69000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-476.676360117364, -451.36161191490356, -411.34950664478737, -217.93005054715744, -626.0024310342598, -469.05322614093586, -715.6092568265788, -615.1202430239045, -304.40192262029535, -558.1231863228099, -669.9155055730746, -101.94034133780367, -51.57059191354731, -13.05447220814267, -67.05424757445431, -66.04398088703246, -348.0067611639467, -224.226664313048, -36.009541113864266, -487.2685123561657, -605.2100664856652, -155.4548118450415, -445.3573849628046, -414.62442943151785, -101.11089447225692, -266.9649948158358, -216.5282071885567, -23.26428190014971, 21.959977483464428, -379.3521160645683, 2.0000000000000013, -583.3556450819993, -340.47719315319284, -318.83026562061997, -2.135203192322125, -636.1238086033122, -512.6315031261283, -66.58767819634406, -22.103709188273182, -19.91033952490026, 103.07721642945671, -84.0788210070172, -494.8599654115443, -331.7037834035437, -510.9256458069935, -9.199221586025908, -451.59222012834323, -83.98393772780095, -53.693734534440395, -113.3701003471902, -505.29839882792174, 6.475595806792796, -463.0558950803242, -535.6185739121244, -290.481905378158, -289.0256910507758, -155.04552732228382, -272.1719173048975, -589.4133218631019, -526.4444749950136, -349.01081223564796, -75.99931922691756, -23.177744593988958, -511.6287075287618, -225.83653342274573, -364.86593213457047, -551.7012169896266, -108.24372114943363, -316.7150954181038, -470.59688989124305, -292.2080147230108, -276.9050279378471, -360.6626607335923, -279.5994212728546, -160.34704848512803, -191.2476522221523, -399.0991683044313, -109.83363376800797, -347.91839884831836, 2.0000000000000013, -146.06891269679335, -478.3605443846336, 89.96261528115589, -482.8235166009464, -30.525619194291025, -3.037180138479412, -247.6277923346849, -324.8681918712299, -207.82995857817258, -270.07339092213476, -40.83562560603717, -412.2977652993935, -3.296924027081305, -554.2309895371549, -207.05545959967668, -6.257526164869377, -3.777771706150965, -262.9184074809481, -25.095322921619776, -586.1575126216572, -129.75029486604794, -320.3208938306072, -377.18062737893825, -153.34752663198844, -337.1900286469069, -225.94511680920832, 0.8405862658890012, -510.44732957571165, -147.7544870617079, -122.83048109567778, -6.588378750786054, -614.5327752308057, -29.024309852294426, -69.28167634249034, -467.16680917556323, -567.9549104810164, -366.49876523527695, -83.51649777495047, -127.52950870882793, 58.96069748683844, -14.966783825265448, -106.72413581263469, -323.35966982804484, -122.99171358178972, -129.54307929041317, -1.4761968180221323, -301.0910207253739, -104.17658614020998, -195.6218140168323, -20.597344833937864, -14.074979398273816, 158.85212525871572, 53.87775161660503, -8.1219781316345, -428.5753138313013, -177.64524647869086, -119.45630505000969, -3.9282417212023724, -295.7508536426108, -397.3475284285658, 2.0000000000000013, -403.78932741857324, -160.06195174414964, -43.40066518816249, -96.18221861657405, -241.24247295393894, -451.8234147907699, -11.104472776136499, 17.689508971360198, -184.55041476209692, -504.87814900447785, -52.84457043275282, -319.41249881822085, 43.86423957082695, -162.47422406376597, -66.04190450018544, 17.175633127669364, -47.19946204614994, -104.67812642298762, 1.1490427150926683, -102.0981494424762, -14.011637645420976, 65.37023239118238, 59.94406729362041, -16.79264130758446, -35.44368947051143, 109.42786859609441, 135.94340089782844, -103.8413156103437, -7.211568091522137, -22.05218611437424, -119.26648450517104, 96.55995781043674, 53.53177044444506, 145.84126283934313, -131.38524972044536, -112.4929038545201, 133.40761152886188, -6.8010799555894135, 14.107732525146051, 44.8635491810061, 23.91153724513908, 43.470378573739254, -116.58426329077102, -27.376381865777358, -118.37131246710248, 72.79044085297734, -87.17622751766565, 53.574178049774105, -10.749077419045268, 129.60145580100922, -241.9346122076352, 103.59548934864974, -15.071089685717668, -264.62241679365445, -110.24905276695831, 107.54554418481571, -3.2776995194103034, 62.64538681598474, -73.20086797939652], "policy_predator_policy_reward": [490.686360117364, 451.63161191490343, 411.4495066447873, 291.9900505471573, 626.0024310342598, 469.19322614093574, 737.2243368167332, 621.9154788822999, 14.545649899811366, 652.6100991620676, 550.7512648769656, 446.86251642966135, 32.30940635062134, 57.80280770184283, 22.808746176746066, 94.37970841786924, 306.3495330333516, 210.87586682520353, 381.1363698841741, 331.9009771909394, 651.0595049944553, 71.36097463685716, 447.3573849628046, 415.11442943151775, 441.24170518522396, 20.18334749803794, 233.5009068163521, 110.63942801368553, 226.8310231673634, 292.69151124472063, 377.49014382762886, 377.0371329556677, 549.2071548996336, 216.0230624631598, 553.7401648834755, 314.17098004753075, 372.4099720673349, 324.993882786196, 29.593707190638465, 3.8017496541252913, 1.8627835705431481, 85.68882100701803, 490.44216315712345, 415.5132976420133, 482.2514153490538, 264.9738674618819, 258.52133677166097, 289.04854076809164, 163.2375649506657, 131.5005538874081, 472.7624606425111, 219.57199094797238, 406.82847810322176, 600.9875679155921, 291.2719053781578, 319.02569105077566, 10.102250761251764, 350.76921726345375, 638.8499063541683, 349.0068246768528, 351.0238627808827, 53.259289057421356, 386.94945130800977, 253.5223456828571, 275.83653342274573, 368.17072871979457, 534.2346800233429, 332.6569305751199, 437.8873590504072, 465.58863067850206, 292.7380147230105, 323.985027937847, 401.73190022835644, 318.91500513301384, 195.74863281963624, 250.24554529663513, 361.39887394680204, 375.6640716464509, 360.0283988483183, 0.0, 95.36954168933873, 508.5852539625004, 502.80544487063094, 37.70121543768763, 69.98805401363055, 32.52541977385067, 201.29649571630338, 316.33291250060864, 259.8299585781725, 271.17339092213376, 243.92403234726044, 355.77780536355533, 474.892096621963, 268.30115917576876, 50.29333458280736, 201.20471070188526, 217.97090237918553, 165.26211967667808, 364.8153320258005, 458.4639815944467, 289.3592098277403, 259.9794130238124, 392.61578585709384, 145.45814708106323, 443.6731971789025, 276.5090278008406, 255.39747165277512, 309.06374379244824, 165.6595335144419, 240.38036846384566, 390.0693966136887, 471.19128293970357, 44.85923215755166, 46.8917419672661, 599.6408549304124, 380.9333399488701, 326.3467194850144, 222.60293092282552, 56.928356592795396, 143.21045462919366, 115.21927538334573, 23.924054092769143, 187.6453391128691, 397.5144905943618, 91.76250903014491, 135.87394218888662, 202.8184415830896, 287.24291708747546, 200.32491262084807, 4.307876276326555, 18.460787515499756, 4.882066624058297, 24.110851318464512, 31.673375196565118, 369.18482476811914, 383.71345209625986, 143.71628135705652, 97.93130806317863, 344.3900681625924, 549.4616434805798, 7.498298407384229, 418.1693274185729, 233.06195174414952, 45.2206651881625, 203.86518472658804, 196.9924807128567, 456.88341479076985, 31.674472776136465, 183.13877012531856, 228.53461159401988, 481.58450756019914, 241.52246386000462, 311.67386508445173, 282.21479738547725, 270.5238136153351, 160.4634851394449, 90.61778420208907, 70.47885723538795, 137.15712787937395, 65.97795559847292, 195.85229843874706, 142.06799696936685, 44.622011532063624, 102.08837854394375, 163.79264130758446, 37.2136894705112, 54.50411518148248, 41.40081312611335, 43.65786607770852, 134.66934150122, 86.71114971861856, 153.6850147405216, 63.021690436136765, 43.98885087034783, 189.8215248720072, 121.48504830343619, 163.4819338082637, 111.17990700969382, 8.823792272638324, 118.62955515780506, 104.47613631566004, 83.31039707169343, 87.5596214262608, 118.19426329077184, 139.56085194532992, 173.38861499741571, 123.29499008243192, 128.15195609437728, 103.1236845009038, 59.162739773970266, 206.25915667280998, 153.44562242348556, 66.40451065135024, 16.951089685717797, 241.86253356421938, 160.30766950738027, 39.23897920006606, 15.205501434699434, 85.35461318401525, 74.89086797939738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8235240233054245, "mean_inference_ms": 2.6679637033254995, "mean_action_processing_ms": 0.3669973542870833, "mean_env_wait_ms": 0.3026576982968785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004781007766723633, "StateBufferConnector_ms": 0.00350797176361084, "ViewRequirementAgentConnector_ms": 0.13843679428100586}, "num_episodes": 23, "episode_return_max": 341.2761978015187, "episode_return_min": -195.3693598812269, "episode_return_mean": 108.36787447236885, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.516821596996, "num_env_steps_trained_throughput_per_sec": 276.516821596996, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 14753.845, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14753.805, "sample_time_ms": 1912.667, "learn_time_ms": 12821.726, "learn_throughput": 311.97, "synch_weights_time_ms": 17.927}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "6c58f_00000", "date": "2024-08-16_16-22-17", "timestamp": 1723805537, "time_this_iter_s": 14.53986406326294, "time_total_s": 919.65025639534, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 919.65025639534, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 61.7, "ram_util_percent": 80.31428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8957658145478162, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.111281002009356, "policy_loss": -0.006053015741854709, "vf_loss": 5.116492251239756, "vf_explained_var": 0.006502386754152005, "kl": 0.005911970810042706, "entropy": 1.4037921697374374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0055613553713236, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 5.980423501938108, "policy_loss": -0.002231374042966063, "vf_loss": 5.982636927801465, "vf_explained_var": 0.06782541088957005, "kl": 0.005738811260730694, "entropy": 1.1515919976764255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 341.2761978015187, "episode_reward_min": -128.0010658270946, "episode_reward_mean": 126.37571179164867, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -614.5327752308057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 161.80056795363907, "predator_policy": 638.8499063541683}, "policy_reward_mean": {"prey_policy": -126.70675766889755, "predator_policy": 189.89461356472185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.18467353105862, -8.618591868410338, 106.54999999999988, 79.39171198404878, 227.10041541791634, 11.993719683608203, 127.6742839564434, 193.51164856935497, 9.141577026366384, 30.79000000000007, -66.34597660247476, -128.0010658270946, -20.72697962426126, 105.66534486811577, 53.30479658522446, 206.9466724594014, 116.16400441956257, 47.61000000000003, 80.38482335492344, 94.39947740899093, 228.13014352081274, 14.109999999999975, -20.474661429587837, 147.6457589885282, 68.95067445471122, -54.86657598900304, 53.099999999999824, 146.56844680538538, 185.66534223349643, 38.18505952014693, 116.53684286876582, 212.02647807697033, 99.26743415489737, 7.545778927230292, 157.04707952362853, 54.854472135401124, 135.45493382090186, 240.1395255717989, -6.555012069968255, -54.54752477729734, 98.934387397612, 131.57000000000022, 17.452409838214137, 138.8084462973971, 96.61717511059729, 84.79375180498002, -11.586369953594899, 168.11999999999995, 101.54000000000083, 146.67771655438824, 118.26304264902323, 200.75332957199572, 23.878298407384367, 74.82000000000035, 63.43297386893145, 25.63000000000021, 244.81247592860095, 165.3842519829734, 318.3404032225351, 202.4711701908285, 131.072812518997, 99.60599976995235, 221.8105083202165, 272.02468976081013, 148.7700000000001, 341.2761978015187, 67.27432387706266, 99.07749383959506, 257.1022695613665, 325.76258629434113, 295.57654849229925, 134.76000000000062, 256.56161981349834, 132.63999999999987, 167.20177260986597, 237.06115951212047, 205.1115249056029, 247.37162268966972, 171.87999999999988, 27.2987335109873, 158.7123253001709, 149.69000000000003, 8.279999999999962, 275.5973442827888, 141.97576342327477, 319.8659267472741, 318.65129493432073, 171.7999999999999, 167.95, 7.817841920135566, 317.610448116629, 233.48310894236764, 137.95429759074298, 293.75254992901284, 299.1248437687764, 125.31927976853332, -7.462543653076484, 3.809999999999964, 106.16064026454949, 3.6199999999999655], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-512.6315031261283, -66.58767819634406, -22.103709188273182, -19.91033952490026, 103.07721642945671, -84.0788210070172, -494.8599654115443, -331.7037834035437, -510.9256458069935, -9.199221586025908, -451.59222012834323, -83.98393772780095, -53.693734534440395, -113.3701003471902, -505.29839882792174, 6.475595806792796, -463.0558950803242, -535.6185739121244, -290.481905378158, -289.0256910507758, -155.04552732228382, -272.1719173048975, -589.4133218631019, -526.4444749950136, -349.01081223564796, -75.99931922691756, -23.177744593988958, -511.6287075287618, -225.83653342274573, -364.86593213457047, -551.7012169896266, -108.24372114943363, -316.7150954181038, -470.59688989124305, -292.2080147230108, -276.9050279378471, -360.6626607335923, -279.5994212728546, -160.34704848512803, -191.2476522221523, -399.0991683044313, -109.83363376800797, -347.91839884831836, 2.0000000000000013, -146.06891269679335, -478.3605443846336, 89.96261528115589, -482.8235166009464, -30.525619194291025, -3.037180138479412, -247.6277923346849, -324.8681918712299, -207.82995857817258, -270.07339092213476, -40.83562560603717, -412.2977652993935, -3.296924027081305, -554.2309895371549, -207.05545959967668, -6.257526164869377, -3.777771706150965, -262.9184074809481, -25.095322921619776, -586.1575126216572, -129.75029486604794, -320.3208938306072, -377.18062737893825, -153.34752663198844, -337.1900286469069, -225.94511680920832, 0.8405862658890012, -510.44732957571165, -147.7544870617079, -122.83048109567778, -6.588378750786054, -614.5327752308057, -29.024309852294426, -69.28167634249034, -467.16680917556323, -567.9549104810164, -366.49876523527695, -83.51649777495047, -127.52950870882793, 58.96069748683844, -14.966783825265448, -106.72413581263469, -323.35966982804484, -122.99171358178972, -129.54307929041317, -1.4761968180221323, -301.0910207253739, -104.17658614020998, -195.6218140168323, -20.597344833937864, -14.074979398273816, 158.85212525871572, 53.87775161660503, -8.1219781316345, -428.5753138313013, -177.64524647869086, -119.45630505000969, -3.9282417212023724, -295.7508536426108, -397.3475284285658, 2.0000000000000013, -403.78932741857324, -160.06195174414964, -43.40066518816249, -96.18221861657405, -241.24247295393894, -451.8234147907699, -11.104472776136499, 17.689508971360198, -184.55041476209692, -504.87814900447785, -52.84457043275282, -319.41249881822085, 43.86423957082695, -162.47422406376597, -66.04190450018544, 17.175633127669364, -47.19946204614994, -104.67812642298762, 1.1490427150926683, -102.0981494424762, -14.011637645420976, 65.37023239118238, 59.94406729362041, -16.79264130758446, -35.44368947051143, 109.42786859609441, 135.94340089782844, -103.8413156103437, -7.211568091522137, -22.05218611437424, -119.26648450517104, 96.55995781043674, 53.53177044444506, 145.84126283934313, -131.38524972044536, -112.4929038545201, 133.40761152886188, -6.8010799555894135, 14.107732525146051, 44.8635491810061, 23.91153724513908, 43.470378573739254, -116.58426329077102, -27.376381865777358, -118.37131246710248, 72.79044085297734, -87.17622751766565, 53.574178049774105, -10.749077419045268, 129.60145580100922, -241.9346122076352, 103.59548934864974, -15.071089685717668, -264.62241679365445, -110.24905276695831, 107.54554418481571, -3.2776995194103034, 62.64538681598474, -73.20086797939652, -82.79429794379209, -22.436177243752248, 142.96051067979846, 3.44100153367736, 19.86003506381742, -5.44577970160641, 81.86487601861462, 96.55532473696786, 85.67585871124669, 102.68792185847474, -33.79282846182659, 142.2988708927976, 43.11435737912941, 76.24593354504253, -5.4066487335727516, -63.82558812514746, 161.80056795363907, 43.663189664609405, -3.812989668005452, 20.176498831312923, -8.525478503147426, 1.1187329438218527, -46.371770288712305, 88.51472416203892, 140.31284398829362, 29.600986619174083, -23.374978571304286, -61.66509537062464, -9.302543653076446, -63.49558674938823, -23.541430634022394, -6.279650247394839, -27.260940085610635, 21.190087536635314, -13.909401148088508, -51.31478161084705], "policy_predator_policy_reward": [372.4099720673349, 324.993882786196, 29.593707190638465, 3.8017496541252913, 1.8627835705431481, 85.68882100701803, 490.44216315712345, 415.5132976420133, 482.2514153490538, 264.9738674618819, 258.52133677166097, 289.04854076809164, 163.2375649506657, 131.5005538874081, 472.7624606425111, 219.57199094797238, 406.82847810322176, 600.9875679155921, 291.2719053781578, 319.02569105077566, 10.102250761251764, 350.76921726345375, 638.8499063541683, 349.0068246768528, 351.0238627808827, 53.259289057421356, 386.94945130800977, 253.5223456828571, 275.83653342274573, 368.17072871979457, 534.2346800233429, 332.6569305751199, 437.8873590504072, 465.58863067850206, 292.7380147230105, 323.985027937847, 401.73190022835644, 318.91500513301384, 195.74863281963624, 250.24554529663513, 361.39887394680204, 375.6640716464509, 360.0283988483183, 0.0, 95.36954168933873, 508.5852539625004, 502.80544487063094, 37.70121543768763, 69.98805401363055, 32.52541977385067, 201.29649571630338, 316.33291250060864, 259.8299585781725, 271.17339092213376, 243.92403234726044, 355.77780536355533, 474.892096621963, 268.30115917576876, 50.29333458280736, 201.20471070188526, 217.97090237918553, 165.26211967667808, 364.8153320258005, 458.4639815944467, 289.3592098277403, 259.9794130238124, 392.61578585709384, 145.45814708106323, 443.6731971789025, 276.5090278008406, 255.39747165277512, 309.06374379244824, 165.6595335144419, 240.38036846384566, 390.0693966136887, 471.19128293970357, 44.85923215755166, 46.8917419672661, 599.6408549304124, 380.9333399488701, 326.3467194850144, 222.60293092282552, 56.928356592795396, 143.21045462919366, 115.21927538334573, 23.924054092769143, 187.6453391128691, 397.5144905943618, 91.76250903014491, 135.87394218888662, 202.8184415830896, 287.24291708747546, 200.32491262084807, 4.307876276326555, 18.460787515499756, 4.882066624058297, 24.110851318464512, 31.673375196565118, 369.18482476811914, 383.71345209625986, 143.71628135705652, 97.93130806317863, 344.3900681625924, 549.4616434805798, 7.498298407384229, 418.1693274185729, 233.06195174414952, 45.2206651881625, 203.86518472658804, 196.9924807128567, 456.88341479076985, 31.674472776136465, 183.13877012531856, 228.53461159401988, 481.58450756019914, 241.52246386000462, 311.67386508445173, 282.21479738547725, 270.5238136153351, 160.4634851394449, 90.61778420208907, 70.47885723538795, 137.15712787937395, 65.97795559847292, 195.85229843874706, 142.06799696936685, 44.622011532063624, 102.08837854394375, 163.79264130758446, 37.2136894705112, 54.50411518148248, 41.40081312611335, 43.65786607770852, 134.66934150122, 86.71114971861856, 153.6850147405216, 63.021690436136765, 43.98885087034783, 189.8215248720072, 121.48504830343619, 163.4819338082637, 111.17990700969382, 8.823792272638324, 118.62955515780506, 104.47613631566004, 83.31039707169343, 87.5596214262608, 118.19426329077184, 139.56085194532992, 173.38861499741571, 123.29499008243192, 128.15195609437728, 103.1236845009038, 59.162739773970266, 206.25915667280998, 153.44562242348556, 66.40451065135024, 16.951089685717797, 241.86253356421938, 160.30766950738027, 39.23897920006606, 15.205501434699434, 85.35461318401525, 74.89086797939738, 26.722028632456354, 86.78844655508887, 51.04954389671005, 78.14628817260287, 50.10249925131361, 77.45900880975, 104.11075316819922, 37.3349728234924, 63.00566844983775, 67.2818459147616, 35.58282846182623, 27.711129107202392, 25.01564262087037, 23.57406645495759, 13.428460902552533, 63.62161787630373, 45.503978301182, 66.64271219719856, 134.62138027684767, 82.4982195022125, 143.6754785031475, 1.6855646469208916, 136.480709495174, 115.12888656051226, 49.30352717624332, 79.90748598506532, 55.65164235534438, 154.7077113551176, 0.0, 65.33558674938878, 25.411430634022686, 8.219650247394798, 84.43029809432272, 27.801194719202407, 12.874293074987833, 55.96988968394734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8234992792778474, "mean_inference_ms": 2.668110842750774, "mean_action_processing_ms": 0.36633411184555803, "mean_env_wait_ms": 0.3022782338405428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004754066467285156, "StateBufferConnector_ms": 0.0035300254821777344, "ViewRequirementAgentConnector_ms": 0.1834787130355835}, "num_episodes": 18, "episode_return_max": 341.2761978015187, "episode_return_min": -128.0010658270946, "episode_return_mean": 126.37571179164867, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.0749775754091, "num_env_steps_trained_throughput_per_sec": 259.0749775754091, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 14840.764, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14840.723, "sample_time_ms": 1986.138, "learn_time_ms": 12835.5, "learn_throughput": 311.636, "synch_weights_time_ms": 17.6}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "6c58f_00000", "date": "2024-08-16_16-22-32", "timestamp": 1723805552, "time_this_iter_s": 15.48532509803772, "time_total_s": 935.1355814933777, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 935.1355814933777, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 65.32272727272726, "ram_util_percent": 80.67727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7443574585611858, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 3.2651345020879514, "policy_loss": -0.010235006347909649, "vf_loss": 3.2738745421959607, "vf_explained_var": -0.005347312253618997, "kl": 0.010499632412207032, "entropy": 1.4301234545531096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7321992256969372, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 5.612355447446228, "policy_loss": -0.006209470862128511, "vf_loss": 5.618523156201398, "vf_explained_var": 0.09336348513446788, "kl": 0.01336345786955259, "entropy": 1.2826059558404186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 341.2761978015187, "episode_reward_min": -54.86657598900304, "episode_reward_mean": 142.1245118384235, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -614.5327752308057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.82582924196237, "predator_policy": 599.6408549304124}, "policy_reward_mean": {"prey_policy": -76.04114226204993, "predator_policy": 147.1033981812617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.38482335492344, 94.39947740899093, 228.13014352081274, 14.109999999999975, -20.474661429587837, 147.6457589885282, 68.95067445471122, -54.86657598900304, 53.099999999999824, 146.56844680538538, 185.66534223349643, 38.18505952014693, 116.53684286876582, 212.02647807697033, 99.26743415489737, 7.545778927230292, 157.04707952362853, 54.854472135401124, 135.45493382090186, 240.1395255717989, -6.555012069968255, -54.54752477729734, 98.934387397612, 131.57000000000022, 17.452409838214137, 138.8084462973971, 96.61717511059729, 84.79375180498002, -11.586369953594899, 168.11999999999995, 101.54000000000083, 146.67771655438824, 118.26304264902323, 200.75332957199572, 23.878298407384367, 74.82000000000035, 63.43297386893145, 25.63000000000021, 244.81247592860095, 165.3842519829734, 318.3404032225351, 202.4711701908285, 131.072812518997, 99.60599976995235, 221.8105083202165, 272.02468976081013, 148.7700000000001, 341.2761978015187, 67.27432387706266, 99.07749383959506, 257.1022695613665, 325.76258629434113, 295.57654849229925, 134.76000000000062, 256.56161981349834, 132.63999999999987, 167.20177260986597, 237.06115951212047, 205.1115249056029, 247.37162268966972, 171.87999999999988, 27.2987335109873, 158.7123253001709, 149.69000000000003, 8.279999999999962, 275.5973442827888, 141.97576342327477, 319.8659267472741, 318.65129493432073, 171.7999999999999, 167.95, 7.817841920135566, 317.610448116629, 233.48310894236764, 137.95429759074298, 293.75254992901284, 299.1248437687764, 125.31927976853332, -7.462543653076484, 3.809999999999964, 106.16064026454949, 3.6199999999999655, 143.1923298924735, 263.3250022699468, 198.54244979610084, 3.8199999999999625, 265.0920056355477, 56.330000000000005, 283.2953676177159, -11.542830179375136, 3.5999999999999686, 243.6458876711183, 112.121846959141, 195.03627402222364, 159.42162494926527, 160.95999999999998, 136.28000000000017, 146.22000000000008, 310.5640204412474, 115.31226018094425], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-360.6626607335923, -279.5994212728546, -160.34704848512803, -191.2476522221523, -399.0991683044313, -109.83363376800797, -347.91839884831836, 2.0000000000000013, -146.06891269679335, -478.3605443846336, 89.96261528115589, -482.8235166009464, -30.525619194291025, -3.037180138479412, -247.6277923346849, -324.8681918712299, -207.82995857817258, -270.07339092213476, -40.83562560603717, -412.2977652993935, -3.296924027081305, -554.2309895371549, -207.05545959967668, -6.257526164869377, -3.777771706150965, -262.9184074809481, -25.095322921619776, -586.1575126216572, -129.75029486604794, -320.3208938306072, -377.18062737893825, -153.34752663198844, -337.1900286469069, -225.94511680920832, 0.8405862658890012, -510.44732957571165, -147.7544870617079, -122.83048109567778, -6.588378750786054, -614.5327752308057, -29.024309852294426, -69.28167634249034, -467.16680917556323, -567.9549104810164, -366.49876523527695, -83.51649777495047, -127.52950870882793, 58.96069748683844, -14.966783825265448, -106.72413581263469, -323.35966982804484, -122.99171358178972, -129.54307929041317, -1.4761968180221323, -301.0910207253739, -104.17658614020998, -195.6218140168323, -20.597344833937864, -14.074979398273816, 158.85212525871572, 53.87775161660503, -8.1219781316345, -428.5753138313013, -177.64524647869086, -119.45630505000969, -3.9282417212023724, -295.7508536426108, -397.3475284285658, 2.0000000000000013, -403.78932741857324, -160.06195174414964, -43.40066518816249, -96.18221861657405, -241.24247295393894, -451.8234147907699, -11.104472776136499, 17.689508971360198, -184.55041476209692, -504.87814900447785, -52.84457043275282, -319.41249881822085, 43.86423957082695, -162.47422406376597, -66.04190450018544, 17.175633127669364, -47.19946204614994, -104.67812642298762, 1.1490427150926683, -102.0981494424762, -14.011637645420976, 65.37023239118238, 59.94406729362041, -16.79264130758446, -35.44368947051143, 109.42786859609441, 135.94340089782844, -103.8413156103437, -7.211568091522137, -22.05218611437424, -119.26648450517104, 96.55995781043674, 53.53177044444506, 145.84126283934313, -131.38524972044536, -112.4929038545201, 133.40761152886188, -6.8010799555894135, 14.107732525146051, 44.8635491810061, 23.91153724513908, 43.470378573739254, -116.58426329077102, -27.376381865777358, -118.37131246710248, 72.79044085297734, -87.17622751766565, 53.574178049774105, -10.749077419045268, 129.60145580100922, -241.9346122076352, 103.59548934864974, -15.071089685717668, -264.62241679365445, -110.24905276695831, 107.54554418481571, -3.2776995194103034, 62.64538681598474, -73.20086797939652, -82.79429794379209, -22.436177243752248, 142.96051067979846, 3.44100153367736, 19.86003506381742, -5.44577970160641, 81.86487601861462, 96.55532473696786, 85.67585871124669, 102.68792185847474, -33.79282846182659, 142.2988708927976, 43.11435737912941, 76.24593354504253, -5.4066487335727516, -63.82558812514746, 161.80056795363907, 43.663189664609405, -3.812989668005452, 20.176498831312923, -8.525478503147426, 1.1187329438218527, -46.371770288712305, 88.51472416203892, 140.31284398829362, 29.600986619174083, -23.374978571304286, -61.66509537062464, -9.302543653076446, -63.49558674938823, -23.541430634022394, -6.279650247394839, -27.260940085610635, 21.190087536635314, -13.909401148088508, -51.31478161084705, -32.91196111794909, 35.32859358278098, 65.6084315918041, 81.40662844177598, -2.6970861081420425, -239.72954481939453, -2.7721961603523964, -13.538032741886402, -7.154169539697797, 114.42974118762854, 4.510295661012247, 0.8904954078542949, 143.24902433909477, -147.63409645667377, -18.421901738015602, -17.759767598925325, -61.8617097363348, -51.22041236476266, 96.60234624049909, 53.62923393690099, -43.19448198000232, 38.12955840408998, 180.82582924196237, -158.4744840954325, 51.82728014638579, -5.678201587435732, 116.94661179135647, -5.794342777996024, 124.38041423398418, -57.370026174706034, 102.318961397015, -19.737963047990558, 122.97240081702272, 43.28044855107599, -20.02625697036619, -175.76914732545126], "policy_predator_policy_reward": [401.73190022835644, 318.91500513301384, 195.74863281963624, 250.24554529663513, 361.39887394680204, 375.6640716464509, 360.0283988483183, 0.0, 95.36954168933873, 508.5852539625004, 502.80544487063094, 37.70121543768763, 69.98805401363055, 32.52541977385067, 201.29649571630338, 316.33291250060864, 259.8299585781725, 271.17339092213376, 243.92403234726044, 355.77780536355533, 474.892096621963, 268.30115917576876, 50.29333458280736, 201.20471070188526, 217.97090237918553, 165.26211967667808, 364.8153320258005, 458.4639815944467, 289.3592098277403, 259.9794130238124, 392.61578585709384, 145.45814708106323, 443.6731971789025, 276.5090278008406, 255.39747165277512, 309.06374379244824, 165.6595335144419, 240.38036846384566, 390.0693966136887, 471.19128293970357, 44.85923215755166, 46.8917419672661, 599.6408549304124, 380.9333399488701, 326.3467194850144, 222.60293092282552, 56.928356592795396, 143.21045462919366, 115.21927538334573, 23.924054092769143, 187.6453391128691, 397.5144905943618, 91.76250903014491, 135.87394218888662, 202.8184415830896, 287.24291708747546, 200.32491262084807, 4.307876276326555, 18.460787515499756, 4.882066624058297, 24.110851318464512, 31.673375196565118, 369.18482476811914, 383.71345209625986, 143.71628135705652, 97.93130806317863, 344.3900681625924, 549.4616434805798, 7.498298407384229, 418.1693274185729, 233.06195174414952, 45.2206651881625, 203.86518472658804, 196.9924807128567, 456.88341479076985, 31.674472776136465, 183.13877012531856, 228.53461159401988, 481.58450756019914, 241.52246386000462, 311.67386508445173, 282.21479738547725, 270.5238136153351, 160.4634851394449, 90.61778420208907, 70.47885723538795, 137.15712787937395, 65.97795559847292, 195.85229843874706, 142.06799696936685, 44.622011532063624, 102.08837854394375, 163.79264130758446, 37.2136894705112, 54.50411518148248, 41.40081312611335, 43.65786607770852, 134.66934150122, 86.71114971861856, 153.6850147405216, 63.021690436136765, 43.98885087034783, 189.8215248720072, 121.48504830343619, 163.4819338082637, 111.17990700969382, 8.823792272638324, 118.62955515780506, 104.47613631566004, 83.31039707169343, 87.5596214262608, 118.19426329077184, 139.56085194532992, 173.38861499741571, 123.29499008243192, 128.15195609437728, 103.1236845009038, 59.162739773970266, 206.25915667280998, 153.44562242348556, 66.40451065135024, 16.951089685717797, 241.86253356421938, 160.30766950738027, 39.23897920006606, 15.205501434699434, 85.35461318401525, 74.89086797939738, 26.722028632456354, 86.78844655508887, 51.04954389671005, 78.14628817260287, 50.10249925131361, 77.45900880975, 104.11075316819922, 37.3349728234924, 63.00566844983775, 67.2818459147616, 35.58282846182623, 27.711129107202392, 25.01564262087037, 23.57406645495759, 13.428460902552533, 63.62161787630373, 45.503978301182, 66.64271219719856, 134.62138027684767, 82.4982195022125, 143.6754785031475, 1.6855646469208916, 136.480709495174, 115.12888656051226, 49.30352717624332, 79.90748598506532, 55.65164235534438, 154.7077113551176, 0.0, 65.33558674938878, 25.411430634022686, 8.219650247394798, 84.43029809432272, 27.801194719202407, 12.874293074987833, 55.96988968394734, 99.17747713575645, 41.59822029188494, 72.70316913261183, 43.606773103755444, 241.37907337032564, 199.59000735331225, 4.722196160352355, 15.408032741886363, 34.52412856929627, 123.2923054183209, 49.82970433898754, 1.0995045921457065, 153.51814395558128, 134.16229577971356, 2.655462806946064, 21.983376350620393, 63.64170973633445, 53.0404123647623, 37.06935963726342, 56.34494785645579, 9.532416765436352, 107.65435376961625, 16.42425668861508, 156.26067218707811, 79.31323212888029, 33.959314261434784, 13.690440142128995, 36.11729084451053, 10.189585766015954, 59.080026174705694, 41.98103860298498, 21.657963047990858, 60.50237363158293, 83.80879744156594, 70.24576019299722, 240.86190428376435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8234613187867373, "mean_inference_ms": 2.6680544208603076, "mean_action_processing_ms": 0.3656216842563946, "mean_env_wait_ms": 0.3017991009434771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004784226417541504, "StateBufferConnector_ms": 0.0037904977798461914, "ViewRequirementAgentConnector_ms": 0.189927339553833}, "num_episodes": 18, "episode_return_max": 341.2761978015187, "episode_return_min": -54.86657598900304, "episode_return_mean": 142.1245118384235, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.2401021239503, "num_env_steps_trained_throughput_per_sec": 265.2401021239503, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 14865.421, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14865.379, "sample_time_ms": 1997.291, "learn_time_ms": 12848.925, "learn_throughput": 311.31, "synch_weights_time_ms": 17.601}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "6c58f_00000", "date": "2024-08-16_16-22-48", "timestamp": 1723805568, "time_this_iter_s": 15.15442705154419, "time_total_s": 950.2900085449219, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33e7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 950.2900085449219, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 65.6952380952381, "ram_util_percent": 81.92857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3193897349809212, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.842796158285999, "policy_loss": -0.007575231169660886, "vf_loss": 2.848773460918003, "vf_explained_var": -0.000809239111249409, "kl": 0.011222802604525016, "entropy": 1.4366552122055538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.985886479307104, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 5.586081145049403, "policy_loss": -0.006241617972652117, "vf_loss": 5.592288578376568, "vf_explained_var": 0.08919577425119107, "kl": 0.010939696168016624, "entropy": 1.3862101719492959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 341.2761978015187, "episode_reward_min": -11.586369953594899, "episode_reward_mean": 152.41952998719674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.5626219508878, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.82582924196237, "predator_policy": 549.4616434805798}, "policy_reward_mean": {"prey_policy": -28.088041609988423, "predator_policy": 104.29780660358679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.934387397612, 131.57000000000022, 17.452409838214137, 138.8084462973971, 96.61717511059729, 84.79375180498002, -11.586369953594899, 168.11999999999995, 101.54000000000083, 146.67771655438824, 118.26304264902323, 200.75332957199572, 23.878298407384367, 74.82000000000035, 63.43297386893145, 25.63000000000021, 244.81247592860095, 165.3842519829734, 318.3404032225351, 202.4711701908285, 131.072812518997, 99.60599976995235, 221.8105083202165, 272.02468976081013, 148.7700000000001, 341.2761978015187, 67.27432387706266, 99.07749383959506, 257.1022695613665, 325.76258629434113, 295.57654849229925, 134.76000000000062, 256.56161981349834, 132.63999999999987, 167.20177260986597, 237.06115951212047, 205.1115249056029, 247.37162268966972, 171.87999999999988, 27.2987335109873, 158.7123253001709, 149.69000000000003, 8.279999999999962, 275.5973442827888, 141.97576342327477, 319.8659267472741, 318.65129493432073, 171.7999999999999, 167.95, 7.817841920135566, 317.610448116629, 233.48310894236764, 137.95429759074298, 293.75254992901284, 299.1248437687764, 125.31927976853332, -7.462543653076484, 3.809999999999964, 106.16064026454949, 3.6199999999999655, 143.1923298924735, 263.3250022699468, 198.54244979610084, 3.8199999999999625, 265.0920056355477, 56.330000000000005, 283.2953676177159, -11.542830179375136, 3.5999999999999686, 243.6458876711183, 112.121846959141, 195.03627402222364, 159.42162494926527, 160.95999999999998, 136.28000000000017, 146.22000000000008, 310.5640204412474, 115.31226018094425, 104.60250114884688, 108.73000000000096, 3.629999999999965, 3.6799999999999677, 110.84293090586462, 65.7200000000007, 178.8299999999997, 112.5124929403263, 257.7999999999995, 175.6999999999997, 122.22000000000088, 177.6299999999997, 145.35000000000034, 239.81077560825287, 284.8688039660942, 61.574918730506674, 175.57999999999976, 129.5799999999998, 109.55174144312443, 93.637913221328, 158.05823401370668, 153.15999999999968], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-366.49876523527695, -83.51649777495047, -127.52950870882793, 58.96069748683844, -14.966783825265448, -106.72413581263469, -323.35966982804484, -122.99171358178972, -129.54307929041317, -1.4761968180221323, -301.0910207253739, -104.17658614020998, -195.6218140168323, -20.597344833937864, -14.074979398273816, 158.85212525871572, 53.87775161660503, -8.1219781316345, -428.5753138313013, -177.64524647869086, -119.45630505000969, -3.9282417212023724, -295.7508536426108, -397.3475284285658, 2.0000000000000013, -403.78932741857324, -160.06195174414964, -43.40066518816249, -96.18221861657405, -241.24247295393894, -451.8234147907699, -11.104472776136499, 17.689508971360198, -184.55041476209692, -504.87814900447785, -52.84457043275282, -319.41249881822085, 43.86423957082695, -162.47422406376597, -66.04190450018544, 17.175633127669364, -47.19946204614994, -104.67812642298762, 1.1490427150926683, -102.0981494424762, -14.011637645420976, 65.37023239118238, 59.94406729362041, -16.79264130758446, -35.44368947051143, 109.42786859609441, 135.94340089782844, -103.8413156103437, -7.211568091522137, -22.05218611437424, -119.26648450517104, 96.55995781043674, 53.53177044444506, 145.84126283934313, -131.38524972044536, -112.4929038545201, 133.40761152886188, -6.8010799555894135, 14.107732525146051, 44.8635491810061, 23.91153724513908, 43.470378573739254, -116.58426329077102, -27.376381865777358, -118.37131246710248, 72.79044085297734, -87.17622751766565, 53.574178049774105, -10.749077419045268, 129.60145580100922, -241.9346122076352, 103.59548934864974, -15.071089685717668, -264.62241679365445, -110.24905276695831, 107.54554418481571, -3.2776995194103034, 62.64538681598474, -73.20086797939652, -82.79429794379209, -22.436177243752248, 142.96051067979846, 3.44100153367736, 19.86003506381742, -5.44577970160641, 81.86487601861462, 96.55532473696786, 85.67585871124669, 102.68792185847474, -33.79282846182659, 142.2988708927976, 43.11435737912941, 76.24593354504253, -5.4066487335727516, -63.82558812514746, 161.80056795363907, 43.663189664609405, -3.812989668005452, 20.176498831312923, -8.525478503147426, 1.1187329438218527, -46.371770288712305, 88.51472416203892, 140.31284398829362, 29.600986619174083, -23.374978571304286, -61.66509537062464, -9.302543653076446, -63.49558674938823, -23.541430634022394, -6.279650247394839, -27.260940085610635, 21.190087536635314, -13.909401148088508, -51.31478161084705, -32.91196111794909, 35.32859358278098, 65.6084315918041, 81.40662844177598, -2.6970861081420425, -239.72954481939453, -2.7721961603523964, -13.538032741886402, -7.154169539697797, 114.42974118762854, 4.510295661012247, 0.8904954078542949, 143.24902433909477, -147.63409645667377, -18.421901738015602, -17.759767598925325, -61.8617097363348, -51.22041236476266, 96.60234624049909, 53.62923393690099, -43.19448198000232, 38.12955840408998, 180.82582924196237, -158.4744840954325, 51.82728014638579, -5.678201587435732, 116.94661179135647, -5.794342777996024, 124.38041423398418, -57.370026174706034, 102.318961397015, -19.737963047990558, 122.97240081702272, 43.28044855107599, -20.02625697036619, -175.76914732545126, -130.69417914487065, -9.723881232371113, 70.66276072407034, -3.042439793875814, -86.87969464489554, -1.2367169167040204, -28.431873916808648, -25.64125361374057, -23.448013576078665, 21.05580588857404, 35.67751011710042, -127.1246150406644, -30.290680691992176, 159.39239099399902, -142.1257797802448, -533.5626219508878, 149.89537985259201, 13.302876159165436, 120.27614069207407, -71.19348432187246, -46.73240491844416, 105.91722815141989, 1.7427811347453193, 93.49343498602846, 133.00995768749738, -393.4056620185816, 110.03226235121895, 32.26062006710174, 106.25644382003713, 89.02459744454322, -2.0919879507634276, 14.372903035540663, 134.75598660152963, -64.25442552022201, 71.28253571885686, -175.48912240818873, -126.79954259595182, -77.12099522054154, -54.62612448256706, 25.457682481817084, 90.17238891353084, -78.62798073332712, -8.665135031052321, 125.42821959236083], "policy_predator_policy_reward": [326.3467194850144, 222.60293092282552, 56.928356592795396, 143.21045462919366, 115.21927538334573, 23.924054092769143, 187.6453391128691, 397.5144905943618, 91.76250903014491, 135.87394218888662, 202.8184415830896, 287.24291708747546, 200.32491262084807, 4.307876276326555, 18.460787515499756, 4.882066624058297, 24.110851318464512, 31.673375196565118, 369.18482476811914, 383.71345209625986, 143.71628135705652, 97.93130806317863, 344.3900681625924, 549.4616434805798, 7.498298407384229, 418.1693274185729, 233.06195174414952, 45.2206651881625, 203.86518472658804, 196.9924807128567, 456.88341479076985, 31.674472776136465, 183.13877012531856, 228.53461159401988, 481.58450756019914, 241.52246386000462, 311.67386508445173, 282.21479738547725, 270.5238136153351, 160.4634851394449, 90.61778420208907, 70.47885723538795, 137.15712787937395, 65.97795559847292, 195.85229843874706, 142.06799696936685, 44.622011532063624, 102.08837854394375, 163.79264130758446, 37.2136894705112, 54.50411518148248, 41.40081312611335, 43.65786607770852, 134.66934150122, 86.71114971861856, 153.6850147405216, 63.021690436136765, 43.98885087034783, 189.8215248720072, 121.48504830343619, 163.4819338082637, 111.17990700969382, 8.823792272638324, 118.62955515780506, 104.47613631566004, 83.31039707169343, 87.5596214262608, 118.19426329077184, 139.56085194532992, 173.38861499741571, 123.29499008243192, 128.15195609437728, 103.1236845009038, 59.162739773970266, 206.25915667280998, 153.44562242348556, 66.40451065135024, 16.951089685717797, 241.86253356421938, 160.30766950738027, 39.23897920006606, 15.205501434699434, 85.35461318401525, 74.89086797939738, 26.722028632456354, 86.78844655508887, 51.04954389671005, 78.14628817260287, 50.10249925131361, 77.45900880975, 104.11075316819922, 37.3349728234924, 63.00566844983775, 67.2818459147616, 35.58282846182623, 27.711129107202392, 25.01564262087037, 23.57406645495759, 13.428460902552533, 63.62161787630373, 45.503978301182, 66.64271219719856, 134.62138027684767, 82.4982195022125, 143.6754785031475, 1.6855646469208916, 136.480709495174, 115.12888656051226, 49.30352717624332, 79.90748598506532, 55.65164235534438, 154.7077113551176, 0.0, 65.33558674938878, 25.411430634022686, 8.219650247394798, 84.43029809432272, 27.801194719202407, 12.874293074987833, 55.96988968394734, 99.17747713575645, 41.59822029188494, 72.70316913261183, 43.606773103755444, 241.37907337032564, 199.59000735331225, 4.722196160352355, 15.408032741886363, 34.52412856929627, 123.2923054183209, 49.82970433898754, 1.0995045921457065, 153.51814395558128, 134.16229577971356, 2.655462806946064, 21.983376350620393, 63.64170973633445, 53.0404123647623, 37.06935963726342, 56.34494785645579, 9.532416765436352, 107.65435376961625, 16.42425668861508, 156.26067218707811, 79.31323212888029, 33.959314261434784, 13.690440142128995, 36.11729084451053, 10.189585766015954, 59.080026174705694, 41.98103860298498, 21.657963047990858, 60.50237363158293, 83.80879744156594, 70.24576019299722, 240.86190428376435, 233.02072578712927, 11.999835738959145, 36.107239275930056, 5.002439793875798, 88.53969464489639, 3.2067169167039955, 30.341873916808947, 27.411253613740847, 46.83566354003249, 66.39947505333609, 54.5247642631699, 102.6423406603945, 32.08068069199243, 17.64760900600103, 549.3827463484853, 238.81814832297448, 25.57040357095052, 69.03134041729196, 53.79385930792596, 72.8234843218733, 48.28240491844395, 14.752771848580267, 43.7304661851412, 38.663317694085, 11.470042312502775, 394.2756620185808, 64.28490417514298, 33.232989014789744, 9.914651811502615, 79.6731108900116, 6.406906681270608, 42.88709696445931, 39.274013398470395, 65.8044255202228, 73.17365858363819, 160.61292810569287, 222.93107872299404, 90.54120053662412, 14.787793033163936, 108.01856218891291, 58.45584510017541, 88.05798073332785, 10.58513503105228, 25.811780407639265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8246449681271494, "mean_inference_ms": 2.6736945549150066, "mean_action_processing_ms": 0.3654837257019101, "mean_env_wait_ms": 0.3016492781536807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00505828857421875, "StateBufferConnector_ms": 0.003959178924560547, "ViewRequirementAgentConnector_ms": 0.2119288444519043}, "num_episodes": 22, "episode_return_max": 341.2761978015187, "episode_return_min": -11.586369953594899, "episode_return_mean": 152.41952998719674, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.09529313212715, "num_env_steps_trained_throughput_per_sec": 270.09529313212715, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 14897.252, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14897.209, "sample_time_ms": 2073.378, "learn_time_ms": 12805.6, "learn_throughput": 312.363, "synch_weights_time_ms": 16.704}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "6c58f_00000", "date": "2024-08-16_16-23-02", "timestamp": 1723805582, "time_this_iter_s": 14.860877990722656, "time_total_s": 965.1508865356445, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0521ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 965.1508865356445, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 62.085714285714296, "ram_util_percent": 81.56190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.198045325326541, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.6280286503847314, "policy_loss": -0.006052306610548859, "vf_loss": 2.632319461479389, "vf_explained_var": 0.009362738693832721, "kl": 0.01237152379535699, "entropy": 1.4095174985587913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7189060145900363, "cur_kl_coeff": 0.003125, "cur_lr": 1e-05, "total_loss": 4.61683515985176, "policy_loss": -0.005092493629960156, "vf_loss": 4.621915267258094, "vf_explained_var": 0.18493621046580966, "kl": 0.00396315264740346, "entropy": 1.3773107994170415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 341.2761978015187, "episode_reward_min": -27.6880461322536, "episode_reward_mean": 148.51638279149049, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.5626219508878, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.82582924196237, "predator_policy": 549.3827463484853}, "policy_reward_mean": {"prey_policy": 3.0252585430503007, "predator_policy": 71.23293285269499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.02468976081013, 148.7700000000001, 341.2761978015187, 67.27432387706266, 99.07749383959506, 257.1022695613665, 325.76258629434113, 295.57654849229925, 134.76000000000062, 256.56161981349834, 132.63999999999987, 167.20177260986597, 237.06115951212047, 205.1115249056029, 247.37162268966972, 171.87999999999988, 27.2987335109873, 158.7123253001709, 149.69000000000003, 8.279999999999962, 275.5973442827888, 141.97576342327477, 319.8659267472741, 318.65129493432073, 171.7999999999999, 167.95, 7.817841920135566, 317.610448116629, 233.48310894236764, 137.95429759074298, 293.75254992901284, 299.1248437687764, 125.31927976853332, -7.462543653076484, 3.809999999999964, 106.16064026454949, 3.6199999999999655, 143.1923298924735, 263.3250022699468, 198.54244979610084, 3.8199999999999625, 265.0920056355477, 56.330000000000005, 283.2953676177159, -11.542830179375136, 3.5999999999999686, 243.6458876711183, 112.121846959141, 195.03627402222364, 159.42162494926527, 160.95999999999998, 136.28000000000017, 146.22000000000008, 310.5640204412474, 115.31226018094425, 104.60250114884688, 108.73000000000096, 3.629999999999965, 3.6799999999999677, 110.84293090586462, 65.7200000000007, 178.8299999999997, 112.5124929403263, 257.7999999999995, 175.6999999999997, 122.22000000000088, 177.6299999999997, 145.35000000000034, 239.81077560825287, 284.8688039660942, 61.574918730506674, 175.57999999999976, 129.5799999999998, 109.55174144312443, 93.637913221328, 158.05823401370668, 153.15999999999968, 6.649999999999923, 320.5282916397473, 3.2099999999999755, 95.36024167410848, 7.659999999999924, 188.48555602988557, 330.53999999999974, 6.137031139143652, 38.475482468169375, 252.63999999999945, 175.87647130575317, -27.6880461322536, 47.595343971215996, 6.659999999999929, 36.239999999999476, 18.460000000000363, 185.70831513223203, 206.13999999999896, 127.42000000000074, 97.51000000000094, 105.35937668240824, 83.7000000000008, 160.2200000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [65.37023239118238, 59.94406729362041, -16.79264130758446, -35.44368947051143, 109.42786859609441, 135.94340089782844, -103.8413156103437, -7.211568091522137, -22.05218611437424, -119.26648450517104, 96.55995781043674, 53.53177044444506, 145.84126283934313, -131.38524972044536, -112.4929038545201, 133.40761152886188, -6.8010799555894135, 14.107732525146051, 44.8635491810061, 23.91153724513908, 43.470378573739254, -116.58426329077102, -27.376381865777358, -118.37131246710248, 72.79044085297734, -87.17622751766565, 53.574178049774105, -10.749077419045268, 129.60145580100922, -241.9346122076352, 103.59548934864974, -15.071089685717668, -264.62241679365445, -110.24905276695831, 107.54554418481571, -3.2776995194103034, 62.64538681598474, -73.20086797939652, -82.79429794379209, -22.436177243752248, 142.96051067979846, 3.44100153367736, 19.86003506381742, -5.44577970160641, 81.86487601861462, 96.55532473696786, 85.67585871124669, 102.68792185847474, -33.79282846182659, 142.2988708927976, 43.11435737912941, 76.24593354504253, -5.4066487335727516, -63.82558812514746, 161.80056795363907, 43.663189664609405, -3.812989668005452, 20.176498831312923, -8.525478503147426, 1.1187329438218527, -46.371770288712305, 88.51472416203892, 140.31284398829362, 29.600986619174083, -23.374978571304286, -61.66509537062464, -9.302543653076446, -63.49558674938823, -23.541430634022394, -6.279650247394839, -27.260940085610635, 21.190087536635314, -13.909401148088508, -51.31478161084705, -32.91196111794909, 35.32859358278098, 65.6084315918041, 81.40662844177598, -2.6970861081420425, -239.72954481939453, -2.7721961603523964, -13.538032741886402, -7.154169539697797, 114.42974118762854, 4.510295661012247, 0.8904954078542949, 143.24902433909477, -147.63409645667377, -18.421901738015602, -17.759767598925325, -61.8617097363348, -51.22041236476266, 96.60234624049909, 53.62923393690099, -43.19448198000232, 38.12955840408998, 180.82582924196237, -158.4744840954325, 51.82728014638579, -5.678201587435732, 116.94661179135647, -5.794342777996024, 124.38041423398418, -57.370026174706034, 102.318961397015, -19.737963047990558, 122.97240081702272, 43.28044855107599, -20.02625697036619, -175.76914732545126, -130.69417914487065, -9.723881232371113, 70.66276072407034, -3.042439793875814, -86.87969464489554, -1.2367169167040204, -28.431873916808648, -25.64125361374057, -23.448013576078665, 21.05580588857404, 35.67751011710042, -127.1246150406644, -30.290680691992176, 159.39239099399902, -142.1257797802448, -533.5626219508878, 149.89537985259201, 13.302876159165436, 120.27614069207407, -71.19348432187246, -46.73240491844416, 105.91722815141989, 1.7427811347453193, 93.49343498602846, 133.00995768749738, -393.4056620185816, 110.03226235121895, 32.26062006710174, 106.25644382003713, 89.02459744454322, -2.0919879507634276, 14.372903035540663, 134.75598660152963, -64.25442552022201, 71.28253571885686, -175.48912240818873, -126.79954259595182, -77.12099522054154, -54.62612448256706, 25.457682481817084, 90.17238891353084, -78.62798073332712, -8.665135031052321, 125.42821959236083, -33.685016423158835, -19.54894161709344, 150.11043088061484, 16.65441069317032, -119.03305559839526, 0.976121457758378, -59.71556621481242, 60.35049838531454, -8.160213683723324, -19.10077954225797, 134.43235852698712, -71.96046790853, 152.41651016099206, 161.5242986306605, -0.7251551812413721, -11.61569164818811, -13.68869381234139, -1.8736312681227172, -31.386962501108087, 89.10090354756824, -5.703940306381462, 41.98893149196652, -148.69533614956137, -65.9101631835724, -122.24360677573806, -36.4442145887368, -16.4285174093983, -9.970471697788064, -47.19071021355348, -15.178738483963164, -18.40608440759826, -27.060598856082066, 116.65626522835747, 6.587829964501223, -41.856063422549575, 102.17779388030186, -7.915506065294583, 68.74948045976986, 50.206975853344794, -85.65698351732979, -15.605542798452664, 35.65999999999973, -5.309698257110204, 24.506097476302298, -10.836982015181741, 126.2502323638002], "policy_predator_policy_reward": [44.622011532063624, 102.08837854394375, 163.79264130758446, 37.2136894705112, 54.50411518148248, 41.40081312611335, 43.65786607770852, 134.66934150122, 86.71114971861856, 153.6850147405216, 63.021690436136765, 43.98885087034783, 189.8215248720072, 121.48504830343619, 163.4819338082637, 111.17990700969382, 8.823792272638324, 118.62955515780506, 104.47613631566004, 83.31039707169343, 87.5596214262608, 118.19426329077184, 139.56085194532992, 173.38861499741571, 123.29499008243192, 128.15195609437728, 103.1236845009038, 59.162739773970266, 206.25915667280998, 153.44562242348556, 66.40451065135024, 16.951089685717797, 241.86253356421938, 160.30766950738027, 39.23897920006606, 15.205501434699434, 85.35461318401525, 74.89086797939738, 26.722028632456354, 86.78844655508887, 51.04954389671005, 78.14628817260287, 50.10249925131361, 77.45900880975, 104.11075316819922, 37.3349728234924, 63.00566844983775, 67.2818459147616, 35.58282846182623, 27.711129107202392, 25.01564262087037, 23.57406645495759, 13.428460902552533, 63.62161787630373, 45.503978301182, 66.64271219719856, 134.62138027684767, 82.4982195022125, 143.6754785031475, 1.6855646469208916, 136.480709495174, 115.12888656051226, 49.30352717624332, 79.90748598506532, 55.65164235534438, 154.7077113551176, 0.0, 65.33558674938878, 25.411430634022686, 8.219650247394798, 84.43029809432272, 27.801194719202407, 12.874293074987833, 55.96988968394734, 99.17747713575645, 41.59822029188494, 72.70316913261183, 43.606773103755444, 241.37907337032564, 199.59000735331225, 4.722196160352355, 15.408032741886363, 34.52412856929627, 123.2923054183209, 49.82970433898754, 1.0995045921457065, 153.51814395558128, 134.16229577971356, 2.655462806946064, 21.983376350620393, 63.64170973633445, 53.0404123647623, 37.06935963726342, 56.34494785645579, 9.532416765436352, 107.65435376961625, 16.42425668861508, 156.26067218707811, 79.31323212888029, 33.959314261434784, 13.690440142128995, 36.11729084451053, 10.189585766015954, 59.080026174705694, 41.98103860298498, 21.657963047990858, 60.50237363158293, 83.80879744156594, 70.24576019299722, 240.86190428376435, 233.02072578712927, 11.999835738959145, 36.107239275930056, 5.002439793875798, 88.53969464489639, 3.2067169167039955, 30.341873916808947, 27.411253613740847, 46.83566354003249, 66.39947505333609, 54.5247642631699, 102.6423406603945, 32.08068069199243, 17.64760900600103, 549.3827463484853, 238.81814832297448, 25.57040357095052, 69.03134041729196, 53.79385930792596, 72.8234843218733, 48.28240491844395, 14.752771848580267, 43.7304661851412, 38.663317694085, 11.470042312502775, 394.2756620185808, 64.28490417514298, 33.232989014789744, 9.914651811502615, 79.6731108900116, 6.406906681270608, 42.88709696445931, 39.274013398470395, 65.8044255202228, 73.17365858363819, 160.61292810569287, 222.93107872299404, 90.54120053662412, 14.787793033163936, 108.01856218891291, 58.45584510017541, 88.05798073332785, 10.58513503105228, 25.811780407639265, 35.48501642315855, 24.39894161709373, 84.82023644757854, 68.94321361838361, 120.25305559839585, 1.0138785422416234, 38.50822411356299, 56.2170853900421, 26.88845195708511, 8.032541268896171, 62.78686606633458, 63.226799345093816, 14.70960335111763, 1.8895878572298594, 4.952186320385093, 13.525691648188069, 35.49829316101642, 18.539514387617587, 168.3869625011081, 26.539096452432084, 104.553544218892, 35.03793590127619, 176.36766096454446, 10.54979223633547, 103.59652801348571, 102.68663732220567, 18.588750231496228, 14.470238875690363, 13.418277182764838, 85.1911715147517, 35.01608440759851, 28.910598856082355, 36.12710450717765, 26.337115432196292, 141.08606342254953, 4.7322061196986045, 12.755506065294544, 53.83051954023028, 39.360889501879925, 93.59911816210582, 60.59960664242947, 24.70531283843018, 7.229698257110163, 57.27390252369782, 12.7569820151817, 32.04976763619991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8275048347083334, "mean_inference_ms": 2.6830971110669806, "mean_action_processing_ms": 0.3662092224264595, "mean_env_wait_ms": 0.30170394991361166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004957079887390137, "StateBufferConnector_ms": 0.0039484500885009766, "ViewRequirementAgentConnector_ms": 0.21970653533935547}, "num_episodes": 23, "episode_return_max": 341.2761978015187, "episode_return_min": -27.6880461322536, "episode_return_mean": 148.51638279149049, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 255.14476903004248, "num_env_steps_trained_throughput_per_sec": 255.14476903004248, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 14890.052, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14890.008, "sample_time_ms": 2090.468, "learn_time_ms": 12780.594, "learn_throughput": 312.974, "synch_weights_time_ms": 17.331}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "6c58f_00000", "date": "2024-08-16_16-23-18", "timestamp": 1723805598, "time_this_iter_s": 15.7620689868927, "time_total_s": 980.9129555225372, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0502280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 980.9129555225372, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 63.73181818181817, "ram_util_percent": 81.49545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4164563350734256, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 4.5987850271204795, "policy_loss": -0.004806568599478514, "vf_loss": 4.602731914368887, "vf_explained_var": 0.0034380699907030376, "kl": 0.006037778679356098, "entropy": 1.4352035786108996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7827984162423975, "cur_kl_coeff": 0.0015625, "cur_lr": 1e-05, "total_loss": 6.2973383656254525, "policy_loss": -0.003914829759264769, "vf_loss": 6.301234583375315, "vf_explained_var": 0.1021730587595985, "kl": 0.011901605554166781, "entropy": 1.2830581160449477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 387.1783439511699, "episode_reward_min": -27.6880461322536, "episode_reward_mean": 140.58620143670416, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.5626219508878, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 183.9518128519187, "predator_policy": 549.3827463484853}, "policy_reward_mean": {"prey_policy": 1.6278864919208755, "predator_policy": 68.66521422643125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.69000000000003, 8.279999999999962, 275.5973442827888, 141.97576342327477, 319.8659267472741, 318.65129493432073, 171.7999999999999, 167.95, 7.817841920135566, 317.610448116629, 233.48310894236764, 137.95429759074298, 293.75254992901284, 299.1248437687764, 125.31927976853332, -7.462543653076484, 3.809999999999964, 106.16064026454949, 3.6199999999999655, 143.1923298924735, 263.3250022699468, 198.54244979610084, 3.8199999999999625, 265.0920056355477, 56.330000000000005, 283.2953676177159, -11.542830179375136, 3.5999999999999686, 243.6458876711183, 112.121846959141, 195.03627402222364, 159.42162494926527, 160.95999999999998, 136.28000000000017, 146.22000000000008, 310.5640204412474, 115.31226018094425, 104.60250114884688, 108.73000000000096, 3.629999999999965, 3.6799999999999677, 110.84293090586462, 65.7200000000007, 178.8299999999997, 112.5124929403263, 257.7999999999995, 175.6999999999997, 122.22000000000088, 177.6299999999997, 145.35000000000034, 239.81077560825287, 284.8688039660942, 61.574918730506674, 175.57999999999976, 129.5799999999998, 109.55174144312443, 93.637913221328, 158.05823401370668, 153.15999999999968, 6.649999999999923, 320.5282916397473, 3.2099999999999755, 95.36024167410848, 7.659999999999924, 188.48555602988557, 330.53999999999974, 6.137031139143652, 38.475482468169375, 252.63999999999945, 175.87647130575317, -27.6880461322536, 47.595343971215996, 6.659999999999929, 36.239999999999476, 18.460000000000363, 185.70831513223203, 206.13999999999896, 127.42000000000074, 97.51000000000094, 105.35937668240824, 83.7000000000008, 160.2200000000003, 148.109785114118, 107.94327462835362, 3.499999999999967, 88.8500000000011, 201.8936906009405, 338.21252079434447, 162.45297362562053, 387.1783439511699, 160.1599999999995, 293.8042144171809, -0.9930001543956277, 137.82727590772953, -2.2443463947892646, 191.8599999999998, 164.16999999999967, 181.6499999999998, 184.94999999999982, 3.1199999999999783], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [62.64538681598474, -73.20086797939652, -82.79429794379209, -22.436177243752248, 142.96051067979846, 3.44100153367736, 19.86003506381742, -5.44577970160641, 81.86487601861462, 96.55532473696786, 85.67585871124669, 102.68792185847474, -33.79282846182659, 142.2988708927976, 43.11435737912941, 76.24593354504253, -5.4066487335727516, -63.82558812514746, 161.80056795363907, 43.663189664609405, -3.812989668005452, 20.176498831312923, -8.525478503147426, 1.1187329438218527, -46.371770288712305, 88.51472416203892, 140.31284398829362, 29.600986619174083, -23.374978571304286, -61.66509537062464, -9.302543653076446, -63.49558674938823, -23.541430634022394, -6.279650247394839, -27.260940085610635, 21.190087536635314, -13.909401148088508, -51.31478161084705, -32.91196111794909, 35.32859358278098, 65.6084315918041, 81.40662844177598, -2.6970861081420425, -239.72954481939453, -2.7721961603523964, -13.538032741886402, -7.154169539697797, 114.42974118762854, 4.510295661012247, 0.8904954078542949, 143.24902433909477, -147.63409645667377, -18.421901738015602, -17.759767598925325, -61.8617097363348, -51.22041236476266, 96.60234624049909, 53.62923393690099, -43.19448198000232, 38.12955840408998, 180.82582924196237, -158.4744840954325, 51.82728014638579, -5.678201587435732, 116.94661179135647, -5.794342777996024, 124.38041423398418, -57.370026174706034, 102.318961397015, -19.737963047990558, 122.97240081702272, 43.28044855107599, -20.02625697036619, -175.76914732545126, -130.69417914487065, -9.723881232371113, 70.66276072407034, -3.042439793875814, -86.87969464489554, -1.2367169167040204, -28.431873916808648, -25.64125361374057, -23.448013576078665, 21.05580588857404, 35.67751011710042, -127.1246150406644, -30.290680691992176, 159.39239099399902, -142.1257797802448, -533.5626219508878, 149.89537985259201, 13.302876159165436, 120.27614069207407, -71.19348432187246, -46.73240491844416, 105.91722815141989, 1.7427811347453193, 93.49343498602846, 133.00995768749738, -393.4056620185816, 110.03226235121895, 32.26062006710174, 106.25644382003713, 89.02459744454322, -2.0919879507634276, 14.372903035540663, 134.75598660152963, -64.25442552022201, 71.28253571885686, -175.48912240818873, -126.79954259595182, -77.12099522054154, -54.62612448256706, 25.457682481817084, 90.17238891353084, -78.62798073332712, -8.665135031052321, 125.42821959236083, -33.685016423158835, -19.54894161709344, 150.11043088061484, 16.65441069317032, -119.03305559839526, 0.976121457758378, -59.71556621481242, 60.35049838531454, -8.160213683723324, -19.10077954225797, 134.43235852698712, -71.96046790853, 152.41651016099206, 161.5242986306605, -0.7251551812413721, -11.61569164818811, -13.68869381234139, -1.8736312681227172, -31.386962501108087, 89.10090354756824, -5.703940306381462, 41.98893149196652, -148.69533614956137, -65.9101631835724, -122.24360677573806, -36.4442145887368, -16.4285174093983, -9.970471697788064, -47.19071021355348, -15.178738483963164, -18.40608440759826, -27.060598856082066, 116.65626522835747, 6.587829964501223, -41.856063422549575, 102.17779388030186, -7.915506065294583, 68.74948045976986, 50.206975853344794, -85.65698351732979, -15.605542798452664, 35.65999999999973, -5.309698257110204, 24.506097476302298, -10.836982015181741, 126.2502323638002, 72.20908575421177, -33.176979624670466, 27.666899275021457, -75.67952020530777, -19.925046377793887, -78.22060027961749, 85.26001831257766, -24.556890692487563, 143.3159596711683, 11.024830597933777, -392.8917268020569, 139.84099134848358, -283.17162183779493, -18.90400296843867, -329.42013874738996, 183.9518128519187, 135.0241626124353, -8.905689253148347, 154.86253948596655, -279.44546987404675, -79.6404842712515, -26.400540125003964, -7.892010524987832, -54.19445199055758, -30.133658869947276, -26.249488722234233, 173.35217071607548, -7.912454361900473, -10.743300426570066, 142.60186642742184, -109.03304486044722, 142.59270589736076, -4.076621017155114, 162.36672181409435, -31.287869863361536, -78.89533789411581], "policy_predator_policy_reward": [85.35461318401525, 74.89086797939738, 26.722028632456354, 86.78844655508887, 51.04954389671005, 78.14628817260287, 50.10249925131361, 77.45900880975, 104.11075316819922, 37.3349728234924, 63.00566844983775, 67.2818459147616, 35.58282846182623, 27.711129107202392, 25.01564262087037, 23.57406645495759, 13.428460902552533, 63.62161787630373, 45.503978301182, 66.64271219719856, 134.62138027684767, 82.4982195022125, 143.6754785031475, 1.6855646469208916, 136.480709495174, 115.12888656051226, 49.30352717624332, 79.90748598506532, 55.65164235534438, 154.7077113551176, 0.0, 65.33558674938878, 25.411430634022686, 8.219650247394798, 84.43029809432272, 27.801194719202407, 12.874293074987833, 55.96988968394734, 99.17747713575645, 41.59822029188494, 72.70316913261183, 43.606773103755444, 241.37907337032564, 199.59000735331225, 4.722196160352355, 15.408032741886363, 34.52412856929627, 123.2923054183209, 49.82970433898754, 1.0995045921457065, 153.51814395558128, 134.16229577971356, 2.655462806946064, 21.983376350620393, 63.64170973633445, 53.0404123647623, 37.06935963726342, 56.34494785645579, 9.532416765436352, 107.65435376961625, 16.42425668861508, 156.26067218707811, 79.31323212888029, 33.959314261434784, 13.690440142128995, 36.11729084451053, 10.189585766015954, 59.080026174705694, 41.98103860298498, 21.657963047990858, 60.50237363158293, 83.80879744156594, 70.24576019299722, 240.86190428376435, 233.02072578712927, 11.999835738959145, 36.107239275930056, 5.002439793875798, 88.53969464489639, 3.2067169167039955, 30.341873916808947, 27.411253613740847, 46.83566354003249, 66.39947505333609, 54.5247642631699, 102.6423406603945, 32.08068069199243, 17.64760900600103, 549.3827463484853, 238.81814832297448, 25.57040357095052, 69.03134041729196, 53.79385930792596, 72.8234843218733, 48.28240491844395, 14.752771848580267, 43.7304661851412, 38.663317694085, 11.470042312502775, 394.2756620185808, 64.28490417514298, 33.232989014789744, 9.914651811502615, 79.6731108900116, 6.406906681270608, 42.88709696445931, 39.274013398470395, 65.8044255202228, 73.17365858363819, 160.61292810569287, 222.93107872299404, 90.54120053662412, 14.787793033163936, 108.01856218891291, 58.45584510017541, 88.05798073332785, 10.58513503105228, 25.811780407639265, 35.48501642315855, 24.39894161709373, 84.82023644757854, 68.94321361838361, 120.25305559839585, 1.0138785422416234, 38.50822411356299, 56.2170853900421, 26.88845195708511, 8.032541268896171, 62.78686606633458, 63.226799345093816, 14.70960335111763, 1.8895878572298594, 4.952186320385093, 13.525691648188069, 35.49829316101642, 18.539514387617587, 168.3869625011081, 26.539096452432084, 104.553544218892, 35.03793590127619, 176.36766096454446, 10.54979223633547, 103.59652801348571, 102.68663732220567, 18.588750231496228, 14.470238875690363, 13.418277182764838, 85.1911715147517, 35.01608440759851, 28.910598856082355, 36.12710450717765, 26.337115432196292, 141.08606342254953, 4.7322061196986045, 12.755506065294544, 53.83051954023028, 39.360889501879925, 93.59911816210582, 60.59960664242947, 24.70531283843018, 7.229698257110163, 57.27390252369782, 12.7569820151817, 32.04976763619991, 49.92058237930422, 59.15709660527199, 29.107176874987076, 126.8487186836533, 21.755046377794173, 79.89060027961834, 25.06232857864972, 3.084543801260782, 3.5192848497242055, 44.03361548211456, 262.5552629571295, 328.70799329078835, 235.42148526536582, 229.10711316648863, 278.26674962632063, 254.37992022032043, 29.174583490245926, 4.866943150466852, 197.53012652142078, 220.85701828384018, 41.78993147789838, 63.2580927639616, 101.36300391869766, 98.55073450457692, 30.029313997631046, 24.10948719976184, 15.454874279651515, 10.965409366173446, 12.643300426570026, 19.668133572578018, 110.68304486044806, 37.40729410263924, 3.211245158631572, 23.44865404442915, 42.40959058934201, 70.89361716813588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8320696408636183, "mean_inference_ms": 2.6946221083682893, "mean_action_processing_ms": 0.3669466959294865, "mean_env_wait_ms": 0.30226761622213066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00463414192199707, "StateBufferConnector_ms": 0.003876805305480957, "ViewRequirementAgentConnector_ms": 0.20960640907287598}, "num_episodes": 18, "episode_return_max": 387.1783439511699, "episode_return_min": -27.6880461322536, "episode_return_mean": 140.58620143670416, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.623735598517, "num_env_steps_trained_throughput_per_sec": 262.623735598517, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 14966.298, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14966.249, "sample_time_ms": 2149.826, "learn_time_ms": 12797.005, "learn_throughput": 312.573, "synch_weights_time_ms": 17.777}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "6c58f_00000", "date": "2024-08-16_16-23-34", "timestamp": 1723805614, "time_this_iter_s": 15.308977842330933, "time_total_s": 996.2219333648682, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b050aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 996.2219333648682, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 66.2818181818182, "ram_util_percent": 81.56818181818183}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2478691541486315, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.420104606378646, "policy_loss": -0.004650221518166954, "vf_loss": 2.4234837281640877, "vf_explained_var": 0.0016689701685829769, "kl": 0.008927356745433233, "entropy": 1.4431271740999172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9859051945663633, "cur_kl_coeff": 0.0015625, "cur_lr": 1e-05, "total_loss": 6.267155556451707, "policy_loss": -0.0030177871397297296, "vf_loss": 6.270165913193314, "vf_explained_var": 0.2074863333866079, "kl": 0.0047517639643518406, "entropy": 1.257459249067559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 387.1783439511699, "episode_reward_min": -27.6880461322536, "episode_reward_mean": 141.1910460144337, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.5626219508878, "predator_policy": 1.0138785422416234}, "policy_reward_max": {"prey_policy": 183.9518128519187, "predator_policy": 549.3827463484853}, "policy_reward_mean": {"prey_policy": -0.05759327971442531, "predator_policy": 70.65311628693132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6199999999999655, 143.1923298924735, 263.3250022699468, 198.54244979610084, 3.8199999999999625, 265.0920056355477, 56.330000000000005, 283.2953676177159, -11.542830179375136, 3.5999999999999686, 243.6458876711183, 112.121846959141, 195.03627402222364, 159.42162494926527, 160.95999999999998, 136.28000000000017, 146.22000000000008, 310.5640204412474, 115.31226018094425, 104.60250114884688, 108.73000000000096, 3.629999999999965, 3.6799999999999677, 110.84293090586462, 65.7200000000007, 178.8299999999997, 112.5124929403263, 257.7999999999995, 175.6999999999997, 122.22000000000088, 177.6299999999997, 145.35000000000034, 239.81077560825287, 284.8688039660942, 61.574918730506674, 175.57999999999976, 129.5799999999998, 109.55174144312443, 93.637913221328, 158.05823401370668, 153.15999999999968, 6.649999999999923, 320.5282916397473, 3.2099999999999755, 95.36024167410848, 7.659999999999924, 188.48555602988557, 330.53999999999974, 6.137031139143652, 38.475482468169375, 252.63999999999945, 175.87647130575317, -27.6880461322536, 47.595343971215996, 6.659999999999929, 36.239999999999476, 18.460000000000363, 185.70831513223203, 206.13999999999896, 127.42000000000074, 97.51000000000094, 105.35937668240824, 83.7000000000008, 160.2200000000003, 148.109785114118, 107.94327462835362, 3.499999999999967, 88.8500000000011, 201.8936906009405, 338.21252079434447, 162.45297362562053, 387.1783439511699, 160.1599999999995, 293.8042144171809, -0.9930001543956277, 137.82727590772953, -2.2443463947892646, 191.8599999999998, 164.16999999999967, 181.6499999999998, 184.94999999999982, 3.1199999999999783, 116.92045224373918, 300.11064974350415, 272.9618842835506, 178.77999999999966, 169.09891387940172, 2.7199999999999838, 113.83424497518591, 156.1000000000002, 259.34377986782283, 92.93633071482488, 127.5900000000003, 68.09000000000117, 356.87120467359904, 169.96894204794552, 154.44620649595288, 257.96216271155436, 148.58048217120694, 185.54999999999973], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.909401148088508, -51.31478161084705, -32.91196111794909, 35.32859358278098, 65.6084315918041, 81.40662844177598, -2.6970861081420425, -239.72954481939453, -2.7721961603523964, -13.538032741886402, -7.154169539697797, 114.42974118762854, 4.510295661012247, 0.8904954078542949, 143.24902433909477, -147.63409645667377, -18.421901738015602, -17.759767598925325, -61.8617097363348, -51.22041236476266, 96.60234624049909, 53.62923393690099, -43.19448198000232, 38.12955840408998, 180.82582924196237, -158.4744840954325, 51.82728014638579, -5.678201587435732, 116.94661179135647, -5.794342777996024, 124.38041423398418, -57.370026174706034, 102.318961397015, -19.737963047990558, 122.97240081702272, 43.28044855107599, -20.02625697036619, -175.76914732545126, -130.69417914487065, -9.723881232371113, 70.66276072407034, -3.042439793875814, -86.87969464489554, -1.2367169167040204, -28.431873916808648, -25.64125361374057, -23.448013576078665, 21.05580588857404, 35.67751011710042, -127.1246150406644, -30.290680691992176, 159.39239099399902, -142.1257797802448, -533.5626219508878, 149.89537985259201, 13.302876159165436, 120.27614069207407, -71.19348432187246, -46.73240491844416, 105.91722815141989, 1.7427811347453193, 93.49343498602846, 133.00995768749738, -393.4056620185816, 110.03226235121895, 32.26062006710174, 106.25644382003713, 89.02459744454322, -2.0919879507634276, 14.372903035540663, 134.75598660152963, -64.25442552022201, 71.28253571885686, -175.48912240818873, -126.79954259595182, -77.12099522054154, -54.62612448256706, 25.457682481817084, 90.17238891353084, -78.62798073332712, -8.665135031052321, 125.42821959236083, -33.685016423158835, -19.54894161709344, 150.11043088061484, 16.65441069317032, -119.03305559839526, 0.976121457758378, -59.71556621481242, 60.35049838531454, -8.160213683723324, -19.10077954225797, 134.43235852698712, -71.96046790853, 152.41651016099206, 161.5242986306605, -0.7251551812413721, -11.61569164818811, -13.68869381234139, -1.8736312681227172, -31.386962501108087, 89.10090354756824, -5.703940306381462, 41.98893149196652, -148.69533614956137, -65.9101631835724, -122.24360677573806, -36.4442145887368, -16.4285174093983, -9.970471697788064, -47.19071021355348, -15.178738483963164, -18.40608440759826, -27.060598856082066, 116.65626522835747, 6.587829964501223, -41.856063422549575, 102.17779388030186, -7.915506065294583, 68.74948045976986, 50.206975853344794, -85.65698351732979, -15.605542798452664, 35.65999999999973, -5.309698257110204, 24.506097476302298, -10.836982015181741, 126.2502323638002, 72.20908575421177, -33.176979624670466, 27.666899275021457, -75.67952020530777, -19.925046377793887, -78.22060027961749, 85.26001831257766, -24.556890692487563, 143.3159596711683, 11.024830597933777, -392.8917268020569, 139.84099134848358, -283.17162183779493, -18.90400296843867, -329.42013874738996, 183.9518128519187, 135.0241626124353, -8.905689253148347, 154.86253948596655, -279.44546987404675, -79.6404842712515, -26.400540125003964, -7.892010524987832, -54.19445199055758, -30.133658869947276, -26.249488722234233, 173.35217071607548, -7.912454361900473, -10.743300426570066, 142.60186642742184, -109.03304486044722, 142.59270589736076, -4.076621017155114, 162.36672181409435, -31.287869863361536, -78.89533789411581, -217.32443148177805, -33.12824717771259, 145.30505671341615, 73.99641059557801, 39.55819658779507, 138.22084806986783, 155.56719201410857, -182.077871752481, -78.66115975845541, -8.068119663836177, -190.735737785919, -33.40841680436112, 2.0000000000000013, -79.26912495714011, 98.87199225883654, -8.95439813993553, 148.89891253117682, 64.90631969648386, -36.56805169710029, 44.39989790994826, -58.04610537852237, -42.5250737222257, 1.4331936533826948, 40.07807352876508, 138.1065610361385, 144.59539542090414, -33.86922131097964, 151.7714315992434, 2.0000000000000013, 79.13563323866488, 97.85636059954223, -223.20528029662762, -4.832780840545935, 27.06518137863718, -69.0260042800137, 172.03247086278088], "policy_predator_policy_reward": [12.874293074987833, 55.96988968394734, 99.17747713575645, 41.59822029188494, 72.70316913261183, 43.606773103755444, 241.37907337032564, 199.59000735331225, 4.722196160352355, 15.408032741886363, 34.52412856929627, 123.2923054183209, 49.82970433898754, 1.0995045921457065, 153.51814395558128, 134.16229577971356, 2.655462806946064, 21.983376350620393, 63.64170973633445, 53.0404123647623, 37.06935963726342, 56.34494785645579, 9.532416765436352, 107.65435376961625, 16.42425668861508, 156.26067218707811, 79.31323212888029, 33.959314261434784, 13.690440142128995, 36.11729084451053, 10.189585766015954, 59.080026174705694, 41.98103860298498, 21.657963047990858, 60.50237363158293, 83.80879744156594, 70.24576019299722, 240.86190428376435, 233.02072578712927, 11.999835738959145, 36.107239275930056, 5.002439793875798, 88.53969464489639, 3.2067169167039955, 30.341873916808947, 27.411253613740847, 46.83566354003249, 66.39947505333609, 54.5247642631699, 102.6423406603945, 32.08068069199243, 17.64760900600103, 549.3827463484853, 238.81814832297448, 25.57040357095052, 69.03134041729196, 53.79385930792596, 72.8234843218733, 48.28240491844395, 14.752771848580267, 43.7304661851412, 38.663317694085, 11.470042312502775, 394.2756620185808, 64.28490417514298, 33.232989014789744, 9.914651811502615, 79.6731108900116, 6.406906681270608, 42.88709696445931, 39.274013398470395, 65.8044255202228, 73.17365858363819, 160.61292810569287, 222.93107872299404, 90.54120053662412, 14.787793033163936, 108.01856218891291, 58.45584510017541, 88.05798073332785, 10.58513503105228, 25.811780407639265, 35.48501642315855, 24.39894161709373, 84.82023644757854, 68.94321361838361, 120.25305559839585, 1.0138785422416234, 38.50822411356299, 56.2170853900421, 26.88845195708511, 8.032541268896171, 62.78686606633458, 63.226799345093816, 14.70960335111763, 1.8895878572298594, 4.952186320385093, 13.525691648188069, 35.49829316101642, 18.539514387617587, 168.3869625011081, 26.539096452432084, 104.553544218892, 35.03793590127619, 176.36766096454446, 10.54979223633547, 103.59652801348571, 102.68663732220567, 18.588750231496228, 14.470238875690363, 13.418277182764838, 85.1911715147517, 35.01608440759851, 28.910598856082355, 36.12710450717765, 26.337115432196292, 141.08606342254953, 4.7322061196986045, 12.755506065294544, 53.83051954023028, 39.360889501879925, 93.59911816210582, 60.59960664242947, 24.70531283843018, 7.229698257110163, 57.27390252369782, 12.7569820151817, 32.04976763619991, 49.92058237930422, 59.15709660527199, 29.107176874987076, 126.8487186836533, 21.755046377794173, 79.89060027961834, 25.06232857864972, 3.084543801260782, 3.5192848497242055, 44.03361548211456, 262.5552629571295, 328.70799329078835, 235.42148526536582, 229.10711316648863, 278.26674962632063, 254.37992022032043, 29.174583490245926, 4.866943150466852, 197.53012652142078, 220.85701828384018, 41.78993147789838, 63.2580927639616, 101.36300391869766, 98.55073450457692, 30.029313997631046, 24.10948719976184, 15.454874279651515, 10.965409366173446, 12.643300426570026, 19.668133572578018, 110.68304486044806, 37.40729410263924, 3.211245158631572, 23.44865404442915, 42.40959058934201, 70.89361716813588, 212.46482533305723, 154.9083055701717, 54.206772320086415, 26.602410114423932, 18.387403410776997, 76.79543621511118, 25.946684985758143, 179.34399475261378, 161.85858575315672, 93.96960754853704, 191.6457377859182, 35.21841680436076, 145.57341549437578, 45.52995443795003, 55.30800774116342, 10.874398139935488, 29.37380248518176, 16.164745154981777, 63.28570202726623, 21.81878247470948, 59.63610537852224, 168.5250737222257, 11.835286796038629, 14.743446021813302, 43.080990497115614, 31.08825771944087, 5.705861668917471, 46.36087009076479, 52.416169831349826, 20.894403425938055, 180.51827949665838, 202.79280291198134, 25.290069571551474, 101.05801206156406, 70.54600428001437, 11.997529137219072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.834774734175985, "mean_inference_ms": 2.7033304635334936, "mean_action_processing_ms": 0.36772044240926605, "mean_env_wait_ms": 0.3026137840208506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004743695259094238, "StateBufferConnector_ms": 0.00391995906829834, "ViewRequirementAgentConnector_ms": 0.16325652599334717}, "num_episodes": 18, "episode_return_max": 387.1783439511699, "episode_return_min": -27.6880461322536, "episode_return_mean": 141.1910460144337, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.12571511174417, "num_env_steps_trained_throughput_per_sec": 267.12571511174417, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 14988.985, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14988.934, "sample_time_ms": 2194.283, "learn_time_ms": 12773.68, "learn_throughput": 313.144, "synch_weights_time_ms": 19.175}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "6c58f_00000", "date": "2024-08-16_16-23-49", "timestamp": 1723805629, "time_this_iter_s": 14.998047113418579, "time_total_s": 1011.2199804782867, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33e7b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1011.2199804782867, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 66.68571428571428, "ram_util_percent": 82.17142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2116830894240627, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 2.356165990564558, "policy_loss": -0.006082250478199471, "vf_loss": 2.3609620836676743, "vf_explained_var": 0.007525884915911962, "kl": 0.009033097164577468, "entropy": 1.4751601485348251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7140765409778667, "cur_kl_coeff": 0.00078125, "cur_lr": 1e-05, "total_loss": 5.816814184945727, "policy_loss": -0.002496768887248383, "vf_loss": 5.81930539595387, "vf_explained_var": 0.17995369393358784, "kl": 0.007091599479623022, "entropy": 1.2495558555164035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 387.1783439511699, "episode_reward_min": -27.6880461322536, "episode_reward_mean": 147.81175660754246, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -533.5626219508878, "predator_policy": 0.7806298106013035}, "policy_reward_max": {"prey_policy": 183.9518128519187, "predator_policy": 549.3827463484853}, "policy_reward_mean": {"prey_policy": 4.767858983369332, "predator_policy": 69.13801932040197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.6799999999999677, 110.84293090586462, 65.7200000000007, 178.8299999999997, 112.5124929403263, 257.7999999999995, 175.6999999999997, 122.22000000000088, 177.6299999999997, 145.35000000000034, 239.81077560825287, 284.8688039660942, 61.574918730506674, 175.57999999999976, 129.5799999999998, 109.55174144312443, 93.637913221328, 158.05823401370668, 153.15999999999968, 6.649999999999923, 320.5282916397473, 3.2099999999999755, 95.36024167410848, 7.659999999999924, 188.48555602988557, 330.53999999999974, 6.137031139143652, 38.475482468169375, 252.63999999999945, 175.87647130575317, -27.6880461322536, 47.595343971215996, 6.659999999999929, 36.239999999999476, 18.460000000000363, 185.70831513223203, 206.13999999999896, 127.42000000000074, 97.51000000000094, 105.35937668240824, 83.7000000000008, 160.2200000000003, 148.109785114118, 107.94327462835362, 3.499999999999967, 88.8500000000011, 201.8936906009405, 338.21252079434447, 162.45297362562053, 387.1783439511699, 160.1599999999995, 293.8042144171809, -0.9930001543956277, 137.82727590772953, -2.2443463947892646, 191.8599999999998, 164.16999999999967, 181.6499999999998, 184.94999999999982, 3.1199999999999783, 116.92045224373918, 300.11064974350415, 272.9618842835506, 178.77999999999966, 169.09891387940172, 2.7199999999999838, 113.83424497518591, 156.1000000000002, 259.34377986782283, 92.93633071482488, 127.5900000000003, 68.09000000000117, 356.87120467359904, 169.96894204794552, 154.44620649595288, 257.96216271155436, 148.58048217120694, 185.54999999999973, 138.29000000000025, 146.21000000000015, 19.95108192122377, 77.04770118047382, 307.1036075407643, 9.339044532069567, 157.03796937357043, 177.96999999999983, 100.26916678359161, 144.28000000000006, 158.80628348530126, 197.16180809717093, 171.54909135441955, 149.03999999999996, 247.02799892003677, 274.9918270541071, 174.14843964262616, 332.9479524929857, 296.5599999999998, 4.994926089943788, 183.78999999999974, 199.35290124778865], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.431873916808648, -25.64125361374057, -23.448013576078665, 21.05580588857404, 35.67751011710042, -127.1246150406644, -30.290680691992176, 159.39239099399902, -142.1257797802448, -533.5626219508878, 149.89537985259201, 13.302876159165436, 120.27614069207407, -71.19348432187246, -46.73240491844416, 105.91722815141989, 1.7427811347453193, 93.49343498602846, 133.00995768749738, -393.4056620185816, 110.03226235121895, 32.26062006710174, 106.25644382003713, 89.02459744454322, -2.0919879507634276, 14.372903035540663, 134.75598660152963, -64.25442552022201, 71.28253571885686, -175.48912240818873, -126.79954259595182, -77.12099522054154, -54.62612448256706, 25.457682481817084, 90.17238891353084, -78.62798073332712, -8.665135031052321, 125.42821959236083, -33.685016423158835, -19.54894161709344, 150.11043088061484, 16.65441069317032, -119.03305559839526, 0.976121457758378, -59.71556621481242, 60.35049838531454, -8.160213683723324, -19.10077954225797, 134.43235852698712, -71.96046790853, 152.41651016099206, 161.5242986306605, -0.7251551812413721, -11.61569164818811, -13.68869381234139, -1.8736312681227172, -31.386962501108087, 89.10090354756824, -5.703940306381462, 41.98893149196652, -148.69533614956137, -65.9101631835724, -122.24360677573806, -36.4442145887368, -16.4285174093983, -9.970471697788064, -47.19071021355348, -15.178738483963164, -18.40608440759826, -27.060598856082066, 116.65626522835747, 6.587829964501223, -41.856063422549575, 102.17779388030186, -7.915506065294583, 68.74948045976986, 50.206975853344794, -85.65698351732979, -15.605542798452664, 35.65999999999973, -5.309698257110204, 24.506097476302298, -10.836982015181741, 126.2502323638002, 72.20908575421177, -33.176979624670466, 27.666899275021457, -75.67952020530777, -19.925046377793887, -78.22060027961749, 85.26001831257766, -24.556890692487563, 143.3159596711683, 11.024830597933777, -392.8917268020569, 139.84099134848358, -283.17162183779493, -18.90400296843867, -329.42013874738996, 183.9518128519187, 135.0241626124353, -8.905689253148347, 154.86253948596655, -279.44546987404675, -79.6404842712515, -26.400540125003964, -7.892010524987832, -54.19445199055758, -30.133658869947276, -26.249488722234233, 173.35217071607548, -7.912454361900473, -10.743300426570066, 142.60186642742184, -109.03304486044722, 142.59270589736076, -4.076621017155114, 162.36672181409435, -31.287869863361536, -78.89533789411581, -217.32443148177805, -33.12824717771259, 145.30505671341615, 73.99641059557801, 39.55819658779507, 138.22084806986783, 155.56719201410857, -182.077871752481, -78.66115975845541, -8.068119663836177, -190.735737785919, -33.40841680436112, 2.0000000000000013, -79.26912495714011, 98.87199225883654, -8.95439813993553, 148.89891253117682, 64.90631969648386, -36.56805169710029, 44.39989790994826, -58.04610537852237, -42.5250737222257, 1.4331936533826948, 40.07807352876508, 138.1065610361385, 144.59539542090414, -33.86922131097964, 151.7714315992434, 2.0000000000000013, 79.13563323866488, 97.85636059954223, -223.20528029662762, -4.832780840545935, 27.06518137863718, -69.0260042800137, 172.03247086278088, -23.962122997158108, 102.86171269542102, 66.98737393161709, -2.7714627585635965, -92.20561994418986, -42.78421718821625, -42.298576783932916, 57.61131980946686, -298.77662454024323, 149.42110183782603, -66.45001039761287, -2.525726978349711, 96.38851556180742, 9.961403188483166, -9.304163932754877, 139.5098444202306, 33.33016299767283, -208.21142067784072, -11.843906800121987, 116.00839672907402, -3.855135607819496, 61.54978619418391, 17.16578537989338, 29.652546202275918, -38.74124991503664, 126.64146658560759, -6.934614200800807, 34.88917638828462, -211.33511957144677, 177.28071288750846, 96.17299123143701, 133.368158440765, 57.863294849517295, 20.81865100104722, 69.56828948325108, 83.62677304856334, 79.80234608404473, 156.86593120190545, -8.933934210961128, -6.841126112268812, -38.30202926294027, 144.1272723812507, 156.66777602633013, -68.52109519730914], "policy_predator_policy_reward": [30.341873916808947, 27.411253613740847, 46.83566354003249, 66.39947505333609, 54.5247642631699, 102.6423406603945, 32.08068069199243, 17.64760900600103, 549.3827463484853, 238.81814832297448, 25.57040357095052, 69.03134041729196, 53.79385930792596, 72.8234843218733, 48.28240491844395, 14.752771848580267, 43.7304661851412, 38.663317694085, 11.470042312502775, 394.2756620185808, 64.28490417514298, 33.232989014789744, 9.914651811502615, 79.6731108900116, 6.406906681270608, 42.88709696445931, 39.274013398470395, 65.8044255202228, 73.17365858363819, 160.61292810569287, 222.93107872299404, 90.54120053662412, 14.787793033163936, 108.01856218891291, 58.45584510017541, 88.05798073332785, 10.58513503105228, 25.811780407639265, 35.48501642315855, 24.39894161709373, 84.82023644757854, 68.94321361838361, 120.25305559839585, 1.0138785422416234, 38.50822411356299, 56.2170853900421, 26.88845195708511, 8.032541268896171, 62.78686606633458, 63.226799345093816, 14.70960335111763, 1.8895878572298594, 4.952186320385093, 13.525691648188069, 35.49829316101642, 18.539514387617587, 168.3869625011081, 26.539096452432084, 104.553544218892, 35.03793590127619, 176.36766096454446, 10.54979223633547, 103.59652801348571, 102.68663732220567, 18.588750231496228, 14.470238875690363, 13.418277182764838, 85.1911715147517, 35.01608440759851, 28.910598856082355, 36.12710450717765, 26.337115432196292, 141.08606342254953, 4.7322061196986045, 12.755506065294544, 53.83051954023028, 39.360889501879925, 93.59911816210582, 60.59960664242947, 24.70531283843018, 7.229698257110163, 57.27390252369782, 12.7569820151817, 32.04976763619991, 49.92058237930422, 59.15709660527199, 29.107176874987076, 126.8487186836533, 21.755046377794173, 79.89060027961834, 25.06232857864972, 3.084543801260782, 3.5192848497242055, 44.03361548211456, 262.5552629571295, 328.70799329078835, 235.42148526536582, 229.10711316648863, 278.26674962632063, 254.37992022032043, 29.174583490245926, 4.866943150466852, 197.53012652142078, 220.85701828384018, 41.78993147789838, 63.2580927639616, 101.36300391869766, 98.55073450457692, 30.029313997631046, 24.10948719976184, 15.454874279651515, 10.965409366173446, 12.643300426570026, 19.668133572578018, 110.68304486044806, 37.40729410263924, 3.211245158631572, 23.44865404442915, 42.40959058934201, 70.89361716813588, 212.46482533305723, 154.9083055701717, 54.206772320086415, 26.602410114423932, 18.387403410776997, 76.79543621511118, 25.946684985758143, 179.34399475261378, 161.85858575315672, 93.96960754853704, 191.6457377859182, 35.21841680436076, 145.57341549437578, 45.52995443795003, 55.30800774116342, 10.874398139935488, 29.37380248518176, 16.164745154981777, 63.28570202726623, 21.81878247470948, 59.63610537852224, 168.5250737222257, 11.835286796038629, 14.743446021813302, 43.080990497115614, 31.08825771944087, 5.705861668917471, 46.36087009076479, 52.416169831349826, 20.894403425938055, 180.51827949665838, 202.79280291198134, 25.290069571551474, 101.05801206156406, 70.54600428001437, 11.997529137219072, 41.724221903837595, 17.666188397899948, 77.26262606838291, 4.731462758563555, 78.0071331018077, 76.93378595182214, 59.93101597937725, 1.803942175561291, 176.53895571316744, 279.9201745300149, 11.74457555436362, 66.5702063536693, 22.22439772917183, 28.463652894108794, 11.234163932754836, 36.53015557976942, 0.7806298106013035, 274.36979465315835, 13.743906800121946, 26.3716032709261, 12.970105576678717, 88.1415273222581, 70.87304113223306, 79.47043538276914, 29.93473411665068, 53.71414056719769, 8.844614200800766, 112.2408236117154, 173.8039780255509, 107.27842757842392, 33.82437341343714, 11.626303968468026, 72.57718860137933, 22.889305190682528, 34.6847647942524, 145.0681251669189, 40.12277718005516, 19.768945533994778, 7.327119737436343, 13.442866675737365, 48.97202926293994, 28.992727618749317, 67.54937238741343, 43.65684803135543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8382504045194075, "mean_inference_ms": 2.7091844835294294, "mean_action_processing_ms": 0.3683748736913043, "mean_env_wait_ms": 0.3031470897820609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004601478576660156, "StateBufferConnector_ms": 0.0035429000854492188, "ViewRequirementAgentConnector_ms": 0.14471149444580078}, "num_episodes": 22, "episode_return_max": 387.1783439511699, "episode_return_min": -27.6880461322536, "episode_return_mean": 147.81175660754246, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.26769647337284, "num_env_steps_trained_throughput_per_sec": 277.26769647337284, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 14947.281, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14947.229, "sample_time_ms": 2194.108, "learn_time_ms": 12731.879, "learn_throughput": 314.172, "synch_weights_time_ms": 19.295}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "6c58f_00000", "date": "2024-08-16_16-24-03", "timestamp": 1723805643, "time_this_iter_s": 14.478624105453491, "time_total_s": 1025.6986045837402, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33e7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1025.6986045837402, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.45714285714286, "ram_util_percent": 81.68571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.222398990881506, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 3.3539266527014435, "policy_loss": -0.005078803692702894, "vf_loss": 3.3577049532264627, "vf_explained_var": 0.006726489842884124, "kl": 0.009133795756307642, "entropy": 1.450718888719246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.849643524550887, "cur_kl_coeff": 0.00078125, "cur_lr": 1e-05, "total_loss": 6.014767550917529, "policy_loss": -0.002084230834485165, "vf_loss": 6.016849795851127, "vf_explained_var": 0.17281679075861733, "kl": 0.002577169926424763, "entropy": 1.2552105703051128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 387.1783439511699, "episode_reward_min": -27.6880461322536, "episode_reward_mean": 149.1605554981794, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.8917268020569, "predator_policy": 0.7719532918717956}, "policy_reward_max": {"prey_policy": 187.33804670812816, "predator_policy": 328.70799329078835}, "policy_reward_mean": {"prey_policy": 10.86606537488347, "predator_policy": 63.714212374206284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.15999999999968, 6.649999999999923, 320.5282916397473, 3.2099999999999755, 95.36024167410848, 7.659999999999924, 188.48555602988557, 330.53999999999974, 6.137031139143652, 38.475482468169375, 252.63999999999945, 175.87647130575317, -27.6880461322536, 47.595343971215996, 6.659999999999929, 36.239999999999476, 18.460000000000363, 185.70831513223203, 206.13999999999896, 127.42000000000074, 97.51000000000094, 105.35937668240824, 83.7000000000008, 160.2200000000003, 148.109785114118, 107.94327462835362, 3.499999999999967, 88.8500000000011, 201.8936906009405, 338.21252079434447, 162.45297362562053, 387.1783439511699, 160.1599999999995, 293.8042144171809, -0.9930001543956277, 137.82727590772953, -2.2443463947892646, 191.8599999999998, 164.16999999999967, 181.6499999999998, 184.94999999999982, 3.1199999999999783, 116.92045224373918, 300.11064974350415, 272.9618842835506, 178.77999999999966, 169.09891387940172, 2.7199999999999838, 113.83424497518591, 156.1000000000002, 259.34377986782283, 92.93633071482488, 127.5900000000003, 68.09000000000117, 356.87120467359904, 169.96894204794552, 154.44620649595288, 257.96216271155436, 148.58048217120694, 185.54999999999973, 138.29000000000025, 146.21000000000015, 19.95108192122377, 77.04770118047382, 307.1036075407643, 9.339044532069567, 157.03796937357043, 177.96999999999983, 100.26916678359161, 144.28000000000006, 158.80628348530126, 197.16180809717093, 171.54909135441955, 149.03999999999996, 247.02799892003677, 274.9918270541071, 174.14843964262616, 332.9479524929857, 296.5599999999998, 4.994926089943788, 183.78999999999974, 199.35290124778865, 169.9699999999999, 188.85999999999973, 114.07698359627335, 172.17999999999935, 264.6511954491439, 32.21884036908835, 104.97000000000044, 60.467142989159555, 145.99000000000012, 313.48999999999955, 158.96999999999946, 151.5447147730452, 190.9299999999997, 190.23628517879283, 19.285938885822205, 249.01000000000016, 189.3899999999996, 21.586598651573716], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.665135031052321, 125.42821959236083, -33.685016423158835, -19.54894161709344, 150.11043088061484, 16.65441069317032, -119.03305559839526, 0.976121457758378, -59.71556621481242, 60.35049838531454, -8.160213683723324, -19.10077954225797, 134.43235852698712, -71.96046790853, 152.41651016099206, 161.5242986306605, -0.7251551812413721, -11.61569164818811, -13.68869381234139, -1.8736312681227172, -31.386962501108087, 89.10090354756824, -5.703940306381462, 41.98893149196652, -148.69533614956137, -65.9101631835724, -122.24360677573806, -36.4442145887368, -16.4285174093983, -9.970471697788064, -47.19071021355348, -15.178738483963164, -18.40608440759826, -27.060598856082066, 116.65626522835747, 6.587829964501223, -41.856063422549575, 102.17779388030186, -7.915506065294583, 68.74948045976986, 50.206975853344794, -85.65698351732979, -15.605542798452664, 35.65999999999973, -5.309698257110204, 24.506097476302298, -10.836982015181741, 126.2502323638002, 72.20908575421177, -33.176979624670466, 27.666899275021457, -75.67952020530777, -19.925046377793887, -78.22060027961749, 85.26001831257766, -24.556890692487563, 143.3159596711683, 11.024830597933777, -392.8917268020569, 139.84099134848358, -283.17162183779493, -18.90400296843867, -329.42013874738996, 183.9518128519187, 135.0241626124353, -8.905689253148347, 154.86253948596655, -279.44546987404675, -79.6404842712515, -26.400540125003964, -7.892010524987832, -54.19445199055758, -30.133658869947276, -26.249488722234233, 173.35217071607548, -7.912454361900473, -10.743300426570066, 142.60186642742184, -109.03304486044722, 142.59270589736076, -4.076621017155114, 162.36672181409435, -31.287869863361536, -78.89533789411581, -217.32443148177805, -33.12824717771259, 145.30505671341615, 73.99641059557801, 39.55819658779507, 138.22084806986783, 155.56719201410857, -182.077871752481, -78.66115975845541, -8.068119663836177, -190.735737785919, -33.40841680436112, 2.0000000000000013, -79.26912495714011, 98.87199225883654, -8.95439813993553, 148.89891253117682, 64.90631969648386, -36.56805169710029, 44.39989790994826, -58.04610537852237, -42.5250737222257, 1.4331936533826948, 40.07807352876508, 138.1065610361385, 144.59539542090414, -33.86922131097964, 151.7714315992434, 2.0000000000000013, 79.13563323866488, 97.85636059954223, -223.20528029662762, -4.832780840545935, 27.06518137863718, -69.0260042800137, 172.03247086278088, -23.962122997158108, 102.86171269542102, 66.98737393161709, -2.7714627585635965, -92.20561994418986, -42.78421718821625, -42.298576783932916, 57.61131980946686, -298.77662454024323, 149.42110183782603, -66.45001039761287, -2.525726978349711, 96.38851556180742, 9.961403188483166, -9.304163932754877, 139.5098444202306, 33.33016299767283, -208.21142067784072, -11.843906800121987, 116.00839672907402, -3.855135607819496, 61.54978619418391, 17.16578537989338, 29.652546202275918, -38.74124991503664, 126.64146658560759, -6.934614200800807, 34.88917638828462, -211.33511957144677, 177.28071288750846, 96.17299123143701, 133.368158440765, 57.863294849517295, 20.81865100104722, 69.56828948325108, 83.62677304856334, 79.80234608404473, 156.86593120190545, -8.933934210961128, -6.841126112268812, -38.30202926294027, 144.1272723812507, 156.66777602633013, -68.52109519730914, -2.605311987101839, 127.81388017418452, 170.32313100287277, -18.170115278650407, 5.097551830533198, 49.13371868348368, 169.445949555873, -15.96582001496569, -59.98899301031415, 38.40990259389726, -0.5964121517813858, -126.33992084301916, -1.362049142303417, -1.8071561737151436, 1.0588252687732183, -114.05131470074346, 28.610039061758343, 0.597903605164216, 64.50189626035588, 172.52085084836716, -52.36991308702488, 151.0412480208027, 105.52793252761586, 0.9492328709947188, 182.2403562443535, -15.721909203334754, -61.346565835490296, -75.03598773726873, -29.137107025564905, -149.22491086693122, 69.61022650754298, 115.64214171362771, -136.2649562090008, 187.33804670812816, -24.492489826536907, -29.32826472525866], "policy_predator_policy_reward": [10.58513503105228, 25.811780407639265, 35.48501642315855, 24.39894161709373, 84.82023644757854, 68.94321361838361, 120.25305559839585, 1.0138785422416234, 38.50822411356299, 56.2170853900421, 26.88845195708511, 8.032541268896171, 62.78686606633458, 63.226799345093816, 14.70960335111763, 1.8895878572298594, 4.952186320385093, 13.525691648188069, 35.49829316101642, 18.539514387617587, 168.3869625011081, 26.539096452432084, 104.553544218892, 35.03793590127619, 176.36766096454446, 10.54979223633547, 103.59652801348571, 102.68663732220567, 18.588750231496228, 14.470238875690363, 13.418277182764838, 85.1911715147517, 35.01608440759851, 28.910598856082355, 36.12710450717765, 26.337115432196292, 141.08606342254953, 4.7322061196986045, 12.755506065294544, 53.83051954023028, 39.360889501879925, 93.59911816210582, 60.59960664242947, 24.70531283843018, 7.229698257110163, 57.27390252369782, 12.7569820151817, 32.04976763619991, 49.92058237930422, 59.15709660527199, 29.107176874987076, 126.8487186836533, 21.755046377794173, 79.89060027961834, 25.06232857864972, 3.084543801260782, 3.5192848497242055, 44.03361548211456, 262.5552629571295, 328.70799329078835, 235.42148526536582, 229.10711316648863, 278.26674962632063, 254.37992022032043, 29.174583490245926, 4.866943150466852, 197.53012652142078, 220.85701828384018, 41.78993147789838, 63.2580927639616, 101.36300391869766, 98.55073450457692, 30.029313997631046, 24.10948719976184, 15.454874279651515, 10.965409366173446, 12.643300426570026, 19.668133572578018, 110.68304486044806, 37.40729410263924, 3.211245158631572, 23.44865404442915, 42.40959058934201, 70.89361716813588, 212.46482533305723, 154.9083055701717, 54.206772320086415, 26.602410114423932, 18.387403410776997, 76.79543621511118, 25.946684985758143, 179.34399475261378, 161.85858575315672, 93.96960754853704, 191.6457377859182, 35.21841680436076, 145.57341549437578, 45.52995443795003, 55.30800774116342, 10.874398139935488, 29.37380248518176, 16.164745154981777, 63.28570202726623, 21.81878247470948, 59.63610537852224, 168.5250737222257, 11.835286796038629, 14.743446021813302, 43.080990497115614, 31.08825771944087, 5.705861668917471, 46.36087009076479, 52.416169831349826, 20.894403425938055, 180.51827949665838, 202.79280291198134, 25.290069571551474, 101.05801206156406, 70.54600428001437, 11.997529137219072, 41.724221903837595, 17.666188397899948, 77.26262606838291, 4.731462758563555, 78.0071331018077, 76.93378595182214, 59.93101597937725, 1.803942175561291, 176.53895571316744, 279.9201745300149, 11.74457555436362, 66.5702063536693, 22.22439772917183, 28.463652894108794, 11.234163932754836, 36.53015557976942, 0.7806298106013035, 274.36979465315835, 13.743906800121946, 26.3716032709261, 12.970105576678717, 88.1415273222581, 70.87304113223306, 79.47043538276914, 29.93473411665068, 53.71414056719769, 8.844614200800766, 112.2408236117154, 173.8039780255509, 107.27842757842392, 33.82437341343714, 11.626303968468026, 72.57718860137933, 22.889305190682528, 34.6847647942524, 145.0681251669189, 40.12277718005516, 19.768945533994778, 7.327119737436343, 13.442866675737365, 48.97202926293994, 28.992727618749317, 67.54937238741343, 43.65684803135543, 39.86212550292682, 4.8993063099904575, 16.676868997127226, 20.030115278650698, 34.98416535655214, 24.861547725703666, 0.8440504441267321, 17.85582001496598, 233.93502951715791, 52.295256348403015, 8.705252520869449, 150.44992084301973, 88.72587355063989, 19.413331765378746, 62.586680847210275, 110.87295157392091, 115.38996093824166, 1.3920963948357854, 66.21122951264374, 10.256023378633403, 53.979913087024556, 6.318751979197462, 21.91944898125854, 23.14810039317606, 6.78964375564649, 17.621909203335, 105.02970380721, 221.58913494434202, 91.63116086188892, 106.01679591642834, 50.58841773054715, 13.16921404828237, 137.54495620899988, 0.7719532918717956, 52.25362264373764, 23.15373055963164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8396006870985695, "mean_inference_ms": 2.7170842775389406, "mean_action_processing_ms": 0.36896543101139656, "mean_env_wait_ms": 0.3031455812910488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004602909088134766, "StateBufferConnector_ms": 0.003485560417175293, "ViewRequirementAgentConnector_ms": 0.13848698139190674}, "num_episodes": 18, "episode_return_max": 387.1783439511699, "episode_return_min": -27.6880461322536, "episode_return_mean": 149.1605554981794, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.28036173152725, "num_env_steps_trained_throughput_per_sec": 274.28036173152725, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 14915.539, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14915.467, "sample_time_ms": 2202.738, "learn_time_ms": 12690.031, "learn_throughput": 315.208, "synch_weights_time_ms": 20.876}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "6c58f_00000", "date": "2024-08-16_16-24-18", "timestamp": 1723805658, "time_this_iter_s": 14.634191036224365, "time_total_s": 1040.3327956199646, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05120d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1040.3327956199646, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 62.48571428571429, "ram_util_percent": 81.45238095238095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.212429900144143, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 3.800075604171349, "policy_loss": -0.005734579402475406, "vf_loss": 3.804353907120922, "vf_explained_var": 0.00885492657858228, "kl": 0.01022788045601461, "entropy": 1.4138276944084773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.099788411773702, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 5.039004242357123, "policy_loss": -0.005716304397629327, "vf_loss": 5.044717955967736, "vf_explained_var": 0.08698230499312991, "kl": 0.0066128455726258565, "entropy": 1.3320293685746571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 387.1783439511699, "episode_reward_min": -2.2443463947892646, "episode_reward_mean": 153.72642165410934, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.8917268020569, "predator_policy": 0.7719532918717956}, "policy_reward_max": {"prey_policy": 187.33804670812816, "predator_policy": 328.70799329078835}, "policy_reward_mean": {"prey_policy": 1.2195132054245987, "predator_policy": 75.64369762163011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.2200000000003, 148.109785114118, 107.94327462835362, 3.499999999999967, 88.8500000000011, 201.8936906009405, 338.21252079434447, 162.45297362562053, 387.1783439511699, 160.1599999999995, 293.8042144171809, -0.9930001543956277, 137.82727590772953, -2.2443463947892646, 191.8599999999998, 164.16999999999967, 181.6499999999998, 184.94999999999982, 3.1199999999999783, 116.92045224373918, 300.11064974350415, 272.9618842835506, 178.77999999999966, 169.09891387940172, 2.7199999999999838, 113.83424497518591, 156.1000000000002, 259.34377986782283, 92.93633071482488, 127.5900000000003, 68.09000000000117, 356.87120467359904, 169.96894204794552, 154.44620649595288, 257.96216271155436, 148.58048217120694, 185.54999999999973, 138.29000000000025, 146.21000000000015, 19.95108192122377, 77.04770118047382, 307.1036075407643, 9.339044532069567, 157.03796937357043, 177.96999999999983, 100.26916678359161, 144.28000000000006, 158.80628348530126, 197.16180809717093, 171.54909135441955, 149.03999999999996, 247.02799892003677, 274.9918270541071, 174.14843964262616, 332.9479524929857, 296.5599999999998, 4.994926089943788, 183.78999999999974, 199.35290124778865, 169.9699999999999, 188.85999999999973, 114.07698359627335, 172.17999999999935, 264.6511954491439, 32.21884036908835, 104.97000000000044, 60.467142989159555, 145.99000000000012, 313.48999999999955, 158.96999999999946, 151.5447147730452, 190.9299999999997, 190.23628517879283, 19.285938885822205, 249.01000000000016, 189.3899999999996, 21.586598651573716, 164.98003140500967, 228.0486729727046, 201.9898683025084, 147.612229158142, 131.4478586041556, 118.01000000000035, 85.35000000000034, 3.7799999999999643, 193.62933818197973, 27.198727560507045, 3.4499999999999686, 143.1500000000003, 3.5899999999999697, 3.8399999999999626, 327.00727388723396, 3.649999999999965, 213.8947187138637, 258.31454039034986, 0.13538134161958365, 115.38536975678421, 146.3934875538963, 225.617700847576, 175.93948082707192], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.836982015181741, 126.2502323638002, 72.20908575421177, -33.176979624670466, 27.666899275021457, -75.67952020530777, -19.925046377793887, -78.22060027961749, 85.26001831257766, -24.556890692487563, 143.3159596711683, 11.024830597933777, -392.8917268020569, 139.84099134848358, -283.17162183779493, -18.90400296843867, -329.42013874738996, 183.9518128519187, 135.0241626124353, -8.905689253148347, 154.86253948596655, -279.44546987404675, -79.6404842712515, -26.400540125003964, -7.892010524987832, -54.19445199055758, -30.133658869947276, -26.249488722234233, 173.35217071607548, -7.912454361900473, -10.743300426570066, 142.60186642742184, -109.03304486044722, 142.59270589736076, -4.076621017155114, 162.36672181409435, -31.287869863361536, -78.89533789411581, -217.32443148177805, -33.12824717771259, 145.30505671341615, 73.99641059557801, 39.55819658779507, 138.22084806986783, 155.56719201410857, -182.077871752481, -78.66115975845541, -8.068119663836177, -190.735737785919, -33.40841680436112, 2.0000000000000013, -79.26912495714011, 98.87199225883654, -8.95439813993553, 148.89891253117682, 64.90631969648386, -36.56805169710029, 44.39989790994826, -58.04610537852237, -42.5250737222257, 1.4331936533826948, 40.07807352876508, 138.1065610361385, 144.59539542090414, -33.86922131097964, 151.7714315992434, 2.0000000000000013, 79.13563323866488, 97.85636059954223, -223.20528029662762, -4.832780840545935, 27.06518137863718, -69.0260042800137, 172.03247086278088, -23.962122997158108, 102.86171269542102, 66.98737393161709, -2.7714627585635965, -92.20561994418986, -42.78421718821625, -42.298576783932916, 57.61131980946686, -298.77662454024323, 149.42110183782603, -66.45001039761287, -2.525726978349711, 96.38851556180742, 9.961403188483166, -9.304163932754877, 139.5098444202306, 33.33016299767283, -208.21142067784072, -11.843906800121987, 116.00839672907402, -3.855135607819496, 61.54978619418391, 17.16578537989338, 29.652546202275918, -38.74124991503664, 126.64146658560759, -6.934614200800807, 34.88917638828462, -211.33511957144677, 177.28071288750846, 96.17299123143701, 133.368158440765, 57.863294849517295, 20.81865100104722, 69.56828948325108, 83.62677304856334, 79.80234608404473, 156.86593120190545, -8.933934210961128, -6.841126112268812, -38.30202926294027, 144.1272723812507, 156.66777602633013, -68.52109519730914, -2.605311987101839, 127.81388017418452, 170.32313100287277, -18.170115278650407, 5.097551830533198, 49.13371868348368, 169.445949555873, -15.96582001496569, -59.98899301031415, 38.40990259389726, -0.5964121517813858, -126.33992084301916, -1.362049142303417, -1.8071561737151436, 1.0588252687732183, -114.05131470074346, 28.610039061758343, 0.597903605164216, 64.50189626035588, 172.52085084836716, -52.36991308702488, 151.0412480208027, 105.52793252761586, 0.9492328709947188, 182.2403562443535, -15.721909203334754, -61.346565835490296, -75.03598773726873, -29.137107025564905, -149.22491086693122, 69.61022650754298, 115.64214171362771, -136.2649562090008, 187.33804670812816, -24.492489826536907, -29.32826472525866, 22.74838011669378, 0.5785766618688335, -133.97503787319792, 110.55374570622426, -10.643191964618051, -258.6925245415193, -49.685959273701364, 61.93762996734443, -34.041498994322524, -21.040526054859043, -22.18025681091665, 5.22523304426571, 0.967857176078475, -94.5856992421593, -22.337670083207882, -3.6491698916222894, -238.90331062749397, 54.52510389197114, -137.6529345675429, -25.348690773472, -147.6545928380255, -17.744315782865655, -49.1629795950232, 86.54195592992674, -106.28663471660414, -18.95319170860232, -17.421090115012, 0.1360323640243301, -133.24943186676413, 148.92602537666804, 1.2178623835369058, -73.68158977191878, -51.46220604728592, -15.197050656956147, -74.38207287266334, 64.54352351379465, -108.4198918757519, -5.1205300629284, -201.10831833125565, -53.80517019479954, 80.07174058040451, -32.19934976758987, 27.528130787316353, 13.454959185280845, -32.09455533750875, -148.7961086701499], "policy_predator_policy_reward": [12.7569820151817, 32.04976763619991, 49.92058237930422, 59.15709660527199, 29.107176874987076, 126.8487186836533, 21.755046377794173, 79.89060027961834, 25.06232857864972, 3.084543801260782, 3.5192848497242055, 44.03361548211456, 262.5552629571295, 328.70799329078835, 235.42148526536582, 229.10711316648863, 278.26674962632063, 254.37992022032043, 29.174583490245926, 4.866943150466852, 197.53012652142078, 220.85701828384018, 41.78993147789838, 63.2580927639616, 101.36300391869766, 98.55073450457692, 30.029313997631046, 24.10948719976184, 15.454874279651515, 10.965409366173446, 12.643300426570026, 19.668133572578018, 110.68304486044806, 37.40729410263924, 3.211245158631572, 23.44865404442915, 42.40959058934201, 70.89361716813588, 212.46482533305723, 154.9083055701717, 54.206772320086415, 26.602410114423932, 18.387403410776997, 76.79543621511118, 25.946684985758143, 179.34399475261378, 161.85858575315672, 93.96960754853704, 191.6457377859182, 35.21841680436076, 145.57341549437578, 45.52995443795003, 55.30800774116342, 10.874398139935488, 29.37380248518176, 16.164745154981777, 63.28570202726623, 21.81878247470948, 59.63610537852224, 168.5250737222257, 11.835286796038629, 14.743446021813302, 43.080990497115614, 31.08825771944087, 5.705861668917471, 46.36087009076479, 52.416169831349826, 20.894403425938055, 180.51827949665838, 202.79280291198134, 25.290069571551474, 101.05801206156406, 70.54600428001437, 11.997529137219072, 41.724221903837595, 17.666188397899948, 77.26262606838291, 4.731462758563555, 78.0071331018077, 76.93378595182214, 59.93101597937725, 1.803942175561291, 176.53895571316744, 279.9201745300149, 11.74457555436362, 66.5702063536693, 22.22439772917183, 28.463652894108794, 11.234163932754836, 36.53015557976942, 0.7806298106013035, 274.36979465315835, 13.743906800121946, 26.3716032709261, 12.970105576678717, 88.1415273222581, 70.87304113223306, 79.47043538276914, 29.93473411665068, 53.71414056719769, 8.844614200800766, 112.2408236117154, 173.8039780255509, 107.27842757842392, 33.82437341343714, 11.626303968468026, 72.57718860137933, 22.889305190682528, 34.6847647942524, 145.0681251669189, 40.12277718005516, 19.768945533994778, 7.327119737436343, 13.442866675737365, 48.97202926293994, 28.992727618749317, 67.54937238741343, 43.65684803135543, 39.86212550292682, 4.8993063099904575, 16.676868997127226, 20.030115278650698, 34.98416535655214, 24.861547725703666, 0.8440504441267321, 17.85582001496598, 233.93502951715791, 52.295256348403015, 8.705252520869449, 150.44992084301973, 88.72587355063989, 19.413331765378746, 62.586680847210275, 110.87295157392091, 115.38996093824166, 1.3920963948357854, 66.21122951264374, 10.256023378633403, 53.979913087024556, 6.318751979197462, 21.91944898125854, 23.14810039317606, 6.78964375564649, 17.621909203335, 105.02970380721, 221.58913494434202, 91.63116086188892, 106.01679591642834, 50.58841773054715, 13.16921404828237, 137.54495620899988, 0.7719532918717956, 52.25362264373764, 23.15373055963164, 130.39931242714502, 11.25376219930197, 138.23476200619442, 113.23520313348475, 181.16312442264166, 290.1624603860048, 74.92498677471094, 60.43557168978738, 38.379357598477455, 148.15052605485909, 79.07035003453808, 55.89467373211315, 80.5719099683259, 98.3959320977551, 24.16767008320817, 5.599169891622248, 213.17376559246668, 164.83377932503623, 44.763484238721155, 145.43686866280012, 149.2145928380241, 19.63431578286595, 84.05685976427819, 21.714163900817894, 108.01663471660503, 20.81319170860261, 19.28109011501229, 1.8439676359756714, 147.8009707974575, 163.52970957987273, 0.7721376164630955, 75.34158977191962, 153.38693305723925, 127.16704236086684, 16.231778914995733, 251.92131083422288, 111.66549809491667, 2.010305185383984, 211.61455437430587, 158.68430390853257, 33.667980748721824, 64.85311599235939, 77.28687394634387, 107.34773692863544, 149.17092397166925, 207.65922086306145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.841310771279141, "mean_inference_ms": 2.723531570104592, "mean_action_processing_ms": 0.36950781131344906, "mean_env_wait_ms": 0.3033005614606661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007037043571472168, "StateBufferConnector_ms": 0.00393223762512207, "ViewRequirementAgentConnector_ms": 0.15772879123687744}, "num_episodes": 23, "episode_return_max": 387.1783439511699, "episode_return_min": -2.2443463947892646, "episode_return_mean": 153.72642165410934, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.479135396156, "num_env_steps_trained_throughput_per_sec": 260.479135396156, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 15004.449, "restore_workers_time_ms": 0.014, "training_step_time_ms": 15004.373, "sample_time_ms": 2319.724, "learn_time_ms": 12661.116, "learn_throughput": 315.928, "synch_weights_time_ms": 21.613}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "6c58f_00000", "date": "2024-08-16_16-24-33", "timestamp": 1723805673, "time_this_iter_s": 15.416478872299194, "time_total_s": 1055.7492744922638, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33e74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1055.7492744922638, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 62.92857142857143, "ram_util_percent": 81.13809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4514827253641907, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.867208155879268, "policy_loss": -0.007993915449413988, "vf_loss": 5.87341420562179, "vf_explained_var": 0.0039316579147621435, "kl": 0.012556813473177213, "entropy": 1.3973980899841065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2921025893990956, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 5.916080153177655, "policy_loss": -0.00433423593122926, "vf_loss": 5.920411611990954, "vf_explained_var": -0.056774267317756776, "kl": 0.007155826840378361, "entropy": 1.3338807077634902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 356.87120467359904, "episode_reward_min": -16.495269064686276, "episode_reward_mean": 141.22722402144723, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.77662454024323, "predator_policy": 0.7719532918717956}, "policy_reward_max": {"prey_policy": 187.33804670812816, "predator_policy": 290.1624603860048}, "policy_reward_mean": {"prey_policy": -7.615046755600434, "predator_policy": 78.22865876632407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.1199999999999783, 116.92045224373918, 300.11064974350415, 272.9618842835506, 178.77999999999966, 169.09891387940172, 2.7199999999999838, 113.83424497518591, 156.1000000000002, 259.34377986782283, 92.93633071482488, 127.5900000000003, 68.09000000000117, 356.87120467359904, 169.96894204794552, 154.44620649595288, 257.96216271155436, 148.58048217120694, 185.54999999999973, 138.29000000000025, 146.21000000000015, 19.95108192122377, 77.04770118047382, 307.1036075407643, 9.339044532069567, 157.03796937357043, 177.96999999999983, 100.26916678359161, 144.28000000000006, 158.80628348530126, 197.16180809717093, 171.54909135441955, 149.03999999999996, 247.02799892003677, 274.9918270541071, 174.14843964262616, 332.9479524929857, 296.5599999999998, 4.994926089943788, 183.78999999999974, 199.35290124778865, 169.9699999999999, 188.85999999999973, 114.07698359627335, 172.17999999999935, 264.6511954491439, 32.21884036908835, 104.97000000000044, 60.467142989159555, 145.99000000000012, 313.48999999999955, 158.96999999999946, 151.5447147730452, 190.9299999999997, 190.23628517879283, 19.285938885822205, 249.01000000000016, 189.3899999999996, 21.586598651573716, 164.98003140500967, 228.0486729727046, 201.9898683025084, 147.612229158142, 131.4478586041556, 118.01000000000035, 85.35000000000034, 3.7799999999999643, 193.62933818197973, 27.198727560507045, 3.4499999999999686, 143.1500000000003, 3.5899999999999697, 3.8399999999999626, 327.00727388723396, 3.649999999999965, 213.8947187138637, 258.31454039034986, 0.13538134161958365, 115.38536975678421, 146.3934875538963, 225.617700847576, 175.93948082707192, 122.80849529997067, 149.61999999999983, 234.3302973531127, 117.0662003232958, 123.33803141724646, 3.7599999999999643, 47.16999999999982, 68.606585600918, 53.451928035443885, 74.2061670713111, -4.165208623989692, -16.495269064686276, 134.74522763956105, -5.92426534812885, 11.370494852557037, 107.83552692536307, 221.97767358294206, 215.92308415914167], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.287869863361536, -78.89533789411581, -217.32443148177805, -33.12824717771259, 145.30505671341615, 73.99641059557801, 39.55819658779507, 138.22084806986783, 155.56719201410857, -182.077871752481, -78.66115975845541, -8.068119663836177, -190.735737785919, -33.40841680436112, 2.0000000000000013, -79.26912495714011, 98.87199225883654, -8.95439813993553, 148.89891253117682, 64.90631969648386, -36.56805169710029, 44.39989790994826, -58.04610537852237, -42.5250737222257, 1.4331936533826948, 40.07807352876508, 138.1065610361385, 144.59539542090414, -33.86922131097964, 151.7714315992434, 2.0000000000000013, 79.13563323866488, 97.85636059954223, -223.20528029662762, -4.832780840545935, 27.06518137863718, -69.0260042800137, 172.03247086278088, -23.962122997158108, 102.86171269542102, 66.98737393161709, -2.7714627585635965, -92.20561994418986, -42.78421718821625, -42.298576783932916, 57.61131980946686, -298.77662454024323, 149.42110183782603, -66.45001039761287, -2.525726978349711, 96.38851556180742, 9.961403188483166, -9.304163932754877, 139.5098444202306, 33.33016299767283, -208.21142067784072, -11.843906800121987, 116.00839672907402, -3.855135607819496, 61.54978619418391, 17.16578537989338, 29.652546202275918, -38.74124991503664, 126.64146658560759, -6.934614200800807, 34.88917638828462, -211.33511957144677, 177.28071288750846, 96.17299123143701, 133.368158440765, 57.863294849517295, 20.81865100104722, 69.56828948325108, 83.62677304856334, 79.80234608404473, 156.86593120190545, -8.933934210961128, -6.841126112268812, -38.30202926294027, 144.1272723812507, 156.66777602633013, -68.52109519730914, -2.605311987101839, 127.81388017418452, 170.32313100287277, -18.170115278650407, 5.097551830533198, 49.13371868348368, 169.445949555873, -15.96582001496569, -59.98899301031415, 38.40990259389726, -0.5964121517813858, -126.33992084301916, -1.362049142303417, -1.8071561737151436, 1.0588252687732183, -114.05131470074346, 28.610039061758343, 0.597903605164216, 64.50189626035588, 172.52085084836716, -52.36991308702488, 151.0412480208027, 105.52793252761586, 0.9492328709947188, 182.2403562443535, -15.721909203334754, -61.346565835490296, -75.03598773726873, -29.137107025564905, -149.22491086693122, 69.61022650754298, 115.64214171362771, -136.2649562090008, 187.33804670812816, -24.492489826536907, -29.32826472525866, 22.74838011669378, 0.5785766618688335, -133.97503787319792, 110.55374570622426, -10.643191964618051, -258.6925245415193, -49.685959273701364, 61.93762996734443, -34.041498994322524, -21.040526054859043, -22.18025681091665, 5.22523304426571, 0.967857176078475, -94.5856992421593, -22.337670083207882, -3.6491698916222894, -238.90331062749397, 54.52510389197114, -137.6529345675429, -25.348690773472, -147.6545928380255, -17.744315782865655, -49.1629795950232, 86.54195592992674, -106.28663471660414, -18.95319170860232, -17.421090115012, 0.1360323640243301, -133.24943186676413, 148.92602537666804, 1.2178623835369058, -73.68158977191878, -51.46220604728592, -15.197050656956147, -74.38207287266334, 64.54352351379465, -108.4198918757519, -5.1205300629284, -201.10831833125565, -53.80517019479954, 80.07174058040451, -32.19934976758987, 27.528130787316353, 13.454959185280845, -32.09455533750875, -148.7961086701499, -111.18816856474162, -13.201069026957533, 115.479074513498, -109.51176730702906, -124.59181886880694, -9.040917330509982, -135.98729725310986, -68.76120452000538, 10.766488105238878, 10.91, -12.215766581899356, -9.057125840763172, -43.925039493046874, 0.5785819839573588, -278.32882649190094, -83.67253605982003, -140.16324056563113, -33.95737646585401, -164.30022655409627, -54.30066423466385, -11.951075690141503, -25.755268119590905, -112.88615588646044, -152.80168775091997, -24.62138356085928, -93.14872252601896, -68.12718048263994, -60.14071506973111, -20.160039586223828, -15.7875914500271, -70.12372065559964, -10.330378135329607, -191.28049011195492, 73.89311186169833, -14.293431676174032, 73.9809104715882], "policy_predator_policy_reward": [42.40959058934201, 70.89361716813588, 212.46482533305723, 154.9083055701717, 54.206772320086415, 26.602410114423932, 18.387403410776997, 76.79543621511118, 25.946684985758143, 179.34399475261378, 161.85858575315672, 93.96960754853704, 191.6457377859182, 35.21841680436076, 145.57341549437578, 45.52995443795003, 55.30800774116342, 10.874398139935488, 29.37380248518176, 16.164745154981777, 63.28570202726623, 21.81878247470948, 59.63610537852224, 168.5250737222257, 11.835286796038629, 14.743446021813302, 43.080990497115614, 31.08825771944087, 5.705861668917471, 46.36087009076479, 52.416169831349826, 20.894403425938055, 180.51827949665838, 202.79280291198134, 25.290069571551474, 101.05801206156406, 70.54600428001437, 11.997529137219072, 41.724221903837595, 17.666188397899948, 77.26262606838291, 4.731462758563555, 78.0071331018077, 76.93378595182214, 59.93101597937725, 1.803942175561291, 176.53895571316744, 279.9201745300149, 11.74457555436362, 66.5702063536693, 22.22439772917183, 28.463652894108794, 11.234163932754836, 36.53015557976942, 0.7806298106013035, 274.36979465315835, 13.743906800121946, 26.3716032709261, 12.970105576678717, 88.1415273222581, 70.87304113223306, 79.47043538276914, 29.93473411665068, 53.71414056719769, 8.844614200800766, 112.2408236117154, 173.8039780255509, 107.27842757842392, 33.82437341343714, 11.626303968468026, 72.57718860137933, 22.889305190682528, 34.6847647942524, 145.0681251669189, 40.12277718005516, 19.768945533994778, 7.327119737436343, 13.442866675737365, 48.97202926293994, 28.992727618749317, 67.54937238741343, 43.65684803135543, 39.86212550292682, 4.8993063099904575, 16.676868997127226, 20.030115278650698, 34.98416535655214, 24.861547725703666, 0.8440504441267321, 17.85582001496598, 233.93502951715791, 52.295256348403015, 8.705252520869449, 150.44992084301973, 88.72587355063989, 19.413331765378746, 62.586680847210275, 110.87295157392091, 115.38996093824166, 1.3920963948357854, 66.21122951264374, 10.256023378633403, 53.979913087024556, 6.318751979197462, 21.91944898125854, 23.14810039317606, 6.78964375564649, 17.621909203335, 105.02970380721, 221.58913494434202, 91.63116086188892, 106.01679591642834, 50.58841773054715, 13.16921404828237, 137.54495620899988, 0.7719532918717956, 52.25362264373764, 23.15373055963164, 130.39931242714502, 11.25376219930197, 138.23476200619442, 113.23520313348475, 181.16312442264166, 290.1624603860048, 74.92498677471094, 60.43557168978738, 38.379357598477455, 148.15052605485909, 79.07035003453808, 55.89467373211315, 80.5719099683259, 98.3959320977551, 24.16767008320817, 5.599169891622248, 213.17376559246668, 164.83377932503623, 44.763484238721155, 145.43686866280012, 149.2145928380241, 19.63431578286595, 84.05685976427819, 21.714163900817894, 108.01663471660503, 20.81319170860261, 19.28109011501229, 1.8439676359756714, 147.8009707974575, 163.52970957987273, 0.7721376164630955, 75.34158977191962, 153.38693305723925, 127.16704236086684, 16.231778914995733, 251.92131083422288, 111.66549809491667, 2.010305185383984, 211.61455437430587, 158.68430390853257, 33.667980748721824, 64.85311599235939, 77.28687394634387, 107.34773692863544, 149.17092397166925, 207.65922086306145, 193.64399920346816, 53.55373368820171, 3.492267747556052, 140.16042504597573, 186.9865930159354, 180.9764405364944, 131.2430408429786, 190.57166125343244, 95.18793014149833, 6.473613170508866, 14.085766581899316, 10.947125840763132, 89.10503949304693, 1.4114180160426426, 260.4579413970839, 170.15000675555575, 164.17531102976372, 63.3972340371644, 147.74564023353662, 145.06141762653502, 27.625268119591198, 5.915867066151851, 86.37541326748394, 162.81716130520942, 143.5701827109986, 108.94515101544134, 30.036454079201267, 92.30717612504154, 18.846117484372385, 28.472008404436203, 48.15576097413166, 140.13386474216006, 170.15765362066526, 169.20739821253323, 37.99704061945068, 118.23856474427737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8422087752148195, "mean_inference_ms": 2.72723895217307, "mean_action_processing_ms": 0.36966743053295986, "mean_env_wait_ms": 0.3035261566759813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007548332214355469, "StateBufferConnector_ms": 0.003962159156799316, "ViewRequirementAgentConnector_ms": 0.16515874862670898}, "num_episodes": 18, "episode_return_max": 356.87120467359904, "episode_return_min": -16.495269064686276, "episode_return_mean": 141.22722402144723, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.6339528291663, "num_env_steps_trained_throughput_per_sec": 265.6339528291663, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 15063.714, "restore_workers_time_ms": 0.015, "training_step_time_ms": 15063.638, "sample_time_ms": 2346.945, "learn_time_ms": 12693.627, "learn_throughput": 315.119, "synch_weights_time_ms": 21.059}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "6c58f_00000", "date": "2024-08-16_16-24-49", "timestamp": 1723805689, "time_this_iter_s": 15.105650901794434, "time_total_s": 1070.8549253940582, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1070.8549253940582, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 65.21363636363637, "ram_util_percent": 81.82272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7171144697874312, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.937091348789356, "policy_loss": -0.007682736117944673, "vf_loss": 5.943125813852542, "vf_explained_var": 0.002968309890656244, "kl": 0.011576220660365108, "entropy": 1.3729743443468891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7894343882326096, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 4.858551154313264, "policy_loss": -0.010378003902068096, "vf_loss": 4.868924232008596, "vf_explained_var": -0.04294427992805602, "kl": 0.012608137780684155, "entropy": 1.4039680923103655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 332.9479524929857, "episode_reward_min": -130.11255559463768, "episode_reward_mean": 125.2049457322468, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.4650713281199, "predator_policy": 0.7719532918717956}, "policy_reward_max": {"prey_policy": 187.33804670812816, "predator_policy": 442.2949527842518}, "policy_reward_mean": {"prey_policy": -29.050257840555997, "predator_policy": 91.65273070667939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.54999999999973, 138.29000000000025, 146.21000000000015, 19.95108192122377, 77.04770118047382, 307.1036075407643, 9.339044532069567, 157.03796937357043, 177.96999999999983, 100.26916678359161, 144.28000000000006, 158.80628348530126, 197.16180809717093, 171.54909135441955, 149.03999999999996, 247.02799892003677, 274.9918270541071, 174.14843964262616, 332.9479524929857, 296.5599999999998, 4.994926089943788, 183.78999999999974, 199.35290124778865, 169.9699999999999, 188.85999999999973, 114.07698359627335, 172.17999999999935, 264.6511954491439, 32.21884036908835, 104.97000000000044, 60.467142989159555, 145.99000000000012, 313.48999999999955, 158.96999999999946, 151.5447147730452, 190.9299999999997, 190.23628517879283, 19.285938885822205, 249.01000000000016, 189.3899999999996, 21.586598651573716, 164.98003140500967, 228.0486729727046, 201.9898683025084, 147.612229158142, 131.4478586041556, 118.01000000000035, 85.35000000000034, 3.7799999999999643, 193.62933818197973, 27.198727560507045, 3.4499999999999686, 143.1500000000003, 3.5899999999999697, 3.8399999999999626, 327.00727388723396, 3.649999999999965, 213.8947187138637, 258.31454039034986, 0.13538134161958365, 115.38536975678421, 146.3934875538963, 225.617700847576, 175.93948082707192, 122.80849529997067, 149.61999999999983, 234.3302973531127, 117.0662003232958, 123.33803141724646, 3.7599999999999643, 47.16999999999982, 68.606585600918, 53.451928035443885, 74.2061670713111, -4.165208623989692, -16.495269064686276, 134.74522763956105, -5.92426534812885, 11.370494852557037, 107.83552692536307, 221.97767358294206, 215.92308415914167, 120.92746778979932, -27.96221324451893, 111.53462383671483, 178.4614127840439, 141.68000000000023, 175.3710227378612, -130.11255559463768, 8.276027313402142, 79.9288288543382, 92.94579881117713, 92.26166019677797, 18.47321400287424, 12.129417217941384, -3.851438742868453, 100.93135016714884, 71.51357243964053, 153.1273196044931, 151.57191671405934], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-69.0260042800137, 172.03247086278088, -23.962122997158108, 102.86171269542102, 66.98737393161709, -2.7714627585635965, -92.20561994418986, -42.78421718821625, -42.298576783932916, 57.61131980946686, -298.77662454024323, 149.42110183782603, -66.45001039761287, -2.525726978349711, 96.38851556180742, 9.961403188483166, -9.304163932754877, 139.5098444202306, 33.33016299767283, -208.21142067784072, -11.843906800121987, 116.00839672907402, -3.855135607819496, 61.54978619418391, 17.16578537989338, 29.652546202275918, -38.74124991503664, 126.64146658560759, -6.934614200800807, 34.88917638828462, -211.33511957144677, 177.28071288750846, 96.17299123143701, 133.368158440765, 57.863294849517295, 20.81865100104722, 69.56828948325108, 83.62677304856334, 79.80234608404473, 156.86593120190545, -8.933934210961128, -6.841126112268812, -38.30202926294027, 144.1272723812507, 156.66777602633013, -68.52109519730914, -2.605311987101839, 127.81388017418452, 170.32313100287277, -18.170115278650407, 5.097551830533198, 49.13371868348368, 169.445949555873, -15.96582001496569, -59.98899301031415, 38.40990259389726, -0.5964121517813858, -126.33992084301916, -1.362049142303417, -1.8071561737151436, 1.0588252687732183, -114.05131470074346, 28.610039061758343, 0.597903605164216, 64.50189626035588, 172.52085084836716, -52.36991308702488, 151.0412480208027, 105.52793252761586, 0.9492328709947188, 182.2403562443535, -15.721909203334754, -61.346565835490296, -75.03598773726873, -29.137107025564905, -149.22491086693122, 69.61022650754298, 115.64214171362771, -136.2649562090008, 187.33804670812816, -24.492489826536907, -29.32826472525866, 22.74838011669378, 0.5785766618688335, -133.97503787319792, 110.55374570622426, -10.643191964618051, -258.6925245415193, -49.685959273701364, 61.93762996734443, -34.041498994322524, -21.040526054859043, -22.18025681091665, 5.22523304426571, 0.967857176078475, -94.5856992421593, -22.337670083207882, -3.6491698916222894, -238.90331062749397, 54.52510389197114, -137.6529345675429, -25.348690773472, -147.6545928380255, -17.744315782865655, -49.1629795950232, 86.54195592992674, -106.28663471660414, -18.95319170860232, -17.421090115012, 0.1360323640243301, -133.24943186676413, 148.92602537666804, 1.2178623835369058, -73.68158977191878, -51.46220604728592, -15.197050656956147, -74.38207287266334, 64.54352351379465, -108.4198918757519, -5.1205300629284, -201.10831833125565, -53.80517019479954, 80.07174058040451, -32.19934976758987, 27.528130787316353, 13.454959185280845, -32.09455533750875, -148.7961086701499, -111.18816856474162, -13.201069026957533, 115.479074513498, -109.51176730702906, -124.59181886880694, -9.040917330509982, -135.98729725310986, -68.76120452000538, 10.766488105238878, 10.91, -12.215766581899356, -9.057125840763172, -43.925039493046874, 0.5785819839573588, -278.32882649190094, -83.67253605982003, -140.16324056563113, -33.95737646585401, -164.30022655409627, -54.30066423466385, -11.951075690141503, -25.755268119590905, -112.88615588646044, -152.80168775091997, -24.62138356085928, -93.14872252601896, -68.12718048263994, -60.14071506973111, -20.160039586223828, -15.7875914500271, -70.12372065559964, -10.330378135329607, -191.28049011195492, 73.89311186169833, -14.293431676174032, 73.9809104715882, 1.0625734177157187, 0.7652083464225399, -128.55237910126152, -209.70873163043558, -224.5790881658026, -106.03040406855418, 107.71986503786208, -25.246753035559582, -7.798485844547622, -78.27265163242988, -221.96065547642255, -64.87234759421573, -440.4650713281199, -208.8583098182036, -89.7321233419013, -122.64749657078121, -49.82150703966889, -137.30149300802967, -214.39484815438584, -90.20620344276938, -12.293039708649173, -196.4586298826639, -226.86897216971147, -68.77335349751864, -105.3987438938845, -278.25207565939644, -68.79382768953123, -130.64690418501394, -9.812581849540654, -155.02204174525596, -113.5681723881705, -37.11750693329039, 2.270886987493501, -228.57741200178808, 2.0000000000000013, -95.91951161571103], "policy_predator_policy_reward": [70.54600428001437, 11.997529137219072, 41.724221903837595, 17.666188397899948, 77.26262606838291, 4.731462758563555, 78.0071331018077, 76.93378595182214, 59.93101597937725, 1.803942175561291, 176.53895571316744, 279.9201745300149, 11.74457555436362, 66.5702063536693, 22.22439772917183, 28.463652894108794, 11.234163932754836, 36.53015557976942, 0.7806298106013035, 274.36979465315835, 13.743906800121946, 26.3716032709261, 12.970105576678717, 88.1415273222581, 70.87304113223306, 79.47043538276914, 29.93473411665068, 53.71414056719769, 8.844614200800766, 112.2408236117154, 173.8039780255509, 107.27842757842392, 33.82437341343714, 11.626303968468026, 72.57718860137933, 22.889305190682528, 34.6847647942524, 145.0681251669189, 40.12277718005516, 19.768945533994778, 7.327119737436343, 13.442866675737365, 48.97202926293994, 28.992727618749317, 67.54937238741343, 43.65684803135543, 39.86212550292682, 4.8993063099904575, 16.676868997127226, 20.030115278650698, 34.98416535655214, 24.861547725703666, 0.8440504441267321, 17.85582001496598, 233.93502951715791, 52.295256348403015, 8.705252520869449, 150.44992084301973, 88.72587355063989, 19.413331765378746, 62.586680847210275, 110.87295157392091, 115.38996093824166, 1.3920963948357854, 66.21122951264374, 10.256023378633403, 53.979913087024556, 6.318751979197462, 21.91944898125854, 23.14810039317606, 6.78964375564649, 17.621909203335, 105.02970380721, 221.58913494434202, 91.63116086188892, 106.01679591642834, 50.58841773054715, 13.16921404828237, 137.54495620899988, 0.7719532918717956, 52.25362264373764, 23.15373055963164, 130.39931242714502, 11.25376219930197, 138.23476200619442, 113.23520313348475, 181.16312442264166, 290.1624603860048, 74.92498677471094, 60.43557168978738, 38.379357598477455, 148.15052605485909, 79.07035003453808, 55.89467373211315, 80.5719099683259, 98.3959320977551, 24.16767008320817, 5.599169891622248, 213.17376559246668, 164.83377932503623, 44.763484238721155, 145.43686866280012, 149.2145928380241, 19.63431578286595, 84.05685976427819, 21.714163900817894, 108.01663471660503, 20.81319170860261, 19.28109011501229, 1.8439676359756714, 147.8009707974575, 163.52970957987273, 0.7721376164630955, 75.34158977191962, 153.38693305723925, 127.16704236086684, 16.231778914995733, 251.92131083422288, 111.66549809491667, 2.010305185383984, 211.61455437430587, 158.68430390853257, 33.667980748721824, 64.85311599235939, 77.28687394634387, 107.34773692863544, 149.17092397166925, 207.65922086306145, 193.64399920346816, 53.55373368820171, 3.492267747556052, 140.16042504597573, 186.9865930159354, 180.9764405364944, 131.2430408429786, 190.57166125343244, 95.18793014149833, 6.473613170508866, 14.085766581899316, 10.947125840763132, 89.10503949304693, 1.4114180160426426, 260.4579413970839, 170.15000675555575, 164.17531102976372, 63.3972340371644, 147.74564023353662, 145.06141762653502, 27.625268119591198, 5.915867066151851, 86.37541326748394, 162.81716130520942, 143.5701827109986, 108.94515101544134, 30.036454079201267, 92.30717612504154, 18.846117484372385, 28.472008404436203, 48.15576097413166, 140.13386474216006, 170.15765362066526, 169.20739821253323, 37.99704061945068, 118.23856474427737, 64.31311682559519, 54.786569200065394, 246.9147255884029, 63.384171898773594, 261.1736497421907, 180.97046632887935, 56.69527220419334, 39.293028577548576, 1.42134477160639, 226.3297927053721, 285.463189244092, 176.74083656440854, 76.91587276743368, 442.2949527842518, 78.35415464500142, 142.3014925810843, 111.3341216144141, 155.7177072876202, 190.5908176834741, 206.95603272485846, 133.6046432358089, 167.40868655228164, 223.11218617258425, 91.00335349751917, 284.63630539066145, 111.14393138056087, 21.380512686597637, 174.2087804450786, 17.605916944984717, 248.16005681696046, 144.1047484122158, 78.09450334888541, 214.0210463687843, 165.41279825000308, 77.43523833101501, 168.05618999875546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8426128437073345, "mean_inference_ms": 2.7288591104293523, "mean_action_processing_ms": 0.3695484053003277, "mean_env_wait_ms": 0.3035008478301942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008305191993713379, "StateBufferConnector_ms": 0.00388491153717041, "ViewRequirementAgentConnector_ms": 0.17003905773162842}, "num_episodes": 18, "episode_return_max": 332.9479524929857, "episode_return_min": -130.11255559463768, "episode_return_mean": 125.2049457322468, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.14511812961825, "num_env_steps_trained_throughput_per_sec": 281.14511812961825, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 14942.512, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14942.433, "sample_time_ms": 2252.31, "learn_time_ms": 12666.265, "learn_throughput": 315.799, "synch_weights_time_ms": 21.76}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "6c58f_00000", "date": "2024-08-16_16-25-03", "timestamp": 1723805703, "time_this_iter_s": 14.261315107345581, "time_total_s": 1085.1162405014038, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1085.1162405014038, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 64.81, "ram_util_percent": 81.735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3780127077190965, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 6.255328729417589, "policy_loss": -0.007462753485592585, "vf_loss": 6.261072798885365, "vf_explained_var": 0.0016449512312651942, "kl": 0.012070781496133989, "entropy": 1.3937842488919616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3055727340872325, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.079813257348601, "policy_loss": -0.006402022237014814, "vf_loss": 6.086210666636311, "vf_explained_var": 0.02472124039811432, "kl": 0.011815992058258094, "entropy": 1.3859544027419317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 327.00727388723396, "episode_reward_min": -130.11255559463768, "episode_reward_mean": 111.34871094960803, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.4650713281199, "predator_policy": 0.7719532918717956}, "policy_reward_max": {"prey_policy": 187.33804670812816, "predator_policy": 442.2949527842518}, "policy_reward_mean": {"prey_policy": -52.038781174419746, "predator_policy": 107.71313664922376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.35290124778865, 169.9699999999999, 188.85999999999973, 114.07698359627335, 172.17999999999935, 264.6511954491439, 32.21884036908835, 104.97000000000044, 60.467142989159555, 145.99000000000012, 313.48999999999955, 158.96999999999946, 151.5447147730452, 190.9299999999997, 190.23628517879283, 19.285938885822205, 249.01000000000016, 189.3899999999996, 21.586598651573716, 164.98003140500967, 228.0486729727046, 201.9898683025084, 147.612229158142, 131.4478586041556, 118.01000000000035, 85.35000000000034, 3.7799999999999643, 193.62933818197973, 27.198727560507045, 3.4499999999999686, 143.1500000000003, 3.5899999999999697, 3.8399999999999626, 327.00727388723396, 3.649999999999965, 213.8947187138637, 258.31454039034986, 0.13538134161958365, 115.38536975678421, 146.3934875538963, 225.617700847576, 175.93948082707192, 122.80849529997067, 149.61999999999983, 234.3302973531127, 117.0662003232958, 123.33803141724646, 3.7599999999999643, 47.16999999999982, 68.606585600918, 53.451928035443885, 74.2061670713111, -4.165208623989692, -16.495269064686276, 134.74522763956105, -5.92426534812885, 11.370494852557037, 107.83552692536307, 221.97767358294206, 215.92308415914167, 120.92746778979932, -27.96221324451893, 111.53462383671483, 178.4614127840439, 141.68000000000023, 175.3710227378612, -130.11255559463768, 8.276027313402142, 79.9288288543382, 92.94579881117713, 92.26166019677797, 18.47321400287424, 12.129417217941384, -3.851438742868453, 100.93135016714884, 71.51357243964053, 153.1273196044931, 151.57191671405934, 254.43892581778445, 9.977693347721582, 204.78714794428532, 3.7499999999999636, 91.29256596820278, 248.20293259402865, 83.33175978671504, 138.60946731946913, 57.910401217194, -44.77022763162682, 118.89650413138428, 130.809228605229, 133.76204943348665, 190.9424666522099, 2.6806201125455766, 149.39165011931885, 88.08674199238057, 100.57500693718778, 7.888482750144949, -120.22621051428696, 110.96245647888121, 307.1437571421519], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.66777602633013, -68.52109519730914, -2.605311987101839, 127.81388017418452, 170.32313100287277, -18.170115278650407, 5.097551830533198, 49.13371868348368, 169.445949555873, -15.96582001496569, -59.98899301031415, 38.40990259389726, -0.5964121517813858, -126.33992084301916, -1.362049142303417, -1.8071561737151436, 1.0588252687732183, -114.05131470074346, 28.610039061758343, 0.597903605164216, 64.50189626035588, 172.52085084836716, -52.36991308702488, 151.0412480208027, 105.52793252761586, 0.9492328709947188, 182.2403562443535, -15.721909203334754, -61.346565835490296, -75.03598773726873, -29.137107025564905, -149.22491086693122, 69.61022650754298, 115.64214171362771, -136.2649562090008, 187.33804670812816, -24.492489826536907, -29.32826472525866, 22.74838011669378, 0.5785766618688335, -133.97503787319792, 110.55374570622426, -10.643191964618051, -258.6925245415193, -49.685959273701364, 61.93762996734443, -34.041498994322524, -21.040526054859043, -22.18025681091665, 5.22523304426571, 0.967857176078475, -94.5856992421593, -22.337670083207882, -3.6491698916222894, -238.90331062749397, 54.52510389197114, -137.6529345675429, -25.348690773472, -147.6545928380255, -17.744315782865655, -49.1629795950232, 86.54195592992674, -106.28663471660414, -18.95319170860232, -17.421090115012, 0.1360323640243301, -133.24943186676413, 148.92602537666804, 1.2178623835369058, -73.68158977191878, -51.46220604728592, -15.197050656956147, -74.38207287266334, 64.54352351379465, -108.4198918757519, -5.1205300629284, -201.10831833125565, -53.80517019479954, 80.07174058040451, -32.19934976758987, 27.528130787316353, 13.454959185280845, -32.09455533750875, -148.7961086701499, -111.18816856474162, -13.201069026957533, 115.479074513498, -109.51176730702906, -124.59181886880694, -9.040917330509982, -135.98729725310986, -68.76120452000538, 10.766488105238878, 10.91, -12.215766581899356, -9.057125840763172, -43.925039493046874, 0.5785819839573588, -278.32882649190094, -83.67253605982003, -140.16324056563113, -33.95737646585401, -164.30022655409627, -54.30066423466385, -11.951075690141503, -25.755268119590905, -112.88615588646044, -152.80168775091997, -24.62138356085928, -93.14872252601896, -68.12718048263994, -60.14071506973111, -20.160039586223828, -15.7875914500271, -70.12372065559964, -10.330378135329607, -191.28049011195492, 73.89311186169833, -14.293431676174032, 73.9809104715882, 1.0625734177157187, 0.7652083464225399, -128.55237910126152, -209.70873163043558, -224.5790881658026, -106.03040406855418, 107.71986503786208, -25.246753035559582, -7.798485844547622, -78.27265163242988, -221.96065547642255, -64.87234759421573, -440.4650713281199, -208.8583098182036, -89.7321233419013, -122.64749657078121, -49.82150703966889, -137.30149300802967, -214.39484815438584, -90.20620344276938, -12.293039708649173, -196.4586298826639, -226.86897216971147, -68.77335349751864, -105.3987438938845, -278.25207565939644, -68.79382768953123, -130.64690418501394, -9.812581849540654, -155.02204174525596, -113.5681723881705, -37.11750693329039, 2.270886987493501, -228.57741200178808, 2.0000000000000013, -95.91951161571103, -268.9355009738042, -14.531691594887306, -82.08600810685404, -18.38110015249231, -10.811573335336282, -64.15683368461511, -35.60990010088611, -2.0357176364074836, -79.71791467185865, -209.485477272289, -375.3231493610573, 10.042707165077982, -5.8623340000472135, -43.93500386313401, -236.31097340394504, -98.00833789113011, -3.827803922628906, 13.972563288430196, -136.54468487720004, -211.2975679843639, -91.47123928187746, -18.04342431237178, -14.415200350142943, -54.49302435746215, 4.264754787355461, -45.3416003874002, -121.0931867630833, 35.63384887122394, -28.033253208948587, -34.31533459055752, 42.914439196040455, 11.012430810497357, -25.116866321526498, -187.60211708274971, -83.30358915569481, 1.0788454051176153, -96.79615612146341, -180.69665404379424, -248.5703881023258, -174.74043369825364, -80.47704098930585, -145.09250653296326, -4.693131197582204, -137.06511973240967], "policy_predator_policy_reward": [67.54937238741343, 43.65684803135543, 39.86212550292682, 4.8993063099904575, 16.676868997127226, 20.030115278650698, 34.98416535655214, 24.861547725703666, 0.8440504441267321, 17.85582001496598, 233.93502951715791, 52.295256348403015, 8.705252520869449, 150.44992084301973, 88.72587355063989, 19.413331765378746, 62.586680847210275, 110.87295157392091, 115.38996093824166, 1.3920963948357854, 66.21122951264374, 10.256023378633403, 53.979913087024556, 6.318751979197462, 21.91944898125854, 23.14810039317606, 6.78964375564649, 17.621909203335, 105.02970380721, 221.58913494434202, 91.63116086188892, 106.01679591642834, 50.58841773054715, 13.16921404828237, 137.54495620899988, 0.7719532918717956, 52.25362264373764, 23.15373055963164, 130.39931242714502, 11.25376219930197, 138.23476200619442, 113.23520313348475, 181.16312442264166, 290.1624603860048, 74.92498677471094, 60.43557168978738, 38.379357598477455, 148.15052605485909, 79.07035003453808, 55.89467373211315, 80.5719099683259, 98.3959320977551, 24.16767008320817, 5.599169891622248, 213.17376559246668, 164.83377932503623, 44.763484238721155, 145.43686866280012, 149.2145928380241, 19.63431578286595, 84.05685976427819, 21.714163900817894, 108.01663471660503, 20.81319170860261, 19.28109011501229, 1.8439676359756714, 147.8009707974575, 163.52970957987273, 0.7721376164630955, 75.34158977191962, 153.38693305723925, 127.16704236086684, 16.231778914995733, 251.92131083422288, 111.66549809491667, 2.010305185383984, 211.61455437430587, 158.68430390853257, 33.667980748721824, 64.85311599235939, 77.28687394634387, 107.34773692863544, 149.17092397166925, 207.65922086306145, 193.64399920346816, 53.55373368820171, 3.492267747556052, 140.16042504597573, 186.9865930159354, 180.9764405364944, 131.2430408429786, 190.57166125343244, 95.18793014149833, 6.473613170508866, 14.085766581899316, 10.947125840763132, 89.10503949304693, 1.4114180160426426, 260.4579413970839, 170.15000675555575, 164.17531102976372, 63.3972340371644, 147.74564023353662, 145.06141762653502, 27.625268119591198, 5.915867066151851, 86.37541326748394, 162.81716130520942, 143.5701827109986, 108.94515101544134, 30.036454079201267, 92.30717612504154, 18.846117484372385, 28.472008404436203, 48.15576097413166, 140.13386474216006, 170.15765362066526, 169.20739821253323, 37.99704061945068, 118.23856474427737, 64.31311682559519, 54.786569200065394, 246.9147255884029, 63.384171898773594, 261.1736497421907, 180.97046632887935, 56.69527220419334, 39.293028577548576, 1.42134477160639, 226.3297927053721, 285.463189244092, 176.74083656440854, 76.91587276743368, 442.2949527842518, 78.35415464500142, 142.3014925810843, 111.3341216144141, 155.7177072876202, 190.5908176834741, 206.95603272485846, 133.6046432358089, 167.40868655228164, 223.11218617258425, 91.00335349751917, 284.63630539066145, 111.14393138056087, 21.380512686597637, 174.2087804450786, 17.605916944984717, 248.16005681696046, 144.1047484122158, 78.09450334888541, 214.0210463687843, 165.41279825000308, 77.43523833101501, 168.05618999875546, 261.515533662747, 276.39058472372983, 89.41600810685472, 21.028793500214242, 149.46287996081125, 130.29267500342624, 37.39990010088575, 3.995717636407442, 125.33271202415057, 255.16324588819836, 322.9769008789132, 290.50647391109555, 27.696782894289985, 105.43231475560499, 287.63136849026733, 185.2974101242777, 12.13682222727424, 35.62881962411897, 51.4210832202366, 251.6509420096992, 121.17977976604138, 107.23138795959167, 97.94588502349984, 101.77156828933424, 22.632749265430082, 152.20614576810058, 144.8057155970004, 131.59608894706932, 29.138653850851178, 35.89055406120065, 56.2933581066877, 39.17142200609463, 133.24388079050414, 167.56184460615142, 120.1715122112249, 62.628238476539515, 135.65847305564142, 149.72281985976102, 6.437770111538232, 296.64684117475326, 182.8984140729431, 153.63358992820702, 272.13967302584155, 176.76233504630278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8431487951109772, "mean_inference_ms": 2.7307887774329136, "mean_action_processing_ms": 0.36938043162929546, "mean_env_wait_ms": 0.30345080763173193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009254693984985352, "StateBufferConnector_ms": 0.004182219505310059, "ViewRequirementAgentConnector_ms": 0.1774839162826538}, "num_episodes": 22, "episode_return_max": 327.00727388723396, "episode_return_min": -130.11255559463768, "episode_return_mean": 111.34871094960803, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.6219114709284, "num_env_steps_trained_throughput_per_sec": 275.6219114709284, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 14885.708, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14885.626, "sample_time_ms": 2247.408, "learn_time_ms": 12614.198, "learn_throughput": 317.103, "synch_weights_time_ms": 21.738}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "6c58f_00000", "date": "2024-08-16_16-25-17", "timestamp": 1723805717, "time_this_iter_s": 14.571449995040894, "time_total_s": 1099.6876904964447, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1099.6876904964447, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 60.32380952380953, "ram_util_percent": 81.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5089311553372278, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 4.292368346799618, "policy_loss": -0.009795218932802083, "vf_loss": 4.300389290865136, "vf_explained_var": 0.012064374723131694, "kl": 0.012461284092884073, "entropy": 1.422042001933648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2670802621929735, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 5.026615848490801, "policy_loss": -0.0051275062745574996, "vf_loss": 5.031739959388814, "vf_explained_var": 0.0836186976344497, "kl": 0.008652083447751337, "entropy": 1.4216925908648779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 327.00727388723396, "episode_reward_min": -137.16220873704663, "episode_reward_mean": 95.48228469516033, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.4650713281199, "predator_policy": 0.7721376164630955}, "policy_reward_max": {"prey_policy": 148.92602537666804, "predator_policy": 442.2949527842518}, "policy_reward_mean": {"prey_policy": -68.56840951162832, "predator_policy": 116.3095518592084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [131.4478586041556, 118.01000000000035, 85.35000000000034, 3.7799999999999643, 193.62933818197973, 27.198727560507045, 3.4499999999999686, 143.1500000000003, 3.5899999999999697, 3.8399999999999626, 327.00727388723396, 3.649999999999965, 213.8947187138637, 258.31454039034986, 0.13538134161958365, 115.38536975678421, 146.3934875538963, 225.617700847576, 175.93948082707192, 122.80849529997067, 149.61999999999983, 234.3302973531127, 117.0662003232958, 123.33803141724646, 3.7599999999999643, 47.16999999999982, 68.606585600918, 53.451928035443885, 74.2061670713111, -4.165208623989692, -16.495269064686276, 134.74522763956105, -5.92426534812885, 11.370494852557037, 107.83552692536307, 221.97767358294206, 215.92308415914167, 120.92746778979932, -27.96221324451893, 111.53462383671483, 178.4614127840439, 141.68000000000023, 175.3710227378612, -130.11255559463768, 8.276027313402142, 79.9288288543382, 92.94579881117713, 92.26166019677797, 18.47321400287424, 12.129417217941384, -3.851438742868453, 100.93135016714884, 71.51357243964053, 153.1273196044931, 151.57191671405934, 254.43892581778445, 9.977693347721582, 204.78714794428532, 3.7499999999999636, 91.29256596820278, 248.20293259402865, 83.33175978671504, 138.60946731946913, 57.910401217194, -44.77022763162682, 118.89650413138428, 130.809228605229, 133.76204943348665, 190.9424666522099, 2.6806201125455766, 149.39165011931885, 88.08674199238057, 100.57500693718778, 7.888482750144949, -120.22621051428696, 110.96245647888121, 307.1437571421519, 137.52907027403123, 86.4075932922214, 34.04000000000001, 6.025000930910341, 19.43903616662858, 15.653334728787767, 113.2696427539347, -137.16220873704663, 128.28040203876364, 23.44327370616823, 110.66422705120434, 303.272003785416, 152.68226890143256, 62.85297223919057, 249.02891913128352, 135.45999999999995, 74.21797668729315, 3.8099999999999623, 132.1148609129861, 104.45296492886429, 223.14743874220756, 63.87000000000006, 50.669999999999504], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.041498994322524, -21.040526054859043, -22.18025681091665, 5.22523304426571, 0.967857176078475, -94.5856992421593, -22.337670083207882, -3.6491698916222894, -238.90331062749397, 54.52510389197114, -137.6529345675429, -25.348690773472, -147.6545928380255, -17.744315782865655, -49.1629795950232, 86.54195592992674, -106.28663471660414, -18.95319170860232, -17.421090115012, 0.1360323640243301, -133.24943186676413, 148.92602537666804, 1.2178623835369058, -73.68158977191878, -51.46220604728592, -15.197050656956147, -74.38207287266334, 64.54352351379465, -108.4198918757519, -5.1205300629284, -201.10831833125565, -53.80517019479954, 80.07174058040451, -32.19934976758987, 27.528130787316353, 13.454959185280845, -32.09455533750875, -148.7961086701499, -111.18816856474162, -13.201069026957533, 115.479074513498, -109.51176730702906, -124.59181886880694, -9.040917330509982, -135.98729725310986, -68.76120452000538, 10.766488105238878, 10.91, -12.215766581899356, -9.057125840763172, -43.925039493046874, 0.5785819839573588, -278.32882649190094, -83.67253605982003, -140.16324056563113, -33.95737646585401, -164.30022655409627, -54.30066423466385, -11.951075690141503, -25.755268119590905, -112.88615588646044, -152.80168775091997, -24.62138356085928, -93.14872252601896, -68.12718048263994, -60.14071506973111, -20.160039586223828, -15.7875914500271, -70.12372065559964, -10.330378135329607, -191.28049011195492, 73.89311186169833, -14.293431676174032, 73.9809104715882, 1.0625734177157187, 0.7652083464225399, -128.55237910126152, -209.70873163043558, -224.5790881658026, -106.03040406855418, 107.71986503786208, -25.246753035559582, -7.798485844547622, -78.27265163242988, -221.96065547642255, -64.87234759421573, -440.4650713281199, -208.8583098182036, -89.7321233419013, -122.64749657078121, -49.82150703966889, -137.30149300802967, -214.39484815438584, -90.20620344276938, -12.293039708649173, -196.4586298826639, -226.86897216971147, -68.77335349751864, -105.3987438938845, -278.25207565939644, -68.79382768953123, -130.64690418501394, -9.812581849540654, -155.02204174525596, -113.5681723881705, -37.11750693329039, 2.270886987493501, -228.57741200178808, 2.0000000000000013, -95.91951161571103, -268.9355009738042, -14.531691594887306, -82.08600810685404, -18.38110015249231, -10.811573335336282, -64.15683368461511, -35.60990010088611, -2.0357176364074836, -79.71791467185865, -209.485477272289, -375.3231493610573, 10.042707165077982, -5.8623340000472135, -43.93500386313401, -236.31097340394504, -98.00833789113011, -3.827803922628906, 13.972563288430196, -136.54468487720004, -211.2975679843639, -91.47123928187746, -18.04342431237178, -14.415200350142943, -54.49302435746215, 4.264754787355461, -45.3416003874002, -121.0931867630833, 35.63384887122394, -28.033253208948587, -34.31533459055752, 42.914439196040455, 11.012430810497357, -25.116866321526498, -187.60211708274971, -83.30358915569481, 1.0788454051176153, -96.79615612146341, -180.69665404379424, -248.5703881023258, -174.74043369825364, -80.47704098930585, -145.09250653296326, -4.693131197582204, -137.06511973240967, -235.83343423320179, -11.958726491218044, -20.540397620986845, -43.3258841077885, -204.97178668449632, -52.14840103492447, -12.966093480729437, -53.72279381631427, -98.43454297692362, -84.37214589546613, -30.460127822191073, -6.446682258970026, -42.572642261955245, -94.05192347547077, -194.06346373631126, -210.40699509134245, -2.949156170344917, 40.01813916562172, -141.0766973933338, -19.625169299082117, 80.24300263260588, -109.19813058483167, -5.694764633585061, -69.00478117454726, -27.85460138875369, 63.583066002620164, -40.99509902665855, -61.93435615174553, -251.88271317607916, -37.67008428719922, -170.4624181159939, 50.18015830066123, 11.606393485436254, -2.604997395439251, -19.227028456536424, -3.5913814283357794, -109.24835734111349, -51.79623963883398, -53.44915482606615, -127.07917711503444, -263.4661175872431, 133.49913827474836, 7.72292585554435, 3.30833320685007, -63.966135224381276, -110.01228767493267], "policy_predator_policy_reward": [38.379357598477455, 148.15052605485909, 79.07035003453808, 55.89467373211315, 80.5719099683259, 98.3959320977551, 24.16767008320817, 5.599169891622248, 213.17376559246668, 164.83377932503623, 44.763484238721155, 145.43686866280012, 149.2145928380241, 19.63431578286595, 84.05685976427819, 21.714163900817894, 108.01663471660503, 20.81319170860261, 19.28109011501229, 1.8439676359756714, 147.8009707974575, 163.52970957987273, 0.7721376164630955, 75.34158977191962, 153.38693305723925, 127.16704236086684, 16.231778914995733, 251.92131083422288, 111.66549809491667, 2.010305185383984, 211.61455437430587, 158.68430390853257, 33.667980748721824, 64.85311599235939, 77.28687394634387, 107.34773692863544, 149.17092397166925, 207.65922086306145, 193.64399920346816, 53.55373368820171, 3.492267747556052, 140.16042504597573, 186.9865930159354, 180.9764405364944, 131.2430408429786, 190.57166125343244, 95.18793014149833, 6.473613170508866, 14.085766581899316, 10.947125840763132, 89.10503949304693, 1.4114180160426426, 260.4579413970839, 170.15000675555575, 164.17531102976372, 63.3972340371644, 147.74564023353662, 145.06141762653502, 27.625268119591198, 5.915867066151851, 86.37541326748394, 162.81716130520942, 143.5701827109986, 108.94515101544134, 30.036454079201267, 92.30717612504154, 18.846117484372385, 28.472008404436203, 48.15576097413166, 140.13386474216006, 170.15765362066526, 169.20739821253323, 37.99704061945068, 118.23856474427737, 64.31311682559519, 54.786569200065394, 246.9147255884029, 63.384171898773594, 261.1736497421907, 180.97046632887935, 56.69527220419334, 39.293028577548576, 1.42134477160639, 226.3297927053721, 285.463189244092, 176.74083656440854, 76.91587276743368, 442.2949527842518, 78.35415464500142, 142.3014925810843, 111.3341216144141, 155.7177072876202, 190.5908176834741, 206.95603272485846, 133.6046432358089, 167.40868655228164, 223.11218617258425, 91.00335349751917, 284.63630539066145, 111.14393138056087, 21.380512686597637, 174.2087804450786, 17.605916944984717, 248.16005681696046, 144.1047484122158, 78.09450334888541, 214.0210463687843, 165.41279825000308, 77.43523833101501, 168.05618999875546, 261.515533662747, 276.39058472372983, 89.41600810685472, 21.028793500214242, 149.46287996081125, 130.29267500342624, 37.39990010088575, 3.995717636407442, 125.33271202415057, 255.16324588819836, 322.9769008789132, 290.50647391109555, 27.696782894289985, 105.43231475560499, 287.63136849026733, 185.2974101242777, 12.13682222727424, 35.62881962411897, 51.4210832202366, 251.6509420096992, 121.17977976604138, 107.23138795959167, 97.94588502349984, 101.77156828933424, 22.632749265430082, 152.20614576810058, 144.8057155970004, 131.59608894706932, 29.138653850851178, 35.89055406120065, 56.2933581066877, 39.17142200609463, 133.24388079050414, 167.56184460615142, 120.1715122112249, 62.628238476539515, 135.65847305564142, 149.72281985976102, 6.437770111538232, 296.64684117475326, 182.8984140729431, 153.63358992820702, 272.13967302584155, 176.76233504630278, 294.6867238151196, 90.63450718333056, 85.0197092901795, 65.2541657308161, 205.80178668449588, 85.35840103492424, 51.65467898198029, 21.059209245973477, 120.34558033079436, 81.90014470822503, 29.902252234123623, 22.657892575825564, 96.37798063045024, 153.51622786091008, 259.4695745607004, 7.838675529905631, 44.80756984869097, 46.40384919479542, 141.35121404663843, 42.793926351944165, 17.758424885590117, 121.86093011784034, 217.2250643614279, 160.74648523212065, 81.04217864891737, 35.91162563864886, 73.2250773306922, 92.55735008690239, 284.70062360785175, 253.88109298671063, 171.602418115993, 84.13984169933872, 53.49315774376501, 11.723422853530128, 21.097028456536716, 5.531381428335748, 123.07832870919404, 170.08112918373976, 168.57828139207427, 116.4030154778897, 244.98981552088122, 108.12460253382095, 27.814032099783137, 25.024708837822452, 110.85342758506823, 113.79499531424679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8429091391947715, "mean_inference_ms": 2.730511151375217, "mean_action_processing_ms": 0.36905004658936363, "mean_env_wait_ms": 0.3033565340874954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0090714693069458, "StateBufferConnector_ms": 0.0040857791900634766, "ViewRequirementAgentConnector_ms": 0.17345952987670898}, "num_episodes": 23, "episode_return_max": 327.00727388723396, "episode_return_min": -137.16220873704663, "episode_return_mean": 95.48228469516033, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.80814276536086, "num_env_steps_trained_throughput_per_sec": 272.80814276536086, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 14870.981, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14870.899, "sample_time_ms": 2149.102, "learn_time_ms": 12697.898, "learn_throughput": 315.013, "synch_weights_time_ms": 21.525}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "6c58f_00000", "date": "2024-08-16_16-25-32", "timestamp": 1723805732, "time_this_iter_s": 14.696645975112915, "time_total_s": 1114.3843364715576, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b07da040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1114.3843364715576, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 60.714999999999996, "ram_util_percent": 81.37999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7450846228807693, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.0735121156803515, "policy_loss": -0.004677691943598566, "vf_loss": 5.076977480782403, "vf_explained_var": 0.006544214234781013, "kl": 0.008514399443314969, "entropy": 1.4204360050499123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3848649234683426, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.225646882839304, "policy_loss": -0.0079265162982564, "vf_loss": 6.233569129812654, "vf_explained_var": 0.18577669792705112, "kl": 0.010929114094866807, "entropy": 1.3701952271991307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 307.1437571421519, "episode_reward_min": -137.16220873704663, "episode_reward_mean": 95.79292185174504, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.4650713281199, "predator_policy": 1.4114180160426426}, "policy_reward_max": {"prey_policy": 158.4207544427391, "predator_policy": 442.2949527842518}, "policy_reward_mean": {"prey_policy": -67.16595156721651, "predator_policy": 115.062412493089}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.93948082707192, 122.80849529997067, 149.61999999999983, 234.3302973531127, 117.0662003232958, 123.33803141724646, 3.7599999999999643, 47.16999999999982, 68.606585600918, 53.451928035443885, 74.2061670713111, -4.165208623989692, -16.495269064686276, 134.74522763956105, -5.92426534812885, 11.370494852557037, 107.83552692536307, 221.97767358294206, 215.92308415914167, 120.92746778979932, -27.96221324451893, 111.53462383671483, 178.4614127840439, 141.68000000000023, 175.3710227378612, -130.11255559463768, 8.276027313402142, 79.9288288543382, 92.94579881117713, 92.26166019677797, 18.47321400287424, 12.129417217941384, -3.851438742868453, 100.93135016714884, 71.51357243964053, 153.1273196044931, 151.57191671405934, 254.43892581778445, 9.977693347721582, 204.78714794428532, 3.7499999999999636, 91.29256596820278, 248.20293259402865, 83.33175978671504, 138.60946731946913, 57.910401217194, -44.77022763162682, 118.89650413138428, 130.809228605229, 133.76204943348665, 190.9424666522099, 2.6806201125455766, 149.39165011931885, 88.08674199238057, 100.57500693718778, 7.888482750144949, -120.22621051428696, 110.96245647888121, 307.1437571421519, 137.52907027403123, 86.4075932922214, 34.04000000000001, 6.025000930910341, 19.43903616662858, 15.653334728787767, 113.2696427539347, -137.16220873704663, 128.28040203876364, 23.44327370616823, 110.66422705120434, 303.272003785416, 152.68226890143256, 62.85297223919057, 249.02891913128352, 135.45999999999995, 74.21797668729315, 3.8099999999999623, 132.1148609129861, 104.45296492886429, 223.14743874220756, 63.87000000000006, 50.669999999999504, 222.56669301185062, 132.03754913713414, 162.5947332838875, 3.5201123535201453, 80.5315344051194, 283.90370049278954, 12.289999999999933, 28.16000000000044, 124.58886959081578, 55.72068294179895, 62.650699806353, 274.70998369683673, 117.70883959719283, 32.44353728529495, 46.35091062475467, 227.60612917664685, 140.95413709244588, 26.57000000000019], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.09455533750875, -148.7961086701499, -111.18816856474162, -13.201069026957533, 115.479074513498, -109.51176730702906, -124.59181886880694, -9.040917330509982, -135.98729725310986, -68.76120452000538, 10.766488105238878, 10.91, -12.215766581899356, -9.057125840763172, -43.925039493046874, 0.5785819839573588, -278.32882649190094, -83.67253605982003, -140.16324056563113, -33.95737646585401, -164.30022655409627, -54.30066423466385, -11.951075690141503, -25.755268119590905, -112.88615588646044, -152.80168775091997, -24.62138356085928, -93.14872252601896, -68.12718048263994, -60.14071506973111, -20.160039586223828, -15.7875914500271, -70.12372065559964, -10.330378135329607, -191.28049011195492, 73.89311186169833, -14.293431676174032, 73.9809104715882, 1.0625734177157187, 0.7652083464225399, -128.55237910126152, -209.70873163043558, -224.5790881658026, -106.03040406855418, 107.71986503786208, -25.246753035559582, -7.798485844547622, -78.27265163242988, -221.96065547642255, -64.87234759421573, -440.4650713281199, -208.8583098182036, -89.7321233419013, -122.64749657078121, -49.82150703966889, -137.30149300802967, -214.39484815438584, -90.20620344276938, -12.293039708649173, -196.4586298826639, -226.86897216971147, -68.77335349751864, -105.3987438938845, -278.25207565939644, -68.79382768953123, -130.64690418501394, -9.812581849540654, -155.02204174525596, -113.5681723881705, -37.11750693329039, 2.270886987493501, -228.57741200178808, 2.0000000000000013, -95.91951161571103, -268.9355009738042, -14.531691594887306, -82.08600810685404, -18.38110015249231, -10.811573335336282, -64.15683368461511, -35.60990010088611, -2.0357176364074836, -79.71791467185865, -209.485477272289, -375.3231493610573, 10.042707165077982, -5.8623340000472135, -43.93500386313401, -236.31097340394504, -98.00833789113011, -3.827803922628906, 13.972563288430196, -136.54468487720004, -211.2975679843639, -91.47123928187746, -18.04342431237178, -14.415200350142943, -54.49302435746215, 4.264754787355461, -45.3416003874002, -121.0931867630833, 35.63384887122394, -28.033253208948587, -34.31533459055752, 42.914439196040455, 11.012430810497357, -25.116866321526498, -187.60211708274971, -83.30358915569481, 1.0788454051176153, -96.79615612146341, -180.69665404379424, -248.5703881023258, -174.74043369825364, -80.47704098930585, -145.09250653296326, -4.693131197582204, -137.06511973240967, -235.83343423320179, -11.958726491218044, -20.540397620986845, -43.3258841077885, -204.97178668449632, -52.14840103492447, -12.966093480729437, -53.72279381631427, -98.43454297692362, -84.37214589546613, -30.460127822191073, -6.446682258970026, -42.572642261955245, -94.05192347547077, -194.06346373631126, -210.40699509134245, -2.949156170344917, 40.01813916562172, -141.0766973933338, -19.625169299082117, 80.24300263260588, -109.19813058483167, -5.694764633585061, -69.00478117454726, -27.85460138875369, 63.583066002620164, -40.99509902665855, -61.93435615174553, -251.88271317607916, -37.67008428719922, -170.4624181159939, 50.18015830066123, 11.606393485436254, -2.604997395439251, -19.227028456536424, -3.5913814283357794, -109.24835734111349, -51.79623963883398, -53.44915482606615, -127.07917711503444, -263.4661175872431, 133.49913827474836, 7.72292585554435, 3.30833320685007, -63.966135224381276, -110.01228767493267, -132.72626729671458, -109.20720434054519, 76.61293287921, -18.224693086174216, 37.26369143965841, -75.56853274970612, -80.30183881582846, 0.10923313554126454, -57.77401488936641, 37.00907204055976, 146.66789090156465, 67.65700403045882, -20.240179967235562, -67.01190862498075, -27.512518005267268, -54.32675121950036, -101.34928622699958, -90.5649431106205, 39.095475944414474, -63.34080001200388, -16.723631094841743, 6.834294140636999, -39.966516375743225, 141.92673393974601, -26.041965801369802, -40.19434122774656, -67.22658027394736, -176.62321940119682, -10.193050115183455, -79.973065306996, 158.4207544427391, 0.23310590910189827, 68.79093940379447, -45.04198300640215, -60.02868939158485, -262.41730800148724], "policy_predator_policy_reward": [149.17092397166925, 207.65922086306145, 193.64399920346816, 53.55373368820171, 3.492267747556052, 140.16042504597573, 186.9865930159354, 180.9764405364944, 131.2430408429786, 190.57166125343244, 95.18793014149833, 6.473613170508866, 14.085766581899316, 10.947125840763132, 89.10503949304693, 1.4114180160426426, 260.4579413970839, 170.15000675555575, 164.17531102976372, 63.3972340371644, 147.74564023353662, 145.06141762653502, 27.625268119591198, 5.915867066151851, 86.37541326748394, 162.81716130520942, 143.5701827109986, 108.94515101544134, 30.036454079201267, 92.30717612504154, 18.846117484372385, 28.472008404436203, 48.15576097413166, 140.13386474216006, 170.15765362066526, 169.20739821253323, 37.99704061945068, 118.23856474427737, 64.31311682559519, 54.786569200065394, 246.9147255884029, 63.384171898773594, 261.1736497421907, 180.97046632887935, 56.69527220419334, 39.293028577548576, 1.42134477160639, 226.3297927053721, 285.463189244092, 176.74083656440854, 76.91587276743368, 442.2949527842518, 78.35415464500142, 142.3014925810843, 111.3341216144141, 155.7177072876202, 190.5908176834741, 206.95603272485846, 133.6046432358089, 167.40868655228164, 223.11218617258425, 91.00335349751917, 284.63630539066145, 111.14393138056087, 21.380512686597637, 174.2087804450786, 17.605916944984717, 248.16005681696046, 144.1047484122158, 78.09450334888541, 214.0210463687843, 165.41279825000308, 77.43523833101501, 168.05618999875546, 261.515533662747, 276.39058472372983, 89.41600810685472, 21.028793500214242, 149.46287996081125, 130.29267500342624, 37.39990010088575, 3.995717636407442, 125.33271202415057, 255.16324588819836, 322.9769008789132, 290.50647391109555, 27.696782894289985, 105.43231475560499, 287.63136849026733, 185.2974101242777, 12.13682222727424, 35.62881962411897, 51.4210832202366, 251.6509420096992, 121.17977976604138, 107.23138795959167, 97.94588502349984, 101.77156828933424, 22.632749265430082, 152.20614576810058, 144.8057155970004, 131.59608894706932, 29.138653850851178, 35.89055406120065, 56.2933581066877, 39.17142200609463, 133.24388079050414, 167.56184460615142, 120.1715122112249, 62.628238476539515, 135.65847305564142, 149.72281985976102, 6.437770111538232, 296.64684117475326, 182.8984140729431, 153.63358992820702, 272.13967302584155, 176.76233504630278, 294.6867238151196, 90.63450718333056, 85.0197092901795, 65.2541657308161, 205.80178668449588, 85.35840103492424, 51.65467898198029, 21.059209245973477, 120.34558033079436, 81.90014470822503, 29.902252234123623, 22.657892575825564, 96.37798063045024, 153.51622786091008, 259.4695745607004, 7.838675529905631, 44.80756984869097, 46.40384919479542, 141.35121404663843, 42.793926351944165, 17.758424885590117, 121.86093011784034, 217.2250643614279, 160.74648523212065, 81.04217864891737, 35.91162563864886, 73.2250773306922, 92.55735008690239, 284.70062360785175, 253.88109298671063, 171.602418115993, 84.13984169933872, 53.49315774376501, 11.723422853530128, 21.097028456536716, 5.531381428335748, 123.07832870919404, 170.08112918373976, 168.57828139207427, 116.4030154778897, 244.98981552088122, 108.12460253382095, 27.814032099783137, 25.024708837822452, 110.85342758506823, 113.79499531424679, 260.46507838316325, 204.03508626594692, 43.94706712079014, 29.70224222330881, 123.79104184422916, 77.10853274970604, 81.97183881582933, 1.7408792179789145, 56.63237191555696, 44.66410533836785, 36.355901088997285, 33.22290447176974, 16.148693725879223, 83.39339486633776, 7.938678659008676, 102.06059056575879, 168.80486557468402, 147.6982333537517, 28.944628603833262, 51.02137840555497, 29.814679716846815, 42.72535704371165, 96.53269835292919, 76.21706777990529, 65.57430460570173, 118.37084202060784, 96.09056335646665, 180.20277360397134, 61.76099612693073, 74.75602992000367, 32.45231577310297, 36.4999530517038, 15.96211620729921, 101.24306448775641, 86.12868939158462, 262.88730800148716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.842511942409565, "mean_inference_ms": 2.7289020655089393, "mean_action_processing_ms": 0.3685269699843511, "mean_env_wait_ms": 0.3031450509636122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00681614875793457, "StateBufferConnector_ms": 0.0038007497787475586, "ViewRequirementAgentConnector_ms": 0.13709425926208496}, "num_episodes": 18, "episode_return_max": 307.1437571421519, "episode_return_min": -137.16220873704663, "episode_return_mean": 95.79292185174504, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.32172286311294, "num_env_steps_trained_throughput_per_sec": 263.32172286311294, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 14822.298, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14822.218, "sample_time_ms": 2034.384, "learn_time_ms": 12763.611, "learn_throughput": 313.391, "synch_weights_time_ms": 21.025}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "6c58f_00000", "date": "2024-08-16_16-25-47", "timestamp": 1723805747, "time_this_iter_s": 15.217000961303711, "time_total_s": 1129.6013374328613, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1129.6013374328613, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 60.63181818181817, "ram_util_percent": 81.8409090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.401904043981007, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 3.4293635441512658, "policy_loss": -0.005012999278143364, "vf_loss": 3.433098250595981, "vf_explained_var": 0.007893421757158148, "kl": 0.008977917389889734, "entropy": 1.447931338491894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9683393506776719, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 4.818950069770612, "policy_loss": -0.005259902358779477, "vf_loss": 4.8242074408859175, "vf_explained_var": 0.26897241627728496, "kl": 0.006507303307740943, "entropy": 1.3818705816117545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 307.1437571421519, "episode_reward_min": -137.16220873704663, "episode_reward_mean": 97.87249290407175, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -440.4650713281199, "predator_policy": 1.42134477160639}, "policy_reward_max": {"prey_policy": 158.4207544427391, "predator_policy": 442.2949527842518}, "policy_reward_mean": {"prey_policy": -59.54038687635978, "predator_policy": 108.47663332839558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.92308415914167, 120.92746778979932, -27.96221324451893, 111.53462383671483, 178.4614127840439, 141.68000000000023, 175.3710227378612, -130.11255559463768, 8.276027313402142, 79.9288288543382, 92.94579881117713, 92.26166019677797, 18.47321400287424, 12.129417217941384, -3.851438742868453, 100.93135016714884, 71.51357243964053, 153.1273196044931, 151.57191671405934, 254.43892581778445, 9.977693347721582, 204.78714794428532, 3.7499999999999636, 91.29256596820278, 248.20293259402865, 83.33175978671504, 138.60946731946913, 57.910401217194, -44.77022763162682, 118.89650413138428, 130.809228605229, 133.76204943348665, 190.9424666522099, 2.6806201125455766, 149.39165011931885, 88.08674199238057, 100.57500693718778, 7.888482750144949, -120.22621051428696, 110.96245647888121, 307.1437571421519, 137.52907027403123, 86.4075932922214, 34.04000000000001, 6.025000930910341, 19.43903616662858, 15.653334728787767, 113.2696427539347, -137.16220873704663, 128.28040203876364, 23.44327370616823, 110.66422705120434, 303.272003785416, 152.68226890143256, 62.85297223919057, 249.02891913128352, 135.45999999999995, 74.21797668729315, 3.8099999999999623, 132.1148609129861, 104.45296492886429, 223.14743874220756, 63.87000000000006, 50.669999999999504, 222.56669301185062, 132.03754913713414, 162.5947332838875, 3.5201123535201453, 80.5315344051194, 283.90370049278954, 12.289999999999933, 28.16000000000044, 124.58886959081578, 55.72068294179895, 62.650699806353, 274.70998369683673, 117.70883959719283, 32.44353728529495, 46.35091062475467, 227.60612917664685, 140.95413709244588, 26.57000000000019, 80.7400000000008, 278.42229381119205, 49.63106474614593, 98.06147887435208, 99.84905862565992, 136.85432122626077, 165.00999999999976, 133.05000000000035, -0.9726734177674266, 142.01803478560697, -1.4879487740863047, 37.80142611516893, 32.17000000000035, 31.28176992246238, 0.7741569452429118, 122.68000000000028, 172.04439894498893, 249.67108931943164], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.293431676174032, 73.9809104715882, 1.0625734177157187, 0.7652083464225399, -128.55237910126152, -209.70873163043558, -224.5790881658026, -106.03040406855418, 107.71986503786208, -25.246753035559582, -7.798485844547622, -78.27265163242988, -221.96065547642255, -64.87234759421573, -440.4650713281199, -208.8583098182036, -89.7321233419013, -122.64749657078121, -49.82150703966889, -137.30149300802967, -214.39484815438584, -90.20620344276938, -12.293039708649173, -196.4586298826639, -226.86897216971147, -68.77335349751864, -105.3987438938845, -278.25207565939644, -68.79382768953123, -130.64690418501394, -9.812581849540654, -155.02204174525596, -113.5681723881705, -37.11750693329039, 2.270886987493501, -228.57741200178808, 2.0000000000000013, -95.91951161571103, -268.9355009738042, -14.531691594887306, -82.08600810685404, -18.38110015249231, -10.811573335336282, -64.15683368461511, -35.60990010088611, -2.0357176364074836, -79.71791467185865, -209.485477272289, -375.3231493610573, 10.042707165077982, -5.8623340000472135, -43.93500386313401, -236.31097340394504, -98.00833789113011, -3.827803922628906, 13.972563288430196, -136.54468487720004, -211.2975679843639, -91.47123928187746, -18.04342431237178, -14.415200350142943, -54.49302435746215, 4.264754787355461, -45.3416003874002, -121.0931867630833, 35.63384887122394, -28.033253208948587, -34.31533459055752, 42.914439196040455, 11.012430810497357, -25.116866321526498, -187.60211708274971, -83.30358915569481, 1.0788454051176153, -96.79615612146341, -180.69665404379424, -248.5703881023258, -174.74043369825364, -80.47704098930585, -145.09250653296326, -4.693131197582204, -137.06511973240967, -235.83343423320179, -11.958726491218044, -20.540397620986845, -43.3258841077885, -204.97178668449632, -52.14840103492447, -12.966093480729437, -53.72279381631427, -98.43454297692362, -84.37214589546613, -30.460127822191073, -6.446682258970026, -42.572642261955245, -94.05192347547077, -194.06346373631126, -210.40699509134245, -2.949156170344917, 40.01813916562172, -141.0766973933338, -19.625169299082117, 80.24300263260588, -109.19813058483167, -5.694764633585061, -69.00478117454726, -27.85460138875369, 63.583066002620164, -40.99509902665855, -61.93435615174553, -251.88271317607916, -37.67008428719922, -170.4624181159939, 50.18015830066123, 11.606393485436254, -2.604997395439251, -19.227028456536424, -3.5913814283357794, -109.24835734111349, -51.79623963883398, -53.44915482606615, -127.07917711503444, -263.4661175872431, 133.49913827474836, 7.72292585554435, 3.30833320685007, -63.966135224381276, -110.01228767493267, -132.72626729671458, -109.20720434054519, 76.61293287921, -18.224693086174216, 37.26369143965841, -75.56853274970612, -80.30183881582846, 0.10923313554126454, -57.77401488936641, 37.00907204055976, 146.66789090156465, 67.65700403045882, -20.240179967235562, -67.01190862498075, -27.512518005267268, -54.32675121950036, -101.34928622699958, -90.5649431106205, 39.095475944414474, -63.34080001200388, -16.723631094841743, 6.834294140636999, -39.966516375743225, 141.92673393974601, -26.041965801369802, -40.19434122774656, -67.22658027394736, -176.62321940119682, -10.193050115183455, -79.973065306996, 158.4207544427391, 0.23310590910189827, 68.79093940379447, -45.04198300640215, -60.02868939158485, -262.41730800148724, -103.67622625312084, -10.715347401808653, 31.67039468035275, 55.497174323922756, -12.942972220085036, -75.55939509680209, 19.23880192138269, -68.17842568306915, -63.70595261335815, 7.7590813223498785, -3.8662881397730375, 10.733306372240763, -16.210352866235425, 128.87504829940747, -40.64102932928161, 69.48700826945846, -12.42398940747359, -142.60818191488175, 86.20122953792438, -3.072969920095365, -71.29767935659324, -152.64138841891076, -7.348615984154403, -168.256687352199, -26.002604043454603, -39.66403932602649, -59.43994837562385, -3.081077488977309, -169.17418823888005, -40.63967770842676, 11.168007586197778, -52.053976979557454, 78.00584158127069, -41.49285017935661, 71.58704239262292, 121.00300445476242], "policy_predator_policy_reward": [37.99704061945068, 118.23856474427737, 64.31311682559519, 54.786569200065394, 246.9147255884029, 63.384171898773594, 261.1736497421907, 180.97046632887935, 56.69527220419334, 39.293028577548576, 1.42134477160639, 226.3297927053721, 285.463189244092, 176.74083656440854, 76.91587276743368, 442.2949527842518, 78.35415464500142, 142.3014925810843, 111.3341216144141, 155.7177072876202, 190.5908176834741, 206.95603272485846, 133.6046432358089, 167.40868655228164, 223.11218617258425, 91.00335349751917, 284.63630539066145, 111.14393138056087, 21.380512686597637, 174.2087804450786, 17.605916944984717, 248.16005681696046, 144.1047484122158, 78.09450334888541, 214.0210463687843, 165.41279825000308, 77.43523833101501, 168.05618999875546, 261.515533662747, 276.39058472372983, 89.41600810685472, 21.028793500214242, 149.46287996081125, 130.29267500342624, 37.39990010088575, 3.995717636407442, 125.33271202415057, 255.16324588819836, 322.9769008789132, 290.50647391109555, 27.696782894289985, 105.43231475560499, 287.63136849026733, 185.2974101242777, 12.13682222727424, 35.62881962411897, 51.4210832202366, 251.6509420096992, 121.17977976604138, 107.23138795959167, 97.94588502349984, 101.77156828933424, 22.632749265430082, 152.20614576810058, 144.8057155970004, 131.59608894706932, 29.138653850851178, 35.89055406120065, 56.2933581066877, 39.17142200609463, 133.24388079050414, 167.56184460615142, 120.1715122112249, 62.628238476539515, 135.65847305564142, 149.72281985976102, 6.437770111538232, 296.64684117475326, 182.8984140729431, 153.63358992820702, 272.13967302584155, 176.76233504630278, 294.6867238151196, 90.63450718333056, 85.0197092901795, 65.2541657308161, 205.80178668449588, 85.35840103492424, 51.65467898198029, 21.059209245973477, 120.34558033079436, 81.90014470822503, 29.902252234123623, 22.657892575825564, 96.37798063045024, 153.51622786091008, 259.4695745607004, 7.838675529905631, 44.80756984869097, 46.40384919479542, 141.35121404663843, 42.793926351944165, 17.758424885590117, 121.86093011784034, 217.2250643614279, 160.74648523212065, 81.04217864891737, 35.91162563864886, 73.2250773306922, 92.55735008690239, 284.70062360785175, 253.88109298671063, 171.602418115993, 84.13984169933872, 53.49315774376501, 11.723422853530128, 21.097028456536716, 5.531381428335748, 123.07832870919404, 170.08112918373976, 168.57828139207427, 116.4030154778897, 244.98981552088122, 108.12460253382095, 27.814032099783137, 25.024708837822452, 110.85342758506823, 113.79499531424679, 260.46507838316325, 204.03508626594692, 43.94706712079014, 29.70224222330881, 123.79104184422916, 77.10853274970604, 81.97183881582933, 1.7408792179789145, 56.63237191555696, 44.66410533836785, 36.355901088997285, 33.22290447176974, 16.148693725879223, 83.39339486633776, 7.938678659008676, 102.06059056575879, 168.80486557468402, 147.6982333537517, 28.944628603833262, 51.02137840555497, 29.814679716846815, 42.72535704371165, 96.53269835292919, 76.21706777990529, 65.57430460570173, 118.37084202060784, 96.09056335646665, 180.20277360397134, 61.76099612693073, 74.75602992000367, 32.45231577310297, 36.4999530517038, 15.96211620729921, 101.24306448775641, 86.12868939158462, 262.88730800148716, 187.844115009927, 7.287458645002822, 52.17727404682427, 139.07745076009272, 41.09769274990425, 97.03573931312974, 83.39652402623126, 63.60457860980727, 76.26304853801959, 79.5328813786473, 10.082326242129644, 119.90497675166408, 18.010352866235685, 34.33495170059257, 42.49102932928124, 61.71299173054154, 95.69745454343835, 58.36204336114831, 25.553248179523774, 33.33652698825377, 133.7393878923262, 88.7117311090907, 84.21175049710823, 129.1949789544135, 27.772604043454752, 70.06403932602623, 47.05757734448491, 46.745218442577716, 11.027796624090163, 199.56022626845848, 109.88199241380224, 53.68397697955713, 64.18207987370018, 71.34932766937487, 34.655379646369994, 22.425662825677215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8413998789552288, "mean_inference_ms": 2.7252225623255173, "mean_action_processing_ms": 0.36780003234864395, "mean_env_wait_ms": 0.3026828494962664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064018964767456055, "StateBufferConnector_ms": 0.0043261051177978516, "ViewRequirementAgentConnector_ms": 0.1282593011856079}, "num_episodes": 18, "episode_return_max": 307.1437571421519, "episode_return_min": -137.16220873704663, "episode_return_mean": 97.87249290407175, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.0840945448461, "num_env_steps_trained_throughput_per_sec": 308.0840945448461, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 14597.553, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14597.477, "sample_time_ms": 1976.382, "learn_time_ms": 12597.627, "learn_throughput": 317.52, "synch_weights_time_ms": 20.305}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "6c58f_00000", "date": "2024-08-16_16-26-00", "timestamp": 1723805760, "time_this_iter_s": 12.988824844360352, "time_total_s": 1142.5901622772217, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1142.5901622772217, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 53.361111111111114, "ram_util_percent": 76.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5281240365807973, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 5.190935726266689, "policy_loss": -0.007979727919809717, "vf_loss": 5.197364525694065, "vf_explained_var": 0.010998374223709107, "kl": 0.010892611113335246, "entropy": 1.4387725731683156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.479391435498283, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.2735396798956335, "policy_loss": -0.002981704326528839, "vf_loss": 6.276518719536917, "vf_explained_var": 0.21858450196407458, "kl": 0.006829252758268655, "entropy": 1.3198955428663386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 332.46502590694786, "episode_reward_min": -137.16220873704663, "episode_reward_mean": 107.77032627198213, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -375.3231493610573, "predator_policy": 1.7408792179789145}, "policy_reward_max": {"prey_policy": 158.4207544427391, "predator_policy": 322.9769008789132}, "policy_reward_mean": {"prey_policy": -37.45063857611877, "predator_policy": 91.33580171210978}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.7499999999999636, 91.29256596820278, 248.20293259402865, 83.33175978671504, 138.60946731946913, 57.910401217194, -44.77022763162682, 118.89650413138428, 130.809228605229, 133.76204943348665, 190.9424666522099, 2.6806201125455766, 149.39165011931885, 88.08674199238057, 100.57500693718778, 7.888482750144949, -120.22621051428696, 110.96245647888121, 307.1437571421519, 137.52907027403123, 86.4075932922214, 34.04000000000001, 6.025000930910341, 19.43903616662858, 15.653334728787767, 113.2696427539347, -137.16220873704663, 128.28040203876364, 23.44327370616823, 110.66422705120434, 303.272003785416, 152.68226890143256, 62.85297223919057, 249.02891913128352, 135.45999999999995, 74.21797668729315, 3.8099999999999623, 132.1148609129861, 104.45296492886429, 223.14743874220756, 63.87000000000006, 50.669999999999504, 222.56669301185062, 132.03754913713414, 162.5947332838875, 3.5201123535201453, 80.5315344051194, 283.90370049278954, 12.289999999999933, 28.16000000000044, 124.58886959081578, 55.72068294179895, 62.650699806353, 274.70998369683673, 117.70883959719283, 32.44353728529495, 46.35091062475467, 227.60612917664685, 140.95413709244588, 26.57000000000019, 80.7400000000008, 278.42229381119205, 49.63106474614593, 98.06147887435208, 99.84905862565992, 136.85432122626077, 165.00999999999976, 133.05000000000035, -0.9726734177674266, 142.01803478560697, -1.4879487740863047, 37.80142611516893, 32.17000000000035, 31.28176992246238, 0.7741569452429118, 122.68000000000028, 172.04439894498893, 249.67108931943164, 162.19233485175113, 115.75281587745899, 265.1716988221529, 163.72999999999996, 279.8795152084049, 151.0900000000001, 29.936381171732936, 141.73000000000025, 221.82690305200208, 296.98866425008265, 81.22621284466679, 3.3199999999999723, 133.49863814522064, 30.41146557300738, 3.489999999999969, 202.22440412619437, 58.89999999999959, 90.214722190248, 3.8299999999999628, 119.0388309283437, 332.46502590694786, 135.20000000000027], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-35.60990010088611, -2.0357176364074836, -79.71791467185865, -209.485477272289, -375.3231493610573, 10.042707165077982, -5.8623340000472135, -43.93500386313401, -236.31097340394504, -98.00833789113011, -3.827803922628906, 13.972563288430196, -136.54468487720004, -211.2975679843639, -91.47123928187746, -18.04342431237178, -14.415200350142943, -54.49302435746215, 4.264754787355461, -45.3416003874002, -121.0931867630833, 35.63384887122394, -28.033253208948587, -34.31533459055752, 42.914439196040455, 11.012430810497357, -25.116866321526498, -187.60211708274971, -83.30358915569481, 1.0788454051176153, -96.79615612146341, -180.69665404379424, -248.5703881023258, -174.74043369825364, -80.47704098930585, -145.09250653296326, -4.693131197582204, -137.06511973240967, -235.83343423320179, -11.958726491218044, -20.540397620986845, -43.3258841077885, -204.97178668449632, -52.14840103492447, -12.966093480729437, -53.72279381631427, -98.43454297692362, -84.37214589546613, -30.460127822191073, -6.446682258970026, -42.572642261955245, -94.05192347547077, -194.06346373631126, -210.40699509134245, -2.949156170344917, 40.01813916562172, -141.0766973933338, -19.625169299082117, 80.24300263260588, -109.19813058483167, -5.694764633585061, -69.00478117454726, -27.85460138875369, 63.583066002620164, -40.99509902665855, -61.93435615174553, -251.88271317607916, -37.67008428719922, -170.4624181159939, 50.18015830066123, 11.606393485436254, -2.604997395439251, -19.227028456536424, -3.5913814283357794, -109.24835734111349, -51.79623963883398, -53.44915482606615, -127.07917711503444, -263.4661175872431, 133.49913827474836, 7.72292585554435, 3.30833320685007, -63.966135224381276, -110.01228767493267, -132.72626729671458, -109.20720434054519, 76.61293287921, -18.224693086174216, 37.26369143965841, -75.56853274970612, -80.30183881582846, 0.10923313554126454, -57.77401488936641, 37.00907204055976, 146.66789090156465, 67.65700403045882, -20.240179967235562, -67.01190862498075, -27.512518005267268, -54.32675121950036, -101.34928622699958, -90.5649431106205, 39.095475944414474, -63.34080001200388, -16.723631094841743, 6.834294140636999, -39.966516375743225, 141.92673393974601, -26.041965801369802, -40.19434122774656, -67.22658027394736, -176.62321940119682, -10.193050115183455, -79.973065306996, 158.4207544427391, 0.23310590910189827, 68.79093940379447, -45.04198300640215, -60.02868939158485, -262.41730800148724, -103.67622625312084, -10.715347401808653, 31.67039468035275, 55.497174323922756, -12.942972220085036, -75.55939509680209, 19.23880192138269, -68.17842568306915, -63.70595261335815, 7.7590813223498785, -3.8662881397730375, 10.733306372240763, -16.210352866235425, 128.87504829940747, -40.64102932928161, 69.48700826945846, -12.42398940747359, -142.60818191488175, 86.20122953792438, -3.072969920095365, -71.29767935659324, -152.64138841891076, -7.348615984154403, -168.256687352199, -26.002604043454603, -39.66403932602649, -59.43994837562385, -3.081077488977309, -169.17418823888005, -40.63967770842676, 11.168007586197778, -52.053976979557454, 78.00584158127069, -41.49285017935661, 71.58704239262292, 121.00300445476242, 108.41254508946503, -11.458009187847338, -94.55866198710488, -53.91556584836639, 50.044800810869226, 98.74515400527342, 154.3210334347291, -75.80767230396343, 141.75617744700483, 54.70904522136749, 95.91166418590626, -7.012847735166577, -55.61144406731321, -112.37769761899054, -54.19494203184271, 69.98508867334665, 53.98795588291204, 51.871481171892796, 66.77042829580328, 104.39195476040841, -77.79808566584747, -89.47233220877524, -19.280291875662158, -150.5006984818098, 50.086613832246364, -287.42003356320186, -75.20912178255675, -2.1813220138685265, -9.327577836676234, -74.89955314186707, 131.44663975381116, -26.055772146716464, 2.111535699202369, -42.618434259639464, -9.193861134271422, -64.14759664028611, -4.595327807725122, -7.624916184191228, -80.18229557267348, 25.923570050865703, 147.5950597201597, 126.17408169105049, -137.0100979863746, 72.8109716683296], "policy_predator_policy_reward": [37.39990010088575, 3.995717636407442, 125.33271202415057, 255.16324588819836, 322.9769008789132, 290.50647391109555, 27.696782894289985, 105.43231475560499, 287.63136849026733, 185.2974101242777, 12.13682222727424, 35.62881962411897, 51.4210832202366, 251.6509420096992, 121.17977976604138, 107.23138795959167, 97.94588502349984, 101.77156828933424, 22.632749265430082, 152.20614576810058, 144.8057155970004, 131.59608894706932, 29.138653850851178, 35.89055406120065, 56.2933581066877, 39.17142200609463, 133.24388079050414, 167.56184460615142, 120.1715122112249, 62.628238476539515, 135.65847305564142, 149.72281985976102, 6.437770111538232, 296.64684117475326, 182.8984140729431, 153.63358992820702, 272.13967302584155, 176.76233504630278, 294.6867238151196, 90.63450718333056, 85.0197092901795, 65.2541657308161, 205.80178668449588, 85.35840103492424, 51.65467898198029, 21.059209245973477, 120.34558033079436, 81.90014470822503, 29.902252234123623, 22.657892575825564, 96.37798063045024, 153.51622786091008, 259.4695745607004, 7.838675529905631, 44.80756984869097, 46.40384919479542, 141.35121404663843, 42.793926351944165, 17.758424885590117, 121.86093011784034, 217.2250643614279, 160.74648523212065, 81.04217864891737, 35.91162563864886, 73.2250773306922, 92.55735008690239, 284.70062360785175, 253.88109298671063, 171.602418115993, 84.13984169933872, 53.49315774376501, 11.723422853530128, 21.097028456536716, 5.531381428335748, 123.07832870919404, 170.08112918373976, 168.57828139207427, 116.4030154778897, 244.98981552088122, 108.12460253382095, 27.814032099783137, 25.024708837822452, 110.85342758506823, 113.79499531424679, 260.46507838316325, 204.03508626594692, 43.94706712079014, 29.70224222330881, 123.79104184422916, 77.10853274970604, 81.97183881582933, 1.7408792179789145, 56.63237191555696, 44.66410533836785, 36.355901088997285, 33.22290447176974, 16.148693725879223, 83.39339486633776, 7.938678659008676, 102.06059056575879, 168.80486557468402, 147.6982333537517, 28.944628603833262, 51.02137840555497, 29.814679716846815, 42.72535704371165, 96.53269835292919, 76.21706777990529, 65.57430460570173, 118.37084202060784, 96.09056335646665, 180.20277360397134, 61.76099612693073, 74.75602992000367, 32.45231577310297, 36.4999530517038, 15.96211620729921, 101.24306448775641, 86.12868939158462, 262.88730800148716, 187.844115009927, 7.287458645002822, 52.17727404682427, 139.07745076009272, 41.09769274990425, 97.03573931312974, 83.39652402623126, 63.60457860980727, 76.26304853801959, 79.5328813786473, 10.082326242129644, 119.90497675166408, 18.010352866235685, 34.33495170059257, 42.49102932928124, 61.71299173054154, 95.69745454343835, 58.36204336114831, 25.553248179523774, 33.33652698825377, 133.7393878923262, 88.7117311090907, 84.21175049710823, 129.1949789544135, 27.772604043454752, 70.06403932602623, 47.05757734448491, 46.745218442577716, 11.027796624090163, 199.56022626845848, 109.88199241380224, 53.68397697955713, 64.18207987370018, 71.34932766937487, 34.655379646369994, 22.425662825677215, 39.003793075703975, 26.234005874429556, 135.05600814746953, 129.1710355654599, 73.74298937087278, 42.63875463513758, 7.978966565270975, 77.23767230396402, 10.45406088622579, 72.96023165380726, 53.26833581409377, 8.922847735166537, 115.07958802332853, 82.84593483470809, 55.8049420318424, 70.13491132665337, 75.06567148505404, 40.90179451214381, 97.12074302036885, 28.70553817350229, 44.13871473566799, 204.35791598362135, 69.4368524661519, 103.66413789131923, 139.37132417395023, 231.4607337022247, 71.56936637480582, 36.232542994627075, 12.324606777397824, 75.39252420114623, 42.75292933351208, 54.080607185588654, 54.99846430079764, 44.40843425963911, 86.77580041664113, 76.7803795481649, 6.5253278077250805, 9.524916184191188, 134.92062919330746, 38.37692725684402, 22.163158723573705, 36.532725772164206, 138.1200979863739, 61.27902833167042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.840069976204994, "mean_inference_ms": 2.7166035180688493, "mean_action_processing_ms": 0.3664079515386287, "mean_env_wait_ms": 0.30197383344108153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005364537239074707, "StateBufferConnector_ms": 0.004278421401977539, "ViewRequirementAgentConnector_ms": 0.1150282621383667}, "num_episodes": 22, "episode_return_max": 332.46502590694786, "episode_return_min": -137.16220873704663, "episode_return_mean": 107.77032627198213, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.5349037585151, "num_env_steps_trained_throughput_per_sec": 336.5349037585151, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 14288.714, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14288.639, "sample_time_ms": 1894.351, "learn_time_ms": 12372.616, "learn_throughput": 323.295, "synch_weights_time_ms": 18.697}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "6c58f_00000", "date": "2024-08-16_16-26-12", "timestamp": 1723805772, "time_this_iter_s": 11.892385244369507, "time_total_s": 1154.4825475215912, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05028b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1154.4825475215912, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 44.435294117647054, "ram_util_percent": 72.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.461461542507328, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.146076460237857, "policy_loss": -0.010620294518216892, "vf_loss": 7.15463621300995, "vf_explained_var": 0.010761815751040424, "kl": 0.01447196135796874, "entropy": 1.4202890529834404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.123687684157538, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.512529789455353, "policy_loss": -0.00529167939460388, "vf_loss": 6.51781816381626, "vf_explained_var": -0.1300655863903187, "kl": 0.008443755902793578, "entropy": 1.304814105059104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 332.46502590694786, "episode_reward_min": -137.16220873704663, "episode_reward_mean": 119.03357466387322, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.42003356320186, "predator_policy": 1.7408792179789145}, "policy_reward_max": {"prey_policy": 159.9060235360905, "predator_policy": 294.6867238151196}, "policy_reward_mean": {"prey_policy": -27.547041444959643, "predator_policy": 87.06382877689623}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.1437571421519, 137.52907027403123, 86.4075932922214, 34.04000000000001, 6.025000930910341, 19.43903616662858, 15.653334728787767, 113.2696427539347, -137.16220873704663, 128.28040203876364, 23.44327370616823, 110.66422705120434, 303.272003785416, 152.68226890143256, 62.85297223919057, 249.02891913128352, 135.45999999999995, 74.21797668729315, 3.8099999999999623, 132.1148609129861, 104.45296492886429, 223.14743874220756, 63.87000000000006, 50.669999999999504, 222.56669301185062, 132.03754913713414, 162.5947332838875, 3.5201123535201453, 80.5315344051194, 283.90370049278954, 12.289999999999933, 28.16000000000044, 124.58886959081578, 55.72068294179895, 62.650699806353, 274.70998369683673, 117.70883959719283, 32.44353728529495, 46.35091062475467, 227.60612917664685, 140.95413709244588, 26.57000000000019, 80.7400000000008, 278.42229381119205, 49.63106474614593, 98.06147887435208, 99.84905862565992, 136.85432122626077, 165.00999999999976, 133.05000000000035, -0.9726734177674266, 142.01803478560697, -1.4879487740863047, 37.80142611516893, 32.17000000000035, 31.28176992246238, 0.7741569452429118, 122.68000000000028, 172.04439894498893, 249.67108931943164, 162.19233485175113, 115.75281587745899, 265.1716988221529, 163.72999999999996, 279.8795152084049, 151.0900000000001, 29.936381171732936, 141.73000000000025, 221.82690305200208, 296.98866425008265, 81.22621284466679, 3.3199999999999723, 133.49863814522064, 30.41146557300738, 3.489999999999969, 202.22440412619437, 58.89999999999959, 90.214722190248, 3.8299999999999628, 119.0388309283437, 332.46502590694786, 135.20000000000027, 69.90224615157939, 104.47121434784674, 59.72000000000006, 290.1245820707127, 183.84332875053138, 88.8276569917643, 107.77221411549463, 166.45812973743705, 318.4080413125947, 86.19634272654886, 237.94832768148706, 161.18589434936604, 243.52988601204655, 46.05000000000003, 146.08545338319558, 42.48341824960781, 132.64050829541603, 132.77349096595086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.693131197582204, -137.06511973240967, -235.83343423320179, -11.958726491218044, -20.540397620986845, -43.3258841077885, -204.97178668449632, -52.14840103492447, -12.966093480729437, -53.72279381631427, -98.43454297692362, -84.37214589546613, -30.460127822191073, -6.446682258970026, -42.572642261955245, -94.05192347547077, -194.06346373631126, -210.40699509134245, -2.949156170344917, 40.01813916562172, -141.0766973933338, -19.625169299082117, 80.24300263260588, -109.19813058483167, -5.694764633585061, -69.00478117454726, -27.85460138875369, 63.583066002620164, -40.99509902665855, -61.93435615174553, -251.88271317607916, -37.67008428719922, -170.4624181159939, 50.18015830066123, 11.606393485436254, -2.604997395439251, -19.227028456536424, -3.5913814283357794, -109.24835734111349, -51.79623963883398, -53.44915482606615, -127.07917711503444, -263.4661175872431, 133.49913827474836, 7.72292585554435, 3.30833320685007, -63.966135224381276, -110.01228767493267, -132.72626729671458, -109.20720434054519, 76.61293287921, -18.224693086174216, 37.26369143965841, -75.56853274970612, -80.30183881582846, 0.10923313554126454, -57.77401488936641, 37.00907204055976, 146.66789090156465, 67.65700403045882, -20.240179967235562, -67.01190862498075, -27.512518005267268, -54.32675121950036, -101.34928622699958, -90.5649431106205, 39.095475944414474, -63.34080001200388, -16.723631094841743, 6.834294140636999, -39.966516375743225, 141.92673393974601, -26.041965801369802, -40.19434122774656, -67.22658027394736, -176.62321940119682, -10.193050115183455, -79.973065306996, 158.4207544427391, 0.23310590910189827, 68.79093940379447, -45.04198300640215, -60.02868939158485, -262.41730800148724, -103.67622625312084, -10.715347401808653, 31.67039468035275, 55.497174323922756, -12.942972220085036, -75.55939509680209, 19.23880192138269, -68.17842568306915, -63.70595261335815, 7.7590813223498785, -3.8662881397730375, 10.733306372240763, -16.210352866235425, 128.87504829940747, -40.64102932928161, 69.48700826945846, -12.42398940747359, -142.60818191488175, 86.20122953792438, -3.072969920095365, -71.29767935659324, -152.64138841891076, -7.348615984154403, -168.256687352199, -26.002604043454603, -39.66403932602649, -59.43994837562385, -3.081077488977309, -169.17418823888005, -40.63967770842676, 11.168007586197778, -52.053976979557454, 78.00584158127069, -41.49285017935661, 71.58704239262292, 121.00300445476242, 108.41254508946503, -11.458009187847338, -94.55866198710488, -53.91556584836639, 50.044800810869226, 98.74515400527342, 154.3210334347291, -75.80767230396343, 141.75617744700483, 54.70904522136749, 95.91166418590626, -7.012847735166577, -55.61144406731321, -112.37769761899054, -54.19494203184271, 69.98508867334665, 53.98795588291204, 51.871481171892796, 66.77042829580328, 104.39195476040841, -77.79808566584747, -89.47233220877524, -19.280291875662158, -150.5006984818098, 50.086613832246364, -287.42003356320186, -75.20912178255675, -2.1813220138685265, -9.327577836676234, -74.89955314186707, 131.44663975381116, -26.055772146716464, 2.111535699202369, -42.618434259639464, -9.193861134271422, -64.14759664028611, -4.595327807725122, -7.624916184191228, -80.18229557267348, 25.923570050865703, 147.5950597201597, 126.17408169105049, -137.0100979863746, 72.8109716683296, -32.01322048313099, -212.72712657960247, 1.0445516350911739, -134.5961771664452, -84.87173596719308, -107.34332999486995, 128.91779564240807, 58.39054352703074, 27.396193066073597, 1.0878687069301567, -41.35153898181501, -4.790594567391271, 2.740719443677734, -2.5416864077884105, -80.76670581399671, -232.44362798461563, 159.9060235360905, 79.43695376496086, -41.404200158495804, -202.729791608572, 79.31406866277808, 78.54013534217836, -51.036402145831936, -113.56272042329296, 69.36419216241927, 41.60365177914006, -15.20565541700105, -150.08278951919252, -50.68163069690999, 90.04202468439314, -5.842013610593857, -225.3170742086859, -30.03654093312511, 18.669803612814825, -3.9348207544934493, 18.902993327756963], "policy_predator_policy_reward": [272.13967302584155, 176.76233504630278, 294.6867238151196, 90.63450718333056, 85.0197092901795, 65.2541657308161, 205.80178668449588, 85.35840103492424, 51.65467898198029, 21.059209245973477, 120.34558033079436, 81.90014470822503, 29.902252234123623, 22.657892575825564, 96.37798063045024, 153.51622786091008, 259.4695745607004, 7.838675529905631, 44.80756984869097, 46.40384919479542, 141.35121404663843, 42.793926351944165, 17.758424885590117, 121.86093011784034, 217.2250643614279, 160.74648523212065, 81.04217864891737, 35.91162563864886, 73.2250773306922, 92.55735008690239, 284.70062360785175, 253.88109298671063, 171.602418115993, 84.13984169933872, 53.49315774376501, 11.723422853530128, 21.097028456536716, 5.531381428335748, 123.07832870919404, 170.08112918373976, 168.57828139207427, 116.4030154778897, 244.98981552088122, 108.12460253382095, 27.814032099783137, 25.024708837822452, 110.85342758506823, 113.79499531424679, 260.46507838316325, 204.03508626594692, 43.94706712079014, 29.70224222330881, 123.79104184422916, 77.10853274970604, 81.97183881582933, 1.7408792179789145, 56.63237191555696, 44.66410533836785, 36.355901088997285, 33.22290447176974, 16.148693725879223, 83.39339486633776, 7.938678659008676, 102.06059056575879, 168.80486557468402, 147.6982333537517, 28.944628603833262, 51.02137840555497, 29.814679716846815, 42.72535704371165, 96.53269835292919, 76.21706777990529, 65.57430460570173, 118.37084202060784, 96.09056335646665, 180.20277360397134, 61.76099612693073, 74.75602992000367, 32.45231577310297, 36.4999530517038, 15.96211620729921, 101.24306448775641, 86.12868939158462, 262.88730800148716, 187.844115009927, 7.287458645002822, 52.17727404682427, 139.07745076009272, 41.09769274990425, 97.03573931312974, 83.39652402623126, 63.60457860980727, 76.26304853801959, 79.5328813786473, 10.082326242129644, 119.90497675166408, 18.010352866235685, 34.33495170059257, 42.49102932928124, 61.71299173054154, 95.69745454343835, 58.36204336114831, 25.553248179523774, 33.33652698825377, 133.7393878923262, 88.7117311090907, 84.21175049710823, 129.1949789544135, 27.772604043454752, 70.06403932602623, 47.05757734448491, 46.745218442577716, 11.027796624090163, 199.56022626845848, 109.88199241380224, 53.68397697955713, 64.18207987370018, 71.34932766937487, 34.655379646369994, 22.425662825677215, 39.003793075703975, 26.234005874429556, 135.05600814746953, 129.1710355654599, 73.74298937087278, 42.63875463513758, 7.978966565270975, 77.23767230396402, 10.45406088622579, 72.96023165380726, 53.26833581409377, 8.922847735166537, 115.07958802332853, 82.84593483470809, 55.8049420318424, 70.13491132665337, 75.06567148505404, 40.90179451214381, 97.12074302036885, 28.70553817350229, 44.13871473566799, 204.35791598362135, 69.4368524661519, 103.66413789131923, 139.37132417395023, 231.4607337022247, 71.56936637480582, 36.232542994627075, 12.324606777397824, 75.39252420114623, 42.75292933351208, 54.080607185588654, 54.99846430079764, 44.40843425963911, 86.77580041664113, 76.7803795481649, 6.5253278077250805, 9.524916184191188, 134.92062919330746, 38.37692725684402, 22.163158723573705, 36.532725772164206, 138.1200979863739, 61.27902833167042, 93.82735477594987, 220.81523843836263, 109.17850126949334, 128.84433860970728, 86.29173596719373, 165.64332999487007, 28.808103166558805, 74.00813973471529, 133.9649733861517, 21.39429359137653, 29.25529721144857, 105.71449332952157, 101.38928055632228, 6.183900523282549, 213.98439957159053, 265.68406396445846, 26.45536627679407, 52.609697734749346, 147.04044172678806, 183.28989276682825, 64.5187605350878, 15.575363141443425, 157.70501295073106, 168.0800039677598, 94.76463120938077, 37.79741086110671, 17.085655417001156, 194.25278951919262, 44.18475410385493, 62.540305291857194, 18.245431860201776, 255.39707420868592, 39.40720463618043, 104.60004097954591, 49.744086331212905, 68.0612320614737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8379387710780533, "mean_inference_ms": 2.71394028349319, "mean_action_processing_ms": 0.3658203757995452, "mean_env_wait_ms": 0.3012651998774752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004449009895324707, "StateBufferConnector_ms": 0.0039577484130859375, "ViewRequirementAgentConnector_ms": 0.10820353031158447}, "num_episodes": 18, "episode_return_max": 332.46502590694786, "episode_return_min": -137.16220873704663, "episode_return_mean": 119.03357466387322, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.8841544962812, "num_env_steps_trained_throughput_per_sec": 333.8841544962812, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 14044.085, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14044.012, "sample_time_ms": 1847.341, "learn_time_ms": 12175.384, "learn_throughput": 328.532, "synch_weights_time_ms": 18.479}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "6c58f_00000", "date": "2024-08-16_16-26-24", "timestamp": 1723805784, "time_this_iter_s": 11.987541913986206, "time_total_s": 1166.4700894355774, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1166.4700894355774, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 44.705882352941174, "ram_util_percent": 73.54705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4785492427292324, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.668295961965328, "policy_loss": -0.006720568762757081, "vf_loss": 7.673223756103919, "vf_explained_var": 0.00361095458742172, "kl": 0.0125912679097361, "entropy": 1.3620304870857765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8418504767632358, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.316819130932843, "policy_loss": -0.005519361100923368, "vf_loss": 6.32233476008057, "vf_explained_var": -0.1353910742928742, "kl": 0.009527190415270002, "entropy": 1.3165942620348048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 332.46502590694786, "episode_reward_min": -23.86432943547691, "episode_reward_mean": 117.15744221790081, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.42003356320186, "predator_policy": 1.7408792179789145}, "policy_reward_max": {"prey_policy": 159.9060235360905, "predator_policy": 328.8888352496832}, "policy_reward_mean": {"prey_policy": -32.592835416328406, "predator_policy": 91.17155652527879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.669999999999504, 222.56669301185062, 132.03754913713414, 162.5947332838875, 3.5201123535201453, 80.5315344051194, 283.90370049278954, 12.289999999999933, 28.16000000000044, 124.58886959081578, 55.72068294179895, 62.650699806353, 274.70998369683673, 117.70883959719283, 32.44353728529495, 46.35091062475467, 227.60612917664685, 140.95413709244588, 26.57000000000019, 80.7400000000008, 278.42229381119205, 49.63106474614593, 98.06147887435208, 99.84905862565992, 136.85432122626077, 165.00999999999976, 133.05000000000035, -0.9726734177674266, 142.01803478560697, -1.4879487740863047, 37.80142611516893, 32.17000000000035, 31.28176992246238, 0.7741569452429118, 122.68000000000028, 172.04439894498893, 249.67108931943164, 162.19233485175113, 115.75281587745899, 265.1716988221529, 163.72999999999996, 279.8795152084049, 151.0900000000001, 29.936381171732936, 141.73000000000025, 221.82690305200208, 296.98866425008265, 81.22621284466679, 3.3199999999999723, 133.49863814522064, 30.41146557300738, 3.489999999999969, 202.22440412619437, 58.89999999999959, 90.214722190248, 3.8299999999999628, 119.0388309283437, 332.46502590694786, 135.20000000000027, 69.90224615157939, 104.47121434784674, 59.72000000000006, 290.1245820707127, 183.84332875053138, 88.8276569917643, 107.77221411549463, 166.45812973743705, 318.4080413125947, 86.19634272654886, 237.94832768148706, 161.18589434936604, 243.52988601204655, 46.05000000000003, 146.08545338319558, 42.48341824960781, 132.64050829541603, 132.77349096595086, 132.66605566882296, 169.78781510988367, 71.84890666336939, 243.0551187003961, 3.929999999999961, 292.8642209168955, 104.04754807293156, 75.18540359079037, 71.76158144943066, 165.39047125055473, 16.604720367671124, -23.86432943547691, 75.60848528930423, 143.83309263740253, 118.72000000000041, -3.017374194646402, 3.4099999999999726, 116.47254996803129, -2.623555749182156, 122.35665247031567, -6.205384558042709, 110.8534267942807, 159.34388506644962], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-63.966135224381276, -110.01228767493267, -132.72626729671458, -109.20720434054519, 76.61293287921, -18.224693086174216, 37.26369143965841, -75.56853274970612, -80.30183881582846, 0.10923313554126454, -57.77401488936641, 37.00907204055976, 146.66789090156465, 67.65700403045882, -20.240179967235562, -67.01190862498075, -27.512518005267268, -54.32675121950036, -101.34928622699958, -90.5649431106205, 39.095475944414474, -63.34080001200388, -16.723631094841743, 6.834294140636999, -39.966516375743225, 141.92673393974601, -26.041965801369802, -40.19434122774656, -67.22658027394736, -176.62321940119682, -10.193050115183455, -79.973065306996, 158.4207544427391, 0.23310590910189827, 68.79093940379447, -45.04198300640215, -60.02868939158485, -262.41730800148724, -103.67622625312084, -10.715347401808653, 31.67039468035275, 55.497174323922756, -12.942972220085036, -75.55939509680209, 19.23880192138269, -68.17842568306915, -63.70595261335815, 7.7590813223498785, -3.8662881397730375, 10.733306372240763, -16.210352866235425, 128.87504829940747, -40.64102932928161, 69.48700826945846, -12.42398940747359, -142.60818191488175, 86.20122953792438, -3.072969920095365, -71.29767935659324, -152.64138841891076, -7.348615984154403, -168.256687352199, -26.002604043454603, -39.66403932602649, -59.43994837562385, -3.081077488977309, -169.17418823888005, -40.63967770842676, 11.168007586197778, -52.053976979557454, 78.00584158127069, -41.49285017935661, 71.58704239262292, 121.00300445476242, 108.41254508946503, -11.458009187847338, -94.55866198710488, -53.91556584836639, 50.044800810869226, 98.74515400527342, 154.3210334347291, -75.80767230396343, 141.75617744700483, 54.70904522136749, 95.91166418590626, -7.012847735166577, -55.61144406731321, -112.37769761899054, -54.19494203184271, 69.98508867334665, 53.98795588291204, 51.871481171892796, 66.77042829580328, 104.39195476040841, -77.79808566584747, -89.47233220877524, -19.280291875662158, -150.5006984818098, 50.086613832246364, -287.42003356320186, -75.20912178255675, -2.1813220138685265, -9.327577836676234, -74.89955314186707, 131.44663975381116, -26.055772146716464, 2.111535699202369, -42.618434259639464, -9.193861134271422, -64.14759664028611, -4.595327807725122, -7.624916184191228, -80.18229557267348, 25.923570050865703, 147.5950597201597, 126.17408169105049, -137.0100979863746, 72.8109716683296, -32.01322048313099, -212.72712657960247, 1.0445516350911739, -134.5961771664452, -84.87173596719308, -107.34332999486995, 128.91779564240807, 58.39054352703074, 27.396193066073597, 1.0878687069301567, -41.35153898181501, -4.790594567391271, 2.740719443677734, -2.5416864077884105, -80.76670581399671, -232.44362798461563, 159.9060235360905, 79.43695376496086, -41.404200158495804, -202.729791608572, 79.31406866277808, 78.54013534217836, -51.036402145831936, -113.56272042329296, 69.36419216241927, 41.60365177914006, -15.20565541700105, -150.08278951919252, -50.68163069690999, 90.04202468439314, -5.842013610593857, -225.3170742086859, -30.03654093312511, 18.669803612814825, -3.9348207544934493, 18.902993327756963, -86.70896035228711, -186.92199387907104, 88.95634819938861, -110.72513903723538, -200.83739949093962, -214.3309244501849, -213.61675802661932, 101.20088833733644, -1.5327969491160676, -2.535582279803396, -141.7397920082722, 141.41303217839413, -255.70118395726755, -99.18193168412778, -76.58357264450207, -265.8542598202726, -54.029224539768855, -136.04569359576516, -83.52496819317726, 108.65734609292443, -45.92670706755824, -69.96575614435524, -32.16507404129754, -44.45173521704442, -89.10773231212013, -139.17366583694925, -9.210718684779676, 64.62606216536014, 26.58349147387719, -56.0715726482916, -193.2065957821989, -258.14515113473607, -17.257343106011845, -81.81456848445308, -37.1795390203339, -53.607850032099826, -38.30107394514814, -10.012388497020448, -21.073600874615924, -24.982307389093563, -218.7458257746595, -203.11990189823237, -232.66730459543433, -56.115627933707906, -19.307502546019055, -175.7997990314142], "policy_predator_policy_reward": [110.85342758506823, 113.79499531424679, 260.46507838316325, 204.03508626594692, 43.94706712079014, 29.70224222330881, 123.79104184422916, 77.10853274970604, 81.97183881582933, 1.7408792179789145, 56.63237191555696, 44.66410533836785, 36.355901088997285, 33.22290447176974, 16.148693725879223, 83.39339486633776, 7.938678659008676, 102.06059056575879, 168.80486557468402, 147.6982333537517, 28.944628603833262, 51.02137840555497, 29.814679716846815, 42.72535704371165, 96.53269835292919, 76.21706777990529, 65.57430460570173, 118.37084202060784, 96.09056335646665, 180.20277360397134, 61.76099612693073, 74.75602992000367, 32.45231577310297, 36.4999530517038, 15.96211620729921, 101.24306448775641, 86.12868939158462, 262.88730800148716, 187.844115009927, 7.287458645002822, 52.17727404682427, 139.07745076009272, 41.09769274990425, 97.03573931312974, 83.39652402623126, 63.60457860980727, 76.26304853801959, 79.5328813786473, 10.082326242129644, 119.90497675166408, 18.010352866235685, 34.33495170059257, 42.49102932928124, 61.71299173054154, 95.69745454343835, 58.36204336114831, 25.553248179523774, 33.33652698825377, 133.7393878923262, 88.7117311090907, 84.21175049710823, 129.1949789544135, 27.772604043454752, 70.06403932602623, 47.05757734448491, 46.745218442577716, 11.027796624090163, 199.56022626845848, 109.88199241380224, 53.68397697955713, 64.18207987370018, 71.34932766937487, 34.655379646369994, 22.425662825677215, 39.003793075703975, 26.234005874429556, 135.05600814746953, 129.1710355654599, 73.74298937087278, 42.63875463513758, 7.978966565270975, 77.23767230396402, 10.45406088622579, 72.96023165380726, 53.26833581409377, 8.922847735166537, 115.07958802332853, 82.84593483470809, 55.8049420318424, 70.13491132665337, 75.06567148505404, 40.90179451214381, 97.12074302036885, 28.70553817350229, 44.13871473566799, 204.35791598362135, 69.4368524661519, 103.66413789131923, 139.37132417395023, 231.4607337022247, 71.56936637480582, 36.232542994627075, 12.324606777397824, 75.39252420114623, 42.75292933351208, 54.080607185588654, 54.99846430079764, 44.40843425963911, 86.77580041664113, 76.7803795481649, 6.5253278077250805, 9.524916184191188, 134.92062919330746, 38.37692725684402, 22.163158723573705, 36.532725772164206, 138.1200979863739, 61.27902833167042, 93.82735477594987, 220.81523843836263, 109.17850126949334, 128.84433860970728, 86.29173596719373, 165.64332999487007, 28.808103166558805, 74.00813973471529, 133.9649733861517, 21.39429359137653, 29.25529721144857, 105.71449332952157, 101.38928055632228, 6.183900523282549, 213.98439957159053, 265.68406396445846, 26.45536627679407, 52.609697734749346, 147.04044172678806, 183.28989276682825, 64.5187605350878, 15.575363141443425, 157.70501295073106, 168.0800039677598, 94.76463120938077, 37.79741086110671, 17.085655417001156, 194.25278951919262, 44.18475410385493, 62.540305291857194, 18.245431860201776, 255.39707420868592, 39.40720463618043, 104.60004097954591, 49.744086331212905, 68.0612320614737, 215.32934500509904, 190.96766489508224, 106.88235343334499, 84.67425251438648, 241.19662354433814, 245.82060706015548, 165.80228633797327, 189.66870205170588, 4.570988587360035, 3.427390641559355, 160.70017139200831, 132.49080935476536, 209.81899843758592, 249.11166527674055, 164.28196801026704, 253.34126804529805, 87.37204731051663, 174.4644522744477, 92.87543944373274, 47.38265390707563, 86.76537782197471, 45.731805757610346, 43.743301441105615, 9.00917838175844, 108.11568434516593, 195.7741990932088, 27.278767396360617, 61.1389817604612, 90.51650852612275, 57.69157264829128, 233.01104136734276, 215.32333135494565, 48.486272267361876, 53.9956393231035, 60.07762147534986, 147.1823175451144, 5.598832747838331, 40.091073945147784, 132.55574308054298, 35.856817653481954, 86.77150786516629, 328.8888352496832, 192.44700968188607, 207.1893496415363, 179.05633326360848, 175.39485338027478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8352334854151071, "mean_inference_ms": 2.705186323239496, "mean_action_processing_ms": 0.3643894152607235, "mean_env_wait_ms": 0.30020458730376887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004169344902038574, "StateBufferConnector_ms": 0.003986477851867676, "ViewRequirementAgentConnector_ms": 0.10312867164611816}, "num_episodes": 23, "episode_return_max": 332.46502590694786, "episode_return_min": -23.86432943547691, "episode_return_mean": 117.15744221790081, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.03991488708556, "num_env_steps_trained_throughput_per_sec": 328.03991488708556, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 13805.087, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13805.035, "sample_time_ms": 1808.683, "learn_time_ms": 11977.427, "learn_throughput": 333.962, "synch_weights_time_ms": 16.38}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "6c58f_00000", "date": "2024-08-16_16-26-37", "timestamp": 1723805797, "time_this_iter_s": 12.200111150741577, "time_total_s": 1178.670200586319, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33e7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1178.670200586319, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 45.54705882352941, "ram_util_percent": 73.87647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3201785008427958, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 6.48929509788594, "policy_loss": -0.00598555696024387, "vf_loss": 6.493734003248669, "vf_explained_var": 0.0018251719613554616, "kl": 0.010862625755107833, "entropy": 1.35530713462325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.682246851605713, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 4.790626607874714, "policy_loss": -0.005853506558446618, "vf_loss": 4.796476718483778, "vf_explained_var": -0.18673523689703966, "kl": 0.008708662290685714, "entropy": 1.338367344714977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 332.46502590694786, "episode_reward_min": -38.63818925318994, "episode_reward_mean": 113.65776914508028, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -287.42003356320186, "predator_policy": 0.7588144912698755}, "policy_reward_max": {"prey_policy": 162.65627343134156, "predator_policy": 328.8888352496832}, "policy_reward_mean": {"prey_policy": -39.735443967852945, "predator_policy": 96.56432854039303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.57000000000019, 80.7400000000008, 278.42229381119205, 49.63106474614593, 98.06147887435208, 99.84905862565992, 136.85432122626077, 165.00999999999976, 133.05000000000035, -0.9726734177674266, 142.01803478560697, -1.4879487740863047, 37.80142611516893, 32.17000000000035, 31.28176992246238, 0.7741569452429118, 122.68000000000028, 172.04439894498893, 249.67108931943164, 162.19233485175113, 115.75281587745899, 265.1716988221529, 163.72999999999996, 279.8795152084049, 151.0900000000001, 29.936381171732936, 141.73000000000025, 221.82690305200208, 296.98866425008265, 81.22621284466679, 3.3199999999999723, 133.49863814522064, 30.41146557300738, 3.489999999999969, 202.22440412619437, 58.89999999999959, 90.214722190248, 3.8299999999999628, 119.0388309283437, 332.46502590694786, 135.20000000000027, 69.90224615157939, 104.47121434784674, 59.72000000000006, 290.1245820707127, 183.84332875053138, 88.8276569917643, 107.77221411549463, 166.45812973743705, 318.4080413125947, 86.19634272654886, 237.94832768148706, 161.18589434936604, 243.52988601204655, 46.05000000000003, 146.08545338319558, 42.48341824960781, 132.64050829541603, 132.77349096595086, 132.66605566882296, 169.78781510988367, 71.84890666336939, 243.0551187003961, 3.929999999999961, 292.8642209168955, 104.04754807293156, 75.18540359079037, 71.76158144943066, 165.39047125055473, 16.604720367671124, -23.86432943547691, 75.60848528930423, 143.83309263740253, 118.72000000000041, -3.017374194646402, 3.4099999999999726, 116.47254996803129, -2.623555749182156, 122.35665247031567, -6.205384558042709, 110.8534267942807, 159.34388506644962, 82.8029159138163, 173.86537725220222, -2.2048170053401073, 106.51741204616997, 175.72781570442092, 3.47999999999997, -38.63818925318994, 2.756087833390453, 108.77438464753371, 107.78138786802623, 157.10000000000008, 156.3610100757208, 163.07804293467638, 145.53667564789617, 129.774112069328, 3.799999999999963, 173.05999999999983, 59.468589479738775], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-60.02868939158485, -262.41730800148724, -103.67622625312084, -10.715347401808653, 31.67039468035275, 55.497174323922756, -12.942972220085036, -75.55939509680209, 19.23880192138269, -68.17842568306915, -63.70595261335815, 7.7590813223498785, -3.8662881397730375, 10.733306372240763, -16.210352866235425, 128.87504829940747, -40.64102932928161, 69.48700826945846, -12.42398940747359, -142.60818191488175, 86.20122953792438, -3.072969920095365, -71.29767935659324, -152.64138841891076, -7.348615984154403, -168.256687352199, -26.002604043454603, -39.66403932602649, -59.43994837562385, -3.081077488977309, -169.17418823888005, -40.63967770842676, 11.168007586197778, -52.053976979557454, 78.00584158127069, -41.49285017935661, 71.58704239262292, 121.00300445476242, 108.41254508946503, -11.458009187847338, -94.55866198710488, -53.91556584836639, 50.044800810869226, 98.74515400527342, 154.3210334347291, -75.80767230396343, 141.75617744700483, 54.70904522136749, 95.91166418590626, -7.012847735166577, -55.61144406731321, -112.37769761899054, -54.19494203184271, 69.98508867334665, 53.98795588291204, 51.871481171892796, 66.77042829580328, 104.39195476040841, -77.79808566584747, -89.47233220877524, -19.280291875662158, -150.5006984818098, 50.086613832246364, -287.42003356320186, -75.20912178255675, -2.1813220138685265, -9.327577836676234, -74.89955314186707, 131.44663975381116, -26.055772146716464, 2.111535699202369, -42.618434259639464, -9.193861134271422, -64.14759664028611, -4.595327807725122, -7.624916184191228, -80.18229557267348, 25.923570050865703, 147.5950597201597, 126.17408169105049, -137.0100979863746, 72.8109716683296, -32.01322048313099, -212.72712657960247, 1.0445516350911739, -134.5961771664452, -84.87173596719308, -107.34332999486995, 128.91779564240807, 58.39054352703074, 27.396193066073597, 1.0878687069301567, -41.35153898181501, -4.790594567391271, 2.740719443677734, -2.5416864077884105, -80.76670581399671, -232.44362798461563, 159.9060235360905, 79.43695376496086, -41.404200158495804, -202.729791608572, 79.31406866277808, 78.54013534217836, -51.036402145831936, -113.56272042329296, 69.36419216241927, 41.60365177914006, -15.20565541700105, -150.08278951919252, -50.68163069690999, 90.04202468439314, -5.842013610593857, -225.3170742086859, -30.03654093312511, 18.669803612814825, -3.9348207544934493, 18.902993327756963, -86.70896035228711, -186.92199387907104, 88.95634819938861, -110.72513903723538, -200.83739949093962, -214.3309244501849, -213.61675802661932, 101.20088833733644, -1.5327969491160676, -2.535582279803396, -141.7397920082722, 141.41303217839413, -255.70118395726755, -99.18193168412778, -76.58357264450207, -265.8542598202726, -54.029224539768855, -136.04569359576516, -83.52496819317726, 108.65734609292443, -45.92670706755824, -69.96575614435524, -32.16507404129754, -44.45173521704442, -89.10773231212013, -139.17366583694925, -9.210718684779676, 64.62606216536014, 26.58349147387719, -56.0715726482916, -193.2065957821989, -258.14515113473607, -17.257343106011845, -81.81456848445308, -37.1795390203339, -53.607850032099826, -38.30107394514814, -10.012388497020448, -21.073600874615924, -24.982307389093563, -218.7458257746595, -203.11990189823237, -232.66730459543433, -56.115627933707906, -19.307502546019055, -175.7997990314142, -275.2468356704001, -41.530398153682, -52.557041658236926, -152.39735596076468, -27.63404105442602, -57.024349839880706, -6.218168567497015, -38.57596594354712, -230.80084661586105, 60.22990865201728, -9.588054769169489, -45.890396380314385, -68.84106531095871, -109.71156840763072, -30.756327206070548, -2.4855464529837183, -48.09341937024208, -188.84387298680386, -181.61374438309517, -12.526660556993255, -6.4242686076548505, 121.33082558958198, -250.96704348576918, -10.276579844018988, -183.3953769520608, -13.097438649135647, 2.6339953936449128, -85.15005756521431, -87.71118690615144, -3.8566168409393002, -2.0854352413048316, -14.732848944235636, -18.399508955475447, 162.65627343134156, -178.57093604898097, -133.86034168225305], "policy_predator_policy_reward": [86.12868939158462, 262.88730800148716, 187.844115009927, 7.287458645002822, 52.17727404682427, 139.07745076009272, 41.09769274990425, 97.03573931312974, 83.39652402623126, 63.60457860980727, 76.26304853801959, 79.5328813786473, 10.082326242129644, 119.90497675166408, 18.010352866235685, 34.33495170059257, 42.49102932928124, 61.71299173054154, 95.69745454343835, 58.36204336114831, 25.553248179523774, 33.33652698825377, 133.7393878923262, 88.7117311090907, 84.21175049710823, 129.1949789544135, 27.772604043454752, 70.06403932602623, 47.05757734448491, 46.745218442577716, 11.027796624090163, 199.56022626845848, 109.88199241380224, 53.68397697955713, 64.18207987370018, 71.34932766937487, 34.655379646369994, 22.425662825677215, 39.003793075703975, 26.234005874429556, 135.05600814746953, 129.1710355654599, 73.74298937087278, 42.63875463513758, 7.978966565270975, 77.23767230396402, 10.45406088622579, 72.96023165380726, 53.26833581409377, 8.922847735166537, 115.07958802332853, 82.84593483470809, 55.8049420318424, 70.13491132665337, 75.06567148505404, 40.90179451214381, 97.12074302036885, 28.70553817350229, 44.13871473566799, 204.35791598362135, 69.4368524661519, 103.66413789131923, 139.37132417395023, 231.4607337022247, 71.56936637480582, 36.232542994627075, 12.324606777397824, 75.39252420114623, 42.75292933351208, 54.080607185588654, 54.99846430079764, 44.40843425963911, 86.77580041664113, 76.7803795481649, 6.5253278077250805, 9.524916184191188, 134.92062919330746, 38.37692725684402, 22.163158723573705, 36.532725772164206, 138.1200979863739, 61.27902833167042, 93.82735477594987, 220.81523843836263, 109.17850126949334, 128.84433860970728, 86.29173596719373, 165.64332999487007, 28.808103166558805, 74.00813973471529, 133.9649733861517, 21.39429359137653, 29.25529721144857, 105.71449332952157, 101.38928055632228, 6.183900523282549, 213.98439957159053, 265.68406396445846, 26.45536627679407, 52.609697734749346, 147.04044172678806, 183.28989276682825, 64.5187605350878, 15.575363141443425, 157.70501295073106, 168.0800039677598, 94.76463120938077, 37.79741086110671, 17.085655417001156, 194.25278951919262, 44.18475410385493, 62.540305291857194, 18.245431860201776, 255.39707420868592, 39.40720463618043, 104.60004097954591, 49.744086331212905, 68.0612320614737, 215.32934500509904, 190.96766489508224, 106.88235343334499, 84.67425251438648, 241.19662354433814, 245.82060706015548, 165.80228633797327, 189.66870205170588, 4.570988587360035, 3.427390641559355, 160.70017139200831, 132.49080935476536, 209.81899843758592, 249.11166527674055, 164.28196801026704, 253.34126804529805, 87.37204731051663, 174.4644522744477, 92.87543944373274, 47.38265390707563, 86.76537782197471, 45.731805757610346, 43.743301441105615, 9.00917838175844, 108.11568434516593, 195.7741990932088, 27.278767396360617, 61.1389817604612, 90.51650852612275, 57.69157264829128, 233.01104136734276, 215.32333135494565, 48.486272267361876, 53.9956393231035, 60.07762147534986, 147.1823175451144, 5.598832747838331, 40.091073945147784, 132.55574308054298, 35.856817653481954, 86.77150786516629, 328.8888352496832, 192.44700968188607, 207.1893496415363, 179.05633326360848, 175.39485338027478, 258.61364436730065, 140.96650537059742, 191.63766573994383, 187.18210913125975, 21.990642720497664, 60.462931168468984, 37.505641810528765, 113.80590474668512, 166.36376481786976, 179.9349888503949, 11.518054769169447, 47.44039638031409, 106.23840989970817, 33.67603456569284, 32.596327206070676, 3.4016342863741444, 216.56798698984957, 129.1436900147293, 137.19381049947492, 164.72798230863947, 8.34426860765481, 33.849174410418044, 229.191314275698, 188.41331912981133, 162.11648810119473, 197.4543704346778, 156.97977883757142, 71.07295898189419, 151.5972175701164, 69.74469824630194, 19.807841927295755, 0.8104422582447013, 28.04442103286432, 0.7588144912698755, 145.07251465149102, 226.82735255948157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8330644078602677, "mean_inference_ms": 2.698266147079348, "mean_action_processing_ms": 0.36328570658032533, "mean_env_wait_ms": 0.2993900722572151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007665872573852539, "StateBufferConnector_ms": 0.0038062334060668945, "ViewRequirementAgentConnector_ms": 0.11055386066436768}, "num_episodes": 18, "episode_return_max": 332.46502590694786, "episode_return_min": -38.63818925318994, "episode_return_mean": 113.65776914508028, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.10481185100593, "num_env_steps_trained_throughput_per_sec": 326.10481185100593, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13496.055, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13496.007, "sample_time_ms": 1688.823, "learn_time_ms": 11789.654, "learn_throughput": 339.281, "synch_weights_time_ms": 15.135}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "6c58f_00000", "date": "2024-08-16_16-26-49", "timestamp": 1723805809, "time_this_iter_s": 12.270853042602539, "time_total_s": 1190.9410536289215, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b342b670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1190.9410536289215, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.49444444444445, "ram_util_percent": 74.35555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1252328864796453, "cur_kl_coeff": 0.14238281249999993, "cur_lr": 1e-05, "total_loss": 7.250173525835471, "policy_loss": -0.0029946445482512, "vf_loss": 7.252542197262799, "vf_explained_var": 0.0012037016096569243, "kl": 0.0043962973559409325, "entropy": 1.358437600148418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6817650235834576, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 5.700503489327809, "policy_loss": -0.007144272705865285, "vf_loss": 5.7076428420959955, "vf_explained_var": -0.06852514598735426, "kl": 0.012573560245555386, "entropy": 1.293111100020232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 332.46502590694786, "episode_reward_min": -38.63818925318994, "episode_reward_mean": 118.89433818393209, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -327.57050069055447, "predator_policy": 0.7588144912698755}, "policy_reward_max": {"prey_policy": 162.65627343134156, "predator_policy": 328.8888352496832}, "policy_reward_mean": {"prey_policy": -49.32324729322455, "predator_policy": 108.77041638519059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.72999999999996, 279.8795152084049, 151.0900000000001, 29.936381171732936, 141.73000000000025, 221.82690305200208, 296.98866425008265, 81.22621284466679, 3.3199999999999723, 133.49863814522064, 30.41146557300738, 3.489999999999969, 202.22440412619437, 58.89999999999959, 90.214722190248, 3.8299999999999628, 119.0388309283437, 332.46502590694786, 135.20000000000027, 69.90224615157939, 104.47121434784674, 59.72000000000006, 290.1245820707127, 183.84332875053138, 88.8276569917643, 107.77221411549463, 166.45812973743705, 318.4080413125947, 86.19634272654886, 237.94832768148706, 161.18589434936604, 243.52988601204655, 46.05000000000003, 146.08545338319558, 42.48341824960781, 132.64050829541603, 132.77349096595086, 132.66605566882296, 169.78781510988367, 71.84890666336939, 243.0551187003961, 3.929999999999961, 292.8642209168955, 104.04754807293156, 75.18540359079037, 71.76158144943066, 165.39047125055473, 16.604720367671124, -23.86432943547691, 75.60848528930423, 143.83309263740253, 118.72000000000041, -3.017374194646402, 3.4099999999999726, 116.47254996803129, -2.623555749182156, 122.35665247031567, -6.205384558042709, 110.8534267942807, 159.34388506644962, 82.8029159138163, 173.86537725220222, -2.2048170053401073, 106.51741204616997, 175.72781570442092, 3.47999999999997, -38.63818925318994, 2.756087833390453, 108.77438464753371, 107.78138786802623, 157.10000000000008, 156.3610100757208, 163.07804293467638, 145.53667564789617, 129.774112069328, 3.799999999999963, 173.05999999999983, 59.468589479738775, 137.89319996602703, -6.808379457476006, 124.55559810520118, 253.8818101077877, 129.8379398434289, 112.37937294207585, 172.59758877375126, 155.9602069747424, 124.05313180887428, 4.779999999999941, 151.51183781140907, 133.48454909605596, 131.4614461208265, 280.29634437849023, 120.72466251590906, 187.41070728172534, 78.83200267558212, 149.13999999999996, 136.15000000000035, 222.76608998169596, 3.5899999999999674, 116.44411563509786], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [154.3210334347291, -75.80767230396343, 141.75617744700483, 54.70904522136749, 95.91166418590626, -7.012847735166577, -55.61144406731321, -112.37769761899054, -54.19494203184271, 69.98508867334665, 53.98795588291204, 51.871481171892796, 66.77042829580328, 104.39195476040841, -77.79808566584747, -89.47233220877524, -19.280291875662158, -150.5006984818098, 50.086613832246364, -287.42003356320186, -75.20912178255675, -2.1813220138685265, -9.327577836676234, -74.89955314186707, 131.44663975381116, -26.055772146716464, 2.111535699202369, -42.618434259639464, -9.193861134271422, -64.14759664028611, -4.595327807725122, -7.624916184191228, -80.18229557267348, 25.923570050865703, 147.5950597201597, 126.17408169105049, -137.0100979863746, 72.8109716683296, -32.01322048313099, -212.72712657960247, 1.0445516350911739, -134.5961771664452, -84.87173596719308, -107.34332999486995, 128.91779564240807, 58.39054352703074, 27.396193066073597, 1.0878687069301567, -41.35153898181501, -4.790594567391271, 2.740719443677734, -2.5416864077884105, -80.76670581399671, -232.44362798461563, 159.9060235360905, 79.43695376496086, -41.404200158495804, -202.729791608572, 79.31406866277808, 78.54013534217836, -51.036402145831936, -113.56272042329296, 69.36419216241927, 41.60365177914006, -15.20565541700105, -150.08278951919252, -50.68163069690999, 90.04202468439314, -5.842013610593857, -225.3170742086859, -30.03654093312511, 18.669803612814825, -3.9348207544934493, 18.902993327756963, -86.70896035228711, -186.92199387907104, 88.95634819938861, -110.72513903723538, -200.83739949093962, -214.3309244501849, -213.61675802661932, 101.20088833733644, -1.5327969491160676, -2.535582279803396, -141.7397920082722, 141.41303217839413, -255.70118395726755, -99.18193168412778, -76.58357264450207, -265.8542598202726, -54.029224539768855, -136.04569359576516, -83.52496819317726, 108.65734609292443, -45.92670706755824, -69.96575614435524, -32.16507404129754, -44.45173521704442, -89.10773231212013, -139.17366583694925, -9.210718684779676, 64.62606216536014, 26.58349147387719, -56.0715726482916, -193.2065957821989, -258.14515113473607, -17.257343106011845, -81.81456848445308, -37.1795390203339, -53.607850032099826, -38.30107394514814, -10.012388497020448, -21.073600874615924, -24.982307389093563, -218.7458257746595, -203.11990189823237, -232.66730459543433, -56.115627933707906, -19.307502546019055, -175.7997990314142, -275.2468356704001, -41.530398153682, -52.557041658236926, -152.39735596076468, -27.63404105442602, -57.024349839880706, -6.218168567497015, -38.57596594354712, -230.80084661586105, 60.22990865201728, -9.588054769169489, -45.890396380314385, -68.84106531095871, -109.71156840763072, -30.756327206070548, -2.4855464529837183, -48.09341937024208, -188.84387298680386, -181.61374438309517, -12.526660556993255, -6.4242686076548505, 121.33082558958198, -250.96704348576918, -10.276579844018988, -183.3953769520608, -13.097438649135647, 2.6339953936449128, -85.15005756521431, -87.71118690615144, -3.8566168409393002, -2.0854352413048316, -14.732848944235636, -18.399508955475447, 162.65627343134156, -178.57093604898097, -133.86034168225305, -165.4555054051465, -1.2736217088000081, -80.2744578197738, -35.002319555318834, 22.116778126641815, -4.70038703376712, -172.35030071358008, 99.74547458899752, -278.8489782540247, -14.66986439891257, -104.85392412041034, -3.8037674343963808, -226.14507580243452, -0.9117066404397514, -19.62260842085771, -327.57050069055447, -84.52057308844962, -8.117331070713009, -15.72323907683193, -9.027013398689592, -104.92646271370761, -15.293822679677815, -251.694034030475, -82.83663004838952, 1.0920068384533959, 0.5931510078933536, -318.3369316718482, 102.36443685812559, -7.010494946510779, -223.84108857039118, 57.86502994794528, -212.9559236818046, -2.896522606727271, -206.25169154530758, 125.37488348733692, -28.112995604524375, 87.27642917335108, -0.032131476357513455, 0.4845152225540854, -176.91895617187828, -31.54610194001448, -29.271687595563602, -48.94615890355752, -39.37421957281983], "policy_predator_policy_reward": [7.978966565270975, 77.23767230396402, 10.45406088622579, 72.96023165380726, 53.26833581409377, 8.922847735166537, 115.07958802332853, 82.84593483470809, 55.8049420318424, 70.13491132665337, 75.06567148505404, 40.90179451214381, 97.12074302036885, 28.70553817350229, 44.13871473566799, 204.35791598362135, 69.4368524661519, 103.66413789131923, 139.37132417395023, 231.4607337022247, 71.56936637480582, 36.232542994627075, 12.324606777397824, 75.39252420114623, 42.75292933351208, 54.080607185588654, 54.99846430079764, 44.40843425963911, 86.77580041664113, 76.7803795481649, 6.5253278077250805, 9.524916184191188, 134.92062919330746, 38.37692725684402, 22.163158723573705, 36.532725772164206, 138.1200979863739, 61.27902833167042, 93.82735477594987, 220.81523843836263, 109.17850126949334, 128.84433860970728, 86.29173596719373, 165.64332999487007, 28.808103166558805, 74.00813973471529, 133.9649733861517, 21.39429359137653, 29.25529721144857, 105.71449332952157, 101.38928055632228, 6.183900523282549, 213.98439957159053, 265.68406396445846, 26.45536627679407, 52.609697734749346, 147.04044172678806, 183.28989276682825, 64.5187605350878, 15.575363141443425, 157.70501295073106, 168.0800039677598, 94.76463120938077, 37.79741086110671, 17.085655417001156, 194.25278951919262, 44.18475410385493, 62.540305291857194, 18.245431860201776, 255.39707420868592, 39.40720463618043, 104.60004097954591, 49.744086331212905, 68.0612320614737, 215.32934500509904, 190.96766489508224, 106.88235343334499, 84.67425251438648, 241.19662354433814, 245.82060706015548, 165.80228633797327, 189.66870205170588, 4.570988587360035, 3.427390641559355, 160.70017139200831, 132.49080935476536, 209.81899843758592, 249.11166527674055, 164.28196801026704, 253.34126804529805, 87.37204731051663, 174.4644522744477, 92.87543944373274, 47.38265390707563, 86.76537782197471, 45.731805757610346, 43.743301441105615, 9.00917838175844, 108.11568434516593, 195.7741990932088, 27.278767396360617, 61.1389817604612, 90.51650852612275, 57.69157264829128, 233.01104136734276, 215.32333135494565, 48.486272267361876, 53.9956393231035, 60.07762147534986, 147.1823175451144, 5.598832747838331, 40.091073945147784, 132.55574308054298, 35.856817653481954, 86.77150786516629, 328.8888352496832, 192.44700968188607, 207.1893496415363, 179.05633326360848, 175.39485338027478, 258.61364436730065, 140.96650537059742, 191.63766573994383, 187.18210913125975, 21.990642720497664, 60.462931168468984, 37.505641810528765, 113.80590474668512, 166.36376481786976, 179.9349888503949, 11.518054769169447, 47.44039638031409, 106.23840989970817, 33.67603456569284, 32.596327206070676, 3.4016342863741444, 216.56798698984957, 129.1436900147293, 137.19381049947492, 164.72798230863947, 8.34426860765481, 33.849174410418044, 229.191314275698, 188.41331912981133, 162.11648810119473, 197.4543704346778, 156.97977883757142, 71.07295898189419, 151.5972175701164, 69.74469824630194, 19.807841927295755, 0.8104422582447013, 28.04442103286432, 0.7588144912698755, 145.07251465149102, 226.82735255948157, 188.99441580070803, 115.62791127926539, 85.7967839511299, 22.671613966487314, 78.10648748117178, 29.032719531154264, 161.28740126194154, 165.19923497042868, 225.9470149438824, 197.4097675524837, 119.8160189092624, 101.22104558761983, 234.62048380165086, 165.0338874149747, 265.62618675178976, 237.52712933436527, 75.20500499642036, 141.4860309716161, 17.63323907683218, 11.897013398689552, 125.65410796023247, 146.0780152445622, 242.8395161535019, 225.1756970214186, 50.885337647804725, 78.89095062667437, 220.1433697629954, 276.1254694292177, 161.97294754352546, 189.60329848928507, 165.38699485878504, 177.1146061567996, 187.1298104649372, 100.85040636267952, 21.92511651266313, 29.952995604524663, 34.57208995774631, 14.333612345260153, 150.46199139529668, 248.73853953572322, 36.400888072855565, 28.006901462722585, 94.67784431432686, 110.08664979714752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8306610530320541, "mean_inference_ms": 2.6874293757454746, "mean_action_processing_ms": 0.36167092314965005, "mean_env_wait_ms": 0.29828816335684305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011480093002319336, "StateBufferConnector_ms": 0.0032050609588623047, "ViewRequirementAgentConnector_ms": 0.10584735870361328}, "num_episodes": 22, "episode_return_max": 332.46502590694786, "episode_return_min": -38.63818925318994, "episode_return_mean": 118.89433818393209, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.89810754063967, "num_env_steps_trained_throughput_per_sec": 325.89810754063967, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13217.601, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13217.553, "sample_time_ms": 1664.138, "learn_time_ms": 11536.623, "learn_throughput": 346.722, "synch_weights_time_ms": 14.484}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "6c58f_00000", "date": "2024-08-16_16-27-01", "timestamp": 1723805821, "time_this_iter_s": 12.278635025024414, "time_total_s": 1203.219688653946, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b342b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1203.219688653946, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 47.258823529411764, "ram_util_percent": 74.35882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3629067639352153, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 4.9572233868654445, "policy_loss": -0.004473221237973246, "vf_loss": 4.961058403953674, "vf_explained_var": 0.003665342185863111, "kl": 0.008964574752451111, "entropy": 1.37220748789096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.955048739247852, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.466430731677504, "policy_loss": -0.0032801084254902822, "vf_loss": 6.469708407114423, "vf_explained_var": 0.15915179498611934, "kl": 0.0062353626019877855, "entropy": 1.300130516006833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 318.4080413125947, "episode_reward_min": -38.63818925318994, "episode_reward_mean": 121.64905597806982, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -327.57050069055447, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 162.65627343134156, "predator_policy": 328.8888352496832}, "policy_reward_mean": {"prey_policy": -51.848479878319665, "predator_policy": 112.67300786735454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.20000000000027, 69.90224615157939, 104.47121434784674, 59.72000000000006, 290.1245820707127, 183.84332875053138, 88.8276569917643, 107.77221411549463, 166.45812973743705, 318.4080413125947, 86.19634272654886, 237.94832768148706, 161.18589434936604, 243.52988601204655, 46.05000000000003, 146.08545338319558, 42.48341824960781, 132.64050829541603, 132.77349096595086, 132.66605566882296, 169.78781510988367, 71.84890666336939, 243.0551187003961, 3.929999999999961, 292.8642209168955, 104.04754807293156, 75.18540359079037, 71.76158144943066, 165.39047125055473, 16.604720367671124, -23.86432943547691, 75.60848528930423, 143.83309263740253, 118.72000000000041, -3.017374194646402, 3.4099999999999726, 116.47254996803129, -2.623555749182156, 122.35665247031567, -6.205384558042709, 110.8534267942807, 159.34388506644962, 82.8029159138163, 173.86537725220222, -2.2048170053401073, 106.51741204616997, 175.72781570442092, 3.47999999999997, -38.63818925318994, 2.756087833390453, 108.77438464753371, 107.78138786802623, 157.10000000000008, 156.3610100757208, 163.07804293467638, 145.53667564789617, 129.774112069328, 3.799999999999963, 173.05999999999983, 59.468589479738775, 137.89319996602703, -6.808379457476006, 124.55559810520118, 253.8818101077877, 129.8379398434289, 112.37937294207585, 172.59758877375126, 155.9602069747424, 124.05313180887428, 4.779999999999941, 151.51183781140907, 133.48454909605596, 131.4614461208265, 280.29634437849023, 120.72466251590906, 187.41070728172534, 78.83200267558212, 149.13999999999996, 136.15000000000035, 222.76608998169596, 3.5899999999999674, 116.44411563509786, 317.4941683288089, 236.89114817843299, 3.8199999999999625, 283.6612767865298, 134.0117389120918, 104.18263421407431, 234.84170358492827, 4.1272224776167405, 126.24257770078799, 3.749999999999963, 135.38874125521585, 208.5154598076616, 98.35876522143532, 132.24358858562192, 3.92999999999996, 164.54219966251617, 135.33000000000033, 291.94131809490455], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-137.0100979863746, 72.8109716683296, -32.01322048313099, -212.72712657960247, 1.0445516350911739, -134.5961771664452, -84.87173596719308, -107.34332999486995, 128.91779564240807, 58.39054352703074, 27.396193066073597, 1.0878687069301567, -41.35153898181501, -4.790594567391271, 2.740719443677734, -2.5416864077884105, -80.76670581399671, -232.44362798461563, 159.9060235360905, 79.43695376496086, -41.404200158495804, -202.729791608572, 79.31406866277808, 78.54013534217836, -51.036402145831936, -113.56272042329296, 69.36419216241927, 41.60365177914006, -15.20565541700105, -150.08278951919252, -50.68163069690999, 90.04202468439314, -5.842013610593857, -225.3170742086859, -30.03654093312511, 18.669803612814825, -3.9348207544934493, 18.902993327756963, -86.70896035228711, -186.92199387907104, 88.95634819938861, -110.72513903723538, -200.83739949093962, -214.3309244501849, -213.61675802661932, 101.20088833733644, -1.5327969491160676, -2.535582279803396, -141.7397920082722, 141.41303217839413, -255.70118395726755, -99.18193168412778, -76.58357264450207, -265.8542598202726, -54.029224539768855, -136.04569359576516, -83.52496819317726, 108.65734609292443, -45.92670706755824, -69.96575614435524, -32.16507404129754, -44.45173521704442, -89.10773231212013, -139.17366583694925, -9.210718684779676, 64.62606216536014, 26.58349147387719, -56.0715726482916, -193.2065957821989, -258.14515113473607, -17.257343106011845, -81.81456848445308, -37.1795390203339, -53.607850032099826, -38.30107394514814, -10.012388497020448, -21.073600874615924, -24.982307389093563, -218.7458257746595, -203.11990189823237, -232.66730459543433, -56.115627933707906, -19.307502546019055, -175.7997990314142, -275.2468356704001, -41.530398153682, -52.557041658236926, -152.39735596076468, -27.63404105442602, -57.024349839880706, -6.218168567497015, -38.57596594354712, -230.80084661586105, 60.22990865201728, -9.588054769169489, -45.890396380314385, -68.84106531095871, -109.71156840763072, -30.756327206070548, -2.4855464529837183, -48.09341937024208, -188.84387298680386, -181.61374438309517, -12.526660556993255, -6.4242686076548505, 121.33082558958198, -250.96704348576918, -10.276579844018988, -183.3953769520608, -13.097438649135647, 2.6339953936449128, -85.15005756521431, -87.71118690615144, -3.8566168409393002, -2.0854352413048316, -14.732848944235636, -18.399508955475447, 162.65627343134156, -178.57093604898097, -133.86034168225305, -165.4555054051465, -1.2736217088000081, -80.2744578197738, -35.002319555318834, 22.116778126641815, -4.70038703376712, -172.35030071358008, 99.74547458899752, -278.8489782540247, -14.66986439891257, -104.85392412041034, -3.8037674343963808, -226.14507580243452, -0.9117066404397514, -19.62260842085771, -327.57050069055447, -84.52057308844962, -8.117331070713009, -15.72323907683193, -9.027013398689592, -104.92646271370761, -15.293822679677815, -251.694034030475, -82.83663004838952, 1.0920068384533959, 0.5931510078933536, -318.3369316718482, 102.36443685812559, -7.010494946510779, -223.84108857039118, 57.86502994794528, -212.9559236818046, -2.896522606727271, -206.25169154530758, 125.37488348733692, -28.112995604524375, 87.27642917335108, -0.032131476357513455, 0.4845152225540854, -176.91895617187828, -31.54610194001448, -29.271687595563602, -48.94615890355752, -39.37421957281983, -116.12645875646817, 112.44820731479182, 65.11665585132334, -60.09162321961263, -7.613433564077091, -10.372566201598831, 101.57725251344397, 115.92066360758389, -2.461799718170912, 14.427242538791832, -12.129563767436313, -11.775462468171007, 0.030654502170907705, 38.068288818309945, -24.83808778466842, -14.708158859667332, -277.4832471689058, -6.182015155729246, -19.23622590651949, -14.74917833682628, -169.3576922091286, -53.31740216483545, -138.284968480265, 56.91609643761825, -27.697036280723463, -233.58911267172456, -4.8211604725527835, -6.405055164413509, 2.0000000000000013, -7.56028291383026, -1.5160802223820724, -95.82621657154186, 105.44054961779172, -26.996764497163028, 54.25140043248108, 123.42656965074515], "policy_predator_policy_reward": [138.1200979863739, 61.27902833167042, 93.82735477594987, 220.81523843836263, 109.17850126949334, 128.84433860970728, 86.29173596719373, 165.64332999487007, 28.808103166558805, 74.00813973471529, 133.9649733861517, 21.39429359137653, 29.25529721144857, 105.71449332952157, 101.38928055632228, 6.183900523282549, 213.98439957159053, 265.68406396445846, 26.45536627679407, 52.609697734749346, 147.04044172678806, 183.28989276682825, 64.5187605350878, 15.575363141443425, 157.70501295073106, 168.0800039677598, 94.76463120938077, 37.79741086110671, 17.085655417001156, 194.25278951919262, 44.18475410385493, 62.540305291857194, 18.245431860201776, 255.39707420868592, 39.40720463618043, 104.60004097954591, 49.744086331212905, 68.0612320614737, 215.32934500509904, 190.96766489508224, 106.88235343334499, 84.67425251438648, 241.19662354433814, 245.82060706015548, 165.80228633797327, 189.66870205170588, 4.570988587360035, 3.427390641559355, 160.70017139200831, 132.49080935476536, 209.81899843758592, 249.11166527674055, 164.28196801026704, 253.34126804529805, 87.37204731051663, 174.4644522744477, 92.87543944373274, 47.38265390707563, 86.76537782197471, 45.731805757610346, 43.743301441105615, 9.00917838175844, 108.11568434516593, 195.7741990932088, 27.278767396360617, 61.1389817604612, 90.51650852612275, 57.69157264829128, 233.01104136734276, 215.32333135494565, 48.486272267361876, 53.9956393231035, 60.07762147534986, 147.1823175451144, 5.598832747838331, 40.091073945147784, 132.55574308054298, 35.856817653481954, 86.77150786516629, 328.8888352496832, 192.44700968188607, 207.1893496415363, 179.05633326360848, 175.39485338027478, 258.61364436730065, 140.96650537059742, 191.63766573994383, 187.18210913125975, 21.990642720497664, 60.462931168468984, 37.505641810528765, 113.80590474668512, 166.36376481786976, 179.9349888503949, 11.518054769169447, 47.44039638031409, 106.23840989970817, 33.67603456569284, 32.596327206070676, 3.4016342863741444, 216.56798698984957, 129.1436900147293, 137.19381049947492, 164.72798230863947, 8.34426860765481, 33.849174410418044, 229.191314275698, 188.41331912981133, 162.11648810119473, 197.4543704346778, 156.97977883757142, 71.07295898189419, 151.5972175701164, 69.74469824630194, 19.807841927295755, 0.8104422582447013, 28.04442103286432, 0.7588144912698755, 145.07251465149102, 226.82735255948157, 188.99441580070803, 115.62791127926539, 85.7967839511299, 22.671613966487314, 78.10648748117178, 29.032719531154264, 161.28740126194154, 165.19923497042868, 225.9470149438824, 197.4097675524837, 119.8160189092624, 101.22104558761983, 234.62048380165086, 165.0338874149747, 265.62618675178976, 237.52712933436527, 75.20500499642036, 141.4860309716161, 17.63323907683218, 11.897013398689552, 125.65410796023247, 146.0780152445622, 242.8395161535019, 225.1756970214186, 50.885337647804725, 78.89095062667437, 220.1433697629954, 276.1254694292177, 161.97294754352546, 189.60329848928507, 165.38699485878504, 177.1146061567996, 187.1298104649372, 100.85040636267952, 21.92511651266313, 29.952995604524663, 34.57208995774631, 14.333612345260153, 150.46199139529668, 248.73853953572322, 36.400888072855565, 28.006901462722585, 94.67784431432686, 110.08664979714752, 167.8223984116558, 153.35002135882957, 107.8908366596086, 123.97527888711411, 9.52343356407705, 12.28256620159879, 38.78556869085705, 27.37779197464512, 61.26158135291116, 60.78471473855915, 96.6769386996298, 31.410721750051522, 124.26264515866492, 72.48011510578274, 28.931318133796506, 14.742150988156371, 242.31539422339978, 167.59244580202287, 16.668259791674945, 21.06714445167118, 200.62051812397993, 157.44331750519893, 200.688006738178, 89.19632511213017, 213.17472019683387, 146.47019397704906, 74.33107805400961, 69.1387261685781, 0.0, 9.49028291383022, 133.1098532396184, 128.77464321682177, 27.999450382208348, 28.886764497163323, 12.24833835148381, 102.01500966019461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8292458647557333, "mean_inference_ms": 2.687292149053738, "mean_action_processing_ms": 0.36147808776973894, "mean_env_wait_ms": 0.2978334677879025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011523842811584473, "StateBufferConnector_ms": 0.003202676773071289, "ViewRequirementAgentConnector_ms": 0.10593616962432861}, "num_episodes": 18, "episode_return_max": 318.4080413125947, "episode_return_min": -38.63818925318994, "episode_return_mean": 121.64905597806982, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.2799022084948, "num_env_steps_trained_throughput_per_sec": 311.2799022084948, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 13079.865, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13079.822, "sample_time_ms": 1746.214, "learn_time_ms": 11316.944, "learn_throughput": 353.452, "synch_weights_time_ms": 14.317}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "6c58f_00000", "date": "2024-08-16_16-27-14", "timestamp": 1723805834, "time_this_iter_s": 12.857795000076294, "time_total_s": 1216.0774836540222, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1216.0774836540222, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 46.11666666666667, "ram_util_percent": 74.29444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7039703457128434, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 4.361377736374184, "policy_loss": -0.008314050152212893, "vf_loss": 4.368746518710303, "vf_explained_var": 0.006750400545735839, "kl": 0.013277761022989673, "entropy": 1.3740599634786133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9408450272190507, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 6.172799504244769, "policy_loss": -0.00606901257818752, "vf_loss": 6.178862511922443, "vf_explained_var": 0.36314516414410225, "kl": 0.015320214687818431, "entropy": 1.311918184303102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 317.4941683288089, "episode_reward_min": -38.63818925318994, "episode_reward_mean": 126.9487423074638, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -327.57050069055447, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.30999999999992, "predator_policy": 328.8888352496832}, "policy_reward_mean": {"prey_policy": -40.69132155314852, "predator_policy": 104.1656927068804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.929999999999961, 292.8642209168955, 104.04754807293156, 75.18540359079037, 71.76158144943066, 165.39047125055473, 16.604720367671124, -23.86432943547691, 75.60848528930423, 143.83309263740253, 118.72000000000041, -3.017374194646402, 3.4099999999999726, 116.47254996803129, -2.623555749182156, 122.35665247031567, -6.205384558042709, 110.8534267942807, 159.34388506644962, 82.8029159138163, 173.86537725220222, -2.2048170053401073, 106.51741204616997, 175.72781570442092, 3.47999999999997, -38.63818925318994, 2.756087833390453, 108.77438464753371, 107.78138786802623, 157.10000000000008, 156.3610100757208, 163.07804293467638, 145.53667564789617, 129.774112069328, 3.799999999999963, 173.05999999999983, 59.468589479738775, 137.89319996602703, -6.808379457476006, 124.55559810520118, 253.8818101077877, 129.8379398434289, 112.37937294207585, 172.59758877375126, 155.9602069747424, 124.05313180887428, 4.779999999999941, 151.51183781140907, 133.48454909605596, 131.4614461208265, 280.29634437849023, 120.72466251590906, 187.41070728172534, 78.83200267558212, 149.13999999999996, 136.15000000000035, 222.76608998169596, 3.5899999999999674, 116.44411563509786, 317.4941683288089, 236.89114817843299, 3.8199999999999625, 283.6612767865298, 134.0117389120918, 104.18263421407431, 234.84170358492827, 4.1272224776167405, 126.24257770078799, 3.749999999999963, 135.38874125521585, 208.5154598076616, 98.35876522143532, 132.24358858562192, 3.92999999999996, 164.54219966251617, 135.33000000000033, 291.94131809490455, 302.92746388247326, 158.85364653648352, 6.533285165289544, 294.6454643252691, 243.0764571359306, 3.919999999999961, 189.09839793152057, 200.04023076202182, 225.83340699904946, 112.15645389146533, 229.1455601604155, 90.92153487650779, 106.56325927383995, 150.03715071587698, 173.75498892903062, 262.6480228464749, 212.77514423907832, 181.5923391679041, 282.52851147380477, 149.3213064602167, 171.23999999999972, -6.931351453487796, 160.26599090428348], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1.5327969491160676, -2.535582279803396, -141.7397920082722, 141.41303217839413, -255.70118395726755, -99.18193168412778, -76.58357264450207, -265.8542598202726, -54.029224539768855, -136.04569359576516, -83.52496819317726, 108.65734609292443, -45.92670706755824, -69.96575614435524, -32.16507404129754, -44.45173521704442, -89.10773231212013, -139.17366583694925, -9.210718684779676, 64.62606216536014, 26.58349147387719, -56.0715726482916, -193.2065957821989, -258.14515113473607, -17.257343106011845, -81.81456848445308, -37.1795390203339, -53.607850032099826, -38.30107394514814, -10.012388497020448, -21.073600874615924, -24.982307389093563, -218.7458257746595, -203.11990189823237, -232.66730459543433, -56.115627933707906, -19.307502546019055, -175.7997990314142, -275.2468356704001, -41.530398153682, -52.557041658236926, -152.39735596076468, -27.63404105442602, -57.024349839880706, -6.218168567497015, -38.57596594354712, -230.80084661586105, 60.22990865201728, -9.588054769169489, -45.890396380314385, -68.84106531095871, -109.71156840763072, -30.756327206070548, -2.4855464529837183, -48.09341937024208, -188.84387298680386, -181.61374438309517, -12.526660556993255, -6.4242686076548505, 121.33082558958198, -250.96704348576918, -10.276579844018988, -183.3953769520608, -13.097438649135647, 2.6339953936449128, -85.15005756521431, -87.71118690615144, -3.8566168409393002, -2.0854352413048316, -14.732848944235636, -18.399508955475447, 162.65627343134156, -178.57093604898097, -133.86034168225305, -165.4555054051465, -1.2736217088000081, -80.2744578197738, -35.002319555318834, 22.116778126641815, -4.70038703376712, -172.35030071358008, 99.74547458899752, -278.8489782540247, -14.66986439891257, -104.85392412041034, -3.8037674343963808, -226.14507580243452, -0.9117066404397514, -19.62260842085771, -327.57050069055447, -84.52057308844962, -8.117331070713009, -15.72323907683193, -9.027013398689592, -104.92646271370761, -15.293822679677815, -251.694034030475, -82.83663004838952, 1.0920068384533959, 0.5931510078933536, -318.3369316718482, 102.36443685812559, -7.010494946510779, -223.84108857039118, 57.86502994794528, -212.9559236818046, -2.896522606727271, -206.25169154530758, 125.37488348733692, -28.112995604524375, 87.27642917335108, -0.032131476357513455, 0.4845152225540854, -176.91895617187828, -31.54610194001448, -29.271687595563602, -48.94615890355752, -39.37421957281983, -116.12645875646817, 112.44820731479182, 65.11665585132334, -60.09162321961263, -7.613433564077091, -10.372566201598831, 101.57725251344397, 115.92066360758389, -2.461799718170912, 14.427242538791832, -12.129563767436313, -11.775462468171007, 0.030654502170907705, 38.068288818309945, -24.83808778466842, -14.708158859667332, -277.4832471689058, -6.182015155729246, -19.23622590651949, -14.74917833682628, -169.3576922091286, -53.31740216483545, -138.284968480265, 56.91609643761825, -27.697036280723463, -233.58911267172456, -4.8211604725527835, -6.405055164413509, 2.0000000000000013, -7.56028291383026, -1.5160802223820724, -95.82621657154186, 105.44054961779172, -26.996764497163028, 54.25140043248108, 123.42656965074515, 150.6901328423166, 65.82498983394945, 23.340242359267386, -7.443892028595734, -2.77585961753189, -18.384260767957244, 88.64481535078052, 73.4392105479003, 129.20497681128057, -113.30512410476986, -4.835691943583541, -4.6004141802979515, 18.882399064762186, -29.081725203250908, 61.396690938047385, -3.7727836252193248, 41.45561767102913, 12.718288200984016, -35.59518713077544, -47.94664037203502, 45.87768959038169, 38.29522092061522, -168.3420928065202, -21.06197337959185, 21.81267659953013, -19.649772667302695, 130.6176926285651, -15.689056667008305, -41.34124833900219, 18.803761715485518, 90.10492804830467, -113.60902018129278, 21.590707352065472, -58.93186067853729, -185.85002413374053, 0.7972527242566141, -39.36862723424399, 151.74804485499436, -19.590887769092173, 1.0925962143954138, 169.30999999999992, -6.911426379275083, -15.390952206578598, -17.259688849428123, 10.342384220197605, 1.074627263794472], "policy_predator_policy_reward": [4.570988587360035, 3.427390641559355, 160.70017139200831, 132.49080935476536, 209.81899843758592, 249.11166527674055, 164.28196801026704, 253.34126804529805, 87.37204731051663, 174.4644522744477, 92.87543944373274, 47.38265390707563, 86.76537782197471, 45.731805757610346, 43.743301441105615, 9.00917838175844, 108.11568434516593, 195.7741990932088, 27.278767396360617, 61.1389817604612, 90.51650852612275, 57.69157264829128, 233.01104136734276, 215.32333135494565, 48.486272267361876, 53.9956393231035, 60.07762147534986, 147.1823175451144, 5.598832747838331, 40.091073945147784, 132.55574308054298, 35.856817653481954, 86.77150786516629, 328.8888352496832, 192.44700968188607, 207.1893496415363, 179.05633326360848, 175.39485338027478, 258.61364436730065, 140.96650537059742, 191.63766573994383, 187.18210913125975, 21.990642720497664, 60.462931168468984, 37.505641810528765, 113.80590474668512, 166.36376481786976, 179.9349888503949, 11.518054769169447, 47.44039638031409, 106.23840989970817, 33.67603456569284, 32.596327206070676, 3.4016342863741444, 216.56798698984957, 129.1436900147293, 137.19381049947492, 164.72798230863947, 8.34426860765481, 33.849174410418044, 229.191314275698, 188.41331912981133, 162.11648810119473, 197.4543704346778, 156.97977883757142, 71.07295898189419, 151.5972175701164, 69.74469824630194, 19.807841927295755, 0.8104422582447013, 28.04442103286432, 0.7588144912698755, 145.07251465149102, 226.82735255948157, 188.99441580070803, 115.62791127926539, 85.7967839511299, 22.671613966487314, 78.10648748117178, 29.032719531154264, 161.28740126194154, 165.19923497042868, 225.9470149438824, 197.4097675524837, 119.8160189092624, 101.22104558761983, 234.62048380165086, 165.0338874149747, 265.62618675178976, 237.52712933436527, 75.20500499642036, 141.4860309716161, 17.63323907683218, 11.897013398689552, 125.65410796023247, 146.0780152445622, 242.8395161535019, 225.1756970214186, 50.885337647804725, 78.89095062667437, 220.1433697629954, 276.1254694292177, 161.97294754352546, 189.60329848928507, 165.38699485878504, 177.1146061567996, 187.1298104649372, 100.85040636267952, 21.92511651266313, 29.952995604524663, 34.57208995774631, 14.333612345260153, 150.46199139529668, 248.73853953572322, 36.400888072855565, 28.006901462722585, 94.67784431432686, 110.08664979714752, 167.8223984116558, 153.35002135882957, 107.8908366596086, 123.97527888711411, 9.52343356407705, 12.28256620159879, 38.78556869085705, 27.37779197464512, 61.26158135291116, 60.78471473855915, 96.6769386996298, 31.410721750051522, 124.26264515866492, 72.48011510578274, 28.931318133796506, 14.742150988156371, 242.31539422339978, 167.59244580202287, 16.668259791674945, 21.06714445167118, 200.62051812397993, 157.44331750519893, 200.688006738178, 89.19632511213017, 213.17472019683387, 146.47019397704906, 74.33107805400961, 69.1387261685781, 0.0, 9.49028291383022, 133.1098532396184, 128.77464321682177, 27.999450382208348, 28.886764497163323, 12.24833835148381, 102.01500966019461, 22.333470651979837, 64.0788705542278, 79.39075455899824, 63.566541646813675, 22.62888733494047, 5.064518215838546, 69.64713789597802, 62.91430053061046, 116.24845998055193, 110.92814444886828, 6.795691943583499, 6.56041418029791, 122.78652608494319, 76.51119798506612, 85.3208042437654, 57.095519205428864, 125.9953503772766, 45.66415074976015, 77.38708551061357, 118.3111958836615, 61.83020304463277, 83.14244660478585, 124.69419083667252, 155.63141022594698, 67.20408223947925, 37.19627310213327, 22.73433785727242, 12.37417689704785, 101.43560521286341, 94.8568703396839, 151.3330383927087, 134.81907658675408, 162.27777493293323, 87.83852263261701, 173.25186821620048, 193.3932423611876, 89.75665153666927, 80.39244231638527, 81.67778900602055, 86.14180900889284, 0.0, 8.841426379275042, 22.00985124824596, 3.709438354273547, 81.89232915856486, 66.95665026172667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8275181353778508, "mean_inference_ms": 2.684202799022286, "mean_action_processing_ms": 0.3609984463989935, "mean_env_wait_ms": 0.29722973841501416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011645793914794922, "StateBufferConnector_ms": 0.0032709836959838867, "ViewRequirementAgentConnector_ms": 0.10670614242553711}, "num_episodes": 23, "episode_return_max": 317.4941683288089, "episode_return_min": -38.63818925318994, "episode_return_mean": 126.9487423074638, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.6865892990053, "num_env_steps_trained_throughput_per_sec": 321.6865892990053, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 12872.048, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12872.007, "sample_time_ms": 1735.354, "learn_time_ms": 11120.43, "learn_throughput": 359.698, "synch_weights_time_ms": 14.086}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "6c58f_00000", "date": "2024-08-16_16-27-27", "timestamp": 1723805847, "time_this_iter_s": 12.440038204193115, "time_total_s": 1228.5175218582153, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1228.5175218582153, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 51.361111111111114, "ram_util_percent": 73.42777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5018119829987722, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 4.501159065110343, "policy_loss": -0.009482325966317188, "vf_loss": 4.509706312134153, "vf_explained_var": 0.004965635393031691, "kl": 0.013134676134458786, "entropy": 1.3749224898045656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8991569204778267, "cur_kl_coeff": 0.000390625, "cur_lr": 1e-05, "total_loss": 5.7068983633051475, "policy_loss": -0.0002756335815690734, "vf_loss": 5.707172204577733, "vf_explained_var": 0.17905007433639, "kl": 0.0046436979151841095, "entropy": 1.293082860285643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 317.4941683288089, "episode_reward_min": -38.63818925318994, "episode_reward_mean": 139.1221587337603, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -327.57050069055447, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.30999999999992, "predator_policy": 276.1254694292177}, "policy_reward_mean": {"prey_policy": -28.96827376441044, "predator_policy": 98.52935313129059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [159.34388506644962, 82.8029159138163, 173.86537725220222, -2.2048170053401073, 106.51741204616997, 175.72781570442092, 3.47999999999997, -38.63818925318994, 2.756087833390453, 108.77438464753371, 107.78138786802623, 157.10000000000008, 156.3610100757208, 163.07804293467638, 145.53667564789617, 129.774112069328, 3.799999999999963, 173.05999999999983, 59.468589479738775, 137.89319996602703, -6.808379457476006, 124.55559810520118, 253.8818101077877, 129.8379398434289, 112.37937294207585, 172.59758877375126, 155.9602069747424, 124.05313180887428, 4.779999999999941, 151.51183781140907, 133.48454909605596, 131.4614461208265, 280.29634437849023, 120.72466251590906, 187.41070728172534, 78.83200267558212, 149.13999999999996, 136.15000000000035, 222.76608998169596, 3.5899999999999674, 116.44411563509786, 317.4941683288089, 236.89114817843299, 3.8199999999999625, 283.6612767865298, 134.0117389120918, 104.18263421407431, 234.84170358492827, 4.1272224776167405, 126.24257770078799, 3.749999999999963, 135.38874125521585, 208.5154598076616, 98.35876522143532, 132.24358858562192, 3.92999999999996, 164.54219966251617, 135.33000000000033, 291.94131809490455, 302.92746388247326, 158.85364653648352, 6.533285165289544, 294.6454643252691, 243.0764571359306, 3.919999999999961, 189.09839793152057, 200.04023076202182, 225.83340699904946, 112.15645389146533, 229.1455601604155, 90.92153487650779, 106.56325927383995, 150.03715071587698, 173.75498892903062, 262.6480228464749, 212.77514423907832, 181.5923391679041, 282.52851147380477, 149.3213064602167, 171.23999999999972, -6.931351453487796, 160.26599090428348, 227.4924796778663, 66.82340704417372, 144.22591264434442, 88.5939704921083, 119.3070620224241, 95.63667587080171, 168.81210107493007, 258.7397881556138, 114.21952979631399, 89.89525682012284, 111.11000000000023, 158.06809218148086, 155.60293115299368, 269.83100389697546, 257.5225499237435, 160.8678212429431, 4.1641998354264, 111.75636966764996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-19.307502546019055, -175.7997990314142, -275.2468356704001, -41.530398153682, -52.557041658236926, -152.39735596076468, -27.63404105442602, -57.024349839880706, -6.218168567497015, -38.57596594354712, -230.80084661586105, 60.22990865201728, -9.588054769169489, -45.890396380314385, -68.84106531095871, -109.71156840763072, -30.756327206070548, -2.4855464529837183, -48.09341937024208, -188.84387298680386, -181.61374438309517, -12.526660556993255, -6.4242686076548505, 121.33082558958198, -250.96704348576918, -10.276579844018988, -183.3953769520608, -13.097438649135647, 2.6339953936449128, -85.15005756521431, -87.71118690615144, -3.8566168409393002, -2.0854352413048316, -14.732848944235636, -18.399508955475447, 162.65627343134156, -178.57093604898097, -133.86034168225305, -165.4555054051465, -1.2736217088000081, -80.2744578197738, -35.002319555318834, 22.116778126641815, -4.70038703376712, -172.35030071358008, 99.74547458899752, -278.8489782540247, -14.66986439891257, -104.85392412041034, -3.8037674343963808, -226.14507580243452, -0.9117066404397514, -19.62260842085771, -327.57050069055447, -84.52057308844962, -8.117331070713009, -15.72323907683193, -9.027013398689592, -104.92646271370761, -15.293822679677815, -251.694034030475, -82.83663004838952, 1.0920068384533959, 0.5931510078933536, -318.3369316718482, 102.36443685812559, -7.010494946510779, -223.84108857039118, 57.86502994794528, -212.9559236818046, -2.896522606727271, -206.25169154530758, 125.37488348733692, -28.112995604524375, 87.27642917335108, -0.032131476357513455, 0.4845152225540854, -176.91895617187828, -31.54610194001448, -29.271687595563602, -48.94615890355752, -39.37421957281983, -116.12645875646817, 112.44820731479182, 65.11665585132334, -60.09162321961263, -7.613433564077091, -10.372566201598831, 101.57725251344397, 115.92066360758389, -2.461799718170912, 14.427242538791832, -12.129563767436313, -11.775462468171007, 0.030654502170907705, 38.068288818309945, -24.83808778466842, -14.708158859667332, -277.4832471689058, -6.182015155729246, -19.23622590651949, -14.74917833682628, -169.3576922091286, -53.31740216483545, -138.284968480265, 56.91609643761825, -27.697036280723463, -233.58911267172456, -4.8211604725527835, -6.405055164413509, 2.0000000000000013, -7.56028291383026, -1.5160802223820724, -95.82621657154186, 105.44054961779172, -26.996764497163028, 54.25140043248108, 123.42656965074515, 150.6901328423166, 65.82498983394945, 23.340242359267386, -7.443892028595734, -2.77585961753189, -18.384260767957244, 88.64481535078052, 73.4392105479003, 129.20497681128057, -113.30512410476986, -4.835691943583541, -4.6004141802979515, 18.882399064762186, -29.081725203250908, 61.396690938047385, -3.7727836252193248, 41.45561767102913, 12.718288200984016, -35.59518713077544, -47.94664037203502, 45.87768959038169, 38.29522092061522, -168.3420928065202, -21.06197337959185, 21.81267659953013, -19.649772667302695, 130.6176926285651, -15.689056667008305, -41.34124833900219, 18.803761715485518, 90.10492804830467, -113.60902018129278, 21.590707352065472, -58.93186067853729, -185.85002413374053, 0.7972527242566141, -39.36862723424399, 151.74804485499436, -19.590887769092173, 1.0925962143954138, 169.30999999999992, -6.911426379275083, -15.390952206578598, -17.259688849428123, 10.342384220197605, 1.074627263794472, 112.67019800480506, -111.34512587900896, -121.0685510019249, -13.239981126643576, 40.62008759293297, -4.537423021383189, -49.95544642070672, 1.1300740635168298, -3.863169307131569, 14.362897766826391, -84.50654495960251, -71.94229793039287, -9.916741599587773, 81.31448259228029, 166.61320901117534, -4.038642255359642, -29.52730275617678, -8.249602072447486, -152.68169497632283, -3.929837179467836, 42.29352880269221, -35.323209008760195, -2.4226945430344458, -6.047484382203885, -1.885590198859787, -22.58351727795291, 72.77057012007641, 57.93196741190695, -235.8856130906391, 29.8800135852997, 55.94821278649687, 2.0000000000000013, -10.079690948684679, -21.257967787145784, -6.320134459813346, -30.068535988802857], "policy_predator_policy_reward": [179.05633326360848, 175.39485338027478, 258.61364436730065, 140.96650537059742, 191.63766573994383, 187.18210913125975, 21.990642720497664, 60.462931168468984, 37.505641810528765, 113.80590474668512, 166.36376481786976, 179.9349888503949, 11.518054769169447, 47.44039638031409, 106.23840989970817, 33.67603456569284, 32.596327206070676, 3.4016342863741444, 216.56798698984957, 129.1436900147293, 137.19381049947492, 164.72798230863947, 8.34426860765481, 33.849174410418044, 229.191314275698, 188.41331912981133, 162.11648810119473, 197.4543704346778, 156.97977883757142, 71.07295898189419, 151.5972175701164, 69.74469824630194, 19.807841927295755, 0.8104422582447013, 28.04442103286432, 0.7588144912698755, 145.07251465149102, 226.82735255948157, 188.99441580070803, 115.62791127926539, 85.7967839511299, 22.671613966487314, 78.10648748117178, 29.032719531154264, 161.28740126194154, 165.19923497042868, 225.9470149438824, 197.4097675524837, 119.8160189092624, 101.22104558761983, 234.62048380165086, 165.0338874149747, 265.62618675178976, 237.52712933436527, 75.20500499642036, 141.4860309716161, 17.63323907683218, 11.897013398689552, 125.65410796023247, 146.0780152445622, 242.8395161535019, 225.1756970214186, 50.885337647804725, 78.89095062667437, 220.1433697629954, 276.1254694292177, 161.97294754352546, 189.60329848928507, 165.38699485878504, 177.1146061567996, 187.1298104649372, 100.85040636267952, 21.92511651266313, 29.952995604524663, 34.57208995774631, 14.333612345260153, 150.46199139529668, 248.73853953572322, 36.400888072855565, 28.006901462722585, 94.67784431432686, 110.08664979714752, 167.8223984116558, 153.35002135882957, 107.8908366596086, 123.97527888711411, 9.52343356407705, 12.28256620159879, 38.78556869085705, 27.37779197464512, 61.26158135291116, 60.78471473855915, 96.6769386996298, 31.410721750051522, 124.26264515866492, 72.48011510578274, 28.931318133796506, 14.742150988156371, 242.31539422339978, 167.59244580202287, 16.668259791674945, 21.06714445167118, 200.62051812397993, 157.44331750519893, 200.688006738178, 89.19632511213017, 213.17472019683387, 146.47019397704906, 74.33107805400961, 69.1387261685781, 0.0, 9.49028291383022, 133.1098532396184, 128.77464321682177, 27.999450382208348, 28.886764497163323, 12.24833835148381, 102.01500966019461, 22.333470651979837, 64.0788705542278, 79.39075455899824, 63.566541646813675, 22.62888733494047, 5.064518215838546, 69.64713789597802, 62.91430053061046, 116.24845998055193, 110.92814444886828, 6.795691943583499, 6.56041418029791, 122.78652608494319, 76.51119798506612, 85.3208042437654, 57.095519205428864, 125.9953503772766, 45.66415074976015, 77.38708551061357, 118.3111958836615, 61.83020304463277, 83.14244660478585, 124.69419083667252, 155.63141022594698, 67.20408223947925, 37.19627310213327, 22.73433785727242, 12.37417689704785, 101.43560521286341, 94.8568703396839, 151.3330383927087, 134.81907658675408, 162.27777493293323, 87.83852263261701, 173.25186821620048, 193.3932423611876, 89.75665153666927, 80.39244231638527, 81.67778900602055, 86.14180900889284, 0.0, 8.841426379275042, 22.00985124824596, 3.709438354273547, 81.89232915856486, 66.95665026172667, 47.02754411552988, 179.13986343654034, 173.3466807287829, 27.785258443959552, 80.79198330857733, 27.35126476421707, 110.23746317941007, 27.181879669887802, 10.264094691219082, 98.54323887150989, 174.05986525607472, 78.02565350472241, 32.71188838297969, 64.70247169925784, 84.36942250173317, 11.795798898065181, 80.39855232961534, 71.5978822953226, 93.76731059897611, 152.73947837693666, 66.96647119730777, 37.17320900875983, 86.16629045017154, 80.37198065654717, 84.79001715971572, 95.2820214700907, 77.80003344120712, 61.328432923785044, 244.42219508879896, 219.105954340284, 71.48157596537722, 31.438032491068913, 23.343725587200684, 12.158132984056481, 80.02693175345732, 68.11810836280856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8271921921744706, "mean_inference_ms": 2.683771748063194, "mean_action_processing_ms": 0.36084248658195933, "mean_env_wait_ms": 0.2968228490551419, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012171506881713867, "StateBufferConnector_ms": 0.0033148527145385742, "ViewRequirementAgentConnector_ms": 0.11413252353668213}, "num_episodes": 18, "episode_return_max": 317.4941683288089, "episode_return_min": -38.63818925318994, "episode_return_mean": 139.1221587337603, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.3413487519133, "num_env_steps_trained_throughput_per_sec": 327.3413487519133, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 12627.782, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12627.742, "sample_time_ms": 1701.313, "learn_time_ms": 10910.193, "learn_throughput": 366.63, "synch_weights_time_ms": 14.219}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "6c58f_00000", "date": "2024-08-16_16-27-39", "timestamp": 1723805859, "time_this_iter_s": 12.22708010673523, "time_total_s": 1240.7446019649506, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0521f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1240.7446019649506, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 50.83529411764706, "ram_util_percent": 72.87058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3106138613015885, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.476174357328466, "policy_loss": -0.008583813498447102, "vf_loss": 7.483910741250981, "vf_explained_var": 0.0003581070080005303, "kl": 0.01190372242810432, "entropy": 1.373184166572712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7634229454098556, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.950773199777754, "policy_loss": -0.0039741617082938475, "vf_loss": 5.954746288723416, "vf_explained_var": -0.16686625240971803, "kl": 0.005519948648316808, "entropy": 1.2249904233942588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 317.4941683288089, "episode_reward_min": -6.931351453487796, "episode_reward_mean": 137.14091630070936, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -327.57050069055447, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.30999999999992, "predator_policy": 276.1254694292177}, "policy_reward_mean": {"prey_policy": -27.27272806495327, "predator_policy": 95.84318621530794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.468589479738775, 137.89319996602703, -6.808379457476006, 124.55559810520118, 253.8818101077877, 129.8379398434289, 112.37937294207585, 172.59758877375126, 155.9602069747424, 124.05313180887428, 4.779999999999941, 151.51183781140907, 133.48454909605596, 131.4614461208265, 280.29634437849023, 120.72466251590906, 187.41070728172534, 78.83200267558212, 149.13999999999996, 136.15000000000035, 222.76608998169596, 3.5899999999999674, 116.44411563509786, 317.4941683288089, 236.89114817843299, 3.8199999999999625, 283.6612767865298, 134.0117389120918, 104.18263421407431, 234.84170358492827, 4.1272224776167405, 126.24257770078799, 3.749999999999963, 135.38874125521585, 208.5154598076616, 98.35876522143532, 132.24358858562192, 3.92999999999996, 164.54219966251617, 135.33000000000033, 291.94131809490455, 302.92746388247326, 158.85364653648352, 6.533285165289544, 294.6454643252691, 243.0764571359306, 3.919999999999961, 189.09839793152057, 200.04023076202182, 225.83340699904946, 112.15645389146533, 229.1455601604155, 90.92153487650779, 106.56325927383995, 150.03715071587698, 173.75498892903062, 262.6480228464749, 212.77514423907832, 181.5923391679041, 282.52851147380477, 149.3213064602167, 171.23999999999972, -6.931351453487796, 160.26599090428348, 227.4924796778663, 66.82340704417372, 144.22591264434442, 88.5939704921083, 119.3070620224241, 95.63667587080171, 168.81210107493007, 258.7397881556138, 114.21952979631399, 89.89525682012284, 111.11000000000023, 158.06809218148086, 155.60293115299368, 269.83100389697546, 257.5225499237435, 160.8678212429431, 4.1641998354264, 111.75636966764996, 3.8399999999999626, 3.7899999999999627, 139.57090174926162, 77.24417679002815, 106.67586366274764, 136.95406014038704, 124.4131730124492, -2.310009141543045, 81.28687893778337, 102.82125089111727, 92.16041361078098, 128.57753986479742, 55.59459029741205, 129.88810483735998, 103.1915853756421, -5.483011690704291, 76.6563556766124, 255.9199834818762], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-178.57093604898097, -133.86034168225305, -165.4555054051465, -1.2736217088000081, -80.2744578197738, -35.002319555318834, 22.116778126641815, -4.70038703376712, -172.35030071358008, 99.74547458899752, -278.8489782540247, -14.66986439891257, -104.85392412041034, -3.8037674343963808, -226.14507580243452, -0.9117066404397514, -19.62260842085771, -327.57050069055447, -84.52057308844962, -8.117331070713009, -15.72323907683193, -9.027013398689592, -104.92646271370761, -15.293822679677815, -251.694034030475, -82.83663004838952, 1.0920068384533959, 0.5931510078933536, -318.3369316718482, 102.36443685812559, -7.010494946510779, -223.84108857039118, 57.86502994794528, -212.9559236818046, -2.896522606727271, -206.25169154530758, 125.37488348733692, -28.112995604524375, 87.27642917335108, -0.032131476357513455, 0.4845152225540854, -176.91895617187828, -31.54610194001448, -29.271687595563602, -48.94615890355752, -39.37421957281983, -116.12645875646817, 112.44820731479182, 65.11665585132334, -60.09162321961263, -7.613433564077091, -10.372566201598831, 101.57725251344397, 115.92066360758389, -2.461799718170912, 14.427242538791832, -12.129563767436313, -11.775462468171007, 0.030654502170907705, 38.068288818309945, -24.83808778466842, -14.708158859667332, -277.4832471689058, -6.182015155729246, -19.23622590651949, -14.74917833682628, -169.3576922091286, -53.31740216483545, -138.284968480265, 56.91609643761825, -27.697036280723463, -233.58911267172456, -4.8211604725527835, -6.405055164413509, 2.0000000000000013, -7.56028291383026, -1.5160802223820724, -95.82621657154186, 105.44054961779172, -26.996764497163028, 54.25140043248108, 123.42656965074515, 150.6901328423166, 65.82498983394945, 23.340242359267386, -7.443892028595734, -2.77585961753189, -18.384260767957244, 88.64481535078052, 73.4392105479003, 129.20497681128057, -113.30512410476986, -4.835691943583541, -4.6004141802979515, 18.882399064762186, -29.081725203250908, 61.396690938047385, -3.7727836252193248, 41.45561767102913, 12.718288200984016, -35.59518713077544, -47.94664037203502, 45.87768959038169, 38.29522092061522, -168.3420928065202, -21.06197337959185, 21.81267659953013, -19.649772667302695, 130.6176926285651, -15.689056667008305, -41.34124833900219, 18.803761715485518, 90.10492804830467, -113.60902018129278, 21.590707352065472, -58.93186067853729, -185.85002413374053, 0.7972527242566141, -39.36862723424399, 151.74804485499436, -19.590887769092173, 1.0925962143954138, 169.30999999999992, -6.911426379275083, -15.390952206578598, -17.259688849428123, 10.342384220197605, 1.074627263794472, 112.67019800480506, -111.34512587900896, -121.0685510019249, -13.239981126643576, 40.62008759293297, -4.537423021383189, -49.95544642070672, 1.1300740635168298, -3.863169307131569, 14.362897766826391, -84.50654495960251, -71.94229793039287, -9.916741599587773, 81.31448259228029, 166.61320901117534, -4.038642255359642, -29.52730275617678, -8.249602072447486, -152.68169497632283, -3.929837179467836, 42.29352880269221, -35.323209008760195, -2.4226945430344458, -6.047484382203885, -1.885590198859787, -22.58351727795291, 72.77057012007641, 57.93196741190695, -235.8856130906391, 29.8800135852997, 55.94821278649687, 2.0000000000000013, -10.079690948684679, -21.257967787145784, -6.320134459813346, -30.068535988802857, -6.545714307804257, -12.0363651394858, -15.230765618690262, -22.35587656026077, 94.31366438599342, -7.826514654515565, -9.287808394037988, -8.335588378679095, -47.23758448425054, -106.80706220167743, -24.22145836142594, 73.87032845032076, -2.033797644940453, -43.286407560342916, -137.94502150020207, -173.5510893000174, -1.9084199924650886, -152.62775569909041, -159.34182790326994, -11.077167792043719, -41.12406318834814, -23.25216294950651, -46.18490859810345, -8.754788124781479, -276.5751351134279, -57.63243526093273, -15.305960448482832, -175.59811860747814, 0.8990403117636286, -78.25640242149426, -11.455925000661596, -8.754764705159705, -1.373464654202578, -255.4072448185019, -124.75302482846502, 131.42241116473662], "policy_predator_policy_reward": [145.07251465149102, 226.82735255948157, 188.99441580070803, 115.62791127926539, 85.7967839511299, 22.671613966487314, 78.10648748117178, 29.032719531154264, 161.28740126194154, 165.19923497042868, 225.9470149438824, 197.4097675524837, 119.8160189092624, 101.22104558761983, 234.62048380165086, 165.0338874149747, 265.62618675178976, 237.52712933436527, 75.20500499642036, 141.4860309716161, 17.63323907683218, 11.897013398689552, 125.65410796023247, 146.0780152445622, 242.8395161535019, 225.1756970214186, 50.885337647804725, 78.89095062667437, 220.1433697629954, 276.1254694292177, 161.97294754352546, 189.60329848928507, 165.38699485878504, 177.1146061567996, 187.1298104649372, 100.85040636267952, 21.92511651266313, 29.952995604524663, 34.57208995774631, 14.333612345260153, 150.46199139529668, 248.73853953572322, 36.400888072855565, 28.006901462722585, 94.67784431432686, 110.08664979714752, 167.8223984116558, 153.35002135882957, 107.8908366596086, 123.97527888711411, 9.52343356407705, 12.28256620159879, 38.78556869085705, 27.37779197464512, 61.26158135291116, 60.78471473855915, 96.6769386996298, 31.410721750051522, 124.26264515866492, 72.48011510578274, 28.931318133796506, 14.742150988156371, 242.31539422339978, 167.59244580202287, 16.668259791674945, 21.06714445167118, 200.62051812397993, 157.44331750519893, 200.688006738178, 89.19632511213017, 213.17472019683387, 146.47019397704906, 74.33107805400961, 69.1387261685781, 0.0, 9.49028291383022, 133.1098532396184, 128.77464321682177, 27.999450382208348, 28.886764497163323, 12.24833835148381, 102.01500966019461, 22.333470651979837, 64.0788705542278, 79.39075455899824, 63.566541646813675, 22.62888733494047, 5.064518215838546, 69.64713789597802, 62.91430053061046, 116.24845998055193, 110.92814444886828, 6.795691943583499, 6.56041418029791, 122.78652608494319, 76.51119798506612, 85.3208042437654, 57.095519205428864, 125.9953503772766, 45.66415074976015, 77.38708551061357, 118.3111958836615, 61.83020304463277, 83.14244660478585, 124.69419083667252, 155.63141022594698, 67.20408223947925, 37.19627310213327, 22.73433785727242, 12.37417689704785, 101.43560521286341, 94.8568703396839, 151.3330383927087, 134.81907658675408, 162.27777493293323, 87.83852263261701, 173.25186821620048, 193.3932423611876, 89.75665153666927, 80.39244231638527, 81.67778900602055, 86.14180900889284, 0.0, 8.841426379275042, 22.00985124824596, 3.709438354273547, 81.89232915856486, 66.95665026172667, 47.02754411552988, 179.13986343654034, 173.3466807287829, 27.785258443959552, 80.79198330857733, 27.35126476421707, 110.23746317941007, 27.181879669887802, 10.264094691219082, 98.54323887150989, 174.05986525607472, 78.02565350472241, 32.71188838297969, 64.70247169925784, 84.36942250173317, 11.795798898065181, 80.39855232961534, 71.5978822953226, 93.76731059897611, 152.73947837693666, 66.96647119730777, 37.17320900875983, 86.16629045017154, 80.37198065654717, 84.79001715971572, 95.2820214700907, 77.80003344120712, 61.328432923785044, 244.42219508879896, 219.105954340284, 71.48157596537722, 31.438032491068913, 23.343725587200684, 12.158132984056481, 80.02693175345732, 68.11810836280856, 8.495714307804215, 13.92636513948576, 17.130765618690422, 24.245876560261067, 46.32949251139363, 6.7542595063900706, 16.012682673886726, 78.85489088885775, 186.24940904096698, 74.47110130770847, 63.11851502958324, 24.18667502190921, 69.49951030694471, 100.23386791078737, 228.4229793323107, 80.76312232636569, 67.1691762403693, 168.65387838896913, 115.71476120354396, 157.52548538288707, 78.86542004793571, 77.67121970069974, 117.41164172821368, 66.10559485946821, 271.2981766249641, 118.50398404680809, 165.3585023338456, 155.4336815594751, 93.77322896088671, 86.77571852448561, 0.0, 14.727678015117007, 158.95825716090306, 174.47880798841365, 146.9668597602259, 102.28373738537927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8259817698074001, "mean_inference_ms": 2.6816404514102397, "mean_action_processing_ms": 0.36044727553942607, "mean_env_wait_ms": 0.2962622545074792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01208043098449707, "StateBufferConnector_ms": 0.003321409225463867, "ViewRequirementAgentConnector_ms": 0.10650193691253662}, "num_episodes": 18, "episode_return_max": 317.4941683288089, "episode_return_min": -6.931351453487796, "episode_return_mean": 137.14091630070936, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.26591609608374, "num_env_steps_trained_throughput_per_sec": 341.26591609608374, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 12280.835, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12280.796, "sample_time_ms": 1668.546, "learn_time_ms": 10597.398, "learn_throughput": 377.451, "synch_weights_time_ms": 13.804}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "6c58f_00000", "date": "2024-08-16_16-27-51", "timestamp": 1723805871, "time_this_iter_s": 11.726524114608765, "time_total_s": 1252.4711260795593, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b334ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1252.4711260795593, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 46.400000000000006, "ram_util_percent": 72.87058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.240557682151517, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.243847612350706, "policy_loss": -0.008343846695349802, "vf_loss": 7.251008926371418, "vf_explained_var": -0.0003564715700805503, "kl": 0.016610769027209205, "entropy": 1.3642480161454942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7017509314591293, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.809987909579403, "policy_loss": -0.0077674972885115835, "vf_loss": 5.817753453986355, "vf_explained_var": -0.28627095134169966, "kl": 0.009996618535717016, "entropy": 1.1915300564160423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 317.4941683288089, "episode_reward_min": -9.093574534125224, "episode_reward_mean": 131.73695849785094, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -366.562558695111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.30999999999992, "predator_policy": 302.8598738825828}, "policy_reward_mean": {"prey_policy": -34.44712367971698, "predator_policy": 100.3156029286424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [116.44411563509786, 317.4941683288089, 236.89114817843299, 3.8199999999999625, 283.6612767865298, 134.0117389120918, 104.18263421407431, 234.84170358492827, 4.1272224776167405, 126.24257770078799, 3.749999999999963, 135.38874125521585, 208.5154598076616, 98.35876522143532, 132.24358858562192, 3.92999999999996, 164.54219966251617, 135.33000000000033, 291.94131809490455, 302.92746388247326, 158.85364653648352, 6.533285165289544, 294.6454643252691, 243.0764571359306, 3.919999999999961, 189.09839793152057, 200.04023076202182, 225.83340699904946, 112.15645389146533, 229.1455601604155, 90.92153487650779, 106.56325927383995, 150.03715071587698, 173.75498892903062, 262.6480228464749, 212.77514423907832, 181.5923391679041, 282.52851147380477, 149.3213064602167, 171.23999999999972, -6.931351453487796, 160.26599090428348, 227.4924796778663, 66.82340704417372, 144.22591264434442, 88.5939704921083, 119.3070620224241, 95.63667587080171, 168.81210107493007, 258.7397881556138, 114.21952979631399, 89.89525682012284, 111.11000000000023, 158.06809218148086, 155.60293115299368, 269.83100389697546, 257.5225499237435, 160.8678212429431, 4.1641998354264, 111.75636966764996, 3.8399999999999626, 3.7899999999999627, 139.57090174926162, 77.24417679002815, 106.67586366274764, 136.95406014038704, 124.4131730124492, -2.310009141543045, 81.28687893778337, 102.82125089111727, 92.16041361078098, 128.57753986479742, 55.59459029741205, 129.88810483735998, 103.1915853756421, -5.483011690704291, 76.6563556766124, 255.9199834818762, 99.08576667319154, 115.34429948321976, 186.07233386276272, 220.85009143799147, 30.706487948733812, 75.66808237402118, 178.15867046449642, 74.33451069945502, 291.9638183187937, 85.50198629773627, 58.20593008203432, 159.98476063191313, 155.66602280918727, 68.4270978293087, 55.87476420460206, 4.7075712500545634, 103.00070082253232, 153.84277124547083, 116.67637320400549, -9.093574534125224, 94.73245301461351, 3.8599999999999612], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-48.94615890355752, -39.37421957281983, -116.12645875646817, 112.44820731479182, 65.11665585132334, -60.09162321961263, -7.613433564077091, -10.372566201598831, 101.57725251344397, 115.92066360758389, -2.461799718170912, 14.427242538791832, -12.129563767436313, -11.775462468171007, 0.030654502170907705, 38.068288818309945, -24.83808778466842, -14.708158859667332, -277.4832471689058, -6.182015155729246, -19.23622590651949, -14.74917833682628, -169.3576922091286, -53.31740216483545, -138.284968480265, 56.91609643761825, -27.697036280723463, -233.58911267172456, -4.8211604725527835, -6.405055164413509, 2.0000000000000013, -7.56028291383026, -1.5160802223820724, -95.82621657154186, 105.44054961779172, -26.996764497163028, 54.25140043248108, 123.42656965074515, 150.6901328423166, 65.82498983394945, 23.340242359267386, -7.443892028595734, -2.77585961753189, -18.384260767957244, 88.64481535078052, 73.4392105479003, 129.20497681128057, -113.30512410476986, -4.835691943583541, -4.6004141802979515, 18.882399064762186, -29.081725203250908, 61.396690938047385, -3.7727836252193248, 41.45561767102913, 12.718288200984016, -35.59518713077544, -47.94664037203502, 45.87768959038169, 38.29522092061522, -168.3420928065202, -21.06197337959185, 21.81267659953013, -19.649772667302695, 130.6176926285651, -15.689056667008305, -41.34124833900219, 18.803761715485518, 90.10492804830467, -113.60902018129278, 21.590707352065472, -58.93186067853729, -185.85002413374053, 0.7972527242566141, -39.36862723424399, 151.74804485499436, -19.590887769092173, 1.0925962143954138, 169.30999999999992, -6.911426379275083, -15.390952206578598, -17.259688849428123, 10.342384220197605, 1.074627263794472, 112.67019800480506, -111.34512587900896, -121.0685510019249, -13.239981126643576, 40.62008759293297, -4.537423021383189, -49.95544642070672, 1.1300740635168298, -3.863169307131569, 14.362897766826391, -84.50654495960251, -71.94229793039287, -9.916741599587773, 81.31448259228029, 166.61320901117534, -4.038642255359642, -29.52730275617678, -8.249602072447486, -152.68169497632283, -3.929837179467836, 42.29352880269221, -35.323209008760195, -2.4226945430344458, -6.047484382203885, -1.885590198859787, -22.58351727795291, 72.77057012007641, 57.93196741190695, -235.8856130906391, 29.8800135852997, 55.94821278649687, 2.0000000000000013, -10.079690948684679, -21.257967787145784, -6.320134459813346, -30.068535988802857, -6.545714307804257, -12.0363651394858, -15.230765618690262, -22.35587656026077, 94.31366438599342, -7.826514654515565, -9.287808394037988, -8.335588378679095, -47.23758448425054, -106.80706220167743, -24.22145836142594, 73.87032845032076, -2.033797644940453, -43.286407560342916, -137.94502150020207, -173.5510893000174, -1.9084199924650886, -152.62775569909041, -159.34182790326994, -11.077167792043719, -41.12406318834814, -23.25216294950651, -46.18490859810345, -8.754788124781479, -276.5751351134279, -57.63243526093273, -15.305960448482832, -175.59811860747814, 0.8990403117636286, -78.25640242149426, -11.455925000661596, -8.754764705159705, -1.373464654202578, -255.4072448185019, -124.75302482846502, 131.42241116473662, -187.5600487953125, -12.765896800870891, 0.42902277433701314, -195.456614143093, -102.30824425089003, -131.62751740818297, -286.17953198093466, -92.50100820993745, -114.02566720114544, -6.248282198384203, -165.80693199299566, -4.26783969553216, -37.84222461796852, -152.50361696018953, -173.81764535732714, -111.10387639448437, 3.4042522708152827, 30.626449994960744, -65.3043956506791, -317.0055752539425, -177.62968660634192, -25.086123665108303, -2.294778951584031, -238.60278021140883, -366.562558695111, -11.709425418716824, -28.39359392094743, -4.091579209945853, -242.79684313523586, -125.67210190715012, -4.675245843181668, -0.5261028447304783, 0.4687390983390913, -190.9014111657995, -32.639709210400056, 1.0255580538263265, -65.48088678616995, -106.7183420982169, -177.38434363037592, -216.2781201014203, -306.8122272703475, -23.06814746368951, -14.622690511123583, -12.876751982357636], "policy_predator_policy_reward": [94.67784431432686, 110.08664979714752, 167.8223984116558, 153.35002135882957, 107.8908366596086, 123.97527888711411, 9.52343356407705, 12.28256620159879, 38.78556869085705, 27.37779197464512, 61.26158135291116, 60.78471473855915, 96.6769386996298, 31.410721750051522, 124.26264515866492, 72.48011510578274, 28.931318133796506, 14.742150988156371, 242.31539422339978, 167.59244580202287, 16.668259791674945, 21.06714445167118, 200.62051812397993, 157.44331750519893, 200.688006738178, 89.19632511213017, 213.17472019683387, 146.47019397704906, 74.33107805400961, 69.1387261685781, 0.0, 9.49028291383022, 133.1098532396184, 128.77464321682177, 27.999450382208348, 28.886764497163323, 12.24833835148381, 102.01500966019461, 22.333470651979837, 64.0788705542278, 79.39075455899824, 63.566541646813675, 22.62888733494047, 5.064518215838546, 69.64713789597802, 62.91430053061046, 116.24845998055193, 110.92814444886828, 6.795691943583499, 6.56041418029791, 122.78652608494319, 76.51119798506612, 85.3208042437654, 57.095519205428864, 125.9953503772766, 45.66415074976015, 77.38708551061357, 118.3111958836615, 61.83020304463277, 83.14244660478585, 124.69419083667252, 155.63141022594698, 67.20408223947925, 37.19627310213327, 22.73433785727242, 12.37417689704785, 101.43560521286341, 94.8568703396839, 151.3330383927087, 134.81907658675408, 162.27777493293323, 87.83852263261701, 173.25186821620048, 193.3932423611876, 89.75665153666927, 80.39244231638527, 81.67778900602055, 86.14180900889284, 0.0, 8.841426379275042, 22.00985124824596, 3.709438354273547, 81.89232915856486, 66.95665026172667, 47.02754411552988, 179.13986343654034, 173.3466807287829, 27.785258443959552, 80.79198330857733, 27.35126476421707, 110.23746317941007, 27.181879669887802, 10.264094691219082, 98.54323887150989, 174.05986525607472, 78.02565350472241, 32.71188838297969, 64.70247169925784, 84.36942250173317, 11.795798898065181, 80.39855232961534, 71.5978822953226, 93.76731059897611, 152.73947837693666, 66.96647119730777, 37.17320900875983, 86.16629045017154, 80.37198065654717, 84.79001715971572, 95.2820214700907, 77.80003344120712, 61.328432923785044, 244.42219508879896, 219.105954340284, 71.48157596537722, 31.438032491068913, 23.343725587200684, 12.158132984056481, 80.02693175345732, 68.11810836280856, 8.495714307804215, 13.92636513948576, 17.130765618690422, 24.245876560261067, 46.32949251139363, 6.7542595063900706, 16.012682673886726, 78.85489088885775, 186.24940904096698, 74.47110130770847, 63.11851502958324, 24.18667502190921, 69.49951030694471, 100.23386791078737, 228.4229793323107, 80.76312232636569, 67.1691762403693, 168.65387838896913, 115.71476120354396, 157.52548538288707, 78.86542004793571, 77.67121970069974, 117.41164172821368, 66.10559485946821, 271.2981766249641, 118.50398404680809, 165.3585023338456, 155.4336815594751, 93.77322896088671, 86.77571852448561, 0.0, 14.727678015117007, 158.95825716090306, 174.47880798841365, 146.9668597602259, 102.28373738537927, 175.8253042936938, 123.5864079756808, 139.08558709330927, 171.28630375866618, 218.66906471569771, 201.339030806138, 302.8598738825828, 296.6707577462804, 115.99612621615837, 34.98431113210527, 148.19805994845413, 97.54479411409454, 210.0577049506105, 158.44680709204377, 157.68614507256407, 201.56988737870228, 153.49718844180057, 104.43592761121705, 235.91676786060884, 231.89518934174842, 167.98551100569975, 92.93622934778521, 190.1057770229135, 210.77654277199255, 272.3538967927018, 261.58411013031366, 51.27551483091582, 49.63675612928621, 257.7699153363149, 166.57379391067343, 4.635948068104003, 5.272971869862712, 137.46154699190478, 155.97182589808722, 94.5865465648005, 90.8703758372439, 161.21461913024868, 127.66098295814417, 272.10518565609954, 112.4637035415714, 279.55349588897, 145.05933185967956, 16.572690511123643, 14.786751982357595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8242288200261165, "mean_inference_ms": 2.6779374382718184, "mean_action_processing_ms": 0.3598036750753904, "mean_env_wait_ms": 0.29556912486792797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046427249908447266, "StateBufferConnector_ms": 0.003337264060974121, "ViewRequirementAgentConnector_ms": 0.10726988315582275}, "num_episodes": 22, "episode_return_max": 317.4941683288089, "episode_return_min": -9.093574534125224, "episode_return_mean": 131.73695849785094, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.3485225677122, "num_env_steps_trained_throughput_per_sec": 324.3485225677122, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 12215.729, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12215.69, "sample_time_ms": 1639.343, "learn_time_ms": 10560.582, "learn_throughput": 378.767, "synch_weights_time_ms": 14.697}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "6c58f_00000", "date": "2024-08-16_16-28-03", "timestamp": 1723805883, "time_this_iter_s": 12.338948249816895, "time_total_s": 1264.8100743293762, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b07da310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1264.8100743293762, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 46.1, "ram_util_percent": 73.04705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4702736719417824, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 5.916318525586809, "policy_loss": -0.005671240415463529, "vf_loss": 5.92110754573156, "vf_explained_var": 0.00036688418615432014, "kl": 0.012392223429824581, "entropy": 1.3700558364075959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6634657110171343, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.138041180782217, "policy_loss": -0.006628586238289557, "vf_loss": 5.144668063915596, "vf_explained_var": 0.1894049853874893, "kl": 0.008711666228543045, "entropy": 1.139972090405762, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 302.92746388247326, "episode_reward_min": -9.093574534125224, "episode_reward_mean": 133.01377175165794, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -366.562558695111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 169.30999999999992, "predator_policy": 302.8598738825828}, "policy_reward_mean": {"prey_policy": -36.089340724050864, "predator_policy": 102.5962265998798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.94131809490455, 302.92746388247326, 158.85364653648352, 6.533285165289544, 294.6454643252691, 243.0764571359306, 3.919999999999961, 189.09839793152057, 200.04023076202182, 225.83340699904946, 112.15645389146533, 229.1455601604155, 90.92153487650779, 106.56325927383995, 150.03715071587698, 173.75498892903062, 262.6480228464749, 212.77514423907832, 181.5923391679041, 282.52851147380477, 149.3213064602167, 171.23999999999972, -6.931351453487796, 160.26599090428348, 227.4924796778663, 66.82340704417372, 144.22591264434442, 88.5939704921083, 119.3070620224241, 95.63667587080171, 168.81210107493007, 258.7397881556138, 114.21952979631399, 89.89525682012284, 111.11000000000023, 158.06809218148086, 155.60293115299368, 269.83100389697546, 257.5225499237435, 160.8678212429431, 4.1641998354264, 111.75636966764996, 3.8399999999999626, 3.7899999999999627, 139.57090174926162, 77.24417679002815, 106.67586366274764, 136.95406014038704, 124.4131730124492, -2.310009141543045, 81.28687893778337, 102.82125089111727, 92.16041361078098, 128.57753986479742, 55.59459029741205, 129.88810483735998, 103.1915853756421, -5.483011690704291, 76.6563556766124, 255.9199834818762, 99.08576667319154, 115.34429948321976, 186.07233386276272, 220.85009143799147, 30.706487948733812, 75.66808237402118, 178.15867046449642, 74.33451069945502, 291.9638183187937, 85.50198629773627, 58.20593008203432, 159.98476063191313, 155.66602280918727, 68.4270978293087, 55.87476420460206, 4.7075712500545634, 103.00070082253232, 153.84277124547083, 116.67637320400549, -9.093574534125224, 94.73245301461351, 3.8599999999999612, 268.13049827833436, 4.58070197921001, 214.7625503280618, 100.10357324813664, 125.34404142336354, 134.84780471993483, 128.11143936435903, 131.02283743093395, 162.035268247613, 162.53194184315328, 147.5708419073267, 3.8899999999999606, 212.02761890172167, 207.61749145494284, 117.62052253652864, 275.51932207870743, 3.7899999999999627, 171.95021198919255], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.25140043248108, 123.42656965074515, 150.6901328423166, 65.82498983394945, 23.340242359267386, -7.443892028595734, -2.77585961753189, -18.384260767957244, 88.64481535078052, 73.4392105479003, 129.20497681128057, -113.30512410476986, -4.835691943583541, -4.6004141802979515, 18.882399064762186, -29.081725203250908, 61.396690938047385, -3.7727836252193248, 41.45561767102913, 12.718288200984016, -35.59518713077544, -47.94664037203502, 45.87768959038169, 38.29522092061522, -168.3420928065202, -21.06197337959185, 21.81267659953013, -19.649772667302695, 130.6176926285651, -15.689056667008305, -41.34124833900219, 18.803761715485518, 90.10492804830467, -113.60902018129278, 21.590707352065472, -58.93186067853729, -185.85002413374053, 0.7972527242566141, -39.36862723424399, 151.74804485499436, -19.590887769092173, 1.0925962143954138, 169.30999999999992, -6.911426379275083, -15.390952206578598, -17.259688849428123, 10.342384220197605, 1.074627263794472, 112.67019800480506, -111.34512587900896, -121.0685510019249, -13.239981126643576, 40.62008759293297, -4.537423021383189, -49.95544642070672, 1.1300740635168298, -3.863169307131569, 14.362897766826391, -84.50654495960251, -71.94229793039287, -9.916741599587773, 81.31448259228029, 166.61320901117534, -4.038642255359642, -29.52730275617678, -8.249602072447486, -152.68169497632283, -3.929837179467836, 42.29352880269221, -35.323209008760195, -2.4226945430344458, -6.047484382203885, -1.885590198859787, -22.58351727795291, 72.77057012007641, 57.93196741190695, -235.8856130906391, 29.8800135852997, 55.94821278649687, 2.0000000000000013, -10.079690948684679, -21.257967787145784, -6.320134459813346, -30.068535988802857, -6.545714307804257, -12.0363651394858, -15.230765618690262, -22.35587656026077, 94.31366438599342, -7.826514654515565, -9.287808394037988, -8.335588378679095, -47.23758448425054, -106.80706220167743, -24.22145836142594, 73.87032845032076, -2.033797644940453, -43.286407560342916, -137.94502150020207, -173.5510893000174, -1.9084199924650886, -152.62775569909041, -159.34182790326994, -11.077167792043719, -41.12406318834814, -23.25216294950651, -46.18490859810345, -8.754788124781479, -276.5751351134279, -57.63243526093273, -15.305960448482832, -175.59811860747814, 0.8990403117636286, -78.25640242149426, -11.455925000661596, -8.754764705159705, -1.373464654202578, -255.4072448185019, -124.75302482846502, 131.42241116473662, -187.5600487953125, -12.765896800870891, 0.42902277433701314, -195.456614143093, -102.30824425089003, -131.62751740818297, -286.17953198093466, -92.50100820993745, -114.02566720114544, -6.248282198384203, -165.80693199299566, -4.26783969553216, -37.84222461796852, -152.50361696018953, -173.81764535732714, -111.10387639448437, 3.4042522708152827, 30.626449994960744, -65.3043956506791, -317.0055752539425, -177.62968660634192, -25.086123665108303, -2.294778951584031, -238.60278021140883, -366.562558695111, -11.709425418716824, -28.39359392094743, -4.091579209945853, -242.79684313523586, -125.67210190715012, -4.675245843181668, -0.5261028447304783, 0.4687390983390913, -190.9014111657995, -32.639709210400056, 1.0255580538263265, -65.48088678616995, -106.7183420982169, -177.38434363037592, -216.2781201014203, -306.8122272703475, -23.06814746368951, -14.622690511123583, -12.876751982357636, -3.58307554994657, -151.5388268435749, -32.07516215181525, -22.425356617326056, 44.371882478985796, -123.91468038049769, 0.33327184160687295, -2.486868256219836, -5.413518640394838, 55.13570197809022, 0.4027522613131782, -0.6926957212605525, 0.9171873325357275, -59.13377065961136, -16.4348253419645, 32.49287442351148, -93.40143460878721, 7.5848853884475345, 100.36709488713892, -8.686297962808018, -258.1663337180829, -1.2239331898452135, -2.3524442692825147, -19.35387957126793, -126.46920588460672, -121.94903642676897, -1.64326348073527, -243.03151558247995, -240.02694936450885, -28.528636228747978, 66.01002899122398, 10.951650191081058, -0.7201138758785328, -27.017347707678894, -19.232481268889384, 142.97655483130455], "policy_predator_policy_reward": [12.24833835148381, 102.01500966019461, 22.333470651979837, 64.0788705542278, 79.39075455899824, 63.566541646813675, 22.62888733494047, 5.064518215838546, 69.64713789597802, 62.91430053061046, 116.24845998055193, 110.92814444886828, 6.795691943583499, 6.56041418029791, 122.78652608494319, 76.51119798506612, 85.3208042437654, 57.095519205428864, 125.9953503772766, 45.66415074976015, 77.38708551061357, 118.3111958836615, 61.83020304463277, 83.14244660478585, 124.69419083667252, 155.63141022594698, 67.20408223947925, 37.19627310213327, 22.73433785727242, 12.37417689704785, 101.43560521286341, 94.8568703396839, 151.3330383927087, 134.81907658675408, 162.27777493293323, 87.83852263261701, 173.25186821620048, 193.3932423611876, 89.75665153666927, 80.39244231638527, 81.67778900602055, 86.14180900889284, 0.0, 8.841426379275042, 22.00985124824596, 3.709438354273547, 81.89232915856486, 66.95665026172667, 47.02754411552988, 179.13986343654034, 173.3466807287829, 27.785258443959552, 80.79198330857733, 27.35126476421707, 110.23746317941007, 27.181879669887802, 10.264094691219082, 98.54323887150989, 174.05986525607472, 78.02565350472241, 32.71188838297969, 64.70247169925784, 84.36942250173317, 11.795798898065181, 80.39855232961534, 71.5978822953226, 93.76731059897611, 152.73947837693666, 66.96647119730777, 37.17320900875983, 86.16629045017154, 80.37198065654717, 84.79001715971572, 95.2820214700907, 77.80003344120712, 61.328432923785044, 244.42219508879896, 219.105954340284, 71.48157596537722, 31.438032491068913, 23.343725587200684, 12.158132984056481, 80.02693175345732, 68.11810836280856, 8.495714307804215, 13.92636513948576, 17.130765618690422, 24.245876560261067, 46.32949251139363, 6.7542595063900706, 16.012682673886726, 78.85489088885775, 186.24940904096698, 74.47110130770847, 63.11851502958324, 24.18667502190921, 69.49951030694471, 100.23386791078737, 228.4229793323107, 80.76312232636569, 67.1691762403693, 168.65387838896913, 115.71476120354396, 157.52548538288707, 78.86542004793571, 77.67121970069974, 117.41164172821368, 66.10559485946821, 271.2981766249641, 118.50398404680809, 165.3585023338456, 155.4336815594751, 93.77322896088671, 86.77571852448561, 0.0, 14.727678015117007, 158.95825716090306, 174.47880798841365, 146.9668597602259, 102.28373738537927, 175.8253042936938, 123.5864079756808, 139.08558709330927, 171.28630375866618, 218.66906471569771, 201.339030806138, 302.8598738825828, 296.6707577462804, 115.99612621615837, 34.98431113210527, 148.19805994845413, 97.54479411409454, 210.0577049506105, 158.44680709204377, 157.68614507256407, 201.56988737870228, 153.49718844180057, 104.43592761121705, 235.91676786060884, 231.89518934174842, 167.98551100569975, 92.93622934778521, 190.1057770229135, 210.77654277199255, 272.3538967927018, 261.58411013031366, 51.27551483091582, 49.63675612928621, 257.7699153363149, 166.57379391067343, 4.635948068104003, 5.272971869862712, 137.46154699190478, 155.97182589808722, 94.5865465648005, 90.8703758372439, 161.21461913024868, 127.66098295814417, 272.10518565609954, 112.4637035415714, 279.55349588897, 145.05933185967956, 16.572690511123643, 14.786751982357595, 222.77695628312304, 200.47544438873308, 32.60171536724497, 26.47950538110632, 126.78244994724437, 167.52289828232915, 87.50045541067871, 14.756714252070816, 24.791119635852056, 50.83073844981557, 81.3492196561851, 53.78852852369668, 87.94257936883054, 98.38544332260388, 62.81605482493092, 52.14873352445606, 157.82161970192075, 90.03019776603197, 53.01179889493614, 17.839346023886197, 193.25904490343237, 213.70206391182245, 4.322444269282473, 21.273879571268232, 223.4270569797417, 237.01880423335518, 201.67713638574722, 250.61513413241136, 192.76718720006173, 193.40892092972373, 86.02961915983002, 112.52802373657235, 2.700113875878519, 28.827347707679177, 34.05446512538591, 14.151673301391929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8228465236091259, "mean_inference_ms": 2.6755049978021908, "mean_action_processing_ms": 0.3592337809163025, "mean_env_wait_ms": 0.2950043253931518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004796743392944336, "StateBufferConnector_ms": 0.004342794418334961, "ViewRequirementAgentConnector_ms": 0.12026238441467285}, "num_episodes": 18, "episode_return_max": 302.92746388247326, "episode_return_min": -9.093574534125224, "episode_return_mean": 133.01377175165794, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.45877498461573, "num_env_steps_trained_throughput_per_sec": 305.45877498461573, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 12336.65, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12336.614, "sample_time_ms": 1756.239, "learn_time_ms": 10564.526, "learn_throughput": 378.626, "synch_weights_time_ms": 14.761}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "6c58f_00000", "date": "2024-08-16_16-28-16", "timestamp": 1723805896, "time_this_iter_s": 13.099462747573853, "time_total_s": 1277.90953707695, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b338e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1277.90953707695, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 51.56842105263158, "ram_util_percent": 75.22105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.438649115802119, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 4.512004195319282, "policy_loss": -0.00758565983626617, "vf_loss": 4.518949468930562, "vf_explained_var": 0.000939675456001645, "kl": 0.008995338060996633, "entropy": 1.3647349540518705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.033793439026232, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 6.204605627312231, "policy_loss": -0.007663706314217832, "vf_loss": 6.212267106172269, "vf_explained_var": 0.2811150631891987, "kl": 0.011423205101657648, "entropy": 1.0192424522505865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 303.8343375725909, "episode_reward_min": -9.093574534125224, "episode_reward_mean": 133.6591306938971, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -366.562558695111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.1507509349268, "predator_policy": 302.8598738825828}, "policy_reward_mean": {"prey_policy": -36.26856216004285, "predator_policy": 103.09812750699139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.26599090428348, 227.4924796778663, 66.82340704417372, 144.22591264434442, 88.5939704921083, 119.3070620224241, 95.63667587080171, 168.81210107493007, 258.7397881556138, 114.21952979631399, 89.89525682012284, 111.11000000000023, 158.06809218148086, 155.60293115299368, 269.83100389697546, 257.5225499237435, 160.8678212429431, 4.1641998354264, 111.75636966764996, 3.8399999999999626, 3.7899999999999627, 139.57090174926162, 77.24417679002815, 106.67586366274764, 136.95406014038704, 124.4131730124492, -2.310009141543045, 81.28687893778337, 102.82125089111727, 92.16041361078098, 128.57753986479742, 55.59459029741205, 129.88810483735998, 103.1915853756421, -5.483011690704291, 76.6563556766124, 255.9199834818762, 99.08576667319154, 115.34429948321976, 186.07233386276272, 220.85009143799147, 30.706487948733812, 75.66808237402118, 178.15867046449642, 74.33451069945502, 291.9638183187937, 85.50198629773627, 58.20593008203432, 159.98476063191313, 155.66602280918727, 68.4270978293087, 55.87476420460206, 4.7075712500545634, 103.00070082253232, 153.84277124547083, 116.67637320400549, -9.093574534125224, 94.73245301461351, 3.8599999999999612, 268.13049827833436, 4.58070197921001, 214.7625503280618, 100.10357324813664, 125.34404142336354, 134.84780471993483, 128.11143936435903, 131.02283743093395, 162.035268247613, 162.53194184315328, 147.5708419073267, 3.8899999999999606, 212.02761890172167, 207.61749145494284, 117.62052253652864, 275.51932207870743, 3.7899999999999627, 171.95021198919255, 266.4031154011068, 159.83268494156175, 208.3270180571781, 303.8343375725909, 98.57347606806017, 108.96232100336871, 3.869999999999962, 124.83669142990814, 3.869999999999962, 170.9799999999999, 183.15999999999974, 152.02520510745506, 300.14725314025344, 207.24995421056593, 188.9823155763513, 194.89565195637095, 288.6445139491924, 168.800073530709, 251.73721850723527, 3.9099999999999606, 162.2399352405261, 303.8122126124461, 242.06450733311001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [10.342384220197605, 1.074627263794472, 112.67019800480506, -111.34512587900896, -121.0685510019249, -13.239981126643576, 40.62008759293297, -4.537423021383189, -49.95544642070672, 1.1300740635168298, -3.863169307131569, 14.362897766826391, -84.50654495960251, -71.94229793039287, -9.916741599587773, 81.31448259228029, 166.61320901117534, -4.038642255359642, -29.52730275617678, -8.249602072447486, -152.68169497632283, -3.929837179467836, 42.29352880269221, -35.323209008760195, -2.4226945430344458, -6.047484382203885, -1.885590198859787, -22.58351727795291, 72.77057012007641, 57.93196741190695, -235.8856130906391, 29.8800135852997, 55.94821278649687, 2.0000000000000013, -10.079690948684679, -21.257967787145784, -6.320134459813346, -30.068535988802857, -6.545714307804257, -12.0363651394858, -15.230765618690262, -22.35587656026077, 94.31366438599342, -7.826514654515565, -9.287808394037988, -8.335588378679095, -47.23758448425054, -106.80706220167743, -24.22145836142594, 73.87032845032076, -2.033797644940453, -43.286407560342916, -137.94502150020207, -173.5510893000174, -1.9084199924650886, -152.62775569909041, -159.34182790326994, -11.077167792043719, -41.12406318834814, -23.25216294950651, -46.18490859810345, -8.754788124781479, -276.5751351134279, -57.63243526093273, -15.305960448482832, -175.59811860747814, 0.8990403117636286, -78.25640242149426, -11.455925000661596, -8.754764705159705, -1.373464654202578, -255.4072448185019, -124.75302482846502, 131.42241116473662, -187.5600487953125, -12.765896800870891, 0.42902277433701314, -195.456614143093, -102.30824425089003, -131.62751740818297, -286.17953198093466, -92.50100820993745, -114.02566720114544, -6.248282198384203, -165.80693199299566, -4.26783969553216, -37.84222461796852, -152.50361696018953, -173.81764535732714, -111.10387639448437, 3.4042522708152827, 30.626449994960744, -65.3043956506791, -317.0055752539425, -177.62968660634192, -25.086123665108303, -2.294778951584031, -238.60278021140883, -366.562558695111, -11.709425418716824, -28.39359392094743, -4.091579209945853, -242.79684313523586, -125.67210190715012, -4.675245843181668, -0.5261028447304783, 0.4687390983390913, -190.9014111657995, -32.639709210400056, 1.0255580538263265, -65.48088678616995, -106.7183420982169, -177.38434363037592, -216.2781201014203, -306.8122272703475, -23.06814746368951, -14.622690511123583, -12.876751982357636, -3.58307554994657, -151.5388268435749, -32.07516215181525, -22.425356617326056, 44.371882478985796, -123.91468038049769, 0.33327184160687295, -2.486868256219836, -5.413518640394838, 55.13570197809022, 0.4027522613131782, -0.6926957212605525, 0.9171873325357275, -59.13377065961136, -16.4348253419645, 32.49287442351148, -93.40143460878721, 7.5848853884475345, 100.36709488713892, -8.686297962808018, -258.1663337180829, -1.2239331898452135, -2.3524442692825147, -19.35387957126793, -126.46920588460672, -121.94903642676897, -1.64326348073527, -243.03151558247995, -240.02694936450885, -28.528636228747978, 66.01002899122398, 10.951650191081058, -0.7201138758785328, -27.017347707678894, -19.232481268889384, 142.97655483130455, -55.58668433436889, 74.75443910948539, -13.007384943425109, 41.025112303375266, -28.68673138186628, 99.48163671149769, -4.51914104918481, 95.16782742567351, -72.00751757489364, 0.5684959302039739, -10.828466638591602, -18.029980499355453, -2.5390313116967658, -8.534723501783077, 33.774345877188836, -2.516645574167452, -10.931871956543898, -0.8636897225863369, -12.561461535692573, 137.63719877095176, 2.0000000000000013, 178.1507509349268, -8.982655115769079, 16.255817445755273, -31.94345862831544, 144.48954699662625, 31.71777210751837, -2.6193908405305484, 7.335954247185614, -69.10137615415928, -77.64080721191996, -32.371633999625004, -63.10922434370991, 68.55557610990314, 132.3453125251903, -4.509423535803467, 42.92300866991118, -119.135790405692, -18.176443829610996, -1.3747116258494871, -9.666330075102962, -11.659101871650236, 100.19882458964871, 101.5161779957721, -113.93148316011279, 3.680769959302695], "policy_predator_policy_reward": [81.89232915856486, 66.95665026172667, 47.02754411552988, 179.13986343654034, 173.3466807287829, 27.785258443959552, 80.79198330857733, 27.35126476421707, 110.23746317941007, 27.181879669887802, 10.264094691219082, 98.54323887150989, 174.05986525607472, 78.02565350472241, 32.71188838297969, 64.70247169925784, 84.36942250173317, 11.795798898065181, 80.39855232961534, 71.5978822953226, 93.76731059897611, 152.73947837693666, 66.96647119730777, 37.17320900875983, 86.16629045017154, 80.37198065654717, 84.79001715971572, 95.2820214700907, 77.80003344120712, 61.328432923785044, 244.42219508879896, 219.105954340284, 71.48157596537722, 31.438032491068913, 23.343725587200684, 12.158132984056481, 80.02693175345732, 68.11810836280856, 8.495714307804215, 13.92636513948576, 17.130765618690422, 24.245876560261067, 46.32949251139363, 6.7542595063900706, 16.012682673886726, 78.85489088885775, 186.24940904096698, 74.47110130770847, 63.11851502958324, 24.18667502190921, 69.49951030694471, 100.23386791078737, 228.4229793323107, 80.76312232636569, 67.1691762403693, 168.65387838896913, 115.71476120354396, 157.52548538288707, 78.86542004793571, 77.67121970069974, 117.41164172821368, 66.10559485946821, 271.2981766249641, 118.50398404680809, 165.3585023338456, 155.4336815594751, 93.77322896088671, 86.77571852448561, 0.0, 14.727678015117007, 158.95825716090306, 174.47880798841365, 146.9668597602259, 102.28373738537927, 175.8253042936938, 123.5864079756808, 139.08558709330927, 171.28630375866618, 218.66906471569771, 201.339030806138, 302.8598738825828, 296.6707577462804, 115.99612621615837, 34.98431113210527, 148.19805994845413, 97.54479411409454, 210.0577049506105, 158.44680709204377, 157.68614507256407, 201.56988737870228, 153.49718844180057, 104.43592761121705, 235.91676786060884, 231.89518934174842, 167.98551100569975, 92.93622934778521, 190.1057770229135, 210.77654277199255, 272.3538967927018, 261.58411013031366, 51.27551483091582, 49.63675612928621, 257.7699153363149, 166.57379391067343, 4.635948068104003, 5.272971869862712, 137.46154699190478, 155.97182589808722, 94.5865465648005, 90.8703758372439, 161.21461913024868, 127.66098295814417, 272.10518565609954, 112.4637035415714, 279.55349588897, 145.05933185967956, 16.572690511123643, 14.786751982357595, 222.77695628312304, 200.47544438873308, 32.60171536724497, 26.47950538110632, 126.78244994724437, 167.52289828232915, 87.50045541067871, 14.756714252070816, 24.791119635852056, 50.83073844981557, 81.3492196561851, 53.78852852369668, 87.94257936883054, 98.38544332260388, 62.81605482493092, 52.14873352445606, 157.82161970192075, 90.03019776603197, 53.01179889493614, 17.839346023886197, 193.25904490343237, 213.70206391182245, 4.322444269282473, 21.273879571268232, 223.4270569797417, 237.01880423335518, 201.67713638574722, 250.61513413241136, 192.76718720006173, 193.40892092972373, 86.02961915983002, 112.52802373657235, 2.700113875878519, 28.827347707679177, 34.05446512538591, 14.151673301391929, 129.48121744070798, 117.75414318528227, 44.69074506857805, 87.12421251303353, 85.99143539939845, 51.540677328148675, 107.01915942697191, 106.16649176913046, 81.98303429362686, 88.02946341912308, 81.31991124045767, 56.50085690085799, 4.509031311696724, 10.434723501783038, 75.70565412281127, 17.87333700407474, 12.831871956543857, 2.8336897225863225, 14.471461535692532, 31.432801229048252, 1.9972885221991592, 1.0119605428739797, 64.58409473102911, 80.16794804643982, 100.06120019459556, 87.53996457734718, 112.95763418832202, 65.19393875525624, 110.54075612981845, 140.2069813535068, 145.1830033980155, 159.7250897699007, 141.71399100241396, 141.484171180585, 12.429687235007302, 28.53449730631473, 203.75377107589924, 124.19622916711695, 20.1164438296113, 3.344711625849459, 80.55379685858425, 103.01157032869511, 43.75918951524538, 58.338020511779845, 93.53214029631133, 258.7830802376087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8209979821327118, "mean_inference_ms": 2.671650286162051, "mean_action_processing_ms": 0.3583707692475274, "mean_env_wait_ms": 0.29428885504256974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004769444465637207, "StateBufferConnector_ms": 0.004386544227600098, "ViewRequirementAgentConnector_ms": 0.1202627420425415}, "num_episodes": 23, "episode_return_max": 303.8343375725909, "episode_return_min": -9.093574534125224, "episode_return_mean": 133.6591306938971, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.57299410214944, "num_env_steps_trained_throughput_per_sec": 347.57299410214944, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 12289.467, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12289.431, "sample_time_ms": 1776.663, "learn_time_ms": 10497.453, "learn_throughput": 381.045, "synch_weights_time_ms": 14.232}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "6c58f_00000", "date": "2024-08-16_16-28-28", "timestamp": 1723805908, "time_this_iter_s": 11.513633728027344, "time_total_s": 1289.4231708049774, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b338eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1289.4231708049774, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 46.5125, "ram_util_percent": 75.11875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5134016906142866, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 5.318963208652678, "policy_loss": -0.007083879066532645, "vf_loss": 5.324748779983117, "vf_explained_var": 0.0010977558358005745, "kl": 0.018236782734415265, "entropy": 1.368000426935771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.064151141173625, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.461249184986902, "policy_loss": -0.006059647435088342, "vf_loss": 5.467306844267265, "vf_explained_var": 0.1476045740344537, "kl": 0.010165624912745775, "entropy": 0.9946139791339793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 338.91936430659644, "episode_reward_min": -9.093574534125224, "episode_reward_mean": 131.6464939523919, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -366.562558695111, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.1507509349268, "predator_policy": 302.8598738825828}, "policy_reward_mean": {"prey_policy": -36.26147630296324, "predator_policy": 102.08472327915915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.75636966764996, 3.8399999999999626, 3.7899999999999627, 139.57090174926162, 77.24417679002815, 106.67586366274764, 136.95406014038704, 124.4131730124492, -2.310009141543045, 81.28687893778337, 102.82125089111727, 92.16041361078098, 128.57753986479742, 55.59459029741205, 129.88810483735998, 103.1915853756421, -5.483011690704291, 76.6563556766124, 255.9199834818762, 99.08576667319154, 115.34429948321976, 186.07233386276272, 220.85009143799147, 30.706487948733812, 75.66808237402118, 178.15867046449642, 74.33451069945502, 291.9638183187937, 85.50198629773627, 58.20593008203432, 159.98476063191313, 155.66602280918727, 68.4270978293087, 55.87476420460206, 4.7075712500545634, 103.00070082253232, 153.84277124547083, 116.67637320400549, -9.093574534125224, 94.73245301461351, 3.8599999999999612, 268.13049827833436, 4.58070197921001, 214.7625503280618, 100.10357324813664, 125.34404142336354, 134.84780471993483, 128.11143936435903, 131.02283743093395, 162.035268247613, 162.53194184315328, 147.5708419073267, 3.8899999999999606, 212.02761890172167, 207.61749145494284, 117.62052253652864, 275.51932207870743, 3.7899999999999627, 171.95021198919255, 266.4031154011068, 159.83268494156175, 208.3270180571781, 303.8343375725909, 98.57347606806017, 108.96232100336871, 3.869999999999962, 124.83669142990814, 3.869999999999962, 170.9799999999999, 183.15999999999974, 152.02520510745506, 300.14725314025344, 207.24995421056593, 188.9823155763513, 194.89565195637095, 288.6445139491924, 168.800073530709, 251.73721850723527, 3.9099999999999606, 162.2399352405261, 303.8122126124461, 242.06450733311001, 148.3933799875853, 149.97000000000023, 3.829999999999962, 338.91936430659644, 3.8499999999999615, 258.22857340292404, -5.942428663042268, 122.10690972451783, 131.1000000000002, 146.02779633660967, 3.9199999999999604, 119.06000000000033, 143.45773518015463, 243.20822375200493, 208.07289080214562, 102.65551021921692, 157.1771793081923, 175.87996422911573], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.320134459813346, -30.068535988802857, -6.545714307804257, -12.0363651394858, -15.230765618690262, -22.35587656026077, 94.31366438599342, -7.826514654515565, -9.287808394037988, -8.335588378679095, -47.23758448425054, -106.80706220167743, -24.22145836142594, 73.87032845032076, -2.033797644940453, -43.286407560342916, -137.94502150020207, -173.5510893000174, -1.9084199924650886, -152.62775569909041, -159.34182790326994, -11.077167792043719, -41.12406318834814, -23.25216294950651, -46.18490859810345, -8.754788124781479, -276.5751351134279, -57.63243526093273, -15.305960448482832, -175.59811860747814, 0.8990403117636286, -78.25640242149426, -11.455925000661596, -8.754764705159705, -1.373464654202578, -255.4072448185019, -124.75302482846502, 131.42241116473662, -187.5600487953125, -12.765896800870891, 0.42902277433701314, -195.456614143093, -102.30824425089003, -131.62751740818297, -286.17953198093466, -92.50100820993745, -114.02566720114544, -6.248282198384203, -165.80693199299566, -4.26783969553216, -37.84222461796852, -152.50361696018953, -173.81764535732714, -111.10387639448437, 3.4042522708152827, 30.626449994960744, -65.3043956506791, -317.0055752539425, -177.62968660634192, -25.086123665108303, -2.294778951584031, -238.60278021140883, -366.562558695111, -11.709425418716824, -28.39359392094743, -4.091579209945853, -242.79684313523586, -125.67210190715012, -4.675245843181668, -0.5261028447304783, 0.4687390983390913, -190.9014111657995, -32.639709210400056, 1.0255580538263265, -65.48088678616995, -106.7183420982169, -177.38434363037592, -216.2781201014203, -306.8122272703475, -23.06814746368951, -14.622690511123583, -12.876751982357636, -3.58307554994657, -151.5388268435749, -32.07516215181525, -22.425356617326056, 44.371882478985796, -123.91468038049769, 0.33327184160687295, -2.486868256219836, -5.413518640394838, 55.13570197809022, 0.4027522613131782, -0.6926957212605525, 0.9171873325357275, -59.13377065961136, -16.4348253419645, 32.49287442351148, -93.40143460878721, 7.5848853884475345, 100.36709488713892, -8.686297962808018, -258.1663337180829, -1.2239331898452135, -2.3524442692825147, -19.35387957126793, -126.46920588460672, -121.94903642676897, -1.64326348073527, -243.03151558247995, -240.02694936450885, -28.528636228747978, 66.01002899122398, 10.951650191081058, -0.7201138758785328, -27.017347707678894, -19.232481268889384, 142.97655483130455, -55.58668433436889, 74.75443910948539, -13.007384943425109, 41.025112303375266, -28.68673138186628, 99.48163671149769, -4.51914104918481, 95.16782742567351, -72.00751757489364, 0.5684959302039739, -10.828466638591602, -18.029980499355453, -2.5390313116967658, -8.534723501783077, 33.774345877188836, -2.516645574167452, -10.931871956543898, -0.8636897225863369, -12.561461535692573, 137.63719877095176, 2.0000000000000013, 178.1507509349268, -8.982655115769079, 16.255817445755273, -31.94345862831544, 144.48954699662625, 31.71777210751837, -2.6193908405305484, 7.335954247185614, -69.10137615415928, -77.64080721191996, -32.371633999625004, -63.10922434370991, 68.55557610990314, 132.3453125251903, -4.509423535803467, 42.92300866991118, -119.135790405692, -18.176443829610996, -1.3747116258494871, -9.666330075102962, -11.659101871650236, 100.19882458964871, 101.5161779957721, -113.93148316011279, 3.680769959302695, 26.63841285188105, 2.0000000000000013, -1.21940005345317, 68.8599669072419, -10.671607495775666, -7.1133237141508925, 123.71033445623364, 115.70347196089145, -0.9896228072290598, -17.04389928575633, -2.7384067846589204, -60.42002452751637, -30.683781693007212, -11.84332234458034, -112.98424241998356, -34.183106954101085, -13.053302678628482, 66.60844496211453, -10.296293841609806, 50.13968493721055, -6.513581890154983, -1.0896447813552008, -29.00837212111059, -1.172747162510251, -40.89043782081686, -7.604810741545984, -1.263391104381924, -197.16703633999387, 2.0000000000000013, -53.62999744853222, -8.514419213805356, -27.53787025861117, -0.19976255504495177, -67.3842920168924, -22.703188639912014, 8.340867534030663], "policy_predator_policy_reward": [80.02693175345732, 68.11810836280856, 8.495714307804215, 13.92636513948576, 17.130765618690422, 24.245876560261067, 46.32949251139363, 6.7542595063900706, 16.012682673886726, 78.85489088885775, 186.24940904096698, 74.47110130770847, 63.11851502958324, 24.18667502190921, 69.49951030694471, 100.23386791078737, 228.4229793323107, 80.76312232636569, 67.1691762403693, 168.65387838896913, 115.71476120354396, 157.52548538288707, 78.86542004793571, 77.67121970069974, 117.41164172821368, 66.10559485946821, 271.2981766249641, 118.50398404680809, 165.3585023338456, 155.4336815594751, 93.77322896088671, 86.77571852448561, 0.0, 14.727678015117007, 158.95825716090306, 174.47880798841365, 146.9668597602259, 102.28373738537927, 175.8253042936938, 123.5864079756808, 139.08558709330927, 171.28630375866618, 218.66906471569771, 201.339030806138, 302.8598738825828, 296.6707577462804, 115.99612621615837, 34.98431113210527, 148.19805994845413, 97.54479411409454, 210.0577049506105, 158.44680709204377, 157.68614507256407, 201.56988737870228, 153.49718844180057, 104.43592761121705, 235.91676786060884, 231.89518934174842, 167.98551100569975, 92.93622934778521, 190.1057770229135, 210.77654277199255, 272.3538967927018, 261.58411013031366, 51.27551483091582, 49.63675612928621, 257.7699153363149, 166.57379391067343, 4.635948068104003, 5.272971869862712, 137.46154699190478, 155.97182589808722, 94.5865465648005, 90.8703758372439, 161.21461913024868, 127.66098295814417, 272.10518565609954, 112.4637035415714, 279.55349588897, 145.05933185967956, 16.572690511123643, 14.786751982357595, 222.77695628312304, 200.47544438873308, 32.60171536724497, 26.47950538110632, 126.78244994724437, 167.52289828232915, 87.50045541067871, 14.756714252070816, 24.791119635852056, 50.83073844981557, 81.3492196561851, 53.78852852369668, 87.94257936883054, 98.38544332260388, 62.81605482493092, 52.14873352445606, 157.82161970192075, 90.03019776603197, 53.01179889493614, 17.839346023886197, 193.25904490343237, 213.70206391182245, 4.322444269282473, 21.273879571268232, 223.4270569797417, 237.01880423335518, 201.67713638574722, 250.61513413241136, 192.76718720006173, 193.40892092972373, 86.02961915983002, 112.52802373657235, 2.700113875878519, 28.827347707679177, 34.05446512538591, 14.151673301391929, 129.48121744070798, 117.75414318528227, 44.69074506857805, 87.12421251303353, 85.99143539939845, 51.540677328148675, 107.01915942697191, 106.16649176913046, 81.98303429362686, 88.02946341912308, 81.31991124045767, 56.50085690085799, 4.509031311696724, 10.434723501783038, 75.70565412281127, 17.87333700407474, 12.831871956543857, 2.8336897225863225, 14.471461535692532, 31.432801229048252, 1.9972885221991592, 1.0119605428739797, 64.58409473102911, 80.16794804643982, 100.06120019459556, 87.53996457734718, 112.95763418832202, 65.19393875525624, 110.54075612981845, 140.2069813535068, 145.1830033980155, 159.7250897699007, 141.71399100241396, 141.484171180585, 12.429687235007302, 28.53449730631473, 203.75377107589924, 124.19622916711695, 20.1164438296113, 3.344711625849459, 80.55379685858425, 103.01157032869511, 43.75918951524538, 58.338020511779845, 93.53214029631133, 258.7830802376087, 90.18811867227684, 29.566848463427405, 44.54474555318469, 37.784687593026554, 12.571607495775625, 9.043323714150851, 50.80451673073767, 48.7010411587337, 3.8625723008315482, 18.020949792154113, 180.08975767815963, 141.2972470369398, 34.35722327439732, 2.2274521001481045, 156.4900376648694, 112.78422143373238, 14.953302678628441, 62.59155503788551, 32.74639040726098, 73.4380148337479, 8.463581890154941, 3.0596447813551797, 136.030984701224, 13.210134582396872, 155.89043782081686, 36.062545921700455, 223.99673472745357, 217.641916468927, 110.30720387319494, 149.3956843774833, 73.73836031214044, 64.96943937949251, 111.57119617334877, 113.19003770678076, 98.85352898036439, 91.38875635463273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8196927236113651, "mean_inference_ms": 2.668736181456325, "mean_action_processing_ms": 0.35765878139949536, "mean_env_wait_ms": 0.29371539674219277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004227757453918457, "StateBufferConnector_ms": 0.004317879676818848, "ViewRequirementAgentConnector_ms": 0.11256015300750732}, "num_episodes": 18, "episode_return_max": 338.91936430659644, "episode_return_min": -9.093574534125224, "episode_return_mean": 131.6464939523919, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.79788944243717, "num_env_steps_trained_throughput_per_sec": 333.79788944243717, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 12268.434, "restore_workers_time_ms": 0.013, "training_step_time_ms": 12268.397, "sample_time_ms": 1778.773, "learn_time_ms": 10474.156, "learn_throughput": 381.892, "synch_weights_time_ms": 14.449}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "6c58f_00000", "date": "2024-08-16_16-28-40", "timestamp": 1723805920, "time_this_iter_s": 11.989503860473633, "time_total_s": 1301.412674665451, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1301.412674665451, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 49.05882352941176, "ram_util_percent": 74.87647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3219729281607129, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.285774949492601, "policy_loss": -0.010977631532981322, "vf_loss": 7.2953848821145515, "vf_explained_var": 0.000430429391760044, "kl": 0.019211779525080824, "entropy": 1.3631531845955622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7440166328634534, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.864165564693471, "policy_loss": -0.0011093107990861413, "vf_loss": 5.8652735586519595, "vf_explained_var": -0.18275637043216242, "kl": 0.006825543559192728, "entropy": 0.9453157628024066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 338.91936430659644, "episode_reward_min": -9.093574534125224, "episode_reward_mean": 137.96094406631246, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -366.562558695111, "predator_policy": 1.0119605428739797}, "policy_reward_max": {"prey_policy": 178.1507509349268, "predator_policy": 302.8598738825828}, "policy_reward_mean": {"prey_policy": -34.28846876567929, "predator_policy": 103.26894079883552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.85009143799147, 30.706487948733812, 75.66808237402118, 178.15867046449642, 74.33451069945502, 291.9638183187937, 85.50198629773627, 58.20593008203432, 159.98476063191313, 155.66602280918727, 68.4270978293087, 55.87476420460206, 4.7075712500545634, 103.00070082253232, 153.84277124547083, 116.67637320400549, -9.093574534125224, 94.73245301461351, 3.8599999999999612, 268.13049827833436, 4.58070197921001, 214.7625503280618, 100.10357324813664, 125.34404142336354, 134.84780471993483, 128.11143936435903, 131.02283743093395, 162.035268247613, 162.53194184315328, 147.5708419073267, 3.8899999999999606, 212.02761890172167, 207.61749145494284, 117.62052253652864, 275.51932207870743, 3.7899999999999627, 171.95021198919255, 266.4031154011068, 159.83268494156175, 208.3270180571781, 303.8343375725909, 98.57347606806017, 108.96232100336871, 3.869999999999962, 124.83669142990814, 3.869999999999962, 170.9799999999999, 183.15999999999974, 152.02520510745506, 300.14725314025344, 207.24995421056593, 188.9823155763513, 194.89565195637095, 288.6445139491924, 168.800073530709, 251.73721850723527, 3.9099999999999606, 162.2399352405261, 303.8122126124461, 242.06450733311001, 148.3933799875853, 149.97000000000023, 3.829999999999962, 338.91936430659644, 3.8499999999999615, 258.22857340292404, -5.942428663042268, 122.10690972451783, 131.1000000000002, 146.02779633660967, 3.9199999999999604, 119.06000000000033, 143.45773518015463, 243.20822375200493, 208.07289080214562, 102.65551021921692, 157.1771793081923, 175.87996422911573, 162.56989805895324, 35.08739399340803, 3.84999999999996, 173.40442796250363, 115.3162673319969, 82.84298931045738, 161.86474429504335, 92.10489515410708, 197.78434940052531, 142.8477913341112, 104.10766354841878, 63.434318518057296, 16.57000000000003, 90.39024640074147, 314.6711266242973, 164.36150962766916, 221.35341625135342, 81.07342115191511, 120.18600841485268, 177.03370614276022, 106.42250875368194, 127.21895630003935], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-286.17953198093466, -92.50100820993745, -114.02566720114544, -6.248282198384203, -165.80693199299566, -4.26783969553216, -37.84222461796852, -152.50361696018953, -173.81764535732714, -111.10387639448437, 3.4042522708152827, 30.626449994960744, -65.3043956506791, -317.0055752539425, -177.62968660634192, -25.086123665108303, -2.294778951584031, -238.60278021140883, -366.562558695111, -11.709425418716824, -28.39359392094743, -4.091579209945853, -242.79684313523586, -125.67210190715012, -4.675245843181668, -0.5261028447304783, 0.4687390983390913, -190.9014111657995, -32.639709210400056, 1.0255580538263265, -65.48088678616995, -106.7183420982169, -177.38434363037592, -216.2781201014203, -306.8122272703475, -23.06814746368951, -14.622690511123583, -12.876751982357636, -3.58307554994657, -151.5388268435749, -32.07516215181525, -22.425356617326056, 44.371882478985796, -123.91468038049769, 0.33327184160687295, -2.486868256219836, -5.413518640394838, 55.13570197809022, 0.4027522613131782, -0.6926957212605525, 0.9171873325357275, -59.13377065961136, -16.4348253419645, 32.49287442351148, -93.40143460878721, 7.5848853884475345, 100.36709488713892, -8.686297962808018, -258.1663337180829, -1.2239331898452135, -2.3524442692825147, -19.35387957126793, -126.46920588460672, -121.94903642676897, -1.64326348073527, -243.03151558247995, -240.02694936450885, -28.528636228747978, 66.01002899122398, 10.951650191081058, -0.7201138758785328, -27.017347707678894, -19.232481268889384, 142.97655483130455, -55.58668433436889, 74.75443910948539, -13.007384943425109, 41.025112303375266, -28.68673138186628, 99.48163671149769, -4.51914104918481, 95.16782742567351, -72.00751757489364, 0.5684959302039739, -10.828466638591602, -18.029980499355453, -2.5390313116967658, -8.534723501783077, 33.774345877188836, -2.516645574167452, -10.931871956543898, -0.8636897225863369, -12.561461535692573, 137.63719877095176, 2.0000000000000013, 178.1507509349268, -8.982655115769079, 16.255817445755273, -31.94345862831544, 144.48954699662625, 31.71777210751837, -2.6193908405305484, 7.335954247185614, -69.10137615415928, -77.64080721191996, -32.371633999625004, -63.10922434370991, 68.55557610990314, 132.3453125251903, -4.509423535803467, 42.92300866991118, -119.135790405692, -18.176443829610996, -1.3747116258494871, -9.666330075102962, -11.659101871650236, 100.19882458964871, 101.5161779957721, -113.93148316011279, 3.680769959302695, 26.63841285188105, 2.0000000000000013, -1.21940005345317, 68.8599669072419, -10.671607495775666, -7.1133237141508925, 123.71033445623364, 115.70347196089145, -0.9896228072290598, -17.04389928575633, -2.7384067846589204, -60.42002452751637, -30.683781693007212, -11.84332234458034, -112.98424241998356, -34.183106954101085, -13.053302678628482, 66.60844496211453, -10.296293841609806, 50.13968493721055, -6.513581890154983, -1.0896447813552008, -29.00837212111059, -1.172747162510251, -40.89043782081686, -7.604810741545984, -1.263391104381924, -197.16703633999387, 2.0000000000000013, -53.62999744853222, -8.514419213805356, -27.53787025861117, -0.19976255504495177, -67.3842920168924, -22.703188639912014, 8.340867534030663, 111.00676822631273, 1.2119172181240252, -185.4282947508002, -174.65091525462324, -29.128832434459408, -22.753712622322546, -10.700621349076815, -115.36694861883296, -50.57536999805589, -28.526443821875418, -81.30446017420748, -114.07330432292338, 13.798336432708606, -50.59925763604058, -47.83707042923377, 2.0000000000000013, -116.53839388273134, 48.91921091447676, -135.5008983488852, -0.3820089465507035, -23.911589821100947, -6.990394352372849, 2.0000000000000013, -195.04676101226138, -4.326498775227083, -25.263791570265916, -0.8527232348610181, -143.13677665707357, -39.51643940195723, 77.87911347477056, -53.44961945968322, -72.83411462487915, -55.43282059815635, -132.5794826737931, -136.04932361778498, 0.02605119106310344, -98.26927625151262, -0.001693613868967738, -100.77234569443314, 25.651852368032447, -20.011779468964303, 1.0744867455308582, 1.0443854203966176, -49.45580008837078], "policy_predator_policy_reward": [302.8598738825828, 296.6707577462804, 115.99612621615837, 34.98431113210527, 148.19805994845413, 97.54479411409454, 210.0577049506105, 158.44680709204377, 157.68614507256407, 201.56988737870228, 153.49718844180057, 104.43592761121705, 235.91676786060884, 231.89518934174842, 167.98551100569975, 92.93622934778521, 190.1057770229135, 210.77654277199255, 272.3538967927018, 261.58411013031366, 51.27551483091582, 49.63675612928621, 257.7699153363149, 166.57379391067343, 4.635948068104003, 5.272971869862712, 137.46154699190478, 155.97182589808722, 94.5865465648005, 90.8703758372439, 161.21461913024868, 127.66098295814417, 272.10518565609954, 112.4637035415714, 279.55349588897, 145.05933185967956, 16.572690511123643, 14.786751982357595, 222.77695628312304, 200.47544438873308, 32.60171536724497, 26.47950538110632, 126.78244994724437, 167.52289828232915, 87.50045541067871, 14.756714252070816, 24.791119635852056, 50.83073844981557, 81.3492196561851, 53.78852852369668, 87.94257936883054, 98.38544332260388, 62.81605482493092, 52.14873352445606, 157.82161970192075, 90.03019776603197, 53.01179889493614, 17.839346023886197, 193.25904490343237, 213.70206391182245, 4.322444269282473, 21.273879571268232, 223.4270569797417, 237.01880423335518, 201.67713638574722, 250.61513413241136, 192.76718720006173, 193.40892092972373, 86.02961915983002, 112.52802373657235, 2.700113875878519, 28.827347707679177, 34.05446512538591, 14.151673301391929, 129.48121744070798, 117.75414318528227, 44.69074506857805, 87.12421251303353, 85.99143539939845, 51.540677328148675, 107.01915942697191, 106.16649176913046, 81.98303429362686, 88.02946341912308, 81.31991124045767, 56.50085690085799, 4.509031311696724, 10.434723501783038, 75.70565412281127, 17.87333700407474, 12.831871956543857, 2.8336897225863225, 14.471461535692532, 31.432801229048252, 1.9972885221991592, 1.0119605428739797, 64.58409473102911, 80.16794804643982, 100.06120019459556, 87.53996457734718, 112.95763418832202, 65.19393875525624, 110.54075612981845, 140.2069813535068, 145.1830033980155, 159.7250897699007, 141.71399100241396, 141.484171180585, 12.429687235007302, 28.53449730631473, 203.75377107589924, 124.19622916711695, 20.1164438296113, 3.344711625849459, 80.55379685858425, 103.01157032869511, 43.75918951524538, 58.338020511779845, 93.53214029631133, 258.7830802376087, 90.18811867227684, 29.566848463427405, 44.54474555318469, 37.784687593026554, 12.571607495775625, 9.043323714150851, 50.80451673073767, 48.7010411587337, 3.8625723008315482, 18.020949792154113, 180.08975767815963, 141.2972470369398, 34.35722327439732, 2.2274521001481045, 156.4900376648694, 112.78422143373238, 14.953302678628441, 62.59155503788551, 32.74639040726098, 73.4380148337479, 8.463581890154941, 3.0596447813551797, 136.030984701224, 13.210134582396872, 155.89043782081686, 36.062545921700455, 223.99673472745357, 217.641916468927, 110.30720387319494, 149.3956843774833, 73.73836031214044, 64.96943937949251, 111.57119617334877, 113.19003770678076, 98.85352898036439, 91.38875635463273, 33.17798018053221, 17.17323243398437, 175.5862505526653, 219.58035344616528, 31.80261423487032, 23.929930821912237, 144.23627988979078, 155.23571804062234, 65.5547304576766, 128.86335069425155, 138.23147278943634, 139.98928101815207, 130.80932264986467, 67.85634284851088, 115.29926671763646, 22.64269886570437, 164.5724510336767, 100.83108133510329, 115.09390577830028, 163.6367928512466, 27.839253369519767, 107.1703943523728, 27.048123997172294, 229.4329555331465, 6.276498775227042, 39.88379157026617, 88.5524223218453, 145.82732397083004, 159.2328826435889, 117.07556990789512, 148.90685598926012, 141.73838772297177, 229.28039427291927, 180.0853252503838, 174.80400890911906, 42.29268466951792, 111.50232030191435, 106.95465797831935, 103.82383219060723, 148.33036727855435, 34.14738904092114, 91.21241243619384, 88.55890248291982, 87.07146848509336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8186781551514961, "mean_inference_ms": 2.6631473138592354, "mean_action_processing_ms": 0.35644453584973834, "mean_env_wait_ms": 0.29307158605680933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00445246696472168, "StateBufferConnector_ms": 0.004292845726013184, "ViewRequirementAgentConnector_ms": 0.11307263374328613}, "num_episodes": 22, "episode_return_max": 338.91936430659644, "episode_return_min": -9.093574534125224, "episode_return_mean": 137.96094406631246, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 29.02816663967101, "num_env_steps_trained_throughput_per_sec": 29.02816663967101, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 24821.554, "restore_workers_time_ms": 0.013, "training_step_time_ms": 24821.517, "sample_time_ms": 1771.8, "learn_time_ms": 23033.66, "learn_throughput": 173.659, "synch_weights_time_ms": 15.016}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "6c58f_00000", "date": "2024-08-16_16-30-57", "timestamp": 1723806057, "time_this_iter_s": 137.82424402236938, "time_total_s": 1439.2369186878204, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b338e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1439.2369186878204, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 54.61666666666666, "ram_util_percent": 75.70555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1136738967800897, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.579594468565845, "policy_loss": -0.0056396211492558005, "vf_loss": 7.584271850787774, "vf_explained_var": 0.0004968090347512059, "kl": 0.013516377523993227, "entropy": 1.3551098121537102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.533184477087682, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 4.831700953100094, "policy_loss": -0.006680168090733113, "vf_loss": 4.838379146182348, "vf_explained_var": -0.2755365358458625, "kl": 0.010141626125868915, "entropy": 1.0374059656625072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 338.91936430659644, "episode_reward_min": -5.942428663042268, "episode_reward_mean": 136.44091908923582, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -425.25585175750587, "predator_policy": 0.9524856078760419}, "policy_reward_max": {"prey_policy": 178.1507509349268, "predator_policy": 378.05231168289276}, "policy_reward_mean": {"prey_policy": -38.63296424865854, "predator_policy": 106.85342379327645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8599999999999612, 268.13049827833436, 4.58070197921001, 214.7625503280618, 100.10357324813664, 125.34404142336354, 134.84780471993483, 128.11143936435903, 131.02283743093395, 162.035268247613, 162.53194184315328, 147.5708419073267, 3.8899999999999606, 212.02761890172167, 207.61749145494284, 117.62052253652864, 275.51932207870743, 3.7899999999999627, 171.95021198919255, 266.4031154011068, 159.83268494156175, 208.3270180571781, 303.8343375725909, 98.57347606806017, 108.96232100336871, 3.869999999999962, 124.83669142990814, 3.869999999999962, 170.9799999999999, 183.15999999999974, 152.02520510745506, 300.14725314025344, 207.24995421056593, 188.9823155763513, 194.89565195637095, 288.6445139491924, 168.800073530709, 251.73721850723527, 3.9099999999999606, 162.2399352405261, 303.8122126124461, 242.06450733311001, 148.3933799875853, 149.97000000000023, 3.829999999999962, 338.91936430659644, 3.8499999999999615, 258.22857340292404, -5.942428663042268, 122.10690972451783, 131.1000000000002, 146.02779633660967, 3.9199999999999604, 119.06000000000033, 143.45773518015463, 243.20822375200493, 208.07289080214562, 102.65551021921692, 157.1771793081923, 175.87996422911573, 162.56989805895324, 35.08739399340803, 3.84999999999996, 173.40442796250363, 115.3162673319969, 82.84298931045738, 161.86474429504335, 92.10489515410708, 197.78434940052531, 142.8477913341112, 104.10766354841878, 63.434318518057296, 16.57000000000003, 90.39024640074147, 314.6711266242973, 164.36150962766916, 221.35341625135342, 81.07342115191511, 120.18600841485268, 177.03370614276022, 106.42250875368194, 127.21895630003935, 63.629353797478565, 76.84218270879221, 65.20410380869998, 3.8599999999999612, 190.73861181269314, 110.4725203117436, 198.16081480873635, 240.67165388161146, 101.05718576825569, 126.79772618746483, 115.3065701434729, 123.90858007769515, 111.60158956774292, -4.06209571807335, 56.26711738383737, 3.9199999999999604, 3.8099999999999623, 179.02010585300542], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.622690511123583, -12.876751982357636, -3.58307554994657, -151.5388268435749, -32.07516215181525, -22.425356617326056, 44.371882478985796, -123.91468038049769, 0.33327184160687295, -2.486868256219836, -5.413518640394838, 55.13570197809022, 0.4027522613131782, -0.6926957212605525, 0.9171873325357275, -59.13377065961136, -16.4348253419645, 32.49287442351148, -93.40143460878721, 7.5848853884475345, 100.36709488713892, -8.686297962808018, -258.1663337180829, -1.2239331898452135, -2.3524442692825147, -19.35387957126793, -126.46920588460672, -121.94903642676897, -1.64326348073527, -243.03151558247995, -240.02694936450885, -28.528636228747978, 66.01002899122398, 10.951650191081058, -0.7201138758785328, -27.017347707678894, -19.232481268889384, 142.97655483130455, -55.58668433436889, 74.75443910948539, -13.007384943425109, 41.025112303375266, -28.68673138186628, 99.48163671149769, -4.51914104918481, 95.16782742567351, -72.00751757489364, 0.5684959302039739, -10.828466638591602, -18.029980499355453, -2.5390313116967658, -8.534723501783077, 33.774345877188836, -2.516645574167452, -10.931871956543898, -0.8636897225863369, -12.561461535692573, 137.63719877095176, 2.0000000000000013, 178.1507509349268, -8.982655115769079, 16.255817445755273, -31.94345862831544, 144.48954699662625, 31.71777210751837, -2.6193908405305484, 7.335954247185614, -69.10137615415928, -77.64080721191996, -32.371633999625004, -63.10922434370991, 68.55557610990314, 132.3453125251903, -4.509423535803467, 42.92300866991118, -119.135790405692, -18.176443829610996, -1.3747116258494871, -9.666330075102962, -11.659101871650236, 100.19882458964871, 101.5161779957721, -113.93148316011279, 3.680769959302695, 26.63841285188105, 2.0000000000000013, -1.21940005345317, 68.8599669072419, -10.671607495775666, -7.1133237141508925, 123.71033445623364, 115.70347196089145, -0.9896228072290598, -17.04389928575633, -2.7384067846589204, -60.42002452751637, -30.683781693007212, -11.84332234458034, -112.98424241998356, -34.183106954101085, -13.053302678628482, 66.60844496211453, -10.296293841609806, 50.13968493721055, -6.513581890154983, -1.0896447813552008, -29.00837212111059, -1.172747162510251, -40.89043782081686, -7.604810741545984, -1.263391104381924, -197.16703633999387, 2.0000000000000013, -53.62999744853222, -8.514419213805356, -27.53787025861117, -0.19976255504495177, -67.3842920168924, -22.703188639912014, 8.340867534030663, 111.00676822631273, 1.2119172181240252, -185.4282947508002, -174.65091525462324, -29.128832434459408, -22.753712622322546, -10.700621349076815, -115.36694861883296, -50.57536999805589, -28.526443821875418, -81.30446017420748, -114.07330432292338, 13.798336432708606, -50.59925763604058, -47.83707042923377, 2.0000000000000013, -116.53839388273134, 48.91921091447676, -135.5008983488852, -0.3820089465507035, -23.911589821100947, -6.990394352372849, 2.0000000000000013, -195.04676101226138, -4.326498775227083, -25.263791570265916, -0.8527232348610181, -143.13677665707357, -39.51643940195723, 77.87911347477056, -53.44961945968322, -72.83411462487915, -55.43282059815635, -132.5794826737931, -136.04932361778498, 0.02605119106310344, -98.26927625151262, -0.001693613868967738, -100.77234569443314, 25.651852368032447, -20.011779468964303, 1.0744867455308582, 1.0443854203966176, -49.45580008837078, -222.57325200387285, -7.312728309089069, -1.6989454703317481, -219.47462074617923, -369.874732841961, -253.74001436940003, -15.895878505091828, -3.3457438598024885, -3.848359517824707, -284.83298310948925, -253.80831902040867, -5.13590710718384, -14.204695905105012, -369.7008098815761, -425.25585175750587, -14.451866315341617, -402.00274648513613, -225.61040801405272, -9.644147206402959, -336.32936573845006, 1.1686012734171722, -99.67767929597615, -210.72622401585144, -0.5944038903084234, -1.4245648889268177, -110.4230736278448, -10.013508090108727, -9.12464471909048, -165.4850215087467, -327.1758844461134, 1.0375143921239596, -5.742130075316576, -14.624711294758498, -22.2012902440704, -291.5913395758246, -1.964964655709431], "policy_predator_policy_reward": [16.572690511123643, 14.786751982357595, 222.77695628312304, 200.47544438873308, 32.60171536724497, 26.47950538110632, 126.78244994724437, 167.52289828232915, 87.50045541067871, 14.756714252070816, 24.791119635852056, 50.83073844981557, 81.3492196561851, 53.78852852369668, 87.94257936883054, 98.38544332260388, 62.81605482493092, 52.14873352445606, 157.82161970192075, 90.03019776603197, 53.01179889493614, 17.839346023886197, 193.25904490343237, 213.70206391182245, 4.322444269282473, 21.273879571268232, 223.4270569797417, 237.01880423335518, 201.67713638574722, 250.61513413241136, 192.76718720006173, 193.40892092972373, 86.02961915983002, 112.52802373657235, 2.700113875878519, 28.827347707679177, 34.05446512538591, 14.151673301391929, 129.48121744070798, 117.75414318528227, 44.69074506857805, 87.12421251303353, 85.99143539939845, 51.540677328148675, 107.01915942697191, 106.16649176913046, 81.98303429362686, 88.02946341912308, 81.31991124045767, 56.50085690085799, 4.509031311696724, 10.434723501783038, 75.70565412281127, 17.87333700407474, 12.831871956543857, 2.8336897225863225, 14.471461535692532, 31.432801229048252, 1.9972885221991592, 1.0119605428739797, 64.58409473102911, 80.16794804643982, 100.06120019459556, 87.53996457734718, 112.95763418832202, 65.19393875525624, 110.54075612981845, 140.2069813535068, 145.1830033980155, 159.7250897699007, 141.71399100241396, 141.484171180585, 12.429687235007302, 28.53449730631473, 203.75377107589924, 124.19622916711695, 20.1164438296113, 3.344711625849459, 80.55379685858425, 103.01157032869511, 43.75918951524538, 58.338020511779845, 93.53214029631133, 258.7830802376087, 90.18811867227684, 29.566848463427405, 44.54474555318469, 37.784687593026554, 12.571607495775625, 9.043323714150851, 50.80451673073767, 48.7010411587337, 3.8625723008315482, 18.020949792154113, 180.08975767815963, 141.2972470369398, 34.35722327439732, 2.2274521001481045, 156.4900376648694, 112.78422143373238, 14.953302678628441, 62.59155503788551, 32.74639040726098, 73.4380148337479, 8.463581890154941, 3.0596447813551797, 136.030984701224, 13.210134582396872, 155.89043782081686, 36.062545921700455, 223.99673472745357, 217.641916468927, 110.30720387319494, 149.3956843774833, 73.73836031214044, 64.96943937949251, 111.57119617334877, 113.19003770678076, 98.85352898036439, 91.38875635463273, 33.17798018053221, 17.17323243398437, 175.5862505526653, 219.58035344616528, 31.80261423487032, 23.929930821912237, 144.23627988979078, 155.23571804062234, 65.5547304576766, 128.86335069425155, 138.23147278943634, 139.98928101815207, 130.80932264986467, 67.85634284851088, 115.29926671763646, 22.64269886570437, 164.5724510336767, 100.83108133510329, 115.09390577830028, 163.6367928512466, 27.839253369519767, 107.1703943523728, 27.048123997172294, 229.4329555331465, 6.276498775227042, 39.88379157026617, 88.5524223218453, 145.82732397083004, 159.2328826435889, 117.07556990789512, 148.90685598926012, 141.73838772297177, 229.28039427291927, 180.0853252503838, 174.80400890911906, 42.29268466951792, 111.50232030191435, 106.95465797831935, 103.82383219060723, 148.33036727855435, 34.14738904092114, 91.21241243619384, 88.55890248291982, 87.07146848509336, 239.70142995692458, 53.813904153515914, 56.25492666397445, 241.76082226132837, 310.76653933716847, 378.05231168289276, 17.795878505092105, 5.305743859802447, 200.9488390131145, 278.4711154268928, 252.7081297291069, 116.70861671022932, 271.2102422875524, 310.85607830786586, 377.3132427981883, 303.0661291562711, 365.011577586651, 363.6587626807938, 234.69859050939652, 238.07264862292072, 97.10948131210297, 116.70616685392852, 168.82574817132445, 166.40345981253031, 116.98207932596938, 106.46714875854491, 14.072705411878559, 1.003351679247298, 254.3412980048628, 294.5867253338345, 0.9524856078760419, 7.6721300753165345, 16.51471129475855, 24.1212902440707, 209.73864589428533, 262.8377641902547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8172637647492164, "mean_inference_ms": 2.6636614022874254, "mean_action_processing_ms": 0.3563505933540594, "mean_env_wait_ms": 0.29258234011755896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004442334175109863, "StateBufferConnector_ms": 0.004343509674072266, "ViewRequirementAgentConnector_ms": 0.1120767593383789}, "num_episodes": 18, "episode_return_max": 338.91936430659644, "episode_return_min": -5.942428663042268, "episode_return_mean": 136.44091908923582, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 340.0903002415224, "num_env_steps_trained_throughput_per_sec": 340.0903002415224, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 24770.335, "restore_workers_time_ms": 0.013, "training_step_time_ms": 24770.298, "sample_time_ms": 1729.614, "learn_time_ms": 23024.576, "learn_throughput": 173.727, "synch_weights_time_ms": 14.999}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "6c58f_00000", "date": "2024-08-16_16-31-09", "timestamp": 1723806069, "time_this_iter_s": 11.767707109451294, "time_total_s": 1451.0046257972717, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1451.0046257972717, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 50.33529411764706, "ram_util_percent": 76.34117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9526066345197183, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.532600393244829, "policy_loss": -0.004694646005839031, "vf_loss": 7.536724507619464, "vf_explained_var": 0.00012899369159072795, "kl": 0.00801391142826186, "entropy": 1.3661779433961898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4541369609574162, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.511774644649849, "policy_loss": -0.005370838065611977, "vf_loss": 5.51714285605799, "vf_explained_var": -0.1501295633416958, "kl": 0.013430253272397054, "entropy": 1.1433364964666821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 338.91936430659644, "episode_reward_min": -74.40962130557833, "episode_reward_mean": 118.66074000668067, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -497.71648317430436, "predator_policy": 0.9524856078760419}, "policy_reward_max": {"prey_policy": 178.1507509349268, "predator_policy": 508.7628920230827}, "policy_reward_mean": {"prey_policy": -85.75539225378368, "predator_policy": 145.08576225712403}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.57347606806017, 108.96232100336871, 3.869999999999962, 124.83669142990814, 3.869999999999962, 170.9799999999999, 183.15999999999974, 152.02520510745506, 300.14725314025344, 207.24995421056593, 188.9823155763513, 194.89565195637095, 288.6445139491924, 168.800073530709, 251.73721850723527, 3.9099999999999606, 162.2399352405261, 303.8122126124461, 242.06450733311001, 148.3933799875853, 149.97000000000023, 3.829999999999962, 338.91936430659644, 3.8499999999999615, 258.22857340292404, -5.942428663042268, 122.10690972451783, 131.1000000000002, 146.02779633660967, 3.9199999999999604, 119.06000000000033, 143.45773518015463, 243.20822375200493, 208.07289080214562, 102.65551021921692, 157.1771793081923, 175.87996422911573, 162.56989805895324, 35.08739399340803, 3.84999999999996, 173.40442796250363, 115.3162673319969, 82.84298931045738, 161.86474429504335, 92.10489515410708, 197.78434940052531, 142.8477913341112, 104.10766354841878, 63.434318518057296, 16.57000000000003, 90.39024640074147, 314.6711266242973, 164.36150962766916, 221.35341625135342, 81.07342115191511, 120.18600841485268, 177.03370614276022, 106.42250875368194, 127.21895630003935, 63.629353797478565, 76.84218270879221, 65.20410380869998, 3.8599999999999612, 190.73861181269314, 110.4725203117436, 198.16081480873635, 240.67165388161146, 101.05718576825569, 126.79772618746483, 115.3065701434729, 123.90858007769515, 111.60158956774292, -4.06209571807335, 56.26711738383737, 3.9199999999999604, 3.8099999999999623, 179.02010585300542, 230.02932848459025, 191.0655510344076, 3.8999999999999604, 10.809388624898398, 3.8399999999999626, 189.3562607930548, 5.851333138713882, 226.18318819489798, -40.03669786519064, -74.40962130557833, -46.216419866150105, 157.5491020851624, 208.58053768253944, 75.41666644605132, 230.03075501025282, 29.763630258696203, 6.746410220102973, 115.66905990767563, 79.66063196595469, 186.20033663844606, 50.00695964065611, -47.66298139807818, -56.63750624265778], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-72.00751757489364, 0.5684959302039739, -10.828466638591602, -18.029980499355453, -2.5390313116967658, -8.534723501783077, 33.774345877188836, -2.516645574167452, -10.931871956543898, -0.8636897225863369, -12.561461535692573, 137.63719877095176, 2.0000000000000013, 178.1507509349268, -8.982655115769079, 16.255817445755273, -31.94345862831544, 144.48954699662625, 31.71777210751837, -2.6193908405305484, 7.335954247185614, -69.10137615415928, -77.64080721191996, -32.371633999625004, -63.10922434370991, 68.55557610990314, 132.3453125251903, -4.509423535803467, 42.92300866991118, -119.135790405692, -18.176443829610996, -1.3747116258494871, -9.666330075102962, -11.659101871650236, 100.19882458964871, 101.5161779957721, -113.93148316011279, 3.680769959302695, 26.63841285188105, 2.0000000000000013, -1.21940005345317, 68.8599669072419, -10.671607495775666, -7.1133237141508925, 123.71033445623364, 115.70347196089145, -0.9896228072290598, -17.04389928575633, -2.7384067846589204, -60.42002452751637, -30.683781693007212, -11.84332234458034, -112.98424241998356, -34.183106954101085, -13.053302678628482, 66.60844496211453, -10.296293841609806, 50.13968493721055, -6.513581890154983, -1.0896447813552008, -29.00837212111059, -1.172747162510251, -40.89043782081686, -7.604810741545984, -1.263391104381924, -197.16703633999387, 2.0000000000000013, -53.62999744853222, -8.514419213805356, -27.53787025861117, -0.19976255504495177, -67.3842920168924, -22.703188639912014, 8.340867534030663, 111.00676822631273, 1.2119172181240252, -185.4282947508002, -174.65091525462324, -29.128832434459408, -22.753712622322546, -10.700621349076815, -115.36694861883296, -50.57536999805589, -28.526443821875418, -81.30446017420748, -114.07330432292338, 13.798336432708606, -50.59925763604058, -47.83707042923377, 2.0000000000000013, -116.53839388273134, 48.91921091447676, -135.5008983488852, -0.3820089465507035, -23.911589821100947, -6.990394352372849, 2.0000000000000013, -195.04676101226138, -4.326498775227083, -25.263791570265916, -0.8527232348610181, -143.13677665707357, -39.51643940195723, 77.87911347477056, -53.44961945968322, -72.83411462487915, -55.43282059815635, -132.5794826737931, -136.04932361778498, 0.02605119106310344, -98.26927625151262, -0.001693613868967738, -100.77234569443314, 25.651852368032447, -20.011779468964303, 1.0744867455308582, 1.0443854203966176, -49.45580008837078, -222.57325200387285, -7.312728309089069, -1.6989454703317481, -219.47462074617923, -369.874732841961, -253.74001436940003, -15.895878505091828, -3.3457438598024885, -3.848359517824707, -284.83298310948925, -253.80831902040867, -5.13590710718384, -14.204695905105012, -369.7008098815761, -425.25585175750587, -14.451866315341617, -402.00274648513613, -225.61040801405272, -9.644147206402959, -336.32936573845006, 1.1686012734171722, -99.67767929597615, -210.72622401585144, -0.5944038903084234, -1.4245648889268177, -110.4230736278448, -10.013508090108727, -9.12464471909048, -165.4850215087467, -327.1758844461134, 1.0375143921239596, -5.742130075316576, -14.624711294758498, -22.2012902440704, -291.5913395758246, -1.964964655709431, -491.52968331865833, -2.2716006589356574, -361.13052206090094, -2.7418377703900614, -14.577646881347624, -0.5120364055357303, -4.825928147643355, -13.406419043245815, -10.444359335141948, -7.382800310178714, -497.71648317430436, -3.2178225016038073, 2.0000000000000013, -16.472593792349645, 2.0000000000000013, -429.5538700999281, -383.6101514440071, -334.39818957523437, -333.63494966083135, -446.6842963188625, -464.7285509729035, -418.9164057338906, -18.727934317316183, -238.36888102308873, -19.708163810948673, -354.99815208606475, -407.32851042017563, -367.2332232640791, -344.91268406470715, -6.8119929285975065, -299.2416040004893, -9.090161245133926, -4.702094180669217, 0.01301945722717387, -337.6474663828495, -7.4493688629533406, -389.1897668688943, -228.08462668337458, -0.7855804869733323, -484.94411910546404, -437.3243516830598, -462.77731192428155, -365.75762376889014, -491.9978972593509, -456.8470531213239, -423.64204313771324], "policy_predator_policy_reward": [81.98303429362686, 88.02946341912308, 81.31991124045767, 56.50085690085799, 4.509031311696724, 10.434723501783038, 75.70565412281127, 17.87333700407474, 12.831871956543857, 2.8336897225863225, 14.471461535692532, 31.432801229048252, 1.9972885221991592, 1.0119605428739797, 64.58409473102911, 80.16794804643982, 100.06120019459556, 87.53996457734718, 112.95763418832202, 65.19393875525624, 110.54075612981845, 140.2069813535068, 145.1830033980155, 159.7250897699007, 141.71399100241396, 141.484171180585, 12.429687235007302, 28.53449730631473, 203.75377107589924, 124.19622916711695, 20.1164438296113, 3.344711625849459, 80.55379685858425, 103.01157032869511, 43.75918951524538, 58.338020511779845, 93.53214029631133, 258.7830802376087, 90.18811867227684, 29.566848463427405, 44.54474555318469, 37.784687593026554, 12.571607495775625, 9.043323714150851, 50.80451673073767, 48.7010411587337, 3.8625723008315482, 18.020949792154113, 180.08975767815963, 141.2972470369398, 34.35722327439732, 2.2274521001481045, 156.4900376648694, 112.78422143373238, 14.953302678628441, 62.59155503788551, 32.74639040726098, 73.4380148337479, 8.463581890154941, 3.0596447813551797, 136.030984701224, 13.210134582396872, 155.89043782081686, 36.062545921700455, 223.99673472745357, 217.641916468927, 110.30720387319494, 149.3956843774833, 73.73836031214044, 64.96943937949251, 111.57119617334877, 113.19003770678076, 98.85352898036439, 91.38875635463273, 33.17798018053221, 17.17323243398437, 175.5862505526653, 219.58035344616528, 31.80261423487032, 23.929930821912237, 144.23627988979078, 155.23571804062234, 65.5547304576766, 128.86335069425155, 138.23147278943634, 139.98928101815207, 130.80932264986467, 67.85634284851088, 115.29926671763646, 22.64269886570437, 164.5724510336767, 100.83108133510329, 115.09390577830028, 163.6367928512466, 27.839253369519767, 107.1703943523728, 27.048123997172294, 229.4329555331465, 6.276498775227042, 39.88379157026617, 88.5524223218453, 145.82732397083004, 159.2328826435889, 117.07556990789512, 148.90685598926012, 141.73838772297177, 229.28039427291927, 180.0853252503838, 174.80400890911906, 42.29268466951792, 111.50232030191435, 106.95465797831935, 103.82383219060723, 148.33036727855435, 34.14738904092114, 91.21241243619384, 88.55890248291982, 87.07146848509336, 239.70142995692458, 53.813904153515914, 56.25492666397445, 241.76082226132837, 310.76653933716847, 378.05231168289276, 17.795878505092105, 5.305743859802447, 200.9488390131145, 278.4711154268928, 252.7081297291069, 116.70861671022932, 271.2102422875524, 310.85607830786586, 377.3132427981883, 303.0661291562711, 365.011577586651, 363.6587626807938, 234.69859050939652, 238.07264862292072, 97.10948131210297, 116.70616685392852, 168.82574817132445, 166.40345981253031, 116.98207932596938, 106.46714875854491, 14.072705411878559, 1.003351679247298, 254.3412980048628, 294.5867253338345, 0.9524856078760419, 7.6721300753165345, 16.51471129475855, 24.1212902440707, 209.73864589428533, 262.8377641902547, 450.8231692590899, 273.00744320309497, 309.973594754552, 244.9643161111471, 16.49764688134767, 2.492036405535721, 19.255657753791922, 9.786078061995642, 12.344359335141908, 9.322800310178673, 375.71929490723653, 314.57127156172635, 4.067540135409155, 16.256386795654752, 259.0006145328768, 394.73644376194915, 508.7628920230827, 169.20875113096824, 392.870303988612, 313.039320685503, 465.1679158786546, 372.2606209619899, 219.98295051889096, 194.66296690667647, 267.83901179741974, 315.4478417821335, 437.0272490823286, 412.95115104797713, 280.5726228297733, 301.1828091737842, 89.67546197784105, 248.41993352647827, 5.5480047855416155, 5.887480158003444, 299.29225385134197, 161.4736413021359, 343.2887553062329, 353.64627021199084, 313.8625636150581, 358.0674726158258, 499.79797452276233, 450.3106487252352, 372.0621523813569, 438.0303872488061, 385.6972125048985, 438.1543775114807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8141579933965959, "mean_inference_ms": 2.6557784070252155, "mean_action_processing_ms": 0.355041899184789, "mean_env_wait_ms": 0.2915495244660051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00483095645904541, "StateBufferConnector_ms": 0.0036382675170898438, "ViewRequirementAgentConnector_ms": 0.09663665294647217}, "num_episodes": 23, "episode_return_max": 338.91936430659644, "episode_return_min": -74.40962130557833, "episode_return_mean": 118.66074000668067, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.341016106286, "num_env_steps_trained_throughput_per_sec": 345.341016106286, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 24643.593, "restore_workers_time_ms": 0.013, "training_step_time_ms": 24643.557, "sample_time_ms": 1625.824, "learn_time_ms": 23002.202, "learn_throughput": 173.896, "synch_weights_time_ms": 14.58}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "6c58f_00000", "date": "2024-08-16_16-31-21", "timestamp": 1723806081, "time_this_iter_s": 11.587237119674683, "time_total_s": 1462.5918629169464, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1462.5918629169464, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 54.20625, "ram_util_percent": 76.2875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9536204298337301, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.6773811635516935, "policy_loss": -0.004861855224790003, "vf_loss": 7.681688240596226, "vf_explained_var": -0.0021846161632941515, "kl": 0.007792983771127912, "entropy": 1.3565886993887564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4708205067764515, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 5.317089272302295, "policy_loss": -0.003294738753398181, "vf_loss": 5.32038254737854, "vf_explained_var": -0.10739968611449792, "kl": 0.007569965118093763, "entropy": 1.182105077322198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 338.91936430659644, "episode_reward_min": -101.28738258299293, "episode_reward_mean": 106.78062099079851, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -649.942525555632, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 123.71033445623364, "predator_policy": 681.7715848119796}, "policy_reward_mean": {"prey_policy": -122.2460476451484, "predator_policy": 175.63635814054763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.06450733311001, 148.3933799875853, 149.97000000000023, 3.829999999999962, 338.91936430659644, 3.8499999999999615, 258.22857340292404, -5.942428663042268, 122.10690972451783, 131.1000000000002, 146.02779633660967, 3.9199999999999604, 119.06000000000033, 143.45773518015463, 243.20822375200493, 208.07289080214562, 102.65551021921692, 157.1771793081923, 175.87996422911573, 162.56989805895324, 35.08739399340803, 3.84999999999996, 173.40442796250363, 115.3162673319969, 82.84298931045738, 161.86474429504335, 92.10489515410708, 197.78434940052531, 142.8477913341112, 104.10766354841878, 63.434318518057296, 16.57000000000003, 90.39024640074147, 314.6711266242973, 164.36150962766916, 221.35341625135342, 81.07342115191511, 120.18600841485268, 177.03370614276022, 106.42250875368194, 127.21895630003935, 63.629353797478565, 76.84218270879221, 65.20410380869998, 3.8599999999999612, 190.73861181269314, 110.4725203117436, 198.16081480873635, 240.67165388161146, 101.05718576825569, 126.79772618746483, 115.3065701434729, 123.90858007769515, 111.60158956774292, -4.06209571807335, 56.26711738383737, 3.9199999999999604, 3.8099999999999623, 179.02010585300542, 230.02932848459025, 191.0655510344076, 3.8999999999999604, 10.809388624898398, 3.8399999999999626, 189.3562607930548, 5.851333138713882, 226.18318819489798, -40.03669786519064, -74.40962130557833, -46.216419866150105, 157.5491020851624, 208.58053768253944, 75.41666644605132, 230.03075501025282, 29.763630258696203, 6.746410220102973, 115.66905990767563, 79.66063196595469, 186.20033663844606, 50.00695964065611, -47.66298139807818, -56.63750624265778, -1.5856209109741592, 144.90498070231712, -19.372961465174768, 102.95498631392397, 197.66452620505694, 246.95495432966288, 172.3616002192357, -101.28738258299293, 171.69547547485936, 216.5901998628115, 141.69659676874443, 9.689999999999921, 7.587999763673659, 105.17567935419036, 3.9499999999999598, 196.83904116354992, 129.02484554534027, 3.8399999999999634], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-113.93148316011279, 3.680769959302695, 26.63841285188105, 2.0000000000000013, -1.21940005345317, 68.8599669072419, -10.671607495775666, -7.1133237141508925, 123.71033445623364, 115.70347196089145, -0.9896228072290598, -17.04389928575633, -2.7384067846589204, -60.42002452751637, -30.683781693007212, -11.84332234458034, -112.98424241998356, -34.183106954101085, -13.053302678628482, 66.60844496211453, -10.296293841609806, 50.13968493721055, -6.513581890154983, -1.0896447813552008, -29.00837212111059, -1.172747162510251, -40.89043782081686, -7.604810741545984, -1.263391104381924, -197.16703633999387, 2.0000000000000013, -53.62999744853222, -8.514419213805356, -27.53787025861117, -0.19976255504495177, -67.3842920168924, -22.703188639912014, 8.340867534030663, 111.00676822631273, 1.2119172181240252, -185.4282947508002, -174.65091525462324, -29.128832434459408, -22.753712622322546, -10.700621349076815, -115.36694861883296, -50.57536999805589, -28.526443821875418, -81.30446017420748, -114.07330432292338, 13.798336432708606, -50.59925763604058, -47.83707042923377, 2.0000000000000013, -116.53839388273134, 48.91921091447676, -135.5008983488852, -0.3820089465507035, -23.911589821100947, -6.990394352372849, 2.0000000000000013, -195.04676101226138, -4.326498775227083, -25.263791570265916, -0.8527232348610181, -143.13677665707357, -39.51643940195723, 77.87911347477056, -53.44961945968322, -72.83411462487915, -55.43282059815635, -132.5794826737931, -136.04932361778498, 0.02605119106310344, -98.26927625151262, -0.001693613868967738, -100.77234569443314, 25.651852368032447, -20.011779468964303, 1.0744867455308582, 1.0443854203966176, -49.45580008837078, -222.57325200387285, -7.312728309089069, -1.6989454703317481, -219.47462074617923, -369.874732841961, -253.74001436940003, -15.895878505091828, -3.3457438598024885, -3.848359517824707, -284.83298310948925, -253.80831902040867, -5.13590710718384, -14.204695905105012, -369.7008098815761, -425.25585175750587, -14.451866315341617, -402.00274648513613, -225.61040801405272, -9.644147206402959, -336.32936573845006, 1.1686012734171722, -99.67767929597615, -210.72622401585144, -0.5944038903084234, -1.4245648889268177, -110.4230736278448, -10.013508090108727, -9.12464471909048, -165.4850215087467, -327.1758844461134, 1.0375143921239596, -5.742130075316576, -14.624711294758498, -22.2012902440704, -291.5913395758246, -1.964964655709431, -491.52968331865833, -2.2716006589356574, -361.13052206090094, -2.7418377703900614, -14.577646881347624, -0.5120364055357303, -4.825928147643355, -13.406419043245815, -10.444359335141948, -7.382800310178714, -497.71648317430436, -3.2178225016038073, 2.0000000000000013, -16.472593792349645, 2.0000000000000013, -429.5538700999281, -383.6101514440071, -334.39818957523437, -333.63494966083135, -446.6842963188625, -464.7285509729035, -418.9164057338906, -18.727934317316183, -238.36888102308873, -19.708163810948673, -354.99815208606475, -407.32851042017563, -367.2332232640791, -344.91268406470715, -6.8119929285975065, -299.2416040004893, -9.090161245133926, -4.702094180669217, 0.01301945722717387, -337.6474663828495, -7.4493688629533406, -389.1897668688943, -228.08462668337458, -0.7855804869733323, -484.94411910546404, -437.3243516830598, -462.77731192428155, -365.75762376889014, -491.9978972593509, -456.8470531213239, -423.64204313771324, -13.710451894968061, -3.5256209109741254, -351.1988706334422, 0.9645549289573195, -399.15185498697144, -557.9001811556127, 0.7806632415399469, -82.14046174727409, -342.9792547546641, -10.545641058738099, -135.96824140888737, 2.2470850815137773, -2.669831861556916, -268.87578799028563, -306.30603884309215, -352.75712090021415, -382.97295779911536, -4.961876489255642, -15.977405424217773, -429.0277960597792, -4.465720105783237, -384.79406197659216, -6.892358507253567, -28.49006675634537, -649.942525555632, -569.9131967289902, -596.1353223140394, -396.6830950356303, -5.244433642521876, 0.7343181943714018, -2.6388209388062016, -464.4339967625063, 2.0000000000000013, -72.25203236032553, -29.237504023583714, -24.700124844532173], "policy_predator_policy_reward": [93.53214029631133, 258.7830802376087, 90.18811867227684, 29.566848463427405, 44.54474555318469, 37.784687593026554, 12.571607495775625, 9.043323714150851, 50.80451673073767, 48.7010411587337, 3.8625723008315482, 18.020949792154113, 180.08975767815963, 141.2972470369398, 34.35722327439732, 2.2274521001481045, 156.4900376648694, 112.78422143373238, 14.953302678628441, 62.59155503788551, 32.74639040726098, 73.4380148337479, 8.463581890154941, 3.0596447813551797, 136.030984701224, 13.210134582396872, 155.89043782081686, 36.062545921700455, 223.99673472745357, 217.641916468927, 110.30720387319494, 149.3956843774833, 73.73836031214044, 64.96943937949251, 111.57119617334877, 113.19003770678076, 98.85352898036439, 91.38875635463273, 33.17798018053221, 17.17323243398437, 175.5862505526653, 219.58035344616528, 31.80261423487032, 23.929930821912237, 144.23627988979078, 155.23571804062234, 65.5547304576766, 128.86335069425155, 138.23147278943634, 139.98928101815207, 130.80932264986467, 67.85634284851088, 115.29926671763646, 22.64269886570437, 164.5724510336767, 100.83108133510329, 115.09390577830028, 163.6367928512466, 27.839253369519767, 107.1703943523728, 27.048123997172294, 229.4329555331465, 6.276498775227042, 39.88379157026617, 88.5524223218453, 145.82732397083004, 159.2328826435889, 117.07556990789512, 148.90685598926012, 141.73838772297177, 229.28039427291927, 180.0853252503838, 174.80400890911906, 42.29268466951792, 111.50232030191435, 106.95465797831935, 103.82383219060723, 148.33036727855435, 34.14738904092114, 91.21241243619384, 88.55890248291982, 87.07146848509336, 239.70142995692458, 53.813904153515914, 56.25492666397445, 241.76082226132837, 310.76653933716847, 378.05231168289276, 17.795878505092105, 5.305743859802447, 200.9488390131145, 278.4711154268928, 252.7081297291069, 116.70861671022932, 271.2102422875524, 310.85607830786586, 377.3132427981883, 303.0661291562711, 365.011577586651, 363.6587626807938, 234.69859050939652, 238.07264862292072, 97.10948131210297, 116.70616685392852, 168.82574817132445, 166.40345981253031, 116.98207932596938, 106.46714875854491, 14.072705411878559, 1.003351679247298, 254.3412980048628, 294.5867253338345, 0.9524856078760419, 7.6721300753165345, 16.51471129475855, 24.1212902440707, 209.73864589428533, 262.8377641902547, 450.8231692590899, 273.00744320309497, 309.973594754552, 244.9643161111471, 16.49764688134767, 2.492036405535721, 19.255657753791922, 9.786078061995642, 12.344359335141908, 9.322800310178673, 375.71929490723653, 314.57127156172635, 4.067540135409155, 16.256386795654752, 259.0006145328768, 394.73644376194915, 508.7628920230827, 169.20875113096824, 392.870303988612, 313.039320685503, 465.1679158786546, 372.2606209619899, 219.98295051889096, 194.66296690667647, 267.83901179741974, 315.4478417821335, 437.0272490823286, 412.95115104797713, 280.5726228297733, 301.1828091737842, 89.67546197784105, 248.41993352647827, 5.5480047855416155, 5.887480158003444, 299.29225385134197, 161.4736413021359, 343.2887553062329, 353.64627021199084, 313.8625636150581, 358.0674726158258, 499.79797452276233, 450.3106487252352, 372.0621523813569, 438.0303872488061, 385.6972125048985, 438.1543775114807, 15.65045189496802, 0.0, 296.2828132842076, 198.85648312259477, 537.4500767429981, 400.2289979344106, 67.86664918624817, 116.4481356334097, 290.4688145541632, 260.7206074642962, 189.59450314515635, 191.08160751188015, 197.6361669576517, 246.2710531134266, 315.18229100880956, 242.59348615150364, 285.24434985105717, 274.38595991217375, 365.86982015404567, 295.7255811927633, 382.864318150704, 148.09206070041552, 14.742358507253527, 30.33006675634566, 633.7263465824144, 593.7173754658813, 681.7715848119796, 416.2225118918802, 7.204433642521834, 1.2556818056285997, 236.18934570578378, 427.72251315907897, 84.46996812125735, 114.80690978440818, 31.147504023584013, 26.630124844532475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8127103290164027, "mean_inference_ms": 2.6506190650439168, "mean_action_processing_ms": 0.35418177736515744, "mean_env_wait_ms": 0.29071493303941215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052683353424072266, "StateBufferConnector_ms": 0.0035897493362426758, "ViewRequirementAgentConnector_ms": 0.09944319725036621}, "num_episodes": 18, "episode_return_max": 338.91936430659644, "episode_return_min": -101.28738258299293, "episode_return_mean": 106.78062099079851, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.2498537548513, "num_env_steps_trained_throughput_per_sec": 341.2498537548513, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 24572.308, "restore_workers_time_ms": 0.013, "training_step_time_ms": 24572.273, "sample_time_ms": 1593.628, "learn_time_ms": 22963.351, "learn_throughput": 174.191, "synch_weights_time_ms": 14.397}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "6c58f_00000", "date": "2024-08-16_16-31-33", "timestamp": 1723806093, "time_this_iter_s": 11.72776985168457, "time_total_s": 1474.319632768631, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b342bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1474.319632768631, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 46.88823529411765, "ram_util_percent": 76.15294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9773482877741415, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 5.2599220457531155, "policy_loss": -0.004916499313410549, "vf_loss": 5.264199864927423, "vf_explained_var": -0.0005946758562925631, "kl": 0.008971123949673688, "entropy": 1.3902883032642344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3619687485316443, "cur_kl_coeff": 0.0001953125, "cur_lr": 1e-05, "total_loss": 3.258943292955873, "policy_loss": -0.0021099399509174484, "vf_loss": 3.261052608742285, "vf_explained_var": -0.1344202550630721, "kl": 0.003239036446343738, "entropy": 1.2624989799090793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 314.6711266242973, "episode_reward_min": -142.04620498428403, "episode_reward_mean": 96.1298280317156, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -649.942525555632, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.00676822631273, "predator_policy": 681.7715848119796}, "policy_reward_mean": {"prey_policy": -145.76758678621673, "predator_policy": 193.83250080207458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.87996422911573, 162.56989805895324, 35.08739399340803, 3.84999999999996, 173.40442796250363, 115.3162673319969, 82.84298931045738, 161.86474429504335, 92.10489515410708, 197.78434940052531, 142.8477913341112, 104.10766354841878, 63.434318518057296, 16.57000000000003, 90.39024640074147, 314.6711266242973, 164.36150962766916, 221.35341625135342, 81.07342115191511, 120.18600841485268, 177.03370614276022, 106.42250875368194, 127.21895630003935, 63.629353797478565, 76.84218270879221, 65.20410380869998, 3.8599999999999612, 190.73861181269314, 110.4725203117436, 198.16081480873635, 240.67165388161146, 101.05718576825569, 126.79772618746483, 115.3065701434729, 123.90858007769515, 111.60158956774292, -4.06209571807335, 56.26711738383737, 3.9199999999999604, 3.8099999999999623, 179.02010585300542, 230.02932848459025, 191.0655510344076, 3.8999999999999604, 10.809388624898398, 3.8399999999999626, 189.3562607930548, 5.851333138713882, 226.18318819489798, -40.03669786519064, -74.40962130557833, -46.216419866150105, 157.5491020851624, 208.58053768253944, 75.41666644605132, 230.03075501025282, 29.763630258696203, 6.746410220102973, 115.66905990767563, 79.66063196595469, 186.20033663844606, 50.00695964065611, -47.66298139807818, -56.63750624265778, -1.5856209109741592, 144.90498070231712, -19.372961465174768, 102.95498631392397, 197.66452620505694, 246.95495432966288, 172.3616002192357, -101.28738258299293, 171.69547547485936, 216.5901998628115, 141.69659676874443, 9.689999999999921, 7.587999763673659, 105.17567935419036, 3.9499999999999598, 196.83904116354992, 129.02484554534027, 3.8399999999999634, 149.1904210346358, 3.979999999999959, 264.18212560532083, 165.6149930770529, 83.19547201266415, 268.31118937266234, 23.666168414586032, 3.8899999999999606, 3.8799999999999613, 1.09826836614943, 99.47450777414575, 5.829999999999922, -142.04620498428403, 3.9199999999999604, 208.8709722998455, 88.63270001081376, 3.779999999999963, 215.5497327981339], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.703188639912014, 8.340867534030663, 111.00676822631273, 1.2119172181240252, -185.4282947508002, -174.65091525462324, -29.128832434459408, -22.753712622322546, -10.700621349076815, -115.36694861883296, -50.57536999805589, -28.526443821875418, -81.30446017420748, -114.07330432292338, 13.798336432708606, -50.59925763604058, -47.83707042923377, 2.0000000000000013, -116.53839388273134, 48.91921091447676, -135.5008983488852, -0.3820089465507035, -23.911589821100947, -6.990394352372849, 2.0000000000000013, -195.04676101226138, -4.326498775227083, -25.263791570265916, -0.8527232348610181, -143.13677665707357, -39.51643940195723, 77.87911347477056, -53.44961945968322, -72.83411462487915, -55.43282059815635, -132.5794826737931, -136.04932361778498, 0.02605119106310344, -98.26927625151262, -0.001693613868967738, -100.77234569443314, 25.651852368032447, -20.011779468964303, 1.0744867455308582, 1.0443854203966176, -49.45580008837078, -222.57325200387285, -7.312728309089069, -1.6989454703317481, -219.47462074617923, -369.874732841961, -253.74001436940003, -15.895878505091828, -3.3457438598024885, -3.848359517824707, -284.83298310948925, -253.80831902040867, -5.13590710718384, -14.204695905105012, -369.7008098815761, -425.25585175750587, -14.451866315341617, -402.00274648513613, -225.61040801405272, -9.644147206402959, -336.32936573845006, 1.1686012734171722, -99.67767929597615, -210.72622401585144, -0.5944038903084234, -1.4245648889268177, -110.4230736278448, -10.013508090108727, -9.12464471909048, -165.4850215087467, -327.1758844461134, 1.0375143921239596, -5.742130075316576, -14.624711294758498, -22.2012902440704, -291.5913395758246, -1.964964655709431, -491.52968331865833, -2.2716006589356574, -361.13052206090094, -2.7418377703900614, -14.577646881347624, -0.5120364055357303, -4.825928147643355, -13.406419043245815, -10.444359335141948, -7.382800310178714, -497.71648317430436, -3.2178225016038073, 2.0000000000000013, -16.472593792349645, 2.0000000000000013, -429.5538700999281, -383.6101514440071, -334.39818957523437, -333.63494966083135, -446.6842963188625, -464.7285509729035, -418.9164057338906, -18.727934317316183, -238.36888102308873, -19.708163810948673, -354.99815208606475, -407.32851042017563, -367.2332232640791, -344.91268406470715, -6.8119929285975065, -299.2416040004893, -9.090161245133926, -4.702094180669217, 0.01301945722717387, -337.6474663828495, -7.4493688629533406, -389.1897668688943, -228.08462668337458, -0.7855804869733323, -484.94411910546404, -437.3243516830598, -462.77731192428155, -365.75762376889014, -491.9978972593509, -456.8470531213239, -423.64204313771324, -13.710451894968061, -3.5256209109741254, -351.1988706334422, 0.9645549289573195, -399.15185498697144, -557.9001811556127, 0.7806632415399469, -82.14046174727409, -342.9792547546641, -10.545641058738099, -135.96824140888737, 2.2470850815137773, -2.669831861556916, -268.87578799028563, -306.30603884309215, -352.75712090021415, -382.97295779911536, -4.961876489255642, -15.977405424217773, -429.0277960597792, -4.465720105783237, -384.79406197659216, -6.892358507253567, -28.49006675634537, -649.942525555632, -569.9131967289902, -596.1353223140394, -396.6830950356303, -5.244433642521876, 0.7343181943714018, -2.6388209388062016, -464.4339967625063, 2.0000000000000013, -72.25203236032553, -29.237504023583714, -24.700124844532173, -229.84542817752845, -2.584971607885203, 2.0000000000000013, -0.27042381228455414, -498.69684785667, -5.944527917198791, -458.571327509667, -4.946401697500975, -404.99025743788195, -460.5724691563439, -15.898114745787746, -612.9165261490526, -334.3186619238313, -1.9328565553510673, -14.57377229940739, -4.813946885312786, 0.3348096661514601, -14.53843279953818, -9.28135976387435, -11.999979801048534, -12.700529437602706, -339.4606555538246, -0.17747025876965616, -12.12737185704851, -309.78617459724444, -426.1391097466194, -7.671685559466294, 2.0000000000000013, -249.97344093071715, 2.0000000000000013, -197.86467085200007, 0.2658697197983814, -18.71037965130681, -12.813650108343019, 2.0000000000000013, -448.5941581309502], "policy_predator_policy_reward": [98.85352898036439, 91.38875635463273, 33.17798018053221, 17.17323243398437, 175.5862505526653, 219.58035344616528, 31.80261423487032, 23.929930821912237, 144.23627988979078, 155.23571804062234, 65.5547304576766, 128.86335069425155, 138.23147278943634, 139.98928101815207, 130.80932264986467, 67.85634284851088, 115.29926671763646, 22.64269886570437, 164.5724510336767, 100.83108133510329, 115.09390577830028, 163.6367928512466, 27.839253369519767, 107.1703943523728, 27.048123997172294, 229.4329555331465, 6.276498775227042, 39.88379157026617, 88.5524223218453, 145.82732397083004, 159.2328826435889, 117.07556990789512, 148.90685598926012, 141.73838772297177, 229.28039427291927, 180.0853252503838, 174.80400890911906, 42.29268466951792, 111.50232030191435, 106.95465797831935, 103.82383219060723, 148.33036727855435, 34.14738904092114, 91.21241243619384, 88.55890248291982, 87.07146848509336, 239.70142995692458, 53.813904153515914, 56.25492666397445, 241.76082226132837, 310.76653933716847, 378.05231168289276, 17.795878505092105, 5.305743859802447, 200.9488390131145, 278.4711154268928, 252.7081297291069, 116.70861671022932, 271.2102422875524, 310.85607830786586, 377.3132427981883, 303.0661291562711, 365.011577586651, 363.6587626807938, 234.69859050939652, 238.07264862292072, 97.10948131210297, 116.70616685392852, 168.82574817132445, 166.40345981253031, 116.98207932596938, 106.46714875854491, 14.072705411878559, 1.003351679247298, 254.3412980048628, 294.5867253338345, 0.9524856078760419, 7.6721300753165345, 16.51471129475855, 24.1212902440707, 209.73864589428533, 262.8377641902547, 450.8231692590899, 273.00744320309497, 309.973594754552, 244.9643161111471, 16.49764688134767, 2.492036405535721, 19.255657753791922, 9.786078061995642, 12.344359335141908, 9.322800310178673, 375.71929490723653, 314.57127156172635, 4.067540135409155, 16.256386795654752, 259.0006145328768, 394.73644376194915, 508.7628920230827, 169.20875113096824, 392.870303988612, 313.039320685503, 465.1679158786546, 372.2606209619899, 219.98295051889096, 194.66296690667647, 267.83901179741974, 315.4478417821335, 437.0272490823286, 412.95115104797713, 280.5726228297733, 301.1828091737842, 89.67546197784105, 248.41993352647827, 5.5480047855416155, 5.887480158003444, 299.29225385134197, 161.4736413021359, 343.2887553062329, 353.64627021199084, 313.8625636150581, 358.0674726158258, 499.79797452276233, 450.3106487252352, 372.0621523813569, 438.0303872488061, 385.6972125048985, 438.1543775114807, 15.65045189496802, 0.0, 296.2828132842076, 198.85648312259477, 537.4500767429981, 400.2289979344106, 67.86664918624817, 116.4481356334097, 290.4688145541632, 260.7206074642962, 189.59450314515635, 191.08160751188015, 197.6361669576517, 246.2710531134266, 315.18229100880956, 242.59348615150364, 285.24434985105717, 274.38595991217375, 365.86982015404567, 295.7255811927633, 382.864318150704, 148.09206070041552, 14.742358507253527, 30.33006675634566, 633.7263465824144, 593.7173754658813, 681.7715848119796, 416.2225118918802, 7.204433642521834, 1.2556818056285997, 236.18934570578378, 427.72251315907897, 84.46996812125735, 114.80690978440818, 31.147504023584013, 26.630124844532475, 148.86305888129817, 232.75776193875117, 0.0, 2.2504238122845504, 443.61451806436065, 325.20898331483, 279.62913795775086, 349.50358432647016, 542.4675486780525, 406.29064992883764, 432.56258969101344, 464.56324057649016, 24.567681074661365, 335.3500058191069, 16.503772299407437, 6.7739468853127445, 1.6451903338485414, 16.438432799538216, 3.2146699910866565, 19.164937939985588, 138.91267262422897, 312.72302014134357, 5.472581435279278, 12.662260680538848, 399.5639427773817, 194.31513658219805, 9.591685559466253, 0.0, 243.3626359049947, 213.48177732556863, 81.14523048963244, 205.08627065338288, 20.590379651307103, 14.713650108342978, 215.31466205817884, 446.8292288709054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8105794326732106, "mean_inference_ms": 2.644439347125444, "mean_action_processing_ms": 0.35318145167170684, "mean_env_wait_ms": 0.289848871710251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057659149169921875, "StateBufferConnector_ms": 0.0036208629608154297, "ViewRequirementAgentConnector_ms": 0.1028892993927002}, "num_episodes": 18, "episode_return_max": 314.6711266242973, "episode_return_min": -142.04620498428403, "episode_return_mean": 96.1298280317156, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.11298459196374, "num_env_steps_trained_throughput_per_sec": 4.11298459196374, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 120603.32, "restore_workers_time_ms": 0.012, "training_step_time_ms": 120603.285, "sample_time_ms": 1592.152, "learn_time_ms": 118995.82, "learn_throughput": 33.615, "synch_weights_time_ms": 14.412}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "6c58f_00000", "date": "2024-08-16_16-47-45", "timestamp": 1723807065, "time_this_iter_s": 972.5825190544128, "time_total_s": 2446.902151823044, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b342b9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2446.902151823044, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 54.25555555555556, "ram_util_percent": 76.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9042818204278038, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.1301060219921135, "policy_loss": -0.00401581477043687, "vf_loss": 7.133676530949022, "vf_explained_var": -0.0007439138081969407, "kl": 0.006254866851161982, "entropy": 1.3649101913921418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3281004465761639, "cur_kl_coeff": 9.765625e-05, "cur_lr": 1e-05, "total_loss": 4.939354975639827, "policy_loss": -0.0019401652218586712, "vf_loss": 4.94129402864547, "vf_explained_var": -0.08476617979624915, "kl": 0.011490590049315404, "entropy": 1.222598924144866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 307.77478581576156, "episode_reward_min": -142.04620498428403, "episode_reward_mean": 92.04990621860901, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -730.8254412994075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 2.2470850815137773, "predator_policy": 755.4310519873821}, "policy_reward_mean": {"prey_policy": -179.8426317845647, "predator_policy": 225.86758489386924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [127.21895630003935, 63.629353797478565, 76.84218270879221, 65.20410380869998, 3.8599999999999612, 190.73861181269314, 110.4725203117436, 198.16081480873635, 240.67165388161146, 101.05718576825569, 126.79772618746483, 115.3065701434729, 123.90858007769515, 111.60158956774292, -4.06209571807335, 56.26711738383737, 3.9199999999999604, 3.8099999999999623, 179.02010585300542, 230.02932848459025, 191.0655510344076, 3.8999999999999604, 10.809388624898398, 3.8399999999999626, 189.3562607930548, 5.851333138713882, 226.18318819489798, -40.03669786519064, -74.40962130557833, -46.216419866150105, 157.5491020851624, 208.58053768253944, 75.41666644605132, 230.03075501025282, 29.763630258696203, 6.746410220102973, 115.66905990767563, 79.66063196595469, 186.20033663844606, 50.00695964065611, -47.66298139807818, -56.63750624265778, -1.5856209109741592, 144.90498070231712, -19.372961465174768, 102.95498631392397, 197.66452620505694, 246.95495432966288, 172.3616002192357, -101.28738258299293, 171.69547547485936, 216.5901998628115, 141.69659676874443, 9.689999999999921, 7.587999763673659, 105.17567935419036, 3.9499999999999598, 196.83904116354992, 129.02484554534027, 3.8399999999999634, 149.1904210346358, 3.979999999999959, 264.18212560532083, 165.6149930770529, 83.19547201266415, 268.31118937266234, 23.666168414586032, 3.8899999999999606, 3.8799999999999613, 1.09826836614943, 99.47450777414575, 5.829999999999922, -142.04620498428403, 3.9199999999999604, 208.8709722998455, 88.63270001081376, 3.779999999999963, 215.5497327981339, 5.525906377166881, 307.77478581576156, 185.6971234076995, 161.2050589368454, 54.5592398773798, 39.05967086006582, 236.1058320375711, -79.05545711756932, 294.52015169471804, -5.710901801381006, 47.547856903045016, 5.087985073589095, 3.879999999999961, 154.6495537198658, 40.275426045081836, 3.889999999999961, 238.2399516907449, 3.9499999999999598, 106.26624727165952, 3.819999999999963, 302.0970017049386, 285.77903269612676], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0443854203966176, -49.45580008837078, -222.57325200387285, -7.312728309089069, -1.6989454703317481, -219.47462074617923, -369.874732841961, -253.74001436940003, -15.895878505091828, -3.3457438598024885, -3.848359517824707, -284.83298310948925, -253.80831902040867, -5.13590710718384, -14.204695905105012, -369.7008098815761, -425.25585175750587, -14.451866315341617, -402.00274648513613, -225.61040801405272, -9.644147206402959, -336.32936573845006, 1.1686012734171722, -99.67767929597615, -210.72622401585144, -0.5944038903084234, -1.4245648889268177, -110.4230736278448, -10.013508090108727, -9.12464471909048, -165.4850215087467, -327.1758844461134, 1.0375143921239596, -5.742130075316576, -14.624711294758498, -22.2012902440704, -291.5913395758246, -1.964964655709431, -491.52968331865833, -2.2716006589356574, -361.13052206090094, -2.7418377703900614, -14.577646881347624, -0.5120364055357303, -4.825928147643355, -13.406419043245815, -10.444359335141948, -7.382800310178714, -497.71648317430436, -3.2178225016038073, 2.0000000000000013, -16.472593792349645, 2.0000000000000013, -429.5538700999281, -383.6101514440071, -334.39818957523437, -333.63494966083135, -446.6842963188625, -464.7285509729035, -418.9164057338906, -18.727934317316183, -238.36888102308873, -19.708163810948673, -354.99815208606475, -407.32851042017563, -367.2332232640791, -344.91268406470715, -6.8119929285975065, -299.2416040004893, -9.090161245133926, -4.702094180669217, 0.01301945722717387, -337.6474663828495, -7.4493688629533406, -389.1897668688943, -228.08462668337458, -0.7855804869733323, -484.94411910546404, -437.3243516830598, -462.77731192428155, -365.75762376889014, -491.9978972593509, -456.8470531213239, -423.64204313771324, -13.710451894968061, -3.5256209109741254, -351.1988706334422, 0.9645549289573195, -399.15185498697144, -557.9001811556127, 0.7806632415399469, -82.14046174727409, -342.9792547546641, -10.545641058738099, -135.96824140888737, 2.2470850815137773, -2.669831861556916, -268.87578799028563, -306.30603884309215, -352.75712090021415, -382.97295779911536, -4.961876489255642, -15.977405424217773, -429.0277960597792, -4.465720105783237, -384.79406197659216, -6.892358507253567, -28.49006675634537, -649.942525555632, -569.9131967289902, -596.1353223140394, -396.6830950356303, -5.244433642521876, 0.7343181943714018, -2.6388209388062016, -464.4339967625063, 2.0000000000000013, -72.25203236032553, -29.237504023583714, -24.700124844532173, -229.84542817752845, -2.584971607885203, 2.0000000000000013, -0.27042381228455414, -498.69684785667, -5.944527917198791, -458.571327509667, -4.946401697500975, -404.99025743788195, -460.5724691563439, -15.898114745787746, -612.9165261490526, -334.3186619238313, -1.9328565553510673, -14.57377229940739, -4.813946885312786, 0.3348096661514601, -14.53843279953818, -9.28135976387435, -11.999979801048534, -12.700529437602706, -339.4606555538246, -0.17747025876965616, -12.12737185704851, -309.78617459724444, -426.1391097466194, -7.671685559466294, 2.0000000000000013, -249.97344093071715, 2.0000000000000013, -197.86467085200007, 0.2658697197983814, -18.71037965130681, -12.813650108343019, 2.0000000000000013, -448.5941581309502, -9.930942492136081, -5.760253799102382, -532.6605860701826, 0.3710390922159896, -25.31264824966591, -331.3623840679882, -394.680562915567, -3.3050214104814186, -427.8246088196564, -514.1680696987125, -730.8254412994075, -645.0317708279821, -514.1864607986487, -2.6643905604709746, -384.8768816367403, -409.1415548326261, -532.1329920556834, 2.0000000000000013, -22.244568934673694, -11.97736352762772, 1.0534849693488544, -118.90665559713456, 0.14602305694079315, -2.7753117302817003, -2.068543360165987, -13.671644086942454, -7.220900161759813, -342.8491363316509, -275.53858535680024, -232.8710773638145, -13.802215191004567, -6.610605221974646, -401.61913123866503, -9.329870376231858, -7.351158473830406, 2.0000000000000013, -425.9604031196067, 0.9168926876744948, -4.755353444363527, -27.166453320206646, -489.14950514533854, -10.451325660779819, -374.9507613164203, -558.9678489351255], "policy_predator_policy_reward": [88.55890248291982, 87.07146848509336, 239.70142995692458, 53.813904153515914, 56.25492666397445, 241.76082226132837, 310.76653933716847, 378.05231168289276, 17.795878505092105, 5.305743859802447, 200.9488390131145, 278.4711154268928, 252.7081297291069, 116.70861671022932, 271.2102422875524, 310.85607830786586, 377.3132427981883, 303.0661291562711, 365.011577586651, 363.6587626807938, 234.69859050939652, 238.07264862292072, 97.10948131210297, 116.70616685392852, 168.82574817132445, 166.40345981253031, 116.98207932596938, 106.46714875854491, 14.072705411878559, 1.003351679247298, 254.3412980048628, 294.5867253338345, 0.9524856078760419, 7.6721300753165345, 16.51471129475855, 24.1212902440707, 209.73864589428533, 262.8377641902547, 450.8231692590899, 273.00744320309497, 309.973594754552, 244.9643161111471, 16.49764688134767, 2.492036405535721, 19.255657753791922, 9.786078061995642, 12.344359335141908, 9.322800310178673, 375.71929490723653, 314.57127156172635, 4.067540135409155, 16.256386795654752, 259.0006145328768, 394.73644376194915, 508.7628920230827, 169.20875113096824, 392.870303988612, 313.039320685503, 465.1679158786546, 372.2606209619899, 219.98295051889096, 194.66296690667647, 267.83901179741974, 315.4478417821335, 437.0272490823286, 412.95115104797713, 280.5726228297733, 301.1828091737842, 89.67546197784105, 248.41993352647827, 5.5480047855416155, 5.887480158003444, 299.29225385134197, 161.4736413021359, 343.2887553062329, 353.64627021199084, 313.8625636150581, 358.0674726158258, 499.79797452276233, 450.3106487252352, 372.0621523813569, 438.0303872488061, 385.6972125048985, 438.1543775114807, 15.65045189496802, 0.0, 296.2828132842076, 198.85648312259477, 537.4500767429981, 400.2289979344106, 67.86664918624817, 116.4481356334097, 290.4688145541632, 260.7206074642962, 189.59450314515635, 191.08160751188015, 197.6361669576517, 246.2710531134266, 315.18229100880956, 242.59348615150364, 285.24434985105717, 274.38595991217375, 365.86982015404567, 295.7255811927633, 382.864318150704, 148.09206070041552, 14.742358507253527, 30.33006675634566, 633.7263465824144, 593.7173754658813, 681.7715848119796, 416.2225118918802, 7.204433642521834, 1.2556818056285997, 236.18934570578378, 427.72251315907897, 84.46996812125735, 114.80690978440818, 31.147504023584013, 26.630124844532475, 148.86305888129817, 232.75776193875117, 0.0, 2.2504238122845504, 443.61451806436065, 325.20898331483, 279.62913795775086, 349.50358432647016, 542.4675486780525, 406.29064992883764, 432.56258969101344, 464.56324057649016, 24.567681074661365, 335.3500058191069, 16.503772299407437, 6.7739468853127445, 1.6451903338485414, 16.438432799538216, 3.2146699910866565, 19.164937939985588, 138.91267262422897, 312.72302014134357, 5.472581435279278, 12.662260680538848, 399.5639427773817, 194.31513658219805, 9.591685559466253, 0.0, 243.3626359049947, 213.48177732556863, 81.14523048963244, 205.08627065338288, 20.590379651307103, 14.713650108342978, 215.31466205817884, 446.8292288709054, 10.436259658243742, 10.780843010161595, 412.48005142890497, 427.58428136482434, 301.4770417778171, 240.89511394753725, 185.96456181144592, 373.22608145144784, 539.3233841876036, 457.22853420814545, 659.4858310000727, 755.4310519873821, 340.752432060659, 412.2042513360319, 271.1678239286467, 443.7951554231502, 414.4398809789051, 410.213262771497, 2.832282039229932, 25.678748621690804, 50.84062380653445, 114.56040372429749, 2.9819620166483674, 4.7353117302816585, 4.038543360165945, 15.581644086942413, 134.62404548417817, 370.09554472909844, 183.36947976659522, 365.31560899910085, 15.732215191004526, 8.570605221974605, 366.05001675522226, 283.1389365504196, 9.301158473830364, 0.0, 412.62625525556683, 118.6835024480245, 6.685353444363486, 29.05645332020694, 404.6696839310054, 397.0281485800524, 649.5243209468656, 570.1733220008068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8086577237335436, "mean_inference_ms": 2.6382688899331264, "mean_action_processing_ms": 0.35224544857384044, "mean_env_wait_ms": 0.2889581960740243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00670623779296875, "StateBufferConnector_ms": 0.003580331802368164, "ViewRequirementAgentConnector_ms": 0.10217738151550293}, "num_episodes": 22, "episode_return_max": 307.77478581576156, "episode_return_min": -142.04620498428403, "episode_return_mean": 92.04990621860901, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.35545982802716, "num_env_steps_trained_throughput_per_sec": 330.35545982802716, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 120642.031, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120641.995, "sample_time_ms": 1658.271, "learn_time_ms": 118967.525, "learn_throughput": 33.623, "synch_weights_time_ms": 15.31}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "6c58f_00000", "date": "2024-08-16_16-47-57", "timestamp": 1723807077, "time_this_iter_s": 12.118262767791748, "time_total_s": 2459.0204145908356, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2459.0204145908356, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 48.94117647058823, "ram_util_percent": 76.23529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9419675666188437, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 7.178710177083495, "policy_loss": -0.003647806867957115, "vf_loss": 7.1817914359784, "vf_explained_var": 0.00031193050127180795, "kl": 0.007958061497510577, "entropy": 1.3503005755641473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2641492542608705, "cur_kl_coeff": 9.765625e-05, "cur_lr": 1e-05, "total_loss": 4.570773376106585, "policy_loss": -0.003216207747362436, "vf_loss": 4.573988997747028, "vf_explained_var": -0.07406618355443238, "kl": 0.0059217196452424825, "entropy": 1.1814340467806215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 423.20384090356424, "episode_reward_min": -142.04620498428403, "episode_reward_mean": 107.71522088944943, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -730.8254412994075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 2.2470850815137773, "predator_policy": 755.4310519873821}, "policy_reward_mean": {"prey_policy": -197.86909147882804, "predator_policy": 251.72670192355287}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.02010585300542, 230.02932848459025, 191.0655510344076, 3.8999999999999604, 10.809388624898398, 3.8399999999999626, 189.3562607930548, 5.851333138713882, 226.18318819489798, -40.03669786519064, -74.40962130557833, -46.216419866150105, 157.5491020851624, 208.58053768253944, 75.41666644605132, 230.03075501025282, 29.763630258696203, 6.746410220102973, 115.66905990767563, 79.66063196595469, 186.20033663844606, 50.00695964065611, -47.66298139807818, -56.63750624265778, -1.5856209109741592, 144.90498070231712, -19.372961465174768, 102.95498631392397, 197.66452620505694, 246.95495432966288, 172.3616002192357, -101.28738258299293, 171.69547547485936, 216.5901998628115, 141.69659676874443, 9.689999999999921, 7.587999763673659, 105.17567935419036, 3.9499999999999598, 196.83904116354992, 129.02484554534027, 3.8399999999999634, 149.1904210346358, 3.979999999999959, 264.18212560532083, 165.6149930770529, 83.19547201266415, 268.31118937266234, 23.666168414586032, 3.8899999999999606, 3.8799999999999613, 1.09826836614943, 99.47450777414575, 5.829999999999922, -142.04620498428403, 3.9199999999999604, 208.8709722998455, 88.63270001081376, 3.779999999999963, 215.5497327981339, 5.525906377166881, 307.77478581576156, 185.6971234076995, 161.2050589368454, 54.5592398773798, 39.05967086006582, 236.1058320375711, -79.05545711756932, 294.52015169471804, -5.710901801381006, 47.547856903045016, 5.087985073589095, 3.879999999999961, 154.6495537198658, 40.275426045081836, 3.889999999999961, 238.2399516907449, 3.9499999999999598, 106.26624727165952, 3.819999999999963, 302.0970017049386, 285.77903269612676, 423.20384090356424, 3.889999999999961, 299.305811870027, 277.91304699363786, 258.28916730374146, 308.2046703205975, 4.6899999999999435, 238.62717855364494, 304.2434619260855, 4.86999999999994, 137.36855323099056, 339.0015268768548, 217.1767596430391, 3.9299999999999593, 77.80855132727339, 7.537277764312184, 248.35693026854466, 127.51956094192087], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-291.5913395758246, -1.964964655709431, -491.52968331865833, -2.2716006589356574, -361.13052206090094, -2.7418377703900614, -14.577646881347624, -0.5120364055357303, -4.825928147643355, -13.406419043245815, -10.444359335141948, -7.382800310178714, -497.71648317430436, -3.2178225016038073, 2.0000000000000013, -16.472593792349645, 2.0000000000000013, -429.5538700999281, -383.6101514440071, -334.39818957523437, -333.63494966083135, -446.6842963188625, -464.7285509729035, -418.9164057338906, -18.727934317316183, -238.36888102308873, -19.708163810948673, -354.99815208606475, -407.32851042017563, -367.2332232640791, -344.91268406470715, -6.8119929285975065, -299.2416040004893, -9.090161245133926, -4.702094180669217, 0.01301945722717387, -337.6474663828495, -7.4493688629533406, -389.1897668688943, -228.08462668337458, -0.7855804869733323, -484.94411910546404, -437.3243516830598, -462.77731192428155, -365.75762376889014, -491.9978972593509, -456.8470531213239, -423.64204313771324, -13.710451894968061, -3.5256209109741254, -351.1988706334422, 0.9645549289573195, -399.15185498697144, -557.9001811556127, 0.7806632415399469, -82.14046174727409, -342.9792547546641, -10.545641058738099, -135.96824140888737, 2.2470850815137773, -2.669831861556916, -268.87578799028563, -306.30603884309215, -352.75712090021415, -382.97295779911536, -4.961876489255642, -15.977405424217773, -429.0277960597792, -4.465720105783237, -384.79406197659216, -6.892358507253567, -28.49006675634537, -649.942525555632, -569.9131967289902, -596.1353223140394, -396.6830950356303, -5.244433642521876, 0.7343181943714018, -2.6388209388062016, -464.4339967625063, 2.0000000000000013, -72.25203236032553, -29.237504023583714, -24.700124844532173, -229.84542817752845, -2.584971607885203, 2.0000000000000013, -0.27042381228455414, -498.69684785667, -5.944527917198791, -458.571327509667, -4.946401697500975, -404.99025743788195, -460.5724691563439, -15.898114745787746, -612.9165261490526, -334.3186619238313, -1.9328565553510673, -14.57377229940739, -4.813946885312786, 0.3348096661514601, -14.53843279953818, -9.28135976387435, -11.999979801048534, -12.700529437602706, -339.4606555538246, -0.17747025876965616, -12.12737185704851, -309.78617459724444, -426.1391097466194, -7.671685559466294, 2.0000000000000013, -249.97344093071715, 2.0000000000000013, -197.86467085200007, 0.2658697197983814, -18.71037965130681, -12.813650108343019, 2.0000000000000013, -448.5941581309502, -9.930942492136081, -5.760253799102382, -532.6605860701826, 0.3710390922159896, -25.31264824966591, -331.3623840679882, -394.680562915567, -3.3050214104814186, -427.8246088196564, -514.1680696987125, -730.8254412994075, -645.0317708279821, -514.1864607986487, -2.6643905604709746, -384.8768816367403, -409.1415548326261, -532.1329920556834, 2.0000000000000013, -22.244568934673694, -11.97736352762772, 1.0534849693488544, -118.90665559713456, 0.14602305694079315, -2.7753117302817003, -2.068543360165987, -13.671644086942454, -7.220900161759813, -342.8491363316509, -275.53858535680024, -232.8710773638145, -13.802215191004567, -6.610605221974646, -401.61913123866503, -9.329870376231858, -7.351158473830406, 2.0000000000000013, -425.9604031196067, 0.9168926876744948, -4.755353444363527, -27.166453320206646, -489.14950514533854, -10.451325660779819, -374.9507613164203, -558.9678489351255, -689.6880960546271, -15.467576988670821, -8.587493934643918, 0.8836352028331279, -391.1786748248375, -4.346969110254383, -316.197832260928, 0.4598030283838667, -462.66475682642744, -5.400577812489642, -521.7627715023905, 0.6069109690126447, 1.1684967217709914, -38.82757948879292, -480.328761980171, -16.366206356399143, -13.044160160260942, -466.0462484285073, -8.301198570663397, -1.7159333260137213, -2.2435498091467503, -345.7313134703866, 1.1134398257066334, -570.541168173911, -0.8162125757451173, -346.28939913302145, -21.64202119879554, 2.0000000000000013, -513.3652418954098, -451.81157573118514, -410.9706818690477, -496.40728685786826, -32.95204545291857, -457.5978904875296, -520.9347518543369, -462.45605972875444], "policy_predator_policy_reward": [209.73864589428533, 262.8377641902547, 450.8231692590899, 273.00744320309497, 309.973594754552, 244.9643161111471, 16.49764688134767, 2.492036405535721, 19.255657753791922, 9.786078061995642, 12.344359335141908, 9.322800310178673, 375.71929490723653, 314.57127156172635, 4.067540135409155, 16.256386795654752, 259.0006145328768, 394.73644376194915, 508.7628920230827, 169.20875113096824, 392.870303988612, 313.039320685503, 465.1679158786546, 372.2606209619899, 219.98295051889096, 194.66296690667647, 267.83901179741974, 315.4478417821335, 437.0272490823286, 412.95115104797713, 280.5726228297733, 301.1828091737842, 89.67546197784105, 248.41993352647827, 5.5480047855416155, 5.887480158003444, 299.29225385134197, 161.4736413021359, 343.2887553062329, 353.64627021199084, 313.8625636150581, 358.0674726158258, 499.79797452276233, 450.3106487252352, 372.0621523813569, 438.0303872488061, 385.6972125048985, 438.1543775114807, 15.65045189496802, 0.0, 296.2828132842076, 198.85648312259477, 537.4500767429981, 400.2289979344106, 67.86664918624817, 116.4481356334097, 290.4688145541632, 260.7206074642962, 189.59450314515635, 191.08160751188015, 197.6361669576517, 246.2710531134266, 315.18229100880956, 242.59348615150364, 285.24434985105717, 274.38595991217375, 365.86982015404567, 295.7255811927633, 382.864318150704, 148.09206070041552, 14.742358507253527, 30.33006675634566, 633.7263465824144, 593.7173754658813, 681.7715848119796, 416.2225118918802, 7.204433642521834, 1.2556818056285997, 236.18934570578378, 427.72251315907897, 84.46996812125735, 114.80690978440818, 31.147504023584013, 26.630124844532475, 148.86305888129817, 232.75776193875117, 0.0, 2.2504238122845504, 443.61451806436065, 325.20898331483, 279.62913795775086, 349.50358432647016, 542.4675486780525, 406.29064992883764, 432.56258969101344, 464.56324057649016, 24.567681074661365, 335.3500058191069, 16.503772299407437, 6.7739468853127445, 1.6451903338485414, 16.438432799538216, 3.2146699910866565, 19.164937939985588, 138.91267262422897, 312.72302014134357, 5.472581435279278, 12.662260680538848, 399.5639427773817, 194.31513658219805, 9.591685559466253, 0.0, 243.3626359049947, 213.48177732556863, 81.14523048963244, 205.08627065338288, 20.590379651307103, 14.713650108342978, 215.31466205817884, 446.8292288709054, 10.436259658243742, 10.780843010161595, 412.48005142890497, 427.58428136482434, 301.4770417778171, 240.89511394753725, 185.96456181144592, 373.22608145144784, 539.3233841876036, 457.22853420814545, 659.4858310000727, 755.4310519873821, 340.752432060659, 412.2042513360319, 271.1678239286467, 443.7951554231502, 414.4398809789051, 410.213262771497, 2.832282039229932, 25.678748621690804, 50.84062380653445, 114.56040372429749, 2.9819620166483674, 4.7353117302816585, 4.038543360165945, 15.581644086942413, 134.62404548417817, 370.09554472909844, 183.36947976659522, 365.31560899910085, 15.732215191004526, 8.570605221974605, 366.05001675522226, 283.1389365504196, 9.301158473830364, 0.0, 412.62625525556683, 118.6835024480245, 6.685353444363486, 29.05645332020694, 404.6696839310054, 397.0281485800524, 649.5243209468656, 570.1733220008068, 493.58585150671246, 634.7736624401515, 9.753807339444442, 1.8400513923663095, 348.0771530728611, 346.7543027322583, 322.5940075088118, 271.05706871737067, 366.0339414496696, 360.32056049298933, 451.76733670130943, 377.59319415266657, 6.327036815844424, 36.02204595117718, 363.8255632324944, 371.4965836577206, 368.0236842776476, 415.3101862372065, 11.201198570663355, 3.6859333260136857, 285.32305433237127, 200.02036217815362, 412.46935887725675, 495.9598963478033, 280.9035387311367, 283.3788326206699, 23.57202119879584, 0.0, 446.98190725756945, 596.0034616962988, 530.4203377898083, 384.49490870141904, 379.0898363606726, 359.81702984832026, 590.783417464669, 520.1269550603436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8077942095826265, "mean_inference_ms": 2.6355295737911355, "mean_action_processing_ms": 0.351861133811337, "mean_env_wait_ms": 0.2885853570487056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007091045379638672, "StateBufferConnector_ms": 0.004229187965393066, "ViewRequirementAgentConnector_ms": 0.15875911712646484}, "num_episodes": 18, "episode_return_max": 423.20384090356424, "episode_return_min": -142.04620498428403, "episode_return_mean": 107.71522088944943, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.3130072842062, "num_env_steps_trained_throughput_per_sec": 320.3130072842062, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 120657.568, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120657.531, "sample_time_ms": 1730.974, "learn_time_ms": 118911.116, "learn_throughput": 33.639, "synch_weights_time_ms": 14.517}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "6c58f_00000", "date": "2024-08-16_16-48-10", "timestamp": 1723807090, "time_this_iter_s": 12.494055271148682, "time_total_s": 2471.5144698619843, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b33b8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2471.5144698619843, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 46.758823529411764, "ram_util_percent": 75.9235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9836067899352028, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 5.450719643648339, "policy_loss": -0.004778080979835183, "vf_loss": 5.454699200675601, "vf_explained_var": 9.529530686676187e-05, "kl": 0.011216511141326834, "entropy": 1.3347500602404276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6340681989041586, "cur_kl_coeff": 9.765625e-05, "cur_lr": 1e-05, "total_loss": 3.8288899390155047, "policy_loss": -0.009469082806180551, "vf_loss": 3.8383575732115083, "vf_explained_var": -0.09159829345329729, "kl": 0.014795687153837682, "entropy": 1.2401721124926572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 423.20384090356424, "episode_reward_min": -142.04620498428403, "episode_reward_mean": 122.21069893028867, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -730.8254412994075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 40.574295157196005, "predator_policy": 755.4310519873821}, "policy_reward_mean": {"prey_policy": -185.39502398333792, "predator_policy": 246.50037344848235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.63750624265778, -1.5856209109741592, 144.90498070231712, -19.372961465174768, 102.95498631392397, 197.66452620505694, 246.95495432966288, 172.3616002192357, -101.28738258299293, 171.69547547485936, 216.5901998628115, 141.69659676874443, 9.689999999999921, 7.587999763673659, 105.17567935419036, 3.9499999999999598, 196.83904116354992, 129.02484554534027, 3.8399999999999634, 149.1904210346358, 3.979999999999959, 264.18212560532083, 165.6149930770529, 83.19547201266415, 268.31118937266234, 23.666168414586032, 3.8899999999999606, 3.8799999999999613, 1.09826836614943, 99.47450777414575, 5.829999999999922, -142.04620498428403, 3.9199999999999604, 208.8709722998455, 88.63270001081376, 3.779999999999963, 215.5497327981339, 5.525906377166881, 307.77478581576156, 185.6971234076995, 161.2050589368454, 54.5592398773798, 39.05967086006582, 236.1058320375711, -79.05545711756932, 294.52015169471804, -5.710901801381006, 47.547856903045016, 5.087985073589095, 3.879999999999961, 154.6495537198658, 40.275426045081836, 3.889999999999961, 238.2399516907449, 3.9499999999999598, 106.26624727165952, 3.819999999999963, 302.0970017049386, 285.77903269612676, 423.20384090356424, 3.889999999999961, 299.305811870027, 277.91304699363786, 258.28916730374146, 308.2046703205975, 4.6899999999999435, 238.62717855364494, 304.2434619260855, 4.86999999999994, 137.36855323099056, 339.0015268768548, 217.1767596430391, 3.9299999999999593, 77.80855132727339, 7.537277764312184, 248.35693026854466, 127.51956094192087, 3.7499999999999627, 243.34972605458165, 318.1512665082529, 269.4798391390283, 299.7910527948464, 7.819999999999922, 242.86668568387034, 3.8799999999999613, 206.74927932147824, 3.0385544938267106, 3.979999999999959, 319.06788706368684, 222.63993342421216, 230.72803922301455, 3.979999999999959, 56.91518958348479, 11.97381545801474, 256.8635609036706, 225.90561139641423, 208.26572127499054, 69.21830788185105, 202.87591550652135, 9.610943916286793], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-456.8470531213239, -423.64204313771324, -13.710451894968061, -3.5256209109741254, -351.1988706334422, 0.9645549289573195, -399.15185498697144, -557.9001811556127, 0.7806632415399469, -82.14046174727409, -342.9792547546641, -10.545641058738099, -135.96824140888737, 2.2470850815137773, -2.669831861556916, -268.87578799028563, -306.30603884309215, -352.75712090021415, -382.97295779911536, -4.961876489255642, -15.977405424217773, -429.0277960597792, -4.465720105783237, -384.79406197659216, -6.892358507253567, -28.49006675634537, -649.942525555632, -569.9131967289902, -596.1353223140394, -396.6830950356303, -5.244433642521876, 0.7343181943714018, -2.6388209388062016, -464.4339967625063, 2.0000000000000013, -72.25203236032553, -29.237504023583714, -24.700124844532173, -229.84542817752845, -2.584971607885203, 2.0000000000000013, -0.27042381228455414, -498.69684785667, -5.944527917198791, -458.571327509667, -4.946401697500975, -404.99025743788195, -460.5724691563439, -15.898114745787746, -612.9165261490526, -334.3186619238313, -1.9328565553510673, -14.57377229940739, -4.813946885312786, 0.3348096661514601, -14.53843279953818, -9.28135976387435, -11.999979801048534, -12.700529437602706, -339.4606555538246, -0.17747025876965616, -12.12737185704851, -309.78617459724444, -426.1391097466194, -7.671685559466294, 2.0000000000000013, -249.97344093071715, 2.0000000000000013, -197.86467085200007, 0.2658697197983814, -18.71037965130681, -12.813650108343019, 2.0000000000000013, -448.5941581309502, -9.930942492136081, -5.760253799102382, -532.6605860701826, 0.3710390922159896, -25.31264824966591, -331.3623840679882, -394.680562915567, -3.3050214104814186, -427.8246088196564, -514.1680696987125, -730.8254412994075, -645.0317708279821, -514.1864607986487, -2.6643905604709746, -384.8768816367403, -409.1415548326261, -532.1329920556834, 2.0000000000000013, -22.244568934673694, -11.97736352762772, 1.0534849693488544, -118.90665559713456, 0.14602305694079315, -2.7753117302817003, -2.068543360165987, -13.671644086942454, -7.220900161759813, -342.8491363316509, -275.53858535680024, -232.8710773638145, -13.802215191004567, -6.610605221974646, -401.61913123866503, -9.329870376231858, -7.351158473830406, 2.0000000000000013, -425.9604031196067, 0.9168926876744948, -4.755353444363527, -27.166453320206646, -489.14950514533854, -10.451325660779819, -374.9507613164203, -558.9678489351255, -689.6880960546271, -15.467576988670821, -8.587493934643918, 0.8836352028331279, -391.1786748248375, -4.346969110254383, -316.197832260928, 0.4598030283838667, -462.66475682642744, -5.400577812489642, -521.7627715023905, 0.6069109690126447, 1.1684967217709914, -38.82757948879292, -480.328761980171, -16.366206356399143, -13.044160160260942, -466.0462484285073, -8.301198570663397, -1.7159333260137213, -2.2435498091467503, -345.7313134703866, 1.1134398257066334, -570.541168173911, -0.8162125757451173, -346.28939913302145, -21.64202119879554, 2.0000000000000013, -513.3652418954098, -451.81157573118514, -410.9706818690477, -496.40728685786826, -32.95204545291857, -457.5978904875296, -520.9347518543369, -462.45605972875444, -18.923856955914733, -20.81360521635177, -4.594354012797262, -368.5841371813906, -2.5214449428073182, -606.9846646259532, -242.65789131722033, 40.574295157196005, -578.9487176053887, -24.063117390806358, -6.38170479675229, -3.5949498120085694, -5.024475875476829, -351.89256501629075, 0.24177128406293508, -9.041123880493744, -290.6459436279165, -7.375760062390011, -19.640570915406883, -2.7604092514198575, 2.0000000000000013, -0.08972170307083754, -548.2667719508096, -38.032059381308805, -291.1560131454062, -8.442778486048136, -274.4488891994714, -494.13757610880833, 0.8302811114240131, 1.263297994456973, -30.99576112866159, -19.604229635611034, -0.4687292522241049, -24.141903771809698, -22.00674274431441, -450.2554726907337, -411.12260130297193, -2.829687229070016, -308.28428967953164, -180.14731965591542, -567.6132864233427, -429.54215019020046, -437.08696011610704, -220.0616252375286, -1.8130357005868085, -29.48019557635121], "policy_predator_policy_reward": [385.6972125048985, 438.1543775114807, 15.65045189496802, 0.0, 296.2828132842076, 198.85648312259477, 537.4500767429981, 400.2289979344106, 67.86664918624817, 116.4481356334097, 290.4688145541632, 260.7206074642962, 189.59450314515635, 191.08160751188015, 197.6361669576517, 246.2710531134266, 315.18229100880956, 242.59348615150364, 285.24434985105717, 274.38595991217375, 365.86982015404567, 295.7255811927633, 382.864318150704, 148.09206070041552, 14.742358507253527, 30.33006675634566, 633.7263465824144, 593.7173754658813, 681.7715848119796, 416.2225118918802, 7.204433642521834, 1.2556818056285997, 236.18934570578378, 427.72251315907897, 84.46996812125735, 114.80690978440818, 31.147504023584013, 26.630124844532475, 148.86305888129817, 232.75776193875117, 0.0, 2.2504238122845504, 443.61451806436065, 325.20898331483, 279.62913795775086, 349.50358432647016, 542.4675486780525, 406.29064992883764, 432.56258969101344, 464.56324057649016, 24.567681074661365, 335.3500058191069, 16.503772299407437, 6.7739468853127445, 1.6451903338485414, 16.438432799538216, 3.2146699910866565, 19.164937939985588, 138.91267262422897, 312.72302014134357, 5.472581435279278, 12.662260680538848, 399.5639427773817, 194.31513658219805, 9.591685559466253, 0.0, 243.3626359049947, 213.48177732556863, 81.14523048963244, 205.08627065338288, 20.590379651307103, 14.713650108342978, 215.31466205817884, 446.8292288709054, 10.436259658243742, 10.780843010161595, 412.48005142890497, 427.58428136482434, 301.4770417778171, 240.89511394753725, 185.96456181144592, 373.22608145144784, 539.3233841876036, 457.22853420814545, 659.4858310000727, 755.4310519873821, 340.752432060659, 412.2042513360319, 271.1678239286467, 443.7951554231502, 414.4398809789051, 410.213262771497, 2.832282039229932, 25.678748621690804, 50.84062380653445, 114.56040372429749, 2.9819620166483674, 4.7353117302816585, 4.038543360165945, 15.581644086942413, 134.62404548417817, 370.09554472909844, 183.36947976659522, 365.31560899910085, 15.732215191004526, 8.570605221974605, 366.05001675522226, 283.1389365504196, 9.301158473830364, 0.0, 412.62625525556683, 118.6835024480245, 6.685353444363486, 29.05645332020694, 404.6696839310054, 397.0281485800524, 649.5243209468656, 570.1733220008068, 493.58585150671246, 634.7736624401515, 9.753807339444442, 1.8400513923663095, 348.0771530728611, 346.7543027322583, 322.5940075088118, 271.05706871737067, 366.0339414496696, 360.32056049298933, 451.76733670130943, 377.59319415266657, 6.327036815844424, 36.02204595117718, 363.8255632324944, 371.4965836577206, 368.0236842776476, 415.3101862372065, 11.201198570663355, 3.6859333260136857, 285.32305433237127, 200.02036217815362, 412.46935887725675, 495.9598963478033, 280.9035387311367, 283.3788326206699, 23.57202119879584, 0.0, 446.98190725756945, 596.0034616962988, 530.4203377898083, 384.49490870141904, 379.0898363606726, 359.81702984832026, 590.783417464669, 520.1269550603436, 20.773856955915022, 22.713605216352068, 311.20369235133006, 305.32452489744014, 488.0690485852572, 439.58832749175616, 247.98037919361644, 223.58305610543712, 463.0449701646576, 439.75791762638335, 12.25170479675225, 5.544949812008528, 308.7948192506445, 290.98890732499444, 8.756515562930144, 3.9228370335006266, 238.00599375819945, 266.7649892535858, 21.570570915407185, 3.868963745246548, 2.069721703070838, 0.0, 470.89508036391663, 434.47163803188874, 253.62187216568458, 268.6168528899818, 469.2045590874653, 530.1099454438283, 1.1597188885759884, 0.7267020055430282, 51.8487162064662, 55.66646414129201, 16.984037223895385, 19.60041125815351, 296.18740792510243, 432.9383684136169, 362.9332812170124, 276.92461871144434, 386.79302255622804, 309.9043080542097, 478.78807234428064, 587.5856721511137, 379.0495566941933, 480.9749441659635, 6.858084414949888, 34.04609077827517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8065025002681141, "mean_inference_ms": 2.6314111530072637, "mean_action_processing_ms": 0.35128188851420455, "mean_env_wait_ms": 0.288065188619042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006443977355957031, "StateBufferConnector_ms": 0.0038765668869018555, "ViewRequirementAgentConnector_ms": 0.15657949447631836}, "num_episodes": 23, "episode_return_max": 423.20384090356424, "episode_return_min": -142.04620498428403, "episode_return_mean": 122.21069893028867, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.4195830366044, "num_env_steps_trained_throughput_per_sec": 370.4195830366044, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 120427.919, "restore_workers_time_ms": 0.013, "training_step_time_ms": 120427.882, "sample_time_ms": 1597.675, "learn_time_ms": 118815.116, "learn_throughput": 33.666, "synch_weights_time_ms": 14.082}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "6c58f_00000", "date": "2024-08-16_16-48-21", "timestamp": 1723807101, "time_this_iter_s": 10.803990125656128, "time_total_s": 2482.3184599876404, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b07da3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2482.3184599876404, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 26.231249999999996, "ram_util_percent": 61.362500000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0394067903990467, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 2.3955231971210904, "policy_loss": -0.0045029974910898735, "vf_loss": 2.3991794204585766, "vf_explained_var": 0.0017744159572338932, "kl": 0.011894270762080677, "entropy": 1.3282692141633816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5779428005849243, "cur_kl_coeff": 9.765625e-05, "cur_lr": 1e-05, "total_loss": 1.9508384537759913, "policy_loss": -0.004100034295497512, "vf_loss": 1.9549377666263985, "vf_explained_var": -0.1023274184219421, "kl": 0.00740253570334931, "entropy": 1.2005734918609499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 423.20384090356424, "episode_reward_min": -142.04620498428403, "episode_reward_mean": 118.06767278062605, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -730.8254412994075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 40.574295157196005, "predator_policy": 755.4310519873821}, "policy_reward_mean": {"prey_policy": -156.72806849727206, "predator_policy": 215.76190488758522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.8399999999999634, 149.1904210346358, 3.979999999999959, 264.18212560532083, 165.6149930770529, 83.19547201266415, 268.31118937266234, 23.666168414586032, 3.8899999999999606, 3.8799999999999613, 1.09826836614943, 99.47450777414575, 5.829999999999922, -142.04620498428403, 3.9199999999999604, 208.8709722998455, 88.63270001081376, 3.779999999999963, 215.5497327981339, 5.525906377166881, 307.77478581576156, 185.6971234076995, 161.2050589368454, 54.5592398773798, 39.05967086006582, 236.1058320375711, -79.05545711756932, 294.52015169471804, -5.710901801381006, 47.547856903045016, 5.087985073589095, 3.879999999999961, 154.6495537198658, 40.275426045081836, 3.889999999999961, 238.2399516907449, 3.9499999999999598, 106.26624727165952, 3.819999999999963, 302.0970017049386, 285.77903269612676, 423.20384090356424, 3.889999999999961, 299.305811870027, 277.91304699363786, 258.28916730374146, 308.2046703205975, 4.6899999999999435, 238.62717855364494, 304.2434619260855, 4.86999999999994, 137.36855323099056, 339.0015268768548, 217.1767596430391, 3.9299999999999593, 77.80855132727339, 7.537277764312184, 248.35693026854466, 127.51956094192087, 3.7499999999999627, 243.34972605458165, 318.1512665082529, 269.4798391390283, 299.7910527948464, 7.819999999999922, 242.86668568387034, 3.8799999999999613, 206.74927932147824, 3.0385544938267106, 3.979999999999959, 319.06788706368684, 222.63993342421216, 230.72803922301455, 3.979999999999959, 56.91518958348479, 11.97381545801474, 256.8635609036706, 225.90561139641423, 208.26572127499054, 69.21830788185105, 202.87591550652135, 9.610943916286793, 3.879999999999961, -2.587939711596504, 138.39013414877576, 175.50563924249252, 224.76673452163232, 3.9699999999999593, 3.9099999999999606, 37.78075512201832, 44.22538476755204, 43.10928563107637, 7.437114907206898, 35.63182472023511, 13.419999999999943, 197.8202920243662, 215.4371026715465, 25.688888772987845, 8.157298793407847, 77.36228392360397], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.237504023583714, -24.700124844532173, -229.84542817752845, -2.584971607885203, 2.0000000000000013, -0.27042381228455414, -498.69684785667, -5.944527917198791, -458.571327509667, -4.946401697500975, -404.99025743788195, -460.5724691563439, -15.898114745787746, -612.9165261490526, -334.3186619238313, -1.9328565553510673, -14.57377229940739, -4.813946885312786, 0.3348096661514601, -14.53843279953818, -9.28135976387435, -11.999979801048534, -12.700529437602706, -339.4606555538246, -0.17747025876965616, -12.12737185704851, -309.78617459724444, -426.1391097466194, -7.671685559466294, 2.0000000000000013, -249.97344093071715, 2.0000000000000013, -197.86467085200007, 0.2658697197983814, -18.71037965130681, -12.813650108343019, 2.0000000000000013, -448.5941581309502, -9.930942492136081, -5.760253799102382, -532.6605860701826, 0.3710390922159896, -25.31264824966591, -331.3623840679882, -394.680562915567, -3.3050214104814186, -427.8246088196564, -514.1680696987125, -730.8254412994075, -645.0317708279821, -514.1864607986487, -2.6643905604709746, -384.8768816367403, -409.1415548326261, -532.1329920556834, 2.0000000000000013, -22.244568934673694, -11.97736352762772, 1.0534849693488544, -118.90665559713456, 0.14602305694079315, -2.7753117302817003, -2.068543360165987, -13.671644086942454, -7.220900161759813, -342.8491363316509, -275.53858535680024, -232.8710773638145, -13.802215191004567, -6.610605221974646, -401.61913123866503, -9.329870376231858, -7.351158473830406, 2.0000000000000013, -425.9604031196067, 0.9168926876744948, -4.755353444363527, -27.166453320206646, -489.14950514533854, -10.451325660779819, -374.9507613164203, -558.9678489351255, -689.6880960546271, -15.467576988670821, -8.587493934643918, 0.8836352028331279, -391.1786748248375, -4.346969110254383, -316.197832260928, 0.4598030283838667, -462.66475682642744, -5.400577812489642, -521.7627715023905, 0.6069109690126447, 1.1684967217709914, -38.82757948879292, -480.328761980171, -16.366206356399143, -13.044160160260942, -466.0462484285073, -8.301198570663397, -1.7159333260137213, -2.2435498091467503, -345.7313134703866, 1.1134398257066334, -570.541168173911, -0.8162125757451173, -346.28939913302145, -21.64202119879554, 2.0000000000000013, -513.3652418954098, -451.81157573118514, -410.9706818690477, -496.40728685786826, -32.95204545291857, -457.5978904875296, -520.9347518543369, -462.45605972875444, -18.923856955914733, -20.81360521635177, -4.594354012797262, -368.5841371813906, -2.5214449428073182, -606.9846646259532, -242.65789131722033, 40.574295157196005, -578.9487176053887, -24.063117390806358, -6.38170479675229, -3.5949498120085694, -5.024475875476829, -351.89256501629075, 0.24177128406293508, -9.041123880493744, -290.6459436279165, -7.375760062390011, -19.640570915406883, -2.7604092514198575, 2.0000000000000013, -0.08972170307083754, -548.2667719508096, -38.032059381308805, -291.1560131454062, -8.442778486048136, -274.4488891994714, -494.13757610880833, 0.8302811114240131, 1.263297994456973, -30.99576112866159, -19.604229635611034, -0.4687292522241049, -24.141903771809698, -22.00674274431441, -450.2554726907337, -411.12260130297193, -2.829687229070016, -308.28428967953164, -180.14731965591542, -567.6132864233427, -429.54215019020046, -437.08696011610704, -220.0616252375286, -1.8130357005868085, -29.48019557635121, 0.7712408268918124, -19.07062308331053, -43.3427472738357, -19.377920835548483, -251.69792327805152, 0.6903146086278235, -1.9621767825484122, -8.710550099759054, -377.80939576788455, -195.07935099951473, 2.0000000000000013, -3.3874335328024223, -4.059827774563616, -1.0372788693685913, -97.66543306957718, -3.222166606509818, -67.36214303365986, -6.145758124241713, -10.116561640810838, -10.890045786126796, -0.20611772106431347, -9.329762129530957, -73.37979123123897, -1.4005686089494662, -3.9739737635670345, -71.51410622023911, -12.541032150523401, -129.02686578869563, -238.7954620206422, -150.74895074851335, -0.8032131768533555, -26.761457961097953, -28.1106192348057, -5.092274087102227, 2.0000000000000013, -115.76642623754472], "policy_predator_policy_reward": [31.147504023584013, 26.630124844532475, 148.86305888129817, 232.75776193875117, 0.0, 2.2504238122845504, 443.61451806436065, 325.20898331483, 279.62913795775086, 349.50358432647016, 542.4675486780525, 406.29064992883764, 432.56258969101344, 464.56324057649016, 24.567681074661365, 335.3500058191069, 16.503772299407437, 6.7739468853127445, 1.6451903338485414, 16.438432799538216, 3.2146699910866565, 19.164937939985588, 138.91267262422897, 312.72302014134357, 5.472581435279278, 12.662260680538848, 399.5639427773817, 194.31513658219805, 9.591685559466253, 0.0, 243.3626359049947, 213.48177732556863, 81.14523048963244, 205.08627065338288, 20.590379651307103, 14.713650108342978, 215.31466205817884, 446.8292288709054, 10.436259658243742, 10.780843010161595, 412.48005142890497, 427.58428136482434, 301.4770417778171, 240.89511394753725, 185.96456181144592, 373.22608145144784, 539.3233841876036, 457.22853420814545, 659.4858310000727, 755.4310519873821, 340.752432060659, 412.2042513360319, 271.1678239286467, 443.7951554231502, 414.4398809789051, 410.213262771497, 2.832282039229932, 25.678748621690804, 50.84062380653445, 114.56040372429749, 2.9819620166483674, 4.7353117302816585, 4.038543360165945, 15.581644086942413, 134.62404548417817, 370.09554472909844, 183.36947976659522, 365.31560899910085, 15.732215191004526, 8.570605221974605, 366.05001675522226, 283.1389365504196, 9.301158473830364, 0.0, 412.62625525556683, 118.6835024480245, 6.685353444363486, 29.05645332020694, 404.6696839310054, 397.0281485800524, 649.5243209468656, 570.1733220008068, 493.58585150671246, 634.7736624401515, 9.753807339444442, 1.8400513923663095, 348.0771530728611, 346.7543027322583, 322.5940075088118, 271.05706871737067, 366.0339414496696, 360.32056049298933, 451.76733670130943, 377.59319415266657, 6.327036815844424, 36.02204595117718, 363.8255632324944, 371.4965836577206, 368.0236842776476, 415.3101862372065, 11.201198570663355, 3.6859333260136857, 285.32305433237127, 200.02036217815362, 412.46935887725675, 495.9598963478033, 280.9035387311367, 283.3788326206699, 23.57202119879584, 0.0, 446.98190725756945, 596.0034616962988, 530.4203377898083, 384.49490870141904, 379.0898363606726, 359.81702984832026, 590.783417464669, 520.1269550603436, 20.773856955915022, 22.713605216352068, 311.20369235133006, 305.32452489744014, 488.0690485852572, 439.58832749175616, 247.98037919361644, 223.58305610543712, 463.0449701646576, 439.75791762638335, 12.25170479675225, 5.544949812008528, 308.7948192506445, 290.98890732499444, 8.756515562930144, 3.9228370335006266, 238.00599375819945, 266.7649892535858, 21.570570915407185, 3.868963745246548, 2.069721703070838, 0.0, 470.89508036391663, 434.47163803188874, 253.62187216568458, 268.6168528899818, 469.2045590874653, 530.1099454438283, 1.1597188885759884, 0.7267020055430282, 51.8487162064662, 55.66646414129201, 16.984037223895385, 19.60041125815351, 296.18740792510243, 432.9383684136169, 362.9332812170124, 276.92461871144434, 386.79302255622804, 309.9043080542097, 478.78807234428064, 587.5856721511137, 379.0495566941933, 480.9749441659635, 6.858084414949888, 34.04609077827517, 1.218759173108189, 20.960623083310825, 45.305898051077506, 14.826830346710185, 218.86439811002725, 170.53334470817276, 93.54347366415523, 92.63489246064482, 371.74000585168494, 425.91547543734566, 0.0, 5.35743353280238, 5.999827774563575, 3.007278869368571, 68.91383005739162, 69.75452474071517, 42.7910888014738, 74.94219712398085, 50.386561640810804, 13.72933141720363, 5.683232628271293, 11.289762129530915, 65.6535959894776, 44.75858857094723, 5.933973763566993, 82.97410622023983, 170.75269251685006, 168.6354974467355, 354.1140007518913, 250.86751468881084, 39.63016874757086, 13.623391163368009, 11.359572880510113, 30.000619234805995, 93.03240666623667, 98.09630349491138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8054543875358354, "mean_inference_ms": 2.6278250915087313, "mean_action_processing_ms": 0.3508047811854864, "mean_env_wait_ms": 0.28759712632577655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059365034103393555, "StateBufferConnector_ms": 0.0038660764694213867, "ViewRequirementAgentConnector_ms": 0.153387188911438}, "num_episodes": 18, "episode_return_max": 423.20384090356424, "episode_return_min": -142.04620498428403, "episode_return_mean": 118.06767278062605, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.43072169129225, "num_env_steps_trained_throughput_per_sec": 4.43072169129225, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 209555.828, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209555.791, "sample_time_ms": 1567.114, "learn_time_ms": 207973.088, "learn_throughput": 19.233, "synch_weights_time_ms": 14.528}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "6c58f_00000", "date": "2024-08-16_17-03-24", "timestamp": 1723808004, "time_this_iter_s": 902.7921590805054, "time_total_s": 3385.1106190681458, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b04dd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3385.1106190681458, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 29.60625, "ram_util_percent": 61.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8997481791272995, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 1.5569931496072698, "policy_loss": -0.006834620675417008, "vf_loss": 1.5628477776492085, "vf_explained_var": 0.0012861712584419855, "kl": 0.013765633378548478, "entropy": 1.3302865572707363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6223846384930232, "cur_kl_coeff": 9.765625e-05, "cur_lr": 1e-05, "total_loss": 1.2010098506691596, "policy_loss": -0.0016087042852723724, "vf_loss": 1.2026181137593335, "vf_explained_var": -0.14681157400368383, "kl": 0.004476737279833748, "entropy": 1.1914729988133466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 423.20384090356424, "episode_reward_min": -79.05545711756932, "episode_reward_mean": 107.52112681678487, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -730.8254412994075, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 71.34064084919048, "predator_policy": 755.4310519873821}, "policy_reward_mean": {"prey_policy": -131.7760466980306, "predator_policy": 185.53661010642315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.2050589368454, 54.5592398773798, 39.05967086006582, 236.1058320375711, -79.05545711756932, 294.52015169471804, -5.710901801381006, 47.547856903045016, 5.087985073589095, 3.879999999999961, 154.6495537198658, 40.275426045081836, 3.889999999999961, 238.2399516907449, 3.9499999999999598, 106.26624727165952, 3.819999999999963, 302.0970017049386, 285.77903269612676, 423.20384090356424, 3.889999999999961, 299.305811870027, 277.91304699363786, 258.28916730374146, 308.2046703205975, 4.6899999999999435, 238.62717855364494, 304.2434619260855, 4.86999999999994, 137.36855323099056, 339.0015268768548, 217.1767596430391, 3.9299999999999593, 77.80855132727339, 7.537277764312184, 248.35693026854466, 127.51956094192087, 3.7499999999999627, 243.34972605458165, 318.1512665082529, 269.4798391390283, 299.7910527948464, 7.819999999999922, 242.86668568387034, 3.8799999999999613, 206.74927932147824, 3.0385544938267106, 3.979999999999959, 319.06788706368684, 222.63993342421216, 230.72803922301455, 3.979999999999959, 56.91518958348479, 11.97381545801474, 256.8635609036706, 225.90561139641423, 208.26572127499054, 69.21830788185105, 202.87591550652135, 9.610943916286793, 3.879999999999961, -2.587939711596504, 138.39013414877576, 175.50563924249252, 224.76673452163232, 3.9699999999999593, 3.9099999999999606, 37.78075512201832, 44.22538476755204, 43.10928563107637, 7.437114907206898, 35.63182472023511, 13.419999999999943, 197.8202920243662, 215.4371026715465, 25.688888772987845, 8.157298793407847, 77.36228392360397, 3.7099999999999644, 10.770518042651773, 3.92999999999996, 3.9699999999999593, 12.29941108939407, 5.849186418998591, 26.951232620899752, 3.9199999999999604, 158.64296233697695, 81.40854903174993, 160.2036335462867, 16.690000000000044, 199.24851377877346, 52.369999999999436, 17.194043582690334, 11.960658068609757, 3.94999999999996, 20.183730855245457, 11.136233009979822, 86.95489261597815, 3.929999999999961, 3.9299999999999606], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.680562915567, -3.3050214104814186, -427.8246088196564, -514.1680696987125, -730.8254412994075, -645.0317708279821, -514.1864607986487, -2.6643905604709746, -384.8768816367403, -409.1415548326261, -532.1329920556834, 2.0000000000000013, -22.244568934673694, -11.97736352762772, 1.0534849693488544, -118.90665559713456, 0.14602305694079315, -2.7753117302817003, -2.068543360165987, -13.671644086942454, -7.220900161759813, -342.8491363316509, -275.53858535680024, -232.8710773638145, -13.802215191004567, -6.610605221974646, -401.61913123866503, -9.329870376231858, -7.351158473830406, 2.0000000000000013, -425.9604031196067, 0.9168926876744948, -4.755353444363527, -27.166453320206646, -489.14950514533854, -10.451325660779819, -374.9507613164203, -558.9678489351255, -689.6880960546271, -15.467576988670821, -8.587493934643918, 0.8836352028331279, -391.1786748248375, -4.346969110254383, -316.197832260928, 0.4598030283838667, -462.66475682642744, -5.400577812489642, -521.7627715023905, 0.6069109690126447, 1.1684967217709914, -38.82757948879292, -480.328761980171, -16.366206356399143, -13.044160160260942, -466.0462484285073, -8.301198570663397, -1.7159333260137213, -2.2435498091467503, -345.7313134703866, 1.1134398257066334, -570.541168173911, -0.8162125757451173, -346.28939913302145, -21.64202119879554, 2.0000000000000013, -513.3652418954098, -451.81157573118514, -410.9706818690477, -496.40728685786826, -32.95204545291857, -457.5978904875296, -520.9347518543369, -462.45605972875444, -18.923856955914733, -20.81360521635177, -4.594354012797262, -368.5841371813906, -2.5214449428073182, -606.9846646259532, -242.65789131722033, 40.574295157196005, -578.9487176053887, -24.063117390806358, -6.38170479675229, -3.5949498120085694, -5.024475875476829, -351.89256501629075, 0.24177128406293508, -9.041123880493744, -290.6459436279165, -7.375760062390011, -19.640570915406883, -2.7604092514198575, 2.0000000000000013, -0.08972170307083754, -548.2667719508096, -38.032059381308805, -291.1560131454062, -8.442778486048136, -274.4488891994714, -494.13757610880833, 0.8302811114240131, 1.263297994456973, -30.99576112866159, -19.604229635611034, -0.4687292522241049, -24.141903771809698, -22.00674274431441, -450.2554726907337, -411.12260130297193, -2.829687229070016, -308.28428967953164, -180.14731965591542, -567.6132864233427, -429.54215019020046, -437.08696011610704, -220.0616252375286, -1.8130357005868085, -29.48019557635121, 0.7712408268918124, -19.07062308331053, -43.3427472738357, -19.377920835548483, -251.69792327805152, 0.6903146086278235, -1.9621767825484122, -8.710550099759054, -377.80939576788455, -195.07935099951473, 2.0000000000000013, -3.3874335328024223, -4.059827774563616, -1.0372788693685913, -97.66543306957718, -3.222166606509818, -67.36214303365986, -6.145758124241713, -10.116561640810838, -10.890045786126796, -0.20611772106431347, -9.329762129530957, -73.37979123123897, -1.4005686089494662, -3.9739737635670345, -71.51410622023911, -12.541032150523401, -129.02686578869563, -238.7954620206422, -150.74895074851335, -0.8032131768533555, -26.761457961097953, -28.1106192348057, -5.092274087102227, 2.0000000000000013, -115.76642623754472, -15.386375760247702, -27.091597834912637, -4.746716215083867, -57.79996613560173, -5.0255382366430705, 0.15137315764776121, 2.0000000000000013, -1.0421607990630366, 0.8830304392723726, -21.567374874632872, -22.646229394313757, -13.802838982268604, -103.97037289035937, -51.821213980912795, 0.10028252860033147, -8.626695048461375, -7.9256076015194665, -9.185136164865824, 10.198286207864376, -0.8785365833593228, 71.34064084919048, -120.23182493582685, -11.979979683099137, -11.405727145316217, -36.34796918348113, -181.83783495124317, 15.324617581185311, 1.002835640978779, -19.896290245732747, -82.03698325602696, -13.8786777943962, -9.373870726107283, 0.2078656329287431, -0.7843374222812827, -57.59066614028852, -107.8032065640527, -1.7609181206231055, -32.92091654818192, -5.233330221948793, -118.45557412330315, -14.161087163976426, 1.0771808593246521, -5.911926948212226, -1.4625992214398869], "policy_predator_policy_reward": [185.96456181144592, 373.22608145144784, 539.3233841876036, 457.22853420814545, 659.4858310000727, 755.4310519873821, 340.752432060659, 412.2042513360319, 271.1678239286467, 443.7951554231502, 414.4398809789051, 410.213262771497, 2.832282039229932, 25.678748621690804, 50.84062380653445, 114.56040372429749, 2.9819620166483674, 4.7353117302816585, 4.038543360165945, 15.581644086942413, 134.62404548417817, 370.09554472909844, 183.36947976659522, 365.31560899910085, 15.732215191004526, 8.570605221974605, 366.05001675522226, 283.1389365504196, 9.301158473830364, 0.0, 412.62625525556683, 118.6835024480245, 6.685353444363486, 29.05645332020694, 404.6696839310054, 397.0281485800524, 649.5243209468656, 570.1733220008068, 493.58585150671246, 634.7736624401515, 9.753807339444442, 1.8400513923663095, 348.0771530728611, 346.7543027322583, 322.5940075088118, 271.05706871737067, 366.0339414496696, 360.32056049298933, 451.76733670130943, 377.59319415266657, 6.327036815844424, 36.02204595117718, 363.8255632324944, 371.4965836577206, 368.0236842776476, 415.3101862372065, 11.201198570663355, 3.6859333260136857, 285.32305433237127, 200.02036217815362, 412.46935887725675, 495.9598963478033, 280.9035387311367, 283.3788326206699, 23.57202119879584, 0.0, 446.98190725756945, 596.0034616962988, 530.4203377898083, 384.49490870141904, 379.0898363606726, 359.81702984832026, 590.783417464669, 520.1269550603436, 20.773856955915022, 22.713605216352068, 311.20369235133006, 305.32452489744014, 488.0690485852572, 439.58832749175616, 247.98037919361644, 223.58305610543712, 463.0449701646576, 439.75791762638335, 12.25170479675225, 5.544949812008528, 308.7948192506445, 290.98890732499444, 8.756515562930144, 3.9228370335006266, 238.00599375819945, 266.7649892535858, 21.570570915407185, 3.868963745246548, 2.069721703070838, 0.0, 470.89508036391663, 434.47163803188874, 253.62187216568458, 268.6168528899818, 469.2045590874653, 530.1099454438283, 1.1597188885759884, 0.7267020055430282, 51.8487162064662, 55.66646414129201, 16.984037223895385, 19.60041125815351, 296.18740792510243, 432.9383684136169, 362.9332812170124, 276.92461871144434, 386.79302255622804, 309.9043080542097, 478.78807234428064, 587.5856721511137, 379.0495566941933, 480.9749441659635, 6.858084414949888, 34.04609077827517, 1.218759173108189, 20.960623083310825, 45.305898051077506, 14.826830346710185, 218.86439811002725, 170.53334470817276, 93.54347366415523, 92.63489246064482, 371.74000585168494, 425.91547543734566, 0.0, 5.35743353280238, 5.999827774563575, 3.007278869368571, 68.91383005739162, 69.75452474071517, 42.7910888014738, 74.94219712398085, 50.386561640810804, 13.72933141720363, 5.683232628271293, 11.289762129530915, 65.6535959894776, 44.75858857094723, 5.933973763566993, 82.97410622023983, 170.75269251685006, 168.6354974467355, 354.1140007518913, 250.86751468881084, 39.63016874757086, 13.623391163368009, 11.359572880510113, 30.000619234805995, 93.03240666623667, 98.09630349491138, 17.306375760247892, 28.881597834912917, 14.953658109243074, 58.363542284093974, 6.975538236643029, 1.8286268423522403, 3.012160799063017, 0.0, 12.863615292331591, 20.12014023242336, 21.965218230717415, 20.333036564863882, 101.26091942463167, 81.4819000675402, 1.87971747139967, 10.566695048461334, 84.20962974444063, 91.54407635892181, 49.11151618691199, 22.977283220331728, 84.37409829274148, 124.72071934018476, 26.769979683099148, 13.305727145316176, 197.35684470491765, 220.07747320858044, 35.05538241881466, 0.9871643590212223, 39.10996155568966, 80.01735552876139, 28.034449029259445, 7.178757559853787, 1.7721343670712582, 2.7543374222812678, 84.68703868215015, 100.89056487743655, 21.68786153987458, 24.130206138909948, 117.623620435319, 93.02017652591039, 16.101087163976402, 0.9128191406753493, 7.8719269482121845, 3.432599221439857]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8044021655423851, "mean_inference_ms": 2.6203870384658803, "mean_action_processing_ms": 0.3497771502627458, "mean_env_wait_ms": 0.2870648096195289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00494074821472168, "StateBufferConnector_ms": 0.0039299726486206055, "ViewRequirementAgentConnector_ms": 0.15011096000671387}, "num_episodes": 22, "episode_return_max": 423.20384090356424, "episode_return_min": -79.05545711756932, "episode_return_mean": 107.52112681678487, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.08750678917716, "num_env_steps_trained_throughput_per_sec": 356.08750678917716, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 209480.817, "restore_workers_time_ms": 0.013, "training_step_time_ms": 209480.781, "sample_time_ms": 1559.011, "learn_time_ms": 207906.096, "learn_throughput": 19.239, "synch_weights_time_ms": 14.61}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "6c58f_00000", "date": "2024-08-16_17-03-35", "timestamp": 1723808015, "time_this_iter_s": 11.239997863769531, "time_total_s": 3396.3506169319153, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b348faf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3396.3506169319153, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 30.96875, "ram_util_percent": 66.04374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0161021553650105, "cur_kl_coeff": 0.07119140624999996, "cur_lr": 1e-05, "total_loss": 1.6048505622243123, "policy_loss": -0.0034306191886090253, "vf_loss": 1.6080826409594722, "vf_explained_var": 0.0020379368590299415, "kl": 0.0027887834540641695, "entropy": 1.3373171604499614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4619509547160416, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 1e-05, "total_loss": 1.388193476058188, "policy_loss": -0.0034678787461151837, "vf_loss": 1.3916611356867685, "vf_explained_var": -0.05814866206002614, "kl": 0.0044553776779309474, "entropy": 1.242300901021907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 423.20384090356424, "episode_reward_min": -2.587939711596504, "episode_reward_mean": 99.64218883740176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -689.6880960546271, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 98.78795738682518, "predator_policy": 649.5243209468656}, "policy_reward_mean": {"prey_policy": -100.79611908934997, "predator_policy": 150.617213508051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [285.77903269612676, 423.20384090356424, 3.889999999999961, 299.305811870027, 277.91304699363786, 258.28916730374146, 308.2046703205975, 4.6899999999999435, 238.62717855364494, 304.2434619260855, 4.86999999999994, 137.36855323099056, 339.0015268768548, 217.1767596430391, 3.9299999999999593, 77.80855132727339, 7.537277764312184, 248.35693026854466, 127.51956094192087, 3.7499999999999627, 243.34972605458165, 318.1512665082529, 269.4798391390283, 299.7910527948464, 7.819999999999922, 242.86668568387034, 3.8799999999999613, 206.74927932147824, 3.0385544938267106, 3.979999999999959, 319.06788706368684, 222.63993342421216, 230.72803922301455, 3.979999999999959, 56.91518958348479, 11.97381545801474, 256.8635609036706, 225.90561139641423, 208.26572127499054, 69.21830788185105, 202.87591550652135, 9.610943916286793, 3.879999999999961, -2.587939711596504, 138.39013414877576, 175.50563924249252, 224.76673452163232, 3.9699999999999593, 3.9099999999999606, 37.78075512201832, 44.22538476755204, 43.10928563107637, 7.437114907206898, 35.63182472023511, 13.419999999999943, 197.8202920243662, 215.4371026715465, 25.688888772987845, 8.157298793407847, 77.36228392360397, 3.7099999999999644, 10.770518042651773, 3.92999999999996, 3.9699999999999593, 12.29941108939407, 5.849186418998591, 26.951232620899752, 3.9199999999999604, 158.64296233697695, 81.40854903174993, 160.2036335462867, 16.690000000000044, 199.24851377877346, 52.369999999999436, 17.194043582690334, 11.960658068609757, 3.94999999999996, 20.183730855245457, 11.136233009979822, 86.95489261597815, 3.929999999999961, 3.9299999999999606, 252.8471113157231, 3.9199999999999604, 52.90042716476984, 3.9199999999999604, 46.16170690582903, 3.92999999999996, 133.9498005066049, 3.9499999999999598, 45.704995811455575, 108.73191847922273, 16.71000000000005, 7.331262916266539, 3.739999999999963, 3.8799999999999604, 57.537239255996795, 53.116144219087374, 20.213212383287047, 3.9499999999999598], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-374.9507613164203, -558.9678489351255, -689.6880960546271, -15.467576988670821, -8.587493934643918, 0.8836352028331279, -391.1786748248375, -4.346969110254383, -316.197832260928, 0.4598030283838667, -462.66475682642744, -5.400577812489642, -521.7627715023905, 0.6069109690126447, 1.1684967217709914, -38.82757948879292, -480.328761980171, -16.366206356399143, -13.044160160260942, -466.0462484285073, -8.301198570663397, -1.7159333260137213, -2.2435498091467503, -345.7313134703866, 1.1134398257066334, -570.541168173911, -0.8162125757451173, -346.28939913302145, -21.64202119879554, 2.0000000000000013, -513.3652418954098, -451.81157573118514, -410.9706818690477, -496.40728685786826, -32.95204545291857, -457.5978904875296, -520.9347518543369, -462.45605972875444, -18.923856955914733, -20.81360521635177, -4.594354012797262, -368.5841371813906, -2.5214449428073182, -606.9846646259532, -242.65789131722033, 40.574295157196005, -578.9487176053887, -24.063117390806358, -6.38170479675229, -3.5949498120085694, -5.024475875476829, -351.89256501629075, 0.24177128406293508, -9.041123880493744, -290.6459436279165, -7.375760062390011, -19.640570915406883, -2.7604092514198575, 2.0000000000000013, -0.08972170307083754, -548.2667719508096, -38.032059381308805, -291.1560131454062, -8.442778486048136, -274.4488891994714, -494.13757610880833, 0.8302811114240131, 1.263297994456973, -30.99576112866159, -19.604229635611034, -0.4687292522241049, -24.141903771809698, -22.00674274431441, -450.2554726907337, -411.12260130297193, -2.829687229070016, -308.28428967953164, -180.14731965591542, -567.6132864233427, -429.54215019020046, -437.08696011610704, -220.0616252375286, -1.8130357005868085, -29.48019557635121, 0.7712408268918124, -19.07062308331053, -43.3427472738357, -19.377920835548483, -251.69792327805152, 0.6903146086278235, -1.9621767825484122, -8.710550099759054, -377.80939576788455, -195.07935099951473, 2.0000000000000013, -3.3874335328024223, -4.059827774563616, -1.0372788693685913, -97.66543306957718, -3.222166606509818, -67.36214303365986, -6.145758124241713, -10.116561640810838, -10.890045786126796, -0.20611772106431347, -9.329762129530957, -73.37979123123897, -1.4005686089494662, -3.9739737635670345, -71.51410622023911, -12.541032150523401, -129.02686578869563, -238.7954620206422, -150.74895074851335, -0.8032131768533555, -26.761457961097953, -28.1106192348057, -5.092274087102227, 2.0000000000000013, -115.76642623754472, -15.386375760247702, -27.091597834912637, -4.746716215083867, -57.79996613560173, -5.0255382366430705, 0.15137315764776121, 2.0000000000000013, -1.0421607990630366, 0.8830304392723726, -21.567374874632872, -22.646229394313757, -13.802838982268604, -103.97037289035937, -51.821213980912795, 0.10028252860033147, -8.626695048461375, -7.9256076015194665, -9.185136164865824, 10.198286207864376, -0.8785365833593228, 71.34064084919048, -120.23182493582685, -11.979979683099137, -11.405727145316217, -36.34796918348113, -181.83783495124317, 15.324617581185311, 1.002835640978779, -19.896290245732747, -82.03698325602696, -13.8786777943962, -9.373870726107283, 0.2078656329287431, -0.7843374222812827, -57.59066614028852, -107.8032065640527, -1.7609181206231055, -32.92091654818192, -5.233330221948793, -118.45557412330315, -14.161087163976426, 1.0771808593246521, -5.911926948212226, -1.4625992214398869, 98.78795738682518, -89.72942417409345, 2.0000000000000013, -9.770080565651007, -0.8484572662427676, -50.276890924861654, -1.6366605392052171, -5.864752404251833, -63.535200702579395, -15.828629196289686, 2.0000000000000013, -4.375290298711539, -81.49630209281521, -11.716501302683302, 2.0000000000000013, -3.198764684605819, -66.29092835888636, 2.0000000000000013, -66.34298148144273, -18.589536896592733, 2.0000000000000013, -5.697745707833274, 2.0000000000000013, -3.6190447254378935, -65.92999323984134, -14.022113350399525, -14.889552015848604, -13.328660826363294, -109.24146612307027, 1.197621796465004, 2.0000000000000013, -89.01277597311426, -1.7883340530418717, -86.96221696473616, -0.5928345036324825, -2.456080859800041], "policy_predator_policy_reward": [649.5243209468656, 570.1733220008068, 493.58585150671246, 634.7736624401515, 9.753807339444442, 1.8400513923663095, 348.0771530728611, 346.7543027322583, 322.5940075088118, 271.05706871737067, 366.0339414496696, 360.32056049298933, 451.76733670130943, 377.59319415266657, 6.327036815844424, 36.02204595117718, 363.8255632324944, 371.4965836577206, 368.0236842776476, 415.3101862372065, 11.201198570663355, 3.6859333260136857, 285.32305433237127, 200.02036217815362, 412.46935887725675, 495.9598963478033, 280.9035387311367, 283.3788326206699, 23.57202119879584, 0.0, 446.98190725756945, 596.0034616962988, 530.4203377898083, 384.49490870141904, 379.0898363606726, 359.81702984832026, 590.783417464669, 520.1269550603436, 20.773856955915022, 22.713605216352068, 311.20369235133006, 305.32452489744014, 488.0690485852572, 439.58832749175616, 247.98037919361644, 223.58305610543712, 463.0449701646576, 439.75791762638335, 12.25170479675225, 5.544949812008528, 308.7948192506445, 290.98890732499444, 8.756515562930144, 3.9228370335006266, 238.00599375819945, 266.7649892535858, 21.570570915407185, 3.868963745246548, 2.069721703070838, 0.0, 470.89508036391663, 434.47163803188874, 253.62187216568458, 268.6168528899818, 469.2045590874653, 530.1099454438283, 1.1597188885759884, 0.7267020055430282, 51.8487162064662, 55.66646414129201, 16.984037223895385, 19.60041125815351, 296.18740792510243, 432.9383684136169, 362.9332812170124, 276.92461871144434, 386.79302255622804, 309.9043080542097, 478.78807234428064, 587.5856721511137, 379.0495566941933, 480.9749441659635, 6.858084414949888, 34.04609077827517, 1.218759173108189, 20.960623083310825, 45.305898051077506, 14.826830346710185, 218.86439811002725, 170.53334470817276, 93.54347366415523, 92.63489246064482, 371.74000585168494, 425.91547543734566, 0.0, 5.35743353280238, 5.999827774563575, 3.007278869368571, 68.91383005739162, 69.75452474071517, 42.7910888014738, 74.94219712398085, 50.386561640810804, 13.72933141720363, 5.683232628271293, 11.289762129530915, 65.6535959894776, 44.75858857094723, 5.933973763566993, 82.97410622023983, 170.75269251685006, 168.6354974467355, 354.1140007518913, 250.86751468881084, 39.63016874757086, 13.623391163368009, 11.359572880510113, 30.000619234805995, 93.03240666623667, 98.09630349491138, 17.306375760247892, 28.881597834912917, 14.953658109243074, 58.363542284093974, 6.975538236643029, 1.8286268423522403, 3.012160799063017, 0.0, 12.863615292331591, 20.12014023242336, 21.965218230717415, 20.333036564863882, 101.26091942463167, 81.4819000675402, 1.87971747139967, 10.566695048461334, 84.20962974444063, 91.54407635892181, 49.11151618691199, 22.977283220331728, 84.37409829274148, 124.72071934018476, 26.769979683099148, 13.305727145316176, 197.35684470491765, 220.07747320858044, 35.05538241881466, 0.9871643590212223, 39.10996155568966, 80.01735552876139, 28.034449029259445, 7.178757559853787, 1.7721343670712582, 2.7543374222812678, 84.68703868215015, 100.89056487743655, 21.68786153987458, 24.130206138909948, 117.623620435319, 93.02017652591039, 16.101087163976402, 0.9128191406753493, 7.8719269482121845, 3.432599221439857, 118.33709384174094, 125.45148426125091, 0.0, 11.690080565650966, 18.573772371278626, 85.45200298459586, 3.6066605392051834, 7.8147524042517915, 51.919253226663535, 73.60628357803586, 0.0, 6.305290298711498, 103.73398438085101, 123.42861952125392, 0.0, 5.148764684605777, 64.8194502283247, 45.17647394201876, 103.30344412580544, 90.36099273145253, 0.0, 20.407745707833236, 3.3712629162666228, 5.579044725437852, 67.72999323984226, 15.962113350399484, 16.819552015848707, 15.278660826363252, 104.36449747056469, 61.216586112038755, 47.763907329290454, 92.36501286291238, 71.92004236941115, 37.04372103165427, 2.5728345036324716, 4.426080859799999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8022799600921483, "mean_inference_ms": 2.617972961881429, "mean_action_processing_ms": 0.34954930751926283, "mean_env_wait_ms": 0.28645442010751365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004363536834716797, "StateBufferConnector_ms": 0.003957509994506836, "ViewRequirementAgentConnector_ms": 0.15067386627197266}, "num_episodes": 18, "episode_return_max": 423.20384090356424, "episode_return_min": -2.587939711596504, "episode_return_mean": 99.64218883740176, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.449462890337, "num_env_steps_trained_throughput_per_sec": 373.449462890337, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 196772.193, "restore_workers_time_ms": 0.013, "training_step_time_ms": 196772.157, "sample_time_ms": 1522.729, "learn_time_ms": 195234.066, "learn_throughput": 20.488, "synch_weights_time_ms": 14.347}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "6c58f_00000", "date": "2024-08-16_17-03-46", "timestamp": 1723808026, "time_this_iter_s": 10.717328071594238, "time_total_s": 3407.0679450035095, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b348fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3407.0679450035095, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 24.72666666666667, "ram_util_percent": 66.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.154636370331522, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 1e-05, "total_loss": 2.9200984175243074, "policy_loss": -0.004723012660600482, "vf_loss": 2.9243674027856694, "vf_explained_var": 0.0014561795683764908, "kl": 0.012755054471634983, "entropy": 1.3554391110384907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.473216917795479, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 1e-05, "total_loss": 2.2351188066144467, "policy_loss": -0.005125661407198225, "vf_loss": 2.240244313018032, "vf_explained_var": -0.044852669339962105, "kl": 0.005371155023340978, "entropy": 1.2050413292551798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 319.06788706368684, "episode_reward_min": -2.587939711596504, "episode_reward_mean": 71.30248116480328, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -578.9487176053887, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.66002859176285, "predator_policy": 587.5856721511137}, "policy_reward_mean": {"prey_policy": -55.4434061333673, "predator_policy": 91.09464671576904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.7910527948464, 7.819999999999922, 242.86668568387034, 3.8799999999999613, 206.74927932147824, 3.0385544938267106, 3.979999999999959, 319.06788706368684, 222.63993342421216, 230.72803922301455, 3.979999999999959, 56.91518958348479, 11.97381545801474, 256.8635609036706, 225.90561139641423, 208.26572127499054, 69.21830788185105, 202.87591550652135, 9.610943916286793, 3.879999999999961, -2.587939711596504, 138.39013414877576, 175.50563924249252, 224.76673452163232, 3.9699999999999593, 3.9099999999999606, 37.78075512201832, 44.22538476755204, 43.10928563107637, 7.437114907206898, 35.63182472023511, 13.419999999999943, 197.8202920243662, 215.4371026715465, 25.688888772987845, 8.157298793407847, 77.36228392360397, 3.7099999999999644, 10.770518042651773, 3.92999999999996, 3.9699999999999593, 12.29941108939407, 5.849186418998591, 26.951232620899752, 3.9199999999999604, 158.64296233697695, 81.40854903174993, 160.2036335462867, 16.690000000000044, 199.24851377877346, 52.369999999999436, 17.194043582690334, 11.960658068609757, 3.94999999999996, 20.183730855245457, 11.136233009979822, 86.95489261597815, 3.929999999999961, 3.9299999999999606, 252.8471113157231, 3.9199999999999604, 52.90042716476984, 3.9199999999999604, 46.16170690582903, 3.92999999999996, 133.9498005066049, 3.9499999999999598, 45.704995811455575, 108.73191847922273, 16.71000000000005, 7.331262916266539, 3.739999999999963, 3.8799999999999604, 57.537239255996795, 53.116144219087374, 20.213212383287047, 3.9499999999999598, 223.4848885346082, 202.90370957770466, 73.34082526891689, 4.489999999999947, 3.92999999999996, 64.16791160022626, 3.9199999999999604, 130.59261612487606, 3.93999999999996, 164.54616975765208, 3.90999999999996, 37.51624743747724, 159.6751450613754, 21.6878035991976, 61.50271170708435, 21.477189707724694, 205.5200532801038, 21.962449244576394, 3.859999999999961, 27.49670007076682, 6.376501270723171, 118.24451281936511, 3.92999999999996], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-578.9487176053887, -24.063117390806358, -6.38170479675229, -3.5949498120085694, -5.024475875476829, -351.89256501629075, 0.24177128406293508, -9.041123880493744, -290.6459436279165, -7.375760062390011, -19.640570915406883, -2.7604092514198575, 2.0000000000000013, -0.08972170307083754, -548.2667719508096, -38.032059381308805, -291.1560131454062, -8.442778486048136, -274.4488891994714, -494.13757610880833, 0.8302811114240131, 1.263297994456973, -30.99576112866159, -19.604229635611034, -0.4687292522241049, -24.141903771809698, -22.00674274431441, -450.2554726907337, -411.12260130297193, -2.829687229070016, -308.28428967953164, -180.14731965591542, -567.6132864233427, -429.54215019020046, -437.08696011610704, -220.0616252375286, -1.8130357005868085, -29.48019557635121, 0.7712408268918124, -19.07062308331053, -43.3427472738357, -19.377920835548483, -251.69792327805152, 0.6903146086278235, -1.9621767825484122, -8.710550099759054, -377.80939576788455, -195.07935099951473, 2.0000000000000013, -3.3874335328024223, -4.059827774563616, -1.0372788693685913, -97.66543306957718, -3.222166606509818, -67.36214303365986, -6.145758124241713, -10.116561640810838, -10.890045786126796, -0.20611772106431347, -9.329762129530957, -73.37979123123897, -1.4005686089494662, -3.9739737635670345, -71.51410622023911, -12.541032150523401, -129.02686578869563, -238.7954620206422, -150.74895074851335, -0.8032131768533555, -26.761457961097953, -28.1106192348057, -5.092274087102227, 2.0000000000000013, -115.76642623754472, -15.386375760247702, -27.091597834912637, -4.746716215083867, -57.79996613560173, -5.0255382366430705, 0.15137315764776121, 2.0000000000000013, -1.0421607990630366, 0.8830304392723726, -21.567374874632872, -22.646229394313757, -13.802838982268604, -103.97037289035937, -51.821213980912795, 0.10028252860033147, -8.626695048461375, -7.9256076015194665, -9.185136164865824, 10.198286207864376, -0.8785365833593228, 71.34064084919048, -120.23182493582685, -11.979979683099137, -11.405727145316217, -36.34796918348113, -181.83783495124317, 15.324617581185311, 1.002835640978779, -19.896290245732747, -82.03698325602696, -13.8786777943962, -9.373870726107283, 0.2078656329287431, -0.7843374222812827, -57.59066614028852, -107.8032065640527, -1.7609181206231055, -32.92091654818192, -5.233330221948793, -118.45557412330315, -14.161087163976426, 1.0771808593246521, -5.911926948212226, -1.4625992214398869, 98.78795738682518, -89.72942417409345, 2.0000000000000013, -9.770080565651007, -0.8484572662427676, -50.276890924861654, -1.6366605392052171, -5.864752404251833, -63.535200702579395, -15.828629196289686, 2.0000000000000013, -4.375290298711539, -81.49630209281521, -11.716501302683302, 2.0000000000000013, -3.198764684605819, -66.29092835888636, 2.0000000000000013, -66.34298148144273, -18.589536896592733, 2.0000000000000013, -5.697745707833274, 2.0000000000000013, -3.6190447254378935, -65.92999323984134, -14.022113350399525, -14.889552015848604, -13.328660826363294, -109.24146612307027, 1.197621796465004, 2.0000000000000013, -89.01277597311426, -1.7883340530418717, -86.96221696473616, -0.5928345036324825, -2.456080859800041, 4.373545468587913, -230.00037644192196, -30.719541278693764, -125.43956279683127, 20.811812061855232, -1.2324272548785313, -9.473968081722113, -71.63383099480286, -1.2884585978205028, -5.9370975551862, -68.63867250781601, -1.3828658236130438, 2.0000000000000013, -10.027196534817989, 8.871031576729912, -14.89702753383976, -6.558244393124175, 2.0000000000000013, -6.947075735004217, -52.20366369505213, -0.24821880179512412, -11.554670762967174, -0.23967416415500398, 4.424068594333246, -0.5723567063230739, -86.36610490307912, -85.62858231146924, -131.59910515523597, 12.1456005211794, -73.5730396538656, -29.26528119110071, -4.2401436806004265, -67.57626508126728, 152.66002859176285, -67.25552408715795, -5.197608775414639, -8.757817581694383, -25.064185900725075, 3.9422572120620982, -49.78617112556158, -69.25377941618969, 1.2132517196757138, 2.0000000000000013, -11.205839732367512, -1.191018982665409, -4.819626774100352], "policy_predator_policy_reward": [463.0449701646576, 439.75791762638335, 12.25170479675225, 5.544949812008528, 308.7948192506445, 290.98890732499444, 8.756515562930144, 3.9228370335006266, 238.00599375819945, 266.7649892535858, 21.570570915407185, 3.868963745246548, 2.069721703070838, 0.0, 470.89508036391663, 434.47163803188874, 253.62187216568458, 268.6168528899818, 469.2045590874653, 530.1099454438283, 1.1597188885759884, 0.7267020055430282, 51.8487162064662, 55.66646414129201, 16.984037223895385, 19.60041125815351, 296.18740792510243, 432.9383684136169, 362.9332812170124, 276.92461871144434, 386.79302255622804, 309.9043080542097, 478.78807234428064, 587.5856721511137, 379.0495566941933, 480.9749441659635, 6.858084414949888, 34.04609077827517, 1.218759173108189, 20.960623083310825, 45.305898051077506, 14.826830346710185, 218.86439811002725, 170.53334470817276, 93.54347366415523, 92.63489246064482, 371.74000585168494, 425.91547543734566, 0.0, 5.35743353280238, 5.999827774563575, 3.007278869368571, 68.91383005739162, 69.75452474071517, 42.7910888014738, 74.94219712398085, 50.386561640810804, 13.72933141720363, 5.683232628271293, 11.289762129530915, 65.6535959894776, 44.75858857094723, 5.933973763566993, 82.97410622023983, 170.75269251685006, 168.6354974467355, 354.1140007518913, 250.86751468881084, 39.63016874757086, 13.623391163368009, 11.359572880510113, 30.000619234805995, 93.03240666623667, 98.09630349491138, 17.306375760247892, 28.881597834912917, 14.953658109243074, 58.363542284093974, 6.975538236643029, 1.8286268423522403, 3.012160799063017, 0.0, 12.863615292331591, 20.12014023242336, 21.965218230717415, 20.333036564863882, 101.26091942463167, 81.4819000675402, 1.87971747139967, 10.566695048461334, 84.20962974444063, 91.54407635892181, 49.11151618691199, 22.977283220331728, 84.37409829274148, 124.72071934018476, 26.769979683099148, 13.305727145316176, 197.35684470491765, 220.07747320858044, 35.05538241881466, 0.9871643590212223, 39.10996155568966, 80.01735552876139, 28.034449029259445, 7.178757559853787, 1.7721343670712582, 2.7543374222812678, 84.68703868215015, 100.89056487743655, 21.68786153987458, 24.130206138909948, 117.623620435319, 93.02017652591039, 16.101087163976402, 0.9128191406753493, 7.8719269482121845, 3.432599221439857, 118.33709384174094, 125.45148426125091, 0.0, 11.690080565650966, 18.573772371278626, 85.45200298459586, 3.6066605392051834, 7.8147524042517915, 51.919253226663535, 73.60628357803586, 0.0, 6.305290298711498, 103.73398438085101, 123.42861952125392, 0.0, 5.148764684605777, 64.8194502283247, 45.17647394201876, 103.30344412580544, 90.36099273145253, 0.0, 20.407745707833236, 3.3712629162666228, 5.579044725437852, 67.72999323984226, 15.962113350399484, 16.819552015848707, 15.278660826363252, 104.36449747056469, 61.216586112038755, 47.763907329290454, 92.36501286291238, 71.92004236941115, 37.04372103165427, 2.5728345036324716, 4.426080859799999, 227.26144235015687, 221.85027715778563, 152.5426965861398, 206.52011706709044, 39.191530920006095, 14.569909541933203, 14.07617723736541, 71.52162183916036, 3.2584585978204768, 7.897097555186158, 123.55867250781648, 10.630777423839572, 0.0, 11.947196534817948, 84.42636063786802, 52.192251444118384, 8.498244393124134, 0.0, 114.33893238750935, 109.35797680019928, 2.228218801795121, 13.484670762967133, 25.302116939669382, 8.029736067630168, 122.01145992382182, 124.60214674695635, 135.2220945013801, 103.69339656452173, 43.881882049796985, 79.04826878997474, 21.145454180465993, 33.83716039895954, 68.96408223187512, 51.472207537734306, 66.0760967132147, 28.33948539393457, 10.697817581694341, 26.984185900725375, 19.751290919741745, 53.58932306452366, 70.55788938635695, 3.859139580881161, 51.36895362199493, 76.08139892973668, 3.161018982665385, 6.7796267741003104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7986476259583865, "mean_inference_ms": 2.6078046373077024, "mean_action_processing_ms": 0.34794684735583686, "mean_env_wait_ms": 0.2853982962562951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003905653953552246, "StateBufferConnector_ms": 0.00485837459564209, "ViewRequirementAgentConnector_ms": 0.09531617164611816}, "num_episodes": 23, "episode_return_max": 319.06788706368684, "episode_return_min": -2.587939711596504, "episode_return_mean": 71.30248116480328, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.0718816677175, "num_env_steps_trained_throughput_per_sec": 372.0718816677175, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 196671.096, "restore_workers_time_ms": 0.013, "training_step_time_ms": 196671.06, "sample_time_ms": 1522.265, "learn_time_ms": 195132.978, "learn_throughput": 20.499, "synch_weights_time_ms": 14.749}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "6c58f_00000", "date": "2024-08-16_17-03-56", "timestamp": 1723808036, "time_this_iter_s": 10.757185935974121, "time_total_s": 3417.8251309394836, "pid": 82974, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b05215e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3417.8251309394836, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 28.04, "ram_util_percent": 66.64}}
