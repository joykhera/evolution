{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4542249810601038, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.477872510814162, "policy_loss": -0.003344914842416685, "vf_loss": 4.480285462878999, "vf_explained_var": 0.0012598976887092388, "kl": 0.004659860378739034, "entropy": 1.6048260432702524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.04557443396755, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.243896730362423, "policy_loss": -0.009852312604783389, "vf_loss": 6.252150109962181, "vf_explained_var": 0.02949543005574948, "kl": 0.007994631033481527, "entropy": 1.6015579281660615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 246.88963183149647, "episode_reward_min": 4.9899999999999665, "episode_reward_mean": 109.94413663398255, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.3148733669042303}, "policy_reward_max": {"prey_policy": 187.43635046351665, "predator_policy": 90.65194900856021}, "policy_reward_mean": {"prey_policy": 23.637879760440537, "predator_policy": 31.334188556550785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.90518288788662, 25.84012296817896, 195.30529553610083, 215.9824276809799, 13.43352020974396, 105.97000000000092, 138.85270834002372, 52.624784596054376, 15.014134684617385, 246.88963183149647, 4.9899999999999665, 91.1200000000005, 59.439999999999685, 73.80204756868531, 218.987660108758, 111.96965343558202, 205.9599999999993, 96.90728956357789], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.24642806984643, 76.25700110531551, 2.0000000000000013, -65.11604635495874, 62.442823919959835, 65.43945281088784, 167.72696967423198, 35.908238992051274, -62.458326105884225, 2.9899999999999944, -7.653356935950468, 59.92569256559731, 66.69582279016578, 30.74083101099196, 7.276889594266655, -48.50336958308198, 2.0000000000000013, -7.780178195406204, 179.7773227590011, 1.0335152747218395, -35.819827664545414, -42.78042267541577, 15.175199935532744, 13.335124749062027, -63.74102030330165, 45.145141691842966, -46.45587282874396, 65.36000000000018, -4.039750577157115, 187.43635046351665, 26.51704215222133, 47.35908666977699, 173.88821593677844, 30.710000000000203, -96.34390881856262, 34.761457392791236], "policy_predator_policy_reward": [7.242660843856948, 90.65194900856021, 8.728714289554587, 80.22745503358335, 42.067257269297286, 25.35576153595694, 12.032345647792901, 0.3148733669042303, 12.091366486715987, 60.81047982891206, 42.06430743440262, 11.63335693595044, 9.994748683849998, 31.42130585501532, 49.27651157303569, 44.57475301183391, 14.966930686434113, 5.827382193589516, 16.631398541343145, 49.447395256431115, 44.78042267541567, 38.80982766454516, 48.20480006446728, 14.404875250937947, 65.74102030330225, 12.294858308156888, 47.51294975311792, 7.384970644311164, 32.00565451958373, 3.5854057028151805, 32.983978360619844, 5.109546252963871, 0.6553326632683046, 0.7064513999533362, 75.4592161048304, 83.03052488451893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8316392082968697, "mean_inference_ms": 2.3284759862808837, "mean_action_processing_ms": 0.36190673661782047, "mean_env_wait_ms": 0.3514517462991759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059074825710720485, "StateBufferConnector_ms": 0.0037226412031385633, "ViewRequirementAgentConnector_ms": 0.09596480263604058}, "num_episodes": 18, "episode_return_max": 246.88963183149647, "episode_return_min": 4.9899999999999665, "episode_return_mean": 109.94413663398255, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.1839091111685, "num_env_steps_trained_throughput_per_sec": 370.1839091111685, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 10805.449, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10805.394, "sample_time_ms": 1837.655, "learn_time_ms": 8949.863, "learn_throughput": 446.934, "synch_weights_time_ms": 11.948}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "e552a_00000", "date": "2024-08-16_08-46-37", "timestamp": 1723778197, "time_this_iter_s": 10.848083972930908, "time_total_s": 10.848083972930908, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7134160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.848083972930908, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 83.85625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5222553585414533, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.966267421384337, "policy_loss": -0.005719381658343115, "vf_loss": 2.9707886326880684, "vf_explained_var": 0.05849666030949386, "kl": 0.011981668613519273, "entropy": 1.593821912909311, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5033312997174642, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.396773564374005, "policy_loss": -0.005505720090993222, "vf_loss": 9.400604028045816, "vf_explained_var": 0.05299816339735001, "kl": 0.008376223926242812, "entropy": 1.5808315033004396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 376.20774058298355, "episode_reward_min": 4.9899999999999665, "episode_reward_mean": 175.3545560046434, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.5200614147637, "predator_policy": 190.60185583592565}, "policy_reward_mean": {"prey_policy": 60.71494695851595, "predator_policy": 26.962331043805783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.90518288788662, 25.84012296817896, 195.30529553610083, 215.9824276809799, 13.43352020974396, 105.97000000000092, 138.85270834002372, 52.624784596054376, 15.014134684617385, 246.88963183149647, 4.9899999999999665, 91.1200000000005, 59.439999999999685, 73.80204756868531, 218.987660108758, 111.96965343558202, 205.9599999999993, 96.90728956357789, 206.56934720253412, 313.23194878509366, 102.01000000000043, 310.9, 129.18834900188216, 234.67, 168.27081029289832, 283.3590007779039, 229.54445460685852, 376.20774058298355, 68.34999999999998, 295.7626382328897, 299.53172489560535, 284.5883916372204, 120.4185986907406, 258.7531661510218, 350.0206398600293, 302.39274603781536], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.24642806984643, 76.25700110531551, 2.0000000000000013, -65.11604635495874, 62.442823919959835, 65.43945281088784, 167.72696967423198, 35.908238992051274, -62.458326105884225, 2.9899999999999944, -7.653356935950468, 59.92569256559731, 66.69582279016578, 30.74083101099196, 7.276889594266655, -48.50336958308198, 2.0000000000000013, -7.780178195406204, 179.7773227590011, 1.0335152747218395, -35.819827664545414, -42.78042267541577, 15.175199935532744, 13.335124749062027, -63.74102030330165, 45.145141691842966, -46.45587282874396, 65.36000000000018, -4.039750577157115, 187.43635046351665, 26.51704215222133, 47.35908666977699, 173.88821593677844, 30.710000000000203, -96.34390881856262, 34.761457392791236, 183.98656680648463, 0.7601871969938181, 101.96552165364007, 186.6796084814978, 3.7609406984130342, 77.80901961626418, 174.82863485935695, 93.93318996307849, 17.84000000000002, 96.21132559246719, 142.58, 69.44034787424516, 72.8796358897812, 42.1029147331377, 113.74172528618702, 145.55, 100.52260624205115, 111.34939404792796, 172.81099847148067, 144.88536723863396, -19.29951655645033, 66.35, 147.53, 128.41739421223426, -80.69818663832478, 106.74236404403226, 154.66645805036137, 100.40394680226048, -44.887033245093924, 96.62680513140822, 53.81996949209953, 186.38014631660914, 199.5200614147637, 143.11497469010635, 90.95029437335386, 137.2368468982886], "policy_predator_policy_reward": [7.242660843856948, 90.65194900856021, 8.728714289554587, 80.22745503358335, 42.067257269297286, 25.35576153595694, 12.032345647792901, 0.3148733669042303, 12.091366486715987, 60.81047982891206, 42.06430743440262, 11.63335693595044, 9.994748683849998, 31.42130585501532, 49.27651157303569, 44.57475301183391, 14.966930686434113, 5.827382193589516, 16.631398541343145, 49.447395256431115, 44.78042267541567, 38.80982766454516, 48.20480006446728, 14.404875250937947, 65.74102030330225, 12.294858308156888, 47.51294975311792, 7.384970644311164, 32.00565451958373, 3.5854057028151805, 32.983978360619844, 5.109546252963871, 0.6553326632683046, 0.7064513999533362, 75.4592161048304, 83.03052488451893, 19.461595791816297, 2.3609974072393656, 3.189921750922669, 21.396896899033187, 8.74473936951574, 11.695300315806927, 9.908969978926848, 32.229205198637665, 11.947873113784139, 3.1891502956307263, 22.649652125754866, 0.0, 41.61831665800379, 11.669943011975564, 17.168753407832813, 6.898522083884069, 6.34713002953549, 11.325324287343978, 56.56816330486666, 1.9432115680023239, 21.2995165564503, 0.0, 10.987912991340698, 8.827331029314818, 82.88569165397276, 190.60185583592565, 15.06313689117944, 14.454849893419924, 3.4621312220708225, 65.21669558235564, 15.321205759201607, 3.231844583111389, 2.8761549039116714, 4.509448851247581, 63.988281865885625, 10.21732290028732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7780012712033374, "mean_inference_ms": 2.1004060596886736, "mean_action_processing_ms": 0.3268657710712063, "mean_env_wait_ms": 0.31556312534448516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006258487701416016, "StateBufferConnector_ms": 0.00349018308851454, "ViewRequirementAgentConnector_ms": 0.09107357925838894}, "num_episodes": 18, "episode_return_max": 376.20774058298355, "episode_return_min": 4.9899999999999665, "episode_return_mean": 175.3545560046434, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 420.2346345377124, "num_env_steps_trained_throughput_per_sec": 420.2346345377124, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 10161.974, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10161.913, "sample_time_ms": 1507.271, "learn_time_ms": 8638.836, "learn_throughput": 463.025, "synch_weights_time_ms": 12.061}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "e552a_00000", "date": "2024-08-16_08-46-49", "timestamp": 1723778209, "time_this_iter_s": 9.562577962875366, "time_total_s": 20.410661935806274, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72a5b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.410661935806274, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.317647058823532, "ram_util_percent": 83.76470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9203211762917736, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.363530291072906, "policy_loss": -0.007035349545385639, "vf_loss": 4.369281942503793, "vf_explained_var": 0.0789961055473045, "kl": 0.012837030031991232, "entropy": 1.5710991043262381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6999544448795774, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.433924797603062, "policy_loss": -0.006994520542803147, "vf_loss": 9.439212769806069, "vf_explained_var": 0.010954766204117467, "kl": 0.008532607545116862, "entropy": 1.5690154559397824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 386.9835090013204, "episode_reward_min": 4.9899999999999665, "episode_reward_mean": 221.54797049579972, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.60185583592565}, "policy_reward_mean": {"prey_policy": 85.40221106028358, "predator_policy": 25.371774187616264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.90518288788662, 25.84012296817896, 195.30529553610083, 215.9824276809799, 13.43352020974396, 105.97000000000092, 138.85270834002372, 52.624784596054376, 15.014134684617385, 246.88963183149647, 4.9899999999999665, 91.1200000000005, 59.439999999999685, 73.80204756868531, 218.987660108758, 111.96965343558202, 205.9599999999993, 96.90728956357789, 206.56934720253412, 313.23194878509366, 102.01000000000043, 310.9, 129.18834900188216, 234.67, 168.27081029289832, 283.3590007779039, 229.54445460685852, 376.20774058298355, 68.34999999999998, 295.7626382328897, 299.53172489560535, 284.5883916372204, 120.4185986907406, 258.7531661510218, 350.0206398600293, 302.39274603781536, 362.1223943222974, 381.7816978034795, 333.6700000000001, 261.4, 247.5400000000005, 349.09752084914624, 299.2646144018634, 383.4455581687258, 367.0306508627467, 377.83660438233153, 309.4241926123805, 290.17860621355896, 252.6631289577776, 282.19, 224.423809466847, 216.69984549041317, 386.9835090013204, 325.0742580731317], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.24642806984643, 76.25700110531551, 2.0000000000000013, -65.11604635495874, 62.442823919959835, 65.43945281088784, 167.72696967423198, 35.908238992051274, -62.458326105884225, 2.9899999999999944, -7.653356935950468, 59.92569256559731, 66.69582279016578, 30.74083101099196, 7.276889594266655, -48.50336958308198, 2.0000000000000013, -7.780178195406204, 179.7773227590011, 1.0335152747218395, -35.819827664545414, -42.78042267541577, 15.175199935532744, 13.335124749062027, -63.74102030330165, 45.145141691842966, -46.45587282874396, 65.36000000000018, -4.039750577157115, 187.43635046351665, 26.51704215222133, 47.35908666977699, 173.88821593677844, 30.710000000000203, -96.34390881856262, 34.761457392791236, 183.98656680648463, 0.7601871969938181, 101.96552165364007, 186.6796084814978, 3.7609406984130342, 77.80901961626418, 174.82863485935695, 93.93318996307849, 17.84000000000002, 96.21132559246719, 142.58, 69.44034787424516, 72.8796358897812, 42.1029147331377, 113.74172528618702, 145.55, 100.52260624205115, 111.34939404792796, 172.81099847148067, 144.88536723863396, -19.29951655645033, 66.35, 147.53, 128.41739421223426, -80.69818663832478, 106.74236404403226, 154.66645805036137, 100.40394680226048, -44.887033245093924, 96.62680513140822, 53.81996949209953, 186.38014631660914, 199.5200614147637, 143.11497469010635, 90.95029437335386, 137.2368468982886, 196.55814684484164, 129.68525192172095, 183.26021778652583, 158.27100872465047, 171.39376650196397, 154.9166236382233, 56.025373832630045, 153.64937716560542, 104.23636777126855, 128.6694365238675, 182.66107536724775, 133.43209470354284, 111.8083008256726, 170.57491983666804, 200.0, 179.7367040492707, 177.07063331106963, 134.18790409901624, 150.59901249435498, 99.16972433380349, 130.70000000000002, 158.13335101448183, 189.28311964720154, 44.25905024513057, 47.75111090576659, 153.83083384467076, 121.96763246784234, 101.89564484844635, 119.40460349848048, 7.461286794642522, 58.08599618933886, 101.1805125566353, 173.86182234772835, 158.99417251085646, 152.41209872066304, 156.8354381736502], "policy_predator_policy_reward": [7.242660843856948, 90.65194900856021, 8.728714289554587, 80.22745503358335, 42.067257269297286, 25.35576153595694, 12.032345647792901, 0.3148733669042303, 12.091366486715987, 60.81047982891206, 42.06430743440262, 11.63335693595044, 9.994748683849998, 31.42130585501532, 49.27651157303569, 44.57475301183391, 14.966930686434113, 5.827382193589516, 16.631398541343145, 49.447395256431115, 44.78042267541567, 38.80982766454516, 48.20480006446728, 14.404875250937947, 65.74102030330225, 12.294858308156888, 47.51294975311792, 7.384970644311164, 32.00565451958373, 3.5854057028151805, 32.983978360619844, 5.109546252963871, 0.6553326632683046, 0.7064513999533362, 75.4592161048304, 83.03052488451893, 19.461595791816297, 2.3609974072393656, 3.189921750922669, 21.396896899033187, 8.74473936951574, 11.695300315806927, 9.908969978926848, 32.229205198637665, 11.947873113784139, 3.1891502956307263, 22.649652125754866, 0.0, 41.61831665800379, 11.669943011975564, 17.168753407832813, 6.898522083884069, 6.34713002953549, 11.325324287343978, 56.56816330486666, 1.9432115680023239, 21.2995165564503, 0.0, 10.987912991340698, 8.827331029314818, 82.88569165397276, 190.60185583592565, 15.06313689117944, 14.454849893419924, 3.4621312220708225, 65.21669558235564, 15.321205759201607, 3.231844583111389, 2.8761549039116714, 4.509448851247581, 63.988281865885625, 10.21732290028732, 9.462857862350761, 26.416137693384186, 13.186899202580888, 27.06357208972237, 3.186375639956463, 4.173234219856149, 4.770622834394595, 46.95462616736993, 9.950563476132409, 4.683632228731328, 7.555979301718974, 25.44837147663663, 7.3286737594734745, 9.552719980049304, 0.9567738012380193, 2.7520803182170592, 32.91731229929185, 22.85480115336901, 56.612338137435245, 71.4555294167371, 13.337639192948345, 7.2532024049503185, 10.261029181625993, 46.37540713960066, 34.76442984878786, 16.31675435855217, 15.497600850560016, 42.82912183315127, 34.06539650151954, 63.49252267220475, 14.822262084205681, 42.61107466023398, 30.010860392143258, 24.11665375059237, 9.174687298180222, 6.6520338806383235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7387767843146672, "mean_inference_ms": 1.9707196840253205, "mean_action_processing_ms": 0.30615539852739493, "mean_env_wait_ms": 0.29352794089786527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006233762811731409, "StateBufferConnector_ms": 0.003311369154188368, "ViewRequirementAgentConnector_ms": 0.0883762483243589}, "num_episodes": 18, "episode_return_max": 386.9835090013204, "episode_return_min": 4.9899999999999665, "episode_return_mean": 221.54797049579972, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 410.0161223194536, "num_env_steps_trained_throughput_per_sec": 410.0161223194536, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 10026.556, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10026.501, "sample_time_ms": 1394.583, "learn_time_ms": 8616.408, "learn_throughput": 464.231, "synch_weights_time_ms": 12.359}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "e552a_00000", "date": "2024-08-16_08-46-59", "timestamp": 1723778219, "time_this_iter_s": 9.787147045135498, "time_total_s": 30.197808980941772, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72a5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.197808980941772, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.321428571428566, "ram_util_percent": 83.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9417839289026917, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.474123968396868, "policy_loss": -0.006848193795996762, "vf_loss": 7.479639596535415, "vf_explained_var": 0.10580908261909687, "kl": 0.013325600923502073, "entropy": 1.5326078337336344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.954953632168669, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.275542277381534, "policy_loss": -0.004856558737256342, "vf_loss": 9.277808532008418, "vf_explained_var": -0.038607326449540555, "kl": 0.012951569544759442, "entropy": 1.5801979676125542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 408.08765107356277, "episode_reward_min": 4.9899999999999665, "episode_reward_mean": 248.82845070286547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.60185583592565}, "policy_reward_mean": {"prey_policy": 92.56059316493881, "predator_policy": 31.85363218649394}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.90518288788662, 25.84012296817896, 195.30529553610083, 215.9824276809799, 13.43352020974396, 105.97000000000092, 138.85270834002372, 52.624784596054376, 15.014134684617385, 246.88963183149647, 4.9899999999999665, 91.1200000000005, 59.439999999999685, 73.80204756868531, 218.987660108758, 111.96965343558202, 205.9599999999993, 96.90728956357789, 206.56934720253412, 313.23194878509366, 102.01000000000043, 310.9, 129.18834900188216, 234.67, 168.27081029289832, 283.3590007779039, 229.54445460685852, 376.20774058298355, 68.34999999999998, 295.7626382328897, 299.53172489560535, 284.5883916372204, 120.4185986907406, 258.7531661510218, 350.0206398600293, 302.39274603781536, 362.1223943222974, 381.7816978034795, 333.6700000000001, 261.4, 247.5400000000005, 349.09752084914624, 299.2646144018634, 383.4455581687258, 367.0306508627467, 377.83660438233153, 309.4241926123805, 290.17860621355896, 252.6631289577776, 282.19, 224.423809466847, 216.69984549041317, 386.9835090013204, 325.0742580731317, 336.0882752054551, 408.08765107356277, 359.7942720683381, 402.5830352537265, 290.41751460924115, 388.4143124381387, 257.739723648825, 330.761650405416, 349.69137322287565, 360.8305662116386, 302.6623377451231, 349.1815927043252, 305.73462415334484, 383.09867936228886, 262.38385665656375, 336.81223286448414, 196.99570866201012, 330.78063754777327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.24642806984643, 76.25700110531551, 2.0000000000000013, -65.11604635495874, 62.442823919959835, 65.43945281088784, 167.72696967423198, 35.908238992051274, -62.458326105884225, 2.9899999999999944, -7.653356935950468, 59.92569256559731, 66.69582279016578, 30.74083101099196, 7.276889594266655, -48.50336958308198, 2.0000000000000013, -7.780178195406204, 179.7773227590011, 1.0335152747218395, -35.819827664545414, -42.78042267541577, 15.175199935532744, 13.335124749062027, -63.74102030330165, 45.145141691842966, -46.45587282874396, 65.36000000000018, -4.039750577157115, 187.43635046351665, 26.51704215222133, 47.35908666977699, 173.88821593677844, 30.710000000000203, -96.34390881856262, 34.761457392791236, 183.98656680648463, 0.7601871969938181, 101.96552165364007, 186.6796084814978, 3.7609406984130342, 77.80901961626418, 174.82863485935695, 93.93318996307849, 17.84000000000002, 96.21132559246719, 142.58, 69.44034787424516, 72.8796358897812, 42.1029147331377, 113.74172528618702, 145.55, 100.52260624205115, 111.34939404792796, 172.81099847148067, 144.88536723863396, -19.29951655645033, 66.35, 147.53, 128.41739421223426, -80.69818663832478, 106.74236404403226, 154.66645805036137, 100.40394680226048, -44.887033245093924, 96.62680513140822, 53.81996949209953, 186.38014631660914, 199.5200614147637, 143.11497469010635, 90.95029437335386, 137.2368468982886, 196.55814684484164, 129.68525192172095, 183.26021778652583, 158.27100872465047, 171.39376650196397, 154.9166236382233, 56.025373832630045, 153.64937716560542, 104.23636777126855, 128.6694365238675, 182.66107536724775, 133.43209470354284, 111.8083008256726, 170.57491983666804, 200.0, 179.7367040492707, 177.07063331106963, 134.18790409901624, 150.59901249435498, 99.16972433380349, 130.70000000000002, 158.13335101448183, 189.28311964720154, 44.25905024513057, 47.75111090576659, 153.83083384467076, 121.96763246784234, 101.89564484844635, 119.40460349848048, 7.461286794642522, 58.08599618933886, 101.1805125566353, 173.86182234772835, 158.99417251085646, 152.41209872066304, 156.8354381736502, 104.33054970880256, 97.21797456828592, 144.75822566584168, 93.74295739968761, 127.89641072651648, 150.48150937199992, 157.8179364524327, 126.92588476526223, 117.3720620146159, 62.596740390918924, 176.64897420904705, 143.36331014528938, 75.0676960053105, 133.568120438634, 106.63972627282983, 88.57388434649165, 149.09597737634436, 58.50155666693349, 181.33762277997678, 105.96086689240376, 119.60559566865012, 150.18233774512305, 86.78197530626221, 90.62986072340374, 114.2844346732264, 155.69114596825955, 143.4325094473234, 126.05049259731112, 40.26214822491892, 162.70864138378005, 160.54698814060401, 112.75419555673643, 51.696641072181286, 10.32416018894008, 88.27493765553615, 90.16257069067862], "policy_predator_policy_reward": [7.242660843856948, 90.65194900856021, 8.728714289554587, 80.22745503358335, 42.067257269297286, 25.35576153595694, 12.032345647792901, 0.3148733669042303, 12.091366486715987, 60.81047982891206, 42.06430743440262, 11.63335693595044, 9.994748683849998, 31.42130585501532, 49.27651157303569, 44.57475301183391, 14.966930686434113, 5.827382193589516, 16.631398541343145, 49.447395256431115, 44.78042267541567, 38.80982766454516, 48.20480006446728, 14.404875250937947, 65.74102030330225, 12.294858308156888, 47.51294975311792, 7.384970644311164, 32.00565451958373, 3.5854057028151805, 32.983978360619844, 5.109546252963871, 0.6553326632683046, 0.7064513999533362, 75.4592161048304, 83.03052488451893, 19.461595791816297, 2.3609974072393656, 3.189921750922669, 21.396896899033187, 8.74473936951574, 11.695300315806927, 9.908969978926848, 32.229205198637665, 11.947873113784139, 3.1891502956307263, 22.649652125754866, 0.0, 41.61831665800379, 11.669943011975564, 17.168753407832813, 6.898522083884069, 6.34713002953549, 11.325324287343978, 56.56816330486666, 1.9432115680023239, 21.2995165564503, 0.0, 10.987912991340698, 8.827331029314818, 82.88569165397276, 190.60185583592565, 15.06313689117944, 14.454849893419924, 3.4621312220708225, 65.21669558235564, 15.321205759201607, 3.231844583111389, 2.8761549039116714, 4.509448851247581, 63.988281865885625, 10.21732290028732, 9.462857862350761, 26.416137693384186, 13.186899202580888, 27.06357208972237, 3.186375639956463, 4.173234219856149, 4.770622834394595, 46.95462616736993, 9.950563476132409, 4.683632228731328, 7.555979301718974, 25.44837147663663, 7.3286737594734745, 9.552719980049304, 0.9567738012380193, 2.7520803182170592, 32.91731229929185, 22.85480115336901, 56.612338137435245, 71.4555294167371, 13.337639192948345, 7.2532024049503185, 10.261029181625993, 46.37540713960066, 34.76442984878786, 16.31675435855217, 15.497600850560016, 42.82912183315127, 34.06539650151954, 63.49252267220475, 14.822262084205681, 42.61107466023398, 30.010860392143258, 24.11665375059237, 9.174687298180222, 6.6520338806383235, 85.70528782499282, 48.83446310337393, 87.58953691334204, 81.996931094691, 30.03519571665004, 51.381156253171575, 62.975389647204054, 54.86382438882732, 39.01109830618786, 71.43761389751832, 48.42859581565234, 19.973432268149885, 38.37444520756047, 10.729461997319987, 67.58566409513884, 67.9623756909559, 90.07253352558102, 52.02130565401692, 15.613517601016152, 57.918558938241915, 20.140921015049102, 12.733483316300791, 87.88559286977672, 83.88416380488273, 14.593221161462997, 21.165822350395864, 47.294823167010236, 66.32085415064391, 26.097164575566985, 33.31590247229778, 16.009740559244243, 47.5013086078997, 62.96791788435362, 72.00698951653497, 75.02666707197194, 77.31646212958643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7137090960865055, "mean_inference_ms": 1.887552834774849, "mean_action_processing_ms": 0.2926743874134366, "mean_env_wait_ms": 0.2797081295451123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006017420026991103, "StateBufferConnector_ms": 0.0032181541124979654, "ViewRequirementAgentConnector_ms": 0.08883211347791883}, "num_episodes": 18, "episode_return_max": 408.08765107356277, "episode_return_min": 4.9899999999999665, "episode_return_mean": 248.82845070286547, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 412.11473497914926, "num_env_steps_trained_throughput_per_sec": 412.11473497914926, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 9946.433, "restore_workers_time_ms": 0.028, "training_step_time_ms": 9946.363, "sample_time_ms": 1340.077, "learn_time_ms": 8590.978, "learn_throughput": 465.605, "synch_weights_time_ms": 12.427}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-08", "timestamp": 1723778228, "time_this_iter_s": 9.775653839111328, "time_total_s": 39.9734628200531, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72a58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.9734628200531, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 32.33571428571428, "ram_util_percent": 83.69285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.564250968215327, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.437689322012442, "policy_loss": -0.008998633034172513, "vf_loss": 6.445271776088331, "vf_explained_var": 0.004762577663653742, "kl": 0.014161789803561878, "entropy": 1.5282435009719202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.031961579423733, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.20310912813459, "policy_loss": -0.008470130643792569, "vf_loss": 9.208545486006157, "vf_explained_var": 0.02209562652956241, "kl": 0.015168887296529003, "entropy": 1.5565319785365352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 415.8584249467496, "episode_reward_min": 4.9899999999999665, "episode_reward_mean": 279.99609075962803, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.60185583592565}, "policy_reward_mean": {"prey_policy": 103.57368400470504, "predator_policy": 36.42436137510895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.90518288788662, 25.84012296817896, 195.30529553610083, 215.9824276809799, 13.43352020974396, 105.97000000000092, 138.85270834002372, 52.624784596054376, 15.014134684617385, 246.88963183149647, 4.9899999999999665, 91.1200000000005, 59.439999999999685, 73.80204756868531, 218.987660108758, 111.96965343558202, 205.9599999999993, 96.90728956357789, 206.56934720253412, 313.23194878509366, 102.01000000000043, 310.9, 129.18834900188216, 234.67, 168.27081029289832, 283.3590007779039, 229.54445460685852, 376.20774058298355, 68.34999999999998, 295.7626382328897, 299.53172489560535, 284.5883916372204, 120.4185986907406, 258.7531661510218, 350.0206398600293, 302.39274603781536, 362.1223943222974, 381.7816978034795, 333.6700000000001, 261.4, 247.5400000000005, 349.09752084914624, 299.2646144018634, 383.4455581687258, 367.0306508627467, 377.83660438233153, 309.4241926123805, 290.17860621355896, 252.6631289577776, 282.19, 224.423809466847, 216.69984549041317, 386.9835090013204, 325.0742580731317, 336.0882752054551, 408.08765107356277, 359.7942720683381, 402.5830352537265, 290.41751460924115, 388.4143124381387, 257.739723648825, 330.761650405416, 349.69137322287565, 360.8305662116386, 302.6623377451231, 349.1815927043252, 305.73462415334484, 383.09867936228886, 262.38385665656375, 336.81223286448414, 196.99570866201012, 330.78063754777327, 377.80144753830655, 299.4370992604471, 389.9151310203707, 316.51346344079553, 355.27508292044956, 393.4214297372561, 371.4307224829907, 415.8584249467496, 394.8061794708367, 319.7305700551388, 345.23662453780196, 328.50380392690465, 332.18272465324327, 374.2983717276656, 361.3021246219636, 382.3070507106597, 363.48880783939944, 355.7641483579814, 376.68659778395795, 355.2432320640537, 398.2498186284514, 355.86975903977566, 395.94699300787124, 392.75617984933933, 338.9201683171419, 357.4782337875932, 355.54034486971295], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.24642806984643, 76.25700110531551, 2.0000000000000013, -65.11604635495874, 62.442823919959835, 65.43945281088784, 167.72696967423198, 35.908238992051274, -62.458326105884225, 2.9899999999999944, -7.653356935950468, 59.92569256559731, 66.69582279016578, 30.74083101099196, 7.276889594266655, -48.50336958308198, 2.0000000000000013, -7.780178195406204, 179.7773227590011, 1.0335152747218395, -35.819827664545414, -42.78042267541577, 15.175199935532744, 13.335124749062027, -63.74102030330165, 45.145141691842966, -46.45587282874396, 65.36000000000018, -4.039750577157115, 187.43635046351665, 26.51704215222133, 47.35908666977699, 173.88821593677844, 30.710000000000203, -96.34390881856262, 34.761457392791236, 183.98656680648463, 0.7601871969938181, 101.96552165364007, 186.6796084814978, 3.7609406984130342, 77.80901961626418, 174.82863485935695, 93.93318996307849, 17.84000000000002, 96.21132559246719, 142.58, 69.44034787424516, 72.8796358897812, 42.1029147331377, 113.74172528618702, 145.55, 100.52260624205115, 111.34939404792796, 172.81099847148067, 144.88536723863396, -19.29951655645033, 66.35, 147.53, 128.41739421223426, -80.69818663832478, 106.74236404403226, 154.66645805036137, 100.40394680226048, -44.887033245093924, 96.62680513140822, 53.81996949209953, 186.38014631660914, 199.5200614147637, 143.11497469010635, 90.95029437335386, 137.2368468982886, 196.55814684484164, 129.68525192172095, 183.26021778652583, 158.27100872465047, 171.39376650196397, 154.9166236382233, 56.025373832630045, 153.64937716560542, 104.23636777126855, 128.6694365238675, 182.66107536724775, 133.43209470354284, 111.8083008256726, 170.57491983666804, 200.0, 179.7367040492707, 177.07063331106963, 134.18790409901624, 150.59901249435498, 99.16972433380349, 130.70000000000002, 158.13335101448183, 189.28311964720154, 44.25905024513057, 47.75111090576659, 153.83083384467076, 121.96763246784234, 101.89564484844635, 119.40460349848048, 7.461286794642522, 58.08599618933886, 101.1805125566353, 173.86182234772835, 158.99417251085646, 152.41209872066304, 156.8354381736502, 104.33054970880256, 97.21797456828592, 144.75822566584168, 93.74295739968761, 127.89641072651648, 150.48150937199992, 157.8179364524327, 126.92588476526223, 117.3720620146159, 62.596740390918924, 176.64897420904705, 143.36331014528938, 75.0676960053105, 133.568120438634, 106.63972627282983, 88.57388434649165, 149.09597737634436, 58.50155666693349, 181.33762277997678, 105.96086689240376, 119.60559566865012, 150.18233774512305, 86.78197530626221, 90.62986072340374, 114.2844346732264, 155.69114596825955, 143.4325094473234, 126.05049259731112, 40.26214822491892, 162.70864138378005, 160.54698814060401, 112.75419555673643, 51.696641072181286, 10.32416018894008, 88.27493765553615, 90.16257069067862, 121.63894732488663, 125.21380007734334, 106.37699272959178, 63.94196771239334, 123.77690801953462, 164.91743379577215, 42.957470459556234, 78.2492618961659, 54.34097499853105, 152.4904705929833, 164.24525109655278, 197.82969570623206, 160.6197559992611, 112.89558258515783, 86.79095751621131, 190.38216957780492, 127.73948695011676, 180.93661229804584, 112.62639277149071, 150.08235801668613, 163.7726489624738, 143.67311528321733, 146.86933412627502, 126.67304713109475, 104.40388458264793, 71.43902034310769, 168.17973995037357, 188.3073944656688, 83.38071226835768, 152.32926223868228, 82.3837770966119, 171.37499897875895, 151.03049995929103, -53.56233465252615, 120.0560020484888, 173.52199898965253, 117.23981552099293, 112.10375293622154, 143.0475705039123, 177.17070787462046, 158.70888379821216, 163.31349051339353, 160.83491317070622, 158.42402343094176, 110.9923078430791, 174.3711532077817, 159.80535506305276, 159.00759726504342, 119.69987041285925, 158.27560528982642, 114.57921060950883, 164.46562705823345, 142.60661145001615, 172.33192933551766], "policy_predator_policy_reward": [7.242660843856948, 90.65194900856021, 8.728714289554587, 80.22745503358335, 42.067257269297286, 25.35576153595694, 12.032345647792901, 0.3148733669042303, 12.091366486715987, 60.81047982891206, 42.06430743440262, 11.63335693595044, 9.994748683849998, 31.42130585501532, 49.27651157303569, 44.57475301183391, 14.966930686434113, 5.827382193589516, 16.631398541343145, 49.447395256431115, 44.78042267541567, 38.80982766454516, 48.20480006446728, 14.404875250937947, 65.74102030330225, 12.294858308156888, 47.51294975311792, 7.384970644311164, 32.00565451958373, 3.5854057028151805, 32.983978360619844, 5.109546252963871, 0.6553326632683046, 0.7064513999533362, 75.4592161048304, 83.03052488451893, 19.461595791816297, 2.3609974072393656, 3.189921750922669, 21.396896899033187, 8.74473936951574, 11.695300315806927, 9.908969978926848, 32.229205198637665, 11.947873113784139, 3.1891502956307263, 22.649652125754866, 0.0, 41.61831665800379, 11.669943011975564, 17.168753407832813, 6.898522083884069, 6.34713002953549, 11.325324287343978, 56.56816330486666, 1.9432115680023239, 21.2995165564503, 0.0, 10.987912991340698, 8.827331029314818, 82.88569165397276, 190.60185583592565, 15.06313689117944, 14.454849893419924, 3.4621312220708225, 65.21669558235564, 15.321205759201607, 3.231844583111389, 2.8761549039116714, 4.509448851247581, 63.988281865885625, 10.21732290028732, 9.462857862350761, 26.416137693384186, 13.186899202580888, 27.06357208972237, 3.186375639956463, 4.173234219856149, 4.770622834394595, 46.95462616736993, 9.950563476132409, 4.683632228731328, 7.555979301718974, 25.44837147663663, 7.3286737594734745, 9.552719980049304, 0.9567738012380193, 2.7520803182170592, 32.91731229929185, 22.85480115336901, 56.612338137435245, 71.4555294167371, 13.337639192948345, 7.2532024049503185, 10.261029181625993, 46.37540713960066, 34.76442984878786, 16.31675435855217, 15.497600850560016, 42.82912183315127, 34.06539650151954, 63.49252267220475, 14.822262084205681, 42.61107466023398, 30.010860392143258, 24.11665375059237, 9.174687298180222, 6.6520338806383235, 85.70528782499282, 48.83446310337393, 87.58953691334204, 81.996931094691, 30.03519571665004, 51.381156253171575, 62.975389647204054, 54.86382438882732, 39.01109830618786, 71.43761389751832, 48.42859581565234, 19.973432268149885, 38.37444520756047, 10.729461997319987, 67.58566409513884, 67.9623756909559, 90.07253352558102, 52.02130565401692, 15.613517601016152, 57.918558938241915, 20.140921015049102, 12.733483316300791, 87.88559286977672, 83.88416380488273, 14.593221161462997, 21.165822350395864, 47.294823167010236, 66.32085415064391, 26.097164575566985, 33.31590247229778, 16.009740559244243, 47.5013086078997, 62.96791788435362, 72.00698951653497, 75.02666707197194, 77.31646212958643, 76.72765272514758, 54.22104741092882, 49.27415384504265, 79.84398497341934, 47.78888521844123, 53.431903986622636, 89.04198068315668, 106.26475040191677, 54.20775166984861, 94.2358856590868, 10.472076365984694, 20.874406568486627, 10.301495480207135, 87.6138884183647, 83.35034956854854, 55.33494828418518, 35.71555066332195, 50.414529559352225, 3.9867790524108457, 53.03504021455113, 18.110510433044023, 19.68034985906688, 32.25574534420262, 22.705677325332328, 28.71252819982268, 127.62729152766508, 8.840907233725957, 8.970330077897293, 80.30348199205963, 45.2886681228642, 67.57763802148499, 60.970636613803464, 113.62796605129368, 152.39267648134094, 55.07111360023355, 7.115033719606574, 71.57504927615011, 75.76798005059293, 9.622604405115785, 25.402349280405023, 43.031838918010884, 33.19560539883483, 10.42135935367474, 26.18946308445287, 71.90649246783406, 38.67703948917658, 45.449746871414625, 28.493480649828257, 6.993773993797184, 53.95091862065882, 56.88060854327061, 21.552787576580503, 13.195587971421508, 27.406216112757694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6868003413592936, "mean_inference_ms": 1.8037866467572452, "mean_action_processing_ms": 0.2795738051944161, "mean_env_wait_ms": 0.26608897893890116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006057638110536517, "StateBufferConnector_ms": 0.0031330368735573507, "ViewRequirementAgentConnector_ms": 0.08860790368282434}, "num_episodes": 27, "episode_return_max": 415.8584249467496, "episode_return_min": 4.9899999999999665, "episode_return_mean": 279.99609075962803, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 409.1267574062707, "num_env_steps_trained_throughput_per_sec": 409.1267574062707, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 9912.532, "restore_workers_time_ms": 0.025, "training_step_time_ms": 9912.467, "sample_time_ms": 1290.575, "learn_time_ms": 8607.089, "learn_throughput": 464.733, "synch_weights_time_ms": 12.136}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-18", "timestamp": 1723778238, "time_this_iter_s": 9.814531087875366, "time_total_s": 49.78799390792847, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7340940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.78799390792847, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 31.442857142857143, "ram_util_percent": 83.5642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9649575085867017, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.737658602346188, "policy_loss": -0.011207526630756479, "vf_loss": 6.7469130220867335, "vf_explained_var": -0.004376249117826028, "kl": 0.019531075432748263, "entropy": 1.5342622895720144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9637571119284503, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.224220711844309, "policy_loss": 0.0006733218358248157, "vf_loss": 9.222365068506312, "vf_explained_var": 0.010932052009320133, "kl": 0.005911498612206214, "entropy": 1.5693555075655539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 415.8584249467496, "episode_reward_min": 68.34999999999998, "episode_reward_mean": 322.1735474223517, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -96.34390881856262, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 190.60185583592565}, "policy_reward_mean": {"prey_policy": 121.07632926991147, "predator_policy": 40.01044444126434}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.90728956357789, 206.56934720253412, 313.23194878509366, 102.01000000000043, 310.9, 129.18834900188216, 234.67, 168.27081029289832, 283.3590007779039, 229.54445460685852, 376.20774058298355, 68.34999999999998, 295.7626382328897, 299.53172489560535, 284.5883916372204, 120.4185986907406, 258.7531661510218, 350.0206398600293, 302.39274603781536, 362.1223943222974, 381.7816978034795, 333.6700000000001, 261.4, 247.5400000000005, 349.09752084914624, 299.2646144018634, 383.4455581687258, 367.0306508627467, 377.83660438233153, 309.4241926123805, 290.17860621355896, 252.6631289577776, 282.19, 224.423809466847, 216.69984549041317, 386.9835090013204, 325.0742580731317, 336.0882752054551, 408.08765107356277, 359.7942720683381, 402.5830352537265, 290.41751460924115, 388.4143124381387, 257.739723648825, 330.761650405416, 349.69137322287565, 360.8305662116386, 302.6623377451231, 349.1815927043252, 305.73462415334484, 383.09867936228886, 262.38385665656375, 336.81223286448414, 196.99570866201012, 330.78063754777327, 377.80144753830655, 299.4370992604471, 389.9151310203707, 316.51346344079553, 355.27508292044956, 393.4214297372561, 371.4307224829907, 415.8584249467496, 394.8061794708367, 319.7305700551388, 345.23662453780196, 328.50380392690465, 332.18272465324327, 374.2983717276656, 361.3021246219636, 382.3070507106597, 363.48880783939944, 355.7641483579814, 376.68659778395795, 355.2432320640537, 398.2498186284514, 355.86975903977566, 395.94699300787124, 392.75617984933933, 338.9201683171419, 357.4782337875932, 355.54034486971295, 348.0836839862036, 357.6343599107675, 341.20943089701854, 358.93933849206604, 392.1108101990099, 355.37904669126664, 353.6461188835453, 368.53718685831853, 369.43084550706766, 359.7335424075076, 342.4722064124875, 318.5126583845672, 348.1263069210034, 307.9697715559554, 379.0100838208567, 364.67640940992254, 333.8557530806813, 380.5013734618533], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.34390881856262, 34.761457392791236, 183.98656680648463, 0.7601871969938181, 101.96552165364007, 186.6796084814978, 3.7609406984130342, 77.80901961626418, 174.82863485935695, 93.93318996307849, 17.84000000000002, 96.21132559246719, 142.58, 69.44034787424516, 72.8796358897812, 42.1029147331377, 113.74172528618702, 145.55, 100.52260624205115, 111.34939404792796, 172.81099847148067, 144.88536723863396, -19.29951655645033, 66.35, 147.53, 128.41739421223426, -80.69818663832478, 106.74236404403226, 154.66645805036137, 100.40394680226048, -44.887033245093924, 96.62680513140822, 53.81996949209953, 186.38014631660914, 199.5200614147637, 143.11497469010635, 90.95029437335386, 137.2368468982886, 196.55814684484164, 129.68525192172095, 183.26021778652583, 158.27100872465047, 171.39376650196397, 154.9166236382233, 56.025373832630045, 153.64937716560542, 104.23636777126855, 128.6694365238675, 182.66107536724775, 133.43209470354284, 111.8083008256726, 170.57491983666804, 200.0, 179.7367040492707, 177.07063331106963, 134.18790409901624, 150.59901249435498, 99.16972433380349, 130.70000000000002, 158.13335101448183, 189.28311964720154, 44.25905024513057, 47.75111090576659, 153.83083384467076, 121.96763246784234, 101.89564484844635, 119.40460349848048, 7.461286794642522, 58.08599618933886, 101.1805125566353, 173.86182234772835, 158.99417251085646, 152.41209872066304, 156.8354381736502, 104.33054970880256, 97.21797456828592, 144.75822566584168, 93.74295739968761, 127.89641072651648, 150.48150937199992, 157.8179364524327, 126.92588476526223, 117.3720620146159, 62.596740390918924, 176.64897420904705, 143.36331014528938, 75.0676960053105, 133.568120438634, 106.63972627282983, 88.57388434649165, 149.09597737634436, 58.50155666693349, 181.33762277997678, 105.96086689240376, 119.60559566865012, 150.18233774512305, 86.78197530626221, 90.62986072340374, 114.2844346732264, 155.69114596825955, 143.4325094473234, 126.05049259731112, 40.26214822491892, 162.70864138378005, 160.54698814060401, 112.75419555673643, 51.696641072181286, 10.32416018894008, 88.27493765553615, 90.16257069067862, 121.63894732488663, 125.21380007734334, 106.37699272959178, 63.94196771239334, 123.77690801953462, 164.91743379577215, 42.957470459556234, 78.2492618961659, 54.34097499853105, 152.4904705929833, 164.24525109655278, 197.82969570623206, 160.6197559992611, 112.89558258515783, 86.79095751621131, 190.38216957780492, 127.73948695011676, 180.93661229804584, 112.62639277149071, 150.08235801668613, 163.7726489624738, 143.67311528321733, 146.86933412627502, 126.67304713109475, 104.40388458264793, 71.43902034310769, 168.17973995037357, 188.3073944656688, 83.38071226835768, 152.32926223868228, 82.3837770966119, 171.37499897875895, 151.03049995929103, -53.56233465252615, 120.0560020484888, 173.52199898965253, 117.23981552099293, 112.10375293622154, 143.0475705039123, 177.17070787462046, 158.70888379821216, 163.31349051339353, 160.83491317070622, 158.42402343094176, 110.9923078430791, 174.3711532077817, 159.80535506305276, 159.00759726504342, 119.69987041285925, 158.27560528982642, 114.57921060950883, 164.46562705823345, 142.60661145001615, 172.33192933551766, 140.7356933513732, 144.62320065841536, 149.12590001912588, 159.48181560715062, 102.28840450427397, 148.2084671761753, 131.69902186496455, 123.58244811437142, 140.1740934719318, 168.53512925465927, 180.31580239204018, 87.51155382229796, 66.40863550949666, 141.7760675668167, 87.03667226934182, 114.36815290736214, 147.39409530467663, 130.4703242497863, 169.26176511268082, 112.96462608051358, 47.72675879856561, 156.6208812450245, 92.71445415539854, 110.99222019989273, 146.81021419927674, 142.93151675527187, 102.0427522935305, 162.4397504984558, 96.19613940881445, 134.63072676881774, 148.70655176895002, 139.72156264691094, 130.72053339281555, 101.86953458434657, 163.94622298868867, 96.19085491010998], "policy_predator_policy_reward": [75.4592161048304, 83.03052488451893, 19.461595791816297, 2.3609974072393656, 3.189921750922669, 21.396896899033187, 8.74473936951574, 11.695300315806927, 9.908969978926848, 32.229205198637665, 11.947873113784139, 3.1891502956307263, 22.649652125754866, 0.0, 41.61831665800379, 11.669943011975564, 17.168753407832813, 6.898522083884069, 6.34713002953549, 11.325324287343978, 56.56816330486666, 1.9432115680023239, 21.2995165564503, 0.0, 10.987912991340698, 8.827331029314818, 82.88569165397276, 190.60185583592565, 15.06313689117944, 14.454849893419924, 3.4621312220708225, 65.21669558235564, 15.321205759201607, 3.231844583111389, 2.8761549039116714, 4.509448851247581, 63.988281865885625, 10.21732290028732, 9.462857862350761, 26.416137693384186, 13.186899202580888, 27.06357208972237, 3.186375639956463, 4.173234219856149, 4.770622834394595, 46.95462616736993, 9.950563476132409, 4.683632228731328, 7.555979301718974, 25.44837147663663, 7.3286737594734745, 9.552719980049304, 0.9567738012380193, 2.7520803182170592, 32.91731229929185, 22.85480115336901, 56.612338137435245, 71.4555294167371, 13.337639192948345, 7.2532024049503185, 10.261029181625993, 46.37540713960066, 34.76442984878786, 16.31675435855217, 15.497600850560016, 42.82912183315127, 34.06539650151954, 63.49252267220475, 14.822262084205681, 42.61107466023398, 30.010860392143258, 24.11665375059237, 9.174687298180222, 6.6520338806383235, 85.70528782499282, 48.83446310337393, 87.58953691334204, 81.996931094691, 30.03519571665004, 51.381156253171575, 62.975389647204054, 54.86382438882732, 39.01109830618786, 71.43761389751832, 48.42859581565234, 19.973432268149885, 38.37444520756047, 10.729461997319987, 67.58566409513884, 67.9623756909559, 90.07253352558102, 52.02130565401692, 15.613517601016152, 57.918558938241915, 20.140921015049102, 12.733483316300791, 87.88559286977672, 83.88416380488273, 14.593221161462997, 21.165822350395864, 47.294823167010236, 66.32085415064391, 26.097164575566985, 33.31590247229778, 16.009740559244243, 47.5013086078997, 62.96791788435362, 72.00698951653497, 75.02666707197194, 77.31646212958643, 76.72765272514758, 54.22104741092882, 49.27415384504265, 79.84398497341934, 47.78888521844123, 53.431903986622636, 89.04198068315668, 106.26475040191677, 54.20775166984861, 94.2358856590868, 10.472076365984694, 20.874406568486627, 10.301495480207135, 87.6138884183647, 83.35034956854854, 55.33494828418518, 35.71555066332195, 50.414529559352225, 3.9867790524108457, 53.03504021455113, 18.110510433044023, 19.68034985906688, 32.25574534420262, 22.705677325332328, 28.71252819982268, 127.62729152766508, 8.840907233725957, 8.970330077897293, 80.30348199205963, 45.2886681228642, 67.57763802148499, 60.970636613803464, 113.62796605129368, 152.39267648134094, 55.07111360023355, 7.115033719606574, 71.57504927615011, 75.76798005059293, 9.622604405115785, 25.402349280405023, 43.031838918010884, 33.19560539883483, 10.42135935367474, 26.18946308445287, 71.90649246783406, 38.67703948917658, 45.449746871414625, 28.493480649828257, 6.993773993797184, 53.95091862065882, 56.88060854327061, 21.552787576580503, 13.195587971421508, 27.406216112757694, 12.538800556242318, 50.18598942017274, 18.864467561936188, 30.162176722554882, 21.982358137760865, 68.73020107880826, 60.6319874221934, 43.02588109053645, 45.44262373442876, 37.95896373798994, 39.31529958680318, 48.2363908901257, 92.70057249025628, 52.76084331697566, 92.84168324283205, 74.29067843878252, 35.7580940439191, 55.80833190868554, 41.964665786054105, 35.54248542825955, 41.9254352130755, 96.19913115582213, 58.83281256966105, 55.97317145961477, 12.814489875594843, 45.57008609085998, 12.69353510623929, 30.793733657729955, 90.70113970692844, 57.48207793629589, 39.32731017070188, 36.92098482335985, 56.9617833736141, 44.3039017299051, 60.81837963362671, 59.54591592942787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6460453610515777, "mean_inference_ms": 1.6731876767548686, "mean_action_processing_ms": 0.25790115198360075, "mean_env_wait_ms": 0.2446427108070123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005565524101257324, "StateBufferConnector_ms": 0.0029592514038085938, "ViewRequirementAgentConnector_ms": 0.0872189998626709}, "num_episodes": 18, "episode_return_max": 415.8584249467496, "episode_return_min": 68.34999999999998, "episode_return_mean": 322.1735474223517, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.33348944327605, "num_env_steps_trained_throughput_per_sec": 406.33348944327605, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 9901.133, "restore_workers_time_ms": 0.023, "training_step_time_ms": 9901.069, "sample_time_ms": 1269.061, "learn_time_ms": 8616.658, "learn_throughput": 464.217, "synch_weights_time_ms": 12.086}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-28", "timestamp": 1723778248, "time_this_iter_s": 9.902184963226318, "time_total_s": 59.690178871154785, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a73409d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.690178871154785, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.80714285714286, "ram_util_percent": 83.47142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6035138970960383, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.910413291719225, "policy_loss": -0.0137470846704981, "vf_loss": 7.922044615266184, "vf_explained_var": 0.013059078543274491, "kl": 0.021157629125929424, "entropy": 1.4859354269567622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.276719032267414, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.734012163000763, "policy_loss": -0.0017336199579947682, "vf_loss": 8.733522545345245, "vf_explained_var": -0.02080484634984738, "kl": 0.011116224382813834, "entropy": 1.5726619080260948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 415.8584249467496, "episode_reward_min": 196.99570866201012, "episode_reward_mean": 343.38348995946944, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.56233465252615, "predator_policy": 0.9567738012380193}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.39267648134094}, "policy_reward_mean": {"prey_policy": 123.7604517438249, "predator_policy": 47.9312932359098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.39274603781536, 362.1223943222974, 381.7816978034795, 333.6700000000001, 261.4, 247.5400000000005, 349.09752084914624, 299.2646144018634, 383.4455581687258, 367.0306508627467, 377.83660438233153, 309.4241926123805, 290.17860621355896, 252.6631289577776, 282.19, 224.423809466847, 216.69984549041317, 386.9835090013204, 325.0742580731317, 336.0882752054551, 408.08765107356277, 359.7942720683381, 402.5830352537265, 290.41751460924115, 388.4143124381387, 257.739723648825, 330.761650405416, 349.69137322287565, 360.8305662116386, 302.6623377451231, 349.1815927043252, 305.73462415334484, 383.09867936228886, 262.38385665656375, 336.81223286448414, 196.99570866201012, 330.78063754777327, 377.80144753830655, 299.4370992604471, 389.9151310203707, 316.51346344079553, 355.27508292044956, 393.4214297372561, 371.4307224829907, 415.8584249467496, 394.8061794708367, 319.7305700551388, 345.23662453780196, 328.50380392690465, 332.18272465324327, 374.2983717276656, 361.3021246219636, 382.3070507106597, 363.48880783939944, 355.7641483579814, 376.68659778395795, 355.2432320640537, 398.2498186284514, 355.86975903977566, 395.94699300787124, 392.75617984933933, 338.9201683171419, 357.4782337875932, 355.54034486971295, 348.0836839862036, 357.6343599107675, 341.20943089701854, 358.93933849206604, 392.1108101990099, 355.37904669126664, 353.6461188835453, 368.53718685831853, 369.43084550706766, 359.7335424075076, 342.4722064124875, 318.5126583845672, 348.1263069210034, 307.9697715559554, 379.0100838208567, 364.67640940992254, 333.8557530806813, 380.5013734618533, 365.3627390999641, 340.69923269582546, 311.4278302367763, 334.2720116035187, 377.684631288673, 326.0545261975325, 341.18382091572164, 330.2764052270013, 336.46007658375385, 343.1748775511287, 377.9593931303882, 327.5636916080926, 345.25172823318854, 340.19018710831716, 364.59512097839263, 382.74690420199175, 364.1528469725875, 340.2223303601623], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [90.95029437335386, 137.2368468982886, 196.55814684484164, 129.68525192172095, 183.26021778652583, 158.27100872465047, 171.39376650196397, 154.9166236382233, 56.025373832630045, 153.64937716560542, 104.23636777126855, 128.6694365238675, 182.66107536724775, 133.43209470354284, 111.8083008256726, 170.57491983666804, 200.0, 179.7367040492707, 177.07063331106963, 134.18790409901624, 150.59901249435498, 99.16972433380349, 130.70000000000002, 158.13335101448183, 189.28311964720154, 44.25905024513057, 47.75111090576659, 153.83083384467076, 121.96763246784234, 101.89564484844635, 119.40460349848048, 7.461286794642522, 58.08599618933886, 101.1805125566353, 173.86182234772835, 158.99417251085646, 152.41209872066304, 156.8354381736502, 104.33054970880256, 97.21797456828592, 144.75822566584168, 93.74295739968761, 127.89641072651648, 150.48150937199992, 157.8179364524327, 126.92588476526223, 117.3720620146159, 62.596740390918924, 176.64897420904705, 143.36331014528938, 75.0676960053105, 133.568120438634, 106.63972627282983, 88.57388434649165, 149.09597737634436, 58.50155666693349, 181.33762277997678, 105.96086689240376, 119.60559566865012, 150.18233774512305, 86.78197530626221, 90.62986072340374, 114.2844346732264, 155.69114596825955, 143.4325094473234, 126.05049259731112, 40.26214822491892, 162.70864138378005, 160.54698814060401, 112.75419555673643, 51.696641072181286, 10.32416018894008, 88.27493765553615, 90.16257069067862, 121.63894732488663, 125.21380007734334, 106.37699272959178, 63.94196771239334, 123.77690801953462, 164.91743379577215, 42.957470459556234, 78.2492618961659, 54.34097499853105, 152.4904705929833, 164.24525109655278, 197.82969570623206, 160.6197559992611, 112.89558258515783, 86.79095751621131, 190.38216957780492, 127.73948695011676, 180.93661229804584, 112.62639277149071, 150.08235801668613, 163.7726489624738, 143.67311528321733, 146.86933412627502, 126.67304713109475, 104.40388458264793, 71.43902034310769, 168.17973995037357, 188.3073944656688, 83.38071226835768, 152.32926223868228, 82.3837770966119, 171.37499897875895, 151.03049995929103, -53.56233465252615, 120.0560020484888, 173.52199898965253, 117.23981552099293, 112.10375293622154, 143.0475705039123, 177.17070787462046, 158.70888379821216, 163.31349051339353, 160.83491317070622, 158.42402343094176, 110.9923078430791, 174.3711532077817, 159.80535506305276, 159.00759726504342, 119.69987041285925, 158.27560528982642, 114.57921060950883, 164.46562705823345, 142.60661145001615, 172.33192933551766, 140.7356933513732, 144.62320065841536, 149.12590001912588, 159.48181560715062, 102.28840450427397, 148.2084671761753, 131.69902186496455, 123.58244811437142, 140.1740934719318, 168.53512925465927, 180.31580239204018, 87.51155382229796, 66.40863550949666, 141.7760675668167, 87.03667226934182, 114.36815290736214, 147.39409530467663, 130.4703242497863, 169.26176511268082, 112.96462608051358, 47.72675879856561, 156.6208812450245, 92.71445415539854, 110.99222019989273, 146.81021419927674, 142.93151675527187, 102.0427522935305, 162.4397504984558, 96.19613940881445, 134.63072676881774, 148.70655176895002, 139.72156264691094, 130.72053339281555, 101.86953458434657, 163.94622298868867, 96.19085491010998, 104.20937839314763, 131.3340545339991, 90.16258605424812, 95.45257710612421, 89.26999682254227, 102.66839945281555, 139.41232736683762, 105.39235778145732, 149.59865052339748, 163.98228986943806, 81.77637222979843, 145.69541834329473, 121.7101291113193, 117.46266644499534, 120.40275032403079, 54.70783381144683, 120.30893835256965, 59.76112392574696, 97.26312781863709, 107.31481430757844, 147.90259710932992, 38.362646534936935, 113.17630089059301, 82.2823577064689, 95.46575840399075, 145.81896173888185, 105.5625147356449, 65.17325676294115, 117.22925417606768, 110.78198629063786, 61.72546828972441, 127.57293626908766, 129.74445307556073, -10.719119932212859, 141.83878126421854, 97.76346583326506], "policy_predator_policy_reward": [63.988281865885625, 10.21732290028732, 9.462857862350761, 26.416137693384186, 13.186899202580888, 27.06357208972237, 3.186375639956463, 4.173234219856149, 4.770622834394595, 46.95462616736993, 9.950563476132409, 4.683632228731328, 7.555979301718974, 25.44837147663663, 7.3286737594734745, 9.552719980049304, 0.9567738012380193, 2.7520803182170592, 32.91731229929185, 22.85480115336901, 56.612338137435245, 71.4555294167371, 13.337639192948345, 7.2532024049503185, 10.261029181625993, 46.37540713960066, 34.76442984878786, 16.31675435855217, 15.497600850560016, 42.82912183315127, 34.06539650151954, 63.49252267220475, 14.822262084205681, 42.61107466023398, 30.010860392143258, 24.11665375059237, 9.174687298180222, 6.6520338806383235, 85.70528782499282, 48.83446310337393, 87.58953691334204, 81.996931094691, 30.03519571665004, 51.381156253171575, 62.975389647204054, 54.86382438882732, 39.01109830618786, 71.43761389751832, 48.42859581565234, 19.973432268149885, 38.37444520756047, 10.729461997319987, 67.58566409513884, 67.9623756909559, 90.07253352558102, 52.02130565401692, 15.613517601016152, 57.918558938241915, 20.140921015049102, 12.733483316300791, 87.88559286977672, 83.88416380488273, 14.593221161462997, 21.165822350395864, 47.294823167010236, 66.32085415064391, 26.097164575566985, 33.31590247229778, 16.009740559244243, 47.5013086078997, 62.96791788435362, 72.00698951653497, 75.02666707197194, 77.31646212958643, 76.72765272514758, 54.22104741092882, 49.27415384504265, 79.84398497341934, 47.78888521844123, 53.431903986622636, 89.04198068315668, 106.26475040191677, 54.20775166984861, 94.2358856590868, 10.472076365984694, 20.874406568486627, 10.301495480207135, 87.6138884183647, 83.35034956854854, 55.33494828418518, 35.71555066332195, 50.414529559352225, 3.9867790524108457, 53.03504021455113, 18.110510433044023, 19.68034985906688, 32.25574534420262, 22.705677325332328, 28.71252819982268, 127.62729152766508, 8.840907233725957, 8.970330077897293, 80.30348199205963, 45.2886681228642, 67.57763802148499, 60.970636613803464, 113.62796605129368, 152.39267648134094, 55.07111360023355, 7.115033719606574, 71.57504927615011, 75.76798005059293, 9.622604405115785, 25.402349280405023, 43.031838918010884, 33.19560539883483, 10.42135935367474, 26.18946308445287, 71.90649246783406, 38.67703948917658, 45.449746871414625, 28.493480649828257, 6.993773993797184, 53.95091862065882, 56.88060854327061, 21.552787576580503, 13.195587971421508, 27.406216112757694, 12.538800556242318, 50.18598942017274, 18.864467561936188, 30.162176722554882, 21.982358137760865, 68.73020107880826, 60.6319874221934, 43.02588109053645, 45.44262373442876, 37.95896373798994, 39.31529958680318, 48.2363908901257, 92.70057249025628, 52.76084331697566, 92.84168324283205, 74.29067843878252, 35.7580940439191, 55.80833190868554, 41.964665786054105, 35.54248542825955, 41.9254352130755, 96.19913115582213, 58.83281256966105, 55.97317145961477, 12.814489875594843, 45.57008609085998, 12.69353510623929, 30.793733657729955, 90.70113970692844, 57.48207793629589, 39.32731017070188, 36.92098482335985, 56.9617833736141, 44.3039017299051, 60.81837963362671, 59.54591592942787, 91.77505668851447, 38.04424948430246, 90.11306343211349, 64.9710061033399, 13.058879259463316, 106.43055470195544, 61.4515723882744, 28.015754066949377, 22.491204310779036, 41.612486585058605, 67.63173741198811, 30.95099821245134, 36.57651955693147, 65.43450580247543, 100.03585627550378, 55.12996481601984, 58.608344023537065, 97.78167028190019, 76.91923148558361, 61.67770393933013, 127.00697994093734, 64.68716954518418, 67.69457641004496, 64.41045660098571, 38.645322737240576, 65.32168535307558, 103.88687131400681, 65.56754429572445, 106.82858129460207, 29.755299217084932, 82.89705922181975, 110.55144042135953, 150.1902638922339, 94.93724993700573, 67.64976513708551, 32.970318125593074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6228889908811296, "mean_inference_ms": 1.609998111120299, "mean_action_processing_ms": 0.24801294278015548, "mean_env_wait_ms": 0.23424620406479732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00493621826171875, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.08658528327941895}, "num_episodes": 18, "episode_return_max": 415.8584249467496, "episode_return_min": 196.99570866201012, "episode_return_mean": 343.38348995946944, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 423.4788578813457, "num_env_steps_trained_throughput_per_sec": 423.4788578813457, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 9836.054, "restore_workers_time_ms": 0.022, "training_step_time_ms": 9835.994, "sample_time_ms": 1252.037, "learn_time_ms": 8568.975, "learn_throughput": 466.8, "synch_weights_time_ms": 11.99}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-38", "timestamp": 1723778258, "time_this_iter_s": 9.493208169937134, "time_total_s": 69.18338704109192, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 69.18338704109192, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 30.51538461538462, "ram_util_percent": 83.65384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6476620485542943, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4285028747780615, "policy_loss": -0.007073075403878219, "vf_loss": 7.4333155894405625, "vf_explained_var": -0.030174918464882666, "kl": 0.015069158397662104, "entropy": 1.4846036864966943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1426087385762935, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.93989372833696, "policy_loss": -0.007213066936169982, "vf_loss": 8.94449107609098, "vf_explained_var": 0.012692606890643084, "kl": 0.013078668570412047, "entropy": 1.5513596691151776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 415.8584249467496, "episode_reward_min": 196.99570866201012, "episode_reward_mean": 353.69796288191253, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -53.56233465252615, "predator_policy": 3.9867790524108457}, "policy_reward_max": {"prey_policy": 197.82969570623206, "predator_policy": 152.39267648134094}, "policy_reward_mean": {"prey_policy": 120.32080407174209, "predator_policy": 56.52817736921415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.0742580731317, 336.0882752054551, 408.08765107356277, 359.7942720683381, 402.5830352537265, 290.41751460924115, 388.4143124381387, 257.739723648825, 330.761650405416, 349.69137322287565, 360.8305662116386, 302.6623377451231, 349.1815927043252, 305.73462415334484, 383.09867936228886, 262.38385665656375, 336.81223286448414, 196.99570866201012, 330.78063754777327, 377.80144753830655, 299.4370992604471, 389.9151310203707, 316.51346344079553, 355.27508292044956, 393.4214297372561, 371.4307224829907, 415.8584249467496, 394.8061794708367, 319.7305700551388, 345.23662453780196, 328.50380392690465, 332.18272465324327, 374.2983717276656, 361.3021246219636, 382.3070507106597, 363.48880783939944, 355.7641483579814, 376.68659778395795, 355.2432320640537, 398.2498186284514, 355.86975903977566, 395.94699300787124, 392.75617984933933, 338.9201683171419, 357.4782337875932, 355.54034486971295, 348.0836839862036, 357.6343599107675, 341.20943089701854, 358.93933849206604, 392.1108101990099, 355.37904669126664, 353.6461188835453, 368.53718685831853, 369.43084550706766, 359.7335424075076, 342.4722064124875, 318.5126583845672, 348.1263069210034, 307.9697715559554, 379.0100838208567, 364.67640940992254, 333.8557530806813, 380.5013734618533, 365.3627390999641, 340.69923269582546, 311.4278302367763, 334.2720116035187, 377.684631288673, 326.0545261975325, 341.18382091572164, 330.2764052270013, 336.46007658375385, 343.1748775511287, 377.9593931303882, 327.5636916080926, 345.25172823318854, 340.19018710831716, 364.59512097839263, 382.74690420199175, 364.1528469725875, 340.2223303601623, 344.45123190089095, 384.33946995451146, 397.237703858995, 270.42017162203103, 363.8041598546421, 371.77137970920313, 347.3442428027134, 403.7703767734174, 391.552768392511, 342.88896806938556, 400.9368884979527, 357.38874540600875, 356.21802802176217, 389.1853257629526, 328.0172279229716, 399.51496023913705, 396.0895465710888, 414.66097545483757], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.41209872066304, 156.8354381736502, 104.33054970880256, 97.21797456828592, 144.75822566584168, 93.74295739968761, 127.89641072651648, 150.48150937199992, 157.8179364524327, 126.92588476526223, 117.3720620146159, 62.596740390918924, 176.64897420904705, 143.36331014528938, 75.0676960053105, 133.568120438634, 106.63972627282983, 88.57388434649165, 149.09597737634436, 58.50155666693349, 181.33762277997678, 105.96086689240376, 119.60559566865012, 150.18233774512305, 86.78197530626221, 90.62986072340374, 114.2844346732264, 155.69114596825955, 143.4325094473234, 126.05049259731112, 40.26214822491892, 162.70864138378005, 160.54698814060401, 112.75419555673643, 51.696641072181286, 10.32416018894008, 88.27493765553615, 90.16257069067862, 121.63894732488663, 125.21380007734334, 106.37699272959178, 63.94196771239334, 123.77690801953462, 164.91743379577215, 42.957470459556234, 78.2492618961659, 54.34097499853105, 152.4904705929833, 164.24525109655278, 197.82969570623206, 160.6197559992611, 112.89558258515783, 86.79095751621131, 190.38216957780492, 127.73948695011676, 180.93661229804584, 112.62639277149071, 150.08235801668613, 163.7726489624738, 143.67311528321733, 146.86933412627502, 126.67304713109475, 104.40388458264793, 71.43902034310769, 168.17973995037357, 188.3073944656688, 83.38071226835768, 152.32926223868228, 82.3837770966119, 171.37499897875895, 151.03049995929103, -53.56233465252615, 120.0560020484888, 173.52199898965253, 117.23981552099293, 112.10375293622154, 143.0475705039123, 177.17070787462046, 158.70888379821216, 163.31349051339353, 160.83491317070622, 158.42402343094176, 110.9923078430791, 174.3711532077817, 159.80535506305276, 159.00759726504342, 119.69987041285925, 158.27560528982642, 114.57921060950883, 164.46562705823345, 142.60661145001615, 172.33192933551766, 140.7356933513732, 144.62320065841536, 149.12590001912588, 159.48181560715062, 102.28840450427397, 148.2084671761753, 131.69902186496455, 123.58244811437142, 140.1740934719318, 168.53512925465927, 180.31580239204018, 87.51155382229796, 66.40863550949666, 141.7760675668167, 87.03667226934182, 114.36815290736214, 147.39409530467663, 130.4703242497863, 169.26176511268082, 112.96462608051358, 47.72675879856561, 156.6208812450245, 92.71445415539854, 110.99222019989273, 146.81021419927674, 142.93151675527187, 102.0427522935305, 162.4397504984558, 96.19613940881445, 134.63072676881774, 148.70655176895002, 139.72156264691094, 130.72053339281555, 101.86953458434657, 163.94622298868867, 96.19085491010998, 104.20937839314763, 131.3340545339991, 90.16258605424812, 95.45257710612421, 89.26999682254227, 102.66839945281555, 139.41232736683762, 105.39235778145732, 149.59865052339748, 163.98228986943806, 81.77637222979843, 145.69541834329473, 121.7101291113193, 117.46266644499534, 120.40275032403079, 54.70783381144683, 120.30893835256965, 59.76112392574696, 97.26312781863709, 107.31481430757844, 147.90259710932992, 38.362646534936935, 113.17630089059301, 82.2823577064689, 95.46575840399075, 145.81896173888185, 105.5625147356449, 65.17325676294115, 117.22925417606768, 110.78198629063786, 61.72546828972441, 127.57293626908766, 129.74445307556073, -10.719119932212859, 141.83878126421854, 97.76346583326506, 92.55126674924158, 177.14332871489788, 136.84647491282237, 163.40489596641362, 139.78689922672078, 98.29200507901443, 58.50477838427121, 63.67319143274749, 146.73773069077458, 74.69217655594916, 142.34543594753953, 146.19998855030974, 114.98971943601502, 89.89526137218083, 105.5019876488804, 86.74581252496759, 79.85803200334884, 131.61503058444922, -11.406050947192645, 105.99077529593563, 63.746435990125924, 148.3280481885449, 136.42806146091215, 35.3715421001203, 176.4880355784983, 87.91754554357107, 160.27815125815226, 172.65405483636712, 82.89219772437755, 77.09918747510969, 129.33705408192887, 119.40146781861512, 130.29463823031202, 113.9146300868695, 176.73360596380041, 128.7192869916563], "policy_predator_policy_reward": [9.174687298180222, 6.6520338806383235, 85.70528782499282, 48.83446310337393, 87.58953691334204, 81.996931094691, 30.03519571665004, 51.381156253171575, 62.975389647204054, 54.86382438882732, 39.01109830618786, 71.43761389751832, 48.42859581565234, 19.973432268149885, 38.37444520756047, 10.729461997319987, 67.58566409513884, 67.9623756909559, 90.07253352558102, 52.02130565401692, 15.613517601016152, 57.918558938241915, 20.140921015049102, 12.733483316300791, 87.88559286977672, 83.88416380488273, 14.593221161462997, 21.165822350395864, 47.294823167010236, 66.32085415064391, 26.097164575566985, 33.31590247229778, 16.009740559244243, 47.5013086078997, 62.96791788435362, 72.00698951653497, 75.02666707197194, 77.31646212958643, 76.72765272514758, 54.22104741092882, 49.27415384504265, 79.84398497341934, 47.78888521844123, 53.431903986622636, 89.04198068315668, 106.26475040191677, 54.20775166984861, 94.2358856590868, 10.472076365984694, 20.874406568486627, 10.301495480207135, 87.6138884183647, 83.35034956854854, 55.33494828418518, 35.71555066332195, 50.414529559352225, 3.9867790524108457, 53.03504021455113, 18.110510433044023, 19.68034985906688, 32.25574534420262, 22.705677325332328, 28.71252819982268, 127.62729152766508, 8.840907233725957, 8.970330077897293, 80.30348199205963, 45.2886681228642, 67.57763802148499, 60.970636613803464, 113.62796605129368, 152.39267648134094, 55.07111360023355, 7.115033719606574, 71.57504927615011, 75.76798005059293, 9.622604405115785, 25.402349280405023, 43.031838918010884, 33.19560539883483, 10.42135935367474, 26.18946308445287, 71.90649246783406, 38.67703948917658, 45.449746871414625, 28.493480649828257, 6.993773993797184, 53.95091862065882, 56.88060854327061, 21.552787576580503, 13.195587971421508, 27.406216112757694, 12.538800556242318, 50.18598942017274, 18.864467561936188, 30.162176722554882, 21.982358137760865, 68.73020107880826, 60.6319874221934, 43.02588109053645, 45.44262373442876, 37.95896373798994, 39.31529958680318, 48.2363908901257, 92.70057249025628, 52.76084331697566, 92.84168324283205, 74.29067843878252, 35.7580940439191, 55.80833190868554, 41.964665786054105, 35.54248542825955, 41.9254352130755, 96.19913115582213, 58.83281256966105, 55.97317145961477, 12.814489875594843, 45.57008609085998, 12.69353510623929, 30.793733657729955, 90.70113970692844, 57.48207793629589, 39.32731017070188, 36.92098482335985, 56.9617833736141, 44.3039017299051, 60.81837963362671, 59.54591592942787, 91.77505668851447, 38.04424948430246, 90.11306343211349, 64.9710061033399, 13.058879259463316, 106.43055470195544, 61.4515723882744, 28.015754066949377, 22.491204310779036, 41.612486585058605, 67.63173741198811, 30.95099821245134, 36.57651955693147, 65.43450580247543, 100.03585627550378, 55.12996481601984, 58.608344023537065, 97.78167028190019, 76.91923148558361, 61.67770393933013, 127.00697994093734, 64.68716954518418, 67.69457641004496, 64.41045660098571, 38.645322737240576, 65.32168535307558, 103.88687131400681, 65.56754429572445, 106.82858129460207, 29.755299217084932, 82.89705922181975, 110.55144042135953, 150.1902638922339, 94.93724993700573, 67.64976513708551, 32.970318125593074, 39.70795710011902, 35.04867933663272, 64.85849629648807, 19.229602778787623, 84.13066155270066, 75.02813800055925, 80.45776317302759, 67.78443863198471, 70.1873713602085, 72.1868812477102, 52.542135125956534, 30.683820085397894, 44.56348752656281, 97.89577446795444, 107.54027889768273, 103.98229770188675, 102.07732732115485, 78.00237848355766, 96.38364124115114, 151.9206024794918, 121.21486586462471, 67.64753845465712, 74.79497115436997, 110.79417069060699, 45.51489952375126, 46.29754737594119, 21.15504052180442, 35.09807914662908, 106.61760885919132, 61.408233864292924, 70.1855390078946, 80.59089933069866, 88.45925503822178, 63.42102321568587, 63.95823000232996, 45.249852497050675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6113205228637547, "mean_inference_ms": 1.5782153721470293, "mean_action_processing_ms": 0.2431598126594297, "mean_env_wait_ms": 0.22960406204908496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004395961761474609, "StateBufferConnector_ms": 0.0028188228607177734, "ViewRequirementAgentConnector_ms": 0.08669674396514893}, "num_episodes": 18, "episode_return_max": 415.8584249467496, "episode_return_min": 196.99570866201012, "episode_return_mean": 353.69796288191253, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.90715334507274, "num_env_steps_trained_throughput_per_sec": 381.90715334507274, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 9915.767, "restore_workers_time_ms": 0.021, "training_step_time_ms": 9915.708, "sample_time_ms": 1251.625, "learn_time_ms": 8648.873, "learn_throughput": 462.488, "synch_weights_time_ms": 12.25}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-48", "timestamp": 1723778268, "time_this_iter_s": 10.516057014465332, "time_total_s": 79.69944405555725, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7340310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 79.69944405555725, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.90666666666666, "ram_util_percent": 83.71333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7093998640618, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.256263289123616, "policy_loss": -0.011063344601699441, "vf_loss": 7.264526302852328, "vf_explained_var": -0.006353962736785727, "kl": 0.018668924436983335, "entropy": 1.473304096794633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.204086300573021, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.813036217260613, "policy_loss": -0.005666137413274516, "vf_loss": 8.816116510118757, "vf_explained_var": 0.022817353470615608, "kl": 0.012929151562519123, "entropy": 1.5600439921257987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 415.8584249467496, "episode_reward_min": 270.42017162203103, "episode_reward_mean": 361.47368592045603, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -95.93300576551755, "predator_policy": 3.9867790524108457}, "policy_reward_max": {"prey_policy": 197.82969570623206, "predator_policy": 208.4426325398554}, "policy_reward_mean": {"prey_policy": 119.68866986876012, "predator_policy": 61.04817309146796}, "custom_metrics": {}, "hist_stats": {"episode_reward": [316.51346344079553, 355.27508292044956, 393.4214297372561, 371.4307224829907, 415.8584249467496, 394.8061794708367, 319.7305700551388, 345.23662453780196, 328.50380392690465, 332.18272465324327, 374.2983717276656, 361.3021246219636, 382.3070507106597, 363.48880783939944, 355.7641483579814, 376.68659778395795, 355.2432320640537, 398.2498186284514, 355.86975903977566, 395.94699300787124, 392.75617984933933, 338.9201683171419, 357.4782337875932, 355.54034486971295, 348.0836839862036, 357.6343599107675, 341.20943089701854, 358.93933849206604, 392.1108101990099, 355.37904669126664, 353.6461188835453, 368.53718685831853, 369.43084550706766, 359.7335424075076, 342.4722064124875, 318.5126583845672, 348.1263069210034, 307.9697715559554, 379.0100838208567, 364.67640940992254, 333.8557530806813, 380.5013734618533, 365.3627390999641, 340.69923269582546, 311.4278302367763, 334.2720116035187, 377.684631288673, 326.0545261975325, 341.18382091572164, 330.2764052270013, 336.46007658375385, 343.1748775511287, 377.9593931303882, 327.5636916080926, 345.25172823318854, 340.19018710831716, 364.59512097839263, 382.74690420199175, 364.1528469725875, 340.2223303601623, 344.45123190089095, 384.33946995451146, 397.237703858995, 270.42017162203103, 363.8041598546421, 371.77137970920313, 347.3442428027134, 403.7703767734174, 391.552768392511, 342.88896806938556, 400.9368884979527, 357.38874540600875, 356.21802802176217, 389.1853257629526, 328.0172279229716, 399.51496023913705, 396.0895465710888, 414.66097545483757, 319.2429968400858, 322.64333451400415, 327.1086137266115, 396.6475069373371, 371.7555983154732, 356.8169325071612, 372.0632980772207, 401.1517669685185, 380.5560871559701, 390.3157550594622, 382.898583378118, 351.9662244581254, 386.19866572488445, 326.0501425196077, 387.82908787345076, 343.23208444038795, 365.8557131514217, 396.1774561572627, 375.1158294086787, 393.61008365670796, 388.542203638691, 386.08031907056704], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.957470459556234, 78.2492618961659, 54.34097499853105, 152.4904705929833, 164.24525109655278, 197.82969570623206, 160.6197559992611, 112.89558258515783, 86.79095751621131, 190.38216957780492, 127.73948695011676, 180.93661229804584, 112.62639277149071, 150.08235801668613, 163.7726489624738, 143.67311528321733, 146.86933412627502, 126.67304713109475, 104.40388458264793, 71.43902034310769, 168.17973995037357, 188.3073944656688, 83.38071226835768, 152.32926223868228, 82.3837770966119, 171.37499897875895, 151.03049995929103, -53.56233465252615, 120.0560020484888, 173.52199898965253, 117.23981552099293, 112.10375293622154, 143.0475705039123, 177.17070787462046, 158.70888379821216, 163.31349051339353, 160.83491317070622, 158.42402343094176, 110.9923078430791, 174.3711532077817, 159.80535506305276, 159.00759726504342, 119.69987041285925, 158.27560528982642, 114.57921060950883, 164.46562705823345, 142.60661145001615, 172.33192933551766, 140.7356933513732, 144.62320065841536, 149.12590001912588, 159.48181560715062, 102.28840450427397, 148.2084671761753, 131.69902186496455, 123.58244811437142, 140.1740934719318, 168.53512925465927, 180.31580239204018, 87.51155382229796, 66.40863550949666, 141.7760675668167, 87.03667226934182, 114.36815290736214, 147.39409530467663, 130.4703242497863, 169.26176511268082, 112.96462608051358, 47.72675879856561, 156.6208812450245, 92.71445415539854, 110.99222019989273, 146.81021419927674, 142.93151675527187, 102.0427522935305, 162.4397504984558, 96.19613940881445, 134.63072676881774, 148.70655176895002, 139.72156264691094, 130.72053339281555, 101.86953458434657, 163.94622298868867, 96.19085491010998, 104.20937839314763, 131.3340545339991, 90.16258605424812, 95.45257710612421, 89.26999682254227, 102.66839945281555, 139.41232736683762, 105.39235778145732, 149.59865052339748, 163.98228986943806, 81.77637222979843, 145.69541834329473, 121.7101291113193, 117.46266644499534, 120.40275032403079, 54.70783381144683, 120.30893835256965, 59.76112392574696, 97.26312781863709, 107.31481430757844, 147.90259710932992, 38.362646534936935, 113.17630089059301, 82.2823577064689, 95.46575840399075, 145.81896173888185, 105.5625147356449, 65.17325676294115, 117.22925417606768, 110.78198629063786, 61.72546828972441, 127.57293626908766, 129.74445307556073, -10.719119932212859, 141.83878126421854, 97.76346583326506, 92.55126674924158, 177.14332871489788, 136.84647491282237, 163.40489596641362, 139.78689922672078, 98.29200507901443, 58.50477838427121, 63.67319143274749, 146.73773069077458, 74.69217655594916, 142.34543594753953, 146.19998855030974, 114.98971943601502, 89.89526137218083, 105.5019876488804, 86.74581252496759, 79.85803200334884, 131.61503058444922, -11.406050947192645, 105.99077529593563, 63.746435990125924, 148.3280481885449, 136.42806146091215, 35.3715421001203, 176.4880355784983, 87.91754554357107, 160.27815125815226, 172.65405483636712, 82.89219772437755, 77.09918747510969, 129.33705408192887, 119.40146781861512, 130.29463823031202, 113.9146300868695, 176.73360596380041, 128.7192869916563, -95.93300576551755, 83.22663610636675, 64.53346625075989, 91.42942881284328, 94.57136861597105, 118.03324013659905, 175.58390940438616, 164.08759891879768, 139.9873784687844, 123.17798013156631, 143.61174491202596, 108.2252174421964, 89.86293481690659, 125.25431861125594, 95.46647129753524, 185.7428187916727, 114.0409670028219, 118.67290349352166, 163.49702981484998, 127.56118201759374, 142.18994848056275, 102.94911810460187, -62.01391075155053, 142.78775452621787, 138.1068921559211, 168.34349059493508, 116.2800578136522, 98.37228387351816, 179.1162174927816, 118.4102994747563, 107.17701123659194, 80.49630986537552, 7.6727836763737605, 129.895087705412, 130.972764727302, 163.70730034260845, 135.86176818211345, 124.18185456999636, 161.4711258935168, 49.20209793612494, 178.52179007636263, 117.0351586546918, 97.41160857611177, 135.19096470908013], "policy_predator_policy_reward": [89.04198068315668, 106.26475040191677, 54.20775166984861, 94.2358856590868, 10.472076365984694, 20.874406568486627, 10.301495480207135, 87.6138884183647, 83.35034956854854, 55.33494828418518, 35.71555066332195, 50.414529559352225, 3.9867790524108457, 53.03504021455113, 18.110510433044023, 19.68034985906688, 32.25574534420262, 22.705677325332328, 28.71252819982268, 127.62729152766508, 8.840907233725957, 8.970330077897293, 80.30348199205963, 45.2886681228642, 67.57763802148499, 60.970636613803464, 113.62796605129368, 152.39267648134094, 55.07111360023355, 7.115033719606574, 71.57504927615011, 75.76798005059293, 9.622604405115785, 25.402349280405023, 43.031838918010884, 33.19560539883483, 10.42135935367474, 26.18946308445287, 71.90649246783406, 38.67703948917658, 45.449746871414625, 28.493480649828257, 6.993773993797184, 53.95091862065882, 56.88060854327061, 21.552787576580503, 13.195587971421508, 27.406216112757694, 12.538800556242318, 50.18598942017274, 18.864467561936188, 30.162176722554882, 21.982358137760865, 68.73020107880826, 60.6319874221934, 43.02588109053645, 45.44262373442876, 37.95896373798994, 39.31529958680318, 48.2363908901257, 92.70057249025628, 52.76084331697566, 92.84168324283205, 74.29067843878252, 35.7580940439191, 55.80833190868554, 41.964665786054105, 35.54248542825955, 41.9254352130755, 96.19913115582213, 58.83281256966105, 55.97317145961477, 12.814489875594843, 45.57008609085998, 12.69353510623929, 30.793733657729955, 90.70113970692844, 57.48207793629589, 39.32731017070188, 36.92098482335985, 56.9617833736141, 44.3039017299051, 60.81837963362671, 59.54591592942787, 91.77505668851447, 38.04424948430246, 90.11306343211349, 64.9710061033399, 13.058879259463316, 106.43055470195544, 61.4515723882744, 28.015754066949377, 22.491204310779036, 41.612486585058605, 67.63173741198811, 30.95099821245134, 36.57651955693147, 65.43450580247543, 100.03585627550378, 55.12996481601984, 58.608344023537065, 97.78167028190019, 76.91923148558361, 61.67770393933013, 127.00697994093734, 64.68716954518418, 67.69457641004496, 64.41045660098571, 38.645322737240576, 65.32168535307558, 103.88687131400681, 65.56754429572445, 106.82858129460207, 29.755299217084932, 82.89705922181975, 110.55144042135953, 150.1902638922339, 94.93724993700573, 67.64976513708551, 32.970318125593074, 39.70795710011902, 35.04867933663272, 64.85849629648807, 19.229602778787623, 84.13066155270066, 75.02813800055925, 80.45776317302759, 67.78443863198471, 70.1873713602085, 72.1868812477102, 52.542135125956534, 30.683820085397894, 44.56348752656281, 97.89577446795444, 107.54027889768273, 103.98229770188675, 102.07732732115485, 78.00237848355766, 96.38364124115114, 151.9206024794918, 121.21486586462471, 67.64753845465712, 74.79497115436997, 110.79417069060699, 45.51489952375126, 46.29754737594119, 21.15504052180442, 35.09807914662908, 106.61760885919132, 61.408233864292924, 70.1855390078946, 80.59089933069866, 88.45925503822178, 63.42102321568587, 63.95823000232996, 45.249852497050675, 123.50673395938108, 208.4426325398554, 103.82396105538076, 62.85647839502009, 35.32059882053743, 79.18340615350398, 42.52745845814891, 14.448540156004178, 47.16480562886807, 61.42543408625452, 58.540473938399735, 46.439496214539616, 77.74711092628954, 79.19893372276869, 79.29605745117868, 40.64641942813205, 104.18174525913733, 43.660471400488966, 42.49084597253178, 56.76669725448652, 88.88259348880548, 48.87692330414784, 152.68216181767778, 118.51021886578027, 45.301520758234695, 34.44676221579369, 78.6424747857849, 32.7553260466526, 28.926924253740495, 61.37564665217245, 82.84265690828268, 72.71610643013807, 53.85642561309788, 174.43141615653795, 59.278781342391426, 42.21860974496115, 63.28235311925403, 51.78985353731482, 103.31690485721711, 79.61995496984902, 54.140875040924676, 38.84437986671201, 115.29859532114025, 38.17915046423487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6026693106183663, "mean_inference_ms": 1.569063191885047, "mean_action_processing_ms": 0.24011667730471536, "mean_env_wait_ms": 0.22691591963218427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003994941711425781, "StateBufferConnector_ms": 0.002857804298400879, "ViewRequirementAgentConnector_ms": 0.08841204643249512}, "num_episodes": 22, "episode_return_max": 415.8584249467496, "episode_return_min": 270.42017162203103, "episode_return_mean": 361.47368592045603, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.3621426664869, "num_env_steps_trained_throughput_per_sec": 369.3621426664869, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 10017.292, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10017.235, "sample_time_ms": 1265.474, "learn_time_ms": 8736.105, "learn_throughput": 457.87, "synch_weights_time_ms": 12.429}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "e552a_00000", "date": "2024-08-16_08-47-59", "timestamp": 1723778279, "time_this_iter_s": 10.875554084777832, "time_total_s": 90.57499814033508, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7340280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 90.57499814033508, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 30.693749999999998, "ram_util_percent": 83.38125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.780080361435653, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.05006326291927, "policy_loss": -0.004420187306299648, "vf_loss": 8.052693104617811, "vf_explained_var": 0.005428507782164074, "kl": 0.01193559610315305, "entropy": 1.4887831587009328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4327690482770326, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.580576213705477, "policy_loss": -0.005217812892798551, "vf_loss": 8.583198326353044, "vf_explained_var": 0.04232168443619259, "kl": 0.012978571431366857, "entropy": 1.554306770947875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 414.66097545483757, "episode_reward_min": 270.42017162203103, "episode_reward_mean": 362.62367658801514, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -95.93300576551755, "predator_policy": 12.538800556242318}, "policy_reward_max": {"prey_policy": 185.7428187916727, "predator_policy": 208.4426325398554}, "policy_reward_mean": {"prey_policy": 117.27665290546342, "predator_policy": 64.03518538854419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [355.54034486971295, 348.0836839862036, 357.6343599107675, 341.20943089701854, 358.93933849206604, 392.1108101990099, 355.37904669126664, 353.6461188835453, 368.53718685831853, 369.43084550706766, 359.7335424075076, 342.4722064124875, 318.5126583845672, 348.1263069210034, 307.9697715559554, 379.0100838208567, 364.67640940992254, 333.8557530806813, 380.5013734618533, 365.3627390999641, 340.69923269582546, 311.4278302367763, 334.2720116035187, 377.684631288673, 326.0545261975325, 341.18382091572164, 330.2764052270013, 336.46007658375385, 343.1748775511287, 377.9593931303882, 327.5636916080926, 345.25172823318854, 340.19018710831716, 364.59512097839263, 382.74690420199175, 364.1528469725875, 340.2223303601623, 344.45123190089095, 384.33946995451146, 397.237703858995, 270.42017162203103, 363.8041598546421, 371.77137970920313, 347.3442428027134, 403.7703767734174, 391.552768392511, 342.88896806938556, 400.9368884979527, 357.38874540600875, 356.21802802176217, 389.1853257629526, 328.0172279229716, 399.51496023913705, 396.0895465710888, 414.66097545483757, 319.2429968400858, 322.64333451400415, 327.1086137266115, 396.6475069373371, 371.7555983154732, 356.8169325071612, 372.0632980772207, 401.1517669685185, 380.5560871559701, 390.3157550594622, 382.898583378118, 351.9662244581254, 386.19866572488445, 326.0501425196077, 387.82908787345076, 343.23208444038795, 365.8557131514217, 396.1774561572627, 375.1158294086787, 393.61008365670796, 388.542203638691, 386.08031907056704, 368.4716742940432, 352.85664585397177, 371.65742928130476, 358.93443388725063, 339.5006286543687, 402.5600312558242, 300.10788601828534, 332.2996318829863, 391.22546748813505, 360.1751322828325, 392.07589270104023, 338.52356189290873, 396.47525756080154, 358.5551652754513, 371.1259082544669, 387.5763286106234, 339.91519680216805, 390.51034926660174, 397.26861742018707, 395.59522300736467, 393.24230177588885, 350.31091335277193, 407.30590184465444], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [142.60661145001615, 172.33192933551766, 140.7356933513732, 144.62320065841536, 149.12590001912588, 159.48181560715062, 102.28840450427397, 148.2084671761753, 131.69902186496455, 123.58244811437142, 140.1740934719318, 168.53512925465927, 180.31580239204018, 87.51155382229796, 66.40863550949666, 141.7760675668167, 87.03667226934182, 114.36815290736214, 147.39409530467663, 130.4703242497863, 169.26176511268082, 112.96462608051358, 47.72675879856561, 156.6208812450245, 92.71445415539854, 110.99222019989273, 146.81021419927674, 142.93151675527187, 102.0427522935305, 162.4397504984558, 96.19613940881445, 134.63072676881774, 148.70655176895002, 139.72156264691094, 130.72053339281555, 101.86953458434657, 163.94622298868867, 96.19085491010998, 104.20937839314763, 131.3340545339991, 90.16258605424812, 95.45257710612421, 89.26999682254227, 102.66839945281555, 139.41232736683762, 105.39235778145732, 149.59865052339748, 163.98228986943806, 81.77637222979843, 145.69541834329473, 121.7101291113193, 117.46266644499534, 120.40275032403079, 54.70783381144683, 120.30893835256965, 59.76112392574696, 97.26312781863709, 107.31481430757844, 147.90259710932992, 38.362646534936935, 113.17630089059301, 82.2823577064689, 95.46575840399075, 145.81896173888185, 105.5625147356449, 65.17325676294115, 117.22925417606768, 110.78198629063786, 61.72546828972441, 127.57293626908766, 129.74445307556073, -10.719119932212859, 141.83878126421854, 97.76346583326506, 92.55126674924158, 177.14332871489788, 136.84647491282237, 163.40489596641362, 139.78689922672078, 98.29200507901443, 58.50477838427121, 63.67319143274749, 146.73773069077458, 74.69217655594916, 142.34543594753953, 146.19998855030974, 114.98971943601502, 89.89526137218083, 105.5019876488804, 86.74581252496759, 79.85803200334884, 131.61503058444922, -11.406050947192645, 105.99077529593563, 63.746435990125924, 148.3280481885449, 136.42806146091215, 35.3715421001203, 176.4880355784983, 87.91754554357107, 160.27815125815226, 172.65405483636712, 82.89219772437755, 77.09918747510969, 129.33705408192887, 119.40146781861512, 130.29463823031202, 113.9146300868695, 176.73360596380041, 128.7192869916563, -95.93300576551755, 83.22663610636675, 64.53346625075989, 91.42942881284328, 94.57136861597105, 118.03324013659905, 175.58390940438616, 164.08759891879768, 139.9873784687844, 123.17798013156631, 143.61174491202596, 108.2252174421964, 89.86293481690659, 125.25431861125594, 95.46647129753524, 185.7428187916727, 114.0409670028219, 118.67290349352166, 163.49702981484998, 127.56118201759374, 142.18994848056275, 102.94911810460187, -62.01391075155053, 142.78775452621787, 138.1068921559211, 168.34349059493508, 116.2800578136522, 98.37228387351816, 179.1162174927816, 118.4102994747563, 107.17701123659194, 80.49630986537552, 7.6727836763737605, 129.895087705412, 130.972764727302, 163.70730034260845, 135.86176818211345, 124.18185456999636, 161.4711258935168, 49.20209793612494, 178.52179007636263, 117.0351586546918, 97.41160857611177, 135.19096470908013, 113.2470507570743, 163.90902524340916, 87.55257194780809, 107.58763794518165, 103.48595541577554, 91.74117147594572, 92.74881995790334, 104.65149013826013, 123.84899490283813, 118.2954364034305, 88.83113846942196, 173.57360635315345, 86.04623380331965, 80.81218103666876, 99.04863587530164, 95.88284350763651, 158.27046292583006, 152.7159095645598, 123.0021750354208, 57.85683572639643, 151.92414040110015, 84.17156797998362, 123.8152151302573, 90.23590014164303, 115.81114798334733, 156.12068695324325, 68.93533957594586, 79.55235599327253, 175.6057968764268, 148.29863908066642, 153.86419771053164, 107.85800405164784, 110.20393776259627, 118.52455427342942, 167.93657784067784, 151.95183849516772, 156.43196310679394, 174.95631877717187, 133.0439967568954, 130.6992293618814, 135.81410596573366, 165.28058382120295, 148.4568839483018, 141.30859315966865, 152.3058177059525, 109.4404647371462], "policy_predator_policy_reward": [13.195587971421508, 27.406216112757694, 12.538800556242318, 50.18598942017274, 18.864467561936188, 30.162176722554882, 21.982358137760865, 68.73020107880826, 60.6319874221934, 43.02588109053645, 45.44262373442876, 37.95896373798994, 39.31529958680318, 48.2363908901257, 92.70057249025628, 52.76084331697566, 92.84168324283205, 74.29067843878252, 35.7580940439191, 55.80833190868554, 41.964665786054105, 35.54248542825955, 41.9254352130755, 96.19913115582213, 58.83281256966105, 55.97317145961477, 12.814489875594843, 45.57008609085998, 12.69353510623929, 30.793733657729955, 90.70113970692844, 57.48207793629589, 39.32731017070188, 36.92098482335985, 56.9617833736141, 44.3039017299051, 60.81837963362671, 59.54591592942787, 91.77505668851447, 38.04424948430246, 90.11306343211349, 64.9710061033399, 13.058879259463316, 106.43055470195544, 61.4515723882744, 28.015754066949377, 22.491204310779036, 41.612486585058605, 67.63173741198811, 30.95099821245134, 36.57651955693147, 65.43450580247543, 100.03585627550378, 55.12996481601984, 58.608344023537065, 97.78167028190019, 76.91923148558361, 61.67770393933013, 127.00697994093734, 64.68716954518418, 67.69457641004496, 64.41045660098571, 38.645322737240576, 65.32168535307558, 103.88687131400681, 65.56754429572445, 106.82858129460207, 29.755299217084932, 82.89705922181975, 110.55144042135953, 150.1902638922339, 94.93724993700573, 67.64976513708551, 32.970318125593074, 39.70795710011902, 35.04867933663272, 64.85849629648807, 19.229602778787623, 84.13066155270066, 75.02813800055925, 80.45776317302759, 67.78443863198471, 70.1873713602085, 72.1868812477102, 52.542135125956534, 30.683820085397894, 44.56348752656281, 97.89577446795444, 107.54027889768273, 103.98229770188675, 102.07732732115485, 78.00237848355766, 96.38364124115114, 151.9206024794918, 121.21486586462471, 67.64753845465712, 74.79497115436997, 110.79417069060699, 45.51489952375126, 46.29754737594119, 21.15504052180442, 35.09807914662908, 106.61760885919132, 61.408233864292924, 70.1855390078946, 80.59089933069866, 88.45925503822178, 63.42102321568587, 63.95823000232996, 45.249852497050675, 123.50673395938108, 208.4426325398554, 103.82396105538076, 62.85647839502009, 35.32059882053743, 79.18340615350398, 42.52745845814891, 14.448540156004178, 47.16480562886807, 61.42543408625452, 58.540473938399735, 46.439496214539616, 77.74711092628954, 79.19893372276869, 79.29605745117868, 40.64641942813205, 104.18174525913733, 43.660471400488966, 42.49084597253178, 56.76669725448652, 88.88259348880548, 48.87692330414784, 152.68216181767778, 118.51021886578027, 45.301520758234695, 34.44676221579369, 78.6424747857849, 32.7553260466526, 28.926924253740495, 61.37564665217245, 82.84265690828268, 72.71610643013807, 53.85642561309788, 174.43141615653795, 59.278781342391426, 42.21860974496115, 63.28235311925403, 51.78985353731482, 103.31690485721711, 79.61995496984902, 54.140875040924676, 38.84437986671201, 115.29859532114025, 38.17915046423487, 48.14580322339286, 43.169795070167126, 61.99568208123574, 95.72075387974613, 93.15178413471318, 83.27851825487033, 100.49085449260554, 61.043269298481725, 30.563242527625476, 66.79295482047426, 69.18076515393788, 70.97452127931136, 49.094101353822644, 84.1553698244743, 77.70856853507077, 59.6595839649775, 43.556019954676955, 36.683075043068264, 107.57148132849348, 71.74464019252176, 68.02123806138363, 87.9589462585724, 61.21046352804991, 63.261983092958715, 69.23690974764239, 55.3065128765688, 113.67539892500596, 96.39207078122652, 28.818688693773833, 18.40278360359986, 72.40467109557356, 53.44945575287027, 43.89322312909125, 67.29348163705102, 41.041842558515434, 29.58009037224113, 44.562356354463276, 21.317979181757906, 64.59207804712204, 67.25991884146555, 37.5986174306776, 54.54899455827486, 15.024072384689621, 45.52136386011171, 80.31807565922537, 65.24154374233031]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5987221222155771, "mean_inference_ms": 1.5756125956403593, "mean_action_processing_ms": 0.23842368750447207, "mean_env_wait_ms": 0.22536840677418837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005517363548278809, "StateBufferConnector_ms": 0.005066394805908203, "ViewRequirementAgentConnector_ms": 0.11264288425445557}, "num_episodes": 23, "episode_return_max": 414.66097545483757, "episode_return_min": 270.42017162203103, "episode_return_mean": 362.62367658801514, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.33250850879944, "num_env_steps_trained_throughput_per_sec": 375.33250850879944, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 10081.285, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10081.23, "sample_time_ms": 1283.585, "learn_time_ms": 8782.06, "learn_throughput": 455.474, "synch_weights_time_ms": 12.557}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "e552a_00000", "date": "2024-08-16_08-48-10", "timestamp": 1723778290, "time_this_iter_s": 10.68981385231018, "time_total_s": 101.26481199264526, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72a5e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 101.26481199264526, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.466666666666665, "ram_util_percent": 83.51333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6157799798975545, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4709984090593125, "policy_loss": -0.008140270926536273, "vf_loss": 7.476390212931961, "vf_explained_var": -0.03415293744001439, "kl": 0.01832310921904026, "entropy": 1.4445831861445513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0902323241744725, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.17271533895422, "policy_loss": -0.0040576934186179955, "vf_loss": 9.173874225313702, "vf_explained_var": 0.0798457662264506, "kl": 0.014493917740600978, "entropy": 1.5473299628212338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 414.66097545483757, "episode_reward_min": 270.42017162203103, "episode_reward_mean": 362.96063823269293, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -95.93300576551755, "predator_policy": 3.787934564706241}, "policy_reward_max": {"prey_policy": 194.06949727460267, "predator_policy": 208.4426325398554}, "policy_reward_mean": {"prey_policy": 118.70655805241474, "predator_policy": 62.77376106393168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.5013734618533, 365.3627390999641, 340.69923269582546, 311.4278302367763, 334.2720116035187, 377.684631288673, 326.0545261975325, 341.18382091572164, 330.2764052270013, 336.46007658375385, 343.1748775511287, 377.9593931303882, 327.5636916080926, 345.25172823318854, 340.19018710831716, 364.59512097839263, 382.74690420199175, 364.1528469725875, 340.2223303601623, 344.45123190089095, 384.33946995451146, 397.237703858995, 270.42017162203103, 363.8041598546421, 371.77137970920313, 347.3442428027134, 403.7703767734174, 391.552768392511, 342.88896806938556, 400.9368884979527, 357.38874540600875, 356.21802802176217, 389.1853257629526, 328.0172279229716, 399.51496023913705, 396.0895465710888, 414.66097545483757, 319.2429968400858, 322.64333451400415, 327.1086137266115, 396.6475069373371, 371.7555983154732, 356.8169325071612, 372.0632980772207, 401.1517669685185, 380.5560871559701, 390.3157550594622, 382.898583378118, 351.9662244581254, 386.19866572488445, 326.0501425196077, 387.82908787345076, 343.23208444038795, 365.8557131514217, 396.1774561572627, 375.1158294086787, 393.61008365670796, 388.542203638691, 386.08031907056704, 368.4716742940432, 352.85664585397177, 371.65742928130476, 358.93443388725063, 339.5006286543687, 402.5600312558242, 300.10788601828534, 332.2996318829863, 391.22546748813505, 360.1751322828325, 392.07589270104023, 338.52356189290873, 396.47525756080154, 358.5551652754513, 371.1259082544669, 387.5763286106234, 339.91519680216805, 390.51034926660174, 397.26861742018707, 395.59522300736467, 393.24230177588885, 350.31091335277193, 407.30590184465444, 303.67462171444873, 336.7844540427726, 304.14552703060565, 404.6754394543951, 322.74976059170194, 388.7430652403104, 388.78821900112706, 389.61101926154424, 338.81051413762896, 374.1488377177584, 371.09664119046647, 378.04954276823673, 313.519808807569, 359.44079367319137, 381.40927945774354, 353.7560725230546, 338.3373000114343, 340.8231661317303], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.94622298868867, 96.19085491010998, 104.20937839314763, 131.3340545339991, 90.16258605424812, 95.45257710612421, 89.26999682254227, 102.66839945281555, 139.41232736683762, 105.39235778145732, 149.59865052339748, 163.98228986943806, 81.77637222979843, 145.69541834329473, 121.7101291113193, 117.46266644499534, 120.40275032403079, 54.70783381144683, 120.30893835256965, 59.76112392574696, 97.26312781863709, 107.31481430757844, 147.90259710932992, 38.362646534936935, 113.17630089059301, 82.2823577064689, 95.46575840399075, 145.81896173888185, 105.5625147356449, 65.17325676294115, 117.22925417606768, 110.78198629063786, 61.72546828972441, 127.57293626908766, 129.74445307556073, -10.719119932212859, 141.83878126421854, 97.76346583326506, 92.55126674924158, 177.14332871489788, 136.84647491282237, 163.40489596641362, 139.78689922672078, 98.29200507901443, 58.50477838427121, 63.67319143274749, 146.73773069077458, 74.69217655594916, 142.34543594753953, 146.19998855030974, 114.98971943601502, 89.89526137218083, 105.5019876488804, 86.74581252496759, 79.85803200334884, 131.61503058444922, -11.406050947192645, 105.99077529593563, 63.746435990125924, 148.3280481885449, 136.42806146091215, 35.3715421001203, 176.4880355784983, 87.91754554357107, 160.27815125815226, 172.65405483636712, 82.89219772437755, 77.09918747510969, 129.33705408192887, 119.40146781861512, 130.29463823031202, 113.9146300868695, 176.73360596380041, 128.7192869916563, -95.93300576551755, 83.22663610636675, 64.53346625075989, 91.42942881284328, 94.57136861597105, 118.03324013659905, 175.58390940438616, 164.08759891879768, 139.9873784687844, 123.17798013156631, 143.61174491202596, 108.2252174421964, 89.86293481690659, 125.25431861125594, 95.46647129753524, 185.7428187916727, 114.0409670028219, 118.67290349352166, 163.49702981484998, 127.56118201759374, 142.18994848056275, 102.94911810460187, -62.01391075155053, 142.78775452621787, 138.1068921559211, 168.34349059493508, 116.2800578136522, 98.37228387351816, 179.1162174927816, 118.4102994747563, 107.17701123659194, 80.49630986537552, 7.6727836763737605, 129.895087705412, 130.972764727302, 163.70730034260845, 135.86176818211345, 124.18185456999636, 161.4711258935168, 49.20209793612494, 178.52179007636263, 117.0351586546918, 97.41160857611177, 135.19096470908013, 113.2470507570743, 163.90902524340916, 87.55257194780809, 107.58763794518165, 103.48595541577554, 91.74117147594572, 92.74881995790334, 104.65149013826013, 123.84899490283813, 118.2954364034305, 88.83113846942196, 173.57360635315345, 86.04623380331965, 80.81218103666876, 99.04863587530164, 95.88284350763651, 158.27046292583006, 152.7159095645598, 123.0021750354208, 57.85683572639643, 151.92414040110015, 84.17156797998362, 123.8152151302573, 90.23590014164303, 115.81114798334733, 156.12068695324325, 68.93533957594586, 79.55235599327253, 175.6057968764268, 148.29863908066642, 153.86419771053164, 107.85800405164784, 110.20393776259627, 118.52455427342942, 167.93657784067784, 151.95183849516772, 156.43196310679394, 174.95631877717187, 133.0439967568954, 130.6992293618814, 135.81410596573366, 165.28058382120295, 148.4568839483018, 141.30859315966865, 152.3058177059525, 109.4404647371462, 108.98489868237354, 120.02407168380759, 149.0709839564787, 99.7337855292163, 153.27575920398056, 136.0726864560096, 178.81866627277032, 28.271557382900053, 127.39280508241241, 146.14170097949707, 173.94309996784943, 172.80387327854405, 174.6748158932243, 151.19070940273286, 144.9236349405662, 194.06949727460267, 156.60034302181873, 142.84234172221943, 177.71122769817217, 173.75165847526455, 132.79912978672664, 167.93307572965276, 38.648373816183806, 186.30839268123697, 21.973538865905276, 116.07904524819978, 184.2088841108262, 114.03838595949856, 120.17273352316445, 139.7941911872557, 68.85611118869815, 177.00575449696277, 144.54529903347114, 170.84561487111048, 162.32606447140287, 105.17232425458687], "policy_predator_policy_reward": [60.81837963362671, 59.54591592942787, 91.77505668851447, 38.04424948430246, 90.11306343211349, 64.9710061033399, 13.058879259463316, 106.43055470195544, 61.4515723882744, 28.015754066949377, 22.491204310779036, 41.612486585058605, 67.63173741198811, 30.95099821245134, 36.57651955693147, 65.43450580247543, 100.03585627550378, 55.12996481601984, 58.608344023537065, 97.78167028190019, 76.91923148558361, 61.67770393933013, 127.00697994093734, 64.68716954518418, 67.69457641004496, 64.41045660098571, 38.645322737240576, 65.32168535307558, 103.88687131400681, 65.56754429572445, 106.82858129460207, 29.755299217084932, 82.89705922181975, 110.55144042135953, 150.1902638922339, 94.93724993700573, 67.64976513708551, 32.970318125593074, 39.70795710011902, 35.04867933663272, 64.85849629648807, 19.229602778787623, 84.13066155270066, 75.02813800055925, 80.45776317302759, 67.78443863198471, 70.1873713602085, 72.1868812477102, 52.542135125956534, 30.683820085397894, 44.56348752656281, 97.89577446795444, 107.54027889768273, 103.98229770188675, 102.07732732115485, 78.00237848355766, 96.38364124115114, 151.9206024794918, 121.21486586462471, 67.64753845465712, 74.79497115436997, 110.79417069060699, 45.51489952375126, 46.29754737594119, 21.15504052180442, 35.09807914662908, 106.61760885919132, 61.408233864292924, 70.1855390078946, 80.59089933069866, 88.45925503822178, 63.42102321568587, 63.95823000232996, 45.249852497050675, 123.50673395938108, 208.4426325398554, 103.82396105538076, 62.85647839502009, 35.32059882053743, 79.18340615350398, 42.52745845814891, 14.448540156004178, 47.16480562886807, 61.42543408625452, 58.540473938399735, 46.439496214539616, 77.74711092628954, 79.19893372276869, 79.29605745117868, 40.64641942813205, 104.18174525913733, 43.660471400488966, 42.49084597253178, 56.76669725448652, 88.88259348880548, 48.87692330414784, 152.68216181767778, 118.51021886578027, 45.301520758234695, 34.44676221579369, 78.6424747857849, 32.7553260466526, 28.926924253740495, 61.37564665217245, 82.84265690828268, 72.71610643013807, 53.85642561309788, 174.43141615653795, 59.278781342391426, 42.21860974496115, 63.28235311925403, 51.78985353731482, 103.31690485721711, 79.61995496984902, 54.140875040924676, 38.84437986671201, 115.29859532114025, 38.17915046423487, 48.14580322339286, 43.169795070167126, 61.99568208123574, 95.72075387974613, 93.15178413471318, 83.27851825487033, 100.49085449260554, 61.043269298481725, 30.563242527625476, 66.79295482047426, 69.18076515393788, 70.97452127931136, 49.094101353822644, 84.1553698244743, 77.70856853507077, 59.6595839649775, 43.556019954676955, 36.683075043068264, 107.57148132849348, 71.74464019252176, 68.02123806138363, 87.9589462585724, 61.21046352804991, 63.261983092958715, 69.23690974764239, 55.3065128765688, 113.67539892500596, 96.39207078122652, 28.818688693773833, 18.40278360359986, 72.40467109557356, 53.44945575287027, 43.89322312909125, 67.29348163705102, 41.041842558515434, 29.58009037224113, 44.562356354463276, 21.317979181757906, 64.59207804712204, 67.25991884146555, 37.5986174306776, 54.54899455827486, 15.024072384689621, 45.52136386011171, 80.31807565922537, 65.24154374233031, 41.27390867532638, 33.39174267294112, 48.52380769455382, 39.45587686252352, 7.212607943907862, 7.584473426707617, 92.7524154446718, 104.8328003540529, 8.068415147640694, 41.1468393821518, 13.017730417473986, 28.97836157644304, 22.90240344848587, 40.02029025668414, 26.395815196703435, 24.22207184967202, 35.579894828884655, 3.787934564706241, 14.370405499851891, 8.31554604446993, 28.847284946780093, 41.51715072730705, 81.84575492734082, 71.24702134347486, 127.30965737631585, 48.157567317147816, 8.023393586229883, 53.17013001663653, 68.63994718335857, 52.802407563964714, 48.568397886666034, 59.32580895072782, 15.735045073497755, 7.211341033355347, 35.38730995760109, 37.93746744813968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5988317121265996, "mean_inference_ms": 1.5919823947379939, "mean_action_processing_ms": 0.23796083569941806, "mean_env_wait_ms": 0.22504803650846758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005700230598449707, "StateBufferConnector_ms": 0.0052214860916137695, "ViewRequirementAgentConnector_ms": 0.11768198013305664}, "num_episodes": 18, "episode_return_max": 414.66097545483757, "episode_return_min": 270.42017162203103, "episode_return_mean": 362.96063823269293, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.663332201364, "num_env_steps_trained_throughput_per_sec": 380.663332201364, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 10051.538, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10051.484, "sample_time_ms": 1251.502, "learn_time_ms": 8784.496, "learn_throughput": 455.348, "synch_weights_time_ms": 12.906}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "e552a_00000", "date": "2024-08-16_08-48-21", "timestamp": 1723778301, "time_this_iter_s": 10.54784607887268, "time_total_s": 111.81265807151794, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72deca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 111.81265807151794, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 31.273333333333333, "ram_util_percent": 83.60666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.217626991978398, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.179766449852595, "policy_loss": -0.004861408069227187, "vf_loss": 6.182509069341831, "vf_explained_var": -0.12181502867628027, "kl": 0.01412511524151014, "entropy": 1.4439348070709794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0285343819667423, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.280762702195101, "policy_loss": -0.002631766043810381, "vf_loss": 9.280884541910162, "vf_explained_var": 0.015947312211233473, "kl": 0.012549524774707789, "entropy": 1.5573569156505442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 414.66097545483757, "episode_reward_min": 270.42017162203103, "episode_reward_mean": 365.61358788514536, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -95.93300576551755, "predator_policy": 3.787934564706241}, "policy_reward_max": {"prey_policy": 194.06949727460267, "predator_policy": 208.4426325398554}, "policy_reward_mean": {"prey_policy": 126.9362972554698, "predator_policy": 55.87049668710291}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.2223303601623, 344.45123190089095, 384.33946995451146, 397.237703858995, 270.42017162203103, 363.8041598546421, 371.77137970920313, 347.3442428027134, 403.7703767734174, 391.552768392511, 342.88896806938556, 400.9368884979527, 357.38874540600875, 356.21802802176217, 389.1853257629526, 328.0172279229716, 399.51496023913705, 396.0895465710888, 414.66097545483757, 319.2429968400858, 322.64333451400415, 327.1086137266115, 396.6475069373371, 371.7555983154732, 356.8169325071612, 372.0632980772207, 401.1517669685185, 380.5560871559701, 390.3157550594622, 382.898583378118, 351.9662244581254, 386.19866572488445, 326.0501425196077, 387.82908787345076, 343.23208444038795, 365.8557131514217, 396.1774561572627, 375.1158294086787, 393.61008365670796, 388.542203638691, 386.08031907056704, 368.4716742940432, 352.85664585397177, 371.65742928130476, 358.93443388725063, 339.5006286543687, 402.5600312558242, 300.10788601828534, 332.2996318829863, 391.22546748813505, 360.1751322828325, 392.07589270104023, 338.52356189290873, 396.47525756080154, 358.5551652754513, 371.1259082544669, 387.5763286106234, 339.91519680216805, 390.51034926660174, 397.26861742018707, 395.59522300736467, 393.24230177588885, 350.31091335277193, 407.30590184465444, 303.67462171444873, 336.7844540427726, 304.14552703060565, 404.6754394543951, 322.74976059170194, 388.7430652403104, 388.78821900112706, 389.61101926154424, 338.81051413762896, 374.1488377177584, 371.09664119046647, 378.04954276823673, 313.519808807569, 359.44079367319137, 381.40927945774354, 353.7560725230546, 338.3373000114343, 340.8231661317303, 329.99690309728555, 373.3361287088413, 347.5766833980997, 310.1956486845741, 333.8932395077064, 376.8656047038604, 403.4063559199101, 388.27011876893334, 313.4297823875464, 338.7976988753496, 360.46169991796216, 397.2141710224405, 380.36641207407285, 374.59780708294034, 394.99668171958, 393.2969669850152, 370.81597579007575, 367.3344836957667], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.83878126421854, 97.76346583326506, 92.55126674924158, 177.14332871489788, 136.84647491282237, 163.40489596641362, 139.78689922672078, 98.29200507901443, 58.50477838427121, 63.67319143274749, 146.73773069077458, 74.69217655594916, 142.34543594753953, 146.19998855030974, 114.98971943601502, 89.89526137218083, 105.5019876488804, 86.74581252496759, 79.85803200334884, 131.61503058444922, -11.406050947192645, 105.99077529593563, 63.746435990125924, 148.3280481885449, 136.42806146091215, 35.3715421001203, 176.4880355784983, 87.91754554357107, 160.27815125815226, 172.65405483636712, 82.89219772437755, 77.09918747510969, 129.33705408192887, 119.40146781861512, 130.29463823031202, 113.9146300868695, 176.73360596380041, 128.7192869916563, -95.93300576551755, 83.22663610636675, 64.53346625075989, 91.42942881284328, 94.57136861597105, 118.03324013659905, 175.58390940438616, 164.08759891879768, 139.9873784687844, 123.17798013156631, 143.61174491202596, 108.2252174421964, 89.86293481690659, 125.25431861125594, 95.46647129753524, 185.7428187916727, 114.0409670028219, 118.67290349352166, 163.49702981484998, 127.56118201759374, 142.18994848056275, 102.94911810460187, -62.01391075155053, 142.78775452621787, 138.1068921559211, 168.34349059493508, 116.2800578136522, 98.37228387351816, 179.1162174927816, 118.4102994747563, 107.17701123659194, 80.49630986537552, 7.6727836763737605, 129.895087705412, 130.972764727302, 163.70730034260845, 135.86176818211345, 124.18185456999636, 161.4711258935168, 49.20209793612494, 178.52179007636263, 117.0351586546918, 97.41160857611177, 135.19096470908013, 113.2470507570743, 163.90902524340916, 87.55257194780809, 107.58763794518165, 103.48595541577554, 91.74117147594572, 92.74881995790334, 104.65149013826013, 123.84899490283813, 118.2954364034305, 88.83113846942196, 173.57360635315345, 86.04623380331965, 80.81218103666876, 99.04863587530164, 95.88284350763651, 158.27046292583006, 152.7159095645598, 123.0021750354208, 57.85683572639643, 151.92414040110015, 84.17156797998362, 123.8152151302573, 90.23590014164303, 115.81114798334733, 156.12068695324325, 68.93533957594586, 79.55235599327253, 175.6057968764268, 148.29863908066642, 153.86419771053164, 107.85800405164784, 110.20393776259627, 118.52455427342942, 167.93657784067784, 151.95183849516772, 156.43196310679394, 174.95631877717187, 133.0439967568954, 130.6992293618814, 135.81410596573366, 165.28058382120295, 148.4568839483018, 141.30859315966865, 152.3058177059525, 109.4404647371462, 108.98489868237354, 120.02407168380759, 149.0709839564787, 99.7337855292163, 153.27575920398056, 136.0726864560096, 178.81866627277032, 28.271557382900053, 127.39280508241241, 146.14170097949707, 173.94309996784943, 172.80387327854405, 174.6748158932243, 151.19070940273286, 144.9236349405662, 194.06949727460267, 156.60034302181873, 142.84234172221943, 177.71122769817217, 173.75165847526455, 132.79912978672664, 167.93307572965276, 38.648373816183806, 186.30839268123697, 21.973538865905276, 116.07904524819978, 184.2088841108262, 114.03838595949856, 120.17273352316445, 139.7941911872557, 68.85611118869815, 177.00575449696277, 144.54529903347114, 170.84561487111048, 162.32606447140287, 105.17232425458687, 121.92265908442693, 164.5031943382439, 161.87846143437312, 187.61237991165592, 83.69457569385665, 132.5976526971302, 124.27109497466395, 147.60990880625687, 66.98210840966578, 155.0187039029043, 139.9287991911661, 141.59886814330946, 152.61180972470908, 191.47416802087253, 183.37324800572748, 115.50544547205324, 100.53490916180901, 158.9227602527784, 132.47018854288743, 141.97536598799658, 118.96509777050873, 87.79944294651445, 187.9712202742188, 176.6278779600261, 184.5219038356817, 176.84921428240284, 184.88612269382236, 148.31025021422568, 182.38510923712943, 185.22824588030576, 188.63285940196945, 188.49999168917503, 167.01123741055872, 142.3665452216629, 151.48230660410672, 158.02635595608882], "policy_predator_policy_reward": [67.64976513708551, 32.970318125593074, 39.70795710011902, 35.04867933663272, 64.85849629648807, 19.229602778787623, 84.13066155270066, 75.02813800055925, 80.45776317302759, 67.78443863198471, 70.1873713602085, 72.1868812477102, 52.542135125956534, 30.683820085397894, 44.56348752656281, 97.89577446795444, 107.54027889768273, 103.98229770188675, 102.07732732115485, 78.00237848355766, 96.38364124115114, 151.9206024794918, 121.21486586462471, 67.64753845465712, 74.79497115436997, 110.79417069060699, 45.51489952375126, 46.29754737594119, 21.15504052180442, 35.09807914662908, 106.61760885919132, 61.408233864292924, 70.1855390078946, 80.59089933069866, 88.45925503822178, 63.42102321568587, 63.95823000232996, 45.249852497050675, 123.50673395938108, 208.4426325398554, 103.82396105538076, 62.85647839502009, 35.32059882053743, 79.18340615350398, 42.52745845814891, 14.448540156004178, 47.16480562886807, 61.42543408625452, 58.540473938399735, 46.439496214539616, 77.74711092628954, 79.19893372276869, 79.29605745117868, 40.64641942813205, 104.18174525913733, 43.660471400488966, 42.49084597253178, 56.76669725448652, 88.88259348880548, 48.87692330414784, 152.68216181767778, 118.51021886578027, 45.301520758234695, 34.44676221579369, 78.6424747857849, 32.7553260466526, 28.926924253740495, 61.37564665217245, 82.84265690828268, 72.71610643013807, 53.85642561309788, 174.43141615653795, 59.278781342391426, 42.21860974496115, 63.28235311925403, 51.78985353731482, 103.31690485721711, 79.61995496984902, 54.140875040924676, 38.84437986671201, 115.29859532114025, 38.17915046423487, 48.14580322339286, 43.169795070167126, 61.99568208123574, 95.72075387974613, 93.15178413471318, 83.27851825487033, 100.49085449260554, 61.043269298481725, 30.563242527625476, 66.79295482047426, 69.18076515393788, 70.97452127931136, 49.094101353822644, 84.1553698244743, 77.70856853507077, 59.6595839649775, 43.556019954676955, 36.683075043068264, 107.57148132849348, 71.74464019252176, 68.02123806138363, 87.9589462585724, 61.21046352804991, 63.261983092958715, 69.23690974764239, 55.3065128765688, 113.67539892500596, 96.39207078122652, 28.818688693773833, 18.40278360359986, 72.40467109557356, 53.44945575287027, 43.89322312909125, 67.29348163705102, 41.041842558515434, 29.58009037224113, 44.562356354463276, 21.317979181757906, 64.59207804712204, 67.25991884146555, 37.5986174306776, 54.54899455827486, 15.024072384689621, 45.52136386011171, 80.31807565922537, 65.24154374233031, 41.27390867532638, 33.39174267294112, 48.52380769455382, 39.45587686252352, 7.212607943907862, 7.584473426707617, 92.7524154446718, 104.8328003540529, 8.068415147640694, 41.1468393821518, 13.017730417473986, 28.97836157644304, 22.90240344848587, 40.02029025668414, 26.395815196703435, 24.22207184967202, 35.579894828884655, 3.787934564706241, 14.370405499851891, 8.31554604446993, 28.847284946780093, 41.51715072730705, 81.84575492734082, 71.24702134347486, 127.30965737631585, 48.157567317147816, 8.023393586229883, 53.17013001663653, 68.63994718335857, 52.802407563964714, 48.568397886666034, 59.32580895072782, 15.735045073497755, 7.211341033355347, 35.38730995760109, 37.93746744813968, 6.738621800524948, 36.832427874090094, 11.082228599839816, 12.763058762972474, 61.44385432490484, 69.84060068220805, 20.62918419588995, 17.685460707763426, 54.17712465334512, 57.715302541791296, 33.98604526948156, 61.351892099903125, 14.427997212050963, 44.89238096227765, 52.05061695406212, 37.34080833709027, 21.208719392352133, 32.763393580606945, 31.971620770435436, 32.38052357403025, 92.8164019352423, 60.88075726569683, 10.766973902982036, 21.848098885213542, 8.981096409101701, 10.01419754688663, 27.300479934947443, 14.100954239944885, 16.988741601809625, 10.394585000335123, 7.82079880675808, 8.343317087112686, 25.100029932075326, 36.33816322577878, 26.876972268844607, 30.948848866726575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5994191231070829, "mean_inference_ms": 1.6149998488389072, "mean_action_processing_ms": 0.2378656365840749, "mean_env_wait_ms": 0.224854674571084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005770087242126465, "StateBufferConnector_ms": 0.005272507667541504, "ViewRequirementAgentConnector_ms": 0.11878013610839844}, "num_episodes": 18, "episode_return_max": 414.66097545483757, "episode_return_min": 270.42017162203103, "episode_return_mean": 365.61358788514536, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.1281490729855, "num_env_steps_trained_throughput_per_sec": 367.1281490729855, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 10189.227, "restore_workers_time_ms": 0.019, "training_step_time_ms": 10189.176, "sample_time_ms": 1275.571, "learn_time_ms": 8897.537, "learn_throughput": 449.563, "synch_weights_time_ms": 13.29}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "e552a_00000", "date": "2024-08-16_08-48-32", "timestamp": 1723778312, "time_this_iter_s": 10.935297012329102, "time_total_s": 122.74795508384705, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a733e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.74795508384705, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 31.84375, "ram_util_percent": 83.58125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.778452487408169, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.709786021898664, "policy_loss": -0.006233386302159892, "vf_loss": 4.714528365488405, "vf_explained_var": -0.06618249488886072, "kl": 0.009940284173661232, "entropy": 1.4194095923787071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0447790557114534, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.191668180940013, "policy_loss": -0.00019858227229662358, "vf_loss": 9.189300429127204, "vf_explained_var": 0.024507673928346584, "kl": 0.012831772322940629, "entropy": 1.5589262720769044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 414.66097545483757, "episode_reward_min": 300.10788601828534, "episode_reward_mean": 365.9263736478881, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -95.93300576551755, "predator_policy": 2.457484930888055}, "policy_reward_max": {"prey_policy": 198.68596815729063, "predator_policy": 208.4426325398554}, "policy_reward_mean": {"prey_policy": 136.55356985136558, "predator_policy": 46.40961697257851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [414.66097545483757, 319.2429968400858, 322.64333451400415, 327.1086137266115, 396.6475069373371, 371.7555983154732, 356.8169325071612, 372.0632980772207, 401.1517669685185, 380.5560871559701, 390.3157550594622, 382.898583378118, 351.9662244581254, 386.19866572488445, 326.0501425196077, 387.82908787345076, 343.23208444038795, 365.8557131514217, 396.1774561572627, 375.1158294086787, 393.61008365670796, 388.542203638691, 386.08031907056704, 368.4716742940432, 352.85664585397177, 371.65742928130476, 358.93443388725063, 339.5006286543687, 402.5600312558242, 300.10788601828534, 332.2996318829863, 391.22546748813505, 360.1751322828325, 392.07589270104023, 338.52356189290873, 396.47525756080154, 358.5551652754513, 371.1259082544669, 387.5763286106234, 339.91519680216805, 390.51034926660174, 397.26861742018707, 395.59522300736467, 393.24230177588885, 350.31091335277193, 407.30590184465444, 303.67462171444873, 336.7844540427726, 304.14552703060565, 404.6754394543951, 322.74976059170194, 388.7430652403104, 388.78821900112706, 389.61101926154424, 338.81051413762896, 374.1488377177584, 371.09664119046647, 378.04954276823673, 313.519808807569, 359.44079367319137, 381.40927945774354, 353.7560725230546, 338.3373000114343, 340.8231661317303, 329.99690309728555, 373.3361287088413, 347.5766833980997, 310.1956486845741, 333.8932395077064, 376.8656047038604, 403.4063559199101, 388.27011876893334, 313.4297823875464, 338.7976988753496, 360.46169991796216, 397.2141710224405, 380.36641207407285, 374.59780708294034, 394.99668171958, 393.2969669850152, 370.81597579007575, 367.3344836957667, 366.0271198601247, 380.4572382394741, 355.9208504584758, 399.44562594251994, 352.3339208162569, 383.3911852959663, 377.04739858080444, 344.55999999999983, 384.7731628328413, 364.5497313157461, 373.3304818364425, 374.1226188886727, 379.1177097048922, 384.7004834123193, 377.13570329258545, 339.9332952496585, 329.0796592293422, 350.5059170384948], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.73360596380041, 128.7192869916563, -95.93300576551755, 83.22663610636675, 64.53346625075989, 91.42942881284328, 94.57136861597105, 118.03324013659905, 175.58390940438616, 164.08759891879768, 139.9873784687844, 123.17798013156631, 143.61174491202596, 108.2252174421964, 89.86293481690659, 125.25431861125594, 95.46647129753524, 185.7428187916727, 114.0409670028219, 118.67290349352166, 163.49702981484998, 127.56118201759374, 142.18994848056275, 102.94911810460187, -62.01391075155053, 142.78775452621787, 138.1068921559211, 168.34349059493508, 116.2800578136522, 98.37228387351816, 179.1162174927816, 118.4102994747563, 107.17701123659194, 80.49630986537552, 7.6727836763737605, 129.895087705412, 130.972764727302, 163.70730034260845, 135.86176818211345, 124.18185456999636, 161.4711258935168, 49.20209793612494, 178.52179007636263, 117.0351586546918, 97.41160857611177, 135.19096470908013, 113.2470507570743, 163.90902524340916, 87.55257194780809, 107.58763794518165, 103.48595541577554, 91.74117147594572, 92.74881995790334, 104.65149013826013, 123.84899490283813, 118.2954364034305, 88.83113846942196, 173.57360635315345, 86.04623380331965, 80.81218103666876, 99.04863587530164, 95.88284350763651, 158.27046292583006, 152.7159095645598, 123.0021750354208, 57.85683572639643, 151.92414040110015, 84.17156797998362, 123.8152151302573, 90.23590014164303, 115.81114798334733, 156.12068695324325, 68.93533957594586, 79.55235599327253, 175.6057968764268, 148.29863908066642, 153.86419771053164, 107.85800405164784, 110.20393776259627, 118.52455427342942, 167.93657784067784, 151.95183849516772, 156.43196310679394, 174.95631877717187, 133.0439967568954, 130.6992293618814, 135.81410596573366, 165.28058382120295, 148.4568839483018, 141.30859315966865, 152.3058177059525, 109.4404647371462, 108.98489868237354, 120.02407168380759, 149.0709839564787, 99.7337855292163, 153.27575920398056, 136.0726864560096, 178.81866627277032, 28.271557382900053, 127.39280508241241, 146.14170097949707, 173.94309996784943, 172.80387327854405, 174.6748158932243, 151.19070940273286, 144.9236349405662, 194.06949727460267, 156.60034302181873, 142.84234172221943, 177.71122769817217, 173.75165847526455, 132.79912978672664, 167.93307572965276, 38.648373816183806, 186.30839268123697, 21.973538865905276, 116.07904524819978, 184.2088841108262, 114.03838595949856, 120.17273352316445, 139.7941911872557, 68.85611118869815, 177.00575449696277, 144.54529903347114, 170.84561487111048, 162.32606447140287, 105.17232425458687, 121.92265908442693, 164.5031943382439, 161.87846143437312, 187.61237991165592, 83.69457569385665, 132.5976526971302, 124.27109497466395, 147.60990880625687, 66.98210840966578, 155.0187039029043, 139.9287991911661, 141.59886814330946, 152.61180972470908, 191.47416802087253, 183.37324800572748, 115.50544547205324, 100.53490916180901, 158.9227602527784, 132.47018854288743, 141.97536598799658, 118.96509777050873, 87.79944294651445, 187.9712202742188, 176.6278779600261, 184.5219038356817, 176.84921428240284, 184.88612269382236, 148.31025021422568, 182.38510923712943, 185.22824588030576, 188.63285940196945, 188.49999168917503, 167.01123741055872, 142.3665452216629, 151.48230660410672, 158.02635595608882, 173.8778956439356, 175.99477149335468, 164.37171530264192, 159.02413997876613, 133.36655838978538, 143.05000639946672, 186.42545691368161, 194.00754667645447, 187.54527551618693, 142.50506125871212, 197.4413564042717, 167.70353957484735, 171.70572918446481, 179.8965778102392, 146.37592662735327, 191.03313061731686, 156.82934232492948, 189.23933121664965, 154.13815468174434, 171.45621951035483, 177.42504854835806, 177.7264204316059, 151.36797496361774, 177.46080199194517, 177.01193884445274, 169.58111108722667, 180.84432555809443, 173.5687836239712, 198.68596815729063, 104.82618824228963, 118.87005867578304, 186.08468062927955, 135.32357201696811, 162.43943555162403, 151.509249155565, 111.86326377620587], "policy_predator_policy_reward": [63.95823000232996, 45.249852497050675, 123.50673395938108, 208.4426325398554, 103.82396105538076, 62.85647839502009, 35.32059882053743, 79.18340615350398, 42.52745845814891, 14.448540156004178, 47.16480562886807, 61.42543408625452, 58.540473938399735, 46.439496214539616, 77.74711092628954, 79.19893372276869, 79.29605745117868, 40.64641942813205, 104.18174525913733, 43.660471400488966, 42.49084597253178, 56.76669725448652, 88.88259348880548, 48.87692330414784, 152.68216181767778, 118.51021886578027, 45.301520758234695, 34.44676221579369, 78.6424747857849, 32.7553260466526, 28.926924253740495, 61.37564665217245, 82.84265690828268, 72.71610643013807, 53.85642561309788, 174.43141615653795, 59.278781342391426, 42.21860974496115, 63.28235311925403, 51.78985353731482, 103.31690485721711, 79.61995496984902, 54.140875040924676, 38.84437986671201, 115.29859532114025, 38.17915046423487, 48.14580322339286, 43.169795070167126, 61.99568208123574, 95.72075387974613, 93.15178413471318, 83.27851825487033, 100.49085449260554, 61.043269298481725, 30.563242527625476, 66.79295482047426, 69.18076515393788, 70.97452127931136, 49.094101353822644, 84.1553698244743, 77.70856853507077, 59.6595839649775, 43.556019954676955, 36.683075043068264, 107.57148132849348, 71.74464019252176, 68.02123806138363, 87.9589462585724, 61.21046352804991, 63.261983092958715, 69.23690974764239, 55.3065128765688, 113.67539892500596, 96.39207078122652, 28.818688693773833, 18.40278360359986, 72.40467109557356, 53.44945575287027, 43.89322312909125, 67.29348163705102, 41.041842558515434, 29.58009037224113, 44.562356354463276, 21.317979181757906, 64.59207804712204, 67.25991884146555, 37.5986174306776, 54.54899455827486, 15.024072384689621, 45.52136386011171, 80.31807565922537, 65.24154374233031, 41.27390867532638, 33.39174267294112, 48.52380769455382, 39.45587686252352, 7.212607943907862, 7.584473426707617, 92.7524154446718, 104.8328003540529, 8.068415147640694, 41.1468393821518, 13.017730417473986, 28.97836157644304, 22.90240344848587, 40.02029025668414, 26.395815196703435, 24.22207184967202, 35.579894828884655, 3.787934564706241, 14.370405499851891, 8.31554604446993, 28.847284946780093, 41.51715072730705, 81.84575492734082, 71.24702134347486, 127.30965737631585, 48.157567317147816, 8.023393586229883, 53.17013001663653, 68.63994718335857, 52.802407563964714, 48.568397886666034, 59.32580895072782, 15.735045073497755, 7.211341033355347, 35.38730995760109, 37.93746744813968, 6.738621800524948, 36.832427874090094, 11.082228599839816, 12.763058762972474, 61.44385432490484, 69.84060068220805, 20.62918419588995, 17.685460707763426, 54.17712465334512, 57.715302541791296, 33.98604526948156, 61.351892099903125, 14.427997212050963, 44.89238096227765, 52.05061695406212, 37.34080833709027, 21.208719392352133, 32.763393580606945, 31.971620770435436, 32.38052357403025, 92.8164019352423, 60.88075726569683, 10.766973902982036, 21.848098885213542, 8.981096409101701, 10.01419754688663, 27.300479934947443, 14.100954239944885, 16.988741601809625, 10.394585000335123, 7.82079880675808, 8.343317087112686, 25.100029932075326, 36.33816322577878, 26.876972268844607, 30.948848866726575, 9.07411822472234, 7.0803344981121334, 13.81293693617463, 43.248446021891525, 53.343375843535924, 26.1609098256878, 9.551051983057352, 9.461570369326552, 12.382639366306883, 9.90094467505097, 4.7433782549986825, 13.502911061848595, 12.392394046129862, 13.052697539970728, 2.457484930888055, 4.693457824441771, 25.63895109762322, 13.065538193638877, 12.615006875776688, 26.340350247870216, 11.334971222608132, 6.844041633870488, 30.179658687173344, 15.114183245936495, 26.135802165432597, 6.3888576077804204, 14.029679729689773, 16.257694500563925, 49.70782099379423, 23.915725899211154, 27.47881707464819, 7.499738869948255, 13.805097237512049, 17.51155442323821, 35.0853552592027, 52.04804884752132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5995357705159761, "mean_inference_ms": 1.6428144375720524, "mean_action_processing_ms": 0.2377345403271569, "mean_env_wait_ms": 0.22430435922357858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005844712257385254, "StateBufferConnector_ms": 0.005340933799743652, "ViewRequirementAgentConnector_ms": 0.11932694911956787}, "num_episodes": 18, "episode_return_max": 414.66097545483757, "episode_return_min": 300.10788601828534, "episode_return_mean": 365.9263736478881, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.2889996017733, "num_env_steps_trained_throughput_per_sec": 365.2889996017733, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 10308.679, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10308.628, "sample_time_ms": 1299.346, "learn_time_ms": 8993.01, "learn_throughput": 444.79, "synch_weights_time_ms": 13.5}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "e552a_00000", "date": "2024-08-16_08-48-43", "timestamp": 1723778323, "time_this_iter_s": 10.997552871704102, "time_total_s": 133.74550795555115, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a73470d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 133.74550795555115, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 32.21333333333334, "ram_util_percent": 83.72666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9084690424815687, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.824180436386633, "policy_loss": -0.005397284008000815, "vf_loss": 2.8281981612639453, "vf_explained_var": 0.03608694442365536, "kl": 0.009197083373907879, "entropy": 1.4043423072370902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2528479995235564, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.974666718578844, "policy_loss": -0.005144291750042054, "vf_loss": 8.97791135197594, "vf_explained_var": 0.07731504247932838, "kl": 0.009498334761356432, "entropy": 1.5338883773990408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 407.30590184465444, "episode_reward_min": 268.3299999999999, "episode_reward_mean": 363.9768426745944, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 21.973538865905276, "predator_policy": 2.457484930888055}, "policy_reward_max": {"prey_policy": 198.68596815729063, "predator_policy": 127.30965737631585}, "policy_reward_mean": {"prey_policy": 150.08651489693025, "predator_policy": 31.901906440366947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.5006286543687, 402.5600312558242, 300.10788601828534, 332.2996318829863, 391.22546748813505, 360.1751322828325, 392.07589270104023, 338.52356189290873, 396.47525756080154, 358.5551652754513, 371.1259082544669, 387.5763286106234, 339.91519680216805, 390.51034926660174, 397.26861742018707, 395.59522300736467, 393.24230177588885, 350.31091335277193, 407.30590184465444, 303.67462171444873, 336.7844540427726, 304.14552703060565, 404.6754394543951, 322.74976059170194, 388.7430652403104, 388.78821900112706, 389.61101926154424, 338.81051413762896, 374.1488377177584, 371.09664119046647, 378.04954276823673, 313.519808807569, 359.44079367319137, 381.40927945774354, 353.7560725230546, 338.3373000114343, 340.8231661317303, 329.99690309728555, 373.3361287088413, 347.5766833980997, 310.1956486845741, 333.8932395077064, 376.8656047038604, 403.4063559199101, 388.27011876893334, 313.4297823875464, 338.7976988753496, 360.46169991796216, 397.2141710224405, 380.36641207407285, 374.59780708294034, 394.99668171958, 393.2969669850152, 370.81597579007575, 367.3344836957667, 366.0271198601247, 380.4572382394741, 355.9208504584758, 399.44562594251994, 352.3339208162569, 383.3911852959663, 377.04739858080444, 344.55999999999983, 384.7731628328413, 364.5497313157461, 373.3304818364425, 374.1226188886727, 379.1177097048922, 384.7004834123193, 377.13570329258545, 339.9332952496585, 329.0796592293422, 350.5059170384948, 337.54473054884204, 393.3506772023811, 380.67268709856177, 350.7401083611064, 328.72840712733847, 374.65354671394175, 402.2038567138264, 368.0662196501484, 364.77640165777143, 387.42383680429157, 350.9560008049559, 381.94272145116724, 362.0951012354898, 384.34244785008843, 367.10422121071593, 386.8912466475782, 268.3299999999999, 365.8143198798777, 340.15017407443645, 328.49855593591656, 361.7447140667771, 361.7752713749242, 340.3207329220072, 373.0948752687995, 377.73560484201556, 382.4194634993762, 372.1104220794426], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.84899490283813, 118.2954364034305, 88.83113846942196, 173.57360635315345, 86.04623380331965, 80.81218103666876, 99.04863587530164, 95.88284350763651, 158.27046292583006, 152.7159095645598, 123.0021750354208, 57.85683572639643, 151.92414040110015, 84.17156797998362, 123.8152151302573, 90.23590014164303, 115.81114798334733, 156.12068695324325, 68.93533957594586, 79.55235599327253, 175.6057968764268, 148.29863908066642, 153.86419771053164, 107.85800405164784, 110.20393776259627, 118.52455427342942, 167.93657784067784, 151.95183849516772, 156.43196310679394, 174.95631877717187, 133.0439967568954, 130.6992293618814, 135.81410596573366, 165.28058382120295, 148.4568839483018, 141.30859315966865, 152.3058177059525, 109.4404647371462, 108.98489868237354, 120.02407168380759, 149.0709839564787, 99.7337855292163, 153.27575920398056, 136.0726864560096, 178.81866627277032, 28.271557382900053, 127.39280508241241, 146.14170097949707, 173.94309996784943, 172.80387327854405, 174.6748158932243, 151.19070940273286, 144.9236349405662, 194.06949727460267, 156.60034302181873, 142.84234172221943, 177.71122769817217, 173.75165847526455, 132.79912978672664, 167.93307572965276, 38.648373816183806, 186.30839268123697, 21.973538865905276, 116.07904524819978, 184.2088841108262, 114.03838595949856, 120.17273352316445, 139.7941911872557, 68.85611118869815, 177.00575449696277, 144.54529903347114, 170.84561487111048, 162.32606447140287, 105.17232425458687, 121.92265908442693, 164.5031943382439, 161.87846143437312, 187.61237991165592, 83.69457569385665, 132.5976526971302, 124.27109497466395, 147.60990880625687, 66.98210840966578, 155.0187039029043, 139.9287991911661, 141.59886814330946, 152.61180972470908, 191.47416802087253, 183.37324800572748, 115.50544547205324, 100.53490916180901, 158.9227602527784, 132.47018854288743, 141.97536598799658, 118.96509777050873, 87.79944294651445, 187.9712202742188, 176.6278779600261, 184.5219038356817, 176.84921428240284, 184.88612269382236, 148.31025021422568, 182.38510923712943, 185.22824588030576, 188.63285940196945, 188.49999168917503, 167.01123741055872, 142.3665452216629, 151.48230660410672, 158.02635595608882, 173.8778956439356, 175.99477149335468, 164.37171530264192, 159.02413997876613, 133.36655838978538, 143.05000639946672, 186.42545691368161, 194.00754667645447, 187.54527551618693, 142.50506125871212, 197.4413564042717, 167.70353957484735, 171.70572918446481, 179.8965778102392, 146.37592662735327, 191.03313061731686, 156.82934232492948, 189.23933121664965, 154.13815468174434, 171.45621951035483, 177.42504854835806, 177.7264204316059, 151.36797496361774, 177.46080199194517, 177.01193884445274, 169.58111108722667, 180.84432555809443, 173.5687836239712, 198.68596815729063, 104.82618824228963, 118.87005867578304, 186.08468062927955, 135.32357201696811, 162.43943555162403, 151.509249155565, 111.86326377620587, 130.93724361021094, 174.5225929158914, 169.69934623377898, 187.34115839430189, 135.59180782113475, 184.09273887848127, 146.30518010992927, 195.08801188472881, 109.76183681237728, 174.101503723565, 159.3532020782932, 180.58924764176294, 178.89377104151032, 178.9635207971892, 135.56354410581798, 168.13644088839223, 152.2844512860475, 167.86372537304962, 184.5766771503727, 167.75584006741335, 164.45297319005329, 174.09914779596014, 170.90101940790137, 190.63489786262946, 179.89012213686246, 154.8667277513236, 168.95228722424827, 185.76065506270405, 169.03526347787403, 173.07509934395375, 179.99076158366498, 185.18978469388145, 146.88293452655824, 104.74900289672091, 159.4774917895504, 184.41281364216115, 128.37045852463882, 168.04269443993877, 150.49999999999994, 148.89440442596583, 192.1613078947718, 138.5743068041897, 194.22892947717614, 134.77091281024707, 135.57789165701305, 170.62402027958012, 186.70032242194804, 166.0895700141762, 186.12337681277364, 169.8822975823197, 152.26505783255584, 157.9692848502554, 164.65701556721237, 151.71431755268628], "policy_predator_policy_reward": [30.563242527625476, 66.79295482047426, 69.18076515393788, 70.97452127931136, 49.094101353822644, 84.1553698244743, 77.70856853507077, 59.6595839649775, 43.556019954676955, 36.683075043068264, 107.57148132849348, 71.74464019252176, 68.02123806138363, 87.9589462585724, 61.21046352804991, 63.261983092958715, 69.23690974764239, 55.3065128765688, 113.67539892500596, 96.39207078122652, 28.818688693773833, 18.40278360359986, 72.40467109557356, 53.44945575287027, 43.89322312909125, 67.29348163705102, 41.041842558515434, 29.58009037224113, 44.562356354463276, 21.317979181757906, 64.59207804712204, 67.25991884146555, 37.5986174306776, 54.54899455827486, 15.024072384689621, 45.52136386011171, 80.31807565922537, 65.24154374233031, 41.27390867532638, 33.39174267294112, 48.52380769455382, 39.45587686252352, 7.212607943907862, 7.584473426707617, 92.7524154446718, 104.8328003540529, 8.068415147640694, 41.1468393821518, 13.017730417473986, 28.97836157644304, 22.90240344848587, 40.02029025668414, 26.395815196703435, 24.22207184967202, 35.579894828884655, 3.787934564706241, 14.370405499851891, 8.31554604446993, 28.847284946780093, 41.51715072730705, 81.84575492734082, 71.24702134347486, 127.30965737631585, 48.157567317147816, 8.023393586229883, 53.17013001663653, 68.63994718335857, 52.802407563964714, 48.568397886666034, 59.32580895072782, 15.735045073497755, 7.211341033355347, 35.38730995760109, 37.93746744813968, 6.738621800524948, 36.832427874090094, 11.082228599839816, 12.763058762972474, 61.44385432490484, 69.84060068220805, 20.62918419588995, 17.685460707763426, 54.17712465334512, 57.715302541791296, 33.98604526948156, 61.351892099903125, 14.427997212050963, 44.89238096227765, 52.05061695406212, 37.34080833709027, 21.208719392352133, 32.763393580606945, 31.971620770435436, 32.38052357403025, 92.8164019352423, 60.88075726569683, 10.766973902982036, 21.848098885213542, 8.981096409101701, 10.01419754688663, 27.300479934947443, 14.100954239944885, 16.988741601809625, 10.394585000335123, 7.82079880675808, 8.343317087112686, 25.100029932075326, 36.33816322577878, 26.876972268844607, 30.948848866726575, 9.07411822472234, 7.0803344981121334, 13.81293693617463, 43.248446021891525, 53.343375843535924, 26.1609098256878, 9.551051983057352, 9.461570369326552, 12.382639366306883, 9.90094467505097, 4.7433782549986825, 13.502911061848595, 12.392394046129862, 13.052697539970728, 2.457484930888055, 4.693457824441771, 25.63895109762322, 13.065538193638877, 12.615006875776688, 26.340350247870216, 11.334971222608132, 6.844041633870488, 30.179658687173344, 15.114183245936495, 26.135802165432597, 6.3888576077804204, 14.029679729689773, 16.257694500563925, 49.70782099379423, 23.915725899211154, 27.47881707464819, 7.499738869948255, 13.805097237512049, 17.51155442323821, 35.0853552592027, 52.04804884752132, 15.822698190086028, 16.262195832653795, 18.946538354202758, 17.36363422009742, 40.82199419745255, 20.166146201493312, 5.820520042536739, 3.5263963239116562, 25.60881650845921, 19.256250082936784, 18.02580524119304, 16.685291752692613, 22.595660570478465, 21.750904304648465, 44.40877192035495, 19.957462735583455, 9.532496708171292, 35.095728290503075, 12.492992103680615, 22.598327482824857, 2.7626351635993958, 9.641244655343458, 5.16516161683224, 15.241642563804183, 5.567104286109806, 21.771147061194384, 17.120668811574138, 12.508836751561942, 12.660897367742685, 12.332961021145495, 12.338587072739541, 9.372113297292271, 12.52706547344175, 4.170997103279113, 13.23967155191604, 8.684342896250074, 20.467709315868714, 23.269311793990283, 11.285739849090195, 17.818411660860466, 13.134479255026724, 17.874620112788776, 5.094260114582503, 27.681168972918623, 18.26590033702591, 15.852920648388059, 4.489676706645638, 15.81530612602968, 8.987202726645936, 12.74272772027631, 44.91429602284723, 27.27082479371797, 28.140486152288183, 27.598602807255936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6001385265235915, "mean_inference_ms": 1.6769784661592968, "mean_action_processing_ms": 0.23773267357638428, "mean_env_wait_ms": 0.22371241466264435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005824923515319824, "StateBufferConnector_ms": 0.005406618118286133, "ViewRequirementAgentConnector_ms": 0.11907851696014404}, "num_episodes": 27, "episode_return_max": 407.30590184465444, "episode_return_min": 268.3299999999999, "episode_return_mean": 363.9768426745944, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.1522862491071, "num_env_steps_trained_throughput_per_sec": 374.1522862491071, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 10407.157, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10407.113, "sample_time_ms": 1323.66, "learn_time_ms": 9067.048, "learn_throughput": 441.158, "synch_weights_time_ms": 13.704}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "e552a_00000", "date": "2024-08-16_08-48-53", "timestamp": 1723778333, "time_this_iter_s": 10.737852334976196, "time_total_s": 144.48336029052734, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72953a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 144.48336029052734, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 29.368750000000002, "ram_util_percent": 83.65625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.176990308837285, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.267258957201842, "policy_loss": -0.012103009053257112, "vf_loss": 2.2767611334563562, "vf_explained_var": 0.1682876877683811, "kl": 0.017338892245292774, "entropy": 1.43238318338596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.49648499594479, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.85387296903701, "policy_loss": -0.001056349539646396, "vf_loss": 8.852672507018639, "vf_explained_var": 0.06543633404862943, "kl": 0.011284107189646465, "entropy": 1.5278651847410454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 407.30590184465444, "episode_reward_min": 268.3299999999999, "episode_reward_mean": 364.46648097141735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 21.973538865905276, "predator_policy": 2.457484930888055}, "policy_reward_max": {"prey_policy": 198.68596815729063, "predator_policy": 127.30965737631585}, "policy_reward_mean": {"prey_policy": 157.81059651352723, "predator_policy": 24.42264397218139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.30590184465444, 303.67462171444873, 336.7844540427726, 304.14552703060565, 404.6754394543951, 322.74976059170194, 388.7430652403104, 388.78821900112706, 389.61101926154424, 338.81051413762896, 374.1488377177584, 371.09664119046647, 378.04954276823673, 313.519808807569, 359.44079367319137, 381.40927945774354, 353.7560725230546, 338.3373000114343, 340.8231661317303, 329.99690309728555, 373.3361287088413, 347.5766833980997, 310.1956486845741, 333.8932395077064, 376.8656047038604, 403.4063559199101, 388.27011876893334, 313.4297823875464, 338.7976988753496, 360.46169991796216, 397.2141710224405, 380.36641207407285, 374.59780708294034, 394.99668171958, 393.2969669850152, 370.81597579007575, 367.3344836957667, 366.0271198601247, 380.4572382394741, 355.9208504584758, 399.44562594251994, 352.3339208162569, 383.3911852959663, 377.04739858080444, 344.55999999999983, 384.7731628328413, 364.5497313157461, 373.3304818364425, 374.1226188886727, 379.1177097048922, 384.7004834123193, 377.13570329258545, 339.9332952496585, 329.0796592293422, 350.5059170384948, 337.54473054884204, 393.3506772023811, 380.67268709856177, 350.7401083611064, 328.72840712733847, 374.65354671394175, 402.2038567138264, 368.0662196501484, 364.77640165777143, 387.42383680429157, 350.9560008049559, 381.94272145116724, 362.0951012354898, 384.34244785008843, 367.10422121071593, 386.8912466475782, 268.3299999999999, 365.8143198798777, 340.15017407443645, 328.49855593591656, 361.7447140667771, 361.7752713749242, 340.3207329220072, 373.0948752687995, 377.73560484201556, 382.4194634993762, 372.1104220794426, 390.8272486532573, 374.7684676634022, 366.0284800398506, 341.4113660647583, 370.97337865085206, 337.8622846392072, 389.6382379540496, 349.4345115124075, 363.03545617109984, 393.05524796769737, 393.9288506768143, 374.0799489211669, 381.57106042189406, 334.4085987205366, 358.167339722579, 398.28316882829364, 384.7347988578173, 383.7988777193076], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.3058177059525, 109.4404647371462, 108.98489868237354, 120.02407168380759, 149.0709839564787, 99.7337855292163, 153.27575920398056, 136.0726864560096, 178.81866627277032, 28.271557382900053, 127.39280508241241, 146.14170097949707, 173.94309996784943, 172.80387327854405, 174.6748158932243, 151.19070940273286, 144.9236349405662, 194.06949727460267, 156.60034302181873, 142.84234172221943, 177.71122769817217, 173.75165847526455, 132.79912978672664, 167.93307572965276, 38.648373816183806, 186.30839268123697, 21.973538865905276, 116.07904524819978, 184.2088841108262, 114.03838595949856, 120.17273352316445, 139.7941911872557, 68.85611118869815, 177.00575449696277, 144.54529903347114, 170.84561487111048, 162.32606447140287, 105.17232425458687, 121.92265908442693, 164.5031943382439, 161.87846143437312, 187.61237991165592, 83.69457569385665, 132.5976526971302, 124.27109497466395, 147.60990880625687, 66.98210840966578, 155.0187039029043, 139.9287991911661, 141.59886814330946, 152.61180972470908, 191.47416802087253, 183.37324800572748, 115.50544547205324, 100.53490916180901, 158.9227602527784, 132.47018854288743, 141.97536598799658, 118.96509777050873, 87.79944294651445, 187.9712202742188, 176.6278779600261, 184.5219038356817, 176.84921428240284, 184.88612269382236, 148.31025021422568, 182.38510923712943, 185.22824588030576, 188.63285940196945, 188.49999168917503, 167.01123741055872, 142.3665452216629, 151.48230660410672, 158.02635595608882, 173.8778956439356, 175.99477149335468, 164.37171530264192, 159.02413997876613, 133.36655838978538, 143.05000639946672, 186.42545691368161, 194.00754667645447, 187.54527551618693, 142.50506125871212, 197.4413564042717, 167.70353957484735, 171.70572918446481, 179.8965778102392, 146.37592662735327, 191.03313061731686, 156.82934232492948, 189.23933121664965, 154.13815468174434, 171.45621951035483, 177.42504854835806, 177.7264204316059, 151.36797496361774, 177.46080199194517, 177.01193884445274, 169.58111108722667, 180.84432555809443, 173.5687836239712, 198.68596815729063, 104.82618824228963, 118.87005867578304, 186.08468062927955, 135.32357201696811, 162.43943555162403, 151.509249155565, 111.86326377620587, 130.93724361021094, 174.5225929158914, 169.69934623377898, 187.34115839430189, 135.59180782113475, 184.09273887848127, 146.30518010992927, 195.08801188472881, 109.76183681237728, 174.101503723565, 159.3532020782932, 180.58924764176294, 178.89377104151032, 178.9635207971892, 135.56354410581798, 168.13644088839223, 152.2844512860475, 167.86372537304962, 184.5766771503727, 167.75584006741335, 164.45297319005329, 174.09914779596014, 170.90101940790137, 190.63489786262946, 179.89012213686246, 154.8667277513236, 168.95228722424827, 185.76065506270405, 169.03526347787403, 173.07509934395375, 179.99076158366498, 185.18978469388145, 146.88293452655824, 104.74900289672091, 159.4774917895504, 184.41281364216115, 128.37045852463882, 168.04269443993877, 150.49999999999994, 148.89440442596583, 192.1613078947718, 138.5743068041897, 194.22892947717614, 134.77091281024707, 135.57789165701305, 170.62402027958012, 186.70032242194804, 166.0895700141762, 186.12337681277364, 169.8822975823197, 152.26505783255584, 157.9692848502554, 164.65701556721237, 151.71431755268628, 191.2795372801291, 161.5214857374943, 174.1522691024611, 164.6831497846912, 167.10613247166555, 177.13299491736126, 155.00665238745927, 140.85673171081876, 182.52729698677078, 160.84785152290132, 163.9588132586378, 150.3432808223727, 177.59276880165157, 176.85876463552736, 150.22117240195342, 153.5180008961874, 159.13066740823027, 148.7172740962584, 187.85995741288616, 175.24144580629329, 193.4059450387553, 178.65860878746054, 187.7715507862307, 161.22482866064456, 180.04326851980406, 181.3134267545273, 148.9387237229856, 131.81870493404352, 160.38309325098402, 166.5393395223906, 160.18794308868894, 197.3790820466087, 188.5454067087208, 181.55784116594916, 177.0733426272273, 180.40499901418877], "policy_predator_policy_reward": [80.31807565922537, 65.24154374233031, 41.27390867532638, 33.39174267294112, 48.52380769455382, 39.45587686252352, 7.212607943907862, 7.584473426707617, 92.7524154446718, 104.8328003540529, 8.068415147640694, 41.1468393821518, 13.017730417473986, 28.97836157644304, 22.90240344848587, 40.02029025668414, 26.395815196703435, 24.22207184967202, 35.579894828884655, 3.787934564706241, 14.370405499851891, 8.31554604446993, 28.847284946780093, 41.51715072730705, 81.84575492734082, 71.24702134347486, 127.30965737631585, 48.157567317147816, 8.023393586229883, 53.17013001663653, 68.63994718335857, 52.802407563964714, 48.568397886666034, 59.32580895072782, 15.735045073497755, 7.211341033355347, 35.38730995760109, 37.93746744813968, 6.738621800524948, 36.832427874090094, 11.082228599839816, 12.763058762972474, 61.44385432490484, 69.84060068220805, 20.62918419588995, 17.685460707763426, 54.17712465334512, 57.715302541791296, 33.98604526948156, 61.351892099903125, 14.427997212050963, 44.89238096227765, 52.05061695406212, 37.34080833709027, 21.208719392352133, 32.763393580606945, 31.971620770435436, 32.38052357403025, 92.8164019352423, 60.88075726569683, 10.766973902982036, 21.848098885213542, 8.981096409101701, 10.01419754688663, 27.300479934947443, 14.100954239944885, 16.988741601809625, 10.394585000335123, 7.82079880675808, 8.343317087112686, 25.100029932075326, 36.33816322577878, 26.876972268844607, 30.948848866726575, 9.07411822472234, 7.0803344981121334, 13.81293693617463, 43.248446021891525, 53.343375843535924, 26.1609098256878, 9.551051983057352, 9.461570369326552, 12.382639366306883, 9.90094467505097, 4.7433782549986825, 13.502911061848595, 12.392394046129862, 13.052697539970728, 2.457484930888055, 4.693457824441771, 25.63895109762322, 13.065538193638877, 12.615006875776688, 26.340350247870216, 11.334971222608132, 6.844041633870488, 30.179658687173344, 15.114183245936495, 26.135802165432597, 6.3888576077804204, 14.029679729689773, 16.257694500563925, 49.70782099379423, 23.915725899211154, 27.47881707464819, 7.499738869948255, 13.805097237512049, 17.51155442323821, 35.0853552592027, 52.04804884752132, 15.822698190086028, 16.262195832653795, 18.946538354202758, 17.36363422009742, 40.82199419745255, 20.166146201493312, 5.820520042536739, 3.5263963239116562, 25.60881650845921, 19.256250082936784, 18.02580524119304, 16.685291752692613, 22.595660570478465, 21.750904304648465, 44.40877192035495, 19.957462735583455, 9.532496708171292, 35.095728290503075, 12.492992103680615, 22.598327482824857, 2.7626351635993958, 9.641244655343458, 5.16516161683224, 15.241642563804183, 5.567104286109806, 21.771147061194384, 17.120668811574138, 12.508836751561942, 12.660897367742685, 12.332961021145495, 12.338587072739541, 9.372113297292271, 12.52706547344175, 4.170997103279113, 13.23967155191604, 8.684342896250074, 20.467709315868714, 23.269311793990283, 11.285739849090195, 17.818411660860466, 13.134479255026724, 17.874620112788776, 5.094260114582503, 27.681168972918623, 18.26590033702591, 15.852920648388059, 4.489676706645638, 15.81530612602968, 8.987202726645936, 12.74272772027631, 44.91429602284723, 27.27082479371797, 28.140486152288183, 27.598602807255936, 15.95566748626732, 22.0705581493666, 24.686460540909597, 11.24658823534043, 7.64020353060236, 14.149149120221386, 24.67484870532973, 20.873133261150553, 10.171819361886113, 17.426410779293803, 11.501695381544893, 12.058495176651773, 21.554310471645508, 13.632394045225237, 21.081931552951275, 24.61340666131545, 33.22908231891875, 21.9584323476925, 16.843229273486944, 13.110615475030976, 15.79657267232787, 6.067724178270618, 12.3904401844816, 12.69312928981005, 11.692828859353007, 8.521536288209811, 20.117453462975547, 33.533716600532, 18.403262598468224, 12.841644350736127, 14.777190506631914, 25.938953186364053, 4.671498286585782, 9.960052696561505, 15.58327817418281, 10.737257903708684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5995446246698815, "mean_inference_ms": 1.6995730426509337, "mean_action_processing_ms": 0.23763890104757576, "mean_env_wait_ms": 0.22293247647913808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036988258361816406, "StateBufferConnector_ms": 0.00321352481842041, "ViewRequirementAgentConnector_ms": 0.09544336795806885}, "num_episodes": 18, "episode_return_max": 407.30590184465444, "episode_return_min": 268.3299999999999, "episode_return_mean": 364.46648097141735, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.3463898964272, "num_env_steps_trained_throughput_per_sec": 371.3463898964272, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 10506.628, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10506.577, "sample_time_ms": 1358.192, "learn_time_ms": 9131.651, "learn_throughput": 438.037, "synch_weights_time_ms": 14.096}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-04", "timestamp": 1723778344, "time_this_iter_s": 10.816282033920288, "time_total_s": 155.29964232444763, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7295430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 155.29964232444763, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.166666666666664, "ram_util_percent": 83.74666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7906894511015956, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6336829219545637, "policy_loss": -0.013929695251555473, "vf_loss": 2.6446691842936967, "vf_explained_var": 0.37545981476546597, "kl": 0.019622909774529438, "entropy": 1.447563730535053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8588278267118667, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.323392402305805, "policy_loss": 0.0023783152870015885, "vf_loss": 8.317151454138378, "vf_explained_var": 0.08051629719280061, "kl": 0.019313188841601464, "entropy": 1.5414013252687202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 418.349047983068, "episode_reward_min": 268.3299999999999, "episode_reward_mean": 366.88210573595694, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 66.98210840966578, "predator_policy": 2.457484930888055}, "policy_reward_max": {"prey_policy": 198.68596815729063, "predator_policy": 92.8164019352423}, "policy_reward_mean": {"prey_policy": 163.10314059923948, "predator_policy": 20.337912268738986}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.8231661317303, 329.99690309728555, 373.3361287088413, 347.5766833980997, 310.1956486845741, 333.8932395077064, 376.8656047038604, 403.4063559199101, 388.27011876893334, 313.4297823875464, 338.7976988753496, 360.46169991796216, 397.2141710224405, 380.36641207407285, 374.59780708294034, 394.99668171958, 393.2969669850152, 370.81597579007575, 367.3344836957667, 366.0271198601247, 380.4572382394741, 355.9208504584758, 399.44562594251994, 352.3339208162569, 383.3911852959663, 377.04739858080444, 344.55999999999983, 384.7731628328413, 364.5497313157461, 373.3304818364425, 374.1226188886727, 379.1177097048922, 384.7004834123193, 377.13570329258545, 339.9332952496585, 329.0796592293422, 350.5059170384948, 337.54473054884204, 393.3506772023811, 380.67268709856177, 350.7401083611064, 328.72840712733847, 374.65354671394175, 402.2038567138264, 368.0662196501484, 364.77640165777143, 387.42383680429157, 350.9560008049559, 381.94272145116724, 362.0951012354898, 384.34244785008843, 367.10422121071593, 386.8912466475782, 268.3299999999999, 365.8143198798777, 340.15017407443645, 328.49855593591656, 361.7447140667771, 361.7752713749242, 340.3207329220072, 373.0948752687995, 377.73560484201556, 382.4194634993762, 372.1104220794426, 390.8272486532573, 374.7684676634022, 366.0284800398506, 341.4113660647583, 370.97337865085206, 337.8622846392072, 389.6382379540496, 349.4345115124075, 363.03545617109984, 393.05524796769737, 393.9288506768143, 374.0799489211669, 381.57106042189406, 334.4085987205366, 358.167339722579, 398.28316882829364, 384.7347988578173, 383.7988777193076, 349.9606661937609, 372.61582474403394, 349.7651614779261, 370.80969087818823, 418.349047983068, 381.99852613210635, 363.78111306931373, 384.740719950497, 386.0324604087847, 381.91590368032126, 358.48602260577866, 381.43483128108545, 352.04239324290944, 320.0754996618797, 372.0116638896495, 368.31999999999994, 386.3974982531284, 397.8722514701774], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.32606447140287, 105.17232425458687, 121.92265908442693, 164.5031943382439, 161.87846143437312, 187.61237991165592, 83.69457569385665, 132.5976526971302, 124.27109497466395, 147.60990880625687, 66.98210840966578, 155.0187039029043, 139.9287991911661, 141.59886814330946, 152.61180972470908, 191.47416802087253, 183.37324800572748, 115.50544547205324, 100.53490916180901, 158.9227602527784, 132.47018854288743, 141.97536598799658, 118.96509777050873, 87.79944294651445, 187.9712202742188, 176.6278779600261, 184.5219038356817, 176.84921428240284, 184.88612269382236, 148.31025021422568, 182.38510923712943, 185.22824588030576, 188.63285940196945, 188.49999168917503, 167.01123741055872, 142.3665452216629, 151.48230660410672, 158.02635595608882, 173.8778956439356, 175.99477149335468, 164.37171530264192, 159.02413997876613, 133.36655838978538, 143.05000639946672, 186.42545691368161, 194.00754667645447, 187.54527551618693, 142.50506125871212, 197.4413564042717, 167.70353957484735, 171.70572918446481, 179.8965778102392, 146.37592662735327, 191.03313061731686, 156.82934232492948, 189.23933121664965, 154.13815468174434, 171.45621951035483, 177.42504854835806, 177.7264204316059, 151.36797496361774, 177.46080199194517, 177.01193884445274, 169.58111108722667, 180.84432555809443, 173.5687836239712, 198.68596815729063, 104.82618824228963, 118.87005867578304, 186.08468062927955, 135.32357201696811, 162.43943555162403, 151.509249155565, 111.86326377620587, 130.93724361021094, 174.5225929158914, 169.69934623377898, 187.34115839430189, 135.59180782113475, 184.09273887848127, 146.30518010992927, 195.08801188472881, 109.76183681237728, 174.101503723565, 159.3532020782932, 180.58924764176294, 178.89377104151032, 178.9635207971892, 135.56354410581798, 168.13644088839223, 152.2844512860475, 167.86372537304962, 184.5766771503727, 167.75584006741335, 164.45297319005329, 174.09914779596014, 170.90101940790137, 190.63489786262946, 179.89012213686246, 154.8667277513236, 168.95228722424827, 185.76065506270405, 169.03526347787403, 173.07509934395375, 179.99076158366498, 185.18978469388145, 146.88293452655824, 104.74900289672091, 159.4774917895504, 184.41281364216115, 128.37045852463882, 168.04269443993877, 150.49999999999994, 148.89440442596583, 192.1613078947718, 138.5743068041897, 194.22892947717614, 134.77091281024707, 135.57789165701305, 170.62402027958012, 186.70032242194804, 166.0895700141762, 186.12337681277364, 169.8822975823197, 152.26505783255584, 157.9692848502554, 164.65701556721237, 151.71431755268628, 191.2795372801291, 161.5214857374943, 174.1522691024611, 164.6831497846912, 167.10613247166555, 177.13299491736126, 155.00665238745927, 140.85673171081876, 182.52729698677078, 160.84785152290132, 163.9588132586378, 150.3432808223727, 177.59276880165157, 176.85876463552736, 150.22117240195342, 153.5180008961874, 159.13066740823027, 148.7172740962584, 187.85995741288616, 175.24144580629329, 193.4059450387553, 178.65860878746054, 187.7715507862307, 161.22482866064456, 180.04326851980406, 181.3134267545273, 148.9387237229856, 131.81870493404352, 160.38309325098402, 166.5393395223906, 160.18794308868894, 197.3790820466087, 188.5454067087208, 181.55784116594916, 177.0733426272273, 180.40499901418877, 161.0963563104283, 167.50607775112545, 177.94336298092176, 163.14933938331387, 159.20872852922565, 166.01653645073526, 155.54630529812167, 185.79508134744881, 170.9178366186061, 132.46057430077934, 175.94826710198143, 159.34325722542502, 172.1407687728676, 154.8305869561642, 185.04230748315092, 156.37300041110032, 188.08654736885458, 126.24211194350084, 181.13141031598798, 182.76132734878234, 169.5665234481004, 152.2071974431876, 182.65222352404058, 179.9473496761308, 161.6031026113299, 162.6027927554955, 156.00080455891242, 101.60012279196691, 179.39478172499477, 157.51153823559113, 175.60348347655204, 178.06223664488874, 176.72816119674837, 192.35067963308646, 179.01935721565732, 187.37160815367469], "policy_predator_policy_reward": [35.38730995760109, 37.93746744813968, 6.738621800524948, 36.832427874090094, 11.082228599839816, 12.763058762972474, 61.44385432490484, 69.84060068220805, 20.62918419588995, 17.685460707763426, 54.17712465334512, 57.715302541791296, 33.98604526948156, 61.351892099903125, 14.427997212050963, 44.89238096227765, 52.05061695406212, 37.34080833709027, 21.208719392352133, 32.763393580606945, 31.971620770435436, 32.38052357403025, 92.8164019352423, 60.88075726569683, 10.766973902982036, 21.848098885213542, 8.981096409101701, 10.01419754688663, 27.300479934947443, 14.100954239944885, 16.988741601809625, 10.394585000335123, 7.82079880675808, 8.343317087112686, 25.100029932075326, 36.33816322577878, 26.876972268844607, 30.948848866726575, 9.07411822472234, 7.0803344981121334, 13.81293693617463, 43.248446021891525, 53.343375843535924, 26.1609098256878, 9.551051983057352, 9.461570369326552, 12.382639366306883, 9.90094467505097, 4.7433782549986825, 13.502911061848595, 12.392394046129862, 13.052697539970728, 2.457484930888055, 4.693457824441771, 25.63895109762322, 13.065538193638877, 12.615006875776688, 26.340350247870216, 11.334971222608132, 6.844041633870488, 30.179658687173344, 15.114183245936495, 26.135802165432597, 6.3888576077804204, 14.029679729689773, 16.257694500563925, 49.70782099379423, 23.915725899211154, 27.47881707464819, 7.499738869948255, 13.805097237512049, 17.51155442323821, 35.0853552592027, 52.04804884752132, 15.822698190086028, 16.262195832653795, 18.946538354202758, 17.36363422009742, 40.82199419745255, 20.166146201493312, 5.820520042536739, 3.5263963239116562, 25.60881650845921, 19.256250082936784, 18.02580524119304, 16.685291752692613, 22.595660570478465, 21.750904304648465, 44.40877192035495, 19.957462735583455, 9.532496708171292, 35.095728290503075, 12.492992103680615, 22.598327482824857, 2.7626351635993958, 9.641244655343458, 5.16516161683224, 15.241642563804183, 5.567104286109806, 21.771147061194384, 17.120668811574138, 12.508836751561942, 12.660897367742685, 12.332961021145495, 12.338587072739541, 9.372113297292271, 12.52706547344175, 4.170997103279113, 13.23967155191604, 8.684342896250074, 20.467709315868714, 23.269311793990283, 11.285739849090195, 17.818411660860466, 13.134479255026724, 17.874620112788776, 5.094260114582503, 27.681168972918623, 18.26590033702591, 15.852920648388059, 4.489676706645638, 15.81530612602968, 8.987202726645936, 12.74272772027631, 44.91429602284723, 27.27082479371797, 28.140486152288183, 27.598602807255936, 15.95566748626732, 22.0705581493666, 24.686460540909597, 11.24658823534043, 7.64020353060236, 14.149149120221386, 24.67484870532973, 20.873133261150553, 10.171819361886113, 17.426410779293803, 11.501695381544893, 12.058495176651773, 21.554310471645508, 13.632394045225237, 21.081931552951275, 24.61340666131545, 33.22908231891875, 21.9584323476925, 16.843229273486944, 13.110615475030976, 15.79657267232787, 6.067724178270618, 12.3904401844816, 12.69312928981005, 11.692828859353007, 8.521536288209811, 20.117453462975547, 33.533716600532, 18.403262598468224, 12.841644350736127, 14.777190506631914, 25.938953186364053, 4.671498286585782, 9.960052696561505, 15.58327817418281, 10.737257903708684, 18.122420907365992, 3.2358112248410698, 13.820485002507034, 17.702637377291406, 8.720765768142403, 15.819130729822882, 22.182573118629897, 7.285731113987946, 52.73912769439032, 62.23150936929201, 32.29566505695675, 14.411336747743107, 13.296018823226804, 23.51373851705508, 20.762193692670422, 22.56321836357558, 21.865121412280224, 49.83867968414914, 9.102503440586275, 8.920662574964684, 12.225828816779421, 24.48647289771128, 11.243158003975113, 7.592100076938896, 7.632087549966766, 20.204410326117333, 54.00761668207476, 8.466955628925696, 5.048586891572114, 30.056757037491593, 5.233801364122748, 9.4204785144365, 6.241625218540747, 11.077032204752664, 18.369771205744026, 13.111514895101493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5981927600451568, "mean_inference_ms": 1.7153636478827543, "mean_action_processing_ms": 0.23735343666448094, "mean_env_wait_ms": 0.22205992959073384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036084651947021484, "StateBufferConnector_ms": 0.003122091293334961, "ViewRequirementAgentConnector_ms": 0.09072303771972656}, "num_episodes": 18, "episode_return_max": 418.349047983068, "episode_return_min": 268.3299999999999, "episode_return_mean": 366.88210573595694, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.7455086385221, "num_env_steps_trained_throughput_per_sec": 370.7455086385221, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 10601.122, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10601.073, "sample_time_ms": 1381.335, "learn_time_ms": 9203.062, "learn_throughput": 434.638, "synch_weights_time_ms": 14.476}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-15", "timestamp": 1723778355, "time_this_iter_s": 10.837538957595825, "time_total_s": 166.13718128204346, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a73408b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 166.13718128204346, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.10666666666666, "ram_util_percent": 83.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.417350522803251, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.345485050968392, "policy_loss": -0.014705941258318643, "vf_loss": 5.357460383006504, "vf_explained_var": 0.18090984452338446, "kl": 0.018204066198354293, "entropy": 1.4543354580011318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103910737504404, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.142869394039981, "policy_loss": 0.0027263848443648646, "vf_loss": 7.137651769194023, "vf_explained_var": 0.14451509783507654, "kl": 0.012456123049706409, "entropy": 1.5280543973206213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 418.349047983068, "episode_reward_min": 268.3299999999999, "episode_reward_mean": 369.1862274774292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 101.60012279196691, "predator_policy": 2.457484930888055}, "policy_reward_max": {"prey_policy": 198.68596815729063, "predator_policy": 71.07344753072016}, "policy_reward_mean": {"prey_policy": 164.32449006526736, "predator_policy": 20.268623673447294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.3344836957667, 366.0271198601247, 380.4572382394741, 355.9208504584758, 399.44562594251994, 352.3339208162569, 383.3911852959663, 377.04739858080444, 344.55999999999983, 384.7731628328413, 364.5497313157461, 373.3304818364425, 374.1226188886727, 379.1177097048922, 384.7004834123193, 377.13570329258545, 339.9332952496585, 329.0796592293422, 350.5059170384948, 337.54473054884204, 393.3506772023811, 380.67268709856177, 350.7401083611064, 328.72840712733847, 374.65354671394175, 402.2038567138264, 368.0662196501484, 364.77640165777143, 387.42383680429157, 350.9560008049559, 381.94272145116724, 362.0951012354898, 384.34244785008843, 367.10422121071593, 386.8912466475782, 268.3299999999999, 365.8143198798777, 340.15017407443645, 328.49855593591656, 361.7447140667771, 361.7752713749242, 340.3207329220072, 373.0948752687995, 377.73560484201556, 382.4194634993762, 372.1104220794426, 390.8272486532573, 374.7684676634022, 366.0284800398506, 341.4113660647583, 370.97337865085206, 337.8622846392072, 389.6382379540496, 349.4345115124075, 363.03545617109984, 393.05524796769737, 393.9288506768143, 374.0799489211669, 381.57106042189406, 334.4085987205366, 358.167339722579, 398.28316882829364, 384.7347988578173, 383.7988777193076, 349.9606661937609, 372.61582474403394, 349.7651614779261, 370.80969087818823, 418.349047983068, 381.99852613210635, 363.78111306931373, 384.740719950497, 386.0324604087847, 381.91590368032126, 358.48602260577866, 381.43483128108545, 352.04239324290944, 320.0754996618797, 372.0116638896495, 368.31999999999994, 386.3974982531284, 397.8722514701774, 388.7833099882818, 396.57737946448617, 351.6454877940006, 393.1143522831674, 401.48715357229287, 347.47862274502216, 356.66219287439117, 378.14762760076576, 389.9772951484847, 373.51553949821476, 363.40487702579435, 368.5326259404389, 369.75902358760095, 379.959029441279, 372.76983630635846, 353.129644412114, 378.41971150170986, 395.38950973875944], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.48230660410672, 158.02635595608882, 173.8778956439356, 175.99477149335468, 164.37171530264192, 159.02413997876613, 133.36655838978538, 143.05000639946672, 186.42545691368161, 194.00754667645447, 187.54527551618693, 142.50506125871212, 197.4413564042717, 167.70353957484735, 171.70572918446481, 179.8965778102392, 146.37592662735327, 191.03313061731686, 156.82934232492948, 189.23933121664965, 154.13815468174434, 171.45621951035483, 177.42504854835806, 177.7264204316059, 151.36797496361774, 177.46080199194517, 177.01193884445274, 169.58111108722667, 180.84432555809443, 173.5687836239712, 198.68596815729063, 104.82618824228963, 118.87005867578304, 186.08468062927955, 135.32357201696811, 162.43943555162403, 151.509249155565, 111.86326377620587, 130.93724361021094, 174.5225929158914, 169.69934623377898, 187.34115839430189, 135.59180782113475, 184.09273887848127, 146.30518010992927, 195.08801188472881, 109.76183681237728, 174.101503723565, 159.3532020782932, 180.58924764176294, 178.89377104151032, 178.9635207971892, 135.56354410581798, 168.13644088839223, 152.2844512860475, 167.86372537304962, 184.5766771503727, 167.75584006741335, 164.45297319005329, 174.09914779596014, 170.90101940790137, 190.63489786262946, 179.89012213686246, 154.8667277513236, 168.95228722424827, 185.76065506270405, 169.03526347787403, 173.07509934395375, 179.99076158366498, 185.18978469388145, 146.88293452655824, 104.74900289672091, 159.4774917895504, 184.41281364216115, 128.37045852463882, 168.04269443993877, 150.49999999999994, 148.89440442596583, 192.1613078947718, 138.5743068041897, 194.22892947717614, 134.77091281024707, 135.57789165701305, 170.62402027958012, 186.70032242194804, 166.0895700141762, 186.12337681277364, 169.8822975823197, 152.26505783255584, 157.9692848502554, 164.65701556721237, 151.71431755268628, 191.2795372801291, 161.5214857374943, 174.1522691024611, 164.6831497846912, 167.10613247166555, 177.13299491736126, 155.00665238745927, 140.85673171081876, 182.52729698677078, 160.84785152290132, 163.9588132586378, 150.3432808223727, 177.59276880165157, 176.85876463552736, 150.22117240195342, 153.5180008961874, 159.13066740823027, 148.7172740962584, 187.85995741288616, 175.24144580629329, 193.4059450387553, 178.65860878746054, 187.7715507862307, 161.22482866064456, 180.04326851980406, 181.3134267545273, 148.9387237229856, 131.81870493404352, 160.38309325098402, 166.5393395223906, 160.18794308868894, 197.3790820466087, 188.5454067087208, 181.55784116594916, 177.0733426272273, 180.40499901418877, 161.0963563104283, 167.50607775112545, 177.94336298092176, 163.14933938331387, 159.20872852922565, 166.01653645073526, 155.54630529812167, 185.79508134744881, 170.9178366186061, 132.46057430077934, 175.94826710198143, 159.34325722542502, 172.1407687728676, 154.8305869561642, 185.04230748315092, 156.37300041110032, 188.08654736885458, 126.24211194350084, 181.13141031598798, 182.76132734878234, 169.5665234481004, 152.2071974431876, 182.65222352404058, 179.9473496761308, 161.6031026113299, 162.6027927554955, 156.00080455891242, 101.60012279196691, 179.39478172499477, 157.51153823559113, 175.60348347655204, 178.06223664488874, 176.72816119674837, 192.35067963308646, 179.01935721565732, 187.37160815367469, 166.63232543957372, 185.56159151238612, 180.4248447621017, 163.91300342448054, 166.3283293678802, 141.07432465162742, 130.67152644218032, 175.43129289043026, 182.49417392993703, 176.89332802221864, 106.01162776007517, 123.70048298935488, 165.2086461158408, 137.69072590532915, 166.2524081717902, 180.14353189122167, 184.28033968320946, 129.18146488583784, 157.92672512916596, 142.41557897449417, 162.2259985265654, 131.20975434344862, 165.03443648412014, 166.96833339160113, 173.9542546553974, 124.14873356260821, 161.45023285584278, 167.25799438830094, 165.78212011715868, 142.20085733859855, 173.14236163686013, 115.2614260792181, 161.1570351313761, 184.59204639876705, 128.36447073273598, 151.3233749145204], "policy_predator_policy_reward": [26.876972268844607, 30.948848866726575, 9.07411822472234, 7.0803344981121334, 13.81293693617463, 43.248446021891525, 53.343375843535924, 26.1609098256878, 9.551051983057352, 9.461570369326552, 12.382639366306883, 9.90094467505097, 4.7433782549986825, 13.502911061848595, 12.392394046129862, 13.052697539970728, 2.457484930888055, 4.693457824441771, 25.63895109762322, 13.065538193638877, 12.615006875776688, 26.340350247870216, 11.334971222608132, 6.844041633870488, 30.179658687173344, 15.114183245936495, 26.135802165432597, 6.3888576077804204, 14.029679729689773, 16.257694500563925, 49.70782099379423, 23.915725899211154, 27.47881707464819, 7.499738869948255, 13.805097237512049, 17.51155442323821, 35.0853552592027, 52.04804884752132, 15.822698190086028, 16.262195832653795, 18.946538354202758, 17.36363422009742, 40.82199419745255, 20.166146201493312, 5.820520042536739, 3.5263963239116562, 25.60881650845921, 19.256250082936784, 18.02580524119304, 16.685291752692613, 22.595660570478465, 21.750904304648465, 44.40877192035495, 19.957462735583455, 9.532496708171292, 35.095728290503075, 12.492992103680615, 22.598327482824857, 2.7626351635993958, 9.641244655343458, 5.16516161683224, 15.241642563804183, 5.567104286109806, 21.771147061194384, 17.120668811574138, 12.508836751561942, 12.660897367742685, 12.332961021145495, 12.338587072739541, 9.372113297292271, 12.52706547344175, 4.170997103279113, 13.23967155191604, 8.684342896250074, 20.467709315868714, 23.269311793990283, 11.285739849090195, 17.818411660860466, 13.134479255026724, 17.874620112788776, 5.094260114582503, 27.681168972918623, 18.26590033702591, 15.852920648388059, 4.489676706645638, 15.81530612602968, 8.987202726645936, 12.74272772027631, 44.91429602284723, 27.27082479371797, 28.140486152288183, 27.598602807255936, 15.95566748626732, 22.0705581493666, 24.686460540909597, 11.24658823534043, 7.64020353060236, 14.149149120221386, 24.67484870532973, 20.873133261150553, 10.171819361886113, 17.426410779293803, 11.501695381544893, 12.058495176651773, 21.554310471645508, 13.632394045225237, 21.081931552951275, 24.61340666131545, 33.22908231891875, 21.9584323476925, 16.843229273486944, 13.110615475030976, 15.79657267232787, 6.067724178270618, 12.3904401844816, 12.69312928981005, 11.692828859353007, 8.521536288209811, 20.117453462975547, 33.533716600532, 18.403262598468224, 12.841644350736127, 14.777190506631914, 25.938953186364053, 4.671498286585782, 9.960052696561505, 15.58327817418281, 10.737257903708684, 18.122420907365992, 3.2358112248410698, 13.820485002507034, 17.702637377291406, 8.720765768142403, 15.819130729822882, 22.182573118629897, 7.285731113987946, 52.73912769439032, 62.23150936929201, 32.29566505695675, 14.411336747743107, 13.296018823226804, 23.51373851705508, 20.762193692670422, 22.56321836357558, 21.865121412280224, 49.83867968414914, 9.102503440586275, 8.920662574964684, 12.225828816779421, 24.48647289771128, 11.243158003975113, 7.592100076938896, 7.632087549966766, 20.204410326117333, 54.00761668207476, 8.466955628925696, 5.048586891572114, 30.056757037491593, 5.233801364122748, 9.4204785144365, 6.241625218540747, 11.077032204752664, 18.369771205744026, 13.111514895101493, 28.3458401777861, 8.243552858536201, 22.27146491043515, 29.9680663674686, 38.374844188657455, 5.8679895858355025, 44.48814811966789, 42.5233848308892, 26.188742889475886, 15.91090873066159, 57.60015624864647, 60.166355746945406, 20.701689374541225, 33.061131478679755, 26.604862287276994, 5.14682525047696, 37.66242752712507, 38.853063052312294, 51.743232284368396, 21.43000311018602, 43.84483035976363, 26.124293796016786, 7.507029763970362, 29.022826300747138, 50.16661032843359, 21.489425041161937, 18.438248089533463, 32.81255410760181, 53.35858736352989, 11.428271487071356, 41.65975646882645, 23.06610022720921, 15.780634434316632, 16.88999553725031, 44.62821656078312, 71.07344753072016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5970434954613891, "mean_inference_ms": 1.7282179661129107, "mean_action_processing_ms": 0.23706806299678887, "mean_env_wait_ms": 0.22143440341414164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003627181053161621, "StateBufferConnector_ms": 0.003150463104248047, "ViewRequirementAgentConnector_ms": 0.09098577499389648}, "num_episodes": 18, "episode_return_max": 418.349047983068, "episode_return_min": 268.3299999999999, "episode_return_mean": 369.1862274774292, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.73683192197086, "num_env_steps_trained_throughput_per_sec": 355.73683192197086, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 10780.991, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10780.941, "sample_time_ms": 1412.58, "learn_time_ms": 9350.977, "learn_throughput": 427.763, "synch_weights_time_ms": 14.959}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-26", "timestamp": 1723778366, "time_this_iter_s": 11.296180009841919, "time_total_s": 177.43336129188538, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a71344c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 177.43336129188538, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.89411764705883, "ram_util_percent": 83.59411764705885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3715144847435927, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.442834152746453, "policy_loss": -0.009593444576526366, "vf_loss": 7.4500925200326105, "vf_explained_var": 0.14607842274443814, "kl": 0.015567073454184099, "entropy": 1.413633127376516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2474893114554186, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0904927299136205, "policy_loss": -0.0016333199998058339, "vf_loss": 7.0905347753454135, "vf_explained_var": 0.003578897348787419, "kl": 0.007956336775727026, "entropy": 1.501033851393947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 418.349047983068, "episode_reward_min": 268.3299999999999, "episode_reward_mean": 369.7512595836924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 58.757214048351386, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3790820466087, "predator_policy": 122.43848891338926}, "policy_reward_mean": {"prey_policy": 157.37737235349658, "predator_policy": 27.49825743834962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.7401083611064, 328.72840712733847, 374.65354671394175, 402.2038567138264, 368.0662196501484, 364.77640165777143, 387.42383680429157, 350.9560008049559, 381.94272145116724, 362.0951012354898, 384.34244785008843, 367.10422121071593, 386.8912466475782, 268.3299999999999, 365.8143198798777, 340.15017407443645, 328.49855593591656, 361.7447140667771, 361.7752713749242, 340.3207329220072, 373.0948752687995, 377.73560484201556, 382.4194634993762, 372.1104220794426, 390.8272486532573, 374.7684676634022, 366.0284800398506, 341.4113660647583, 370.97337865085206, 337.8622846392072, 389.6382379540496, 349.4345115124075, 363.03545617109984, 393.05524796769737, 393.9288506768143, 374.0799489211669, 381.57106042189406, 334.4085987205366, 358.167339722579, 398.28316882829364, 384.7347988578173, 383.7988777193076, 349.9606661937609, 372.61582474403394, 349.7651614779261, 370.80969087818823, 418.349047983068, 381.99852613210635, 363.78111306931373, 384.740719950497, 386.0324604087847, 381.91590368032126, 358.48602260577866, 381.43483128108545, 352.04239324290944, 320.0754996618797, 372.0116638896495, 368.31999999999994, 386.3974982531284, 397.8722514701774, 388.7833099882818, 396.57737946448617, 351.6454877940006, 393.1143522831674, 401.48715357229287, 347.47862274502216, 356.66219287439117, 378.14762760076576, 389.9772951484847, 373.51553949821476, 363.40487702579435, 368.5326259404389, 369.75902358760095, 379.959029441279, 372.76983630635846, 353.129644412114, 378.41971150170986, 395.38950973875944, 383.3597430236545, 368.10567059172604, 341.1773659982889, 390.0550028635016, 356.6340325127774, 370.2110263291935, 345.41252740017393, 373.05680133986976, 371.43546478812266, 372.0879836944936, 373.29314428676736, 392.76406637262045, 372.80114524205055, 380.40773318412727, 347.54727598135247, 385.5449351563415, 391.3448156961404, 382.1348416433352, 336.9201470897108, 366.57886475070814, 372.7519657406424, 378.2133374808812], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.30518010992927, 195.08801188472881, 109.76183681237728, 174.101503723565, 159.3532020782932, 180.58924764176294, 178.89377104151032, 178.9635207971892, 135.56354410581798, 168.13644088839223, 152.2844512860475, 167.86372537304962, 184.5766771503727, 167.75584006741335, 164.45297319005329, 174.09914779596014, 170.90101940790137, 190.63489786262946, 179.89012213686246, 154.8667277513236, 168.95228722424827, 185.76065506270405, 169.03526347787403, 173.07509934395375, 179.99076158366498, 185.18978469388145, 146.88293452655824, 104.74900289672091, 159.4774917895504, 184.41281364216115, 128.37045852463882, 168.04269443993877, 150.49999999999994, 148.89440442596583, 192.1613078947718, 138.5743068041897, 194.22892947717614, 134.77091281024707, 135.57789165701305, 170.62402027958012, 186.70032242194804, 166.0895700141762, 186.12337681277364, 169.8822975823197, 152.26505783255584, 157.9692848502554, 164.65701556721237, 151.71431755268628, 191.2795372801291, 161.5214857374943, 174.1522691024611, 164.6831497846912, 167.10613247166555, 177.13299491736126, 155.00665238745927, 140.85673171081876, 182.52729698677078, 160.84785152290132, 163.9588132586378, 150.3432808223727, 177.59276880165157, 176.85876463552736, 150.22117240195342, 153.5180008961874, 159.13066740823027, 148.7172740962584, 187.85995741288616, 175.24144580629329, 193.4059450387553, 178.65860878746054, 187.7715507862307, 161.22482866064456, 180.04326851980406, 181.3134267545273, 148.9387237229856, 131.81870493404352, 160.38309325098402, 166.5393395223906, 160.18794308868894, 197.3790820466087, 188.5454067087208, 181.55784116594916, 177.0733426272273, 180.40499901418877, 161.0963563104283, 167.50607775112545, 177.94336298092176, 163.14933938331387, 159.20872852922565, 166.01653645073526, 155.54630529812167, 185.79508134744881, 170.9178366186061, 132.46057430077934, 175.94826710198143, 159.34325722542502, 172.1407687728676, 154.8305869561642, 185.04230748315092, 156.37300041110032, 188.08654736885458, 126.24211194350084, 181.13141031598798, 182.76132734878234, 169.5665234481004, 152.2071974431876, 182.65222352404058, 179.9473496761308, 161.6031026113299, 162.6027927554955, 156.00080455891242, 101.60012279196691, 179.39478172499477, 157.51153823559113, 175.60348347655204, 178.06223664488874, 176.72816119674837, 192.35067963308646, 179.01935721565732, 187.37160815367469, 166.63232543957372, 185.56159151238612, 180.4248447621017, 163.91300342448054, 166.3283293678802, 141.07432465162742, 130.67152644218032, 175.43129289043026, 182.49417392993703, 176.89332802221864, 106.01162776007517, 123.70048298935488, 165.2086461158408, 137.69072590532915, 166.2524081717902, 180.14353189122167, 184.28033968320946, 129.18146488583784, 157.92672512916596, 142.41557897449417, 162.2259985265654, 131.20975434344862, 165.03443648412014, 166.96833339160113, 173.9542546553974, 124.14873356260821, 161.45023285584278, 167.25799438830094, 165.78212011715868, 142.20085733859855, 173.14236163686013, 115.2614260792181, 161.1570351313761, 184.59204639876705, 128.36447073273598, 151.3233749145204, 158.68917792101055, 154.20486329876047, 148.68566178076065, 125.50395059764686, 134.741002516362, 112.78977718330152, 147.3560269362298, 171.4357235582196, 91.80763510995767, 146.7909303394461, 128.74545606084064, 149.3313899943606, 122.16063102564483, 98.42277598403281, 118.4235748549412, 135.85795904418322, 136.46484296202084, 141.10170904330798, 138.3215336787528, 168.91167929203675, 145.48038682899838, 137.61030177009266, 80.91822551332895, 114.75237762221, 131.0296571588766, 152.67733609969966, 91.24028704212995, 107.09358324652867, 122.23434332590261, 136.67866896493263, 97.78736456271557, 58.757214048351386, 171.32801846476275, 150.7215815931045, 136.52106155503924, 148.5754741137842, 127.81534201462281, 157.8619831198817, 164.12450534638563, 138.02029677616525, 140.00982162873265, 137.54587251191313, 142.94376853173617, 121.37279181756139], "policy_predator_policy_reward": [5.820520042536739, 3.5263963239116562, 25.60881650845921, 19.256250082936784, 18.02580524119304, 16.685291752692613, 22.595660570478465, 21.750904304648465, 44.40877192035495, 19.957462735583455, 9.532496708171292, 35.095728290503075, 12.492992103680615, 22.598327482824857, 2.7626351635993958, 9.641244655343458, 5.16516161683224, 15.241642563804183, 5.567104286109806, 21.771147061194384, 17.120668811574138, 12.508836751561942, 12.660897367742685, 12.332961021145495, 12.338587072739541, 9.372113297292271, 12.52706547344175, 4.170997103279113, 13.23967155191604, 8.684342896250074, 20.467709315868714, 23.269311793990283, 11.285739849090195, 17.818411660860466, 13.134479255026724, 17.874620112788776, 5.094260114582503, 27.681168972918623, 18.26590033702591, 15.852920648388059, 4.489676706645638, 15.81530612602968, 8.987202726645936, 12.74272772027631, 44.91429602284723, 27.27082479371797, 28.140486152288183, 27.598602807255936, 15.95566748626732, 22.0705581493666, 24.686460540909597, 11.24658823534043, 7.64020353060236, 14.149149120221386, 24.67484870532973, 20.873133261150553, 10.171819361886113, 17.426410779293803, 11.501695381544893, 12.058495176651773, 21.554310471645508, 13.632394045225237, 21.081931552951275, 24.61340666131545, 33.22908231891875, 21.9584323476925, 16.843229273486944, 13.110615475030976, 15.79657267232787, 6.067724178270618, 12.3904401844816, 12.69312928981005, 11.692828859353007, 8.521536288209811, 20.117453462975547, 33.533716600532, 18.403262598468224, 12.841644350736127, 14.777190506631914, 25.938953186364053, 4.671498286585782, 9.960052696561505, 15.58327817418281, 10.737257903708684, 18.122420907365992, 3.2358112248410698, 13.820485002507034, 17.702637377291406, 8.720765768142403, 15.819130729822882, 22.182573118629897, 7.285731113987946, 52.73912769439032, 62.23150936929201, 32.29566505695675, 14.411336747743107, 13.296018823226804, 23.51373851705508, 20.762193692670422, 22.56321836357558, 21.865121412280224, 49.83867968414914, 9.102503440586275, 8.920662574964684, 12.225828816779421, 24.48647289771128, 11.243158003975113, 7.592100076938896, 7.632087549966766, 20.204410326117333, 54.00761668207476, 8.466955628925696, 5.048586891572114, 30.056757037491593, 5.233801364122748, 9.4204785144365, 6.241625218540747, 11.077032204752664, 18.369771205744026, 13.111514895101493, 28.3458401777861, 8.243552858536201, 22.27146491043515, 29.9680663674686, 38.374844188657455, 5.8679895858355025, 44.48814811966789, 42.5233848308892, 26.188742889475886, 15.91090873066159, 57.60015624864647, 60.166355746945406, 20.701689374541225, 33.061131478679755, 26.604862287276994, 5.14682525047696, 37.66242752712507, 38.853063052312294, 51.743232284368396, 21.43000311018602, 43.84483035976363, 26.124293796016786, 7.507029763970362, 29.022826300747138, 50.16661032843359, 21.489425041161937, 18.438248089533463, 32.81255410760181, 53.35858736352989, 11.428271487071356, 41.65975646882645, 23.06610022720921, 15.780634434316632, 16.88999553725031, 44.62821656078312, 71.07344753072016, 44.90083115914709, 25.564870644736175, 54.548266988524816, 39.367791224793656, 93.22556900839484, 0.4210172902303745, 37.753831236099096, 33.50942113295318, 0.0, 118.03546706337372, 55.60053028447385, 36.533649989518345, 84.53269280068616, 40.296427589810136, 31.453293227055845, 87.32197421368947, 61.2256376037532, 32.64327517904072, 22.208211555559114, 42.64655916814473, 34.891894174766364, 55.31056151290985, 122.43848891338926, 74.65497432369236, 33.57576048857103, 55.51839149490337, 99.09227386297052, 82.98158903249804, 37.22614546429062, 51.408118226226534, 119.22553723935246, 109.77481930592215, 42.30875559634623, 26.98646004192712, 62.87179447481277, 34.166511499698856, 23.78444181164595, 27.458380143560227, 25.820738748298105, 38.613323879859074, 39.34272636301243, 55.853545236984154, 56.40148442155644, 57.49529271002744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5985957719963119, "mean_inference_ms": 1.746808484790764, "mean_action_processing_ms": 0.23722402068892806, "mean_env_wait_ms": 0.22183892425619461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037207603454589844, "StateBufferConnector_ms": 0.0031709671020507812, "ViewRequirementAgentConnector_ms": 0.0944284200668335}, "num_episodes": 22, "episode_return_max": 418.349047983068, "episode_return_min": 268.3299999999999, "episode_return_mean": 369.7512595836924, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.74942939725133, "num_env_steps_trained_throughput_per_sec": 365.74942939725133, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 10827.261, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10827.212, "sample_time_ms": 1460.106, "learn_time_ms": 9349.726, "learn_throughput": 427.82, "synch_weights_time_ms": 15.106}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-37", "timestamp": 1723778377, "time_this_iter_s": 10.997544765472412, "time_total_s": 188.4309060573578, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7347dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 188.4309060573578, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.660000000000004, "ram_util_percent": 83.56}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.596485565862958, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.610652868836015, "policy_loss": -0.010115130192467145, "vf_loss": 8.61880818826181, "vf_explained_var": 0.03781485601707741, "kl": 0.013065271209781333, "entropy": 1.3885818692111465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9486796302139444, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.850633440320454, "policy_loss": -0.003901025284052132, "vf_loss": 7.852627352053526, "vf_explained_var": 0.03530352106170049, "kl": 0.009535539684725008, "entropy": 1.497050801597575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 418.349047983068, "episode_reward_min": 320.0754996618797, "episode_reward_mean": 372.6572216360738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2.496806240035286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3790820466087, "predator_policy": 150.80896146339575}, "policy_reward_mean": {"prey_policy": 144.50417365662176, "predator_policy": 41.82443716141522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.1104220794426, 390.8272486532573, 374.7684676634022, 366.0284800398506, 341.4113660647583, 370.97337865085206, 337.8622846392072, 389.6382379540496, 349.4345115124075, 363.03545617109984, 393.05524796769737, 393.9288506768143, 374.0799489211669, 381.57106042189406, 334.4085987205366, 358.167339722579, 398.28316882829364, 384.7347988578173, 383.7988777193076, 349.9606661937609, 372.61582474403394, 349.7651614779261, 370.80969087818823, 418.349047983068, 381.99852613210635, 363.78111306931373, 384.740719950497, 386.0324604087847, 381.91590368032126, 358.48602260577866, 381.43483128108545, 352.04239324290944, 320.0754996618797, 372.0116638896495, 368.31999999999994, 386.3974982531284, 397.8722514701774, 388.7833099882818, 396.57737946448617, 351.6454877940006, 393.1143522831674, 401.48715357229287, 347.47862274502216, 356.66219287439117, 378.14762760076576, 389.9772951484847, 373.51553949821476, 363.40487702579435, 368.5326259404389, 369.75902358760095, 379.959029441279, 372.76983630635846, 353.129644412114, 378.41971150170986, 395.38950973875944, 383.3597430236545, 368.10567059172604, 341.1773659982889, 390.0550028635016, 356.6340325127774, 370.2110263291935, 345.41252740017393, 373.05680133986976, 371.43546478812266, 372.0879836944936, 373.29314428676736, 392.76406637262045, 372.80114524205055, 380.40773318412727, 347.54727598135247, 385.5449351563415, 391.3448156961404, 382.1348416433352, 336.9201470897108, 366.57886475070814, 372.7519657406424, 378.2133374808812, 382.1192539282941, 348.9570601085538, 381.51516088669894, 347.35341865792105, 417.7250878744856, 350.7052443534077, 354.47918663558164, 356.39480023479797, 390.0061167611066, 381.92657956352076, 390.7182296486749, 372.8565784784895, 382.36983306130867, 354.95050887983547, 387.478204967205, 368.1620985220416, 378.7868895864845, 345.3701442840968, 370.79970943874036, 374.78092150383037, 364.48889779658356, 396.1809520446137, 402.27915611443274], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.65701556721237, 151.71431755268628, 191.2795372801291, 161.5214857374943, 174.1522691024611, 164.6831497846912, 167.10613247166555, 177.13299491736126, 155.00665238745927, 140.85673171081876, 182.52729698677078, 160.84785152290132, 163.9588132586378, 150.3432808223727, 177.59276880165157, 176.85876463552736, 150.22117240195342, 153.5180008961874, 159.13066740823027, 148.7172740962584, 187.85995741288616, 175.24144580629329, 193.4059450387553, 178.65860878746054, 187.7715507862307, 161.22482866064456, 180.04326851980406, 181.3134267545273, 148.9387237229856, 131.81870493404352, 160.38309325098402, 166.5393395223906, 160.18794308868894, 197.3790820466087, 188.5454067087208, 181.55784116594916, 177.0733426272273, 180.40499901418877, 161.0963563104283, 167.50607775112545, 177.94336298092176, 163.14933938331387, 159.20872852922565, 166.01653645073526, 155.54630529812167, 185.79508134744881, 170.9178366186061, 132.46057430077934, 175.94826710198143, 159.34325722542502, 172.1407687728676, 154.8305869561642, 185.04230748315092, 156.37300041110032, 188.08654736885458, 126.24211194350084, 181.13141031598798, 182.76132734878234, 169.5665234481004, 152.2071974431876, 182.65222352404058, 179.9473496761308, 161.6031026113299, 162.6027927554955, 156.00080455891242, 101.60012279196691, 179.39478172499477, 157.51153823559113, 175.60348347655204, 178.06223664488874, 176.72816119674837, 192.35067963308646, 179.01935721565732, 187.37160815367469, 166.63232543957372, 185.56159151238612, 180.4248447621017, 163.91300342448054, 166.3283293678802, 141.07432465162742, 130.67152644218032, 175.43129289043026, 182.49417392993703, 176.89332802221864, 106.01162776007517, 123.70048298935488, 165.2086461158408, 137.69072590532915, 166.2524081717902, 180.14353189122167, 184.28033968320946, 129.18146488583784, 157.92672512916596, 142.41557897449417, 162.2259985265654, 131.20975434344862, 165.03443648412014, 166.96833339160113, 173.9542546553974, 124.14873356260821, 161.45023285584278, 167.25799438830094, 165.78212011715868, 142.20085733859855, 173.14236163686013, 115.2614260792181, 161.1570351313761, 184.59204639876705, 128.36447073273598, 151.3233749145204, 158.68917792101055, 154.20486329876047, 148.68566178076065, 125.50395059764686, 134.741002516362, 112.78977718330152, 147.3560269362298, 171.4357235582196, 91.80763510995767, 146.7909303394461, 128.74545606084064, 149.3313899943606, 122.16063102564483, 98.42277598403281, 118.4235748549412, 135.85795904418322, 136.46484296202084, 141.10170904330798, 138.3215336787528, 168.91167929203675, 145.48038682899838, 137.61030177009266, 80.91822551332895, 114.75237762221, 131.0296571588766, 152.67733609969966, 91.24028704212995, 107.09358324652867, 122.23434332590261, 136.67866896493263, 97.78736456271557, 58.757214048351386, 171.32801846476275, 150.7215815931045, 136.52106155503924, 148.5754741137842, 127.81534201462281, 157.8619831198817, 164.12450534638563, 138.02029677616525, 140.00982162873265, 137.54587251191313, 142.94376853173617, 121.37279181756139, 122.29110341057452, 156.17361088506576, 120.72841731562902, 155.40187796507567, 106.81721072380651, 102.86107170621148, 40.708301954457255, 115.64270775056636, 110.99082609172561, 56.872000775906415, 108.75619689411049, 59.590130890529316, 53.557072670522594, 75.48036552108124, 106.39842059673681, 36.620374126771495, 101.50399443980001, 97.01137393397508, 133.24191509416053, 85.47404488875061, 75.28224733536295, 124.56683394764659, 139.6170920530889, 114.54542569883266, 126.93999940981918, -2.496806240035286, 79.52884854688568, 99.74644651126694, 152.9420494175669, 135.7607163968277, 119.74188237686693, 84.39800404239273, 134.77965953546268, 97.48211073526485, 144.98184936639558, 123.25747813758983, 104.87928470804162, 148.34579405262136, 104.42037653589674, 123.10427013736245, 141.03299599064002, 159.55392251726738, 135.6067702612842, 163.51390664470816, 129.52121987433463, 90.56963617023192], "policy_predator_policy_reward": [28.140486152288183, 27.598602807255936, 15.95566748626732, 22.0705581493666, 24.686460540909597, 11.24658823534043, 7.64020353060236, 14.149149120221386, 24.67484870532973, 20.873133261150553, 10.171819361886113, 17.426410779293803, 11.501695381544893, 12.058495176651773, 21.554310471645508, 13.632394045225237, 21.081931552951275, 24.61340666131545, 33.22908231891875, 21.9584323476925, 16.843229273486944, 13.110615475030976, 15.79657267232787, 6.067724178270618, 12.3904401844816, 12.69312928981005, 11.692828859353007, 8.521536288209811, 20.117453462975547, 33.533716600532, 18.403262598468224, 12.841644350736127, 14.777190506631914, 25.938953186364053, 4.671498286585782, 9.960052696561505, 15.58327817418281, 10.737257903708684, 18.122420907365992, 3.2358112248410698, 13.820485002507034, 17.702637377291406, 8.720765768142403, 15.819130729822882, 22.182573118629897, 7.285731113987946, 52.73912769439032, 62.23150936929201, 32.29566505695675, 14.411336747743107, 13.296018823226804, 23.51373851705508, 20.762193692670422, 22.56321836357558, 21.865121412280224, 49.83867968414914, 9.102503440586275, 8.920662574964684, 12.225828816779421, 24.48647289771128, 11.243158003975113, 7.592100076938896, 7.632087549966766, 20.204410326117333, 54.00761668207476, 8.466955628925696, 5.048586891572114, 30.056757037491593, 5.233801364122748, 9.4204785144365, 6.241625218540747, 11.077032204752664, 18.369771205744026, 13.111514895101493, 28.3458401777861, 8.243552858536201, 22.27146491043515, 29.9680663674686, 38.374844188657455, 5.8679895858355025, 44.48814811966789, 42.5233848308892, 26.188742889475886, 15.91090873066159, 57.60015624864647, 60.166355746945406, 20.701689374541225, 33.061131478679755, 26.604862287276994, 5.14682525047696, 37.66242752712507, 38.853063052312294, 51.743232284368396, 21.43000311018602, 43.84483035976363, 26.124293796016786, 7.507029763970362, 29.022826300747138, 50.16661032843359, 21.489425041161937, 18.438248089533463, 32.81255410760181, 53.35858736352989, 11.428271487071356, 41.65975646882645, 23.06610022720921, 15.780634434316632, 16.88999553725031, 44.62821656078312, 71.07344753072016, 44.90083115914709, 25.564870644736175, 54.548266988524816, 39.367791224793656, 93.22556900839484, 0.4210172902303745, 37.753831236099096, 33.50942113295318, 0.0, 118.03546706337372, 55.60053028447385, 36.533649989518345, 84.53269280068616, 40.296427589810136, 31.453293227055845, 87.32197421368947, 61.2256376037532, 32.64327517904072, 22.208211555559114, 42.64655916814473, 34.891894174766364, 55.31056151290985, 122.43848891338926, 74.65497432369236, 33.57576048857103, 55.51839149490337, 99.09227386297052, 82.98158903249804, 37.22614546429062, 51.408118226226534, 119.22553723935246, 109.77481930592215, 42.30875559634623, 26.98646004192712, 62.87179447481277, 34.166511499698856, 23.78444181164595, 27.458380143560227, 25.820738748298105, 38.613323879859074, 39.34272636301243, 55.853545236984154, 56.40148442155644, 57.49529271002744, 56.507080147776186, 47.147459484877665, 42.708688074228334, 30.118076753620944, 65.94780638948129, 105.88907206719995, 107.58239819424195, 83.42001075865564, 134.40093013907315, 115.46133086778043, 78.37283947168049, 103.9860770970873, 93.35750107224106, 132.08424737173684, 144.43358840862214, 68.94241710266789, 66.79160015131927, 124.69914823601235, 67.60023265252086, 95.61038692808829, 111.04463481955804, 79.82451354610717, 45.450612882583755, 73.24344784398409, 150.80896146339575, 107.11767842812884, 99.22143185425763, 76.45378196742482, 38.56431488227841, 60.21112427053189, 75.68605517482449, 88.33615692795756, 50.84214313727311, 95.68297617848356, 3.761675959301352, 73.36914082081013, 52.061262979365324, 65.51336769871202, 75.08530060687693, 72.1709742236948, 56.627196008362944, 7.274783280313317, 56.54584376130947, 40.51443137731196, 67.30905676082992, 114.87924330903677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6000672562793813, "mean_inference_ms": 1.758264780402794, "mean_action_processing_ms": 0.23769117512068497, "mean_env_wait_ms": 0.22219430215678776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004024624824523926, "StateBufferConnector_ms": 0.003244757652282715, "ViewRequirementAgentConnector_ms": 0.10502159595489502}, "num_episodes": 23, "episode_return_max": 418.349047983068, "episode_return_min": 320.0754996618797, "episode_return_mean": 372.6572216360738, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.6671921444706, "num_env_steps_trained_throughput_per_sec": 373.6671921444706, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 10814.785, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10814.736, "sample_time_ms": 1453.533, "learn_time_ms": 9344.113, "learn_throughput": 428.077, "synch_weights_time_ms": 15.108}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-48", "timestamp": 1723778388, "time_this_iter_s": 10.758092164993286, "time_total_s": 199.18899822235107, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7347e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 199.18899822235107, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.279999999999998, "ram_util_percent": 83.67333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.952112298667746, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.907363792449709, "policy_loss": -0.00996369352236528, "vf_loss": 7.914697564846624, "vf_explained_var": 0.002832886813178895, "kl": 0.017532810574521416, "entropy": 1.3761595654739904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.39024411335824, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7414675132307424, "policy_loss": -0.006654391334411841, "vf_loss": 7.745559533689388, "vf_explained_var": 0.053599536513525343, "kl": 0.012811996045359887, "entropy": 1.499292284092575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 419.6944085727305, "episode_reward_min": 299.7506122134642, "episode_reward_mean": 373.1339246040282, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2.496806240035286, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.35067963308646, "predator_policy": 200.93696923929426}, "policy_reward_mean": {"prey_policy": 133.04279949734052, "predator_policy": 53.524162804673615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.7988777193076, 349.9606661937609, 372.61582474403394, 349.7651614779261, 370.80969087818823, 418.349047983068, 381.99852613210635, 363.78111306931373, 384.740719950497, 386.0324604087847, 381.91590368032126, 358.48602260577866, 381.43483128108545, 352.04239324290944, 320.0754996618797, 372.0116638896495, 368.31999999999994, 386.3974982531284, 397.8722514701774, 388.7833099882818, 396.57737946448617, 351.6454877940006, 393.1143522831674, 401.48715357229287, 347.47862274502216, 356.66219287439117, 378.14762760076576, 389.9772951484847, 373.51553949821476, 363.40487702579435, 368.5326259404389, 369.75902358760095, 379.959029441279, 372.76983630635846, 353.129644412114, 378.41971150170986, 395.38950973875944, 383.3597430236545, 368.10567059172604, 341.1773659982889, 390.0550028635016, 356.6340325127774, 370.2110263291935, 345.41252740017393, 373.05680133986976, 371.43546478812266, 372.0879836944936, 373.29314428676736, 392.76406637262045, 372.80114524205055, 380.40773318412727, 347.54727598135247, 385.5449351563415, 391.3448156961404, 382.1348416433352, 336.9201470897108, 366.57886475070814, 372.7519657406424, 378.2133374808812, 382.1192539282941, 348.9570601085538, 381.51516088669894, 347.35341865792105, 417.7250878744856, 350.7052443534077, 354.47918663558164, 356.39480023479797, 390.0061167611066, 381.92657956352076, 390.7182296486749, 372.8565784784895, 382.36983306130867, 354.95050887983547, 387.478204967205, 368.1620985220416, 378.7868895864845, 345.3701442840968, 370.79970943874036, 374.78092150383037, 364.48889779658356, 396.1809520446137, 402.27915611443274, 366.7652081395501, 355.1562571627164, 347.24574235743745, 377.7442297440844, 365.4023975837978, 357.2217181915766, 384.5468041601341, 406.9379474272357, 379.6789559983744, 381.7603574394493, 393.54559104442586, 367.1764034914358, 419.6944085727305, 367.7069175412653, 365.6405789226008, 378.00975048854224, 408.00528386174256, 299.7506122134642], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.0733426272273, 180.40499901418877, 161.0963563104283, 167.50607775112545, 177.94336298092176, 163.14933938331387, 159.20872852922565, 166.01653645073526, 155.54630529812167, 185.79508134744881, 170.9178366186061, 132.46057430077934, 175.94826710198143, 159.34325722542502, 172.1407687728676, 154.8305869561642, 185.04230748315092, 156.37300041110032, 188.08654736885458, 126.24211194350084, 181.13141031598798, 182.76132734878234, 169.5665234481004, 152.2071974431876, 182.65222352404058, 179.9473496761308, 161.6031026113299, 162.6027927554955, 156.00080455891242, 101.60012279196691, 179.39478172499477, 157.51153823559113, 175.60348347655204, 178.06223664488874, 176.72816119674837, 192.35067963308646, 179.01935721565732, 187.37160815367469, 166.63232543957372, 185.56159151238612, 180.4248447621017, 163.91300342448054, 166.3283293678802, 141.07432465162742, 130.67152644218032, 175.43129289043026, 182.49417392993703, 176.89332802221864, 106.01162776007517, 123.70048298935488, 165.2086461158408, 137.69072590532915, 166.2524081717902, 180.14353189122167, 184.28033968320946, 129.18146488583784, 157.92672512916596, 142.41557897449417, 162.2259985265654, 131.20975434344862, 165.03443648412014, 166.96833339160113, 173.9542546553974, 124.14873356260821, 161.45023285584278, 167.25799438830094, 165.78212011715868, 142.20085733859855, 173.14236163686013, 115.2614260792181, 161.1570351313761, 184.59204639876705, 128.36447073273598, 151.3233749145204, 158.68917792101055, 154.20486329876047, 148.68566178076065, 125.50395059764686, 134.741002516362, 112.78977718330152, 147.3560269362298, 171.4357235582196, 91.80763510995767, 146.7909303394461, 128.74545606084064, 149.3313899943606, 122.16063102564483, 98.42277598403281, 118.4235748549412, 135.85795904418322, 136.46484296202084, 141.10170904330798, 138.3215336787528, 168.91167929203675, 145.48038682899838, 137.61030177009266, 80.91822551332895, 114.75237762221, 131.0296571588766, 152.67733609969966, 91.24028704212995, 107.09358324652867, 122.23434332590261, 136.67866896493263, 97.78736456271557, 58.757214048351386, 171.32801846476275, 150.7215815931045, 136.52106155503924, 148.5754741137842, 127.81534201462281, 157.8619831198817, 164.12450534638563, 138.02029677616525, 140.00982162873265, 137.54587251191313, 142.94376853173617, 121.37279181756139, 122.29110341057452, 156.17361088506576, 120.72841731562902, 155.40187796507567, 106.81721072380651, 102.86107170621148, 40.708301954457255, 115.64270775056636, 110.99082609172561, 56.872000775906415, 108.75619689411049, 59.590130890529316, 53.557072670522594, 75.48036552108124, 106.39842059673681, 36.620374126771495, 101.50399443980001, 97.01137393397508, 133.24191509416053, 85.47404488875061, 75.28224733536295, 124.56683394764659, 139.6170920530889, 114.54542569883266, 126.93999940981918, -2.496806240035286, 79.52884854688568, 99.74644651126694, 152.9420494175669, 135.7607163968277, 119.74188237686693, 84.39800404239273, 134.77965953546268, 97.48211073526485, 144.98184936639558, 123.25747813758983, 104.87928470804162, 148.34579405262136, 104.42037653589674, 123.10427013736245, 141.03299599064002, 159.55392251726738, 135.6067702612842, 163.51390664470816, 129.52121987433463, 90.56963617023192, 150.47928019846603, 121.9874107945306, 96.6701747162027, 125.38698152058846, 127.1088291653363, 102.03116292166864, 75.59006627815229, 36.51689507381691, 126.0513611870112, 123.3132761968734, 155.7648403833439, 130.19595057400565, 67.50048212159204, 146.21610875651686, 64.33844793350598, 79.48825090149317, 144.0651055182552, 6.819733920868529, 96.23745518927116, 144.26951438580238, 71.56741798078332, 74.37120670457985, 122.11735154585358, 120.14767133279567, 9.475214827585354, 81.61846196024614, 143.25683382552774, 77.49119939334048, 141.15257713333364, 128.80725710365394, 101.65721592979742, 140.52649228307828, 90.70885596746304, 124.45130109111201, 117.15611739079952, 95.8840094859517], "policy_predator_policy_reward": [15.58327817418281, 10.737257903708684, 18.122420907365992, 3.2358112248410698, 13.820485002507034, 17.702637377291406, 8.720765768142403, 15.819130729822882, 22.182573118629897, 7.285731113987946, 52.73912769439032, 62.23150936929201, 32.29566505695675, 14.411336747743107, 13.296018823226804, 23.51373851705508, 20.762193692670422, 22.56321836357558, 21.865121412280224, 49.83867968414914, 9.102503440586275, 8.920662574964684, 12.225828816779421, 24.48647289771128, 11.243158003975113, 7.592100076938896, 7.632087549966766, 20.204410326117333, 54.00761668207476, 8.466955628925696, 5.048586891572114, 30.056757037491593, 5.233801364122748, 9.4204785144365, 6.241625218540747, 11.077032204752664, 18.369771205744026, 13.111514895101493, 28.3458401777861, 8.243552858536201, 22.27146491043515, 29.9680663674686, 38.374844188657455, 5.8679895858355025, 44.48814811966789, 42.5233848308892, 26.188742889475886, 15.91090873066159, 57.60015624864647, 60.166355746945406, 20.701689374541225, 33.061131478679755, 26.604862287276994, 5.14682525047696, 37.66242752712507, 38.853063052312294, 51.743232284368396, 21.43000311018602, 43.84483035976363, 26.124293796016786, 7.507029763970362, 29.022826300747138, 50.16661032843359, 21.489425041161937, 18.438248089533463, 32.81255410760181, 53.35858736352989, 11.428271487071356, 41.65975646882645, 23.06610022720921, 15.780634434316632, 16.88999553725031, 44.62821656078312, 71.07344753072016, 44.90083115914709, 25.564870644736175, 54.548266988524816, 39.367791224793656, 93.22556900839484, 0.4210172902303745, 37.753831236099096, 33.50942113295318, 0.0, 118.03546706337372, 55.60053028447385, 36.533649989518345, 84.53269280068616, 40.296427589810136, 31.453293227055845, 87.32197421368947, 61.2256376037532, 32.64327517904072, 22.208211555559114, 42.64655916814473, 34.891894174766364, 55.31056151290985, 122.43848891338926, 74.65497432369236, 33.57576048857103, 55.51839149490337, 99.09227386297052, 82.98158903249804, 37.22614546429062, 51.408118226226534, 119.22553723935246, 109.77481930592215, 42.30875559634623, 26.98646004192712, 62.87179447481277, 34.166511499698856, 23.78444181164595, 27.458380143560227, 25.820738748298105, 38.613323879859074, 39.34272636301243, 55.853545236984154, 56.40148442155644, 57.49529271002744, 56.507080147776186, 47.147459484877665, 42.708688074228334, 30.118076753620944, 65.94780638948129, 105.88907206719995, 107.58239819424195, 83.42001075865564, 134.40093013907315, 115.46133086778043, 78.37283947168049, 103.9860770970873, 93.35750107224106, 132.08424737173684, 144.43358840862214, 68.94241710266789, 66.79160015131927, 124.69914823601235, 67.60023265252086, 95.61038692808829, 111.04463481955804, 79.82451354610717, 45.450612882583755, 73.24344784398409, 150.80896146339575, 107.11767842812884, 99.22143185425763, 76.45378196742482, 38.56431488227841, 60.21112427053189, 75.68605517482449, 88.33615692795756, 50.84214313727311, 95.68297617848356, 3.761675959301352, 73.36914082081013, 52.061262979365324, 65.51336769871202, 75.08530060687693, 72.1709742236948, 56.627196008362944, 7.274783280313317, 56.54584376130947, 40.51443137731196, 67.30905676082992, 114.87924330903677, 46.92562719634885, 47.37288995020473, 66.30708474045024, 66.79201618547538, 83.43286717625972, 34.67288309417222, 126.43183666465347, 139.20543172746184, 69.66958972609977, 46.36817047381359, 44.06761777402175, 27.1933094602054, 87.21608052495834, 83.61413275706704, 115.33912225214337, 147.7721263400938, 111.64441766759136, 117.14969889165944, 58.50966244250423, 82.74372542187194, 98.81655331369464, 148.79041304536804, 75.62045837310902, 49.29092223967795, 127.66376254560426, 200.93696923929426, 94.88683224881163, 52.072052073585546, 55.10488135822322, 40.575863327390216, 81.74468918247148, 54.08135309319488, 95.18433151579727, 97.66079528737039, 36.427684197468835, 50.2828011392442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6010390201367024, "mean_inference_ms": 1.7657824374838271, "mean_action_processing_ms": 0.23773403164183013, "mean_env_wait_ms": 0.22242760421857588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00405120849609375, "StateBufferConnector_ms": 0.003287792205810547, "ViewRequirementAgentConnector_ms": 0.1060711145401001}, "num_episodes": 18, "episode_return_max": 419.6944085727305, "episode_return_min": 299.7506122134642, "episode_return_mean": 373.1339246040282, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.864946469589, "num_env_steps_trained_throughput_per_sec": 369.864946469589, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 10830.539, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10830.489, "sample_time_ms": 1443.501, "learn_time_ms": 9369.659, "learn_throughput": 426.91, "synch_weights_time_ms": 15.162}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "e552a_00000", "date": "2024-08-16_08-49-59", "timestamp": 1723778399, "time_this_iter_s": 10.870662927627563, "time_total_s": 210.05966114997864, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a71343a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 210.05966114997864, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 30.125, "ram_util_percent": 83.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9132975054796413, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.930552314576649, "policy_loss": -0.013079128685535459, "vf_loss": 7.940502618860315, "vf_explained_var": 0.026094454211532753, "kl": 0.020858833605578497, "entropy": 1.4070548910943288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4658130688642066, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.528131646706314, "policy_loss": -0.0063068546216796945, "vf_loss": 8.532440794586504, "vf_explained_var": 0.10745464525525532, "kl": 0.009988662555224919, "entropy": 1.4984671619834093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 419.6944085727305, "episode_reward_min": 299.7506122134642, "episode_reward_mean": 371.6750854120135, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.9868330042969, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.37160815367469, "predator_policy": 200.93696923929426}, "policy_reward_mean": {"prey_policy": 119.77016796742569, "predator_policy": 66.06737473858108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [397.8722514701774, 388.7833099882818, 396.57737946448617, 351.6454877940006, 393.1143522831674, 401.48715357229287, 347.47862274502216, 356.66219287439117, 378.14762760076576, 389.9772951484847, 373.51553949821476, 363.40487702579435, 368.5326259404389, 369.75902358760095, 379.959029441279, 372.76983630635846, 353.129644412114, 378.41971150170986, 395.38950973875944, 383.3597430236545, 368.10567059172604, 341.1773659982889, 390.0550028635016, 356.6340325127774, 370.2110263291935, 345.41252740017393, 373.05680133986976, 371.43546478812266, 372.0879836944936, 373.29314428676736, 392.76406637262045, 372.80114524205055, 380.40773318412727, 347.54727598135247, 385.5449351563415, 391.3448156961404, 382.1348416433352, 336.9201470897108, 366.57886475070814, 372.7519657406424, 378.2133374808812, 382.1192539282941, 348.9570601085538, 381.51516088669894, 347.35341865792105, 417.7250878744856, 350.7052443534077, 354.47918663558164, 356.39480023479797, 390.0061167611066, 381.92657956352076, 390.7182296486749, 372.8565784784895, 382.36983306130867, 354.95050887983547, 387.478204967205, 368.1620985220416, 378.7868895864845, 345.3701442840968, 370.79970943874036, 374.78092150383037, 364.48889779658356, 396.1809520446137, 402.27915611443274, 366.7652081395501, 355.1562571627164, 347.24574235743745, 377.7442297440844, 365.4023975837978, 357.2217181915766, 384.5468041601341, 406.9379474272357, 379.6789559983744, 381.7603574394493, 393.54559104442586, 367.1764034914358, 419.6944085727305, 367.7069175412653, 365.6405789226008, 378.00975048854224, 408.00528386174256, 299.7506122134642, 368.01557773045, 356.67705325979534, 367.80078832976517, 391.07083020660366, 386.58014521840016, 361.515453493676, 397.6623394091033, 322.2738519162898, 340.7629598195407, 361.97531662943953, 336.46049827575854, 365.1158615221302, 367.46905703644126, 377.75950471595604, 337.8697700332677, 349.5826364533988, 358.93683859093477, 389.1234993293124], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.01935721565732, 187.37160815367469, 166.63232543957372, 185.56159151238612, 180.4248447621017, 163.91300342448054, 166.3283293678802, 141.07432465162742, 130.67152644218032, 175.43129289043026, 182.49417392993703, 176.89332802221864, 106.01162776007517, 123.70048298935488, 165.2086461158408, 137.69072590532915, 166.2524081717902, 180.14353189122167, 184.28033968320946, 129.18146488583784, 157.92672512916596, 142.41557897449417, 162.2259985265654, 131.20975434344862, 165.03443648412014, 166.96833339160113, 173.9542546553974, 124.14873356260821, 161.45023285584278, 167.25799438830094, 165.78212011715868, 142.20085733859855, 173.14236163686013, 115.2614260792181, 161.1570351313761, 184.59204639876705, 128.36447073273598, 151.3233749145204, 158.68917792101055, 154.20486329876047, 148.68566178076065, 125.50395059764686, 134.741002516362, 112.78977718330152, 147.3560269362298, 171.4357235582196, 91.80763510995767, 146.7909303394461, 128.74545606084064, 149.3313899943606, 122.16063102564483, 98.42277598403281, 118.4235748549412, 135.85795904418322, 136.46484296202084, 141.10170904330798, 138.3215336787528, 168.91167929203675, 145.48038682899838, 137.61030177009266, 80.91822551332895, 114.75237762221, 131.0296571588766, 152.67733609969966, 91.24028704212995, 107.09358324652867, 122.23434332590261, 136.67866896493263, 97.78736456271557, 58.757214048351386, 171.32801846476275, 150.7215815931045, 136.52106155503924, 148.5754741137842, 127.81534201462281, 157.8619831198817, 164.12450534638563, 138.02029677616525, 140.00982162873265, 137.54587251191313, 142.94376853173617, 121.37279181756139, 122.29110341057452, 156.17361088506576, 120.72841731562902, 155.40187796507567, 106.81721072380651, 102.86107170621148, 40.708301954457255, 115.64270775056636, 110.99082609172561, 56.872000775906415, 108.75619689411049, 59.590130890529316, 53.557072670522594, 75.48036552108124, 106.39842059673681, 36.620374126771495, 101.50399443980001, 97.01137393397508, 133.24191509416053, 85.47404488875061, 75.28224733536295, 124.56683394764659, 139.6170920530889, 114.54542569883266, 126.93999940981918, -2.496806240035286, 79.52884854688568, 99.74644651126694, 152.9420494175669, 135.7607163968277, 119.74188237686693, 84.39800404239273, 134.77965953546268, 97.48211073526485, 144.98184936639558, 123.25747813758983, 104.87928470804162, 148.34579405262136, 104.42037653589674, 123.10427013736245, 141.03299599064002, 159.55392251726738, 135.6067702612842, 163.51390664470816, 129.52121987433463, 90.56963617023192, 150.47928019846603, 121.9874107945306, 96.6701747162027, 125.38698152058846, 127.1088291653363, 102.03116292166864, 75.59006627815229, 36.51689507381691, 126.0513611870112, 123.3132761968734, 155.7648403833439, 130.19595057400565, 67.50048212159204, 146.21610875651686, 64.33844793350598, 79.48825090149317, 144.0651055182552, 6.819733920868529, 96.23745518927116, 144.26951438580238, 71.56741798078332, 74.37120670457985, 122.11735154585358, 120.14767133279567, 9.475214827585354, 81.61846196024614, 143.25683382552774, 77.49119939334048, 141.15257713333364, 128.80725710365394, 101.65721592979742, 140.52649228307828, 90.70885596746304, 124.45130109111201, 117.15611739079952, 95.8840094859517, 58.09831935111416, -21.9868330042969, 121.11898137329993, 114.79430997835507, 127.77745870615888, 99.97438973129225, 119.00219147072515, 117.33859996531471, 133.86146579230086, 127.4817292396143, 106.30160967804908, 36.82427783483337, 57.19260493738345, 105.23462702685903, 59.057351765272905, 82.76691459954357, 86.95292712394208, 103.15229466695372, 82.16918953294925, 63.98049588876071, 83.15321887197635, 81.58840832172571, 92.24690392602805, 140.81389603764987, 60.19420267880149, 67.23638158432433, 110.00316402331714, 92.57008477781412, 100.93236241632728, 81.25367948163662, 99.72531647266231, 84.44020306502611, 105.83818212794586, 144.183378452548, 110.04662416277235, 115.00390521901653], "policy_predator_policy_reward": [18.369771205744026, 13.111514895101493, 28.3458401777861, 8.243552858536201, 22.27146491043515, 29.9680663674686, 38.374844188657455, 5.8679895858355025, 44.48814811966789, 42.5233848308892, 26.188742889475886, 15.91090873066159, 57.60015624864647, 60.166355746945406, 20.701689374541225, 33.061131478679755, 26.604862287276994, 5.14682525047696, 37.66242752712507, 38.853063052312294, 51.743232284368396, 21.43000311018602, 43.84483035976363, 26.124293796016786, 7.507029763970362, 29.022826300747138, 50.16661032843359, 21.489425041161937, 18.438248089533463, 32.81255410760181, 53.35858736352989, 11.428271487071356, 41.65975646882645, 23.06610022720921, 15.780634434316632, 16.88999553725031, 44.62821656078312, 71.07344753072016, 44.90083115914709, 25.564870644736175, 54.548266988524816, 39.367791224793656, 93.22556900839484, 0.4210172902303745, 37.753831236099096, 33.50942113295318, 0.0, 118.03546706337372, 55.60053028447385, 36.533649989518345, 84.53269280068616, 40.296427589810136, 31.453293227055845, 87.32197421368947, 61.2256376037532, 32.64327517904072, 22.208211555559114, 42.64655916814473, 34.891894174766364, 55.31056151290985, 122.43848891338926, 74.65497432369236, 33.57576048857103, 55.51839149490337, 99.09227386297052, 82.98158903249804, 37.22614546429062, 51.408118226226534, 119.22553723935246, 109.77481930592215, 42.30875559634623, 26.98646004192712, 62.87179447481277, 34.166511499698856, 23.78444181164595, 27.458380143560227, 25.820738748298105, 38.613323879859074, 39.34272636301243, 55.853545236984154, 56.40148442155644, 57.49529271002744, 56.507080147776186, 47.147459484877665, 42.708688074228334, 30.118076753620944, 65.94780638948129, 105.88907206719995, 107.58239819424195, 83.42001075865564, 134.40093013907315, 115.46133086778043, 78.37283947168049, 103.9860770970873, 93.35750107224106, 132.08424737173684, 144.43358840862214, 68.94241710266789, 66.79160015131927, 124.69914823601235, 67.60023265252086, 95.61038692808829, 111.04463481955804, 79.82451354610717, 45.450612882583755, 73.24344784398409, 150.80896146339575, 107.11767842812884, 99.22143185425763, 76.45378196742482, 38.56431488227841, 60.21112427053189, 75.68605517482449, 88.33615692795756, 50.84214313727311, 95.68297617848356, 3.761675959301352, 73.36914082081013, 52.061262979365324, 65.51336769871202, 75.08530060687693, 72.1709742236948, 56.627196008362944, 7.274783280313317, 56.54584376130947, 40.51443137731196, 67.30905676082992, 114.87924330903677, 46.92562719634885, 47.37288995020473, 66.30708474045024, 66.79201618547538, 83.43286717625972, 34.67288309417222, 126.43183666465347, 139.20543172746184, 69.66958972609977, 46.36817047381359, 44.06761777402175, 27.1933094602054, 87.21608052495834, 83.61413275706704, 115.33912225214337, 147.7721263400938, 111.64441766759136, 117.14969889165944, 58.50966244250423, 82.74372542187194, 98.81655331369464, 148.79041304536804, 75.62045837310902, 49.29092223967795, 127.66376254560426, 200.93696923929426, 94.88683224881163, 52.072052073585546, 55.10488135822322, 40.575863327390216, 81.74468918247148, 54.08135309319488, 95.18433151579727, 97.66079528737039, 36.427684197468835, 50.2828011392442, 155.0814720281026, 176.82261935553055, 44.314871889239626, 76.44889001890087, 71.24974504364235, 68.79919484867187, 91.81627569594312, 62.91376307462076, 60.985846486509985, 64.25110369997522, 120.35163059926666, 98.03793538152667, 138.56541944095164, 96.66968800390917, 113.15057536270592, 67.29901018876777, 74.52689014552986, 76.1308478831154, 89.48595571842756, 126.33967548930192, 110.0198286383903, 61.69904244366621, 67.79673867079279, 64.25832288765945, 125.24037568807357, 114.798097085242, 68.38372686126505, 106.80252905355965, 51.19686402838016, 104.4868641069239, 128.70870164978692, 36.70841526592321, 80.49407514459264, 28.421202865848183, 86.44130045160438, 77.63166949591898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6021179362046727, "mean_inference_ms": 1.7727113379168515, "mean_action_processing_ms": 0.2377865494198911, "mean_env_wait_ms": 0.2228657350767368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004044294357299805, "StateBufferConnector_ms": 0.0033391714096069336, "ViewRequirementAgentConnector_ms": 0.10583245754241943}, "num_episodes": 18, "episode_return_max": 419.6944085727305, "episode_return_min": 299.7506122134642, "episode_return_mean": 371.6750854120135, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.2873807102914, "num_env_steps_trained_throughput_per_sec": 377.2873807102914, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 10839.942, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10839.888, "sample_time_ms": 1428.543, "learn_time_ms": 9394.073, "learn_throughput": 425.8, "synch_weights_time_ms": 15.106}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "e552a_00000", "date": "2024-08-16_08-50-10", "timestamp": 1723778410, "time_this_iter_s": 10.644965887069702, "time_total_s": 220.70462703704834, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72de9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.70462703704834, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 31.713333333333328, "ram_util_percent": 82.90666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5771130037055445, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.850276018828943, "policy_loss": -0.011492998832738195, "vf_loss": 8.857964842407792, "vf_explained_var": 0.045259259869812656, "kl": 0.016907449536698586, "entropy": 1.4559629439046142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2788829809774165, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.863670027445233, "policy_loss": -0.0060058349433044595, "vf_loss": 8.867832881180698, "vf_explained_var": 0.046161613514814424, "kl": 0.009214971510958108, "entropy": 1.5064100116018264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 419.6944085727305, "episode_reward_min": 299.7506122134642, "episode_reward_mean": 367.8751634745472, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -27.18146723655315, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.4357235582196, "predator_policy": 238.3166894734007}, "policy_reward_mean": {"prey_policy": 103.56279982815813, "predator_policy": 80.3747819091155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [395.38950973875944, 383.3597430236545, 368.10567059172604, 341.1773659982889, 390.0550028635016, 356.6340325127774, 370.2110263291935, 345.41252740017393, 373.05680133986976, 371.43546478812266, 372.0879836944936, 373.29314428676736, 392.76406637262045, 372.80114524205055, 380.40773318412727, 347.54727598135247, 385.5449351563415, 391.3448156961404, 382.1348416433352, 336.9201470897108, 366.57886475070814, 372.7519657406424, 378.2133374808812, 382.1192539282941, 348.9570601085538, 381.51516088669894, 347.35341865792105, 417.7250878744856, 350.7052443534077, 354.47918663558164, 356.39480023479797, 390.0061167611066, 381.92657956352076, 390.7182296486749, 372.8565784784895, 382.36983306130867, 354.95050887983547, 387.478204967205, 368.1620985220416, 378.7868895864845, 345.3701442840968, 370.79970943874036, 374.78092150383037, 364.48889779658356, 396.1809520446137, 402.27915611443274, 366.7652081395501, 355.1562571627164, 347.24574235743745, 377.7442297440844, 365.4023975837978, 357.2217181915766, 384.5468041601341, 406.9379474272357, 379.6789559983744, 381.7603574394493, 393.54559104442586, 367.1764034914358, 419.6944085727305, 367.7069175412653, 365.6405789226008, 378.00975048854224, 408.00528386174256, 299.7506122134642, 368.01557773045, 356.67705325979534, 367.80078832976517, 391.07083020660366, 386.58014521840016, 361.515453493676, 397.6623394091033, 322.2738519162898, 340.7629598195407, 361.97531662943953, 336.46049827575854, 365.1158615221302, 367.46905703644126, 377.75950471595604, 337.8697700332677, 349.5826364533988, 358.93683859093477, 389.1234993293124, 361.3279333822569, 369.1976836592864, 338.199319963483, 359.5858328941585, 347.6645142718689, 368.10874684742373, 338.21124151209193, 365.9175695030344, 360.2323616096231, 355.89032138392025, 359.8364926173774, 359.9929412827021, 318.61125730349045, 368.25353228378685, 356.2101962857342, 325.9499492662525, 368.434039008277, 359.6198338331817], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.36447073273598, 151.3233749145204, 158.68917792101055, 154.20486329876047, 148.68566178076065, 125.50395059764686, 134.741002516362, 112.78977718330152, 147.3560269362298, 171.4357235582196, 91.80763510995767, 146.7909303394461, 128.74545606084064, 149.3313899943606, 122.16063102564483, 98.42277598403281, 118.4235748549412, 135.85795904418322, 136.46484296202084, 141.10170904330798, 138.3215336787528, 168.91167929203675, 145.48038682899838, 137.61030177009266, 80.91822551332895, 114.75237762221, 131.0296571588766, 152.67733609969966, 91.24028704212995, 107.09358324652867, 122.23434332590261, 136.67866896493263, 97.78736456271557, 58.757214048351386, 171.32801846476275, 150.7215815931045, 136.52106155503924, 148.5754741137842, 127.81534201462281, 157.8619831198817, 164.12450534638563, 138.02029677616525, 140.00982162873265, 137.54587251191313, 142.94376853173617, 121.37279181756139, 122.29110341057452, 156.17361088506576, 120.72841731562902, 155.40187796507567, 106.81721072380651, 102.86107170621148, 40.708301954457255, 115.64270775056636, 110.99082609172561, 56.872000775906415, 108.75619689411049, 59.590130890529316, 53.557072670522594, 75.48036552108124, 106.39842059673681, 36.620374126771495, 101.50399443980001, 97.01137393397508, 133.24191509416053, 85.47404488875061, 75.28224733536295, 124.56683394764659, 139.6170920530889, 114.54542569883266, 126.93999940981918, -2.496806240035286, 79.52884854688568, 99.74644651126694, 152.9420494175669, 135.7607163968277, 119.74188237686693, 84.39800404239273, 134.77965953546268, 97.48211073526485, 144.98184936639558, 123.25747813758983, 104.87928470804162, 148.34579405262136, 104.42037653589674, 123.10427013736245, 141.03299599064002, 159.55392251726738, 135.6067702612842, 163.51390664470816, 129.52121987433463, 90.56963617023192, 150.47928019846603, 121.9874107945306, 96.6701747162027, 125.38698152058846, 127.1088291653363, 102.03116292166864, 75.59006627815229, 36.51689507381691, 126.0513611870112, 123.3132761968734, 155.7648403833439, 130.19595057400565, 67.50048212159204, 146.21610875651686, 64.33844793350598, 79.48825090149317, 144.0651055182552, 6.819733920868529, 96.23745518927116, 144.26951438580238, 71.56741798078332, 74.37120670457985, 122.11735154585358, 120.14767133279567, 9.475214827585354, 81.61846196024614, 143.25683382552774, 77.49119939334048, 141.15257713333364, 128.80725710365394, 101.65721592979742, 140.52649228307828, 90.70885596746304, 124.45130109111201, 117.15611739079952, 95.8840094859517, 58.09831935111416, -21.9868330042969, 121.11898137329993, 114.79430997835507, 127.77745870615888, 99.97438973129225, 119.00219147072515, 117.33859996531471, 133.86146579230086, 127.4817292396143, 106.30160967804908, 36.82427783483337, 57.19260493738345, 105.23462702685903, 59.057351765272905, 82.76691459954357, 86.95292712394208, 103.15229466695372, 82.16918953294925, 63.98049588876071, 83.15321887197635, 81.58840832172571, 92.24690392602805, 140.81389603764987, 60.19420267880149, 67.23638158432433, 110.00316402331714, 92.57008477781412, 100.93236241632728, 81.25367948163662, 99.72531647266231, 84.44020306502611, 105.83818212794586, 144.183378452548, 110.04662416277235, 115.00390521901653, 69.7864739241708, 95.0156124023033, 68.09768911970858, 62.27870936423318, 109.68429526687909, 63.55239225720233, 67.8940192920591, 64.75535888469028, 88.17012294374284, 84.12168062065831, 30.60881208452666, 95.10799532865579, 111.46715290242334, 69.13942886624523, 63.636865152091566, 89.69161208758766, 76.38264717602351, 63.240828202162184, 63.46401673136653, 24.926812526204863, 78.00693507637949, 86.68646615368738, 35.36255296227099, 75.36099852210732, 36.433779224427965, -27.18146723655315, 79.93684345882474, 69.14411146810583, 105.60091168387947, 63.51991461534713, 58.09548315997888, 37.909530579337265, 113.95618958318731, 98.24349973947245, 46.25736576516526, 63.18355448626007], "policy_predator_policy_reward": [44.62821656078312, 71.07344753072016, 44.90083115914709, 25.564870644736175, 54.548266988524816, 39.367791224793656, 93.22556900839484, 0.4210172902303745, 37.753831236099096, 33.50942113295318, 0.0, 118.03546706337372, 55.60053028447385, 36.533649989518345, 84.53269280068616, 40.296427589810136, 31.453293227055845, 87.32197421368947, 61.2256376037532, 32.64327517904072, 22.208211555559114, 42.64655916814473, 34.891894174766364, 55.31056151290985, 122.43848891338926, 74.65497432369236, 33.57576048857103, 55.51839149490337, 99.09227386297052, 82.98158903249804, 37.22614546429062, 51.408118226226534, 119.22553723935246, 109.77481930592215, 42.30875559634623, 26.98646004192712, 62.87179447481277, 34.166511499698856, 23.78444181164595, 27.458380143560227, 25.820738748298105, 38.613323879859074, 39.34272636301243, 55.853545236984154, 56.40148442155644, 57.49529271002744, 56.507080147776186, 47.147459484877665, 42.708688074228334, 30.118076753620944, 65.94780638948129, 105.88907206719995, 107.58239819424195, 83.42001075865564, 134.40093013907315, 115.46133086778043, 78.37283947168049, 103.9860770970873, 93.35750107224106, 132.08424737173684, 144.43358840862214, 68.94241710266789, 66.79160015131927, 124.69914823601235, 67.60023265252086, 95.61038692808829, 111.04463481955804, 79.82451354610717, 45.450612882583755, 73.24344784398409, 150.80896146339575, 107.11767842812884, 99.22143185425763, 76.45378196742482, 38.56431488227841, 60.21112427053189, 75.68605517482449, 88.33615692795756, 50.84214313727311, 95.68297617848356, 3.761675959301352, 73.36914082081013, 52.061262979365324, 65.51336769871202, 75.08530060687693, 72.1709742236948, 56.627196008362944, 7.274783280313317, 56.54584376130947, 40.51443137731196, 67.30905676082992, 114.87924330903677, 46.92562719634885, 47.37288995020473, 66.30708474045024, 66.79201618547538, 83.43286717625972, 34.67288309417222, 126.43183666465347, 139.20543172746184, 69.66958972609977, 46.36817047381359, 44.06761777402175, 27.1933094602054, 87.21608052495834, 83.61413275706704, 115.33912225214337, 147.7721263400938, 111.64441766759136, 117.14969889165944, 58.50966244250423, 82.74372542187194, 98.81655331369464, 148.79041304536804, 75.62045837310902, 49.29092223967795, 127.66376254560426, 200.93696923929426, 94.88683224881163, 52.072052073585546, 55.10488135822322, 40.575863327390216, 81.74468918247148, 54.08135309319488, 95.18433151579727, 97.66079528737039, 36.427684197468835, 50.2828011392442, 155.0814720281026, 176.82261935553055, 44.314871889239626, 76.44889001890087, 71.24974504364235, 68.79919484867187, 91.81627569594312, 62.91376307462076, 60.985846486509985, 64.25110369997522, 120.35163059926666, 98.03793538152667, 138.56541944095164, 96.66968800390917, 113.15057536270592, 67.29901018876777, 74.52689014552986, 76.1308478831154, 89.48595571842756, 126.33967548930192, 110.0198286383903, 61.69904244366621, 67.79673867079279, 64.25832288765945, 125.24037568807357, 114.798097085242, 68.38372686126505, 106.80252905355965, 51.19686402838016, 104.4868641069239, 128.70870164978692, 36.70841526592321, 80.49407514459264, 28.421202865848183, 86.44130045160438, 77.63166949591898, 126.75412798038433, 69.77171907539856, 134.10570786002071, 104.71557731532347, 67.25973568697405, 97.70289675242725, 149.35097537837026, 77.58547933903854, 106.64386563522044, 68.72884507224734, 132.51988887248874, 109.87205056175266, 83.20437749963857, 74.40028224378503, 100.86365696795994, 111.72543529539499, 96.95124096981208, 123.65764526162536, 133.66082017866304, 133.83867194768578, 106.08676660756356, 89.05632477974704, 135.269448597489, 113.99994120083512, 71.04225584221487, 238.3166894734007, 125.92917669469531, 93.24340066216094, 88.8845562808373, 98.20481370567029, 93.10770239684125, 136.8372331300952, 67.03159720094885, 89.20275248466879, 108.8791637617687, 141.29974981998737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6027173050752048, "mean_inference_ms": 1.779183475998256, "mean_action_processing_ms": 0.23776033236177468, "mean_env_wait_ms": 0.2232848809201435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004109978675842285, "StateBufferConnector_ms": 0.003331422805786133, "ViewRequirementAgentConnector_ms": 0.10669708251953125}, "num_episodes": 18, "episode_return_max": 419.6944085727305, "episode_return_min": 299.7506122134642, "episode_return_mean": 367.8751634745472, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.20937746735177, "num_env_steps_trained_throughput_per_sec": 369.20937746735177, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 10833.8, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10833.746, "sample_time_ms": 1424.497, "learn_time_ms": 9392.235, "learn_throughput": 425.884, "synch_weights_time_ms": 14.94}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "e552a_00000", "date": "2024-08-16_08-50-21", "timestamp": 1723778421, "time_this_iter_s": 10.872430801391602, "time_total_s": 231.57705783843994, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a73408b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 231.57705783843994, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 28.69375, "ram_util_percent": 82.91875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2544097402739145, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.748929078995236, "policy_loss": -0.008646131275965778, "vf_loss": 8.75468473737202, "vf_explained_var": 0.030371768133980886, "kl": 0.01284672217049018, "entropy": 1.4784033283354745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.530475697189412, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.754596515181204, "policy_loss": -0.00927814657568301, "vf_loss": 8.76127131956595, "vf_explained_var": -0.2073809854567997, "kl": 0.01301681010339067, "entropy": 1.4828789516731544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 419.6944085727305, "episode_reward_min": 296.5762470708654, "episode_reward_mean": 364.48345170996663, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -27.18146723655315, "predator_policy": 3.761675959301352}, "policy_reward_max": {"prey_policy": 163.51390664470816, "predator_policy": 238.3166894734007}, "policy_reward_mean": {"prey_policy": 88.10788330377062, "predator_policy": 94.13384255121268}, "custom_metrics": {}, "hist_stats": {"episode_reward": [417.7250878744856, 350.7052443534077, 354.47918663558164, 356.39480023479797, 390.0061167611066, 381.92657956352076, 390.7182296486749, 372.8565784784895, 382.36983306130867, 354.95050887983547, 387.478204967205, 368.1620985220416, 378.7868895864845, 345.3701442840968, 370.79970943874036, 374.78092150383037, 364.48889779658356, 396.1809520446137, 402.27915611443274, 366.7652081395501, 355.1562571627164, 347.24574235743745, 377.7442297440844, 365.4023975837978, 357.2217181915766, 384.5468041601341, 406.9379474272357, 379.6789559983744, 381.7603574394493, 393.54559104442586, 367.1764034914358, 419.6944085727305, 367.7069175412653, 365.6405789226008, 378.00975048854224, 408.00528386174256, 299.7506122134642, 368.01557773045, 356.67705325979534, 367.80078832976517, 391.07083020660366, 386.58014521840016, 361.515453493676, 397.6623394091033, 322.2738519162898, 340.7629598195407, 361.97531662943953, 336.46049827575854, 365.1158615221302, 367.46905703644126, 377.75950471595604, 337.8697700332677, 349.5826364533988, 358.93683859093477, 389.1234993293124, 361.3279333822569, 369.1976836592864, 338.199319963483, 359.5858328941585, 347.6645142718689, 368.10874684742373, 338.21124151209193, 365.9175695030344, 360.2323616096231, 355.89032138392025, 359.8364926173774, 359.9929412827021, 318.61125730349045, 368.25353228378685, 356.2101962857342, 325.9499492662525, 368.434039008277, 359.6198338331817, 317.1053994569283, 341.5659722593134, 396.79783069216325, 365.9134068102562, 379.87016954699953, 347.3594888611954, 371.3861174868302, 361.81336697966555, 367.32149338773735, 365.29955964144267, 340.60106525389267, 339.1740583242739, 328.1663635841744, 352.5654940817426, 382.1739711701737, 296.5762470708654, 373.82260105126346, 345.6110575054018, 325.23855358297607, 390.9695294213863, 360.99117552092645, 330.1099152611724, 384.8459738918502, 374.3535669305275, 389.7392753134587, 368.8801794651212, 369.74928547690627], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [110.99082609172561, 56.872000775906415, 108.75619689411049, 59.590130890529316, 53.557072670522594, 75.48036552108124, 106.39842059673681, 36.620374126771495, 101.50399443980001, 97.01137393397508, 133.24191509416053, 85.47404488875061, 75.28224733536295, 124.56683394764659, 139.6170920530889, 114.54542569883266, 126.93999940981918, -2.496806240035286, 79.52884854688568, 99.74644651126694, 152.9420494175669, 135.7607163968277, 119.74188237686693, 84.39800404239273, 134.77965953546268, 97.48211073526485, 144.98184936639558, 123.25747813758983, 104.87928470804162, 148.34579405262136, 104.42037653589674, 123.10427013736245, 141.03299599064002, 159.55392251726738, 135.6067702612842, 163.51390664470816, 129.52121987433463, 90.56963617023192, 150.47928019846603, 121.9874107945306, 96.6701747162027, 125.38698152058846, 127.1088291653363, 102.03116292166864, 75.59006627815229, 36.51689507381691, 126.0513611870112, 123.3132761968734, 155.7648403833439, 130.19595057400565, 67.50048212159204, 146.21610875651686, 64.33844793350598, 79.48825090149317, 144.0651055182552, 6.819733920868529, 96.23745518927116, 144.26951438580238, 71.56741798078332, 74.37120670457985, 122.11735154585358, 120.14767133279567, 9.475214827585354, 81.61846196024614, 143.25683382552774, 77.49119939334048, 141.15257713333364, 128.80725710365394, 101.65721592979742, 140.52649228307828, 90.70885596746304, 124.45130109111201, 117.15611739079952, 95.8840094859517, 58.09831935111416, -21.9868330042969, 121.11898137329993, 114.79430997835507, 127.77745870615888, 99.97438973129225, 119.00219147072515, 117.33859996531471, 133.86146579230086, 127.4817292396143, 106.30160967804908, 36.82427783483337, 57.19260493738345, 105.23462702685903, 59.057351765272905, 82.76691459954357, 86.95292712394208, 103.15229466695372, 82.16918953294925, 63.98049588876071, 83.15321887197635, 81.58840832172571, 92.24690392602805, 140.81389603764987, 60.19420267880149, 67.23638158432433, 110.00316402331714, 92.57008477781412, 100.93236241632728, 81.25367948163662, 99.72531647266231, 84.44020306502611, 105.83818212794586, 144.183378452548, 110.04662416277235, 115.00390521901653, 69.7864739241708, 95.0156124023033, 68.09768911970858, 62.27870936423318, 109.68429526687909, 63.55239225720233, 67.8940192920591, 64.75535888469028, 88.17012294374284, 84.12168062065831, 30.60881208452666, 95.10799532865579, 111.46715290242334, 69.13942886624523, 63.636865152091566, 89.69161208758766, 76.38264717602351, 63.240828202162184, 63.46401673136653, 24.926812526204863, 78.00693507637949, 86.68646615368738, 35.36255296227099, 75.36099852210732, 36.433779224427965, -27.18146723655315, 79.93684345882474, 69.14411146810583, 105.60091168387947, 63.51991461534713, 58.09548315997888, 37.909530579337265, 113.95618958318731, 98.24349973947245, 46.25736576516526, 63.18355448626007, 18.86336520661857, 68.9194929088036, 19.061807473797415, 86.78316511783264, 70.39799655979355, 79.0243263138649, 52.75737495643317, 107.81584154368443, 110.93914386980036, 145.22391315277522, 77.23554247964715, 90.96196055306022, 52.108599767274264, 77.05293969118064, 95.36082659783051, 74.11702697091216, 97.53549160242639, 19.5517154667266, 83.77888223891124, 73.61965063255009, 53.86708501185231, 65.20848976567494, 41.10544673480255, 46.54464670931991, 42.01788767061624, 88.61647188071225, 69.51919277365445, 135.6480434264161, 73.76695642679633, 111.45569858505084, 58.165497562364706, -20.15136003530965, 98.73219350345062, 63.15027736697086, 81.69816828531033, 107.62644968511994, 101.16497983511996, 81.50279858672154, 96.32562603551354, 75.52317012424044, 33.4325925261556, 90.83717862307121, 94.5974761865108, 32.362253387730895, 90.43392666872117, 95.14226315316988, 68.40406543908628, 58.820621272230895, 73.17327619441991, 63.35977536699811, 65.7313203308816, 46.93593652516657, 75.40828037990003, 90.93965822804977], "policy_predator_policy_reward": [134.40093013907315, 115.46133086778043, 78.37283947168049, 103.9860770970873, 93.35750107224106, 132.08424737173684, 144.43358840862214, 68.94241710266789, 66.79160015131927, 124.69914823601235, 67.60023265252086, 95.61038692808829, 111.04463481955804, 79.82451354610717, 45.450612882583755, 73.24344784398409, 150.80896146339575, 107.11767842812884, 99.22143185425763, 76.45378196742482, 38.56431488227841, 60.21112427053189, 75.68605517482449, 88.33615692795756, 50.84214313727311, 95.68297617848356, 3.761675959301352, 73.36914082081013, 52.061262979365324, 65.51336769871202, 75.08530060687693, 72.1709742236948, 56.627196008362944, 7.274783280313317, 56.54584376130947, 40.51443137731196, 67.30905676082992, 114.87924330903677, 46.92562719634885, 47.37288995020473, 66.30708474045024, 66.79201618547538, 83.43286717625972, 34.67288309417222, 126.43183666465347, 139.20543172746184, 69.66958972609977, 46.36817047381359, 44.06761777402175, 27.1933094602054, 87.21608052495834, 83.61413275706704, 115.33912225214337, 147.7721263400938, 111.64441766759136, 117.14969889165944, 58.50966244250423, 82.74372542187194, 98.81655331369464, 148.79041304536804, 75.62045837310902, 49.29092223967795, 127.66376254560426, 200.93696923929426, 94.88683224881163, 52.072052073585546, 55.10488135822322, 40.575863327390216, 81.74468918247148, 54.08135309319488, 95.18433151579727, 97.66079528737039, 36.427684197468835, 50.2828011392442, 155.0814720281026, 176.82261935553055, 44.314871889239626, 76.44889001890087, 71.24974504364235, 68.79919484867187, 91.81627569594312, 62.91376307462076, 60.985846486509985, 64.25110369997522, 120.35163059926666, 98.03793538152667, 138.56541944095164, 96.66968800390917, 113.15057536270592, 67.29901018876777, 74.52689014552986, 76.1308478831154, 89.48595571842756, 126.33967548930192, 110.0198286383903, 61.69904244366621, 67.79673867079279, 64.25832288765945, 125.24037568807357, 114.798097085242, 68.38372686126505, 106.80252905355965, 51.19686402838016, 104.4868641069239, 128.70870164978692, 36.70841526592321, 80.49407514459264, 28.421202865848183, 86.44130045160438, 77.63166949591898, 126.75412798038433, 69.77171907539856, 134.10570786002071, 104.71557731532347, 67.25973568697405, 97.70289675242725, 149.35097537837026, 77.58547933903854, 106.64386563522044, 68.72884507224734, 132.51988887248874, 109.87205056175266, 83.20437749963857, 74.40028224378503, 100.86365696795994, 111.72543529539499, 96.95124096981208, 123.65764526162536, 133.66082017866304, 133.83867194768578, 106.08676660756356, 89.05632477974704, 135.269448597489, 113.99994120083512, 71.04225584221487, 238.3166894734007, 125.92917669469531, 93.24340066216094, 88.8845562808373, 98.20481370567029, 93.10770239684125, 136.8372331300952, 67.03159720094885, 89.20275248466879, 108.8791637617687, 141.29974981998737, 144.17648237222338, 85.14605896928268, 103.19974096828977, 132.52125869939354, 126.3253191327344, 121.05018868577048, 123.39625804813626, 81.94393226200155, 59.46363575528407, 64.24347676914, 121.13497962536991, 58.027006203118226, 158.9502391521524, 83.27433887622253, 88.4234500793587, 103.9120633315638, 121.48021787799622, 128.7540684405884, 110.21882836028057, 97.68219840970045, 122.3949319529726, 99.13055852339306, 127.67554054449698, 123.84842433565474, 110.24085600318632, 87.2911480296595, 58.75959531842558, 88.6386625632464, 105.34960188950049, 91.60171426882644, 127.41427016202817, 131.147839381782, 119.85209643211464, 92.08803374872701, 90.96135744568443, 65.32508208928706, 74.84046188125714, 67.7303132798774, 99.24813449606458, 119.8725987655678, 149.88957684476784, 86.83182752693155, 95.5782803035352, 107.57190538339545, 96.38092215312413, 102.88886191683478, 105.05327371858216, 142.075606500628, 125.83058473254393, 127.37563901949642, 106.54872063982003, 149.66420196925318, 89.89722111144015, 113.50412575751587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.600715009451988, "mean_inference_ms": 1.7780153892812616, "mean_action_processing_ms": 0.2369454327365155, "mean_env_wait_ms": 0.22293911480153508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042389631271362305, "StateBufferConnector_ms": 0.003420591354370117, "ViewRequirementAgentConnector_ms": 0.1053318977355957}, "num_episodes": 27, "episode_return_max": 419.6944085727305, "episode_return_min": 296.5762470708654, "episode_return_mean": 364.48345170996663, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.57337277995526, "num_env_steps_trained_throughput_per_sec": 353.57337277995526, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 10870.083, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10870.026, "sample_time_ms": 1415.134, "learn_time_ms": 9437.583, "learn_throughput": 423.837, "synch_weights_time_ms": 15.057}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "e552a_00000", "date": "2024-08-16_08-50-32", "timestamp": 1723778432, "time_this_iter_s": 11.352425813674927, "time_total_s": 242.92948365211487, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7295310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.92948365211487, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 36.125, "ram_util_percent": 83.6375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3744284702987266, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.777193006132014, "policy_loss": -0.0034281715522791263, "vf_loss": 8.77766452390681, "vf_explained_var": 0.016400741427033037, "kl": 0.0131407024164272, "entropy": 1.4300179651805334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6257493697776995, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.492756438886047, "policy_loss": -0.00633422751891274, "vf_loss": 8.49658897616876, "vf_explained_var": -0.08987577163353168, "kl": 0.012508560078924301, "entropy": 1.4896038328529035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 446.9631118840297, "episode_reward_min": 296.5762470708654, "episode_reward_mean": 366.9495619617012, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.7824055537128, "predator_policy": 27.1933094602054}, "policy_reward_max": {"prey_policy": 156.96309591488725, "predator_policy": 356.4402905003165}, "policy_reward_mean": {"prey_policy": 82.68661659235177, "predator_policy": 100.78816438849883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [402.27915611443274, 366.7652081395501, 355.1562571627164, 347.24574235743745, 377.7442297440844, 365.4023975837978, 357.2217181915766, 384.5468041601341, 406.9379474272357, 379.6789559983744, 381.7603574394493, 393.54559104442586, 367.1764034914358, 419.6944085727305, 367.7069175412653, 365.6405789226008, 378.00975048854224, 408.00528386174256, 299.7506122134642, 368.01557773045, 356.67705325979534, 367.80078832976517, 391.07083020660366, 386.58014521840016, 361.515453493676, 397.6623394091033, 322.2738519162898, 340.7629598195407, 361.97531662943953, 336.46049827575854, 365.1158615221302, 367.46905703644126, 377.75950471595604, 337.8697700332677, 349.5826364533988, 358.93683859093477, 389.1234993293124, 361.3279333822569, 369.1976836592864, 338.199319963483, 359.5858328941585, 347.6645142718689, 368.10874684742373, 338.21124151209193, 365.9175695030344, 360.2323616096231, 355.89032138392025, 359.8364926173774, 359.9929412827021, 318.61125730349045, 368.25353228378685, 356.2101962857342, 325.9499492662525, 368.434039008277, 359.6198338331817, 317.1053994569283, 341.5659722593134, 396.79783069216325, 365.9134068102562, 379.87016954699953, 347.3594888611954, 371.3861174868302, 361.81336697966555, 367.32149338773735, 365.29955964144267, 340.60106525389267, 339.1740583242739, 328.1663635841744, 352.5654940817426, 382.1739711701737, 296.5762470708654, 373.82260105126346, 345.6110575054018, 325.23855358297607, 390.9695294213863, 360.99117552092645, 330.1099152611724, 384.8459738918502, 374.3535669305275, 389.7392753134587, 368.8801794651212, 369.74928547690627, 348.304541609706, 373.260137432661, 384.7319930475655, 396.0521237101972, 350.76265506662315, 417.0144271821424, 384.6505454139029, 378.57687929395786, 373.794733091994, 383.7237649171514, 446.9631118840297, 380.50003587048866, 385.99476580778577, 366.80675843948774, 406.8440693830658, 418.87514983764447, 368.55390766881357, 419.3814091510488], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [129.52121987433463, 90.56963617023192, 150.47928019846603, 121.9874107945306, 96.6701747162027, 125.38698152058846, 127.1088291653363, 102.03116292166864, 75.59006627815229, 36.51689507381691, 126.0513611870112, 123.3132761968734, 155.7648403833439, 130.19595057400565, 67.50048212159204, 146.21610875651686, 64.33844793350598, 79.48825090149317, 144.0651055182552, 6.819733920868529, 96.23745518927116, 144.26951438580238, 71.56741798078332, 74.37120670457985, 122.11735154585358, 120.14767133279567, 9.475214827585354, 81.61846196024614, 143.25683382552774, 77.49119939334048, 141.15257713333364, 128.80725710365394, 101.65721592979742, 140.52649228307828, 90.70885596746304, 124.45130109111201, 117.15611739079952, 95.8840094859517, 58.09831935111416, -21.9868330042969, 121.11898137329993, 114.79430997835507, 127.77745870615888, 99.97438973129225, 119.00219147072515, 117.33859996531471, 133.86146579230086, 127.4817292396143, 106.30160967804908, 36.82427783483337, 57.19260493738345, 105.23462702685903, 59.057351765272905, 82.76691459954357, 86.95292712394208, 103.15229466695372, 82.16918953294925, 63.98049588876071, 83.15321887197635, 81.58840832172571, 92.24690392602805, 140.81389603764987, 60.19420267880149, 67.23638158432433, 110.00316402331714, 92.57008477781412, 100.93236241632728, 81.25367948163662, 99.72531647266231, 84.44020306502611, 105.83818212794586, 144.183378452548, 110.04662416277235, 115.00390521901653, 69.7864739241708, 95.0156124023033, 68.09768911970858, 62.27870936423318, 109.68429526687909, 63.55239225720233, 67.8940192920591, 64.75535888469028, 88.17012294374284, 84.12168062065831, 30.60881208452666, 95.10799532865579, 111.46715290242334, 69.13942886624523, 63.636865152091566, 89.69161208758766, 76.38264717602351, 63.240828202162184, 63.46401673136653, 24.926812526204863, 78.00693507637949, 86.68646615368738, 35.36255296227099, 75.36099852210732, 36.433779224427965, -27.18146723655315, 79.93684345882474, 69.14411146810583, 105.60091168387947, 63.51991461534713, 58.09548315997888, 37.909530579337265, 113.95618958318731, 98.24349973947245, 46.25736576516526, 63.18355448626007, 18.86336520661857, 68.9194929088036, 19.061807473797415, 86.78316511783264, 70.39799655979355, 79.0243263138649, 52.75737495643317, 107.81584154368443, 110.93914386980036, 145.22391315277522, 77.23554247964715, 90.96196055306022, 52.108599767274264, 77.05293969118064, 95.36082659783051, 74.11702697091216, 97.53549160242639, 19.5517154667266, 83.77888223891124, 73.61965063255009, 53.86708501185231, 65.20848976567494, 41.10544673480255, 46.54464670931991, 42.01788767061624, 88.61647188071225, 69.51919277365445, 135.6480434264161, 73.76695642679633, 111.45569858505084, 58.165497562364706, -20.15136003530965, 98.73219350345062, 63.15027736697086, 81.69816828531033, 107.62644968511994, 101.16497983511996, 81.50279858672154, 96.32562603551354, 75.52317012424044, 33.4325925261556, 90.83717862307121, 94.5974761865108, 32.362253387730895, 90.43392666872117, 95.14226315316988, 68.40406543908628, 58.820621272230895, 73.17327619441991, 63.35977536699811, 65.7313203308816, 46.93593652516657, 75.40828037990003, 90.93965822804977, 127.29784107478872, 33.29914117986695, 93.40871877749159, 55.63133909163714, 98.67685134044294, 51.07134876821442, 60.25357036950779, 53.582665189381395, 65.0274802115988, 44.75108037901184, 67.05657530398594, 134.0148853439397, 111.62703993541548, 71.65069896427546, 82.2689075844957, 78.03178224486028, 130.49585900097136, 19.062223362610656, 132.01530030774316, 104.1971807947031, -239.7824055537128, 117.83570922484651, 93.8354462065722, 21.210699542738123, 69.51933338376631, 73.90143309312086, 119.96591700499724, 156.96309591488725, 127.72468241044851, 44.38432817948217, 143.37132743013942, 70.76461145469541, 72.60992175728566, 53.76114147653444, 141.58357698773708, 91.70522402087845], "policy_predator_policy_reward": [67.30905676082992, 114.87924330903677, 46.92562719634885, 47.37288995020473, 66.30708474045024, 66.79201618547538, 83.43286717625972, 34.67288309417222, 126.43183666465347, 139.20543172746184, 69.66958972609977, 46.36817047381359, 44.06761777402175, 27.1933094602054, 87.21608052495834, 83.61413275706704, 115.33912225214337, 147.7721263400938, 111.64441766759136, 117.14969889165944, 58.50966244250423, 82.74372542187194, 98.81655331369464, 148.79041304536804, 75.62045837310902, 49.29092223967795, 127.66376254560426, 200.93696923929426, 94.88683224881163, 52.072052073585546, 55.10488135822322, 40.575863327390216, 81.74468918247148, 54.08135309319488, 95.18433151579727, 97.66079528737039, 36.427684197468835, 50.2828011392442, 155.0814720281026, 176.82261935553055, 44.314871889239626, 76.44889001890087, 71.24974504364235, 68.79919484867187, 91.81627569594312, 62.91376307462076, 60.985846486509985, 64.25110369997522, 120.35163059926666, 98.03793538152667, 138.56541944095164, 96.66968800390917, 113.15057536270592, 67.29901018876777, 74.52689014552986, 76.1308478831154, 89.48595571842756, 126.33967548930192, 110.0198286383903, 61.69904244366621, 67.79673867079279, 64.25832288765945, 125.24037568807357, 114.798097085242, 68.38372686126505, 106.80252905355965, 51.19686402838016, 104.4868641069239, 128.70870164978692, 36.70841526592321, 80.49407514459264, 28.421202865848183, 86.44130045160438, 77.63166949591898, 126.75412798038433, 69.77171907539856, 134.10570786002071, 104.71557731532347, 67.25973568697405, 97.70289675242725, 149.35097537837026, 77.58547933903854, 106.64386563522044, 68.72884507224734, 132.51988887248874, 109.87205056175266, 83.20437749963857, 74.40028224378503, 100.86365696795994, 111.72543529539499, 96.95124096981208, 123.65764526162536, 133.66082017866304, 133.83867194768578, 106.08676660756356, 89.05632477974704, 135.269448597489, 113.99994120083512, 71.04225584221487, 238.3166894734007, 125.92917669469531, 93.24340066216094, 88.8845562808373, 98.20481370567029, 93.10770239684125, 136.8372331300952, 67.03159720094885, 89.20275248466879, 108.8791637617687, 141.29974981998737, 144.17648237222338, 85.14605896928268, 103.19974096828977, 132.52125869939354, 126.3253191327344, 121.05018868577048, 123.39625804813626, 81.94393226200155, 59.46363575528407, 64.24347676914, 121.13497962536991, 58.027006203118226, 158.9502391521524, 83.27433887622253, 88.4234500793587, 103.9120633315638, 121.48021787799622, 128.7540684405884, 110.21882836028057, 97.68219840970045, 122.3949319529726, 99.13055852339306, 127.67554054449698, 123.84842433565474, 110.24085600318632, 87.2911480296595, 58.75959531842558, 88.6386625632464, 105.34960188950049, 91.60171426882644, 127.41427016202817, 131.147839381782, 119.85209643211464, 92.08803374872701, 90.96135744568443, 65.32508208928706, 74.84046188125714, 67.7303132798774, 99.24813449606458, 119.8725987655678, 149.88957684476784, 86.83182752693155, 95.5782803035352, 107.57190538339545, 96.38092215312413, 102.88886191683478, 105.05327371858216, 142.075606500628, 125.83058473254393, 127.37563901949642, 106.54872063982003, 149.66420196925318, 89.89722111144015, 113.50412575751587, 85.24169277614787, 102.46586657890234, 106.38378802769456, 117.83629153583777, 120.59043624568773, 114.3933566932203, 142.73609270502928, 139.47979544627853, 133.4241907233527, 107.55990375265996, 108.4176377271302, 107.52532880708668, 98.37787779530406, 102.99492871890756, 98.87698766603219, 119.39920179856979, 88.65741579974332, 135.5792349286688, 69.55426309180554, 77.9570207228994, 212.4695177125797, 356.4402905003165, 126.28843573146834, 139.16545438970962, 119.82074768160842, 122.75325164929019, 39.408265241861244, 50.469480277741944, 125.23203105717754, 109.50302773595794, 105.88445497884828, 98.85475597396145, 113.94751644886617, 128.23532798612695, 81.95790489473167, 104.13470324770134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5991351856805892, "mean_inference_ms": 1.7831825762402547, "mean_action_processing_ms": 0.23663186284424373, "mean_env_wait_ms": 0.22294161222261757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004473567008972168, "StateBufferConnector_ms": 0.003414154052734375, "ViewRequirementAgentConnector_ms": 0.09641051292419434}, "num_episodes": 18, "episode_return_max": 446.9631118840297, "episode_return_min": 296.5762470708654, "episode_return_mean": 366.9495619617012, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.29375808083637, "num_env_steps_trained_throughput_per_sec": 376.29375808083637, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 10863.999, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10863.941, "sample_time_ms": 1425.732, "learn_time_ms": 9420.991, "learn_throughput": 424.584, "synch_weights_time_ms": 15.023}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "e552a_00000", "date": "2024-08-16_08-50-43", "timestamp": 1723778443, "time_this_iter_s": 10.68146014213562, "time_total_s": 253.6109437942505, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72efc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 253.6109437942505, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 32.373333333333335, "ram_util_percent": 83.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3810505668952984, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6364946617651235, "policy_loss": -0.005745104668050925, "vf_loss": 7.6397691270031, "vf_explained_var": -0.040270928415671856, "kl": 0.010980610694713549, "entropy": 1.4062907259300272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.195898044235492, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.807346356104291, "policy_loss": -0.012879592414930582, "vf_loss": 7.816398100625901, "vf_explained_var": 0.047727676863392826, "kl": 0.01913932023230339, "entropy": 1.4918046799286333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 446.9631118840297, "episode_reward_min": 296.5762470708654, "episode_reward_mean": 369.7986725669665, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.7824055537128, "predator_policy": 28.421202865848183}, "policy_reward_max": {"prey_policy": 182.53336880929544, "predator_policy": 356.4402905003165}, "policy_reward_mean": {"prey_policy": 87.15319058468165, "predator_policy": 97.74614569880156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.7506122134642, 368.01557773045, 356.67705325979534, 367.80078832976517, 391.07083020660366, 386.58014521840016, 361.515453493676, 397.6623394091033, 322.2738519162898, 340.7629598195407, 361.97531662943953, 336.46049827575854, 365.1158615221302, 367.46905703644126, 377.75950471595604, 337.8697700332677, 349.5826364533988, 358.93683859093477, 389.1234993293124, 361.3279333822569, 369.1976836592864, 338.199319963483, 359.5858328941585, 347.6645142718689, 368.10874684742373, 338.21124151209193, 365.9175695030344, 360.2323616096231, 355.89032138392025, 359.8364926173774, 359.9929412827021, 318.61125730349045, 368.25353228378685, 356.2101962857342, 325.9499492662525, 368.434039008277, 359.6198338331817, 317.1053994569283, 341.5659722593134, 396.79783069216325, 365.9134068102562, 379.87016954699953, 347.3594888611954, 371.3861174868302, 361.81336697966555, 367.32149338773735, 365.29955964144267, 340.60106525389267, 339.1740583242739, 328.1663635841744, 352.5654940817426, 382.1739711701737, 296.5762470708654, 373.82260105126346, 345.6110575054018, 325.23855358297607, 390.9695294213863, 360.99117552092645, 330.1099152611724, 384.8459738918502, 374.3535669305275, 389.7392753134587, 368.8801794651212, 369.74928547690627, 348.304541609706, 373.260137432661, 384.7319930475655, 396.0521237101972, 350.76265506662315, 417.0144271821424, 384.6505454139029, 378.57687929395786, 373.794733091994, 383.7237649171514, 446.9631118840297, 380.50003587048866, 385.99476580778577, 366.80675843948774, 406.8440693830658, 418.87514983764447, 368.55390766881357, 419.3814091510488, 371.95903539466906, 394.6722660041428, 387.2921322216052, 412.20024249762037, 404.89238641002567, 384.7562638479958, 401.9382947075374, 416.02534559895133, 411.25308826361425, 394.02458590535605, 399.1971377442347, 369.15184319452, 403.87995541122075, 412.9401582385696, 398.779596843206, 401.12987968401086, 376.1173793376296, 369.21917746315086], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.15611739079952, 95.8840094859517, 58.09831935111416, -21.9868330042969, 121.11898137329993, 114.79430997835507, 127.77745870615888, 99.97438973129225, 119.00219147072515, 117.33859996531471, 133.86146579230086, 127.4817292396143, 106.30160967804908, 36.82427783483337, 57.19260493738345, 105.23462702685903, 59.057351765272905, 82.76691459954357, 86.95292712394208, 103.15229466695372, 82.16918953294925, 63.98049588876071, 83.15321887197635, 81.58840832172571, 92.24690392602805, 140.81389603764987, 60.19420267880149, 67.23638158432433, 110.00316402331714, 92.57008477781412, 100.93236241632728, 81.25367948163662, 99.72531647266231, 84.44020306502611, 105.83818212794586, 144.183378452548, 110.04662416277235, 115.00390521901653, 69.7864739241708, 95.0156124023033, 68.09768911970858, 62.27870936423318, 109.68429526687909, 63.55239225720233, 67.8940192920591, 64.75535888469028, 88.17012294374284, 84.12168062065831, 30.60881208452666, 95.10799532865579, 111.46715290242334, 69.13942886624523, 63.636865152091566, 89.69161208758766, 76.38264717602351, 63.240828202162184, 63.46401673136653, 24.926812526204863, 78.00693507637949, 86.68646615368738, 35.36255296227099, 75.36099852210732, 36.433779224427965, -27.18146723655315, 79.93684345882474, 69.14411146810583, 105.60091168387947, 63.51991461534713, 58.09548315997888, 37.909530579337265, 113.95618958318731, 98.24349973947245, 46.25736576516526, 63.18355448626007, 18.86336520661857, 68.9194929088036, 19.061807473797415, 86.78316511783264, 70.39799655979355, 79.0243263138649, 52.75737495643317, 107.81584154368443, 110.93914386980036, 145.22391315277522, 77.23554247964715, 90.96196055306022, 52.108599767274264, 77.05293969118064, 95.36082659783051, 74.11702697091216, 97.53549160242639, 19.5517154667266, 83.77888223891124, 73.61965063255009, 53.86708501185231, 65.20848976567494, 41.10544673480255, 46.54464670931991, 42.01788767061624, 88.61647188071225, 69.51919277365445, 135.6480434264161, 73.76695642679633, 111.45569858505084, 58.165497562364706, -20.15136003530965, 98.73219350345062, 63.15027736697086, 81.69816828531033, 107.62644968511994, 101.16497983511996, 81.50279858672154, 96.32562603551354, 75.52317012424044, 33.4325925261556, 90.83717862307121, 94.5974761865108, 32.362253387730895, 90.43392666872117, 95.14226315316988, 68.40406543908628, 58.820621272230895, 73.17327619441991, 63.35977536699811, 65.7313203308816, 46.93593652516657, 75.40828037990003, 90.93965822804977, 127.29784107478872, 33.29914117986695, 93.40871877749159, 55.63133909163714, 98.67685134044294, 51.07134876821442, 60.25357036950779, 53.582665189381395, 65.0274802115988, 44.75108037901184, 67.05657530398594, 134.0148853439397, 111.62703993541548, 71.65069896427546, 82.2689075844957, 78.03178224486028, 130.49585900097136, 19.062223362610656, 132.01530030774316, 104.1971807947031, -239.7824055537128, 117.83570922484651, 93.8354462065722, 21.210699542738123, 69.51933338376631, 73.90143309312086, 119.96591700499724, 156.96309591488725, 127.72468241044851, 44.38432817948217, 143.37132743013942, 70.76461145469541, 72.60992175728566, 53.76114147653444, 141.58357698773708, 91.70522402087845, 117.23527234077189, 76.08234580919874, 152.17725658358222, 147.41922778118604, 85.78559970486195, 108.6844884663787, 182.53336880929544, 128.581851238231, 88.78374208994104, 126.4826156718494, 149.78694833800097, 157.9854037653862, 125.32216537790504, 142.37720649774366, 171.73987661027476, 139.45741542880927, 103.77215107215659, 115.16446206565864, 124.94520220020952, 136.4782902008961, 144.25943112534225, 119.85467753128613, 125.35075922287106, 153.02443987115535, 95.97127341609108, 122.05329857847988, 142.98227099304538, 106.26593349393147, 78.21973788450406, 165.53216637954026, 162.5990897741893, 90.67370835064459, 159.07308500302975, 154.93811507217197, 114.4636043790899, 144.7295581992881], "policy_predator_policy_reward": [36.427684197468835, 50.2828011392442, 155.0814720281026, 176.82261935553055, 44.314871889239626, 76.44889001890087, 71.24974504364235, 68.79919484867187, 91.81627569594312, 62.91376307462076, 60.985846486509985, 64.25110369997522, 120.35163059926666, 98.03793538152667, 138.56541944095164, 96.66968800390917, 113.15057536270592, 67.29901018876777, 74.52689014552986, 76.1308478831154, 89.48595571842756, 126.33967548930192, 110.0198286383903, 61.69904244366621, 67.79673867079279, 64.25832288765945, 125.24037568807357, 114.798097085242, 68.38372686126505, 106.80252905355965, 51.19686402838016, 104.4868641069239, 128.70870164978692, 36.70841526592321, 80.49407514459264, 28.421202865848183, 86.44130045160438, 77.63166949591898, 126.75412798038433, 69.77171907539856, 134.10570786002071, 104.71557731532347, 67.25973568697405, 97.70289675242725, 149.35097537837026, 77.58547933903854, 106.64386563522044, 68.72884507224734, 132.51988887248874, 109.87205056175266, 83.20437749963857, 74.40028224378503, 100.86365696795994, 111.72543529539499, 96.95124096981208, 123.65764526162536, 133.66082017866304, 133.83867194768578, 106.08676660756356, 89.05632477974704, 135.269448597489, 113.99994120083512, 71.04225584221487, 238.3166894734007, 125.92917669469531, 93.24340066216094, 88.8845562808373, 98.20481370567029, 93.10770239684125, 136.8372331300952, 67.03159720094885, 89.20275248466879, 108.8791637617687, 141.29974981998737, 144.17648237222338, 85.14605896928268, 103.19974096828977, 132.52125869939354, 126.3253191327344, 121.05018868577048, 123.39625804813626, 81.94393226200155, 59.46363575528407, 64.24347676914, 121.13497962536991, 58.027006203118226, 158.9502391521524, 83.27433887622253, 88.4234500793587, 103.9120633315638, 121.48021787799622, 128.7540684405884, 110.21882836028057, 97.68219840970045, 122.3949319529726, 99.13055852339306, 127.67554054449698, 123.84842433565474, 110.24085600318632, 87.2911480296595, 58.75959531842558, 88.6386625632464, 105.34960188950049, 91.60171426882644, 127.41427016202817, 131.147839381782, 119.85209643211464, 92.08803374872701, 90.96135744568443, 65.32508208928706, 74.84046188125714, 67.7303132798774, 99.24813449606458, 119.8725987655678, 149.88957684476784, 86.83182752693155, 95.5782803035352, 107.57190538339545, 96.38092215312413, 102.88886191683478, 105.05327371858216, 142.075606500628, 125.83058473254393, 127.37563901949642, 106.54872063982003, 149.66420196925318, 89.89722111144015, 113.50412575751587, 85.24169277614787, 102.46586657890234, 106.38378802769456, 117.83629153583777, 120.59043624568773, 114.3933566932203, 142.73609270502928, 139.47979544627853, 133.4241907233527, 107.55990375265996, 108.4176377271302, 107.52532880708668, 98.37787779530406, 102.99492871890756, 98.87698766603219, 119.39920179856979, 88.65741579974332, 135.5792349286688, 69.55426309180554, 77.9570207228994, 212.4695177125797, 356.4402905003165, 126.28843573146834, 139.16545438970962, 119.82074768160842, 122.75325164929019, 39.408265241861244, 50.469480277741944, 125.23203105717754, 109.50302773595794, 105.88445497884828, 98.85475597396145, 113.94751644886617, 128.23532798612695, 81.95790489473167, 104.13470324770134, 70.2241795766352, 108.4172376680627, 62.480823164576485, 32.594958474797856, 98.533648983177, 94.28839506718731, 39.683970086797416, 61.40105236329649, 85.72905737355258, 103.89697127468217, 45.976374264397, 31.00753748021189, 65.92776689249744, 68.31115593939172, 49.09041664666044, 55.73763691320716, 93.35719825448896, 98.95927687131022, 71.1519404443228, 61.44915305992776, 68.52793722115932, 66.55509186644751, 44.49016424695309, 46.28647985354007, 95.37225458887792, 90.48312882777189, 77.49317790044833, 86.1987758511445, 71.82392479968979, 83.20376777947213, 66.51126991286222, 81.34581164631496, 29.72055916019749, 32.38562010223007, 72.55176502672352, 37.474249858049305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5983991358458128, "mean_inference_ms": 1.7876849144166809, "mean_action_processing_ms": 0.2416939780621359, "mean_env_wait_ms": 0.2231142311638415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050470829010009766, "StateBufferConnector_ms": 0.0034461021423339844, "ViewRequirementAgentConnector_ms": 0.09659147262573242}, "num_episodes": 18, "episode_return_max": 446.9631118840297, "episode_return_min": 296.5762470708654, "episode_return_mean": 369.7986725669665, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.00670613266465, "num_env_steps_trained_throughput_per_sec": 362.00670613266465, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 10891.788, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10891.736, "sample_time_ms": 1468.948, "learn_time_ms": 9405.656, "learn_throughput": 425.276, "synch_weights_time_ms": 14.955}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "e552a_00000", "date": "2024-08-16_08-50-54", "timestamp": 1723778454, "time_this_iter_s": 11.058669805526733, "time_total_s": 264.6696135997772, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72efca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.6696135997772, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 32.78125, "ram_util_percent": 83.1875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7152428051151296, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.381716966124439, "policy_loss": -0.005014810465010149, "vf_loss": 7.384968305012537, "vf_explained_var": 0.0041094548487789415, "kl": 0.007837714749674402, "entropy": 1.3390494500518475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.229146381282302, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.593617789707487, "policy_loss": -0.012191791695212482, "vf_loss": 7.6027160967468586, "vf_explained_var": 0.07253174185752868, "kl": 0.015467453802639438, "entropy": 1.4700363355338888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 451.35078420145487, "episode_reward_min": 296.5762470708654, "episode_reward_mean": 377.0597691578704, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.7824055537128, "predator_policy": 11.020530984121459}, "policy_reward_max": {"prey_policy": 184.33205653830106, "predator_policy": 356.4402905003165}, "policy_reward_mean": {"prey_policy": 96.62213340633731, "predator_policy": 91.90775117259784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.1234993293124, 361.3279333822569, 369.1976836592864, 338.199319963483, 359.5858328941585, 347.6645142718689, 368.10874684742373, 338.21124151209193, 365.9175695030344, 360.2323616096231, 355.89032138392025, 359.8364926173774, 359.9929412827021, 318.61125730349045, 368.25353228378685, 356.2101962857342, 325.9499492662525, 368.434039008277, 359.6198338331817, 317.1053994569283, 341.5659722593134, 396.79783069216325, 365.9134068102562, 379.87016954699953, 347.3594888611954, 371.3861174868302, 361.81336697966555, 367.32149338773735, 365.29955964144267, 340.60106525389267, 339.1740583242739, 328.1663635841744, 352.5654940817426, 382.1739711701737, 296.5762470708654, 373.82260105126346, 345.6110575054018, 325.23855358297607, 390.9695294213863, 360.99117552092645, 330.1099152611724, 384.8459738918502, 374.3535669305275, 389.7392753134587, 368.8801794651212, 369.74928547690627, 348.304541609706, 373.260137432661, 384.7319930475655, 396.0521237101972, 350.76265506662315, 417.0144271821424, 384.6505454139029, 378.57687929395786, 373.794733091994, 383.7237649171514, 446.9631118840297, 380.50003587048866, 385.99476580778577, 366.80675843948774, 406.8440693830658, 418.87514983764447, 368.55390766881357, 419.3814091510488, 371.95903539466906, 394.6722660041428, 387.2921322216052, 412.20024249762037, 404.89238641002567, 384.7562638479958, 401.9382947075374, 416.02534559895133, 411.25308826361425, 394.02458590535605, 399.1971377442347, 369.15184319452, 403.87995541122075, 412.9401582385696, 398.779596843206, 401.12987968401086, 376.1173793376296, 369.21917746315086, 426.97658989939833, 351.3151114996325, 451.35078420145487, 416.53794042346897, 395.21851236545155, 411.50875922592394, 380.6989678123554, 381.7309294425553, 426.8467651685074, 407.2075900139022, 402.6362617571261, 407.4473477596788, 391.778282824655, 404.73322627899506, 364.06228875089414, 371.8425995669268, 385.44169059940754, 396.0551063544665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [110.04662416277235, 115.00390521901653, 69.7864739241708, 95.0156124023033, 68.09768911970858, 62.27870936423318, 109.68429526687909, 63.55239225720233, 67.8940192920591, 64.75535888469028, 88.17012294374284, 84.12168062065831, 30.60881208452666, 95.10799532865579, 111.46715290242334, 69.13942886624523, 63.636865152091566, 89.69161208758766, 76.38264717602351, 63.240828202162184, 63.46401673136653, 24.926812526204863, 78.00693507637949, 86.68646615368738, 35.36255296227099, 75.36099852210732, 36.433779224427965, -27.18146723655315, 79.93684345882474, 69.14411146810583, 105.60091168387947, 63.51991461534713, 58.09548315997888, 37.909530579337265, 113.95618958318731, 98.24349973947245, 46.25736576516526, 63.18355448626007, 18.86336520661857, 68.9194929088036, 19.061807473797415, 86.78316511783264, 70.39799655979355, 79.0243263138649, 52.75737495643317, 107.81584154368443, 110.93914386980036, 145.22391315277522, 77.23554247964715, 90.96196055306022, 52.108599767274264, 77.05293969118064, 95.36082659783051, 74.11702697091216, 97.53549160242639, 19.5517154667266, 83.77888223891124, 73.61965063255009, 53.86708501185231, 65.20848976567494, 41.10544673480255, 46.54464670931991, 42.01788767061624, 88.61647188071225, 69.51919277365445, 135.6480434264161, 73.76695642679633, 111.45569858505084, 58.165497562364706, -20.15136003530965, 98.73219350345062, 63.15027736697086, 81.69816828531033, 107.62644968511994, 101.16497983511996, 81.50279858672154, 96.32562603551354, 75.52317012424044, 33.4325925261556, 90.83717862307121, 94.5974761865108, 32.362253387730895, 90.43392666872117, 95.14226315316988, 68.40406543908628, 58.820621272230895, 73.17327619441991, 63.35977536699811, 65.7313203308816, 46.93593652516657, 75.40828037990003, 90.93965822804977, 127.29784107478872, 33.29914117986695, 93.40871877749159, 55.63133909163714, 98.67685134044294, 51.07134876821442, 60.25357036950779, 53.582665189381395, 65.0274802115988, 44.75108037901184, 67.05657530398594, 134.0148853439397, 111.62703993541548, 71.65069896427546, 82.2689075844957, 78.03178224486028, 130.49585900097136, 19.062223362610656, 132.01530030774316, 104.1971807947031, -239.7824055537128, 117.83570922484651, 93.8354462065722, 21.210699542738123, 69.51933338376631, 73.90143309312086, 119.96591700499724, 156.96309591488725, 127.72468241044851, 44.38432817948217, 143.37132743013942, 70.76461145469541, 72.60992175728566, 53.76114147653444, 141.58357698773708, 91.70522402087845, 117.23527234077189, 76.08234580919874, 152.17725658358222, 147.41922778118604, 85.78559970486195, 108.6844884663787, 182.53336880929544, 128.581851238231, 88.78374208994104, 126.4826156718494, 149.78694833800097, 157.9854037653862, 125.32216537790504, 142.37720649774366, 171.73987661027476, 139.45741542880927, 103.77215107215659, 115.16446206565864, 124.94520220020952, 136.4782902008961, 144.25943112534225, 119.85467753128613, 125.35075922287106, 153.02443987115535, 95.97127341609108, 122.05329857847988, 142.98227099304538, 106.26593349393147, 78.21973788450406, 165.53216637954026, 162.5990897741893, 90.67370835064459, 159.07308500302975, 154.93811507217197, 114.4636043790899, 144.7295581992881, 161.979404716393, 144.63487121501367, 160.34422007638867, 143.05014969948755, 47.07595775745678, 169.06365485169246, 155.97969067971113, 184.33205653830106, 177.74611616210757, 146.3078307541706, 177.60584506612207, 133.80164736395727, 98.84755792098528, 98.55917871013172, 148.2053475168333, 154.94883952518, 108.04798357499467, 175.6735913772579, 179.16343039132508, 64.04108386246452, 172.18827562815918, 130.22685376813297, 175.23894067918985, 144.02115129253315, 126.80929225061715, 171.53630305214364, 177.2943561935131, 181.67198815395767, 140.15856238871612, 131.79921347773973, 142.46083123526108, 161.20243429251764, 66.21034106540205, 144.3010778814154, 155.97987351642934, 181.59302646838577], "policy_predator_policy_reward": [86.44130045160438, 77.63166949591898, 126.75412798038433, 69.77171907539856, 134.10570786002071, 104.71557731532347, 67.25973568697405, 97.70289675242725, 149.35097537837026, 77.58547933903854, 106.64386563522044, 68.72884507224734, 132.51988887248874, 109.87205056175266, 83.20437749963857, 74.40028224378503, 100.86365696795994, 111.72543529539499, 96.95124096981208, 123.65764526162536, 133.66082017866304, 133.83867194768578, 106.08676660756356, 89.05632477974704, 135.269448597489, 113.99994120083512, 71.04225584221487, 238.3166894734007, 125.92917669469531, 93.24340066216094, 88.8845562808373, 98.20481370567029, 93.10770239684125, 136.8372331300952, 67.03159720094885, 89.20275248466879, 108.8791637617687, 141.29974981998737, 144.17648237222338, 85.14605896928268, 103.19974096828977, 132.52125869939354, 126.3253191327344, 121.05018868577048, 123.39625804813626, 81.94393226200155, 59.46363575528407, 64.24347676914, 121.13497962536991, 58.027006203118226, 158.9502391521524, 83.27433887622253, 88.4234500793587, 103.9120633315638, 121.48021787799622, 128.7540684405884, 110.21882836028057, 97.68219840970045, 122.3949319529726, 99.13055852339306, 127.67554054449698, 123.84842433565474, 110.24085600318632, 87.2911480296595, 58.75959531842558, 88.6386625632464, 105.34960188950049, 91.60171426882644, 127.41427016202817, 131.147839381782, 119.85209643211464, 92.08803374872701, 90.96135744568443, 65.32508208928706, 74.84046188125714, 67.7303132798774, 99.24813449606458, 119.8725987655678, 149.88957684476784, 86.83182752693155, 95.5782803035352, 107.57190538339545, 96.38092215312413, 102.88886191683478, 105.05327371858216, 142.075606500628, 125.83058473254393, 127.37563901949642, 106.54872063982003, 149.66420196925318, 89.89722111144015, 113.50412575751587, 85.24169277614787, 102.46586657890234, 106.38378802769456, 117.83629153583777, 120.59043624568773, 114.3933566932203, 142.73609270502928, 139.47979544627853, 133.4241907233527, 107.55990375265996, 108.4176377271302, 107.52532880708668, 98.37787779530406, 102.99492871890756, 98.87698766603219, 119.39920179856979, 88.65741579974332, 135.5792349286688, 69.55426309180554, 77.9570207228994, 212.4695177125797, 356.4402905003165, 126.28843573146834, 139.16545438970962, 119.82074768160842, 122.75325164929019, 39.408265241861244, 50.469480277741944, 125.23203105717754, 109.50302773595794, 105.88445497884828, 98.85475597396145, 113.94751644886617, 128.23532798612695, 81.95790489473167, 104.13470324770134, 70.2241795766352, 108.4172376680627, 62.480823164576485, 32.594958474797856, 98.533648983177, 94.28839506718731, 39.683970086797416, 61.40105236329649, 85.72905737355258, 103.89697127468217, 45.976374264397, 31.00753748021189, 65.92776689249744, 68.31115593939172, 49.09041664666044, 55.73763691320716, 93.35719825448896, 98.95927687131022, 71.1519404443228, 61.44915305992776, 68.52793722115932, 66.55509186644751, 44.49016424695309, 46.28647985354007, 95.37225458887792, 90.48312882777189, 77.49317790044833, 86.1987758511445, 71.82392479968979, 83.20376777947213, 66.51126991286222, 81.34581164631496, 29.72055916019749, 32.38562010223007, 72.55176502672352, 37.474249858049305, 65.2851660960036, 55.07714787198786, 28.436995280935648, 19.483746442820703, 108.22098433143019, 126.99018726087606, 31.34833039511403, 44.87786281034273, 32.28312823263762, 38.881437216536035, 52.466309993813375, 47.634956802031276, 89.27606201231904, 94.01616916891959, 45.08842142780116, 33.488320972740816, 85.6948945294047, 57.430295686850705, 61.364819003004555, 102.6382567571079, 64.62970503568695, 35.59142732514679, 34.65228310823004, 53.53497267972584, 45.999332680230964, 47.4333548416633, 22.374815657462193, 23.392066274061857, 45.35082351916614, 46.753689365272265, 11.020530984121459, 57.158803055026766, 85.54846511936245, 89.38180653322772, 28.485143554446104, 29.997062815205137]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5977221584237472, "mean_inference_ms": 1.7926444184329335, "mean_action_processing_ms": 0.2466202314744506, "mean_env_wait_ms": 0.22325247190269043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005453824996948242, "StateBufferConnector_ms": 0.003381013870239258, "ViewRequirementAgentConnector_ms": 0.09724617004394531}, "num_episodes": 18, "episode_return_max": 451.35078420145487, "episode_return_min": 296.5762470708654, "episode_return_mean": 377.0597691578704, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.6385076355423, "num_env_steps_trained_throughput_per_sec": 374.6385076355423, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 10880.577, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10880.522, "sample_time_ms": 1470.528, "learn_time_ms": 9392.628, "learn_throughput": 425.866, "synch_weights_time_ms": 15.034}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "e552a_00000", "date": "2024-08-16_08-51-05", "timestamp": 1723778465, "time_this_iter_s": 10.73542308807373, "time_total_s": 275.40503668785095, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72ef790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 275.40503668785095, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 29.880000000000006, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.164616228789879, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.905045791908547, "policy_loss": -0.007553247263453034, "vf_loss": 6.909165295595845, "vf_explained_var": 0.005325220154706763, "kl": 0.015261090428856778, "entropy": 1.337075075838301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.71744196670396, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.719907052428634, "policy_loss": 0.011379517848288058, "vf_loss": 6.702337296046908, "vf_explained_var": 0.22716726200290457, "kl": 0.03095117804217839, "entropy": 1.5112634517528392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 451.35078420145487, "episode_reward_min": 296.5762470708654, "episode_reward_mean": 382.42863037413406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.7824055537128, "predator_policy": 3.9810394873839385}, "policy_reward_max": {"prey_policy": 195.89689809595265, "predator_policy": 356.4402905003165}, "policy_reward_mean": {"prey_policy": 117.16171468304921, "predator_policy": 74.05260050401786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.9134068102562, 379.87016954699953, 347.3594888611954, 371.3861174868302, 361.81336697966555, 367.32149338773735, 365.29955964144267, 340.60106525389267, 339.1740583242739, 328.1663635841744, 352.5654940817426, 382.1739711701737, 296.5762470708654, 373.82260105126346, 345.6110575054018, 325.23855358297607, 390.9695294213863, 360.99117552092645, 330.1099152611724, 384.8459738918502, 374.3535669305275, 389.7392753134587, 368.8801794651212, 369.74928547690627, 348.304541609706, 373.260137432661, 384.7319930475655, 396.0521237101972, 350.76265506662315, 417.0144271821424, 384.6505454139029, 378.57687929395786, 373.794733091994, 383.7237649171514, 446.9631118840297, 380.50003587048866, 385.99476580778577, 366.80675843948774, 406.8440693830658, 418.87514983764447, 368.55390766881357, 419.3814091510488, 371.95903539466906, 394.6722660041428, 387.2921322216052, 412.20024249762037, 404.89238641002567, 384.7562638479958, 401.9382947075374, 416.02534559895133, 411.25308826361425, 394.02458590535605, 399.1971377442347, 369.15184319452, 403.87995541122075, 412.9401582385696, 398.779596843206, 401.12987968401086, 376.1173793376296, 369.21917746315086, 426.97658989939833, 351.3151114996325, 451.35078420145487, 416.53794042346897, 395.21851236545155, 411.50875922592394, 380.6989678123554, 381.7309294425553, 426.8467651685074, 407.2075900139022, 402.6362617571261, 407.4473477596788, 391.778282824655, 404.73322627899506, 364.06228875089414, 371.8425995669268, 385.44169059940754, 396.0551063544665, 429.42662811331405, 392.0592100847562, 328.8875303690252, 413.99746131604127, 374.8437103192324, 396.6647120592816, 388.85139307986424, 371.9026167552775, 381.6626443484564, 389.6629012631901, 367.0578308263531, 372.09997993695123, 392.0042806128431, 384.99308542160094, 350.41939756478945, 355.167755544087, 394.8167556935217, 388.3291861697573, 357.70935668513334, 371.7749539749966, 387.69581250406486, 372.69538762951055], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [52.75737495643317, 107.81584154368443, 110.93914386980036, 145.22391315277522, 77.23554247964715, 90.96196055306022, 52.108599767274264, 77.05293969118064, 95.36082659783051, 74.11702697091216, 97.53549160242639, 19.5517154667266, 83.77888223891124, 73.61965063255009, 53.86708501185231, 65.20848976567494, 41.10544673480255, 46.54464670931991, 42.01788767061624, 88.61647188071225, 69.51919277365445, 135.6480434264161, 73.76695642679633, 111.45569858505084, 58.165497562364706, -20.15136003530965, 98.73219350345062, 63.15027736697086, 81.69816828531033, 107.62644968511994, 101.16497983511996, 81.50279858672154, 96.32562603551354, 75.52317012424044, 33.4325925261556, 90.83717862307121, 94.5974761865108, 32.362253387730895, 90.43392666872117, 95.14226315316988, 68.40406543908628, 58.820621272230895, 73.17327619441991, 63.35977536699811, 65.7313203308816, 46.93593652516657, 75.40828037990003, 90.93965822804977, 127.29784107478872, 33.29914117986695, 93.40871877749159, 55.63133909163714, 98.67685134044294, 51.07134876821442, 60.25357036950779, 53.582665189381395, 65.0274802115988, 44.75108037901184, 67.05657530398594, 134.0148853439397, 111.62703993541548, 71.65069896427546, 82.2689075844957, 78.03178224486028, 130.49585900097136, 19.062223362610656, 132.01530030774316, 104.1971807947031, -239.7824055537128, 117.83570922484651, 93.8354462065722, 21.210699542738123, 69.51933338376631, 73.90143309312086, 119.96591700499724, 156.96309591488725, 127.72468241044851, 44.38432817948217, 143.37132743013942, 70.76461145469541, 72.60992175728566, 53.76114147653444, 141.58357698773708, 91.70522402087845, 117.23527234077189, 76.08234580919874, 152.17725658358222, 147.41922778118604, 85.78559970486195, 108.6844884663787, 182.53336880929544, 128.581851238231, 88.78374208994104, 126.4826156718494, 149.78694833800097, 157.9854037653862, 125.32216537790504, 142.37720649774366, 171.73987661027476, 139.45741542880927, 103.77215107215659, 115.16446206565864, 124.94520220020952, 136.4782902008961, 144.25943112534225, 119.85467753128613, 125.35075922287106, 153.02443987115535, 95.97127341609108, 122.05329857847988, 142.98227099304538, 106.26593349393147, 78.21973788450406, 165.53216637954026, 162.5990897741893, 90.67370835064459, 159.07308500302975, 154.93811507217197, 114.4636043790899, 144.7295581992881, 161.979404716393, 144.63487121501367, 160.34422007638867, 143.05014969948755, 47.07595775745678, 169.06365485169246, 155.97969067971113, 184.33205653830106, 177.74611616210757, 146.3078307541706, 177.60584506612207, 133.80164736395727, 98.84755792098528, 98.55917871013172, 148.2053475168333, 154.94883952518, 108.04798357499467, 175.6735913772579, 179.16343039132508, 64.04108386246452, 172.18827562815918, 130.22685376813297, 175.23894067918985, 144.02115129253315, 126.80929225061715, 171.53630305214364, 177.2943561935131, 181.67198815395767, 140.15856238871612, 131.79921347773973, 142.46083123526108, 161.20243429251764, 66.21034106540205, 144.3010778814154, 155.97987351642934, 181.59302646838577, 164.77613587070624, 172.21199292256483, 163.8355592070256, 163.9438522943665, 111.81919889089554, 162.36370465392298, 162.0759355353796, 134.5838993634881, 170.9285788168583, 160.46235968987145, 190.69410181341564, 189.3458638032999, 154.60867749318868, 130.58534908479058, 141.15795638179418, 166.06101581220142, 168.01301729737887, 181.0120306027005, 164.64924933090487, 149.8685319564893, 165.03190256619692, 174.7406571481947, 157.83100519112472, 191.17663364290544, 170.68246237584793, 164.63195551291403, 162.90771594501928, 176.346562143066, 164.87550808899547, 114.40885826175301, 141.9666135750043, 144.0535028606951, 168.77594935526716, 195.89689809595265, 175.0202676191325, 178.69804728473858, 144.08335193838656, 134.2136104720076, 172.40011728956657, 184.64761508738061, 185.42955009852616, 178.65435490485555, 166.03428160453552, 142.0517007963837], "policy_predator_policy_reward": [123.39625804813626, 81.94393226200155, 59.46363575528407, 64.24347676914, 121.13497962536991, 58.027006203118226, 158.9502391521524, 83.27433887622253, 88.4234500793587, 103.9120633315638, 121.48021787799622, 128.7540684405884, 110.21882836028057, 97.68219840970045, 122.3949319529726, 99.13055852339306, 127.67554054449698, 123.84842433565474, 110.24085600318632, 87.2911480296595, 58.75959531842558, 88.6386625632464, 105.34960188950049, 91.60171426882644, 127.41427016202817, 131.147839381782, 119.85209643211464, 92.08803374872701, 90.96135744568443, 65.32508208928706, 74.84046188125714, 67.7303132798774, 99.24813449606458, 119.8725987655678, 149.88957684476784, 86.83182752693155, 95.5782803035352, 107.57190538339545, 96.38092215312413, 102.88886191683478, 105.05327371858216, 142.075606500628, 125.83058473254393, 127.37563901949642, 106.54872063982003, 149.66420196925318, 89.89722111144015, 113.50412575751587, 85.24169277614787, 102.46586657890234, 106.38378802769456, 117.83629153583777, 120.59043624568773, 114.3933566932203, 142.73609270502928, 139.47979544627853, 133.4241907233527, 107.55990375265996, 108.4176377271302, 107.52532880708668, 98.37787779530406, 102.99492871890756, 98.87698766603219, 119.39920179856979, 88.65741579974332, 135.5792349286688, 69.55426309180554, 77.9570207228994, 212.4695177125797, 356.4402905003165, 126.28843573146834, 139.16545438970962, 119.82074768160842, 122.75325164929019, 39.408265241861244, 50.469480277741944, 125.23203105717754, 109.50302773595794, 105.88445497884828, 98.85475597396145, 113.94751644886617, 128.23532798612695, 81.95790489473167, 104.13470324770134, 70.2241795766352, 108.4172376680627, 62.480823164576485, 32.594958474797856, 98.533648983177, 94.28839506718731, 39.683970086797416, 61.40105236329649, 85.72905737355258, 103.89697127468217, 45.976374264397, 31.00753748021189, 65.92776689249744, 68.31115593939172, 49.09041664666044, 55.73763691320716, 93.35719825448896, 98.95927687131022, 71.1519404443228, 61.44915305992776, 68.52793722115932, 66.55509186644751, 44.49016424695309, 46.28647985354007, 95.37225458887792, 90.48312882777189, 77.49317790044833, 86.1987758511445, 71.82392479968979, 83.20376777947213, 66.51126991286222, 81.34581164631496, 29.72055916019749, 32.38562010223007, 72.55176502672352, 37.474249858049305, 65.2851660960036, 55.07714787198786, 28.436995280935648, 19.483746442820703, 108.22098433143019, 126.99018726087606, 31.34833039511403, 44.87786281034273, 32.28312823263762, 38.881437216536035, 52.466309993813375, 47.634956802031276, 89.27606201231904, 94.01616916891959, 45.08842142780116, 33.488320972740816, 85.6948945294047, 57.430295686850705, 61.364819003004555, 102.6382567571079, 64.62970503568695, 35.59142732514679, 34.65228310823004, 53.53497267972584, 45.999332680230964, 47.4333548416633, 22.374815657462193, 23.392066274061857, 45.35082351916614, 46.753689365272265, 11.020530984121459, 57.158803055026766, 85.54846511936245, 89.38180653322772, 28.485143554446104, 29.997062815205137, 53.63472400750187, 38.80377531254092, 29.940180615222424, 34.33961796814174, 14.95128007569788, 39.753346748508655, 73.0650967479305, 44.272529669243184, 19.436365667401517, 24.016406145101122, 3.9810394873839385, 12.643706955182292, 45.45001070367752, 58.207355798207466, 41.646597867936826, 23.037046693345047, 15.005078280338239, 17.63251816803876, 23.862140407255154, 51.28297956854041, 21.640017216407227, 5.645253895554249, 14.67154195868004, 8.42079914424086, 36.08274366284742, 20.60711906123392, 17.45323713716652, 28.28557019634901, 41.99386809680209, 29.141163117238783, 27.839372229110307, 41.30826687927728, 7.473184953850238, 22.670723288451583, 16.920949377847897, 17.68992188803827, 35.00782500291936, 44.404569271819796, 10.125170215508662, 4.6020513825407425, 10.829704105006778, 12.782203395676358, 24.042545027518834, 40.56686020107265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5973975741685809, "mean_inference_ms": 1.8002309013861417, "mean_action_processing_ms": 0.2523156030885712, "mean_env_wait_ms": 0.22339246366100454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006277322769165039, "StateBufferConnector_ms": 0.0033636093139648438, "ViewRequirementAgentConnector_ms": 0.09641683101654053}, "num_episodes": 22, "episode_return_max": 451.35078420145487, "episode_return_min": 296.5762470708654, "episode_return_mean": 382.42863037413406, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 389.0962429005403, "num_env_steps_trained_throughput_per_sec": 389.0962429005403, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 10784.173, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10784.118, "sample_time_ms": 1456.168, "learn_time_ms": 9310.857, "learn_throughput": 429.606, "synch_weights_time_ms": 14.895}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "e552a_00000", "date": "2024-08-16_08-51-15", "timestamp": 1723778475, "time_this_iter_s": 10.32443904876709, "time_total_s": 285.72947573661804, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a733e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 285.72947573661804, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 30.360000000000003, "ram_util_percent": 83.22000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.860056639600683, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.803698600284637, "policy_loss": -0.015447202719570625, "vf_loss": 5.814989720955097, "vf_explained_var": 0.10738878360501042, "kl": 0.018471427877136137, "entropy": 1.372052964268538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6162115668178236, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.975624897366479, "policy_loss": -0.003002765961484146, "vf_loss": 5.974248583859237, "vf_explained_var": 0.20640035419867783, "kl": 0.014596877605789232, "entropy": 1.4802809724101313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 451.35078420145487, "episode_reward_min": 287.647253021523, "episode_reward_mean": 384.36033231351934, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -239.7824055537128, "predator_policy": 1.7482962344517423}, "policy_reward_max": {"prey_policy": 195.89689809595265, "predator_policy": 356.4402905003165}, "policy_reward_mean": {"prey_policy": 135.35690520792448, "predator_policy": 56.823260948835156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.74928547690627, 348.304541609706, 373.260137432661, 384.7319930475655, 396.0521237101972, 350.76265506662315, 417.0144271821424, 384.6505454139029, 378.57687929395786, 373.794733091994, 383.7237649171514, 446.9631118840297, 380.50003587048866, 385.99476580778577, 366.80675843948774, 406.8440693830658, 418.87514983764447, 368.55390766881357, 419.3814091510488, 371.95903539466906, 394.6722660041428, 387.2921322216052, 412.20024249762037, 404.89238641002567, 384.7562638479958, 401.9382947075374, 416.02534559895133, 411.25308826361425, 394.02458590535605, 399.1971377442347, 369.15184319452, 403.87995541122075, 412.9401582385696, 398.779596843206, 401.12987968401086, 376.1173793376296, 369.21917746315086, 426.97658989939833, 351.3151114996325, 451.35078420145487, 416.53794042346897, 395.21851236545155, 411.50875922592394, 380.6989678123554, 381.7309294425553, 426.8467651685074, 407.2075900139022, 402.6362617571261, 407.4473477596788, 391.778282824655, 404.73322627899506, 364.06228875089414, 371.8425995669268, 385.44169059940754, 396.0551063544665, 429.42662811331405, 392.0592100847562, 328.8875303690252, 413.99746131604127, 374.8437103192324, 396.6647120592816, 388.85139307986424, 371.9026167552775, 381.6626443484564, 389.6629012631901, 367.0578308263531, 372.09997993695123, 392.0042806128431, 384.99308542160094, 350.41939756478945, 355.167755544087, 394.8167556935217, 388.3291861697573, 357.70935668513334, 371.7749539749966, 387.69581250406486, 372.69538762951055, 369.88882676739456, 401.5246286237829, 377.04347747174563, 406.25986781058236, 352.7829188243126, 348.3783023699184, 382.14569908836216, 377.48663479858754, 370.8595073912636, 312.6242328140844, 378.76178924221983, 392.4907436104196, 367.1420714053023, 374.3220740409609, 371.99548803587305, 376.9265855021471, 375.04499671343154, 367.4733403968117, 333.53123926162107, 350.8551585580121, 384.5073276884488, 376.2606606450407, 287.647253021523], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [75.40828037990003, 90.93965822804977, 127.29784107478872, 33.29914117986695, 93.40871877749159, 55.63133909163714, 98.67685134044294, 51.07134876821442, 60.25357036950779, 53.582665189381395, 65.0274802115988, 44.75108037901184, 67.05657530398594, 134.0148853439397, 111.62703993541548, 71.65069896427546, 82.2689075844957, 78.03178224486028, 130.49585900097136, 19.062223362610656, 132.01530030774316, 104.1971807947031, -239.7824055537128, 117.83570922484651, 93.8354462065722, 21.210699542738123, 69.51933338376631, 73.90143309312086, 119.96591700499724, 156.96309591488725, 127.72468241044851, 44.38432817948217, 143.37132743013942, 70.76461145469541, 72.60992175728566, 53.76114147653444, 141.58357698773708, 91.70522402087845, 117.23527234077189, 76.08234580919874, 152.17725658358222, 147.41922778118604, 85.78559970486195, 108.6844884663787, 182.53336880929544, 128.581851238231, 88.78374208994104, 126.4826156718494, 149.78694833800097, 157.9854037653862, 125.32216537790504, 142.37720649774366, 171.73987661027476, 139.45741542880927, 103.77215107215659, 115.16446206565864, 124.94520220020952, 136.4782902008961, 144.25943112534225, 119.85467753128613, 125.35075922287106, 153.02443987115535, 95.97127341609108, 122.05329857847988, 142.98227099304538, 106.26593349393147, 78.21973788450406, 165.53216637954026, 162.5990897741893, 90.67370835064459, 159.07308500302975, 154.93811507217197, 114.4636043790899, 144.7295581992881, 161.979404716393, 144.63487121501367, 160.34422007638867, 143.05014969948755, 47.07595775745678, 169.06365485169246, 155.97969067971113, 184.33205653830106, 177.74611616210757, 146.3078307541706, 177.60584506612207, 133.80164736395727, 98.84755792098528, 98.55917871013172, 148.2053475168333, 154.94883952518, 108.04798357499467, 175.6735913772579, 179.16343039132508, 64.04108386246452, 172.18827562815918, 130.22685376813297, 175.23894067918985, 144.02115129253315, 126.80929225061715, 171.53630305214364, 177.2943561935131, 181.67198815395767, 140.15856238871612, 131.79921347773973, 142.46083123526108, 161.20243429251764, 66.21034106540205, 144.3010778814154, 155.97987351642934, 181.59302646838577, 164.77613587070624, 172.21199292256483, 163.8355592070256, 163.9438522943665, 111.81919889089554, 162.36370465392298, 162.0759355353796, 134.5838993634881, 170.9285788168583, 160.46235968987145, 190.69410181341564, 189.3458638032999, 154.60867749318868, 130.58534908479058, 141.15795638179418, 166.06101581220142, 168.01301729737887, 181.0120306027005, 164.64924933090487, 149.8685319564893, 165.03190256619692, 174.7406571481947, 157.83100519112472, 191.17663364290544, 170.68246237584793, 164.63195551291403, 162.90771594501928, 176.346562143066, 164.87550808899547, 114.40885826175301, 141.9666135750043, 144.0535028606951, 168.77594935526716, 195.89689809595265, 175.0202676191325, 178.69804728473858, 144.08335193838656, 134.2136104720076, 172.40011728956657, 184.64761508738061, 185.42955009852616, 178.65435490485555, 166.03428160453552, 142.0517007963837, 110.35338164375221, 165.68385483473887, 182.4721321204463, 141.43463093675206, 135.9185414246495, 172.28000000000003, 189.56480897385998, 178.49372323978994, 152.3612953516549, 97.90794681210252, 178.24260457172937, 152.42983748559072, 180.4245532800186, 165.1902001214217, 175.91478319474493, 147.4689403015334, 155.49477453129654, 181.81509292927547, 51.7139285334863, 155.93521549736715, 133.3857397222912, 183.96486964495384, 178.1205178000873, 157.10325232857613, 180.68467127074433, 13.957851910421933, 174.90760123777522, 174.47047551342632, 162.16401735359415, 177.84300423450998, 176.1918560322369, 182.32895127158145, 138.74900933561938, 104.84272949460437, 177.19573510188576, 174.4869217514718, 183.60821724972428, 141.70007417617444, 167.90383458476578, 141.82381199399262, 175.30555180319712, 184.58064928337998, 141.2388384825685, 130.18644692870438, 133.57455993849945, 120.3959858778119], "policy_predator_policy_reward": [89.89722111144015, 113.50412575751587, 85.24169277614787, 102.46586657890234, 106.38378802769456, 117.83629153583777, 120.59043624568773, 114.3933566932203, 142.73609270502928, 139.47979544627853, 133.4241907233527, 107.55990375265996, 108.4176377271302, 107.52532880708668, 98.37787779530406, 102.99492871890756, 98.87698766603219, 119.39920179856979, 88.65741579974332, 135.5792349286688, 69.55426309180554, 77.9570207228994, 212.4695177125797, 356.4402905003165, 126.28843573146834, 139.16545438970962, 119.82074768160842, 122.75325164929019, 39.408265241861244, 50.469480277741944, 125.23203105717754, 109.50302773595794, 105.88445497884828, 98.85475597396145, 113.94751644886617, 128.23532798612695, 81.95790489473167, 104.13470324770134, 70.2241795766352, 108.4172376680627, 62.480823164576485, 32.594958474797856, 98.533648983177, 94.28839506718731, 39.683970086797416, 61.40105236329649, 85.72905737355258, 103.89697127468217, 45.976374264397, 31.00753748021189, 65.92776689249744, 68.31115593939172, 49.09041664666044, 55.73763691320716, 93.35719825448896, 98.95927687131022, 71.1519404443228, 61.44915305992776, 68.52793722115932, 66.55509186644751, 44.49016424695309, 46.28647985354007, 95.37225458887792, 90.48312882777189, 77.49317790044833, 86.1987758511445, 71.82392479968979, 83.20376777947213, 66.51126991286222, 81.34581164631496, 29.72055916019749, 32.38562010223007, 72.55176502672352, 37.474249858049305, 65.2851660960036, 55.07714787198786, 28.436995280935648, 19.483746442820703, 108.22098433143019, 126.99018726087606, 31.34833039511403, 44.87786281034273, 32.28312823263762, 38.881437216536035, 52.466309993813375, 47.634956802031276, 89.27606201231904, 94.01616916891959, 45.08842142780116, 33.488320972740816, 85.6948945294047, 57.430295686850705, 61.364819003004555, 102.6382567571079, 64.62970503568695, 35.59142732514679, 34.65228310823004, 53.53497267972584, 45.999332680230964, 47.4333548416633, 22.374815657462193, 23.392066274061857, 45.35082351916614, 46.753689365272265, 11.020530984121459, 57.158803055026766, 85.54846511936245, 89.38180653322772, 28.485143554446104, 29.997062815205137, 53.63472400750187, 38.80377531254092, 29.940180615222424, 34.33961796814174, 14.95128007569788, 39.753346748508655, 73.0650967479305, 44.272529669243184, 19.436365667401517, 24.016406145101122, 3.9810394873839385, 12.643706955182292, 45.45001070367752, 58.207355798207466, 41.646597867936826, 23.037046693345047, 15.005078280338239, 17.63251816803876, 23.862140407255154, 51.28297956854041, 21.640017216407227, 5.645253895554249, 14.67154195868004, 8.42079914424086, 36.08274366284742, 20.60711906123392, 17.45323713716652, 28.28557019634901, 41.99386809680209, 29.141163117238783, 27.839372229110307, 41.30826687927728, 7.473184953850238, 22.670723288451583, 16.920949377847897, 17.68992188803827, 35.00782500291936, 44.404569271819796, 10.125170215508662, 4.6020513825407425, 10.829704105006778, 12.782203395676358, 24.042545027518834, 40.56686020107265, 48.80082865163666, 45.05076163726675, 36.02617265923002, 41.59169290735455, 22.22203101163754, 46.62290503545869, 25.24502838174758, 12.956307215185046, 75.50879407499941, 27.00488258555603, 7.229614108807053, 10.476246203791268, 13.589954967339459, 22.940990719582715, 19.569335599304168, 34.53357570300504, 13.903416324505976, 19.64622360618543, 41.893747345461605, 63.081341437769446, 31.544860910581853, 29.866318964392878, 24.748385428552467, 32.51858805320387, 15.989198754242326, 156.51034946989404, 8.305068190260208, 16.638929099499535, 15.197736166541317, 16.79073028122754, 9.055234630815859, 9.350543567512899, 50.46605164400651, 80.9872062392015, 3.732635000759509, 12.05804854269466, 6.474651601270761, 1.7482962344517423, 32.25049434221644, 8.877017637037122, 5.756868480695523, 18.864258121176135, 55.31486301171729, 49.520512222050506, 6.065692900760031, 27.61101430445162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5972641806419152, "mean_inference_ms": 1.8056435725733422, "mean_action_processing_ms": 0.2585850533982488, "mean_env_wait_ms": 0.22368475895809437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009402155876159668, "StateBufferConnector_ms": 0.0032614469528198242, "ViewRequirementAgentConnector_ms": 0.09530484676361084}, "num_episodes": 23, "episode_return_max": 451.35078420145487, "episode_return_min": 287.647253021523, "episode_return_mean": 384.36033231351934, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.4384859162979, "num_env_steps_trained_throughput_per_sec": 368.4384859162979, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 10776.193, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10776.133, "sample_time_ms": 1429.625, "learn_time_ms": 9329.569, "learn_throughput": 428.744, "synch_weights_time_ms": 14.676}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "e552a_00000", "date": "2024-08-16_08-51-26", "timestamp": 1723778486, "time_this_iter_s": 10.907119035720825, "time_total_s": 296.63659477233887, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72efca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 296.63659477233887, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.18666666666666, "ram_util_percent": 83.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2808750377761, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.730351369847696, "policy_loss": -0.018362195217715843, "vf_loss": 6.743479850052526, "vf_explained_var": 0.05798034510284505, "kl": 0.023260941937243786, "entropy": 1.3404532879748672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.547627768440852, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.281101476578486, "policy_loss": -0.010650900062469264, "vf_loss": 7.287371907158503, "vf_explained_var": 0.12182213332917956, "kl": 0.014601591464421994, "entropy": 1.4564453951896184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 451.35078420145487, "episode_reward_min": 287.647253021523, "episode_reward_mean": 380.57994301220606, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 13.957851910421933, "predator_policy": 1.7482962344517423}, "policy_reward_max": {"prey_policy": 195.89689809595265, "predator_policy": 156.51034946989404}, "policy_reward_mean": {"prey_policy": 147.56133448388437, "predator_policy": 42.72863702221867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [419.3814091510488, 371.95903539466906, 394.6722660041428, 387.2921322216052, 412.20024249762037, 404.89238641002567, 384.7562638479958, 401.9382947075374, 416.02534559895133, 411.25308826361425, 394.02458590535605, 399.1971377442347, 369.15184319452, 403.87995541122075, 412.9401582385696, 398.779596843206, 401.12987968401086, 376.1173793376296, 369.21917746315086, 426.97658989939833, 351.3151114996325, 451.35078420145487, 416.53794042346897, 395.21851236545155, 411.50875922592394, 380.6989678123554, 381.7309294425553, 426.8467651685074, 407.2075900139022, 402.6362617571261, 407.4473477596788, 391.778282824655, 404.73322627899506, 364.06228875089414, 371.8425995669268, 385.44169059940754, 396.0551063544665, 429.42662811331405, 392.0592100847562, 328.8875303690252, 413.99746131604127, 374.8437103192324, 396.6647120592816, 388.85139307986424, 371.9026167552775, 381.6626443484564, 389.6629012631901, 367.0578308263531, 372.09997993695123, 392.0042806128431, 384.99308542160094, 350.41939756478945, 355.167755544087, 394.8167556935217, 388.3291861697573, 357.70935668513334, 371.7749539749966, 387.69581250406486, 372.69538762951055, 369.88882676739456, 401.5246286237829, 377.04347747174563, 406.25986781058236, 352.7829188243126, 348.3783023699184, 382.14569908836216, 377.48663479858754, 370.8595073912636, 312.6242328140844, 378.76178924221983, 392.4907436104196, 367.1420714053023, 374.3220740409609, 371.99548803587305, 376.9265855021471, 375.04499671343154, 367.4733403968117, 333.53123926162107, 350.8551585580121, 384.5073276884488, 376.2606606450407, 287.647253021523, 339.8869367528524, 387.3566515511816, 356.22606039634076, 373.8967945060519, 331.6977664350345, 388.77373862712426, 399.07872753582313, 348.8111968193231, 351.26523177657253, 335.08664079723144, 354.55535825070774, 380.89878202984784, 347.34605928264506, 392.67718025791817, 367.6324222919439, 358.6727635092304, 381.88496990426626, 361.3726742787053], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.58357698773708, 91.70522402087845, 117.23527234077189, 76.08234580919874, 152.17725658358222, 147.41922778118604, 85.78559970486195, 108.6844884663787, 182.53336880929544, 128.581851238231, 88.78374208994104, 126.4826156718494, 149.78694833800097, 157.9854037653862, 125.32216537790504, 142.37720649774366, 171.73987661027476, 139.45741542880927, 103.77215107215659, 115.16446206565864, 124.94520220020952, 136.4782902008961, 144.25943112534225, 119.85467753128613, 125.35075922287106, 153.02443987115535, 95.97127341609108, 122.05329857847988, 142.98227099304538, 106.26593349393147, 78.21973788450406, 165.53216637954026, 162.5990897741893, 90.67370835064459, 159.07308500302975, 154.93811507217197, 114.4636043790899, 144.7295581992881, 161.979404716393, 144.63487121501367, 160.34422007638867, 143.05014969948755, 47.07595775745678, 169.06365485169246, 155.97969067971113, 184.33205653830106, 177.74611616210757, 146.3078307541706, 177.60584506612207, 133.80164736395727, 98.84755792098528, 98.55917871013172, 148.2053475168333, 154.94883952518, 108.04798357499467, 175.6735913772579, 179.16343039132508, 64.04108386246452, 172.18827562815918, 130.22685376813297, 175.23894067918985, 144.02115129253315, 126.80929225061715, 171.53630305214364, 177.2943561935131, 181.67198815395767, 140.15856238871612, 131.79921347773973, 142.46083123526108, 161.20243429251764, 66.21034106540205, 144.3010778814154, 155.97987351642934, 181.59302646838577, 164.77613587070624, 172.21199292256483, 163.8355592070256, 163.9438522943665, 111.81919889089554, 162.36370465392298, 162.0759355353796, 134.5838993634881, 170.9285788168583, 160.46235968987145, 190.69410181341564, 189.3458638032999, 154.60867749318868, 130.58534908479058, 141.15795638179418, 166.06101581220142, 168.01301729737887, 181.0120306027005, 164.64924933090487, 149.8685319564893, 165.03190256619692, 174.7406571481947, 157.83100519112472, 191.17663364290544, 170.68246237584793, 164.63195551291403, 162.90771594501928, 176.346562143066, 164.87550808899547, 114.40885826175301, 141.9666135750043, 144.0535028606951, 168.77594935526716, 195.89689809595265, 175.0202676191325, 178.69804728473858, 144.08335193838656, 134.2136104720076, 172.40011728956657, 184.64761508738061, 185.42955009852616, 178.65435490485555, 166.03428160453552, 142.0517007963837, 110.35338164375221, 165.68385483473887, 182.4721321204463, 141.43463093675206, 135.9185414246495, 172.28000000000003, 189.56480897385998, 178.49372323978994, 152.3612953516549, 97.90794681210252, 178.24260457172937, 152.42983748559072, 180.4245532800186, 165.1902001214217, 175.91478319474493, 147.4689403015334, 155.49477453129654, 181.81509292927547, 51.7139285334863, 155.93521549736715, 133.3857397222912, 183.96486964495384, 178.1205178000873, 157.10325232857613, 180.68467127074433, 13.957851910421933, 174.90760123777522, 174.47047551342632, 162.16401735359415, 177.84300423450998, 176.1918560322369, 182.32895127158145, 138.74900933561938, 104.84272949460437, 177.19573510188576, 174.4869217514718, 183.60821724972428, 141.70007417617444, 167.90383458476578, 141.82381199399262, 175.30555180319712, 184.58064928337998, 141.2388384825685, 130.18644692870438, 133.57455993849945, 120.3959858778119, 123.999849629567, 164.50931788552217, 178.2908618334468, 159.78886025331278, 140.9074473041791, 146.62655594437527, 151.70127519080464, 134.7494643007696, 123.15859340043646, 146.1228181570156, 159.68004191589924, 164.99374738353552, 170.31965533032027, 187.1590478695072, 92.49639746791092, 153.76860718445195, 144.37265594152913, 145.06465043974558, 124.90355585338298, 134.0527073884832, 157.5142825824785, 138.1287639857577, 162.58048420026387, 156.24045856693715, 142.9520920457271, 144.95241728348108, 155.02759520978069, 76.47809398289314, 159.2495235004527, 122.40885396033657, 138.66258967637586, 78.45282484076127, 150.1359653745905, 133.40361778019746, 152.8257056734061, 131.04014521303398], "policy_predator_policy_reward": [81.95790489473167, 104.13470324770134, 70.2241795766352, 108.4172376680627, 62.480823164576485, 32.594958474797856, 98.533648983177, 94.28839506718731, 39.683970086797416, 61.40105236329649, 85.72905737355258, 103.89697127468217, 45.976374264397, 31.00753748021189, 65.92776689249744, 68.31115593939172, 49.09041664666044, 55.73763691320716, 93.35719825448896, 98.95927687131022, 71.1519404443228, 61.44915305992776, 68.52793722115932, 66.55509186644751, 44.49016424695309, 46.28647985354007, 95.37225458887792, 90.48312882777189, 77.49317790044833, 86.1987758511445, 71.82392479968979, 83.20376777947213, 66.51126991286222, 81.34581164631496, 29.72055916019749, 32.38562010223007, 72.55176502672352, 37.474249858049305, 65.2851660960036, 55.07714787198786, 28.436995280935648, 19.483746442820703, 108.22098433143019, 126.99018726087606, 31.34833039511403, 44.87786281034273, 32.28312823263762, 38.881437216536035, 52.466309993813375, 47.634956802031276, 89.27606201231904, 94.01616916891959, 45.08842142780116, 33.488320972740816, 85.6948945294047, 57.430295686850705, 61.364819003004555, 102.6382567571079, 64.62970503568695, 35.59142732514679, 34.65228310823004, 53.53497267972584, 45.999332680230964, 47.4333548416633, 22.374815657462193, 23.392066274061857, 45.35082351916614, 46.753689365272265, 11.020530984121459, 57.158803055026766, 85.54846511936245, 89.38180653322772, 28.485143554446104, 29.997062815205137, 53.63472400750187, 38.80377531254092, 29.940180615222424, 34.33961796814174, 14.95128007569788, 39.753346748508655, 73.0650967479305, 44.272529669243184, 19.436365667401517, 24.016406145101122, 3.9810394873839385, 12.643706955182292, 45.45001070367752, 58.207355798207466, 41.646597867936826, 23.037046693345047, 15.005078280338239, 17.63251816803876, 23.862140407255154, 51.28297956854041, 21.640017216407227, 5.645253895554249, 14.67154195868004, 8.42079914424086, 36.08274366284742, 20.60711906123392, 17.45323713716652, 28.28557019634901, 41.99386809680209, 29.141163117238783, 27.839372229110307, 41.30826687927728, 7.473184953850238, 22.670723288451583, 16.920949377847897, 17.68992188803827, 35.00782500291936, 44.404569271819796, 10.125170215508662, 4.6020513825407425, 10.829704105006778, 12.782203395676358, 24.042545027518834, 40.56686020107265, 48.80082865163666, 45.05076163726675, 36.02617265923002, 41.59169290735455, 22.22203101163754, 46.62290503545869, 25.24502838174758, 12.956307215185046, 75.50879407499941, 27.00488258555603, 7.229614108807053, 10.476246203791268, 13.589954967339459, 22.940990719582715, 19.569335599304168, 34.53357570300504, 13.903416324505976, 19.64622360618543, 41.893747345461605, 63.081341437769446, 31.544860910581853, 29.866318964392878, 24.748385428552467, 32.51858805320387, 15.989198754242326, 156.51034946989404, 8.305068190260208, 16.638929099499535, 15.197736166541317, 16.79073028122754, 9.055234630815859, 9.350543567512899, 50.46605164400651, 80.9872062392015, 3.732635000759509, 12.05804854269466, 6.474651601270761, 1.7482962344517423, 32.25049434221644, 8.877017637037122, 5.756868480695523, 18.864258121176135, 55.31486301171729, 49.520512222050506, 6.065692900760031, 27.61101430445162, 21.893719237746314, 29.484050000017096, 33.48056869679433, 15.796360767627691, 46.535304524284015, 22.156752623502417, 44.71387352563486, 42.73218148884258, 39.408399604680596, 23.007955272902116, 26.74425553294407, 37.35569379474534, 27.76807742257013, 13.831946913425723, 58.032230140227476, 44.51396202673296, 39.46349747160074, 22.364427923697683, 47.139335422144725, 28.99104213322067, 37.756583337791966, 21.155728344679982, 41.50290395332324, 20.574935309323408, 29.40313060334831, 30.038419350088848, 90.70691599943056, 70.46457506581388, 44.4992789014476, 41.47476592970696, 87.06469857591028, 54.49265041618334, 36.86331171564254, 61.482075033835855, 38.28164370603361, 39.22517968623113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5980227946516855, "mean_inference_ms": 1.813327345316327, "mean_action_processing_ms": 0.26339069005167326, "mean_env_wait_ms": 0.2242327651763708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008911967277526855, "StateBufferConnector_ms": 0.0033377408981323242, "ViewRequirementAgentConnector_ms": 0.09560894966125488}, "num_episodes": 18, "episode_return_max": 451.35078420145487, "episode_return_min": 287.647253021523, "episode_return_mean": 380.57994301220606, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.58036317943123, "num_env_steps_trained_throughput_per_sec": 355.58036317943123, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 10830.643, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10830.583, "sample_time_ms": 1476.247, "learn_time_ms": 9337.551, "learn_throughput": 428.378, "synch_weights_time_ms": 14.687}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "e552a_00000", "date": "2024-08-16_08-51-37", "timestamp": 1723778497, "time_this_iter_s": 11.271812915802002, "time_total_s": 307.90840768814087, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a73478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 307.90840768814087, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.03125, "ram_util_percent": 83.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.327450510433742, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.580539924883968, "policy_loss": -0.013998422220043799, "vf_loss": 7.58973926034554, "vf_explained_var": 0.01329901410789086, "kl": 0.014219535787090277, "entropy": 1.3215690989342948, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.714510539410607, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.492069463376645, "policy_loss": -0.01123414664731297, "vf_loss": 7.498556784977988, "vf_explained_var": 0.17397940789580976, "kl": 0.01582274446873812, "entropy": 1.4531997392417262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 451.35078420145487, "episode_reward_min": 287.647253021523, "episode_reward_mean": 378.0187367325856, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 13.957851910421933, "predator_policy": 1.7482962344517423}, "policy_reward_max": {"prey_policy": 195.89689809595265, "predator_policy": 156.51034946989404}, "policy_reward_mean": {"prey_policy": 147.57324699101326, "predator_policy": 41.43612137527955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.21917746315086, 426.97658989939833, 351.3151114996325, 451.35078420145487, 416.53794042346897, 395.21851236545155, 411.50875922592394, 380.6989678123554, 381.7309294425553, 426.8467651685074, 407.2075900139022, 402.6362617571261, 407.4473477596788, 391.778282824655, 404.73322627899506, 364.06228875089414, 371.8425995669268, 385.44169059940754, 396.0551063544665, 429.42662811331405, 392.0592100847562, 328.8875303690252, 413.99746131604127, 374.8437103192324, 396.6647120592816, 388.85139307986424, 371.9026167552775, 381.6626443484564, 389.6629012631901, 367.0578308263531, 372.09997993695123, 392.0042806128431, 384.99308542160094, 350.41939756478945, 355.167755544087, 394.8167556935217, 388.3291861697573, 357.70935668513334, 371.7749539749966, 387.69581250406486, 372.69538762951055, 369.88882676739456, 401.5246286237829, 377.04347747174563, 406.25986781058236, 352.7829188243126, 348.3783023699184, 382.14569908836216, 377.48663479858754, 370.8595073912636, 312.6242328140844, 378.76178924221983, 392.4907436104196, 367.1420714053023, 374.3220740409609, 371.99548803587305, 376.9265855021471, 375.04499671343154, 367.4733403968117, 333.53123926162107, 350.8551585580121, 384.5073276884488, 376.2606606450407, 287.647253021523, 339.8869367528524, 387.3566515511816, 356.22606039634076, 373.8967945060519, 331.6977664350345, 388.77373862712426, 399.07872753582313, 348.8111968193231, 351.26523177657253, 335.08664079723144, 354.55535825070774, 380.89878202984784, 347.34605928264506, 392.67718025791817, 367.6324222919439, 358.6727635092304, 381.88496990426626, 361.3726742787053, 388.0018267016403, 345.5725898241276, 385.07781056394555, 408.950501243978, 355.22936560681507, 383.1096629339186, 372.5224460738157, 353.44920312728703, 412.19726283565336, 393.77817886382945, 376.0296754034614, 383.8066751046348, 414.9972251708063, 378.09026468225164, 374.6626414514579, 405.47067611580115, 399.75729683294134, 372.76706995754665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.4636043790899, 144.7295581992881, 161.979404716393, 144.63487121501367, 160.34422007638867, 143.05014969948755, 47.07595775745678, 169.06365485169246, 155.97969067971113, 184.33205653830106, 177.74611616210757, 146.3078307541706, 177.60584506612207, 133.80164736395727, 98.84755792098528, 98.55917871013172, 148.2053475168333, 154.94883952518, 108.04798357499467, 175.6735913772579, 179.16343039132508, 64.04108386246452, 172.18827562815918, 130.22685376813297, 175.23894067918985, 144.02115129253315, 126.80929225061715, 171.53630305214364, 177.2943561935131, 181.67198815395767, 140.15856238871612, 131.79921347773973, 142.46083123526108, 161.20243429251764, 66.21034106540205, 144.3010778814154, 155.97987351642934, 181.59302646838577, 164.77613587070624, 172.21199292256483, 163.8355592070256, 163.9438522943665, 111.81919889089554, 162.36370465392298, 162.0759355353796, 134.5838993634881, 170.9285788168583, 160.46235968987145, 190.69410181341564, 189.3458638032999, 154.60867749318868, 130.58534908479058, 141.15795638179418, 166.06101581220142, 168.01301729737887, 181.0120306027005, 164.64924933090487, 149.8685319564893, 165.03190256619692, 174.7406571481947, 157.83100519112472, 191.17663364290544, 170.68246237584793, 164.63195551291403, 162.90771594501928, 176.346562143066, 164.87550808899547, 114.40885826175301, 141.9666135750043, 144.0535028606951, 168.77594935526716, 195.89689809595265, 175.0202676191325, 178.69804728473858, 144.08335193838656, 134.2136104720076, 172.40011728956657, 184.64761508738061, 185.42955009852616, 178.65435490485555, 166.03428160453552, 142.0517007963837, 110.35338164375221, 165.68385483473887, 182.4721321204463, 141.43463093675206, 135.9185414246495, 172.28000000000003, 189.56480897385998, 178.49372323978994, 152.3612953516549, 97.90794681210252, 178.24260457172937, 152.42983748559072, 180.4245532800186, 165.1902001214217, 175.91478319474493, 147.4689403015334, 155.49477453129654, 181.81509292927547, 51.7139285334863, 155.93521549736715, 133.3857397222912, 183.96486964495384, 178.1205178000873, 157.10325232857613, 180.68467127074433, 13.957851910421933, 174.90760123777522, 174.47047551342632, 162.16401735359415, 177.84300423450998, 176.1918560322369, 182.32895127158145, 138.74900933561938, 104.84272949460437, 177.19573510188576, 174.4869217514718, 183.60821724972428, 141.70007417617444, 167.90383458476578, 141.82381199399262, 175.30555180319712, 184.58064928337998, 141.2388384825685, 130.18644692870438, 133.57455993849945, 120.3959858778119, 123.999849629567, 164.50931788552217, 178.2908618334468, 159.78886025331278, 140.9074473041791, 146.62655594437527, 151.70127519080464, 134.7494643007696, 123.15859340043646, 146.1228181570156, 159.68004191589924, 164.99374738353552, 170.31965533032027, 187.1590478695072, 92.49639746791092, 153.76860718445195, 144.37265594152913, 145.06465043974558, 124.90355585338298, 134.0527073884832, 157.5142825824785, 138.1287639857577, 162.58048420026387, 156.24045856693715, 142.9520920457271, 144.95241728348108, 155.02759520978069, 76.47809398289314, 159.2495235004527, 122.40885396033657, 138.66258967637586, 78.45282484076127, 150.1359653745905, 133.40361778019746, 152.8257056734061, 131.04014521303398, 117.82124545858079, 95.52926163181905, 109.5844225307702, 110.15758788071919, 151.14591979484587, 152.52830005665052, 150.84879423755376, 87.42458866234516, 122.90671005836705, 109.9591227222874, 84.77930990258145, 134.818653321764, 138.20337814750016, 141.35099920764387, 113.09222772889458, 165.03625991279353, 109.61968076938304, 103.97345328971808, 78.2024877081708, 165.95575110678857, 140.4560000015002, 135.8285091815313, 120.0562841226875, 150.38428709209077, 157.40044749923374, 139.83745336378445, 126.67080170775158, 128.04817620422696, 125.31102850136884, 110.48123270996044, 137.25269842221635, 132.7620841670621, 152.03168158465976, 164.7039224047013, 124.4185022525473, 148.68291583851484], "policy_predator_policy_reward": [72.55176502672352, 37.474249858049305, 65.2851660960036, 55.07714787198786, 28.436995280935648, 19.483746442820703, 108.22098433143019, 126.99018726087606, 31.34833039511403, 44.87786281034273, 32.28312823263762, 38.881437216536035, 52.466309993813375, 47.634956802031276, 89.27606201231904, 94.01616916891959, 45.08842142780116, 33.488320972740816, 85.6948945294047, 57.430295686850705, 61.364819003004555, 102.6382567571079, 64.62970503568695, 35.59142732514679, 34.65228310823004, 53.53497267972584, 45.999332680230964, 47.4333548416633, 22.374815657462193, 23.392066274061857, 45.35082351916614, 46.753689365272265, 11.020530984121459, 57.158803055026766, 85.54846511936245, 89.38180653322772, 28.485143554446104, 29.997062815205137, 53.63472400750187, 38.80377531254092, 29.940180615222424, 34.33961796814174, 14.95128007569788, 39.753346748508655, 73.0650967479305, 44.272529669243184, 19.436365667401517, 24.016406145101122, 3.9810394873839385, 12.643706955182292, 45.45001070367752, 58.207355798207466, 41.646597867936826, 23.037046693345047, 15.005078280338239, 17.63251816803876, 23.862140407255154, 51.28297956854041, 21.640017216407227, 5.645253895554249, 14.67154195868004, 8.42079914424086, 36.08274366284742, 20.60711906123392, 17.45323713716652, 28.28557019634901, 41.99386809680209, 29.141163117238783, 27.839372229110307, 41.30826687927728, 7.473184953850238, 22.670723288451583, 16.920949377847897, 17.68992188803827, 35.00782500291936, 44.404569271819796, 10.125170215508662, 4.6020513825407425, 10.829704105006778, 12.782203395676358, 24.042545027518834, 40.56686020107265, 48.80082865163666, 45.05076163726675, 36.02617265923002, 41.59169290735455, 22.22203101163754, 46.62290503545869, 25.24502838174758, 12.956307215185046, 75.50879407499941, 27.00488258555603, 7.229614108807053, 10.476246203791268, 13.589954967339459, 22.940990719582715, 19.569335599304168, 34.53357570300504, 13.903416324505976, 19.64622360618543, 41.893747345461605, 63.081341437769446, 31.544860910581853, 29.866318964392878, 24.748385428552467, 32.51858805320387, 15.989198754242326, 156.51034946989404, 8.305068190260208, 16.638929099499535, 15.197736166541317, 16.79073028122754, 9.055234630815859, 9.350543567512899, 50.46605164400651, 80.9872062392015, 3.732635000759509, 12.05804854269466, 6.474651601270761, 1.7482962344517423, 32.25049434221644, 8.877017637037122, 5.756868480695523, 18.864258121176135, 55.31486301171729, 49.520512222050506, 6.065692900760031, 27.61101430445162, 21.893719237746314, 29.484050000017096, 33.48056869679433, 15.796360767627691, 46.535304524284015, 22.156752623502417, 44.71387352563486, 42.73218148884258, 39.408399604680596, 23.007955272902116, 26.74425553294407, 37.35569379474534, 27.76807742257013, 13.831946913425723, 58.032230140227476, 44.51396202673296, 39.46349747160074, 22.364427923697683, 47.139335422144725, 28.99104213322067, 37.756583337791966, 21.155728344679982, 41.50290395332324, 20.574935309323408, 29.40313060334831, 30.038419350088848, 90.70691599943056, 70.46457506581388, 44.4992789014476, 41.47476592970696, 87.06469857591028, 54.49265041618334, 36.86331171564254, 61.482075033835855, 38.28164370603361, 39.22517968623113, 80.89785567746135, 93.75346393377873, 73.10663723595758, 52.72394217668051, 23.237014234232994, 58.16657647821648, 103.2862249864618, 67.39089335761703, 55.58110478998058, 66.78242803618001, 93.65103996746045, 69.86065974211304, 60.138546819263475, 32.829521899408206, 49.4583571853458, 25.862358300253277, 60.28395398583089, 138.32017479072127, 100.9178927607542, 48.70204728811587, 39.38100979460015, 60.36415642582971, 69.75189431097533, 43.61420957888116, 56.39298111776775, 61.36634319001973, 65.12930519008084, 58.24198158019241, 49.05306832339681, 89.81731191673194, 71.84242092659387, 63.61347259992925, 39.56991014545728, 43.451782698123296, 70.62386419839282, 29.04178766809208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5985984406805328, "mean_inference_ms": 1.8191567314599257, "mean_action_processing_ms": 0.26306179438118205, "mean_env_wait_ms": 0.22468385193416843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008437275886535645, "StateBufferConnector_ms": 0.003376483917236328, "ViewRequirementAgentConnector_ms": 0.0998375415802002}, "num_episodes": 18, "episode_return_max": 451.35078420145487, "episode_return_min": 287.647253021523, "episode_return_mean": 378.0187367325856, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.38723955606844, "num_env_steps_trained_throughput_per_sec": 360.38723955606844, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 10859.085, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10859.025, "sample_time_ms": 1483.367, "learn_time_ms": 9358.792, "learn_throughput": 427.406, "synch_weights_time_ms": 14.962}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "e552a_00000", "date": "2024-08-16_08-51-48", "timestamp": 1723778508, "time_this_iter_s": 11.108043909072876, "time_total_s": 319.01645159721375, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 319.01645159721375, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 30.849999999999994, "ram_util_percent": 83.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.541390314114787, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.7468335706720906, "policy_loss": -0.006784901415889777, "vf_loss": 7.7502524297704145, "vf_explained_var": -0.0222803895435636, "kl": 0.009973437865143512, "entropy": 1.2878906635380296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.75873092179576, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4221701036685355, "policy_loss": -0.010543288159671994, "vf_loss": 7.428693200671484, "vf_explained_var": 0.1343339134145666, "kl": 0.013400546354466107, "entropy": 1.4690916222870034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 429.42662811331405, "episode_reward_min": 287.647253021523, "episode_reward_mean": 374.4052133136946, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 13.957851910421933, "predator_policy": 1.7482962344517423}, "policy_reward_max": {"prey_policy": 195.89689809595265, "predator_policy": 156.51034946989404}, "policy_reward_mean": {"prey_policy": 146.46429909365276, "predator_policy": 40.73830756319456}, "custom_metrics": {}, "hist_stats": {"episode_reward": [396.0551063544665, 429.42662811331405, 392.0592100847562, 328.8875303690252, 413.99746131604127, 374.8437103192324, 396.6647120592816, 388.85139307986424, 371.9026167552775, 381.6626443484564, 389.6629012631901, 367.0578308263531, 372.09997993695123, 392.0042806128431, 384.99308542160094, 350.41939756478945, 355.167755544087, 394.8167556935217, 388.3291861697573, 357.70935668513334, 371.7749539749966, 387.69581250406486, 372.69538762951055, 369.88882676739456, 401.5246286237829, 377.04347747174563, 406.25986781058236, 352.7829188243126, 348.3783023699184, 382.14569908836216, 377.48663479858754, 370.8595073912636, 312.6242328140844, 378.76178924221983, 392.4907436104196, 367.1420714053023, 374.3220740409609, 371.99548803587305, 376.9265855021471, 375.04499671343154, 367.4733403968117, 333.53123926162107, 350.8551585580121, 384.5073276884488, 376.2606606450407, 287.647253021523, 339.8869367528524, 387.3566515511816, 356.22606039634076, 373.8967945060519, 331.6977664350345, 388.77373862712426, 399.07872753582313, 348.8111968193231, 351.26523177657253, 335.08664079723144, 354.55535825070774, 380.89878202984784, 347.34605928264506, 392.67718025791817, 367.6324222919439, 358.6727635092304, 381.88496990426626, 361.3726742787053, 388.0018267016403, 345.5725898241276, 385.07781056394555, 408.950501243978, 355.22936560681507, 383.1096629339186, 372.5224460738157, 353.44920312728703, 412.19726283565336, 393.77817886382945, 376.0296754034614, 383.8066751046348, 414.9972251708063, 378.09026468225164, 374.6626414514579, 405.47067611580115, 399.75729683294134, 372.76706995754665, 293.6825588328453, 388.36225424712103, 377.6609333538536, 366.88574253064803, 356.8823453403742, 414.4087567208493, 348.32717727725174, 408.5684463838446, 386.3679729190107, 400.8802120082146, 343.3037539614598, 382.69395114945013, 374.7430099127684, 366.4241031918779, 394.3141252372849, 412.94258908067957, 376.62176189363714, 392.1307891232138], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.97987351642934, 181.59302646838577, 164.77613587070624, 172.21199292256483, 163.8355592070256, 163.9438522943665, 111.81919889089554, 162.36370465392298, 162.0759355353796, 134.5838993634881, 170.9285788168583, 160.46235968987145, 190.69410181341564, 189.3458638032999, 154.60867749318868, 130.58534908479058, 141.15795638179418, 166.06101581220142, 168.01301729737887, 181.0120306027005, 164.64924933090487, 149.8685319564893, 165.03190256619692, 174.7406571481947, 157.83100519112472, 191.17663364290544, 170.68246237584793, 164.63195551291403, 162.90771594501928, 176.346562143066, 164.87550808899547, 114.40885826175301, 141.9666135750043, 144.0535028606951, 168.77594935526716, 195.89689809595265, 175.0202676191325, 178.69804728473858, 144.08335193838656, 134.2136104720076, 172.40011728956657, 184.64761508738061, 185.42955009852616, 178.65435490485555, 166.03428160453552, 142.0517007963837, 110.35338164375221, 165.68385483473887, 182.4721321204463, 141.43463093675206, 135.9185414246495, 172.28000000000003, 189.56480897385998, 178.49372323978994, 152.3612953516549, 97.90794681210252, 178.24260457172937, 152.42983748559072, 180.4245532800186, 165.1902001214217, 175.91478319474493, 147.4689403015334, 155.49477453129654, 181.81509292927547, 51.7139285334863, 155.93521549736715, 133.3857397222912, 183.96486964495384, 178.1205178000873, 157.10325232857613, 180.68467127074433, 13.957851910421933, 174.90760123777522, 174.47047551342632, 162.16401735359415, 177.84300423450998, 176.1918560322369, 182.32895127158145, 138.74900933561938, 104.84272949460437, 177.19573510188576, 174.4869217514718, 183.60821724972428, 141.70007417617444, 167.90383458476578, 141.82381199399262, 175.30555180319712, 184.58064928337998, 141.2388384825685, 130.18644692870438, 133.57455993849945, 120.3959858778119, 123.999849629567, 164.50931788552217, 178.2908618334468, 159.78886025331278, 140.9074473041791, 146.62655594437527, 151.70127519080464, 134.7494643007696, 123.15859340043646, 146.1228181570156, 159.68004191589924, 164.99374738353552, 170.31965533032027, 187.1590478695072, 92.49639746791092, 153.76860718445195, 144.37265594152913, 145.06465043974558, 124.90355585338298, 134.0527073884832, 157.5142825824785, 138.1287639857577, 162.58048420026387, 156.24045856693715, 142.9520920457271, 144.95241728348108, 155.02759520978069, 76.47809398289314, 159.2495235004527, 122.40885396033657, 138.66258967637586, 78.45282484076127, 150.1359653745905, 133.40361778019746, 152.8257056734061, 131.04014521303398, 117.82124545858079, 95.52926163181905, 109.5844225307702, 110.15758788071919, 151.14591979484587, 152.52830005665052, 150.84879423755376, 87.42458866234516, 122.90671005836705, 109.9591227222874, 84.77930990258145, 134.818653321764, 138.20337814750016, 141.35099920764387, 113.09222772889458, 165.03625991279353, 109.61968076938304, 103.97345328971808, 78.2024877081708, 165.95575110678857, 140.4560000015002, 135.8285091815313, 120.0562841226875, 150.38428709209077, 157.40044749923374, 139.83745336378445, 126.67080170775158, 128.04817620422696, 125.31102850136884, 110.48123270996044, 137.25269842221635, 132.7620841670621, 152.03168158465976, 164.7039224047013, 124.4185022525473, 148.68291583851484, 119.7164681855908, 59.015483746864504, 158.61223630463874, 153.16857126735005, 139.22926757695265, 138.67564351023867, 89.69912932869853, 93.6044264881352, 148.28608826564425, 131.3290645009601, 123.34011714116579, 179.45213232707013, 134.72410612901388, 162.57134234383807, 133.44029050742623, 141.1964715693728, 158.78963699483856, 112.93854451937374, 155.7528240736313, 180.65856892763267, 138.6129598909691, 111.71455362155571, 29.45860448717922, 149.78041151322793, 157.5660689324856, 140.67038596015433, 185.52563473191714, 149.5068002356718, 123.90272970252968, 165.94598886418007, 135.56606793730506, 189.72251893717868, 81.14053932627719, 166.1209905498922, 163.14978469275746, 129.3472091338324], "policy_predator_policy_reward": [28.485143554446104, 29.997062815205137, 53.63472400750187, 38.80377531254092, 29.940180615222424, 34.33961796814174, 14.95128007569788, 39.753346748508655, 73.0650967479305, 44.272529669243184, 19.436365667401517, 24.016406145101122, 3.9810394873839385, 12.643706955182292, 45.45001070367752, 58.207355798207466, 41.646597867936826, 23.037046693345047, 15.005078280338239, 17.63251816803876, 23.862140407255154, 51.28297956854041, 21.640017216407227, 5.645253895554249, 14.67154195868004, 8.42079914424086, 36.08274366284742, 20.60711906123392, 17.45323713716652, 28.28557019634901, 41.99386809680209, 29.141163117238783, 27.839372229110307, 41.30826687927728, 7.473184953850238, 22.670723288451583, 16.920949377847897, 17.68992188803827, 35.00782500291936, 44.404569271819796, 10.125170215508662, 4.6020513825407425, 10.829704105006778, 12.782203395676358, 24.042545027518834, 40.56686020107265, 48.80082865163666, 45.05076163726675, 36.02617265923002, 41.59169290735455, 22.22203101163754, 46.62290503545869, 25.24502838174758, 12.956307215185046, 75.50879407499941, 27.00488258555603, 7.229614108807053, 10.476246203791268, 13.589954967339459, 22.940990719582715, 19.569335599304168, 34.53357570300504, 13.903416324505976, 19.64622360618543, 41.893747345461605, 63.081341437769446, 31.544860910581853, 29.866318964392878, 24.748385428552467, 32.51858805320387, 15.989198754242326, 156.51034946989404, 8.305068190260208, 16.638929099499535, 15.197736166541317, 16.79073028122754, 9.055234630815859, 9.350543567512899, 50.46605164400651, 80.9872062392015, 3.732635000759509, 12.05804854269466, 6.474651601270761, 1.7482962344517423, 32.25049434221644, 8.877017637037122, 5.756868480695523, 18.864258121176135, 55.31486301171729, 49.520512222050506, 6.065692900760031, 27.61101430445162, 21.893719237746314, 29.484050000017096, 33.48056869679433, 15.796360767627691, 46.535304524284015, 22.156752623502417, 44.71387352563486, 42.73218148884258, 39.408399604680596, 23.007955272902116, 26.74425553294407, 37.35569379474534, 27.76807742257013, 13.831946913425723, 58.032230140227476, 44.51396202673296, 39.46349747160074, 22.364427923697683, 47.139335422144725, 28.99104213322067, 37.756583337791966, 21.155728344679982, 41.50290395332324, 20.574935309323408, 29.40313060334831, 30.038419350088848, 90.70691599943056, 70.46457506581388, 44.4992789014476, 41.47476592970696, 87.06469857591028, 54.49265041618334, 36.86331171564254, 61.482075033835855, 38.28164370603361, 39.22517968623113, 80.89785567746135, 93.75346393377873, 73.10663723595758, 52.72394217668051, 23.237014234232994, 58.16657647821648, 103.2862249864618, 67.39089335761703, 55.58110478998058, 66.78242803618001, 93.65103996746045, 69.86065974211304, 60.138546819263475, 32.829521899408206, 49.4583571853458, 25.862358300253277, 60.28395398583089, 138.32017479072127, 100.9178927607542, 48.70204728811587, 39.38100979460015, 60.36415642582971, 69.75189431097533, 43.61420957888116, 56.39298111776775, 61.36634319001973, 65.12930519008084, 58.24198158019241, 49.05306832339681, 89.81731191673194, 71.84242092659387, 63.61347259992925, 39.56991014545728, 43.451782698123296, 70.62386419839282, 29.04178766809208, 49.50715968649283, 65.44344721389731, 46.65965082802764, 29.921795847104654, 34.991436317581524, 64.76458594908117, 110.04568786139143, 73.53649885242338, 42.297121826678136, 34.97007074709179, 67.3271549491953, 44.289352303417715, 15.475680529037984, 35.55604827536175, 64.51115603420021, 69.42052827284526, 77.71702036740263, 36.922771037395925, 34.735629811825525, 29.73318919512541, 26.451572044355487, 66.52466840457973, 135.2744314313328, 68.1805037177103, 37.72953938393706, 38.77701563619157, 13.004682152535269, 18.38698607175348, 49.53676074234115, 54.92864592823389, 44.36401257374829, 43.28998963244729, 27.042602053330032, 102.31762996413815, 53.071821604181956, 46.561973692442464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5991997609776881, "mean_inference_ms": 1.8239095674288268, "mean_action_processing_ms": 0.2625097540224068, "mean_env_wait_ms": 0.22515164301379123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008026361465454102, "StateBufferConnector_ms": 0.0033538341522216797, "ViewRequirementAgentConnector_ms": 0.09908521175384521}, "num_episodes": 18, "episode_return_max": 429.42662811331405, "episode_return_min": 287.647253021523, "episode_return_mean": 374.4052133136946, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.4718558288889, "num_env_steps_trained_throughput_per_sec": 356.4718558288889, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 10920.994, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10920.936, "sample_time_ms": 1484.37, "learn_time_ms": 9419.625, "learn_throughput": 424.645, "synch_weights_time_ms": 15.008}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "e552a_00000", "date": "2024-08-16_08-52-00", "timestamp": 1723778520, "time_this_iter_s": 11.266577005386353, "time_total_s": 330.2830286026001, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.2830286026001, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 33.849999999999994, "ram_util_percent": 83.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.996978014739102, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.332509699069634, "policy_loss": -0.007530502827650813, "vf_loss": 7.336904794955379, "vf_explained_var": 0.022608979353829037, "kl": 0.009290075404925473, "entropy": 1.287822343054272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.80451763477275, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.079627384205975, "policy_loss": -0.01515719601391721, "vf_loss": 7.090467865000326, "vf_explained_var": 0.22984074697923407, "kl": 0.014389081675919051, "entropy": 1.4393356694746269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 420.7164179536111, "episode_reward_min": 287.647253021523, "episode_reward_mean": 376.72062620018494, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 13.957851910421933, "predator_policy": 1.7482962344517423}, "policy_reward_max": {"prey_policy": 197.38520753625036, "predator_policy": 156.51034946989404}, "policy_reward_mean": {"prey_policy": 142.49799402004808, "predator_policy": 45.86231908004445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.7829188243126, 348.3783023699184, 382.14569908836216, 377.48663479858754, 370.8595073912636, 312.6242328140844, 378.76178924221983, 392.4907436104196, 367.1420714053023, 374.3220740409609, 371.99548803587305, 376.9265855021471, 375.04499671343154, 367.4733403968117, 333.53123926162107, 350.8551585580121, 384.5073276884488, 376.2606606450407, 287.647253021523, 339.8869367528524, 387.3566515511816, 356.22606039634076, 373.8967945060519, 331.6977664350345, 388.77373862712426, 399.07872753582313, 348.8111968193231, 351.26523177657253, 335.08664079723144, 354.55535825070774, 380.89878202984784, 347.34605928264506, 392.67718025791817, 367.6324222919439, 358.6727635092304, 381.88496990426626, 361.3726742787053, 388.0018267016403, 345.5725898241276, 385.07781056394555, 408.950501243978, 355.22936560681507, 383.1096629339186, 372.5224460738157, 353.44920312728703, 412.19726283565336, 393.77817886382945, 376.0296754034614, 383.8066751046348, 414.9972251708063, 378.09026468225164, 374.6626414514579, 405.47067611580115, 399.75729683294134, 372.76706995754665, 293.6825588328453, 388.36225424712103, 377.6609333538536, 366.88574253064803, 356.8823453403742, 414.4087567208493, 348.32717727725174, 408.5684463838446, 386.3679729190107, 400.8802120082146, 343.3037539614598, 382.69395114945013, 374.7430099127684, 366.4241031918779, 394.3141252372849, 412.94258908067957, 376.62176189363714, 392.1307891232138, 375.2786463769546, 392.59997718304686, 349.6045650909426, 411.6061238751765, 355.9960905819818, 397.82480873918246, 384.8317797769122, 397.6357503946288, 420.7164179536111, 383.3362533779548, 399.13110368462293, 410.46424957203004, 368.37820456340586, 368.96036732510964, 359.6006640562353, 395.59841503532243, 395.59823215273764, 380.202423965275, 384.0308698560764, 399.78419155477883, 417.97740741180894, 362.94633852457986, 409.7396982404893, 415.7244829051661, 420.5842814521178, 411.0415817467723, 375.8428605521435], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.3612953516549, 97.90794681210252, 178.24260457172937, 152.42983748559072, 180.4245532800186, 165.1902001214217, 175.91478319474493, 147.4689403015334, 155.49477453129654, 181.81509292927547, 51.7139285334863, 155.93521549736715, 133.3857397222912, 183.96486964495384, 178.1205178000873, 157.10325232857613, 180.68467127074433, 13.957851910421933, 174.90760123777522, 174.47047551342632, 162.16401735359415, 177.84300423450998, 176.1918560322369, 182.32895127158145, 138.74900933561938, 104.84272949460437, 177.19573510188576, 174.4869217514718, 183.60821724972428, 141.70007417617444, 167.90383458476578, 141.82381199399262, 175.30555180319712, 184.58064928337998, 141.2388384825685, 130.18644692870438, 133.57455993849945, 120.3959858778119, 123.999849629567, 164.50931788552217, 178.2908618334468, 159.78886025331278, 140.9074473041791, 146.62655594437527, 151.70127519080464, 134.7494643007696, 123.15859340043646, 146.1228181570156, 159.68004191589924, 164.99374738353552, 170.31965533032027, 187.1590478695072, 92.49639746791092, 153.76860718445195, 144.37265594152913, 145.06465043974558, 124.90355585338298, 134.0527073884832, 157.5142825824785, 138.1287639857577, 162.58048420026387, 156.24045856693715, 142.9520920457271, 144.95241728348108, 155.02759520978069, 76.47809398289314, 159.2495235004527, 122.40885396033657, 138.66258967637586, 78.45282484076127, 150.1359653745905, 133.40361778019746, 152.8257056734061, 131.04014521303398, 117.82124545858079, 95.52926163181905, 109.5844225307702, 110.15758788071919, 151.14591979484587, 152.52830005665052, 150.84879423755376, 87.42458866234516, 122.90671005836705, 109.9591227222874, 84.77930990258145, 134.818653321764, 138.20337814750016, 141.35099920764387, 113.09222772889458, 165.03625991279353, 109.61968076938304, 103.97345328971808, 78.2024877081708, 165.95575110678857, 140.4560000015002, 135.8285091815313, 120.0562841226875, 150.38428709209077, 157.40044749923374, 139.83745336378445, 126.67080170775158, 128.04817620422696, 125.31102850136884, 110.48123270996044, 137.25269842221635, 132.7620841670621, 152.03168158465976, 164.7039224047013, 124.4185022525473, 148.68291583851484, 119.7164681855908, 59.015483746864504, 158.61223630463874, 153.16857126735005, 139.22926757695265, 138.67564351023867, 89.69912932869853, 93.6044264881352, 148.28608826564425, 131.3290645009601, 123.34011714116579, 179.45213232707013, 134.72410612901388, 162.57134234383807, 133.44029050742623, 141.1964715693728, 158.78963699483856, 112.93854451937374, 155.7528240736313, 180.65856892763267, 138.6129598909691, 111.71455362155571, 29.45860448717922, 149.78041151322793, 157.5660689324856, 140.67038596015433, 185.52563473191714, 149.5068002356718, 123.90272970252968, 165.94598886418007, 135.56606793730506, 189.72251893717868, 81.14053932627719, 166.1209905498922, 163.14978469275746, 129.3472091338324, 175.57383773693968, 161.49281743911442, 130.39489780680566, 177.0767545653714, 159.3105476839196, 134.66278195573864, 177.15396325750282, 123.32197831064539, 105.06294852866093, 131.67713465505807, 172.1760560551807, 122.45210743525062, 158.02831660977603, 150.6724101434904, 121.17189041920055, 185.53345962681516, 137.68462805132992, 189.32516578238403, 183.28728304177062, 180.49977888548108, 117.78884645782045, 160.26302945596532, 159.23852573591657, 166.1010183879941, 169.63369731418894, 160.20421217341558, 158.8367432903618, 167.90430066266265, 148.24127572181334, 96.45023699552435, 157.64557664731083, 130.87844952910592, 180.3201449584361, 161.95906470390204, 132.7638344865467, 87.53378992494392, 105.70327280278548, 112.8333807482814, 142.4645268859593, 153.70595376983943, 186.35598549856613, 143.95213785606452, 155.31609091763016, 100.29436797387184, 177.35091004994268, 197.38520753625036, 120.08394465382271, 167.20588127748783, 114.61760132460475, 176.30634599279065, 165.84460002571063, 112.21405738237462, 91.18484272459541, 122.92847926064162], "policy_predator_policy_reward": [75.50879407499941, 27.00488258555603, 7.229614108807053, 10.476246203791268, 13.589954967339459, 22.940990719582715, 19.569335599304168, 34.53357570300504, 13.903416324505976, 19.64622360618543, 41.893747345461605, 63.081341437769446, 31.544860910581853, 29.866318964392878, 24.748385428552467, 32.51858805320387, 15.989198754242326, 156.51034946989404, 8.305068190260208, 16.638929099499535, 15.197736166541317, 16.79073028122754, 9.055234630815859, 9.350543567512899, 50.46605164400651, 80.9872062392015, 3.732635000759509, 12.05804854269466, 6.474651601270761, 1.7482962344517423, 32.25049434221644, 8.877017637037122, 5.756868480695523, 18.864258121176135, 55.31486301171729, 49.520512222050506, 6.065692900760031, 27.61101430445162, 21.893719237746314, 29.484050000017096, 33.48056869679433, 15.796360767627691, 46.535304524284015, 22.156752623502417, 44.71387352563486, 42.73218148884258, 39.408399604680596, 23.007955272902116, 26.74425553294407, 37.35569379474534, 27.76807742257013, 13.831946913425723, 58.032230140227476, 44.51396202673296, 39.46349747160074, 22.364427923697683, 47.139335422144725, 28.99104213322067, 37.756583337791966, 21.155728344679982, 41.50290395332324, 20.574935309323408, 29.40313060334831, 30.038419350088848, 90.70691599943056, 70.46457506581388, 44.4992789014476, 41.47476592970696, 87.06469857591028, 54.49265041618334, 36.86331171564254, 61.482075033835855, 38.28164370603361, 39.22517968623113, 80.89785567746135, 93.75346393377873, 73.10663723595758, 52.72394217668051, 23.237014234232994, 58.16657647821648, 103.2862249864618, 67.39089335761703, 55.58110478998058, 66.78242803618001, 93.65103996746045, 69.86065974211304, 60.138546819263475, 32.829521899408206, 49.4583571853458, 25.862358300253277, 60.28395398583089, 138.32017479072127, 100.9178927607542, 48.70204728811587, 39.38100979460015, 60.36415642582971, 69.75189431097533, 43.61420957888116, 56.39298111776775, 61.36634319001973, 65.12930519008084, 58.24198158019241, 49.05306832339681, 89.81731191673194, 71.84242092659387, 63.61347259992925, 39.56991014545728, 43.451782698123296, 70.62386419839282, 29.04178766809208, 49.50715968649283, 65.44344721389731, 46.65965082802764, 29.921795847104654, 34.991436317581524, 64.76458594908117, 110.04568786139143, 73.53649885242338, 42.297121826678136, 34.97007074709179, 67.3271549491953, 44.289352303417715, 15.475680529037984, 35.55604827536175, 64.51115603420021, 69.42052827284526, 77.71702036740263, 36.922771037395925, 34.735629811825525, 29.73318919512541, 26.451572044355487, 66.52466840457973, 135.2744314313328, 68.1805037177103, 37.72953938393706, 38.77701563619157, 13.004682152535269, 18.38698607175348, 49.53676074234115, 54.92864592823389, 44.36401257374829, 43.28998963244729, 27.042602053330032, 102.31762996413815, 53.071821604181956, 46.561973692442464, 17.210631231878494, 21.00135996902214, 49.89352882615784, 35.234795984711525, 22.246168185467816, 33.38506726581662, 55.959234705399574, 55.170947601628846, 50.88581865281476, 68.37018874544782, 52.50549019596425, 50.69115505278689, 29.119360186143904, 47.0116928375019, 46.73501557586628, 44.195384772746905, 43.75184386085779, 49.9547802590397, 4.924016899696804, 14.625174551006166, 63.43950419807275, 57.639723572765135, 42.16390755743498, 42.960797890684695, 8.14811870236166, 30.392176373439725, 20.071009569500877, 22.148313802584326, 58.21374250099597, 56.69540883790176, 45.64682139316028, 61.42756746574508, 28.46468440504334, 24.854338085356137, 63.457149461861505, 96.44765009192285, 79.11287382744744, 86.38134247756204, 53.175846958943026, 50.43786394003693, 36.344417993343065, 51.32486606383527, 77.153621031266, 30.18225860181146, 20.233258513163467, 14.770322141132361, 69.24089901085154, 59.19375796300465, 79.35575875840739, 50.304575376314666, 89.57922139164715, 43.40370294704024, 82.85614931674228, 78.87338925016438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6010341710346073, "mean_inference_ms": 1.8280622385965024, "mean_action_processing_ms": 0.26197358322551145, "mean_env_wait_ms": 0.22600213739855543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012227296829223633, "StateBufferConnector_ms": 0.0037894248962402344, "ViewRequirementAgentConnector_ms": 0.11393904685974121}, "num_episodes": 27, "episode_return_max": 420.7164179536111, "episode_return_min": 287.647253021523, "episode_return_mean": 376.72062620018494, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.48844974432643, "num_env_steps_trained_throughput_per_sec": 366.48844974432643, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 10929.037, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10928.979, "sample_time_ms": 1493.332, "learn_time_ms": 9418.466, "learn_throughput": 424.698, "synch_weights_time_ms": 15.099}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "e552a_00000", "date": "2024-08-16_08-52-11", "timestamp": 1723778531, "time_this_iter_s": 10.956269979476929, "time_total_s": 341.239298582077, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7347f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 341.239298582077, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 31.64666666666666, "ram_util_percent": 83.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.609237494544377, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.552139986885918, "policy_loss": -0.006899732543727157, "vf_loss": 6.556340534472592, "vf_explained_var": 0.0408983085836683, "kl": 0.007997610675203536, "entropy": 1.2825167906347406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.454094466267439, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.79225962881058, "policy_loss": -0.007952247801971025, "vf_loss": 5.797176278583587, "vf_explained_var": 0.31809196424862696, "kl": 0.010118665838710812, "entropy": 1.4431402263187227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 420.7164179536111, "episode_reward_min": 287.647253021523, "episode_reward_mean": 378.54376942396686, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.45860448717922, "predator_policy": 2.8201723891396733}, "policy_reward_max": {"prey_policy": 197.38520753625036, "predator_policy": 138.32017479072127}, "policy_reward_mean": {"prey_policy": 143.40538032003383, "predator_policy": 45.86650439194962}, "custom_metrics": {}, "hist_stats": {"episode_reward": [287.647253021523, 339.8869367528524, 387.3566515511816, 356.22606039634076, 373.8967945060519, 331.6977664350345, 388.77373862712426, 399.07872753582313, 348.8111968193231, 351.26523177657253, 335.08664079723144, 354.55535825070774, 380.89878202984784, 347.34605928264506, 392.67718025791817, 367.6324222919439, 358.6727635092304, 381.88496990426626, 361.3726742787053, 388.0018267016403, 345.5725898241276, 385.07781056394555, 408.950501243978, 355.22936560681507, 383.1096629339186, 372.5224460738157, 353.44920312728703, 412.19726283565336, 393.77817886382945, 376.0296754034614, 383.8066751046348, 414.9972251708063, 378.09026468225164, 374.6626414514579, 405.47067611580115, 399.75729683294134, 372.76706995754665, 293.6825588328453, 388.36225424712103, 377.6609333538536, 366.88574253064803, 356.8823453403742, 414.4087567208493, 348.32717727725174, 408.5684463838446, 386.3679729190107, 400.8802120082146, 343.3037539614598, 382.69395114945013, 374.7430099127684, 366.4241031918779, 394.3141252372849, 412.94258908067957, 376.62176189363714, 392.1307891232138, 375.2786463769546, 392.59997718304686, 349.6045650909426, 411.6061238751765, 355.9960905819818, 397.82480873918246, 384.8317797769122, 397.6357503946288, 420.7164179536111, 383.3362533779548, 399.13110368462293, 410.46424957203004, 368.37820456340586, 368.96036732510964, 359.6006640562353, 395.59841503532243, 395.59823215273764, 380.202423965275, 384.0308698560764, 399.78419155477883, 417.97740741180894, 362.94633852457986, 409.7396982404893, 415.7244829051661, 420.5842814521178, 411.0415817467723, 375.8428605521435, 355.42186070801137, 391.692920826982, 398.2531289666347, 355.25151802619826, 390.08645783692197, 346.2887302517118, 375.3021321845633, 363.78366186693836, 396.1370906134502, 385.1324203696063, 328.9006121054578, 405.7430273374516, 397.7733640079741, 367.56335504581, 389.15016803267633, 382.75747011273586, 373.4085183925257, 373.2566560793496], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [133.57455993849945, 120.3959858778119, 123.999849629567, 164.50931788552217, 178.2908618334468, 159.78886025331278, 140.9074473041791, 146.62655594437527, 151.70127519080464, 134.7494643007696, 123.15859340043646, 146.1228181570156, 159.68004191589924, 164.99374738353552, 170.31965533032027, 187.1590478695072, 92.49639746791092, 153.76860718445195, 144.37265594152913, 145.06465043974558, 124.90355585338298, 134.0527073884832, 157.5142825824785, 138.1287639857577, 162.58048420026387, 156.24045856693715, 142.9520920457271, 144.95241728348108, 155.02759520978069, 76.47809398289314, 159.2495235004527, 122.40885396033657, 138.66258967637586, 78.45282484076127, 150.1359653745905, 133.40361778019746, 152.8257056734061, 131.04014521303398, 117.82124545858079, 95.52926163181905, 109.5844225307702, 110.15758788071919, 151.14591979484587, 152.52830005665052, 150.84879423755376, 87.42458866234516, 122.90671005836705, 109.9591227222874, 84.77930990258145, 134.818653321764, 138.20337814750016, 141.35099920764387, 113.09222772889458, 165.03625991279353, 109.61968076938304, 103.97345328971808, 78.2024877081708, 165.95575110678857, 140.4560000015002, 135.8285091815313, 120.0562841226875, 150.38428709209077, 157.40044749923374, 139.83745336378445, 126.67080170775158, 128.04817620422696, 125.31102850136884, 110.48123270996044, 137.25269842221635, 132.7620841670621, 152.03168158465976, 164.7039224047013, 124.4185022525473, 148.68291583851484, 119.7164681855908, 59.015483746864504, 158.61223630463874, 153.16857126735005, 139.22926757695265, 138.67564351023867, 89.69912932869853, 93.6044264881352, 148.28608826564425, 131.3290645009601, 123.34011714116579, 179.45213232707013, 134.72410612901388, 162.57134234383807, 133.44029050742623, 141.1964715693728, 158.78963699483856, 112.93854451937374, 155.7528240736313, 180.65856892763267, 138.6129598909691, 111.71455362155571, 29.45860448717922, 149.78041151322793, 157.5660689324856, 140.67038596015433, 185.52563473191714, 149.5068002356718, 123.90272970252968, 165.94598886418007, 135.56606793730506, 189.72251893717868, 81.14053932627719, 166.1209905498922, 163.14978469275746, 129.3472091338324, 175.57383773693968, 161.49281743911442, 130.39489780680566, 177.0767545653714, 159.3105476839196, 134.66278195573864, 177.15396325750282, 123.32197831064539, 105.06294852866093, 131.67713465505807, 172.1760560551807, 122.45210743525062, 158.02831660977603, 150.6724101434904, 121.17189041920055, 185.53345962681516, 137.68462805132992, 189.32516578238403, 183.28728304177062, 180.49977888548108, 117.78884645782045, 160.26302945596532, 159.23852573591657, 166.1010183879941, 169.63369731418894, 160.20421217341558, 158.8367432903618, 167.90430066266265, 148.24127572181334, 96.45023699552435, 157.64557664731083, 130.87844952910592, 180.3201449584361, 161.95906470390204, 132.7638344865467, 87.53378992494392, 105.70327280278548, 112.8333807482814, 142.4645268859593, 153.70595376983943, 186.35598549856613, 143.95213785606452, 155.31609091763016, 100.29436797387184, 177.35091004994268, 197.38520753625036, 120.08394465382271, 167.20588127748783, 114.61760132460475, 176.30634599279065, 165.84460002571063, 112.21405738237462, 91.18484272459541, 122.92847926064162, 149.92858940323669, 104.44524971816455, 186.87504213919573, 172.1964075370702, 186.80938224288832, 184.23642967827445, 132.55529502022176, 135.72696875833978, 167.25015140755715, 182.170604680643, 153.75058165246554, 152.13744438658563, 142.8381773776365, 141.12995408599312, 163.57690417773318, 180.96732379436094, 160.54716692735744, 162.1679958559179, 166.75693204341138, 182.26017949722353, 101.39867679515477, 148.72277917914434, 120.61955507118381, 177.25340553164605, 169.99448911642293, 147.5946714496998, 169.28687015194953, 176.69372799360903, 158.17203211312147, 183.4437007491441, 135.22033676818046, 157.42143475085385, 182.22672841745387, 170.67446315752153, 159.86453831021717, 166.2068711740758], "policy_predator_policy_reward": [6.065692900760031, 27.61101430445162, 21.893719237746314, 29.484050000017096, 33.48056869679433, 15.796360767627691, 46.535304524284015, 22.156752623502417, 44.71387352563486, 42.73218148884258, 39.408399604680596, 23.007955272902116, 26.74425553294407, 37.35569379474534, 27.76807742257013, 13.831946913425723, 58.032230140227476, 44.51396202673296, 39.46349747160074, 22.364427923697683, 47.139335422144725, 28.99104213322067, 37.756583337791966, 21.155728344679982, 41.50290395332324, 20.574935309323408, 29.40313060334831, 30.038419350088848, 90.70691599943056, 70.46457506581388, 44.4992789014476, 41.47476592970696, 87.06469857591028, 54.49265041618334, 36.86331171564254, 61.482075033835855, 38.28164370603361, 39.22517968623113, 80.89785567746135, 93.75346393377873, 73.10663723595758, 52.72394217668051, 23.237014234232994, 58.16657647821648, 103.2862249864618, 67.39089335761703, 55.58110478998058, 66.78242803618001, 93.65103996746045, 69.86065974211304, 60.138546819263475, 32.829521899408206, 49.4583571853458, 25.862358300253277, 60.28395398583089, 138.32017479072127, 100.9178927607542, 48.70204728811587, 39.38100979460015, 60.36415642582971, 69.75189431097533, 43.61420957888116, 56.39298111776775, 61.36634319001973, 65.12930519008084, 58.24198158019241, 49.05306832339681, 89.81731191673194, 71.84242092659387, 63.61347259992925, 39.56991014545728, 43.451782698123296, 70.62386419839282, 29.04178766809208, 49.50715968649283, 65.44344721389731, 46.65965082802764, 29.921795847104654, 34.991436317581524, 64.76458594908117, 110.04568786139143, 73.53649885242338, 42.297121826678136, 34.97007074709179, 67.3271549491953, 44.289352303417715, 15.475680529037984, 35.55604827536175, 64.51115603420021, 69.42052827284526, 77.71702036740263, 36.922771037395925, 34.735629811825525, 29.73318919512541, 26.451572044355487, 66.52466840457973, 135.2744314313328, 68.1805037177103, 37.72953938393706, 38.77701563619157, 13.004682152535269, 18.38698607175348, 49.53676074234115, 54.92864592823389, 44.36401257374829, 43.28998963244729, 27.042602053330032, 102.31762996413815, 53.071821604181956, 46.561973692442464, 17.210631231878494, 21.00135996902214, 49.89352882615784, 35.234795984711525, 22.246168185467816, 33.38506726581662, 55.959234705399574, 55.170947601628846, 50.88581865281476, 68.37018874544782, 52.50549019596425, 50.69115505278689, 29.119360186143904, 47.0116928375019, 46.73501557586628, 44.195384772746905, 43.75184386085779, 49.9547802590397, 4.924016899696804, 14.625174551006166, 63.43950419807275, 57.639723572765135, 42.16390755743498, 42.960797890684695, 8.14811870236166, 30.392176373439725, 20.071009569500877, 22.148313802584326, 58.21374250099597, 56.69540883790176, 45.64682139316028, 61.42756746574508, 28.46468440504334, 24.854338085356137, 63.457149461861505, 96.44765009192285, 79.11287382744744, 86.38134247756204, 53.175846958943026, 50.43786394003693, 36.344417993343065, 51.32486606383527, 77.153621031266, 30.18225860181146, 20.233258513163467, 14.770322141132361, 69.24089901085154, 59.19375796300465, 79.35575875840739, 50.304575376314666, 89.57922139164715, 43.40370294704024, 82.85614931674228, 78.87338925016438, 47.706539849035906, 53.34148173757432, 15.24637340354291, 17.375097747173257, 14.395168256387443, 12.812148789084599, 54.459867531300524, 32.50938671633625, 20.98021559340619, 19.685486155315523, 16.7916660111153, 23.609038201545776, 66.67766584253536, 24.65633487839831, 8.066014928197488, 11.17341896664671, 23.468170815573632, 49.953757014601095, 17.405312195074583, 18.709996633896615, 13.63828006276223, 65.14087606839641, 46.506596677714725, 61.36347005690707, 42.60016988697336, 37.58403355487828, 18.76258451111179, 2.8201723891396733, 20.98973843955507, 26.54469673085553, 41.97196836622752, 48.14373022747421, 9.647614766298924, 10.859712051251483, 8.718920007136965, 38.46632658791967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6017500762287473, "mean_inference_ms": 1.8365131860588644, "mean_action_processing_ms": 0.2615618588743404, "mean_env_wait_ms": 0.22653889350643927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00890207290649414, "StateBufferConnector_ms": 0.0037910938262939453, "ViewRequirementAgentConnector_ms": 0.11347901821136475}, "num_episodes": 18, "episode_return_max": 420.7164179536111, "episode_return_min": 287.647253021523, "episode_return_mean": 378.54376942396686, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.0468706705061, "num_env_steps_trained_throughput_per_sec": 321.0468706705061, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 11043.654, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11043.6, "sample_time_ms": 1501.524, "learn_time_ms": 9524.908, "learn_throughput": 419.952, "synch_weights_time_ms": 15.101}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "e552a_00000", "date": "2024-08-16_08-52-23", "timestamp": 1723778543, "time_this_iter_s": 12.510528802871704, "time_total_s": 353.74982738494873, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72deb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 353.74982738494873, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 47.86111111111111, "ram_util_percent": 83.90555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.908441702146379, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.493753297240646, "policy_loss": -0.007170114164282543, "vf_loss": 5.498387896573102, "vf_explained_var": 0.22972472335295702, "kl": 0.0075126443432521435, "entropy": 1.2719518723941985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.848852177334841, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.684990806428213, "policy_loss": -0.004792682019988735, "vf_loss": 3.68766555874436, "vf_explained_var": 0.26548630601514583, "kl": 0.007059758101439381, "entropy": 1.4566053186144148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 420.7164179536111, "episode_reward_min": 293.6825588328453, "episode_reward_mean": 382.0429296922864, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.45860448717922, "predator_policy": 2.024476209065791}, "policy_reward_max": {"prey_policy": 197.38520753625036, "predator_policy": 138.32017479072127}, "policy_reward_mean": {"prey_policy": 147.1455471825673, "predator_policy": 43.875917663575926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.3726742787053, 388.0018267016403, 345.5725898241276, 385.07781056394555, 408.950501243978, 355.22936560681507, 383.1096629339186, 372.5224460738157, 353.44920312728703, 412.19726283565336, 393.77817886382945, 376.0296754034614, 383.8066751046348, 414.9972251708063, 378.09026468225164, 374.6626414514579, 405.47067611580115, 399.75729683294134, 372.76706995754665, 293.6825588328453, 388.36225424712103, 377.6609333538536, 366.88574253064803, 356.8823453403742, 414.4087567208493, 348.32717727725174, 408.5684463838446, 386.3679729190107, 400.8802120082146, 343.3037539614598, 382.69395114945013, 374.7430099127684, 366.4241031918779, 394.3141252372849, 412.94258908067957, 376.62176189363714, 392.1307891232138, 375.2786463769546, 392.59997718304686, 349.6045650909426, 411.6061238751765, 355.9960905819818, 397.82480873918246, 384.8317797769122, 397.6357503946288, 420.7164179536111, 383.3362533779548, 399.13110368462293, 410.46424957203004, 368.37820456340586, 368.96036732510964, 359.6006640562353, 395.59841503532243, 395.59823215273764, 380.202423965275, 384.0308698560764, 399.78419155477883, 417.97740741180894, 362.94633852457986, 409.7396982404893, 415.7244829051661, 420.5842814521178, 411.0415817467723, 375.8428605521435, 355.42186070801137, 391.692920826982, 398.2531289666347, 355.25151802619826, 390.08645783692197, 346.2887302517118, 375.3021321845633, 363.78366186693836, 396.1370906134502, 385.1324203696063, 328.9006121054578, 405.7430273374516, 397.7733640079741, 367.56335504581, 389.15016803267633, 382.75747011273586, 373.4085183925257, 373.2566560793496, 387.03611731871547, 383.8712114199987, 397.69306912466914, 351.9520634961358, 387.6899038134764, 349.3294270916905, 402.1414431793724, 375.44131201923244, 387.42151991618323, 374.03598720581573, 390.78199783455943, 387.937667652021, 361.79828283554855, 385.9484935211299, 353.73876966630326, 363.03256029678107, 400.15021924672, 393.3105149392246], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.8257056734061, 131.04014521303398, 117.82124545858079, 95.52926163181905, 109.5844225307702, 110.15758788071919, 151.14591979484587, 152.52830005665052, 150.84879423755376, 87.42458866234516, 122.90671005836705, 109.9591227222874, 84.77930990258145, 134.818653321764, 138.20337814750016, 141.35099920764387, 113.09222772889458, 165.03625991279353, 109.61968076938304, 103.97345328971808, 78.2024877081708, 165.95575110678857, 140.4560000015002, 135.8285091815313, 120.0562841226875, 150.38428709209077, 157.40044749923374, 139.83745336378445, 126.67080170775158, 128.04817620422696, 125.31102850136884, 110.48123270996044, 137.25269842221635, 132.7620841670621, 152.03168158465976, 164.7039224047013, 124.4185022525473, 148.68291583851484, 119.7164681855908, 59.015483746864504, 158.61223630463874, 153.16857126735005, 139.22926757695265, 138.67564351023867, 89.69912932869853, 93.6044264881352, 148.28608826564425, 131.3290645009601, 123.34011714116579, 179.45213232707013, 134.72410612901388, 162.57134234383807, 133.44029050742623, 141.1964715693728, 158.78963699483856, 112.93854451937374, 155.7528240736313, 180.65856892763267, 138.6129598909691, 111.71455362155571, 29.45860448717922, 149.78041151322793, 157.5660689324856, 140.67038596015433, 185.52563473191714, 149.5068002356718, 123.90272970252968, 165.94598886418007, 135.56606793730506, 189.72251893717868, 81.14053932627719, 166.1209905498922, 163.14978469275746, 129.3472091338324, 175.57383773693968, 161.49281743911442, 130.39489780680566, 177.0767545653714, 159.3105476839196, 134.66278195573864, 177.15396325750282, 123.32197831064539, 105.06294852866093, 131.67713465505807, 172.1760560551807, 122.45210743525062, 158.02831660977603, 150.6724101434904, 121.17189041920055, 185.53345962681516, 137.68462805132992, 189.32516578238403, 183.28728304177062, 180.49977888548108, 117.78884645782045, 160.26302945596532, 159.23852573591657, 166.1010183879941, 169.63369731418894, 160.20421217341558, 158.8367432903618, 167.90430066266265, 148.24127572181334, 96.45023699552435, 157.64557664731083, 130.87844952910592, 180.3201449584361, 161.95906470390204, 132.7638344865467, 87.53378992494392, 105.70327280278548, 112.8333807482814, 142.4645268859593, 153.70595376983943, 186.35598549856613, 143.95213785606452, 155.31609091763016, 100.29436797387184, 177.35091004994268, 197.38520753625036, 120.08394465382271, 167.20588127748783, 114.61760132460475, 176.30634599279065, 165.84460002571063, 112.21405738237462, 91.18484272459541, 122.92847926064162, 149.92858940323669, 104.44524971816455, 186.87504213919573, 172.1964075370702, 186.80938224288832, 184.23642967827445, 132.55529502022176, 135.72696875833978, 167.25015140755715, 182.170604680643, 153.75058165246554, 152.13744438658563, 142.8381773776365, 141.12995408599312, 163.57690417773318, 180.96732379436094, 160.54716692735744, 162.1679958559179, 166.75693204341138, 182.26017949722353, 101.39867679515477, 148.72277917914434, 120.61955507118381, 177.25340553164605, 169.99448911642293, 147.5946714496998, 169.28687015194953, 176.69372799360903, 158.17203211312147, 183.4437007491441, 135.22033676818046, 157.42143475085385, 182.22672841745387, 170.67446315752153, 159.86453831021717, 166.2068711740758, 180.64663152138456, 189.9299171144609, 180.91826689519576, 137.3168705777253, 192.3345594699189, 161.36749646112213, 147.28964140237107, 112.49870639631324, 176.1522457700652, 159.11782674983908, 125.80224618356459, 168.24664430987212, 182.4809689383821, 157.97091214367552, 161.20023762757782, 166.7921371087257, 172.83483783022777, 187.45998713777595, 190.36435143565646, 167.54334143035467, 183.529860376645, 147.82439054301406, 178.623786537348, 135.41755893723962, 150.6586101083792, 150.4674911897007, 164.52112755008937, 74.16689982876827, 126.1068826458531, 164.85982340048858, 173.9295606109735, 179.007075890466, 190.01060256553336, 155.53529906036513, 191.77982925297684, 180.15096698518667], "policy_predator_policy_reward": [38.28164370603361, 39.22517968623113, 80.89785567746135, 93.75346393377873, 73.10663723595758, 52.72394217668051, 23.237014234232994, 58.16657647821648, 103.2862249864618, 67.39089335761703, 55.58110478998058, 66.78242803618001, 93.65103996746045, 69.86065974211304, 60.138546819263475, 32.829521899408206, 49.4583571853458, 25.862358300253277, 60.28395398583089, 138.32017479072127, 100.9178927607542, 48.70204728811587, 39.38100979460015, 60.36415642582971, 69.75189431097533, 43.61420957888116, 56.39298111776775, 61.36634319001973, 65.12930519008084, 58.24198158019241, 49.05306832339681, 89.81731191673194, 71.84242092659387, 63.61347259992925, 39.56991014545728, 43.451782698123296, 70.62386419839282, 29.04178766809208, 49.50715968649283, 65.44344721389731, 46.65965082802764, 29.921795847104654, 34.991436317581524, 64.76458594908117, 110.04568786139143, 73.53649885242338, 42.297121826678136, 34.97007074709179, 67.3271549491953, 44.289352303417715, 15.475680529037984, 35.55604827536175, 64.51115603420021, 69.42052827284526, 77.71702036740263, 36.922771037395925, 34.735629811825525, 29.73318919512541, 26.451572044355487, 66.52466840457973, 135.2744314313328, 68.1805037177103, 37.72953938393706, 38.77701563619157, 13.004682152535269, 18.38698607175348, 49.53676074234115, 54.92864592823389, 44.36401257374829, 43.28998963244729, 27.042602053330032, 102.31762996413815, 53.071821604181956, 46.561973692442464, 17.210631231878494, 21.00135996902214, 49.89352882615784, 35.234795984711525, 22.246168185467816, 33.38506726581662, 55.959234705399574, 55.170947601628846, 50.88581865281476, 68.37018874544782, 52.50549019596425, 50.69115505278689, 29.119360186143904, 47.0116928375019, 46.73501557586628, 44.195384772746905, 43.75184386085779, 49.9547802590397, 4.924016899696804, 14.625174551006166, 63.43950419807275, 57.639723572765135, 42.16390755743498, 42.960797890684695, 8.14811870236166, 30.392176373439725, 20.071009569500877, 22.148313802584326, 58.21374250099597, 56.69540883790176, 45.64682139316028, 61.42756746574508, 28.46468440504334, 24.854338085356137, 63.457149461861505, 96.44765009192285, 79.11287382744744, 86.38134247756204, 53.175846958943026, 50.43786394003693, 36.344417993343065, 51.32486606383527, 77.153621031266, 30.18225860181146, 20.233258513163467, 14.770322141132361, 69.24089901085154, 59.19375796300465, 79.35575875840739, 50.304575376314666, 89.57922139164715, 43.40370294704024, 82.85614931674228, 78.87338925016438, 47.706539849035906, 53.34148173757432, 15.24637340354291, 17.375097747173257, 14.395168256387443, 12.812148789084599, 54.459867531300524, 32.50938671633625, 20.98021559340619, 19.685486155315523, 16.7916660111153, 23.609038201545776, 66.67766584253536, 24.65633487839831, 8.066014928197488, 11.17341896664671, 23.468170815573632, 49.953757014601095, 17.405312195074583, 18.709996633896615, 13.63828006276223, 65.14087606839641, 46.506596677714725, 61.36347005690707, 42.60016988697336, 37.58403355487828, 18.76258451111179, 2.8201723891396733, 20.98973843955507, 26.54469673085553, 41.97196836622752, 48.14373022747421, 9.647614766298924, 10.859712051251483, 8.718920007136965, 38.46632658791967, 14.435092473804275, 2.024476209065791, 32.4408912468122, 33.19518270026536, 26.49635422355877, 17.49465897006941, 68.85776206038341, 23.30595363706783, 34.82341807346384, 17.596413220108392, 30.141938431425867, 25.13859816682796, 43.60231984964352, 18.08724224767131, 35.64713584712221, 11.801801435806665, 5.918027646069083, 21.208667302110268, 3.7422752630981924, 12.3860190767064, 40.817136605662284, 18.61061030923812, 29.64314356253534, 44.253178614897884, 32.74007193002768, 27.932109607441042, 74.58557037892118, 72.67489576335112, 50.68333137491503, 12.088732245046433, 5.182514868364668, 4.913408926976906, 35.12173169976878, 19.482585921052724, 13.659575195667275, 7.72014350539381]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6018722109394864, "mean_inference_ms": 1.8386236356783037, "mean_action_processing_ms": 0.260923816405853, "mean_env_wait_ms": 0.22650596080597482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00894308090209961, "StateBufferConnector_ms": 0.003552079200744629, "ViewRequirementAgentConnector_ms": 0.1104499101638794}, "num_episodes": 18, "episode_return_max": 420.7164179536111, "episode_return_min": 293.6825588328453, "episode_return_mean": 382.0429296922864, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.65071127786865, "num_env_steps_trained_throughput_per_sec": 345.65071127786865, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 11137.892, "restore_workers_time_ms": 0.018, "training_step_time_ms": 11137.839, "sample_time_ms": 1487.597, "learn_time_ms": 9632.946, "learn_throughput": 415.242, "synch_weights_time_ms": 15.095}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "e552a_00000", "date": "2024-08-16_08-52-35", "timestamp": 1723778555, "time_this_iter_s": 11.642787218093872, "time_total_s": 365.3926146030426, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72dec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 365.3926146030426, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.688235294117646, "ram_util_percent": 82.86470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.314549897839783, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7558137163283334, "policy_loss": -0.0069796972925326335, "vf_loss": 3.760684592887838, "vf_explained_var": 0.41818671444105726, "kl": 0.006248370839242102, "entropy": 1.26911193447769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3553155197352957, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.968691844031924, "policy_loss": -0.00652125640907793, "vf_loss": 3.9731481724945956, "vf_explained_var": 0.2631372141144263, "kl": 0.006883073413866451, "entropy": 1.4489679022440836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 420.7164179536111, "episode_reward_min": 293.6825588328453, "episode_reward_mean": 381.0461504477361, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.45860448717922, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 135.2744314313328}, "policy_reward_mean": {"prey_policy": 154.0442725248354, "predator_policy": 36.478802699032656}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.76706995754665, 293.6825588328453, 388.36225424712103, 377.6609333538536, 366.88574253064803, 356.8823453403742, 414.4087567208493, 348.32717727725174, 408.5684463838446, 386.3679729190107, 400.8802120082146, 343.3037539614598, 382.69395114945013, 374.7430099127684, 366.4241031918779, 394.3141252372849, 412.94258908067957, 376.62176189363714, 392.1307891232138, 375.2786463769546, 392.59997718304686, 349.6045650909426, 411.6061238751765, 355.9960905819818, 397.82480873918246, 384.8317797769122, 397.6357503946288, 420.7164179536111, 383.3362533779548, 399.13110368462293, 410.46424957203004, 368.37820456340586, 368.96036732510964, 359.6006640562353, 395.59841503532243, 395.59823215273764, 380.202423965275, 384.0308698560764, 399.78419155477883, 417.97740741180894, 362.94633852457986, 409.7396982404893, 415.7244829051661, 420.5842814521178, 411.0415817467723, 375.8428605521435, 355.42186070801137, 391.692920826982, 398.2531289666347, 355.25151802619826, 390.08645783692197, 346.2887302517118, 375.3021321845633, 363.78366186693836, 396.1370906134502, 385.1324203696063, 328.9006121054578, 405.7430273374516, 397.7733640079741, 367.56335504581, 389.15016803267633, 382.75747011273586, 373.4085183925257, 373.2566560793496, 387.03611731871547, 383.8712114199987, 397.69306912466914, 351.9520634961358, 387.6899038134764, 349.3294270916905, 402.1414431793724, 375.44131201923244, 387.42151991618323, 374.03598720581573, 390.78199783455943, 387.937667652021, 361.79828283554855, 385.9484935211299, 353.73876966630326, 363.03256029678107, 400.15021924672, 393.3105149392246, 412.48983980750666, 352.45189520275704, 381.5592331668219, 364.97005153728327, 393.4222017590381, 314.9719719991871, 370.23611777773743, 387.18367172432494, 395.405440486221, 418.5726732553133, 351.78369561878026, 367.87269978555696, 399.0785796585087, 401.4530704119237, 373.552076494624, 356.76664981570923, 394.06, 356.5681838587414], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [124.4185022525473, 148.68291583851484, 119.7164681855908, 59.015483746864504, 158.61223630463874, 153.16857126735005, 139.22926757695265, 138.67564351023867, 89.69912932869853, 93.6044264881352, 148.28608826564425, 131.3290645009601, 123.34011714116579, 179.45213232707013, 134.72410612901388, 162.57134234383807, 133.44029050742623, 141.1964715693728, 158.78963699483856, 112.93854451937374, 155.7528240736313, 180.65856892763267, 138.6129598909691, 111.71455362155571, 29.45860448717922, 149.78041151322793, 157.5660689324856, 140.67038596015433, 185.52563473191714, 149.5068002356718, 123.90272970252968, 165.94598886418007, 135.56606793730506, 189.72251893717868, 81.14053932627719, 166.1209905498922, 163.14978469275746, 129.3472091338324, 175.57383773693968, 161.49281743911442, 130.39489780680566, 177.0767545653714, 159.3105476839196, 134.66278195573864, 177.15396325750282, 123.32197831064539, 105.06294852866093, 131.67713465505807, 172.1760560551807, 122.45210743525062, 158.02831660977603, 150.6724101434904, 121.17189041920055, 185.53345962681516, 137.68462805132992, 189.32516578238403, 183.28728304177062, 180.49977888548108, 117.78884645782045, 160.26302945596532, 159.23852573591657, 166.1010183879941, 169.63369731418894, 160.20421217341558, 158.8367432903618, 167.90430066266265, 148.24127572181334, 96.45023699552435, 157.64557664731083, 130.87844952910592, 180.3201449584361, 161.95906470390204, 132.7638344865467, 87.53378992494392, 105.70327280278548, 112.8333807482814, 142.4645268859593, 153.70595376983943, 186.35598549856613, 143.95213785606452, 155.31609091763016, 100.29436797387184, 177.35091004994268, 197.38520753625036, 120.08394465382271, 167.20588127748783, 114.61760132460475, 176.30634599279065, 165.84460002571063, 112.21405738237462, 91.18484272459541, 122.92847926064162, 149.92858940323669, 104.44524971816455, 186.87504213919573, 172.1964075370702, 186.80938224288832, 184.23642967827445, 132.55529502022176, 135.72696875833978, 167.25015140755715, 182.170604680643, 153.75058165246554, 152.13744438658563, 142.8381773776365, 141.12995408599312, 163.57690417773318, 180.96732379436094, 160.54716692735744, 162.1679958559179, 166.75693204341138, 182.26017949722353, 101.39867679515477, 148.72277917914434, 120.61955507118381, 177.25340553164605, 169.99448911642293, 147.5946714496998, 169.28687015194953, 176.69372799360903, 158.17203211312147, 183.4437007491441, 135.22033676818046, 157.42143475085385, 182.22672841745387, 170.67446315752153, 159.86453831021717, 166.2068711740758, 180.64663152138456, 189.9299171144609, 180.91826689519576, 137.3168705777253, 192.3345594699189, 161.36749646112213, 147.28964140237107, 112.49870639631324, 176.1522457700652, 159.11782674983908, 125.80224618356459, 168.24664430987212, 182.4809689383821, 157.97091214367552, 161.20023762757782, 166.7921371087257, 172.83483783022777, 187.45998713777595, 190.36435143565646, 167.54334143035467, 183.529860376645, 147.82439054301406, 178.623786537348, 135.41755893723962, 150.6586101083792, 150.4674911897007, 164.52112755008937, 74.16689982876827, 126.1068826458531, 164.85982340048858, 173.9295606109735, 179.007075890466, 190.01060256553336, 155.53529906036513, 191.77982925297684, 180.15096698518667, 135.81134491021513, 190.18384886398357, 183.41744854648664, 135.40308911594911, 181.13700261030473, 177.0216550003355, 162.38, 189.99955276885234, 158.88081798066654, 200.0, 124.21011179290115, 117.85555207033508, 159.70321444663594, 195.89578168234704, 191.08420531634297, 186.65546937695882, 162.18410865817518, 165.93034446552355, 143.57543644842087, 174.6750707556291, 165.06759137889685, 142.8455697027867, 199.09260951315957, 165.3019971401198, 174.82199120427094, 198.21692763974664, 169.10055006648497, 200.0, 151.39904391801502, 171.4454588211878, 113.07393316418165, 168.3106218245143, 193.21875830653585, 194.84470376059681, 145.6400567775122, 139.38981240394034], "policy_predator_policy_reward": [70.62386419839282, 29.04178766809208, 49.50715968649283, 65.44344721389731, 46.65965082802764, 29.921795847104654, 34.991436317581524, 64.76458594908117, 110.04568786139143, 73.53649885242338, 42.297121826678136, 34.97007074709179, 67.3271549491953, 44.289352303417715, 15.475680529037984, 35.55604827536175, 64.51115603420021, 69.42052827284526, 77.71702036740263, 36.922771037395925, 34.735629811825525, 29.73318919512541, 26.451572044355487, 66.52466840457973, 135.2744314313328, 68.1805037177103, 37.72953938393706, 38.77701563619157, 13.004682152535269, 18.38698607175348, 49.53676074234115, 54.92864592823389, 44.36401257374829, 43.28998963244729, 27.042602053330032, 102.31762996413815, 53.071821604181956, 46.561973692442464, 17.210631231878494, 21.00135996902214, 49.89352882615784, 35.234795984711525, 22.246168185467816, 33.38506726581662, 55.959234705399574, 55.170947601628846, 50.88581865281476, 68.37018874544782, 52.50549019596425, 50.69115505278689, 29.119360186143904, 47.0116928375019, 46.73501557586628, 44.195384772746905, 43.75184386085779, 49.9547802590397, 4.924016899696804, 14.625174551006166, 63.43950419807275, 57.639723572765135, 42.16390755743498, 42.960797890684695, 8.14811870236166, 30.392176373439725, 20.071009569500877, 22.148313802584326, 58.21374250099597, 56.69540883790176, 45.64682139316028, 61.42756746574508, 28.46468440504334, 24.854338085356137, 63.457149461861505, 96.44765009192285, 79.11287382744744, 86.38134247756204, 53.175846958943026, 50.43786394003693, 36.344417993343065, 51.32486606383527, 77.153621031266, 30.18225860181146, 20.233258513163467, 14.770322141132361, 69.24089901085154, 59.19375796300465, 79.35575875840739, 50.304575376314666, 89.57922139164715, 43.40370294704024, 82.85614931674228, 78.87338925016438, 47.706539849035906, 53.34148173757432, 15.24637340354291, 17.375097747173257, 14.395168256387443, 12.812148789084599, 54.459867531300524, 32.50938671633625, 20.98021559340619, 19.685486155315523, 16.7916660111153, 23.609038201545776, 66.67766584253536, 24.65633487839831, 8.066014928197488, 11.17341896664671, 23.468170815573632, 49.953757014601095, 17.405312195074583, 18.709996633896615, 13.63828006276223, 65.14087606839641, 46.506596677714725, 61.36347005690707, 42.60016988697336, 37.58403355487828, 18.76258451111179, 2.8201723891396733, 20.98973843955507, 26.54469673085553, 41.97196836622752, 48.14373022747421, 9.647614766298924, 10.859712051251483, 8.718920007136965, 38.46632658791967, 14.435092473804275, 2.024476209065791, 32.4408912468122, 33.19518270026536, 26.49635422355877, 17.49465897006941, 68.85776206038341, 23.30595363706783, 34.82341807346384, 17.596413220108392, 30.141938431425867, 25.13859816682796, 43.60231984964352, 18.08724224767131, 35.64713584712221, 11.801801435806665, 5.918027646069083, 21.208667302110268, 3.7422752630981924, 12.3860190767064, 40.817136605662284, 18.61061030923812, 29.64314356253534, 44.253178614897884, 32.74007193002768, 27.932109607441042, 74.58557037892118, 72.67489576335112, 50.68333137491503, 12.088732245046433, 5.182514868364668, 4.913408926976906, 35.12173169976878, 19.482585921052724, 13.659575195667275, 7.72014350539381, 46.040753430091655, 40.45389260321634, 26.65429359378151, 6.977063946539935, 16.165021419082063, 7.235554137099694, 2.7681070997511266, 9.822391668679801, 14.572070306204031, 19.969313472167535, 5.666975366537241, 67.2393327694136, 7.508630606647381, 7.128491042107062, 3.3198858377553697, 6.124111193267788, 33.33547845838886, 33.955508904133275, 43.54708125897291, 56.7750847922904, 24.77187640729033, 19.098658129806356, 0.0, 3.478093132277619, 12.694098552292004, 13.345562262199142, 18.1605123874788, 14.192007957959937, 24.460547355201438, 26.247026400219717, 8.3261569003881, 67.05593792662496, 2.466045761957302, 3.5304921709100685, 62.60117508889521, 8.937139588393851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6022603030256222, "mean_inference_ms": 1.8416657025956897, "mean_action_processing_ms": 0.2604409330439652, "mean_env_wait_ms": 0.22653950853149568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008904695510864258, "StateBufferConnector_ms": 0.0035409927368164062, "ViewRequirementAgentConnector_ms": 0.10766232013702393}, "num_episodes": 18, "episode_return_max": 420.7164179536111, "episode_return_min": 293.6825588328453, "episode_return_mean": 381.0461504477361, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.41227089228914, "num_env_steps_trained_throughput_per_sec": 283.41227089228914, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 11444.312, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11444.26, "sample_time_ms": 1459.057, "learn_time_ms": 9967.673, "learn_throughput": 401.297, "synch_weights_time_ms": 15.304}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "e552a_00000", "date": "2024-08-16_08-52-49", "timestamp": 1723778569, "time_this_iter_s": 14.173143863677979, "time_total_s": 379.5657584667206, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 379.5657584667206, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 47.888888888888886, "ram_util_percent": 83.49444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.18238391453627, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2061560864171024, "policy_loss": -0.007820961195926266, "vf_loss": 3.211902986506306, "vf_explained_var": 0.5826411042894636, "kl": 0.006145368371574203, "entropy": 1.2770697529353792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.996565031847626, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.118419003991223, "policy_loss": -0.002828573230432258, "vf_loss": 4.120281268806054, "vf_explained_var": 0.1492260025607215, "kl": 0.0032209917557897896, "entropy": 1.4441699542696513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 420.7164179536111, "episode_reward_min": 265.7952059516291, "episode_reward_mean": 378.11972722700733, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 24.963605532322802, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 96.44765009192285}, "policy_reward_mean": {"prey_policy": 158.98930856602308, "predator_policy": 30.07055504748056}, "custom_metrics": {}, "hist_stats": {"episode_reward": [411.6061238751765, 355.9960905819818, 397.82480873918246, 384.8317797769122, 397.6357503946288, 420.7164179536111, 383.3362533779548, 399.13110368462293, 410.46424957203004, 368.37820456340586, 368.96036732510964, 359.6006640562353, 395.59841503532243, 395.59823215273764, 380.202423965275, 384.0308698560764, 399.78419155477883, 417.97740741180894, 362.94633852457986, 409.7396982404893, 415.7244829051661, 420.5842814521178, 411.0415817467723, 375.8428605521435, 355.42186070801137, 391.692920826982, 398.2531289666347, 355.25151802619826, 390.08645783692197, 346.2887302517118, 375.3021321845633, 363.78366186693836, 396.1370906134502, 385.1324203696063, 328.9006121054578, 405.7430273374516, 397.7733640079741, 367.56335504581, 389.15016803267633, 382.75747011273586, 373.4085183925257, 373.2566560793496, 387.03611731871547, 383.8712114199987, 397.69306912466914, 351.9520634961358, 387.6899038134764, 349.3294270916905, 402.1414431793724, 375.44131201923244, 387.42151991618323, 374.03598720581573, 390.78199783455943, 387.937667652021, 361.79828283554855, 385.9484935211299, 353.73876966630326, 363.03256029678107, 400.15021924672, 393.3105149392246, 412.48983980750666, 352.45189520275704, 381.5592331668219, 364.97005153728327, 393.4222017590381, 314.9719719991871, 370.23611777773743, 387.18367172432494, 395.405440486221, 418.5726732553133, 351.78369561878026, 367.87269978555696, 399.0785796585087, 401.4530704119237, 373.552076494624, 356.76664981570923, 394.06, 356.5681838587414, 346.53999999999996, 334.5376209240121, 341.1243536589449, 384.91591421418485, 362.62325562198953, 398.7174815314952, 383.52682185059905, 385.8204493731117, 377.4124477680644, 379.1161054397937, 389.88982223836246, 340.72354739110324, 265.7952059516291, 345.06048290046095, 392.86757056109843, 392.86747597723485, 337.5963857617526, 368.5072554190889, 360.31493871315587, 399.9253590129137, 304.51794890466476, 390.40797648633486], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.15396325750282, 123.32197831064539, 105.06294852866093, 131.67713465505807, 172.1760560551807, 122.45210743525062, 158.02831660977603, 150.6724101434904, 121.17189041920055, 185.53345962681516, 137.68462805132992, 189.32516578238403, 183.28728304177062, 180.49977888548108, 117.78884645782045, 160.26302945596532, 159.23852573591657, 166.1010183879941, 169.63369731418894, 160.20421217341558, 158.8367432903618, 167.90430066266265, 148.24127572181334, 96.45023699552435, 157.64557664731083, 130.87844952910592, 180.3201449584361, 161.95906470390204, 132.7638344865467, 87.53378992494392, 105.70327280278548, 112.8333807482814, 142.4645268859593, 153.70595376983943, 186.35598549856613, 143.95213785606452, 155.31609091763016, 100.29436797387184, 177.35091004994268, 197.38520753625036, 120.08394465382271, 167.20588127748783, 114.61760132460475, 176.30634599279065, 165.84460002571063, 112.21405738237462, 91.18484272459541, 122.92847926064162, 149.92858940323669, 104.44524971816455, 186.87504213919573, 172.1964075370702, 186.80938224288832, 184.23642967827445, 132.55529502022176, 135.72696875833978, 167.25015140755715, 182.170604680643, 153.75058165246554, 152.13744438658563, 142.8381773776365, 141.12995408599312, 163.57690417773318, 180.96732379436094, 160.54716692735744, 162.1679958559179, 166.75693204341138, 182.26017949722353, 101.39867679515477, 148.72277917914434, 120.61955507118381, 177.25340553164605, 169.99448911642293, 147.5946714496998, 169.28687015194953, 176.69372799360903, 158.17203211312147, 183.4437007491441, 135.22033676818046, 157.42143475085385, 182.22672841745387, 170.67446315752153, 159.86453831021717, 166.2068711740758, 180.64663152138456, 189.9299171144609, 180.91826689519576, 137.3168705777253, 192.3345594699189, 161.36749646112213, 147.28964140237107, 112.49870639631324, 176.1522457700652, 159.11782674983908, 125.80224618356459, 168.24664430987212, 182.4809689383821, 157.97091214367552, 161.20023762757782, 166.7921371087257, 172.83483783022777, 187.45998713777595, 190.36435143565646, 167.54334143035467, 183.529860376645, 147.82439054301406, 178.623786537348, 135.41755893723962, 150.6586101083792, 150.4674911897007, 164.52112755008937, 74.16689982876827, 126.1068826458531, 164.85982340048858, 173.9295606109735, 179.007075890466, 190.01060256553336, 155.53529906036513, 191.77982925297684, 180.15096698518667, 135.81134491021513, 190.18384886398357, 183.41744854648664, 135.40308911594911, 181.13700261030473, 177.0216550003355, 162.38, 189.99955276885234, 158.88081798066654, 200.0, 124.21011179290115, 117.85555207033508, 159.70321444663594, 195.89578168234704, 191.08420531634297, 186.65546937695882, 162.18410865817518, 165.93034446552355, 143.57543644842087, 174.6750707556291, 165.06759137889685, 142.8455697027867, 199.09260951315957, 165.3019971401198, 174.82199120427094, 198.21692763974664, 169.10055006648497, 200.0, 151.39904391801502, 171.4454588211878, 113.07393316418165, 168.3106218245143, 193.21875830653585, 194.84470376059681, 145.6400567775122, 139.38981240394034, 153.47000000000003, 187.34625858142186, 189.02369656089954, 111.41799949488531, 125.3750261307118, 91.0980854510358, 179.86358440850162, 174.19737171289853, 133.59673687849693, 136.66073432744497, 191.40049809275482, 190.31450940302796, 186.48345061053578, 183.6878972842912, 155.7916546529013, 150.41441300887212, 178.4155603602954, 185.48135202566857, 172.37308995897638, 177.66459025306904, 191.199679520193, 184.79706152656732, 175.11757020388217, 145.55, 24.963605532322802, 147.01544498999982, 126.09358172846983, 175.96958325397722, 163.16607816287862, 177.99663796480053, 190.5555253380605, 189.01359282951594, 141.89900365670192, 186.3627388584809, 168.00100109861472, 180.26895404206888, 156.82063325841386, 139.4725808528516, 189.33189267335177, 190.45490960965648, 146.67115261632946, 122.87258615675826, 199.7825605741072, 165.09904209734665], "policy_predator_policy_reward": [55.959234705399574, 55.170947601628846, 50.88581865281476, 68.37018874544782, 52.50549019596425, 50.69115505278689, 29.119360186143904, 47.0116928375019, 46.73501557586628, 44.195384772746905, 43.75184386085779, 49.9547802590397, 4.924016899696804, 14.625174551006166, 63.43950419807275, 57.639723572765135, 42.16390755743498, 42.960797890684695, 8.14811870236166, 30.392176373439725, 20.071009569500877, 22.148313802584326, 58.21374250099597, 56.69540883790176, 45.64682139316028, 61.42756746574508, 28.46468440504334, 24.854338085356137, 63.457149461861505, 96.44765009192285, 79.11287382744744, 86.38134247756204, 53.175846958943026, 50.43786394003693, 36.344417993343065, 51.32486606383527, 77.153621031266, 30.18225860181146, 20.233258513163467, 14.770322141132361, 69.24089901085154, 59.19375796300465, 79.35575875840739, 50.304575376314666, 89.57922139164715, 43.40370294704024, 82.85614931674228, 78.87338925016438, 47.706539849035906, 53.34148173757432, 15.24637340354291, 17.375097747173257, 14.395168256387443, 12.812148789084599, 54.459867531300524, 32.50938671633625, 20.98021559340619, 19.685486155315523, 16.7916660111153, 23.609038201545776, 66.67766584253536, 24.65633487839831, 8.066014928197488, 11.17341896664671, 23.468170815573632, 49.953757014601095, 17.405312195074583, 18.709996633896615, 13.63828006276223, 65.14087606839641, 46.506596677714725, 61.36347005690707, 42.60016988697336, 37.58403355487828, 18.76258451111179, 2.8201723891396733, 20.98973843955507, 26.54469673085553, 41.97196836622752, 48.14373022747421, 9.647614766298924, 10.859712051251483, 8.718920007136965, 38.46632658791967, 14.435092473804275, 2.024476209065791, 32.4408912468122, 33.19518270026536, 26.49635422355877, 17.49465897006941, 68.85776206038341, 23.30595363706783, 34.82341807346384, 17.596413220108392, 30.141938431425867, 25.13859816682796, 43.60231984964352, 18.08724224767131, 35.64713584712221, 11.801801435806665, 5.918027646069083, 21.208667302110268, 3.7422752630981924, 12.3860190767064, 40.817136605662284, 18.61061030923812, 29.64314356253534, 44.253178614897884, 32.74007193002768, 27.932109607441042, 74.58557037892118, 72.67489576335112, 50.68333137491503, 12.088732245046433, 5.182514868364668, 4.913408926976906, 35.12173169976878, 19.482585921052724, 13.659575195667275, 7.72014350539381, 46.040753430091655, 40.45389260321634, 26.65429359378151, 6.977063946539935, 16.165021419082063, 7.235554137099694, 2.7681070997511266, 9.822391668679801, 14.572070306204031, 19.969313472167535, 5.666975366537241, 67.2393327694136, 7.508630606647381, 7.128491042107062, 3.3198858377553697, 6.124111193267788, 33.33547845838886, 33.955508904133275, 43.54708125897291, 56.7750847922904, 24.77187640729033, 19.098658129806356, 0.0, 3.478093132277619, 12.694098552292004, 13.345562262199142, 18.1605123874788, 14.192007957959937, 24.460547355201438, 26.247026400219717, 8.3261569003881, 67.05593792662496, 2.466045761957302, 3.5304921709100685, 62.60117508889521, 8.937139588393851, 3.437522374073596, 2.2862190445045374, 1.1123801747239828, 32.983544693503404, 66.98456112943077, 57.66668094776678, 21.218773165649036, 9.636184927135622, 66.47323084883381, 25.892553567214065, 9.395121061982307, 7.607352973730139, 1.7018656757426716, 11.653608280029415, 40.10846649772115, 39.50591521361756, 8.684479328972596, 4.831056053127841, 14.538386160271918, 14.540039067476378, 6.918627787849913, 6.974453403752236, 13.881343825740316, 6.174633361480828, 90.3308997314136, 3.485255697892934, 8.874962675529991, 34.122355242484, 29.997548746469437, 21.707305686949752, 6.704205422774993, 6.5941523868833976, 0.9155312742710848, 8.41911197229862, 3.3679771132179583, 16.869323165187307, 43.684422962111135, 20.337301639779103, 12.056595891111321, 8.08196083879411, 33.979568949252716, 0.9946411823248879, 13.944749087336497, 11.581624727544432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6043190553183052, "mean_inference_ms": 1.8547592944679823, "mean_action_processing_ms": 0.2606411326185689, "mean_env_wait_ms": 0.2274531086220114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008330702781677246, "StateBufferConnector_ms": 0.003595590591430664, "ViewRequirementAgentConnector_ms": 0.11569690704345703}, "num_episodes": 22, "episode_return_max": 420.7164179536111, "episode_return_min": 265.7952059516291, "episode_return_mean": 378.11972722700733, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.02479872532126, "num_env_steps_trained_throughput_per_sec": 292.02479872532126, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 11746.362, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11746.313, "sample_time_ms": 1541.598, "learn_time_ms": 10187.27, "learn_throughput": 392.647, "synch_weights_time_ms": 15.096}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "e552a_00000", "date": "2024-08-16_08-53-03", "timestamp": 1723778583, "time_this_iter_s": 13.731551885604858, "time_total_s": 393.29731035232544, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 393.29731035232544, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 60.38947368421053, "ram_util_percent": 83.5421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.560288682059636, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.943018296029833, "policy_loss": -0.007153011194218403, "vf_loss": 4.948075957525344, "vf_explained_var": 0.3961238287113331, "kl": 0.006208463686268005, "entropy": 1.255441180423454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.992980767305566, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.05474594888233, "policy_loss": -0.0015815666829920793, "vf_loss": 6.055586287836549, "vf_explained_var": 0.09505289575410268, "kl": 0.004941551491234821, "entropy": 1.4482694065760053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 418.5726732553133, "episode_reward_min": 265.7952059516291, "episode_reward_mean": 370.60784253836084, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 24.379521843638265, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 160.5596343387817}, "policy_reward_mean": {"prey_policy": 155.82767295686386, "predator_policy": 29.47624831231657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.8428605521435, 355.42186070801137, 391.692920826982, 398.2531289666347, 355.25151802619826, 390.08645783692197, 346.2887302517118, 375.3021321845633, 363.78366186693836, 396.1370906134502, 385.1324203696063, 328.9006121054578, 405.7430273374516, 397.7733640079741, 367.56335504581, 389.15016803267633, 382.75747011273586, 373.4085183925257, 373.2566560793496, 387.03611731871547, 383.8712114199987, 397.69306912466914, 351.9520634961358, 387.6899038134764, 349.3294270916905, 402.1414431793724, 375.44131201923244, 387.42151991618323, 374.03598720581573, 390.78199783455943, 387.937667652021, 361.79828283554855, 385.9484935211299, 353.73876966630326, 363.03256029678107, 400.15021924672, 393.3105149392246, 412.48983980750666, 352.45189520275704, 381.5592331668219, 364.97005153728327, 393.4222017590381, 314.9719719991871, 370.23611777773743, 387.18367172432494, 395.405440486221, 418.5726732553133, 351.78369561878026, 367.87269978555696, 399.0785796585087, 401.4530704119237, 373.552076494624, 356.76664981570923, 394.06, 356.5681838587414, 346.53999999999996, 334.5376209240121, 341.1243536589449, 384.91591421418485, 362.62325562198953, 398.7174815314952, 383.52682185059905, 385.8204493731117, 377.4124477680644, 379.1161054397937, 389.88982223836246, 340.72354739110324, 265.7952059516291, 345.06048290046095, 392.86757056109843, 392.86747597723485, 337.5963857617526, 368.5072554190889, 360.31493871315587, 399.9253590129137, 304.51794890466476, 390.40797648633486, 349.3954999880438, 350.8452117485516, 346.52426154102733, 363.4119948271446, 393.01071773018344, 318.07487026623585, 387.1717576351217, 313.7422087998375, 361.3952571672411, 316.8318213786973, 291.12278290910496, 356.59842155499877, 373.88028764999586, 387.2279048973742, 403.1454189647567, 346.3857135342389, 369.734344218451, 339.81135282009024, 392.9960832104292, 394.56254408729006, 397.4337923683054, 364.30282196951146, 382.9161986147036], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [91.18484272459541, 122.92847926064162, 149.92858940323669, 104.44524971816455, 186.87504213919573, 172.1964075370702, 186.80938224288832, 184.23642967827445, 132.55529502022176, 135.72696875833978, 167.25015140755715, 182.170604680643, 153.75058165246554, 152.13744438658563, 142.8381773776365, 141.12995408599312, 163.57690417773318, 180.96732379436094, 160.54716692735744, 162.1679958559179, 166.75693204341138, 182.26017949722353, 101.39867679515477, 148.72277917914434, 120.61955507118381, 177.25340553164605, 169.99448911642293, 147.5946714496998, 169.28687015194953, 176.69372799360903, 158.17203211312147, 183.4437007491441, 135.22033676818046, 157.42143475085385, 182.22672841745387, 170.67446315752153, 159.86453831021717, 166.2068711740758, 180.64663152138456, 189.9299171144609, 180.91826689519576, 137.3168705777253, 192.3345594699189, 161.36749646112213, 147.28964140237107, 112.49870639631324, 176.1522457700652, 159.11782674983908, 125.80224618356459, 168.24664430987212, 182.4809689383821, 157.97091214367552, 161.20023762757782, 166.7921371087257, 172.83483783022777, 187.45998713777595, 190.36435143565646, 167.54334143035467, 183.529860376645, 147.82439054301406, 178.623786537348, 135.41755893723962, 150.6586101083792, 150.4674911897007, 164.52112755008937, 74.16689982876827, 126.1068826458531, 164.85982340048858, 173.9295606109735, 179.007075890466, 190.01060256553336, 155.53529906036513, 191.77982925297684, 180.15096698518667, 135.81134491021513, 190.18384886398357, 183.41744854648664, 135.40308911594911, 181.13700261030473, 177.0216550003355, 162.38, 189.99955276885234, 158.88081798066654, 200.0, 124.21011179290115, 117.85555207033508, 159.70321444663594, 195.89578168234704, 191.08420531634297, 186.65546937695882, 162.18410865817518, 165.93034446552355, 143.57543644842087, 174.6750707556291, 165.06759137889685, 142.8455697027867, 199.09260951315957, 165.3019971401198, 174.82199120427094, 198.21692763974664, 169.10055006648497, 200.0, 151.39904391801502, 171.4454588211878, 113.07393316418165, 168.3106218245143, 193.21875830653585, 194.84470376059681, 145.6400567775122, 139.38981240394034, 153.47000000000003, 187.34625858142186, 189.02369656089954, 111.41799949488531, 125.3750261307118, 91.0980854510358, 179.86358440850162, 174.19737171289853, 133.59673687849693, 136.66073432744497, 191.40049809275482, 190.31450940302796, 186.48345061053578, 183.6878972842912, 155.7916546529013, 150.41441300887212, 178.4155603602954, 185.48135202566857, 172.37308995897638, 177.66459025306904, 191.199679520193, 184.79706152656732, 175.11757020388217, 145.55, 24.963605532322802, 147.01544498999982, 126.09358172846983, 175.96958325397722, 163.16607816287862, 177.99663796480053, 190.5555253380605, 189.01359282951594, 141.89900365670192, 186.3627388584809, 168.00100109861472, 180.26895404206888, 156.82063325841386, 139.4725808528516, 189.33189267335177, 190.45490960965648, 146.67115261632946, 122.87258615675826, 199.7825605741072, 165.09904209734665, 50.36196869949313, 92.23121275255171, 89.67931046051392, 76.85033973708349, 65.40826309694094, 126.71717947496536, 173.75855976341373, 171.0097901195308, 173.80890922235426, 193.6750386649894, 139.9535057303302, 88.16695459630786, 165.55036050061776, 179.67660162333755, 63.37581841191194, 94.61060554851882, 164.16506618857855, 150.60877484303518, 103.13307822099412, 82.34796870022622, 141.65758829626387, 44.08124317640414, 101.26386304672442, 114.09131469890623, 163.3308532377078, 172.13695671064474, 121.41247406406491, 24.379521843638265, 197.0828148314869, 167.04100677258907, 111.4097326734211, 103.31931784177864, 161.0361181225903, 140.80111552030974, 135.7159675424289, 124.03937212819707, 159.75907834637638, 188.56289361192637, 178.02812094667112, 184.49504508416928, 182.2856521037995, 192.27450776386073, 167.94031644795646, 140.42267205087842, 170.362317067252, 161.09783982685138], "policy_predator_policy_reward": [82.85614931674228, 78.87338925016438, 47.706539849035906, 53.34148173757432, 15.24637340354291, 17.375097747173257, 14.395168256387443, 12.812148789084599, 54.459867531300524, 32.50938671633625, 20.98021559340619, 19.685486155315523, 16.7916660111153, 23.609038201545776, 66.67766584253536, 24.65633487839831, 8.066014928197488, 11.17341896664671, 23.468170815573632, 49.953757014601095, 17.405312195074583, 18.709996633896615, 13.63828006276223, 65.14087606839641, 46.506596677714725, 61.36347005690707, 42.60016988697336, 37.58403355487828, 18.76258451111179, 2.8201723891396733, 20.98973843955507, 26.54469673085553, 41.97196836622752, 48.14373022747421, 9.647614766298924, 10.859712051251483, 8.718920007136965, 38.46632658791967, 14.435092473804275, 2.024476209065791, 32.4408912468122, 33.19518270026536, 26.49635422355877, 17.49465897006941, 68.85776206038341, 23.30595363706783, 34.82341807346384, 17.596413220108392, 30.141938431425867, 25.13859816682796, 43.60231984964352, 18.08724224767131, 35.64713584712221, 11.801801435806665, 5.918027646069083, 21.208667302110268, 3.7422752630981924, 12.3860190767064, 40.817136605662284, 18.61061030923812, 29.64314356253534, 44.253178614897884, 32.74007193002768, 27.932109607441042, 74.58557037892118, 72.67489576335112, 50.68333137491503, 12.088732245046433, 5.182514868364668, 4.913408926976906, 35.12173169976878, 19.482585921052724, 13.659575195667275, 7.72014350539381, 46.040753430091655, 40.45389260321634, 26.65429359378151, 6.977063946539935, 16.165021419082063, 7.235554137099694, 2.7681070997511266, 9.822391668679801, 14.572070306204031, 19.969313472167535, 5.666975366537241, 67.2393327694136, 7.508630606647381, 7.128491042107062, 3.3198858377553697, 6.124111193267788, 33.33547845838886, 33.955508904133275, 43.54708125897291, 56.7750847922904, 24.77187640729033, 19.098658129806356, 0.0, 3.478093132277619, 12.694098552292004, 13.345562262199142, 18.1605123874788, 14.192007957959937, 24.460547355201438, 26.247026400219717, 8.3261569003881, 67.05593792662496, 2.466045761957302, 3.5304921709100685, 62.60117508889521, 8.937139588393851, 3.437522374073596, 2.2862190445045374, 1.1123801747239828, 32.983544693503404, 66.98456112943077, 57.66668094776678, 21.218773165649036, 9.636184927135622, 66.47323084883381, 25.892553567214065, 9.395121061982307, 7.607352973730139, 1.7018656757426716, 11.653608280029415, 40.10846649772115, 39.50591521361756, 8.684479328972596, 4.831056053127841, 14.538386160271918, 14.540039067476378, 6.918627787849913, 6.974453403752236, 13.881343825740316, 6.174633361480828, 90.3308997314136, 3.485255697892934, 8.874962675529991, 34.122355242484, 29.997548746469437, 21.707305686949752, 6.704205422774993, 6.5941523868833976, 0.9155312742710848, 8.41911197229862, 3.3679771132179583, 16.869323165187307, 43.684422962111135, 20.337301639779103, 12.056595891111321, 8.08196083879411, 33.979568949252716, 0.9946411823248879, 13.944749087336497, 11.581624727544432, 112.16013221455141, 94.64218632144782, 160.5596343387817, 23.75592721217246, 61.27498500801386, 93.12383396110742, 8.923668945984842, 9.719975998215237, 11.68023086849469, 13.846538974345139, 6.530170299951347, 83.42423963964637, 12.518080371048786, 29.42671514011758, 72.68320920646266, 83.07257563294404, 19.185438356436403, 27.435977779190974, 90.93772609939917, 40.41304835807803, 1.5140646834450295, 103.86988675299173, 77.56391462981904, 63.67932917954895, 26.856879158085043, 11.555598543558153, 146.4494626613656, 94.9864463283054, 12.721184775416614, 26.30041258526426, 120.85068163572754, 10.805981383311753, 39.184688842916174, 28.712421732634823, 20.207107857505154, 59.84890529195903, 27.40747722490972, 17.266634027216753, 23.038808377404568, 9.00056967904485, 14.880622681472353, 7.993009819172984, 21.85369426153491, 34.08613920914139, 36.72806783534463, 14.727973885255405]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6115838625738075, "mean_inference_ms": 1.879570735463787, "mean_action_processing_ms": 0.2626871171364573, "mean_env_wait_ms": 0.22998345036908077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005301952362060547, "StateBufferConnector_ms": 0.005176424980163574, "ViewRequirementAgentConnector_ms": 0.12349307537078857}, "num_episodes": 23, "episode_return_max": 418.5726732553133, "episode_return_min": 265.7952059516291, "episode_return_mean": 370.60784253836084, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9520864583249, "num_env_steps_trained_throughput_per_sec": 292.9520864583249, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 12083.75, "restore_workers_time_ms": 0.017, "training_step_time_ms": 12083.702, "sample_time_ms": 1738.297, "learn_time_ms": 10327.339, "learn_throughput": 387.321, "synch_weights_time_ms": 15.446}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "e552a_00000", "date": "2024-08-16_08-53-17", "timestamp": 1723778597, "time_this_iter_s": 13.6822509765625, "time_total_s": 406.97956132888794, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 406.97956132888794, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 49.184999999999995, "ram_util_percent": 83.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.169260565818302, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.563023784173229, "policy_loss": -0.007230419231696971, "vf_loss": 5.5679598195212225, "vf_explained_var": 0.2967140450679436, "kl": 0.00679811467927235, "entropy": 1.2408524880333551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1354943464042018, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.807176388129986, "policy_loss": -0.005084198950321744, "vf_loss": 6.811610858654849, "vf_explained_var": 0.04926800954909552, "kl": 0.00866318228686096, "entropy": 1.432080809527604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 418.5726732553133, "episode_reward_min": 265.7952059516291, "episode_reward_mean": 368.4752579739678, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 13.599268427237805, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 205.44742862420145}, "policy_reward_mean": {"prey_policy": 150.51623249464336, "predator_policy": 33.72139649234054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.2566560793496, 387.03611731871547, 383.8712114199987, 397.69306912466914, 351.9520634961358, 387.6899038134764, 349.3294270916905, 402.1414431793724, 375.44131201923244, 387.42151991618323, 374.03598720581573, 390.78199783455943, 387.937667652021, 361.79828283554855, 385.9484935211299, 353.73876966630326, 363.03256029678107, 400.15021924672, 393.3105149392246, 412.48983980750666, 352.45189520275704, 381.5592331668219, 364.97005153728327, 393.4222017590381, 314.9719719991871, 370.23611777773743, 387.18367172432494, 395.405440486221, 418.5726732553133, 351.78369561878026, 367.87269978555696, 399.0785796585087, 401.4530704119237, 373.552076494624, 356.76664981570923, 394.06, 356.5681838587414, 346.53999999999996, 334.5376209240121, 341.1243536589449, 384.91591421418485, 362.62325562198953, 398.7174815314952, 383.52682185059905, 385.8204493731117, 377.4124477680644, 379.1161054397937, 389.88982223836246, 340.72354739110324, 265.7952059516291, 345.06048290046095, 392.86757056109843, 392.86747597723485, 337.5963857617526, 368.5072554190889, 360.31493871315587, 399.9253590129137, 304.51794890466476, 390.40797648633486, 349.3954999880438, 350.8452117485516, 346.52426154102733, 363.4119948271446, 393.01071773018344, 318.07487026623585, 387.1717576351217, 313.7422087998375, 361.3952571672411, 316.8318213786973, 291.12278290910496, 356.59842155499877, 373.88028764999586, 387.2279048973742, 403.1454189647567, 346.3857135342389, 369.734344218451, 339.81135282009024, 392.9960832104292, 394.56254408729006, 397.4337923683054, 364.30282196951146, 382.9161986147036, 324.7112969658192, 371.88750608792685, 301.89653444915535, 388.6432505784988, 377.8035618768215, 326.7961015174341, 386.1559226878178, 383.9019883559039, 400.100909670918, 371.7224690597294, 362.79271827261874, 322.46888060218646, 400.86450219186816, 340.31885428985044, 365.21991693498006, 352.0366662514753, 387.0312376637114, 400.87852334177404], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [159.86453831021717, 166.2068711740758, 180.64663152138456, 189.9299171144609, 180.91826689519576, 137.3168705777253, 192.3345594699189, 161.36749646112213, 147.28964140237107, 112.49870639631324, 176.1522457700652, 159.11782674983908, 125.80224618356459, 168.24664430987212, 182.4809689383821, 157.97091214367552, 161.20023762757782, 166.7921371087257, 172.83483783022777, 187.45998713777595, 190.36435143565646, 167.54334143035467, 183.529860376645, 147.82439054301406, 178.623786537348, 135.41755893723962, 150.6586101083792, 150.4674911897007, 164.52112755008937, 74.16689982876827, 126.1068826458531, 164.85982340048858, 173.9295606109735, 179.007075890466, 190.01060256553336, 155.53529906036513, 191.77982925297684, 180.15096698518667, 135.81134491021513, 190.18384886398357, 183.41744854648664, 135.40308911594911, 181.13700261030473, 177.0216550003355, 162.38, 189.99955276885234, 158.88081798066654, 200.0, 124.21011179290115, 117.85555207033508, 159.70321444663594, 195.89578168234704, 191.08420531634297, 186.65546937695882, 162.18410865817518, 165.93034446552355, 143.57543644842087, 174.6750707556291, 165.06759137889685, 142.8455697027867, 199.09260951315957, 165.3019971401198, 174.82199120427094, 198.21692763974664, 169.10055006648497, 200.0, 151.39904391801502, 171.4454588211878, 113.07393316418165, 168.3106218245143, 193.21875830653585, 194.84470376059681, 145.6400567775122, 139.38981240394034, 153.47000000000003, 187.34625858142186, 189.02369656089954, 111.41799949488531, 125.3750261307118, 91.0980854510358, 179.86358440850162, 174.19737171289853, 133.59673687849693, 136.66073432744497, 191.40049809275482, 190.31450940302796, 186.48345061053578, 183.6878972842912, 155.7916546529013, 150.41441300887212, 178.4155603602954, 185.48135202566857, 172.37308995897638, 177.66459025306904, 191.199679520193, 184.79706152656732, 175.11757020388217, 145.55, 24.963605532322802, 147.01544498999982, 126.09358172846983, 175.96958325397722, 163.16607816287862, 177.99663796480053, 190.5555253380605, 189.01359282951594, 141.89900365670192, 186.3627388584809, 168.00100109861472, 180.26895404206888, 156.82063325841386, 139.4725808528516, 189.33189267335177, 190.45490960965648, 146.67115261632946, 122.87258615675826, 199.7825605741072, 165.09904209734665, 50.36196869949313, 92.23121275255171, 89.67931046051392, 76.85033973708349, 65.40826309694094, 126.71717947496536, 173.75855976341373, 171.0097901195308, 173.80890922235426, 193.6750386649894, 139.9535057303302, 88.16695459630786, 165.55036050061776, 179.67660162333755, 63.37581841191194, 94.61060554851882, 164.16506618857855, 150.60877484303518, 103.13307822099412, 82.34796870022622, 141.65758829626387, 44.08124317640414, 101.26386304672442, 114.09131469890623, 163.3308532377078, 172.13695671064474, 121.41247406406491, 24.379521843638265, 197.0828148314869, 167.04100677258907, 111.4097326734211, 103.31931784177864, 161.0361181225903, 140.80111552030974, 135.7159675424289, 124.03937212819707, 159.75907834637638, 188.56289361192637, 178.02812094667112, 184.49504508416928, 182.2856521037995, 192.27450776386073, 167.94031644795646, 140.42267205087842, 170.362317067252, 161.09783982685138, 20.52282384783404, 67.05533139670868, 162.0210860421338, 151.21396979227018, 66.94005232962726, 13.599268427237805, 181.67083787142104, 158.9796135510979, 150.76398279380555, 156.12580971431063, 72.91310008743396, 82.92478101265243, 183.70026042303454, 183.90806503913277, 176.90223290363372, 179.11063797290763, 179.3585428922862, 171.06540208868498, 22.21179307444655, 60.325354702717775, 168.0067800260287, 144.78371013351818, 94.24746927360029, 28.91798227363431, 192.19407654620352, 180.09181826737324, 39.64922994843767, 81.16782218651572, 125.66231770171956, 149.12586693799014, 119.93986198307915, 87.72395248801911, 177.21183754442967, 188.5440057101226, 151.91597208923122, 188.3792320972204], "policy_predator_policy_reward": [8.718920007136965, 38.46632658791967, 14.435092473804275, 2.024476209065791, 32.4408912468122, 33.19518270026536, 26.49635422355877, 17.49465897006941, 68.85776206038341, 23.30595363706783, 34.82341807346384, 17.596413220108392, 30.141938431425867, 25.13859816682796, 43.60231984964352, 18.08724224767131, 35.64713584712221, 11.801801435806665, 5.918027646069083, 21.208667302110268, 3.7422752630981924, 12.3860190767064, 40.817136605662284, 18.61061030923812, 29.64314356253534, 44.253178614897884, 32.74007193002768, 27.932109607441042, 74.58557037892118, 72.67489576335112, 50.68333137491503, 12.088732245046433, 5.182514868364668, 4.913408926976906, 35.12173169976878, 19.482585921052724, 13.659575195667275, 7.72014350539381, 46.040753430091655, 40.45389260321634, 26.65429359378151, 6.977063946539935, 16.165021419082063, 7.235554137099694, 2.7681070997511266, 9.822391668679801, 14.572070306204031, 19.969313472167535, 5.666975366537241, 67.2393327694136, 7.508630606647381, 7.128491042107062, 3.3198858377553697, 6.124111193267788, 33.33547845838886, 33.955508904133275, 43.54708125897291, 56.7750847922904, 24.77187640729033, 19.098658129806356, 0.0, 3.478093132277619, 12.694098552292004, 13.345562262199142, 18.1605123874788, 14.192007957959937, 24.460547355201438, 26.247026400219717, 8.3261569003881, 67.05593792662496, 2.466045761957302, 3.5304921709100685, 62.60117508889521, 8.937139588393851, 3.437522374073596, 2.2862190445045374, 1.1123801747239828, 32.983544693503404, 66.98456112943077, 57.66668094776678, 21.218773165649036, 9.636184927135622, 66.47323084883381, 25.892553567214065, 9.395121061982307, 7.607352973730139, 1.7018656757426716, 11.653608280029415, 40.10846649772115, 39.50591521361756, 8.684479328972596, 4.831056053127841, 14.538386160271918, 14.540039067476378, 6.918627787849913, 6.974453403752236, 13.881343825740316, 6.174633361480828, 90.3308997314136, 3.485255697892934, 8.874962675529991, 34.122355242484, 29.997548746469437, 21.707305686949752, 6.704205422774993, 6.5941523868833976, 0.9155312742710848, 8.41911197229862, 3.3679771132179583, 16.869323165187307, 43.684422962111135, 20.337301639779103, 12.056595891111321, 8.08196083879411, 33.979568949252716, 0.9946411823248879, 13.944749087336497, 11.581624727544432, 112.16013221455141, 94.64218632144782, 160.5596343387817, 23.75592721217246, 61.27498500801386, 93.12383396110742, 8.923668945984842, 9.719975998215237, 11.68023086849469, 13.846538974345139, 6.530170299951347, 83.42423963964637, 12.518080371048786, 29.42671514011758, 72.68320920646266, 83.07257563294404, 19.185438356436403, 27.435977779190974, 90.93772609939917, 40.41304835807803, 1.5140646834450295, 103.86988675299173, 77.56391462981904, 63.67932917954895, 26.856879158085043, 11.555598543558153, 146.4494626613656, 94.9864463283054, 12.721184775416614, 26.30041258526426, 120.85068163572754, 10.805981383311753, 39.184688842916174, 28.712421732634823, 20.207107857505154, 59.84890529195903, 27.40747722490972, 17.266634027216753, 23.038808377404568, 9.00056967904485, 14.880622681472353, 7.993009819172984, 21.85369426153491, 34.08613920914139, 36.72806783534463, 14.727973885255405, 45.13515385312954, 191.99798786814608, 9.850337131787839, 48.80211312173564, 205.44742862420145, 15.909785068088443, 39.99134492880651, 8.001454227173507, 5.8516696710577545, 65.06209969764761, 20.121213751280628, 150.8370066660671, 3.895509006000407, 14.652088219650071, 19.08580214611555, 8.803315333246925, 27.7919599853181, 21.885004704628685, 145.62938667966196, 143.55593460290333, 16.231217358334803, 33.771010754736984, 58.744773580801926, 140.55865547414982, 8.689654782429145, 19.88895259586221, 113.45423418601113, 106.04756796888596, 16.52260613638546, 73.90912615888458, 123.24133748808131, 21.131514292295844, 5.168900757457598, 16.10649365170152, 21.642806906926097, 38.9405122483958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6169035713571773, "mean_inference_ms": 1.9003634197117745, "mean_action_processing_ms": 0.26431350291047423, "mean_env_wait_ms": 0.23212387152482822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005311489105224609, "StateBufferConnector_ms": 0.005128264427185059, "ViewRequirementAgentConnector_ms": 0.12242019176483154}, "num_episodes": 18, "episode_return_max": 418.5726732553133, "episode_return_min": 265.7952059516291, "episode_return_mean": 368.4752579739678, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.9593602687119, "num_env_steps_trained_throughput_per_sec": 360.9593602687119, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 12106.244, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12106.199, "sample_time_ms": 1740.801, "learn_time_ms": 10346.814, "learn_throughput": 386.592, "synch_weights_time_ms": 15.794}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "e552a_00000", "date": "2024-08-16_08-53-28", "timestamp": 1723778608, "time_this_iter_s": 11.138070821762085, "time_total_s": 418.11763215065, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 418.11763215065, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.64375, "ram_util_percent": 82.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.598350175663277, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0526920255529815, "policy_loss": -0.00763335574477438, "vf_loss": 7.05825040176432, "vf_explained_var": 0.26799416441135304, "kl": 0.006148081357101563, "entropy": 1.209647930614532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9961982417358923, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.915366833046, "policy_loss": -0.008749421901641187, "vf_loss": 7.922733981268746, "vf_explained_var": 0.013307013902714644, "kl": 0.018430323901851443, "entropy": 1.4399057812791654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 418.5726732553133, "episode_reward_min": 265.7952059516291, "episode_reward_mean": 366.458614161723, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4.947901034510768, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 222.49423247319106}, "policy_reward_mean": {"prey_policy": 141.5499125470138, "predator_policy": 41.67939453384772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.3105149392246, 412.48983980750666, 352.45189520275704, 381.5592331668219, 364.97005153728327, 393.4222017590381, 314.9719719991871, 370.23611777773743, 387.18367172432494, 395.405440486221, 418.5726732553133, 351.78369561878026, 367.87269978555696, 399.0785796585087, 401.4530704119237, 373.552076494624, 356.76664981570923, 394.06, 356.5681838587414, 346.53999999999996, 334.5376209240121, 341.1243536589449, 384.91591421418485, 362.62325562198953, 398.7174815314952, 383.52682185059905, 385.8204493731117, 377.4124477680644, 379.1161054397937, 389.88982223836246, 340.72354739110324, 265.7952059516291, 345.06048290046095, 392.86757056109843, 392.86747597723485, 337.5963857617526, 368.5072554190889, 360.31493871315587, 399.9253590129137, 304.51794890466476, 390.40797648633486, 349.3954999880438, 350.8452117485516, 346.52426154102733, 363.4119948271446, 393.01071773018344, 318.07487026623585, 387.1717576351217, 313.7422087998375, 361.3952571672411, 316.8318213786973, 291.12278290910496, 356.59842155499877, 373.88028764999586, 387.2279048973742, 403.1454189647567, 346.3857135342389, 369.734344218451, 339.81135282009024, 392.9960832104292, 394.56254408729006, 397.4337923683054, 364.30282196951146, 382.9161986147036, 324.7112969658192, 371.88750608792685, 301.89653444915535, 388.6432505784988, 377.8035618768215, 326.7961015174341, 386.1559226878178, 383.9019883559039, 400.100909670918, 371.7224690597294, 362.79271827261874, 322.46888060218646, 400.86450219186816, 340.31885428985044, 365.21991693498006, 352.0366662514753, 387.0312376637114, 400.87852334177404, 367.0047261526466, 331.3515644712532, 390.6633360538942, 339.30010420874675, 390.11968159785613, 382.29735868258035, 359.23027367094073, 378.98878399828726, 346.6893248090003, 391.11566800996627, 386.0352535224013, 404.16856821837456, 387.53525637706787, 307.7489595370788, 399.3990873927103, 323.3891082254453, 334.10418310397154, 392.45108246100045], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.77982925297684, 180.15096698518667, 135.81134491021513, 190.18384886398357, 183.41744854648664, 135.40308911594911, 181.13700261030473, 177.0216550003355, 162.38, 189.99955276885234, 158.88081798066654, 200.0, 124.21011179290115, 117.85555207033508, 159.70321444663594, 195.89578168234704, 191.08420531634297, 186.65546937695882, 162.18410865817518, 165.93034446552355, 143.57543644842087, 174.6750707556291, 165.06759137889685, 142.8455697027867, 199.09260951315957, 165.3019971401198, 174.82199120427094, 198.21692763974664, 169.10055006648497, 200.0, 151.39904391801502, 171.4454588211878, 113.07393316418165, 168.3106218245143, 193.21875830653585, 194.84470376059681, 145.6400567775122, 139.38981240394034, 153.47000000000003, 187.34625858142186, 189.02369656089954, 111.41799949488531, 125.3750261307118, 91.0980854510358, 179.86358440850162, 174.19737171289853, 133.59673687849693, 136.66073432744497, 191.40049809275482, 190.31450940302796, 186.48345061053578, 183.6878972842912, 155.7916546529013, 150.41441300887212, 178.4155603602954, 185.48135202566857, 172.37308995897638, 177.66459025306904, 191.199679520193, 184.79706152656732, 175.11757020388217, 145.55, 24.963605532322802, 147.01544498999982, 126.09358172846983, 175.96958325397722, 163.16607816287862, 177.99663796480053, 190.5555253380605, 189.01359282951594, 141.89900365670192, 186.3627388584809, 168.00100109861472, 180.26895404206888, 156.82063325841386, 139.4725808528516, 189.33189267335177, 190.45490960965648, 146.67115261632946, 122.87258615675826, 199.7825605741072, 165.09904209734665, 50.36196869949313, 92.23121275255171, 89.67931046051392, 76.85033973708349, 65.40826309694094, 126.71717947496536, 173.75855976341373, 171.0097901195308, 173.80890922235426, 193.6750386649894, 139.9535057303302, 88.16695459630786, 165.55036050061776, 179.67660162333755, 63.37581841191194, 94.61060554851882, 164.16506618857855, 150.60877484303518, 103.13307822099412, 82.34796870022622, 141.65758829626387, 44.08124317640414, 101.26386304672442, 114.09131469890623, 163.3308532377078, 172.13695671064474, 121.41247406406491, 24.379521843638265, 197.0828148314869, 167.04100677258907, 111.4097326734211, 103.31931784177864, 161.0361181225903, 140.80111552030974, 135.7159675424289, 124.03937212819707, 159.75907834637638, 188.56289361192637, 178.02812094667112, 184.49504508416928, 182.2856521037995, 192.27450776386073, 167.94031644795646, 140.42267205087842, 170.362317067252, 161.09783982685138, 20.52282384783404, 67.05533139670868, 162.0210860421338, 151.21396979227018, 66.94005232962726, 13.599268427237805, 181.67083787142104, 158.9796135510979, 150.76398279380555, 156.12580971431063, 72.91310008743396, 82.92478101265243, 183.70026042303454, 183.90806503913277, 176.90223290363372, 179.11063797290763, 179.3585428922862, 171.06540208868498, 22.21179307444655, 60.325354702717775, 168.0067800260287, 144.78371013351818, 94.24746927360029, 28.91798227363431, 192.19407654620352, 180.09181826737324, 39.64922994843767, 81.16782218651572, 125.66231770171956, 149.12586693799014, 119.93986198307915, 87.72395248801911, 177.21183754442967, 188.5440057101226, 151.91597208923122, 188.3792320972204, 113.09108087675739, 137.01805468433957, 96.66824774192295, 97.66789406953811, 192.57866943624845, 162.634329178314, 72.72862801867352, 59.60572960182031, 150.42225001952485, 160.38909195686344, 144.30741270916937, 150.2647694840827, 118.28413779647005, 43.08420818334101, 72.83778208286058, -3.501878856304004, 4.411311361976795, 72.74816186150788, 53.217563370610975, 63.56930007953571, 167.27753700410284, 154.5997991164369, 169.33937601520532, 181.85756672978184, 162.96967460316523, 170.71359700789228, 30.98763036459028, -4.947901034510768, 98.37241926968207, 73.03295115219446, 155.48532315537236, 123.82328302866722, 99.9689557442279, 107.30711577999823, 179.33006459006344, 193.59007952332627], "policy_predator_policy_reward": [13.659575195667275, 7.72014350539381, 46.040753430091655, 40.45389260321634, 26.65429359378151, 6.977063946539935, 16.165021419082063, 7.235554137099694, 2.7681070997511266, 9.822391668679801, 14.572070306204031, 19.969313472167535, 5.666975366537241, 67.2393327694136, 7.508630606647381, 7.128491042107062, 3.3198858377553697, 6.124111193267788, 33.33547845838886, 33.955508904133275, 43.54708125897291, 56.7750847922904, 24.77187640729033, 19.098658129806356, 0.0, 3.478093132277619, 12.694098552292004, 13.345562262199142, 18.1605123874788, 14.192007957959937, 24.460547355201438, 26.247026400219717, 8.3261569003881, 67.05593792662496, 2.466045761957302, 3.5304921709100685, 62.60117508889521, 8.937139588393851, 3.437522374073596, 2.2862190445045374, 1.1123801747239828, 32.983544693503404, 66.98456112943077, 57.66668094776678, 21.218773165649036, 9.636184927135622, 66.47323084883381, 25.892553567214065, 9.395121061982307, 7.607352973730139, 1.7018656757426716, 11.653608280029415, 40.10846649772115, 39.50591521361756, 8.684479328972596, 4.831056053127841, 14.538386160271918, 14.540039067476378, 6.918627787849913, 6.974453403752236, 13.881343825740316, 6.174633361480828, 90.3308997314136, 3.485255697892934, 8.874962675529991, 34.122355242484, 29.997548746469437, 21.707305686949752, 6.704205422774993, 6.5941523868833976, 0.9155312742710848, 8.41911197229862, 3.3679771132179583, 16.869323165187307, 43.684422962111135, 20.337301639779103, 12.056595891111321, 8.08196083879411, 33.979568949252716, 0.9946411823248879, 13.944749087336497, 11.581624727544432, 112.16013221455141, 94.64218632144782, 160.5596343387817, 23.75592721217246, 61.27498500801386, 93.12383396110742, 8.923668945984842, 9.719975998215237, 11.68023086849469, 13.846538974345139, 6.530170299951347, 83.42423963964637, 12.518080371048786, 29.42671514011758, 72.68320920646266, 83.07257563294404, 19.185438356436403, 27.435977779190974, 90.93772609939917, 40.41304835807803, 1.5140646834450295, 103.86988675299173, 77.56391462981904, 63.67932917954895, 26.856879158085043, 11.555598543558153, 146.4494626613656, 94.9864463283054, 12.721184775416614, 26.30041258526426, 120.85068163572754, 10.805981383311753, 39.184688842916174, 28.712421732634823, 20.207107857505154, 59.84890529195903, 27.40747722490972, 17.266634027216753, 23.038808377404568, 9.00056967904485, 14.880622681472353, 7.993009819172984, 21.85369426153491, 34.08613920914139, 36.72806783534463, 14.727973885255405, 45.13515385312954, 191.99798786814608, 9.850337131787839, 48.80211312173564, 205.44742862420145, 15.909785068088443, 39.99134492880651, 8.001454227173507, 5.8516696710577545, 65.06209969764761, 20.121213751280628, 150.8370066660671, 3.895509006000407, 14.652088219650071, 19.08580214611555, 8.803315333246925, 27.7919599853181, 21.885004704628685, 145.62938667966196, 143.55593460290333, 16.231217358334803, 33.771010754736984, 58.744773580801926, 140.55865547414982, 8.689654782429145, 19.88895259586221, 113.45423418601113, 106.04756796888596, 16.52260613638546, 73.90912615888458, 123.24133748808131, 21.131514292295844, 5.168900757457598, 16.10649365170152, 21.642806906926097, 38.9405122483958, 24.08663143494781, 92.80895915660187, 122.86265616975288, 14.152766490039044, 17.983883059097465, 17.466454380234367, 182.52814979060108, 24.437596797651757, 32.05540656386141, 47.25293305760628, 34.74551346429848, 52.97966302502954, 32.36895649191193, 165.4929711992179, 126.96173825550967, 182.69114251622034, 113.73901532082628, 155.79083626468915, 138.0543724490921, 136.27443211072773, 43.79017034523919, 20.36774705662287, 14.985707805352693, 37.98591766803525, 23.763837664416904, 30.088147101593556, 59.21499773380809, 222.49423247319106, 133.82903487069487, 94.16468210013873, 10.733456981619893, 33.347045059786026, 20.58968260107446, 106.23842897867111, 3.499778240750853, 16.03116010685965]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6222097486322282, "mean_inference_ms": 1.9207827603836338, "mean_action_processing_ms": 0.2660277456197624, "mean_env_wait_ms": 0.23434103786917646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00524139404296875, "StateBufferConnector_ms": 0.005143523216247559, "ViewRequirementAgentConnector_ms": 0.12635791301727295}, "num_episodes": 18, "episode_return_max": 418.5726732553133, "episode_return_min": 265.7952059516291, "episode_return_mean": 366.458614161723, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.9039252776024, "num_env_steps_trained_throughput_per_sec": 351.9039252776024, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 12117.996, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12117.952, "sample_time_ms": 1714.032, "learn_time_ms": 10385.075, "learn_throughput": 385.168, "synch_weights_time_ms": 15.956}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "e552a_00000", "date": "2024-08-16_08-53-39", "timestamp": 1723778619, "time_this_iter_s": 11.411026954650879, "time_total_s": 429.5286591053009, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7340820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 429.5286591053009, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.44375, "ram_util_percent": 82.80625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.509230027627693, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.9286451998211085, "policy_loss": -0.004633595632812964, "vf_loss": 7.931532392804585, "vf_explained_var": 0.20938437650443384, "kl": 0.005174509436037633, "entropy": 1.2063743842341912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.264462435844714, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.72391376318755, "policy_loss": -0.0021359418735657104, "vf_loss": 8.725227232332584, "vf_explained_var": 0.037263981722019335, "kl": 0.010966137792130458, "entropy": 1.45708867368244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 404.16856821837456, "episode_reward_min": 265.7952059516291, "episode_reward_mean": 364.09566545417607, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -265.51644144353196, "predator_policy": 0.9155312742710848}, "policy_reward_max": {"prey_policy": 199.7825605741072, "predator_policy": 387.0710004456677}, "policy_reward_mean": {"prey_policy": 126.87171612706891, "predator_policy": 55.17611660001907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.91591421418485, 362.62325562198953, 398.7174815314952, 383.52682185059905, 385.8204493731117, 377.4124477680644, 379.1161054397937, 389.88982223836246, 340.72354739110324, 265.7952059516291, 345.06048290046095, 392.86757056109843, 392.86747597723485, 337.5963857617526, 368.5072554190889, 360.31493871315587, 399.9253590129137, 304.51794890466476, 390.40797648633486, 349.3954999880438, 350.8452117485516, 346.52426154102733, 363.4119948271446, 393.01071773018344, 318.07487026623585, 387.1717576351217, 313.7422087998375, 361.3952571672411, 316.8318213786973, 291.12278290910496, 356.59842155499877, 373.88028764999586, 387.2279048973742, 403.1454189647567, 346.3857135342389, 369.734344218451, 339.81135282009024, 392.9960832104292, 394.56254408729006, 397.4337923683054, 364.30282196951146, 382.9161986147036, 324.7112969658192, 371.88750608792685, 301.89653444915535, 388.6432505784988, 377.8035618768215, 326.7961015174341, 386.1559226878178, 383.9019883559039, 400.100909670918, 371.7224690597294, 362.79271827261874, 322.46888060218646, 400.86450219186816, 340.31885428985044, 365.21991693498006, 352.0366662514753, 387.0312376637114, 400.87852334177404, 367.0047261526466, 331.3515644712532, 390.6633360538942, 339.30010420874675, 390.11968159785613, 382.29735868258035, 359.23027367094073, 378.98878399828726, 346.6893248090003, 391.11566800996627, 386.0352535224013, 404.16856821837456, 387.53525637706787, 307.7489595370788, 399.3990873927103, 323.3891082254453, 334.10418310397154, 392.45108246100045, 368.5287026997455, 343.9658679740371, 371.2122040745952, 359.6663437277392, 390.90165473742763, 299.2802010662871, 378.85674743448266, 362.1166525439651, 387.8087210461586, 370.09162245411886, 348.1669221516237, 380.36721259520493, 319.5298592772586, 340.287816364944, 312.47948748458356, 372.81996138775827, 369.39564597875676, 384.6810549772716, 392.6802309993, 378.4084458342374, 385.5821306185182, 354.788185699495], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.86358440850162, 174.19737171289853, 133.59673687849693, 136.66073432744497, 191.40049809275482, 190.31450940302796, 186.48345061053578, 183.6878972842912, 155.7916546529013, 150.41441300887212, 178.4155603602954, 185.48135202566857, 172.37308995897638, 177.66459025306904, 191.199679520193, 184.79706152656732, 175.11757020388217, 145.55, 24.963605532322802, 147.01544498999982, 126.09358172846983, 175.96958325397722, 163.16607816287862, 177.99663796480053, 190.5555253380605, 189.01359282951594, 141.89900365670192, 186.3627388584809, 168.00100109861472, 180.26895404206888, 156.82063325841386, 139.4725808528516, 189.33189267335177, 190.45490960965648, 146.67115261632946, 122.87258615675826, 199.7825605741072, 165.09904209734665, 50.36196869949313, 92.23121275255171, 89.67931046051392, 76.85033973708349, 65.40826309694094, 126.71717947496536, 173.75855976341373, 171.0097901195308, 173.80890922235426, 193.6750386649894, 139.9535057303302, 88.16695459630786, 165.55036050061776, 179.67660162333755, 63.37581841191194, 94.61060554851882, 164.16506618857855, 150.60877484303518, 103.13307822099412, 82.34796870022622, 141.65758829626387, 44.08124317640414, 101.26386304672442, 114.09131469890623, 163.3308532377078, 172.13695671064474, 121.41247406406491, 24.379521843638265, 197.0828148314869, 167.04100677258907, 111.4097326734211, 103.31931784177864, 161.0361181225903, 140.80111552030974, 135.7159675424289, 124.03937212819707, 159.75907834637638, 188.56289361192637, 178.02812094667112, 184.49504508416928, 182.2856521037995, 192.27450776386073, 167.94031644795646, 140.42267205087842, 170.362317067252, 161.09783982685138, 20.52282384783404, 67.05533139670868, 162.0210860421338, 151.21396979227018, 66.94005232962726, 13.599268427237805, 181.67083787142104, 158.9796135510979, 150.76398279380555, 156.12580971431063, 72.91310008743396, 82.92478101265243, 183.70026042303454, 183.90806503913277, 176.90223290363372, 179.11063797290763, 179.3585428922862, 171.06540208868498, 22.21179307444655, 60.325354702717775, 168.0067800260287, 144.78371013351818, 94.24746927360029, 28.91798227363431, 192.19407654620352, 180.09181826737324, 39.64922994843767, 81.16782218651572, 125.66231770171956, 149.12586693799014, 119.93986198307915, 87.72395248801911, 177.21183754442967, 188.5440057101226, 151.91597208923122, 188.3792320972204, 113.09108087675739, 137.01805468433957, 96.66824774192295, 97.66789406953811, 192.57866943624845, 162.634329178314, 72.72862801867352, 59.60572960182031, 150.42225001952485, 160.38909195686344, 144.30741270916937, 150.2647694840827, 118.28413779647005, 43.08420818334101, 72.83778208286058, -3.501878856304004, 4.411311361976795, 72.74816186150788, 53.217563370610975, 63.56930007953571, 167.27753700410284, 154.5997991164369, 169.33937601520532, 181.85756672978184, 162.96967460316523, 170.71359700789228, 30.98763036459028, -4.947901034510768, 98.37241926968207, 73.03295115219446, 155.48532315537236, 123.82328302866722, 99.9689557442279, 107.30711577999823, 179.33006459006344, 193.59007952332627, 106.88039888033032, 127.14384081973144, 92.08946957482465, 96.22273916802638, 78.48821128795568, 90.8548303337778, 75.70640462414002, 139.8844939632034, 157.35721118815022, 160.6601866261593, 120.68768800812903, 53.40241713704132, 138.9247313569365, 165.8338304095422, 70.20280026009266, 82.55319389957039, 52.91169114201777, 30.36151426988248, 68.6221490881434, 83.25944552891374, 128.81038369715705, 165.5170063842402, 94.25281189348686, 92.63759065207172, 74.8584865960191, 84.63854270754697, 73.1618923175172, 132.22170300657504, 84.51694448156766, 71.32699032958953, -265.51644144353196, -1.8427852237134303, 164.71319052463056, 160.36026057283263, -22.733713285848946, 38.23577190220594, 185.19365662700577, 176.0915691867529, 135.5377869189307, 126.14729321405571, 167.18805513911045, 182.23475688033068, 144.70912100292506, 137.4881372521275], "policy_predator_policy_reward": [21.218773165649036, 9.636184927135622, 66.47323084883381, 25.892553567214065, 9.395121061982307, 7.607352973730139, 1.7018656757426716, 11.653608280029415, 40.10846649772115, 39.50591521361756, 8.684479328972596, 4.831056053127841, 14.538386160271918, 14.540039067476378, 6.918627787849913, 6.974453403752236, 13.881343825740316, 6.174633361480828, 90.3308997314136, 3.485255697892934, 8.874962675529991, 34.122355242484, 29.997548746469437, 21.707305686949752, 6.704205422774993, 6.5941523868833976, 0.9155312742710848, 8.41911197229862, 3.3679771132179583, 16.869323165187307, 43.684422962111135, 20.337301639779103, 12.056595891111321, 8.08196083879411, 33.979568949252716, 0.9946411823248879, 13.944749087336497, 11.581624727544432, 112.16013221455141, 94.64218632144782, 160.5596343387817, 23.75592721217246, 61.27498500801386, 93.12383396110742, 8.923668945984842, 9.719975998215237, 11.68023086849469, 13.846538974345139, 6.530170299951347, 83.42423963964637, 12.518080371048786, 29.42671514011758, 72.68320920646266, 83.07257563294404, 19.185438356436403, 27.435977779190974, 90.93772609939917, 40.41304835807803, 1.5140646834450295, 103.86988675299173, 77.56391462981904, 63.67932917954895, 26.856879158085043, 11.555598543558153, 146.4494626613656, 94.9864463283054, 12.721184775416614, 26.30041258526426, 120.85068163572754, 10.805981383311753, 39.184688842916174, 28.712421732634823, 20.207107857505154, 59.84890529195903, 27.40747722490972, 17.266634027216753, 23.038808377404568, 9.00056967904485, 14.880622681472353, 7.993009819172984, 21.85369426153491, 34.08613920914139, 36.72806783534463, 14.727973885255405, 45.13515385312954, 191.99798786814608, 9.850337131787839, 48.80211312173564, 205.44742862420145, 15.909785068088443, 39.99134492880651, 8.001454227173507, 5.8516696710577545, 65.06209969764761, 20.121213751280628, 150.8370066660671, 3.895509006000407, 14.652088219650071, 19.08580214611555, 8.803315333246925, 27.7919599853181, 21.885004704628685, 145.62938667966196, 143.55593460290333, 16.231217358334803, 33.771010754736984, 58.744773580801926, 140.55865547414982, 8.689654782429145, 19.88895259586221, 113.45423418601113, 106.04756796888596, 16.52260613638546, 73.90912615888458, 123.24133748808131, 21.131514292295844, 5.168900757457598, 16.10649365170152, 21.642806906926097, 38.9405122483958, 24.08663143494781, 92.80895915660187, 122.86265616975288, 14.152766490039044, 17.983883059097465, 17.466454380234367, 182.52814979060108, 24.437596797651757, 32.05540656386141, 47.25293305760628, 34.74551346429848, 52.97966302502954, 32.36895649191193, 165.4929711992179, 126.96173825550967, 182.69114251622034, 113.73901532082628, 155.79083626468915, 138.0543724490921, 136.27443211072773, 43.79017034523919, 20.36774705662287, 14.985707805352693, 37.98591766803525, 23.763837664416904, 30.088147101593556, 59.21499773380809, 222.49423247319106, 133.82903487069487, 94.16468210013873, 10.733456981619893, 33.347045059786026, 20.58968260107446, 106.23842897867111, 3.499778240750853, 16.03116010685965, 88.25151184053027, 46.252951159153646, 130.62746385283745, 25.02619537834871, 134.493573253235, 67.37558919962713, 38.43681011466099, 105.63863502573442, 50.37333315132003, 22.510923771797977, 2.515154965563714, 122.67494095555315, 31.347745389212005, 42.75044027879194, 117.48908674547988, 91.87157163882233, 177.78066076738838, 126.75485486686988, 39.11945517074442, 179.09057266631788, 26.16045802736226, 27.679074042864805, 115.55800428831449, 77.9188057613313, 146.80485255302594, 13.227977420666788, 102.78984064556671, 32.114380395284655, 148.457737619634, 8.177815053792289, 253.10818760933648, 387.0710004456677, 28.35982372535966, 15.962371155934216, 177.13229781604872, 192.04669854486548, 16.679569453970075, 14.715435731571231, 83.9030968669246, 32.82026883432603, 1.0267264134488954, 35.132592185628425, 56.53448490523989, 16.056442539202674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6274467215092888, "mean_inference_ms": 1.944289360572737, "mean_action_processing_ms": 0.26753744977267385, "mean_env_wait_ms": 0.23668794972829046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005148887634277344, "StateBufferConnector_ms": 0.005051851272583008, "ViewRequirementAgentConnector_ms": 0.1236271858215332}, "num_episodes": 22, "episode_return_max": 404.16856821837456, "episode_return_min": 265.7952059516291, "episode_return_mean": 364.09566545417607, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.776374679948, "num_env_steps_trained_throughput_per_sec": 358.776374679948, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 12122.979, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12122.936, "sample_time_ms": 1706.309, "learn_time_ms": 10397.808, "learn_throughput": 384.696, "synch_weights_time_ms": 15.843}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "e552a_00000", "date": "2024-08-16_08-53-50", "timestamp": 1723778630, "time_this_iter_s": 11.193939924240112, "time_total_s": 440.722599029541, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72dea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 440.722599029541, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.006249999999994, "ram_util_percent": 82.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.356968737910034, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.400870648641435, "policy_loss": -0.007098273405061158, "vf_loss": 8.40580541696498, "vf_explained_var": 0.26947755662221756, "kl": 0.006410394792539975, "entropy": 1.2057856301781993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2402164534286215, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.616857337194777, "policy_loss": -0.0027769616233411605, "vf_loss": 8.618691895500062, "vf_explained_var": 0.06780896007068574, "kl": 0.012565343123351917, "entropy": 1.4645652856776323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 404.16856821837456, "episode_reward_min": 137.5214264335842, "episode_reward_mean": 356.0563039336701, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -265.51644144353196, "predator_policy": 1.0267264134488954}, "policy_reward_max": {"prey_policy": 197.0828148314869, "predator_policy": 387.0710004456677}, "policy_reward_mean": {"prey_policy": 108.76433158431722, "predator_policy": 69.26382038251782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.01071773018344, 318.07487026623585, 387.1717576351217, 313.7422087998375, 361.3952571672411, 316.8318213786973, 291.12278290910496, 356.59842155499877, 373.88028764999586, 387.2279048973742, 403.1454189647567, 346.3857135342389, 369.734344218451, 339.81135282009024, 392.9960832104292, 394.56254408729006, 397.4337923683054, 364.30282196951146, 382.9161986147036, 324.7112969658192, 371.88750608792685, 301.89653444915535, 388.6432505784988, 377.8035618768215, 326.7961015174341, 386.1559226878178, 383.9019883559039, 400.100909670918, 371.7224690597294, 362.79271827261874, 322.46888060218646, 400.86450219186816, 340.31885428985044, 365.21991693498006, 352.0366662514753, 387.0312376637114, 400.87852334177404, 367.0047261526466, 331.3515644712532, 390.6633360538942, 339.30010420874675, 390.11968159785613, 382.29735868258035, 359.23027367094073, 378.98878399828726, 346.6893248090003, 391.11566800996627, 386.0352535224013, 404.16856821837456, 387.53525637706787, 307.7489595370788, 399.3990873927103, 323.3891082254453, 334.10418310397154, 392.45108246100045, 368.5287026997455, 343.9658679740371, 371.2122040745952, 359.6663437277392, 390.90165473742763, 299.2802010662871, 378.85674743448266, 362.1166525439651, 387.8087210461586, 370.09162245411886, 348.1669221516237, 380.36721259520493, 319.5298592772586, 340.287816364944, 312.47948748458356, 372.81996138775827, 369.39564597875676, 384.6810549772716, 392.6802309993, 378.4084458342374, 385.5821306185182, 354.788185699495, 324.2057996746794, 390.0465328767305, 312.6301192273642, 337.2733878600419, 285.3054026828249, 382.43789607470126, 382.8962343998148, 336.0206716344253, 137.5214264335842, 307.175502200145, 341.07432067521546, 306.56418605922073, 193.5584620335212, 353.92204899737743, 321.6178852607249, 298.7562411550015, 386.6245310214618, 331.7456722819959, 325.5800279350974, 337.39540398497564, 388.5186378785447, 394.8570417659812, 391.1198290577926], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.80890922235426, 193.6750386649894, 139.9535057303302, 88.16695459630786, 165.55036050061776, 179.67660162333755, 63.37581841191194, 94.61060554851882, 164.16506618857855, 150.60877484303518, 103.13307822099412, 82.34796870022622, 141.65758829626387, 44.08124317640414, 101.26386304672442, 114.09131469890623, 163.3308532377078, 172.13695671064474, 121.41247406406491, 24.379521843638265, 197.0828148314869, 167.04100677258907, 111.4097326734211, 103.31931784177864, 161.0361181225903, 140.80111552030974, 135.7159675424289, 124.03937212819707, 159.75907834637638, 188.56289361192637, 178.02812094667112, 184.49504508416928, 182.2856521037995, 192.27450776386073, 167.94031644795646, 140.42267205087842, 170.362317067252, 161.09783982685138, 20.52282384783404, 67.05533139670868, 162.0210860421338, 151.21396979227018, 66.94005232962726, 13.599268427237805, 181.67083787142104, 158.9796135510979, 150.76398279380555, 156.12580971431063, 72.91310008743396, 82.92478101265243, 183.70026042303454, 183.90806503913277, 176.90223290363372, 179.11063797290763, 179.3585428922862, 171.06540208868498, 22.21179307444655, 60.325354702717775, 168.0067800260287, 144.78371013351818, 94.24746927360029, 28.91798227363431, 192.19407654620352, 180.09181826737324, 39.64922994843767, 81.16782218651572, 125.66231770171956, 149.12586693799014, 119.93986198307915, 87.72395248801911, 177.21183754442967, 188.5440057101226, 151.91597208923122, 188.3792320972204, 113.09108087675739, 137.01805468433957, 96.66824774192295, 97.66789406953811, 192.57866943624845, 162.634329178314, 72.72862801867352, 59.60572960182031, 150.42225001952485, 160.38909195686344, 144.30741270916937, 150.2647694840827, 118.28413779647005, 43.08420818334101, 72.83778208286058, -3.501878856304004, 4.411311361976795, 72.74816186150788, 53.217563370610975, 63.56930007953571, 167.27753700410284, 154.5997991164369, 169.33937601520532, 181.85756672978184, 162.96967460316523, 170.71359700789228, 30.98763036459028, -4.947901034510768, 98.37241926968207, 73.03295115219446, 155.48532315537236, 123.82328302866722, 99.9689557442279, 107.30711577999823, 179.33006459006344, 193.59007952332627, 106.88039888033032, 127.14384081973144, 92.08946957482465, 96.22273916802638, 78.48821128795568, 90.8548303337778, 75.70640462414002, 139.8844939632034, 157.35721118815022, 160.6601866261593, 120.68768800812903, 53.40241713704132, 138.9247313569365, 165.8338304095422, 70.20280026009266, 82.55319389957039, 52.91169114201777, 30.36151426988248, 68.6221490881434, 83.25944552891374, 128.81038369715705, 165.5170063842402, 94.25281189348686, 92.63759065207172, 74.8584865960191, 84.63854270754697, 73.1618923175172, 132.22170300657504, 84.51694448156766, 71.32699032958953, -265.51644144353196, -1.8427852237134303, 164.71319052463056, 160.36026057283263, -22.733713285848946, 38.23577190220594, 185.19365662700577, 176.0915691867529, 135.5377869189307, 126.14729321405571, 167.18805513911045, 182.23475688033068, 144.70912100292506, 137.4881372521275, 72.4552476553305, 90.0011983413913, 156.24401404048757, 145.41506798250327, 63.07368281311113, 42.60234589994773, 76.87152565699016, 2.6044672010818344, -33.45705458786475, 55.52378199269435, 159.7571134802573, 140.9380508295203, 172.16826684372822, 152.6158456472395, -118.99169639637745, 0.18427930545655258, 50.95488683845155, -5.232941825063776, 73.6290391433785, 41.85887277369, 80.87947449238773, 132.57101788849755, 47.937043495642826, 104.1703536714558, -24.768964374226556, 29.294580044414626, 107.1243627429022, 77.24319534473186, -114.04040140307552, 89.11341420358426, 10.771656691596654, 95.45608676832819, 149.33332546409108, 179.48468184636548, 113.07492399889645, 78.88589437597518, 67.40613208372962, 21.22923901468187, 148.49357282528808, 146.70405653299719, 131.7268778986396, 143.24142715369166, 48.704918863822485, 58.124174987556984, 139.66416460196587, 98.31937222734776], "policy_predator_policy_reward": [11.68023086849469, 13.846538974345139, 6.530170299951347, 83.42423963964637, 12.518080371048786, 29.42671514011758, 72.68320920646266, 83.07257563294404, 19.185438356436403, 27.435977779190974, 90.93772609939917, 40.41304835807803, 1.5140646834450295, 103.86988675299173, 77.56391462981904, 63.67932917954895, 26.856879158085043, 11.555598543558153, 146.4494626613656, 94.9864463283054, 12.721184775416614, 26.30041258526426, 120.85068163572754, 10.805981383311753, 39.184688842916174, 28.712421732634823, 20.207107857505154, 59.84890529195903, 27.40747722490972, 17.266634027216753, 23.038808377404568, 9.00056967904485, 14.880622681472353, 7.993009819172984, 21.85369426153491, 34.08613920914139, 36.72806783534463, 14.727973885255405, 45.13515385312954, 191.99798786814608, 9.850337131787839, 48.80211312173564, 205.44742862420145, 15.909785068088443, 39.99134492880651, 8.001454227173507, 5.8516696710577545, 65.06209969764761, 20.121213751280628, 150.8370066660671, 3.895509006000407, 14.652088219650071, 19.08580214611555, 8.803315333246925, 27.7919599853181, 21.885004704628685, 145.62938667966196, 143.55593460290333, 16.231217358334803, 33.771010754736984, 58.744773580801926, 140.55865547414982, 8.689654782429145, 19.88895259586221, 113.45423418601113, 106.04756796888596, 16.52260613638546, 73.90912615888458, 123.24133748808131, 21.131514292295844, 5.168900757457598, 16.10649365170152, 21.642806906926097, 38.9405122483958, 24.08663143494781, 92.80895915660187, 122.86265616975288, 14.152766490039044, 17.983883059097465, 17.466454380234367, 182.52814979060108, 24.437596797651757, 32.05540656386141, 47.25293305760628, 34.74551346429848, 52.97966302502954, 32.36895649191193, 165.4929711992179, 126.96173825550967, 182.69114251622034, 113.73901532082628, 155.79083626468915, 138.0543724490921, 136.27443211072773, 43.79017034523919, 20.36774705662287, 14.985707805352693, 37.98591766803525, 23.763837664416904, 30.088147101593556, 59.21499773380809, 222.49423247319106, 133.82903487069487, 94.16468210013873, 10.733456981619893, 33.347045059786026, 20.58968260107446, 106.23842897867111, 3.499778240750853, 16.03116010685965, 88.25151184053027, 46.252951159153646, 130.62746385283745, 25.02619537834871, 134.493573253235, 67.37558919962713, 38.43681011466099, 105.63863502573442, 50.37333315132003, 22.510923771797977, 2.515154965563714, 122.67494095555315, 31.347745389212005, 42.75044027879194, 117.48908674547988, 91.87157163882233, 177.78066076738838, 126.75485486686988, 39.11945517074442, 179.09057266631788, 26.16045802736226, 27.679074042864805, 115.55800428831449, 77.9188057613313, 146.80485255302594, 13.227977420666788, 102.78984064556671, 32.114380395284655, 148.457737619634, 8.177815053792289, 253.10818760933648, 387.0710004456677, 28.35982372535966, 15.962371155934216, 177.13229781604872, 192.04669854486548, 16.679569453970075, 14.715435731571231, 83.9030968669246, 32.82026883432603, 1.0267264134488954, 35.132592185628425, 56.53448490523989, 16.056442539202674, 146.41346256757976, 15.335891110377899, 37.114766660297384, 51.27268419344205, 92.32878622472585, 114.62530428957939, 127.26331102675032, 130.53408397521954, 105.32524696618529, 157.91342831180953, 61.77821677227867, 19.964514992645253, 27.71564603718663, 30.396475871660115, 196.5656415689333, 258.2624471564134, 47.70299811842904, 44.09648330176709, 118.1586566961712, 73.52893358690525, 112.22185717500811, 15.401971119322388, 9.833809956431763, 144.6229789356901, 107.87554472884887, 81.15730163448492, 60.663915033819556, 108.890575875924, 261.67892192329134, 84.86595053692477, 143.46570167974733, 49.06279601532904, 28.480649189821445, 29.325874521183966, 118.41507967861095, 21.369774228513805, 74.01553817223211, 162.92911866445417, 16.878366155906864, 25.31940847078371, 73.04006677373263, 40.51026605248078, 162.83165478090046, 125.19629313370159, 78.0166163041944, 75.11967592428398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6311508934558373, "mean_inference_ms": 1.950088692288189, "mean_action_processing_ms": 0.2682876131900369, "mean_env_wait_ms": 0.2380028715534932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004885673522949219, "StateBufferConnector_ms": 0.004839897155761719, "ViewRequirementAgentConnector_ms": 0.10496294498443604}, "num_episodes": 23, "episode_return_max": 404.16856821837456, "episode_return_min": 137.5214264335842, "episode_return_mean": 356.0563039336701, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.66166157277604, "num_env_steps_trained_throughput_per_sec": 368.66166157277604, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 12085.877, "restore_workers_time_ms": 0.015, "training_step_time_ms": 12085.834, "sample_time_ms": 1704.981, "learn_time_ms": 10362.242, "learn_throughput": 386.017, "synch_weights_time_ms": 15.74}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-01", "timestamp": 1723778641, "time_this_iter_s": 10.85463809967041, "time_total_s": 451.5772371292114, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 451.5772371292114, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 29.819999999999997, "ram_util_percent": 82.50666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.284049496764228, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.142816323578042, "policy_loss": -0.004877141837976755, "vf_loss": 9.145555369059245, "vf_explained_var": 0.11419706675741408, "kl": 0.006335105548691304, "entropy": 1.1797216077960988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9698541226210415, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.130212337251693, "policy_loss": -0.0016252412731764178, "vf_loss": 9.131292198827026, "vf_explained_var": 0.023013578520880804, "kl": 0.007271386389873432, "entropy": 1.4383134958605286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 408.0239502816915, "episode_reward_min": 137.5214264335842, "episode_reward_mean": 355.4594315960499, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -303.726352108639, "predator_policy": 1.0267264134488954}, "policy_reward_max": {"prey_policy": 193.59007952332627, "predator_policy": 430.2336226065485}, "policy_reward_mean": {"prey_policy": 88.49590434432932, "predator_policy": 89.23381145369567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.9161986147036, 324.7112969658192, 371.88750608792685, 301.89653444915535, 388.6432505784988, 377.8035618768215, 326.7961015174341, 386.1559226878178, 383.9019883559039, 400.100909670918, 371.7224690597294, 362.79271827261874, 322.46888060218646, 400.86450219186816, 340.31885428985044, 365.21991693498006, 352.0366662514753, 387.0312376637114, 400.87852334177404, 367.0047261526466, 331.3515644712532, 390.6633360538942, 339.30010420874675, 390.11968159785613, 382.29735868258035, 359.23027367094073, 378.98878399828726, 346.6893248090003, 391.11566800996627, 386.0352535224013, 404.16856821837456, 387.53525637706787, 307.7489595370788, 399.3990873927103, 323.3891082254453, 334.10418310397154, 392.45108246100045, 368.5287026997455, 343.9658679740371, 371.2122040745952, 359.6663437277392, 390.90165473742763, 299.2802010662871, 378.85674743448266, 362.1166525439651, 387.8087210461586, 370.09162245411886, 348.1669221516237, 380.36721259520493, 319.5298592772586, 340.287816364944, 312.47948748458356, 372.81996138775827, 369.39564597875676, 384.6810549772716, 392.6802309993, 378.4084458342374, 385.5821306185182, 354.788185699495, 324.2057996746794, 390.0465328767305, 312.6301192273642, 337.2733878600419, 285.3054026828249, 382.43789607470126, 382.8962343998148, 336.0206716344253, 137.5214264335842, 307.175502200145, 341.07432067521546, 306.56418605922073, 193.5584620335212, 353.92204899737743, 321.6178852607249, 298.7562411550015, 386.6245310214618, 331.7456722819959, 325.5800279350974, 337.39540398497564, 388.5186378785447, 394.8570417659812, 391.1198290577926, 311.4219563727716, 362.37295718279734, 300.1976365885255, 384.9827145289092, 408.0239502816915, 335.20462739651913, 358.14238363599065, 373.9797400813672, 374.9959182993502, 370.32958395313324, 378.90218604382386, 348.9511142983846, 347.3462419993167, 369.63361034644754, 364.599107036704, 366.16791651203266, 326.8858434797815, 365.6033793623033], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.362317067252, 161.09783982685138, 20.52282384783404, 67.05533139670868, 162.0210860421338, 151.21396979227018, 66.94005232962726, 13.599268427237805, 181.67083787142104, 158.9796135510979, 150.76398279380555, 156.12580971431063, 72.91310008743396, 82.92478101265243, 183.70026042303454, 183.90806503913277, 176.90223290363372, 179.11063797290763, 179.3585428922862, 171.06540208868498, 22.21179307444655, 60.325354702717775, 168.0067800260287, 144.78371013351818, 94.24746927360029, 28.91798227363431, 192.19407654620352, 180.09181826737324, 39.64922994843767, 81.16782218651572, 125.66231770171956, 149.12586693799014, 119.93986198307915, 87.72395248801911, 177.21183754442967, 188.5440057101226, 151.91597208923122, 188.3792320972204, 113.09108087675739, 137.01805468433957, 96.66824774192295, 97.66789406953811, 192.57866943624845, 162.634329178314, 72.72862801867352, 59.60572960182031, 150.42225001952485, 160.38909195686344, 144.30741270916937, 150.2647694840827, 118.28413779647005, 43.08420818334101, 72.83778208286058, -3.501878856304004, 4.411311361976795, 72.74816186150788, 53.217563370610975, 63.56930007953571, 167.27753700410284, 154.5997991164369, 169.33937601520532, 181.85756672978184, 162.96967460316523, 170.71359700789228, 30.98763036459028, -4.947901034510768, 98.37241926968207, 73.03295115219446, 155.48532315537236, 123.82328302866722, 99.9689557442279, 107.30711577999823, 179.33006459006344, 193.59007952332627, 106.88039888033032, 127.14384081973144, 92.08946957482465, 96.22273916802638, 78.48821128795568, 90.8548303337778, 75.70640462414002, 139.8844939632034, 157.35721118815022, 160.6601866261593, 120.68768800812903, 53.40241713704132, 138.9247313569365, 165.8338304095422, 70.20280026009266, 82.55319389957039, 52.91169114201777, 30.36151426988248, 68.6221490881434, 83.25944552891374, 128.81038369715705, 165.5170063842402, 94.25281189348686, 92.63759065207172, 74.8584865960191, 84.63854270754697, 73.1618923175172, 132.22170300657504, 84.51694448156766, 71.32699032958953, -265.51644144353196, -1.8427852237134303, 164.71319052463056, 160.36026057283263, -22.733713285848946, 38.23577190220594, 185.19365662700577, 176.0915691867529, 135.5377869189307, 126.14729321405571, 167.18805513911045, 182.23475688033068, 144.70912100292506, 137.4881372521275, 72.4552476553305, 90.0011983413913, 156.24401404048757, 145.41506798250327, 63.07368281311113, 42.60234589994773, 76.87152565699016, 2.6044672010818344, -33.45705458786475, 55.52378199269435, 159.7571134802573, 140.9380508295203, 172.16826684372822, 152.6158456472395, -118.99169639637745, 0.18427930545655258, 50.95488683845155, -5.232941825063776, 73.6290391433785, 41.85887277369, 80.87947449238773, 132.57101788849755, 47.937043495642826, 104.1703536714558, -24.768964374226556, 29.294580044414626, 107.1243627429022, 77.24319534473186, -114.04040140307552, 89.11341420358426, 10.771656691596654, 95.45608676832819, 149.33332546409108, 179.48468184636548, 113.07492399889645, 78.88589437597518, 67.40613208372962, 21.22923901468187, 148.49357282528808, 146.70405653299719, 131.7268778986396, 143.24142715369166, 48.704918863822485, 58.124174987556984, 139.66416460196587, 98.31937222734776, 7.331557665279083, 84.98368472102251, 19.263421829729623, 34.230257284397574, 38.43673070456712, -94.273331966911, 60.64325959916603, -89.02410935030136, 98.70858621104277, -257.598107948411, 12.943005118240386, 15.242505334761194, 121.52183527715705, 161.26516792001422, 80.21451142406764, 111.2836514611389, 105.4416089560765, -303.726352108639, 93.56158618158629, 66.55578012204282, 24.373403487666245, -28.691828459317726, 47.7670987845811, 54.072627455923524, 42.71752740036801, 8.170440750283301, 86.61957085180626, 94.43836485117961, 96.94203112114886, 138.7253732668571, 47.045490982237204, 67.00062935445146, -233.84150451608014, 57.99514595360764, 41.01057160716029, 50.60458978851196], "policy_predator_policy_reward": [36.72806783534463, 14.727973885255405, 45.13515385312954, 191.99798786814608, 9.850337131787839, 48.80211312173564, 205.44742862420145, 15.909785068088443, 39.99134492880651, 8.001454227173507, 5.8516696710577545, 65.06209969764761, 20.121213751280628, 150.8370066660671, 3.895509006000407, 14.652088219650071, 19.08580214611555, 8.803315333246925, 27.7919599853181, 21.885004704628685, 145.62938667966196, 143.55593460290333, 16.231217358334803, 33.771010754736984, 58.744773580801926, 140.55865547414982, 8.689654782429145, 19.88895259586221, 113.45423418601113, 106.04756796888596, 16.52260613638546, 73.90912615888458, 123.24133748808131, 21.131514292295844, 5.168900757457598, 16.10649365170152, 21.642806906926097, 38.9405122483958, 24.08663143494781, 92.80895915660187, 122.86265616975288, 14.152766490039044, 17.983883059097465, 17.466454380234367, 182.52814979060108, 24.437596797651757, 32.05540656386141, 47.25293305760628, 34.74551346429848, 52.97966302502954, 32.36895649191193, 165.4929711992179, 126.96173825550967, 182.69114251622034, 113.73901532082628, 155.79083626468915, 138.0543724490921, 136.27443211072773, 43.79017034523919, 20.36774705662287, 14.985707805352693, 37.98591766803525, 23.763837664416904, 30.088147101593556, 59.21499773380809, 222.49423247319106, 133.82903487069487, 94.16468210013873, 10.733456981619893, 33.347045059786026, 20.58968260107446, 106.23842897867111, 3.499778240750853, 16.03116010685965, 88.25151184053027, 46.252951159153646, 130.62746385283745, 25.02619537834871, 134.493573253235, 67.37558919962713, 38.43681011466099, 105.63863502573442, 50.37333315132003, 22.510923771797977, 2.515154965563714, 122.67494095555315, 31.347745389212005, 42.75044027879194, 117.48908674547988, 91.87157163882233, 177.78066076738838, 126.75485486686988, 39.11945517074442, 179.09057266631788, 26.16045802736226, 27.679074042864805, 115.55800428831449, 77.9188057613313, 146.80485255302594, 13.227977420666788, 102.78984064556671, 32.114380395284655, 148.457737619634, 8.177815053792289, 253.10818760933648, 387.0710004456677, 28.35982372535966, 15.962371155934216, 177.13229781604872, 192.04669854486548, 16.679569453970075, 14.715435731571231, 83.9030968669246, 32.82026883432603, 1.0267264134488954, 35.132592185628425, 56.53448490523989, 16.056442539202674, 146.41346256757976, 15.335891110377899, 37.114766660297384, 51.27268419344205, 92.32878622472585, 114.62530428957939, 127.26331102675032, 130.53408397521954, 105.32524696618529, 157.91342831180953, 61.77821677227867, 19.964514992645253, 27.71564603718663, 30.396475871660115, 196.5656415689333, 258.2624471564134, 47.70299811842904, 44.09648330176709, 118.1586566961712, 73.52893358690525, 112.22185717500811, 15.401971119322388, 9.833809956431763, 144.6229789356901, 107.87554472884887, 81.15730163448492, 60.663915033819556, 108.890575875924, 261.67892192329134, 84.86595053692477, 143.46570167974733, 49.06279601532904, 28.480649189821445, 29.325874521183966, 118.41507967861095, 21.369774228513805, 74.01553817223211, 162.92911866445417, 16.878366155906864, 25.31940847078371, 73.04006677373263, 40.51026605248078, 162.83165478090046, 125.19629313370159, 78.0166163041944, 75.11967592428398, 84.34994965798985, 134.75676432848007, 218.09965294010698, 90.77962512856335, 162.73874431329156, 193.29549353757798, 174.84812217134348, 238.51544210870097, 136.67984941251, 430.2336226065485, 156.11761568280107, 150.90150126071688, 26.862398189513534, 48.49298224930582, 121.36276065937973, 61.11881653678099, 226.97654484840373, 346.3041166035094, 82.08745242088298, 128.12476522862107, 164.3033229045533, 218.91728811092216, 163.7216665460326, 83.38972151184753, 239.93049403750734, 56.5277798111581, 55.60141658072541, 132.97425806273642, 85.94920440337289, 42.98249824532494, 123.46461613401513, 128.6571800413285, 247.86586520252303, 254.86633683973145, 136.91312458040926, 137.07509338622145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6298046192772244, "mean_inference_ms": 1.9529485346286861, "mean_action_processing_ms": 0.2678015838850507, "mean_env_wait_ms": 0.237801602411836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003733038902282715, "StateBufferConnector_ms": 0.0030194520950317383, "ViewRequirementAgentConnector_ms": 0.09571540355682373}, "num_episodes": 18, "episode_return_max": 408.0239502816915, "episode_return_min": 137.5214264335842, "episode_return_mean": 355.4594315960499, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.56404452742396, "num_env_steps_trained_throughput_per_sec": 365.56404452742396, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 12088.636, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12088.595, "sample_time_ms": 1701.871, "learn_time_ms": 10368.781, "learn_throughput": 385.773, "synch_weights_time_ms": 15.328}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-12", "timestamp": 1723778652, "time_this_iter_s": 10.948631048202515, "time_total_s": 462.52586817741394, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72fee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 462.52586817741394, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 30.89375, "ram_util_percent": 82.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7552998166235665, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.006585394642341, "policy_loss": -0.006413786908828471, "vf_loss": 9.010863193128476, "vf_explained_var": 0.15616900327975158, "kl": 0.006328820283655931, "entropy": 1.177021474876101, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.200003567259148, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.944360678536551, "policy_loss": -0.0075027891897926574, "vf_loss": 8.95064994746415, "vf_explained_var": 0.011400468324227309, "kl": 0.016180306736003357, "entropy": 1.444380243808504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 408.0239502816915, "episode_reward_min": 137.5214264335842, "episode_reward_mean": 356.8035598521887, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -303.726352108639, "predator_policy": 1.0267264134488954}, "policy_reward_max": {"prey_policy": 193.59007952332627, "predator_policy": 430.2336226065485}, "policy_reward_mean": {"prey_policy": 75.26435105873817, "predator_policy": 103.13742886735614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.87852334177404, 367.0047261526466, 331.3515644712532, 390.6633360538942, 339.30010420874675, 390.11968159785613, 382.29735868258035, 359.23027367094073, 378.98878399828726, 346.6893248090003, 391.11566800996627, 386.0352535224013, 404.16856821837456, 387.53525637706787, 307.7489595370788, 399.3990873927103, 323.3891082254453, 334.10418310397154, 392.45108246100045, 368.5287026997455, 343.9658679740371, 371.2122040745952, 359.6663437277392, 390.90165473742763, 299.2802010662871, 378.85674743448266, 362.1166525439651, 387.8087210461586, 370.09162245411886, 348.1669221516237, 380.36721259520493, 319.5298592772586, 340.287816364944, 312.47948748458356, 372.81996138775827, 369.39564597875676, 384.6810549772716, 392.6802309993, 378.4084458342374, 385.5821306185182, 354.788185699495, 324.2057996746794, 390.0465328767305, 312.6301192273642, 337.2733878600419, 285.3054026828249, 382.43789607470126, 382.8962343998148, 336.0206716344253, 137.5214264335842, 307.175502200145, 341.07432067521546, 306.56418605922073, 193.5584620335212, 353.92204899737743, 321.6178852607249, 298.7562411550015, 386.6245310214618, 331.7456722819959, 325.5800279350974, 337.39540398497564, 388.5186378785447, 394.8570417659812, 391.1198290577926, 311.4219563727716, 362.37295718279734, 300.1976365885255, 384.9827145289092, 408.0239502816915, 335.20462739651913, 358.14238363599065, 373.9797400813672, 374.9959182993502, 370.32958395313324, 378.90218604382386, 348.9511142983846, 347.3462419993167, 369.63361034644754, 364.599107036704, 366.16791651203266, 326.8858434797815, 365.6033793623033, 396.0180301231984, 364.3833401049954, 334.00313888085196, 382.99539707518744, 383.0924992296434, 364.74695264562524, 390.5689256880664, 378.7776040168983, 322.99093848150636, 357.36431448989396, 377.9387909257437, 365.49988609556203, 382.7667180607363, 400.11880815682787, 349.053752061856, 372.77637474157086, 372.8637888662967, 385.72208204082614], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.91597208923122, 188.3792320972204, 113.09108087675739, 137.01805468433957, 96.66824774192295, 97.66789406953811, 192.57866943624845, 162.634329178314, 72.72862801867352, 59.60572960182031, 150.42225001952485, 160.38909195686344, 144.30741270916937, 150.2647694840827, 118.28413779647005, 43.08420818334101, 72.83778208286058, -3.501878856304004, 4.411311361976795, 72.74816186150788, 53.217563370610975, 63.56930007953571, 167.27753700410284, 154.5997991164369, 169.33937601520532, 181.85756672978184, 162.96967460316523, 170.71359700789228, 30.98763036459028, -4.947901034510768, 98.37241926968207, 73.03295115219446, 155.48532315537236, 123.82328302866722, 99.9689557442279, 107.30711577999823, 179.33006459006344, 193.59007952332627, 106.88039888033032, 127.14384081973144, 92.08946957482465, 96.22273916802638, 78.48821128795568, 90.8548303337778, 75.70640462414002, 139.8844939632034, 157.35721118815022, 160.6601866261593, 120.68768800812903, 53.40241713704132, 138.9247313569365, 165.8338304095422, 70.20280026009266, 82.55319389957039, 52.91169114201777, 30.36151426988248, 68.6221490881434, 83.25944552891374, 128.81038369715705, 165.5170063842402, 94.25281189348686, 92.63759065207172, 74.8584865960191, 84.63854270754697, 73.1618923175172, 132.22170300657504, 84.51694448156766, 71.32699032958953, -265.51644144353196, -1.8427852237134303, 164.71319052463056, 160.36026057283263, -22.733713285848946, 38.23577190220594, 185.19365662700577, 176.0915691867529, 135.5377869189307, 126.14729321405571, 167.18805513911045, 182.23475688033068, 144.70912100292506, 137.4881372521275, 72.4552476553305, 90.0011983413913, 156.24401404048757, 145.41506798250327, 63.07368281311113, 42.60234589994773, 76.87152565699016, 2.6044672010818344, -33.45705458786475, 55.52378199269435, 159.7571134802573, 140.9380508295203, 172.16826684372822, 152.6158456472395, -118.99169639637745, 0.18427930545655258, 50.95488683845155, -5.232941825063776, 73.6290391433785, 41.85887277369, 80.87947449238773, 132.57101788849755, 47.937043495642826, 104.1703536714558, -24.768964374226556, 29.294580044414626, 107.1243627429022, 77.24319534473186, -114.04040140307552, 89.11341420358426, 10.771656691596654, 95.45608676832819, 149.33332546409108, 179.48468184636548, 113.07492399889645, 78.88589437597518, 67.40613208372962, 21.22923901468187, 148.49357282528808, 146.70405653299719, 131.7268778986396, 143.24142715369166, 48.704918863822485, 58.124174987556984, 139.66416460196587, 98.31937222734776, 7.331557665279083, 84.98368472102251, 19.263421829729623, 34.230257284397574, 38.43673070456712, -94.273331966911, 60.64325959916603, -89.02410935030136, 98.70858621104277, -257.598107948411, 12.943005118240386, 15.242505334761194, 121.52183527715705, 161.26516792001422, 80.21451142406764, 111.2836514611389, 105.4416089560765, -303.726352108639, 93.56158618158629, 66.55578012204282, 24.373403487666245, -28.691828459317726, 47.7670987845811, 54.072627455923524, 42.71752740036801, 8.170440750283301, 86.61957085180626, 94.43836485117961, 96.94203112114886, 138.7253732668571, 47.045490982237204, 67.00062935445146, -233.84150451608014, 57.99514595360764, 41.01057160716029, 50.60458978851196, 7.176627678992686, 16.623611683516195, 67.16470292554249, 28.964953123196224, 104.82346213714948, 42.76832516388423, 51.07511248554135, 16.427329053520285, 129.48969872663986, 122.22208912992463, 50.29540003910683, 28.72264639842688, 3.813041754199207, 18.387273092668373, 56.836017218126976, 43.193723145082984, -16.439699015213925, 51.16441675447011, 83.31009052270068, 89.0089840472032, -20.05478156888632, 72.1993204284801, -1.5140663352974755, -37.87763036840282, 135.07027081694196, 126.12116729482993, 77.70868243847937, 66.2530148715402, 64.24560821805268, -13.825988326755025, 120.23433007577528, 91.4128090229088, -7.730664274437504, 80.3202724509303, 84.5443768784183, 71.5946490726701], "policy_predator_policy_reward": [21.642806906926097, 38.9405122483958, 24.08663143494781, 92.80895915660187, 122.86265616975288, 14.152766490039044, 17.983883059097465, 17.466454380234367, 182.52814979060108, 24.437596797651757, 32.05540656386141, 47.25293305760628, 34.74551346429848, 52.97966302502954, 32.36895649191193, 165.4929711992179, 126.96173825550967, 182.69114251622034, 113.73901532082628, 155.79083626468915, 138.0543724490921, 136.27443211072773, 43.79017034523919, 20.36774705662287, 14.985707805352693, 37.98591766803525, 23.763837664416904, 30.088147101593556, 59.21499773380809, 222.49423247319106, 133.82903487069487, 94.16468210013873, 10.733456981619893, 33.347045059786026, 20.58968260107446, 106.23842897867111, 3.499778240750853, 16.03116010685965, 88.25151184053027, 46.252951159153646, 130.62746385283745, 25.02619537834871, 134.493573253235, 67.37558919962713, 38.43681011466099, 105.63863502573442, 50.37333315132003, 22.510923771797977, 2.515154965563714, 122.67494095555315, 31.347745389212005, 42.75044027879194, 117.48908674547988, 91.87157163882233, 177.78066076738838, 126.75485486686988, 39.11945517074442, 179.09057266631788, 26.16045802736226, 27.679074042864805, 115.55800428831449, 77.9188057613313, 146.80485255302594, 13.227977420666788, 102.78984064556671, 32.114380395284655, 148.457737619634, 8.177815053792289, 253.10818760933648, 387.0710004456677, 28.35982372535966, 15.962371155934216, 177.13229781604872, 192.04669854486548, 16.679569453970075, 14.715435731571231, 83.9030968669246, 32.82026883432603, 1.0267264134488954, 35.132592185628425, 56.53448490523989, 16.056442539202674, 146.41346256757976, 15.335891110377899, 37.114766660297384, 51.27268419344205, 92.32878622472585, 114.62530428957939, 127.26331102675032, 130.53408397521954, 105.32524696618529, 157.91342831180953, 61.77821677227867, 19.964514992645253, 27.71564603718663, 30.396475871660115, 196.5656415689333, 258.2624471564134, 47.70299811842904, 44.09648330176709, 118.1586566961712, 73.52893358690525, 112.22185717500811, 15.401971119322388, 9.833809956431763, 144.6229789356901, 107.87554472884887, 81.15730163448492, 60.663915033819556, 108.890575875924, 261.67892192329134, 84.86595053692477, 143.46570167974733, 49.06279601532904, 28.480649189821445, 29.325874521183966, 118.41507967861095, 21.369774228513805, 74.01553817223211, 162.92911866445417, 16.878366155906864, 25.31940847078371, 73.04006677373263, 40.51026605248078, 162.83165478090046, 125.19629313370159, 78.0166163041944, 75.11967592428398, 84.34994965798985, 134.75676432848007, 218.09965294010698, 90.77962512856335, 162.73874431329156, 193.29549353757798, 174.84812217134348, 238.51544210870097, 136.67984941251, 430.2336226065485, 156.11761568280107, 150.90150126071688, 26.862398189513534, 48.49298224930582, 121.36276065937973, 61.11881653678099, 226.97654484840373, 346.3041166035094, 82.08745242088298, 128.12476522862107, 164.3033229045533, 218.91728811092216, 163.7216665460326, 83.38972151184753, 239.93049403750734, 56.5277798111581, 55.60141658072541, 132.97425806273642, 85.94920440337289, 42.98249824532494, 123.46461613401513, 128.6571800413285, 247.86586520252303, 254.86633683973145, 136.91312458040926, 137.07509338622145, 167.34036705081877, 204.87742370987107, 160.45337799875645, 107.80030605750038, 122.51120691363204, 63.900144666186044, 182.11005344175308, 133.38290209437346, 71.72512032009166, 59.655591052986935, 118.50742167159342, 167.2214845364982, 178.0470873515304, 190.32152348966773, 107.43440391536694, 171.31345973832134, 139.64779392399527, 148.6184268182551, 59.50203992698548, 125.54319999300436, 124.38475669587717, 201.4094953702726, 193.68185779805094, 211.20972500121093, 67.21736811459294, 54.3579118343714, 131.42575161754968, 124.73135922925849, 138.26279922869185, 160.37133294186683, 69.19274396025797, 91.93649168262941, 120.49741597287668, 179.77676471692695, 120.7330322740357, 108.85002381570202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6289377067780094, "mean_inference_ms": 1.951138963568963, "mean_action_processing_ms": 0.2671427106708188, "mean_env_wait_ms": 0.23751796222441401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037456750869750977, "StateBufferConnector_ms": 0.0030394792556762695, "ViewRequirementAgentConnector_ms": 0.09586834907531738}, "num_episodes": 18, "episode_return_max": 408.0239502816915, "episode_return_min": 137.5214264335842, "episode_return_mean": 356.8035598521887, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 374.68886785945443, "num_env_steps_trained_throughput_per_sec": 374.68886785945443, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 11910.265, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11910.224, "sample_time_ms": 1701.513, "learn_time_ms": 10190.997, "learn_throughput": 392.503, "synch_weights_time_ms": 15.376}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-23", "timestamp": 1723778663, "time_this_iter_s": 10.680292129516602, "time_total_s": 473.20616030693054, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72feee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 473.20616030693054, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 30.073333333333334, "ram_util_percent": 81.92666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8790247130961646, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.879594994852782, "policy_loss": -0.002608894067200482, "vf_loss": 8.879389363243467, "vf_explained_var": 0.059721851380413804, "kl": 0.008339243254979598, "entropy": 1.1842933135057883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8877887845354735, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.760267027597578, "policy_loss": -0.0008037627516954979, "vf_loss": 8.760115269252232, "vf_explained_var": 0.06342765023468663, "kl": 0.01274031286906588, "entropy": 1.4523757495577374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 408.0239502816915, "episode_reward_min": 137.5214264335842, "episode_reward_mean": 352.47902691068396, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -303.726352108639, "predator_policy": 1.0267264134488954}, "policy_reward_max": {"prey_policy": 193.59007952332627, "predator_policy": 430.2336226065485}, "policy_reward_mean": {"prey_policy": 65.12899428672675, "predator_policy": 111.11051916861524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.45108246100045, 368.5287026997455, 343.9658679740371, 371.2122040745952, 359.6663437277392, 390.90165473742763, 299.2802010662871, 378.85674743448266, 362.1166525439651, 387.8087210461586, 370.09162245411886, 348.1669221516237, 380.36721259520493, 319.5298592772586, 340.287816364944, 312.47948748458356, 372.81996138775827, 369.39564597875676, 384.6810549772716, 392.6802309993, 378.4084458342374, 385.5821306185182, 354.788185699495, 324.2057996746794, 390.0465328767305, 312.6301192273642, 337.2733878600419, 285.3054026828249, 382.43789607470126, 382.8962343998148, 336.0206716344253, 137.5214264335842, 307.175502200145, 341.07432067521546, 306.56418605922073, 193.5584620335212, 353.92204899737743, 321.6178852607249, 298.7562411550015, 386.6245310214618, 331.7456722819959, 325.5800279350974, 337.39540398497564, 388.5186378785447, 394.8570417659812, 391.1198290577926, 311.4219563727716, 362.37295718279734, 300.1976365885255, 384.9827145289092, 408.0239502816915, 335.20462739651913, 358.14238363599065, 373.9797400813672, 374.9959182993502, 370.32958395313324, 378.90218604382386, 348.9511142983846, 347.3462419993167, 369.63361034644754, 364.599107036704, 366.16791651203266, 326.8858434797815, 365.6033793623033, 396.0180301231984, 364.3833401049954, 334.00313888085196, 382.99539707518744, 383.0924992296434, 364.74695264562524, 390.5689256880664, 378.7776040168983, 322.99093848150636, 357.36431448989396, 377.9387909257437, 365.49988609556203, 382.7667180607363, 400.11880815682787, 349.053752061856, 372.77637474157086, 372.8637888662967, 385.72208204082614, 333.8451132933073, 329.38458346629943, 359.20513697162477, 287.00836248940846, 391.53683594268756, 383.28476908097383, 362.4120782748208, 369.00869175366716, 351.0825764612392, 349.0864578160309, 338.4612864962467, 398.0375994367907, 366.5793227596898, 357.45253962750394, 355.63246857286634, 200.9778039937592, 375.72322192177523, 278.8476188648377], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.33006459006344, 193.59007952332627, 106.88039888033032, 127.14384081973144, 92.08946957482465, 96.22273916802638, 78.48821128795568, 90.8548303337778, 75.70640462414002, 139.8844939632034, 157.35721118815022, 160.6601866261593, 120.68768800812903, 53.40241713704132, 138.9247313569365, 165.8338304095422, 70.20280026009266, 82.55319389957039, 52.91169114201777, 30.36151426988248, 68.6221490881434, 83.25944552891374, 128.81038369715705, 165.5170063842402, 94.25281189348686, 92.63759065207172, 74.8584865960191, 84.63854270754697, 73.1618923175172, 132.22170300657504, 84.51694448156766, 71.32699032958953, -265.51644144353196, -1.8427852237134303, 164.71319052463056, 160.36026057283263, -22.733713285848946, 38.23577190220594, 185.19365662700577, 176.0915691867529, 135.5377869189307, 126.14729321405571, 167.18805513911045, 182.23475688033068, 144.70912100292506, 137.4881372521275, 72.4552476553305, 90.0011983413913, 156.24401404048757, 145.41506798250327, 63.07368281311113, 42.60234589994773, 76.87152565699016, 2.6044672010818344, -33.45705458786475, 55.52378199269435, 159.7571134802573, 140.9380508295203, 172.16826684372822, 152.6158456472395, -118.99169639637745, 0.18427930545655258, 50.95488683845155, -5.232941825063776, 73.6290391433785, 41.85887277369, 80.87947449238773, 132.57101788849755, 47.937043495642826, 104.1703536714558, -24.768964374226556, 29.294580044414626, 107.1243627429022, 77.24319534473186, -114.04040140307552, 89.11341420358426, 10.771656691596654, 95.45608676832819, 149.33332546409108, 179.48468184636548, 113.07492399889645, 78.88589437597518, 67.40613208372962, 21.22923901468187, 148.49357282528808, 146.70405653299719, 131.7268778986396, 143.24142715369166, 48.704918863822485, 58.124174987556984, 139.66416460196587, 98.31937222734776, 7.331557665279083, 84.98368472102251, 19.263421829729623, 34.230257284397574, 38.43673070456712, -94.273331966911, 60.64325959916603, -89.02410935030136, 98.70858621104277, -257.598107948411, 12.943005118240386, 15.242505334761194, 121.52183527715705, 161.26516792001422, 80.21451142406764, 111.2836514611389, 105.4416089560765, -303.726352108639, 93.56158618158629, 66.55578012204282, 24.373403487666245, -28.691828459317726, 47.7670987845811, 54.072627455923524, 42.71752740036801, 8.170440750283301, 86.61957085180626, 94.43836485117961, 96.94203112114886, 138.7253732668571, 47.045490982237204, 67.00062935445146, -233.84150451608014, 57.99514595360764, 41.01057160716029, 50.60458978851196, 7.176627678992686, 16.623611683516195, 67.16470292554249, 28.964953123196224, 104.82346213714948, 42.76832516388423, 51.07511248554135, 16.427329053520285, 129.48969872663986, 122.22208912992463, 50.29540003910683, 28.72264639842688, 3.813041754199207, 18.387273092668373, 56.836017218126976, 43.193723145082984, -16.439699015213925, 51.16441675447011, 83.31009052270068, 89.0089840472032, -20.05478156888632, 72.1993204284801, -1.5140663352974755, -37.87763036840282, 135.07027081694196, 126.12116729482993, 77.70868243847937, 66.2530148715402, 64.24560821805268, -13.825988326755025, 120.23433007577528, 91.4128090229088, -7.730664274437504, 80.3202724509303, 84.5443768784183, 71.5946490726701, 111.98255555574634, 119.846235063131, -28.61144261725731, -22.874037968742094, 110.77373360425942, 100.68179827054412, 8.244949866164573, 41.606911104460465, 136.7522702402434, 156.47153829404746, 91.06778963476037, 45.52027253435985, 86.71819911074948, 78.22827902056454, 108.28830650199521, -85.17246709168101, 0.6992891396567485, 48.219489894810934, 13.988095160182214, 29.354295896290665, 44.9133961892463, 29.834774623903634, 56.79709702217756, 74.54678657278707, 136.25277329926013, 129.65213130831484, -33.692895923574135, 50.56731667354981, 60.16264936609988, 83.25153893234291, -16.358410545133605, 37.28398978872542, 37.31472013897678, 67.69922801697197, 4.076594675255448, 51.95017002503423], "policy_predator_policy_reward": [3.499778240750853, 16.03116010685965, 88.25151184053027, 46.252951159153646, 130.62746385283745, 25.02619537834871, 134.493573253235, 67.37558919962713, 38.43681011466099, 105.63863502573442, 50.37333315132003, 22.510923771797977, 2.515154965563714, 122.67494095555315, 31.347745389212005, 42.75044027879194, 117.48908674547988, 91.87157163882233, 177.78066076738838, 126.75485486686988, 39.11945517074442, 179.09057266631788, 26.16045802736226, 27.679074042864805, 115.55800428831449, 77.9188057613313, 146.80485255302594, 13.227977420666788, 102.78984064556671, 32.114380395284655, 148.457737619634, 8.177815053792289, 253.10818760933648, 387.0710004456677, 28.35982372535966, 15.962371155934216, 177.13229781604872, 192.04669854486548, 16.679569453970075, 14.715435731571231, 83.9030968669246, 32.82026883432603, 1.0267264134488954, 35.132592185628425, 56.53448490523989, 16.056442539202674, 146.41346256757976, 15.335891110377899, 37.114766660297384, 51.27268419344205, 92.32878622472585, 114.62530428957939, 127.26331102675032, 130.53408397521954, 105.32524696618529, 157.91342831180953, 61.77821677227867, 19.964514992645253, 27.71564603718663, 30.396475871660115, 196.5656415689333, 258.2624471564134, 47.70299811842904, 44.09648330176709, 118.1586566961712, 73.52893358690525, 112.22185717500811, 15.401971119322388, 9.833809956431763, 144.6229789356901, 107.87554472884887, 81.15730163448492, 60.663915033819556, 108.890575875924, 261.67892192329134, 84.86595053692477, 143.46570167974733, 49.06279601532904, 28.480649189821445, 29.325874521183966, 118.41507967861095, 21.369774228513805, 74.01553817223211, 162.92911866445417, 16.878366155906864, 25.31940847078371, 73.04006677373263, 40.51026605248078, 162.83165478090046, 125.19629313370159, 78.0166163041944, 75.11967592428398, 84.34994965798985, 134.75676432848007, 218.09965294010698, 90.77962512856335, 162.73874431329156, 193.29549353757798, 174.84812217134348, 238.51544210870097, 136.67984941251, 430.2336226065485, 156.11761568280107, 150.90150126071688, 26.862398189513534, 48.49298224930582, 121.36276065937973, 61.11881653678099, 226.97654484840373, 346.3041166035094, 82.08745242088298, 128.12476522862107, 164.3033229045533, 218.91728811092216, 163.7216665460326, 83.38972151184753, 239.93049403750734, 56.5277798111581, 55.60141658072541, 132.97425806273642, 85.94920440337289, 42.98249824532494, 123.46461613401513, 128.6571800413285, 247.86586520252303, 254.86633683973145, 136.91312458040926, 137.07509338622145, 167.34036705081877, 204.87742370987107, 160.45337799875645, 107.80030605750038, 122.51120691363204, 63.900144666186044, 182.11005344175308, 133.38290209437346, 71.72512032009166, 59.655591052986935, 118.50742167159342, 167.2214845364982, 178.0470873515304, 190.32152348966773, 107.43440391536694, 171.31345973832134, 139.64779392399527, 148.6184268182551, 59.50203992698548, 125.54319999300436, 124.38475669587717, 201.4094953702726, 193.68185779805094, 211.20972500121093, 67.21736811459294, 54.3579118343714, 131.42575161754968, 124.73135922925849, 138.26279922869185, 160.37133294186683, 69.19274396025797, 91.93649168262941, 120.49741597287668, 179.77676471692695, 120.7330322740357, 108.85002381570202, 28.531791049371574, 73.48453162505874, 204.0495088886264, 176.82055516367285, 93.10279471556662, 54.64681038125424, 140.29561882123548, 96.86088269754863, 50.64176789482163, 47.67125951357572, 152.63756252745955, 94.0591443843938, 73.35868274098698, 124.10691740251958, 173.84687104161458, 172.04598130173815, 164.16261805682802, 138.00117936994386, 100.02633956559617, 205.71772719396174, 157.99524012414543, 105.71787555895098, 125.98200306775041, 140.7117127740748, 52.18468475641533, 48.48973339569963, 150.34318603564532, 190.23493284188274, 102.28385755372011, 109.9344227207036, 124.33943093733609, 55.71279381283122, 128.06392370762197, 142.64535005820423, 132.05480834315134, 90.76604582139659]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6279831143822328, "mean_inference_ms": 1.948830574445508, "mean_action_processing_ms": 0.26644084993046385, "mean_env_wait_ms": 0.23718531762988454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037772655487060547, "StateBufferConnector_ms": 0.0030710697174072266, "ViewRequirementAgentConnector_ms": 0.09453475475311279}, "num_episodes": 18, "episode_return_max": 408.0239502816915, "episode_return_min": 137.5214264335842, "episode_return_mean": 352.47902691068396, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 377.2416125532304, "num_env_steps_trained_throughput_per_sec": 377.2416125532304, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 11813.356, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11813.315, "sample_time_ms": 1699.898, "learn_time_ms": 10095.658, "learn_throughput": 396.21, "synch_weights_time_ms": 15.559}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-34", "timestamp": 1723778674, "time_this_iter_s": 10.611125707626343, "time_total_s": 483.8172860145569, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 483.8172860145569, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 30.426666666666666, "ram_util_percent": 81.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1651890028090706, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.849221893088528, "policy_loss": -0.004560200714323887, "vf_loss": 8.85131741654936, "vf_explained_var": -0.1447831428870953, "kl": 0.007302712768532542, "entropy": 1.169112018681077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7121471766756957, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.983788728209399, "policy_loss": -0.007317058136686682, "vf_loss": 8.989737811416544, "vf_explained_var": 0.10796926034190667, "kl": 0.01823978391787225, "entropy": 1.4310569238410424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 409.5378842680131, "episode_reward_min": 137.5214264335842, "episode_reward_mean": 346.2299145507563, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -303.726352108639, "predator_policy": 9.833809956431763}, "policy_reward_max": {"prey_policy": 179.48468184636548, "predator_policy": 430.2336226065485}, "policy_reward_mean": {"prey_policy": 53.759075722470406, "predator_policy": 119.35588155290775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.788185699495, 324.2057996746794, 390.0465328767305, 312.6301192273642, 337.2733878600419, 285.3054026828249, 382.43789607470126, 382.8962343998148, 336.0206716344253, 137.5214264335842, 307.175502200145, 341.07432067521546, 306.56418605922073, 193.5584620335212, 353.92204899737743, 321.6178852607249, 298.7562411550015, 386.6245310214618, 331.7456722819959, 325.5800279350974, 337.39540398497564, 388.5186378785447, 394.8570417659812, 391.1198290577926, 311.4219563727716, 362.37295718279734, 300.1976365885255, 384.9827145289092, 408.0239502816915, 335.20462739651913, 358.14238363599065, 373.9797400813672, 374.9959182993502, 370.32958395313324, 378.90218604382386, 348.9511142983846, 347.3462419993167, 369.63361034644754, 364.599107036704, 366.16791651203266, 326.8858434797815, 365.6033793623033, 396.0180301231984, 364.3833401049954, 334.00313888085196, 382.99539707518744, 383.0924992296434, 364.74695264562524, 390.5689256880664, 378.7776040168983, 322.99093848150636, 357.36431448989396, 377.9387909257437, 365.49988609556203, 382.7667180607363, 400.11880815682787, 349.053752061856, 372.77637474157086, 372.8637888662967, 385.72208204082614, 333.8451132933073, 329.38458346629943, 359.20513697162477, 287.00836248940846, 391.53683594268756, 383.28476908097383, 362.4120782748208, 369.00869175366716, 351.0825764612392, 349.0864578160309, 338.4612864962467, 398.0375994367907, 366.5793227596898, 357.45253962750394, 355.63246857286634, 200.9778039937592, 375.72322192177523, 278.8476188648377, 378.1907061656957, 302.2235981811351, 318.0015724472004, 265.1930622967976, 348.16210490044, 349.1006481197036, 352.3161669327283, 364.5902438658825, 289.39588460823813, 251.68224891023073, 372.92101639363756, 344.5203169159771, 340.5273157094263, 375.16508491691155, 317.8506611158716, 300.9345650321151, 321.64251003480587, 388.1365612014935, 343.3127649791498, 340.12857321264744, 409.5378842680131, 310.8338416881428], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.70912100292506, 137.4881372521275, 72.4552476553305, 90.0011983413913, 156.24401404048757, 145.41506798250327, 63.07368281311113, 42.60234589994773, 76.87152565699016, 2.6044672010818344, -33.45705458786475, 55.52378199269435, 159.7571134802573, 140.9380508295203, 172.16826684372822, 152.6158456472395, -118.99169639637745, 0.18427930545655258, 50.95488683845155, -5.232941825063776, 73.6290391433785, 41.85887277369, 80.87947449238773, 132.57101788849755, 47.937043495642826, 104.1703536714558, -24.768964374226556, 29.294580044414626, 107.1243627429022, 77.24319534473186, -114.04040140307552, 89.11341420358426, 10.771656691596654, 95.45608676832819, 149.33332546409108, 179.48468184636548, 113.07492399889645, 78.88589437597518, 67.40613208372962, 21.22923901468187, 148.49357282528808, 146.70405653299719, 131.7268778986396, 143.24142715369166, 48.704918863822485, 58.124174987556984, 139.66416460196587, 98.31937222734776, 7.331557665279083, 84.98368472102251, 19.263421829729623, 34.230257284397574, 38.43673070456712, -94.273331966911, 60.64325959916603, -89.02410935030136, 98.70858621104277, -257.598107948411, 12.943005118240386, 15.242505334761194, 121.52183527715705, 161.26516792001422, 80.21451142406764, 111.2836514611389, 105.4416089560765, -303.726352108639, 93.56158618158629, 66.55578012204282, 24.373403487666245, -28.691828459317726, 47.7670987845811, 54.072627455923524, 42.71752740036801, 8.170440750283301, 86.61957085180626, 94.43836485117961, 96.94203112114886, 138.7253732668571, 47.045490982237204, 67.00062935445146, -233.84150451608014, 57.99514595360764, 41.01057160716029, 50.60458978851196, 7.176627678992686, 16.623611683516195, 67.16470292554249, 28.964953123196224, 104.82346213714948, 42.76832516388423, 51.07511248554135, 16.427329053520285, 129.48969872663986, 122.22208912992463, 50.29540003910683, 28.72264639842688, 3.813041754199207, 18.387273092668373, 56.836017218126976, 43.193723145082984, -16.439699015213925, 51.16441675447011, 83.31009052270068, 89.0089840472032, -20.05478156888632, 72.1993204284801, -1.5140663352974755, -37.87763036840282, 135.07027081694196, 126.12116729482993, 77.70868243847937, 66.2530148715402, 64.24560821805268, -13.825988326755025, 120.23433007577528, 91.4128090229088, -7.730664274437504, 80.3202724509303, 84.5443768784183, 71.5946490726701, 111.98255555574634, 119.846235063131, -28.61144261725731, -22.874037968742094, 110.77373360425942, 100.68179827054412, 8.244949866164573, 41.606911104460465, 136.7522702402434, 156.47153829404746, 91.06778963476037, 45.52027253435985, 86.71819911074948, 78.22827902056454, 108.28830650199521, -85.17246709168101, 0.6992891396567485, 48.219489894810934, 13.988095160182214, 29.354295896290665, 44.9133961892463, 29.834774623903634, 56.79709702217756, 74.54678657278707, 136.25277329926013, 129.65213130831484, -33.692895923574135, 50.56731667354981, 60.16264936609988, 83.25153893234291, -16.358410545133605, 37.28398978872542, 37.31472013897678, 67.69922801697197, 4.076594675255448, 51.95017002503423, 55.823928429189976, 56.23019149873461, 25.671078497677655, 64.9126330868451, 3.8539328319116626, 69.8462523230188, 99.19852274494828, -23.020341420306877, 76.83444206159577, 38.19855812162105, 35.661375106450976, 59.42501766836736, 80.28376123965943, 100.58662093268676, 48.711530875397344, 21.320510214826772, 66.63140228313297, 49.60291812261333, 31.381556707134735, -8.95979321980925, 74.08825018733685, 103.64504010226692, 32.195358514735496, 28.14770588009947, 51.88820991405497, 32.02109704327192, 57.512081449000284, 81.26622779708474, -30.40671715635215, 73.34858292808171, 9.163194636532362, 59.61134038501156, 41.80178093992962, 63.17702096911065, 114.91046402782553, 71.1144548100277, 80.81218420116458, -9.568427836373226, 47.7225670775718, 7.866223595347524, 68.23182274270248, 73.16637965129465, 42.31152737133258, 12.31496457046749], "policy_predator_policy_reward": [56.53448490523989, 16.056442539202674, 146.41346256757976, 15.335891110377899, 37.114766660297384, 51.27268419344205, 92.32878622472585, 114.62530428957939, 127.26331102675032, 130.53408397521954, 105.32524696618529, 157.91342831180953, 61.77821677227867, 19.964514992645253, 27.71564603718663, 30.396475871660115, 196.5656415689333, 258.2624471564134, 47.70299811842904, 44.09648330176709, 118.1586566961712, 73.52893358690525, 112.22185717500811, 15.401971119322388, 9.833809956431763, 144.6229789356901, 107.87554472884887, 81.15730163448492, 60.663915033819556, 108.890575875924, 261.67892192329134, 84.86595053692477, 143.46570167974733, 49.06279601532904, 28.480649189821445, 29.325874521183966, 118.41507967861095, 21.369774228513805, 74.01553817223211, 162.92911866445417, 16.878366155906864, 25.31940847078371, 73.04006677373263, 40.51026605248078, 162.83165478090046, 125.19629313370159, 78.0166163041944, 75.11967592428398, 84.34994965798985, 134.75676432848007, 218.09965294010698, 90.77962512856335, 162.73874431329156, 193.29549353757798, 174.84812217134348, 238.51544210870097, 136.67984941251, 430.2336226065485, 156.11761568280107, 150.90150126071688, 26.862398189513534, 48.49298224930582, 121.36276065937973, 61.11881653678099, 226.97654484840373, 346.3041166035094, 82.08745242088298, 128.12476522862107, 164.3033229045533, 218.91728811092216, 163.7216665460326, 83.38972151184753, 239.93049403750734, 56.5277798111581, 55.60141658072541, 132.97425806273642, 85.94920440337289, 42.98249824532494, 123.46461613401513, 128.6571800413285, 247.86586520252303, 254.86633683973145, 136.91312458040926, 137.07509338622145, 167.34036705081877, 204.87742370987107, 160.45337799875645, 107.80030605750038, 122.51120691363204, 63.900144666186044, 182.11005344175308, 133.38290209437346, 71.72512032009166, 59.655591052986935, 118.50742167159342, 167.2214845364982, 178.0470873515304, 190.32152348966773, 107.43440391536694, 171.31345973832134, 139.64779392399527, 148.6184268182551, 59.50203992698548, 125.54319999300436, 124.38475669587717, 201.4094953702726, 193.68185779805094, 211.20972500121093, 67.21736811459294, 54.3579118343714, 131.42575161754968, 124.73135922925849, 138.26279922869185, 160.37133294186683, 69.19274396025797, 91.93649168262941, 120.49741597287668, 179.77676471692695, 120.7330322740357, 108.85002381570202, 28.531791049371574, 73.48453162505874, 204.0495088886264, 176.82055516367285, 93.10279471556662, 54.64681038125424, 140.29561882123548, 96.86088269754863, 50.64176789482163, 47.67125951357572, 152.63756252745955, 94.0591443843938, 73.35868274098698, 124.10691740251958, 173.84687104161458, 172.04598130173815, 164.16261805682802, 138.00117936994386, 100.02633956559617, 205.71772719396174, 157.99524012414543, 105.71787555895098, 125.98200306775041, 140.7117127740748, 52.18468475641533, 48.48973339569963, 150.34318603564532, 190.23493284188274, 102.28385755372011, 109.9344227207036, 124.33943093733609, 55.71279381283122, 128.06392370762197, 142.64535005820423, 132.05480834315134, 90.76604582139659, 157.21090296044667, 108.92568327732522, 107.93131269502015, 103.70857390159205, 126.61466002841605, 117.68672726385354, 80.09487330221008, 108.92000766994623, 91.03509667794341, 142.0940080392799, 113.1038014896066, 140.91045385527897, 101.72278091597045, 69.72300384441145, 166.96677464037646, 127.59142813528186, 95.75088265605918, 77.41068154643284, 132.62485967468356, 96.63562574822208, 95.35470098538052, 99.83302511865323, 121.98970040415045, 162.18755211699133, 98.5987961459097, 158.01921260618974, 127.65642190348512, 108.73035376734167, 179.81640642906459, 95.09238891507742, 119.22485031885434, 112.93517969171666, 86.64030232732202, 130.02340579844363, 109.49203867982034, 92.61960368381949, 115.2897620771876, 156.77924653717088, 132.9946395312976, 151.54514300843047, 120.80061960939295, 147.33906226462295, 90.2432851203484, 165.96406462599458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6270798321897989, "mean_inference_ms": 1.9461124521053206, "mean_action_processing_ms": 0.26569573017286147, "mean_env_wait_ms": 0.23682282211441502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003880023956298828, "StateBufferConnector_ms": 0.00315248966217041, "ViewRequirementAgentConnector_ms": 0.09698963165283203}, "num_episodes": 22, "episode_return_max": 409.5378842680131, "episode_return_min": 137.5214264335842, "episode_return_mean": 346.2299145507563, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.2106212006288, "num_env_steps_trained_throughput_per_sec": 360.2106212006288, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 11512.445, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11512.406, "sample_time_ms": 1684.751, "learn_time_ms": 9809.955, "learn_throughput": 407.749, "synch_weights_time_ms": 15.546}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-45", "timestamp": 1723778685, "time_this_iter_s": 11.112774133682251, "time_total_s": 494.93006014823914, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 494.93006014823914, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 31.34375, "ram_util_percent": 82.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.040925575942589, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.0756625566533, "policy_loss": -0.004388556052639923, "vf_loss": 8.077815026076383, "vf_explained_var": 0.027692465807395008, "kl": 0.0066254514980007345, "entropy": 1.2047417598426657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.502503297190187, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.22021828656474, "policy_loss": -0.00537321633768943, "vf_loss": 8.224386081746015, "vf_explained_var": 0.01922831342964576, "kl": 0.01607240757600059, "entropy": 1.3775819865484087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 409.5378842680131, "episode_reward_min": 194.19607335143294, "episode_reward_mean": 349.430461619695, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -515.0215983087189, "predator_policy": 26.862398189513534}, "policy_reward_max": {"prey_policy": 161.26516792001422, "predator_policy": 633.5106028481366}, "policy_reward_mean": {"prey_policy": 46.22322305269582, "predator_policy": 128.4920077571516}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.1198290577926, 311.4219563727716, 362.37295718279734, 300.1976365885255, 384.9827145289092, 408.0239502816915, 335.20462739651913, 358.14238363599065, 373.9797400813672, 374.9959182993502, 370.32958395313324, 378.90218604382386, 348.9511142983846, 347.3462419993167, 369.63361034644754, 364.599107036704, 366.16791651203266, 326.8858434797815, 365.6033793623033, 396.0180301231984, 364.3833401049954, 334.00313888085196, 382.99539707518744, 383.0924992296434, 364.74695264562524, 390.5689256880664, 378.7776040168983, 322.99093848150636, 357.36431448989396, 377.9387909257437, 365.49988609556203, 382.7667180607363, 400.11880815682787, 349.053752061856, 372.77637474157086, 372.8637888662967, 385.72208204082614, 333.8451132933073, 329.38458346629943, 359.20513697162477, 287.00836248940846, 391.53683594268756, 383.28476908097383, 362.4120782748208, 369.00869175366716, 351.0825764612392, 349.0864578160309, 338.4612864962467, 398.0375994367907, 366.5793227596898, 357.45253962750394, 355.63246857286634, 200.9778039937592, 375.72322192177523, 278.8476188648377, 378.1907061656957, 302.2235981811351, 318.0015724472004, 265.1930622967976, 348.16210490044, 349.1006481197036, 352.3161669327283, 364.5902438658825, 289.39588460823813, 251.68224891023073, 372.92101639363756, 344.5203169159771, 340.5273157094263, 375.16508491691155, 317.8506611158716, 300.9345650321151, 321.64251003480587, 388.1365612014935, 343.3127649791498, 340.12857321264744, 409.5378842680131, 310.8338416881428, 347.13369030904494, 347.5376836606502, 370.5858826145443, 372.8222804091633, 389.78700915995756, 303.60766490198404, 377.367862475342, 194.19607335143294, 359.61457739765416, 371.5829424336676, 346.8773509700815, 380.5139811760405, 371.4137790037203, 284.9207397698778, 347.60431700414824, 382.9124338106322, 368.7514948700434, 242.6567748400072, 284.830291462386, 376.9160083964428, 350.70824738735325, 356.9650695411901, 321.2641697614211], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [139.66416460196587, 98.31937222734776, 7.331557665279083, 84.98368472102251, 19.263421829729623, 34.230257284397574, 38.43673070456712, -94.273331966911, 60.64325959916603, -89.02410935030136, 98.70858621104277, -257.598107948411, 12.943005118240386, 15.242505334761194, 121.52183527715705, 161.26516792001422, 80.21451142406764, 111.2836514611389, 105.4416089560765, -303.726352108639, 93.56158618158629, 66.55578012204282, 24.373403487666245, -28.691828459317726, 47.7670987845811, 54.072627455923524, 42.71752740036801, 8.170440750283301, 86.61957085180626, 94.43836485117961, 96.94203112114886, 138.7253732668571, 47.045490982237204, 67.00062935445146, -233.84150451608014, 57.99514595360764, 41.01057160716029, 50.60458978851196, 7.176627678992686, 16.623611683516195, 67.16470292554249, 28.964953123196224, 104.82346213714948, 42.76832516388423, 51.07511248554135, 16.427329053520285, 129.48969872663986, 122.22208912992463, 50.29540003910683, 28.72264639842688, 3.813041754199207, 18.387273092668373, 56.836017218126976, 43.193723145082984, -16.439699015213925, 51.16441675447011, 83.31009052270068, 89.0089840472032, -20.05478156888632, 72.1993204284801, -1.5140663352974755, -37.87763036840282, 135.07027081694196, 126.12116729482993, 77.70868243847937, 66.2530148715402, 64.24560821805268, -13.825988326755025, 120.23433007577528, 91.4128090229088, -7.730664274437504, 80.3202724509303, 84.5443768784183, 71.5946490726701, 111.98255555574634, 119.846235063131, -28.61144261725731, -22.874037968742094, 110.77373360425942, 100.68179827054412, 8.244949866164573, 41.606911104460465, 136.7522702402434, 156.47153829404746, 91.06778963476037, 45.52027253435985, 86.71819911074948, 78.22827902056454, 108.28830650199521, -85.17246709168101, 0.6992891396567485, 48.219489894810934, 13.988095160182214, 29.354295896290665, 44.9133961892463, 29.834774623903634, 56.79709702217756, 74.54678657278707, 136.25277329926013, 129.65213130831484, -33.692895923574135, 50.56731667354981, 60.16264936609988, 83.25153893234291, -16.358410545133605, 37.28398978872542, 37.31472013897678, 67.69922801697197, 4.076594675255448, 51.95017002503423, 55.823928429189976, 56.23019149873461, 25.671078497677655, 64.9126330868451, 3.8539328319116626, 69.8462523230188, 99.19852274494828, -23.020341420306877, 76.83444206159577, 38.19855812162105, 35.661375106450976, 59.42501766836736, 80.28376123965943, 100.58662093268676, 48.711530875397344, 21.320510214826772, 66.63140228313297, 49.60291812261333, 31.381556707134735, -8.95979321980925, 74.08825018733685, 103.64504010226692, 32.195358514735496, 28.14770588009947, 51.88820991405497, 32.02109704327192, 57.512081449000284, 81.26622779708474, -30.40671715635215, 73.34858292808171, 9.163194636532362, 59.61134038501156, 41.80178093992962, 63.17702096911065, 114.91046402782553, 71.1144548100277, 80.81218420116458, -9.568427836373226, 47.7225670775718, 7.866223595347524, 68.23182274270248, 73.16637965129465, 42.31152737133258, 12.31496457046749, 56.37577532453895, 119.3732168561757, 114.69968134671305, 67.0996760937696, 68.94021930503253, 96.89797785549402, 27.708280976612063, -73.68538567980164, -332.6993869767052, 84.69082558458781, 80.67888365760217, 77.2733993014068, 64.0521819217548, 113.0895011577527, 52.681091676006744, -1.7926756348556514, 45.626070034901964, 26.491145032703756, 106.40999671997668, 124.9966419237986, 116.93618565949126, 89.16496449495969, 61.15240450263617, 62.974665560280336, 93.38588711326662, 85.20111624892309, 23.563891343282258, -515.0215983087189, 65.21867784316485, 62.3636188579131, 102.20566152465703, 35.950840939201846, 132.39230961363427, 116.44973027825723, -61.28605223471403, 107.65838741860064, -0.6125487789974899, 37.38177237998953, 93.03339270318077, 87.01585040823194, 44.00764230685003, -2.819694984417718, 80.80118117587861, 42.485052677870286, 99.67732186220141, 58.21598546497669], "policy_predator_policy_reward": [78.0166163041944, 75.11967592428398, 84.34994965798985, 134.75676432848007, 218.09965294010698, 90.77962512856335, 162.73874431329156, 193.29549353757798, 174.84812217134348, 238.51544210870097, 136.67984941251, 430.2336226065485, 156.11761568280107, 150.90150126071688, 26.862398189513534, 48.49298224930582, 121.36276065937973, 61.11881653678099, 226.97654484840373, 346.3041166035094, 82.08745242088298, 128.12476522862107, 164.3033229045533, 218.91728811092216, 163.7216665460326, 83.38972151184753, 239.93049403750734, 56.5277798111581, 55.60141658072541, 132.97425806273642, 85.94920440337289, 42.98249824532494, 123.46461613401513, 128.6571800413285, 247.86586520252303, 254.86633683973145, 136.91312458040926, 137.07509338622145, 167.34036705081877, 204.87742370987107, 160.45337799875645, 107.80030605750038, 122.51120691363204, 63.900144666186044, 182.11005344175308, 133.38290209437346, 71.72512032009166, 59.655591052986935, 118.50742167159342, 167.2214845364982, 178.0470873515304, 190.32152348966773, 107.43440391536694, 171.31345973832134, 139.64779392399527, 148.6184268182551, 59.50203992698548, 125.54319999300436, 124.38475669587717, 201.4094953702726, 193.68185779805094, 211.20972500121093, 67.21736811459294, 54.3579118343714, 131.42575161754968, 124.73135922925849, 138.26279922869185, 160.37133294186683, 69.19274396025797, 91.93649168262941, 120.49741597287668, 179.77676471692695, 120.7330322740357, 108.85002381570202, 28.531791049371574, 73.48453162505874, 204.0495088886264, 176.82055516367285, 93.10279471556662, 54.64681038125424, 140.29561882123548, 96.86088269754863, 50.64176789482163, 47.67125951357572, 152.63756252745955, 94.0591443843938, 73.35868274098698, 124.10691740251958, 173.84687104161458, 172.04598130173815, 164.16261805682802, 138.00117936994386, 100.02633956559617, 205.71772719396174, 157.99524012414543, 105.71787555895098, 125.98200306775041, 140.7117127740748, 52.18468475641533, 48.48973339569963, 150.34318603564532, 190.23493284188274, 102.28385755372011, 109.9344227207036, 124.33943093733609, 55.71279381283122, 128.06392370762197, 142.64535005820423, 132.05480834315134, 90.76604582139659, 157.21090296044667, 108.92568327732522, 107.93131269502015, 103.70857390159205, 126.61466002841605, 117.68672726385354, 80.09487330221008, 108.92000766994623, 91.03509667794341, 142.0940080392799, 113.1038014896066, 140.91045385527897, 101.72278091597045, 69.72300384441145, 166.96677464037646, 127.59142813528186, 95.75088265605918, 77.41068154643284, 132.62485967468356, 96.63562574822208, 95.35470098538052, 99.83302511865323, 121.98970040415045, 162.18755211699133, 98.5987961459097, 158.01921260618974, 127.65642190348512, 108.73035376734167, 179.81640642906459, 95.09238891507742, 119.22485031885434, 112.93517969171666, 86.64030232732202, 130.02340579844363, 109.49203867982034, 92.61960368381949, 115.2897620771876, 156.77924653717088, 132.9946395312976, 151.54514300843047, 120.80061960939295, 147.33906226462295, 90.2432851203484, 165.96406462599458, 54.63780064412935, 116.74689748420107, 78.58793599018666, 87.1503902299815, 110.31424637761873, 94.43343907639942, 201.66055962775505, 217.13882548459787, 116.30065709132995, 521.4949134607448, 60.98047099048363, 84.67491095249166, 98.52663696838754, 101.69954242744717, 72.98240338455686, 70.32525392572535, 144.63692164720453, 142.86044068284392, 79.850522079344, 60.32578171054811, 62.01055877937286, 78.76564203625728, 121.38280754515009, 135.00410356797363, 102.77624567344371, 90.05052996808718, 142.86784388717822, 633.5106028481366, 78.5148832458532, 141.50713705721748, 141.5771004039464, 103.17883094282655, 55.566389308449025, 64.34306566970331, 108.72841528425292, 87.55602437186776, 129.88074980764762, 118.1803180537464, 55.49938867869432, 141.3673766063363, 170.72823691949023, 138.79206314543072, 101.48536767576647, 132.19346801167444, 106.2223182151186, 57.14854421912448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6260585237804565, "mean_inference_ms": 1.9433133511115352, "mean_action_processing_ms": 0.26495028519392316, "mean_env_wait_ms": 0.2364576406107415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004489541053771973, "StateBufferConnector_ms": 0.003206968307495117, "ViewRequirementAgentConnector_ms": 0.09703934192657471}, "num_episodes": 23, "episode_return_max": 409.5378842680131, "episode_return_min": 194.19607335143294, "episode_return_mean": 349.430461619695, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.709483969597, "num_env_steps_trained_throughput_per_sec": 369.709483969597, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 11224.629, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11224.591, "sample_time_ms": 1593.707, "learn_time_ms": 9613.636, "learn_throughput": 416.076, "synch_weights_time_ms": 15.482}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "e552a_00000", "date": "2024-08-16_08-54-56", "timestamp": 1723778696, "time_this_iter_s": 10.824815034866333, "time_total_s": 505.75487518310547, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72de3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 505.75487518310547, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 31.306666666666665, "ram_util_percent": 82.86666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.478769779268396, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.194210500565786, "policy_loss": -0.0026529563445519045, "vf_loss": 8.194778873050023, "vf_explained_var": 0.15774652793924646, "kl": 0.006176521457949649, "entropy": 1.1880103703529115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.21390003577742, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.478387528374082, "policy_loss": -0.0078102381983722645, "vf_loss": 8.485143337804804, "vf_explained_var": 0.17670121672292236, "kl": 0.014059053362218995, "entropy": 1.3658968929891233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 409.5378842680131, "episode_reward_min": 99.61135386393121, "episode_reward_mean": 339.64144341085455, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -515.0215983087189, "predator_policy": 9.927693972089658}, "policy_reward_max": {"prey_policy": 156.47153829404746, "predator_policy": 633.5106028481366}, "policy_reward_mean": {"prey_policy": 53.90464511934994, "predator_policy": 115.91607658607737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.6033793623033, 396.0180301231984, 364.3833401049954, 334.00313888085196, 382.99539707518744, 383.0924992296434, 364.74695264562524, 390.5689256880664, 378.7776040168983, 322.99093848150636, 357.36431448989396, 377.9387909257437, 365.49988609556203, 382.7667180607363, 400.11880815682787, 349.053752061856, 372.77637474157086, 372.8637888662967, 385.72208204082614, 333.8451132933073, 329.38458346629943, 359.20513697162477, 287.00836248940846, 391.53683594268756, 383.28476908097383, 362.4120782748208, 369.00869175366716, 351.0825764612392, 349.0864578160309, 338.4612864962467, 398.0375994367907, 366.5793227596898, 357.45253962750394, 355.63246857286634, 200.9778039937592, 375.72322192177523, 278.8476188648377, 378.1907061656957, 302.2235981811351, 318.0015724472004, 265.1930622967976, 348.16210490044, 349.1006481197036, 352.3161669327283, 364.5902438658825, 289.39588460823813, 251.68224891023073, 372.92101639363756, 344.5203169159771, 340.5273157094263, 375.16508491691155, 317.8506611158716, 300.9345650321151, 321.64251003480587, 388.1365612014935, 343.3127649791498, 340.12857321264744, 409.5378842680131, 310.8338416881428, 347.13369030904494, 347.5376836606502, 370.5858826145443, 372.8222804091633, 389.78700915995756, 303.60766490198404, 377.367862475342, 194.19607335143294, 359.61457739765416, 371.5829424336676, 346.8773509700815, 380.5139811760405, 371.4137790037203, 284.9207397698778, 347.60431700414824, 382.9124338106322, 368.7514948700434, 242.6567748400072, 284.830291462386, 376.9160083964428, 350.70824738735325, 356.9650695411901, 321.2641697614211, 330.4363183864011, 175.64035554790487, 283.5553049909657, 342.7447537115316, 300.83464898309495, 225.06691931960177, 375.9606267210479, 358.904182873274, 353.0064366738907, 354.96515583388793, 212.98807482489565, 99.61135386393121, 271.73236230210995, 379.68122035411756, 376.19234545295177, 344.1082862790692, 350.05538877804, 358.8717613145871], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [41.01057160716029, 50.60458978851196, 7.176627678992686, 16.623611683516195, 67.16470292554249, 28.964953123196224, 104.82346213714948, 42.76832516388423, 51.07511248554135, 16.427329053520285, 129.48969872663986, 122.22208912992463, 50.29540003910683, 28.72264639842688, 3.813041754199207, 18.387273092668373, 56.836017218126976, 43.193723145082984, -16.439699015213925, 51.16441675447011, 83.31009052270068, 89.0089840472032, -20.05478156888632, 72.1993204284801, -1.5140663352974755, -37.87763036840282, 135.07027081694196, 126.12116729482993, 77.70868243847937, 66.2530148715402, 64.24560821805268, -13.825988326755025, 120.23433007577528, 91.4128090229088, -7.730664274437504, 80.3202724509303, 84.5443768784183, 71.5946490726701, 111.98255555574634, 119.846235063131, -28.61144261725731, -22.874037968742094, 110.77373360425942, 100.68179827054412, 8.244949866164573, 41.606911104460465, 136.7522702402434, 156.47153829404746, 91.06778963476037, 45.52027253435985, 86.71819911074948, 78.22827902056454, 108.28830650199521, -85.17246709168101, 0.6992891396567485, 48.219489894810934, 13.988095160182214, 29.354295896290665, 44.9133961892463, 29.834774623903634, 56.79709702217756, 74.54678657278707, 136.25277329926013, 129.65213130831484, -33.692895923574135, 50.56731667354981, 60.16264936609988, 83.25153893234291, -16.358410545133605, 37.28398978872542, 37.31472013897678, 67.69922801697197, 4.076594675255448, 51.95017002503423, 55.823928429189976, 56.23019149873461, 25.671078497677655, 64.9126330868451, 3.8539328319116626, 69.8462523230188, 99.19852274494828, -23.020341420306877, 76.83444206159577, 38.19855812162105, 35.661375106450976, 59.42501766836736, 80.28376123965943, 100.58662093268676, 48.711530875397344, 21.320510214826772, 66.63140228313297, 49.60291812261333, 31.381556707134735, -8.95979321980925, 74.08825018733685, 103.64504010226692, 32.195358514735496, 28.14770588009947, 51.88820991405497, 32.02109704327192, 57.512081449000284, 81.26622779708474, -30.40671715635215, 73.34858292808171, 9.163194636532362, 59.61134038501156, 41.80178093992962, 63.17702096911065, 114.91046402782553, 71.1144548100277, 80.81218420116458, -9.568427836373226, 47.7225670775718, 7.866223595347524, 68.23182274270248, 73.16637965129465, 42.31152737133258, 12.31496457046749, 56.37577532453895, 119.3732168561757, 114.69968134671305, 67.0996760937696, 68.94021930503253, 96.89797785549402, 27.708280976612063, -73.68538567980164, -332.6993869767052, 84.69082558458781, 80.67888365760217, 77.2733993014068, 64.0521819217548, 113.0895011577527, 52.681091676006744, -1.7926756348556514, 45.626070034901964, 26.491145032703756, 106.40999671997668, 124.9966419237986, 116.93618565949126, 89.16496449495969, 61.15240450263617, 62.974665560280336, 93.38588711326662, 85.20111624892309, 23.563891343282258, -515.0215983087189, 65.21867784316485, 62.3636188579131, 102.20566152465703, 35.950840939201846, 132.39230961363427, 116.44973027825723, -61.28605223471403, 107.65838741860064, -0.6125487789974899, 37.38177237998953, 93.03339270318077, 87.01585040823194, 44.00764230685003, -2.819694984417718, 80.80118117587861, 42.485052677870286, 99.67732186220141, 58.21598546497669, 69.4293505019896, 100.79644932468506, 1.2292802077018141, 55.898312797303966, 106.33151295117631, 99.06499648713725, 68.81903867577276, 75.95437884979495, 93.5724767344552, 67.66517425905863, 112.41112524798173, 73.74735088279472, 65.22435565982695, 53.52321184369718, 120.3820556685139, 126.49699940746392, 44.790785588382676, 77.69334919332819, 67.48603754056553, 118.57076045032242, 0.4920302364035917, 80.44723606233984, -11.901474718754557, 68.8680070076656, 86.51852493069865, 136.70207466563184, 86.59023440271876, 118.57460518288636, 48.71829244872044, 102.69504962562128, 30.60433895735442, 113.2527070921836, 53.61567251163905, 63.0455564474077, 29.53116602672177, 37.76654672968568], "policy_predator_policy_reward": [136.91312458040926, 137.07509338622145, 167.34036705081877, 204.87742370987107, 160.45337799875645, 107.80030605750038, 122.51120691363204, 63.900144666186044, 182.11005344175308, 133.38290209437346, 71.72512032009166, 59.655591052986935, 118.50742167159342, 167.2214845364982, 178.0470873515304, 190.32152348966773, 107.43440391536694, 171.31345973832134, 139.64779392399527, 148.6184268182551, 59.50203992698548, 125.54319999300436, 124.38475669587717, 201.4094953702726, 193.68185779805094, 211.20972500121093, 67.21736811459294, 54.3579118343714, 131.42575161754968, 124.73135922925849, 138.26279922869185, 160.37133294186683, 69.19274396025797, 91.93649168262941, 120.49741597287668, 179.77676471692695, 120.7330322740357, 108.85002381570202, 28.531791049371574, 73.48453162505874, 204.0495088886264, 176.82055516367285, 93.10279471556662, 54.64681038125424, 140.29561882123548, 96.86088269754863, 50.64176789482163, 47.67125951357572, 152.63756252745955, 94.0591443843938, 73.35868274098698, 124.10691740251958, 173.84687104161458, 172.04598130173815, 164.16261805682802, 138.00117936994386, 100.02633956559617, 205.71772719396174, 157.99524012414543, 105.71787555895098, 125.98200306775041, 140.7117127740748, 52.18468475641533, 48.48973339569963, 150.34318603564532, 190.23493284188274, 102.28385755372011, 109.9344227207036, 124.33943093733609, 55.71279381283122, 128.06392370762197, 142.64535005820423, 132.05480834315134, 90.76604582139659, 157.21090296044667, 108.92568327732522, 107.93131269502015, 103.70857390159205, 126.61466002841605, 117.68672726385354, 80.09487330221008, 108.92000766994623, 91.03509667794341, 142.0940080392799, 113.1038014896066, 140.91045385527897, 101.72278091597045, 69.72300384441145, 166.96677464037646, 127.59142813528186, 95.75088265605918, 77.41068154643284, 132.62485967468356, 96.63562574822208, 95.35470098538052, 99.83302511865323, 121.98970040415045, 162.18755211699133, 98.5987961459097, 158.01921260618974, 127.65642190348512, 108.73035376734167, 179.81640642906459, 95.09238891507742, 119.22485031885434, 112.93517969171666, 86.64030232732202, 130.02340579844363, 109.49203867982034, 92.61960368381949, 115.2897620771876, 156.77924653717088, 132.9946395312976, 151.54514300843047, 120.80061960939295, 147.33906226462295, 90.2432851203484, 165.96406462599458, 54.63780064412935, 116.74689748420107, 78.58793599018666, 87.1503902299815, 110.31424637761873, 94.43343907639942, 201.66055962775505, 217.13882548459787, 116.30065709132995, 521.4949134607448, 60.98047099048363, 84.67491095249166, 98.52663696838754, 101.69954242744717, 72.98240338455686, 70.32525392572535, 144.63692164720453, 142.86044068284392, 79.850522079344, 60.32578171054811, 62.01055877937286, 78.76564203625728, 121.38280754515009, 135.00410356797363, 102.77624567344371, 90.05052996808718, 142.86784388717822, 633.5106028481366, 78.5148832458532, 141.50713705721748, 141.5771004039464, 103.17883094282655, 55.566389308449025, 64.34306566970331, 108.72841528425292, 87.55602437186776, 129.88074980764762, 118.1803180537464, 55.49938867869432, 141.3673766063363, 170.72823691949023, 138.79206314543072, 101.48536767576647, 132.19346801167444, 106.2223182151186, 57.14854421912448, 71.51512770822872, 88.69539085149785, 38.171951324803246, 80.34081121809622, 33.442186243125356, 44.716609309527286, 107.49633399837296, 90.47500218759079, 63.00601961702955, 76.59097837255248, 16.415432352113456, 22.49301083671424, 137.43052015758528, 119.78253905993812, 36.7829308644605, 75.24219693283595, 120.79751248568914, 109.72478940649047, 94.31688350568456, 74.59147433731559, 77.34141081429355, 54.70739771185934, 9.927693972089658, 32.7171276029301, 26.302040930153744, 22.209721775626694, 68.58275326060458, 105.93362750790791, 126.38071461572959, 98.39828876288077, 148.1986542165802, 52.052586012950904, 132.33842561438328, 101.05573420461015, 135.4848139561764, 156.08923460200316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6251153014978376, "mean_inference_ms": 1.9404671391213326, "mean_action_processing_ms": 0.2643001951508995, "mean_env_wait_ms": 0.23607378921245029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004891872406005859, "StateBufferConnector_ms": 0.00322568416595459, "ViewRequirementAgentConnector_ms": 0.09792399406433105}, "num_episodes": 18, "episode_return_max": 409.5378842680131, "episode_return_min": 99.61135386393121, "episode_return_mean": 339.64144341085455, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.6847134630931, "num_env_steps_trained_throughput_per_sec": 362.6847134630931, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 10962.104, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10962.066, "sample_time_ms": 1395.721, "learn_time_ms": 9549.992, "learn_throughput": 418.849, "synch_weights_time_ms": 14.948}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "e552a_00000", "date": "2024-08-16_08-55-07", "timestamp": 1723778707, "time_this_iter_s": 11.072154760360718, "time_total_s": 516.8270299434662, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72efc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 516.8270299434662, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 32.23125, "ram_util_percent": 83.02499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.982840969322851, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.615629777454195, "policy_loss": -0.005462738441022497, "vf_loss": 7.618643226320781, "vf_explained_var": -0.1679648374123548, "kl": 0.007257132742900157, "entropy": 1.1764234233785558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.772054108488497, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8812681942389755, "policy_loss": -0.009394128092012748, "vf_loss": 7.889558529979968, "vf_explained_var": 0.4432686882359641, "kl": 0.01471718888378986, "entropy": 1.3312594992143136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 409.5378842680131, "episode_reward_min": 99.61135386393121, "episode_reward_mean": 329.460956138838, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -515.0215983087189, "predator_policy": 6.347072311016321}, "policy_reward_max": {"prey_policy": 168.7382224688592, "predator_policy": 633.5106028481366}, "policy_reward_mean": {"prey_policy": 58.5824239289317, "predator_policy": 106.14805414048736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.72208204082614, 333.8451132933073, 329.38458346629943, 359.20513697162477, 287.00836248940846, 391.53683594268756, 383.28476908097383, 362.4120782748208, 369.00869175366716, 351.0825764612392, 349.0864578160309, 338.4612864962467, 398.0375994367907, 366.5793227596898, 357.45253962750394, 355.63246857286634, 200.9778039937592, 375.72322192177523, 278.8476188648377, 378.1907061656957, 302.2235981811351, 318.0015724472004, 265.1930622967976, 348.16210490044, 349.1006481197036, 352.3161669327283, 364.5902438658825, 289.39588460823813, 251.68224891023073, 372.92101639363756, 344.5203169159771, 340.5273157094263, 375.16508491691155, 317.8506611158716, 300.9345650321151, 321.64251003480587, 388.1365612014935, 343.3127649791498, 340.12857321264744, 409.5378842680131, 310.8338416881428, 347.13369030904494, 347.5376836606502, 370.5858826145443, 372.8222804091633, 389.78700915995756, 303.60766490198404, 377.367862475342, 194.19607335143294, 359.61457739765416, 371.5829424336676, 346.8773509700815, 380.5139811760405, 371.4137790037203, 284.9207397698778, 347.60431700414824, 382.9124338106322, 368.7514948700434, 242.6567748400072, 284.830291462386, 376.9160083964428, 350.70824738735325, 356.9650695411901, 321.2641697614211, 330.4363183864011, 175.64035554790487, 283.5553049909657, 342.7447537115316, 300.83464898309495, 225.06691931960177, 375.9606267210479, 358.904182873274, 353.0064366738907, 354.96515583388793, 212.98807482489565, 99.61135386393121, 271.73236230210995, 379.68122035411756, 376.19234545295177, 344.1082862790692, 350.05538877804, 358.8717613145871, 355.82151795214446, 400.68651068911703, 234.5199054702891, 367.60932085452805, 392.3520090889163, 365.036813715683, 390.5572054921843, 221.3586279769513, 354.3879063071465, 202.3577084438598, 258.88441008047835, 312.814093581239, 349.90045251260267, 374.80476590676375, 385.11367326261967, 297.4326283637379, 167.02248145458253, 212.85388065226968], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [84.5443768784183, 71.5946490726701, 111.98255555574634, 119.846235063131, -28.61144261725731, -22.874037968742094, 110.77373360425942, 100.68179827054412, 8.244949866164573, 41.606911104460465, 136.7522702402434, 156.47153829404746, 91.06778963476037, 45.52027253435985, 86.71819911074948, 78.22827902056454, 108.28830650199521, -85.17246709168101, 0.6992891396567485, 48.219489894810934, 13.988095160182214, 29.354295896290665, 44.9133961892463, 29.834774623903634, 56.79709702217756, 74.54678657278707, 136.25277329926013, 129.65213130831484, -33.692895923574135, 50.56731667354981, 60.16264936609988, 83.25153893234291, -16.358410545133605, 37.28398978872542, 37.31472013897678, 67.69922801697197, 4.076594675255448, 51.95017002503423, 55.823928429189976, 56.23019149873461, 25.671078497677655, 64.9126330868451, 3.8539328319116626, 69.8462523230188, 99.19852274494828, -23.020341420306877, 76.83444206159577, 38.19855812162105, 35.661375106450976, 59.42501766836736, 80.28376123965943, 100.58662093268676, 48.711530875397344, 21.320510214826772, 66.63140228313297, 49.60291812261333, 31.381556707134735, -8.95979321980925, 74.08825018733685, 103.64504010226692, 32.195358514735496, 28.14770588009947, 51.88820991405497, 32.02109704327192, 57.512081449000284, 81.26622779708474, -30.40671715635215, 73.34858292808171, 9.163194636532362, 59.61134038501156, 41.80178093992962, 63.17702096911065, 114.91046402782553, 71.1144548100277, 80.81218420116458, -9.568427836373226, 47.7225670775718, 7.866223595347524, 68.23182274270248, 73.16637965129465, 42.31152737133258, 12.31496457046749, 56.37577532453895, 119.3732168561757, 114.69968134671305, 67.0996760937696, 68.94021930503253, 96.89797785549402, 27.708280976612063, -73.68538567980164, -332.6993869767052, 84.69082558458781, 80.67888365760217, 77.2733993014068, 64.0521819217548, 113.0895011577527, 52.681091676006744, -1.7926756348556514, 45.626070034901964, 26.491145032703756, 106.40999671997668, 124.9966419237986, 116.93618565949126, 89.16496449495969, 61.15240450263617, 62.974665560280336, 93.38588711326662, 85.20111624892309, 23.563891343282258, -515.0215983087189, 65.21867784316485, 62.3636188579131, 102.20566152465703, 35.950840939201846, 132.39230961363427, 116.44973027825723, -61.28605223471403, 107.65838741860064, -0.6125487789974899, 37.38177237998953, 93.03339270318077, 87.01585040823194, 44.00764230685003, -2.819694984417718, 80.80118117587861, 42.485052677870286, 99.67732186220141, 58.21598546497669, 69.4293505019896, 100.79644932468506, 1.2292802077018141, 55.898312797303966, 106.33151295117631, 99.06499648713725, 68.81903867577276, 75.95437884979495, 93.5724767344552, 67.66517425905863, 112.41112524798173, 73.74735088279472, 65.22435565982695, 53.52321184369718, 120.3820556685139, 126.49699940746392, 44.790785588382676, 77.69334919332819, 67.48603754056553, 118.57076045032242, 0.4920302364035917, 80.44723606233984, -11.901474718754557, 68.8680070076656, 86.51852493069865, 136.70207466563184, 86.59023440271876, 118.57460518288636, 48.71829244872044, 102.69504962562128, 30.60433895735442, 113.2527070921836, 53.61567251163905, 63.0455564474077, 29.53116602672177, 37.76654672968568, 114.27633223800864, 116.38205403947515, 129.9611733664814, 168.7382224688592, 10.754376506697955, 88.28464218346653, 105.23136392034472, 108.41179115330465, -31.11578082470067, 39.12783031662883, 77.80018388811618, 108.80651102007779, 65.99281483016557, 113.29533621184186, 54.34799481535426, 87.27473026015817, 55.05056506253836, 67.12436615995604, -5.716727090100493, 29.923990914311283, 83.28347168967927, 119.36191149188517, 73.8893809797166, 64.88078658366247, 113.05600031602428, 107.10659209047093, 112.33468441675609, 155.48116761993043, 69.13743034859309, 112.11165800377296, 60.708606111980835, 34.31853639882286, 142.95993082619688, -2.2058099913221287, -55.28459786989449, 79.66955366360327], "policy_predator_policy_reward": [120.7330322740357, 108.85002381570202, 28.531791049371574, 73.48453162505874, 204.0495088886264, 176.82055516367285, 93.10279471556662, 54.64681038125424, 140.29561882123548, 96.86088269754863, 50.64176789482163, 47.67125951357572, 152.63756252745955, 94.0591443843938, 73.35868274098698, 124.10691740251958, 173.84687104161458, 172.04598130173815, 164.16261805682802, 138.00117936994386, 100.02633956559617, 205.71772719396174, 157.99524012414543, 105.71787555895098, 125.98200306775041, 140.7117127740748, 52.18468475641533, 48.48973339569963, 150.34318603564532, 190.23493284188274, 102.28385755372011, 109.9344227207036, 124.33943093733609, 55.71279381283122, 128.06392370762197, 142.64535005820423, 132.05480834315134, 90.76604582139659, 157.21090296044667, 108.92568327732522, 107.93131269502015, 103.70857390159205, 126.61466002841605, 117.68672726385354, 80.09487330221008, 108.92000766994623, 91.03509667794341, 142.0940080392799, 113.1038014896066, 140.91045385527897, 101.72278091597045, 69.72300384441145, 166.96677464037646, 127.59142813528186, 95.75088265605918, 77.41068154643284, 132.62485967468356, 96.63562574822208, 95.35470098538052, 99.83302511865323, 121.98970040415045, 162.18755211699133, 98.5987961459097, 158.01921260618974, 127.65642190348512, 108.73035376734167, 179.81640642906459, 95.09238891507742, 119.22485031885434, 112.93517969171666, 86.64030232732202, 130.02340579844363, 109.49203867982034, 92.61960368381949, 115.2897620771876, 156.77924653717088, 132.9946395312976, 151.54514300843047, 120.80061960939295, 147.33906226462295, 90.2432851203484, 165.96406462599458, 54.63780064412935, 116.74689748420107, 78.58793599018666, 87.1503902299815, 110.31424637761873, 94.43343907639942, 201.66055962775505, 217.13882548459787, 116.30065709132995, 521.4949134607448, 60.98047099048363, 84.67491095249166, 98.52663696838754, 101.69954242744717, 72.98240338455686, 70.32525392572535, 144.63692164720453, 142.86044068284392, 79.850522079344, 60.32578171054811, 62.01055877937286, 78.76564203625728, 121.38280754515009, 135.00410356797363, 102.77624567344371, 90.05052996808718, 142.86784388717822, 633.5106028481366, 78.5148832458532, 141.50713705721748, 141.5771004039464, 103.17883094282655, 55.566389308449025, 64.34306566970331, 108.72841528425292, 87.55602437186776, 129.88074980764762, 118.1803180537464, 55.49938867869432, 141.3673766063363, 170.72823691949023, 138.79206314543072, 101.48536767576647, 132.19346801167444, 106.2223182151186, 57.14854421912448, 71.51512770822872, 88.69539085149785, 38.171951324803246, 80.34081121809622, 33.442186243125356, 44.716609309527286, 107.49633399837296, 90.47500218759079, 63.00601961702955, 76.59097837255248, 16.415432352113456, 22.49301083671424, 137.43052015758528, 119.78253905993812, 36.7829308644605, 75.24219693283595, 120.79751248568914, 109.72478940649047, 94.31688350568456, 74.59147433731559, 77.34141081429355, 54.70739771185934, 9.927693972089658, 32.7171276029301, 26.302040930153744, 22.209721775626694, 68.58275326060458, 105.93362750790791, 126.38071461572959, 98.39828876288077, 148.1986542165802, 52.052586012950904, 132.33842561438328, 101.05573420461015, 135.4848139561764, 156.08923460200316, 48.65306139629075, 76.51007027836985, 46.14833902754565, 55.838775826230574, 74.63873963247637, 60.842147147647914, 53.63206160006197, 100.33410418081665, 141.07155250128622, 243.26840709570206, 102.73557507325205, 75.69454373423748, 89.37732527397743, 121.89172917620012, 24.145010118107624, 55.59089278333125, 103.59391155147523, 128.61906353317656, 96.0754448167147, 82.07499980293468, 49.891954587898326, 6.347072311016321, 95.33358403836294, 78.71034197949672, 70.35710299616406, 59.38075710994423, 43.96657956667528, 63.0223343034023, 80.09050628056036, 123.77407862969369, 116.79880256962444, 85.60668328330996, 10.566906790304452, 15.701453829403201, 85.39647174079383, 103.0724531177671]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6243689024874804, "mean_inference_ms": 1.9387493811814631, "mean_action_processing_ms": 0.26380915517150894, "mean_env_wait_ms": 0.23582747030330586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005666971206665039, "StateBufferConnector_ms": 0.0033761262893676758, "ViewRequirementAgentConnector_ms": 0.10397744178771973}, "num_episodes": 18, "episode_return_max": 409.5378842680131, "episode_return_min": 99.61135386393121, "episode_return_mean": 329.460956138838, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.6956861297661, "num_env_steps_trained_throughput_per_sec": 349.6956861297661, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 10997.798, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10997.76, "sample_time_ms": 1404.984, "learn_time_ms": 9576.794, "learn_throughput": 417.676, "synch_weights_time_ms": 14.68}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "e552a_00000", "date": "2024-08-16_08-55-18", "timestamp": 1723778718, "time_this_iter_s": 11.493804216384888, "time_total_s": 528.3208341598511, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 528.3208341598511, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 37.1375, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7362258713712135, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.070790780789007, "policy_loss": -0.006360942835145921, "vf_loss": 8.074509868419991, "vf_explained_var": -0.11246190020646998, "kl": 0.007827706455775138, "entropy": 1.1607267242890817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.975514297573655, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8906278615275385, "policy_loss": -0.013394541967605984, "vf_loss": 7.9029356999372045, "vf_explained_var": 0.3576041873485323, "kl": 0.014489117908017496, "entropy": 1.3374096159581785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 409.5378842680131, "episode_reward_min": 99.61135386393121, "episode_reward_mean": 322.87568702958424, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -515.0215983087189, "predator_policy": 6.347072311016321}, "policy_reward_max": {"prey_policy": 168.97884008681757, "predator_policy": 633.5106028481366}, "policy_reward_mean": {"prey_policy": 70.32226947490346, "predator_policy": 91.11557403988867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.1930622967976, 348.16210490044, 349.1006481197036, 352.3161669327283, 364.5902438658825, 289.39588460823813, 251.68224891023073, 372.92101639363756, 344.5203169159771, 340.5273157094263, 375.16508491691155, 317.8506611158716, 300.9345650321151, 321.64251003480587, 388.1365612014935, 343.3127649791498, 340.12857321264744, 409.5378842680131, 310.8338416881428, 347.13369030904494, 347.5376836606502, 370.5858826145443, 372.8222804091633, 389.78700915995756, 303.60766490198404, 377.367862475342, 194.19607335143294, 359.61457739765416, 371.5829424336676, 346.8773509700815, 380.5139811760405, 371.4137790037203, 284.9207397698778, 347.60431700414824, 382.9124338106322, 368.7514948700434, 242.6567748400072, 284.830291462386, 376.9160083964428, 350.70824738735325, 356.9650695411901, 321.2641697614211, 330.4363183864011, 175.64035554790487, 283.5553049909657, 342.7447537115316, 300.83464898309495, 225.06691931960177, 375.9606267210479, 358.904182873274, 353.0064366738907, 354.96515583388793, 212.98807482489565, 99.61135386393121, 271.73236230210995, 379.68122035411756, 376.19234545295177, 344.1082862790692, 350.05538877804, 358.8717613145871, 355.82151795214446, 400.68651068911703, 234.5199054702891, 367.60932085452805, 392.3520090889163, 365.036813715683, 390.5572054921843, 221.3586279769513, 354.3879063071465, 202.3577084438598, 258.88441008047835, 312.814093581239, 349.90045251260267, 374.80476590676375, 385.11367326261967, 297.4326283637379, 167.02248145458253, 212.85388065226968, 188.28608542111934, 360.0489480020302, 368.6492756703761, 335.23247720950997, 302.3830352993765, 355.4512854460652, 388.63768485568056, 304.35998240217845, 140.6443702864438, 376.6622277347423, 367.86916919588066, 276.2729166946637, 356.70184446930597, 337.83666846457976, 322.2199762856766, 407.5628783969354, 346.3425588947678, 147.23476749742807, 322.5649649492971, 328.7664592946006, 260.46979136564613, 318.9801472966964], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [99.19852274494828, -23.020341420306877, 76.83444206159577, 38.19855812162105, 35.661375106450976, 59.42501766836736, 80.28376123965943, 100.58662093268676, 48.711530875397344, 21.320510214826772, 66.63140228313297, 49.60291812261333, 31.381556707134735, -8.95979321980925, 74.08825018733685, 103.64504010226692, 32.195358514735496, 28.14770588009947, 51.88820991405497, 32.02109704327192, 57.512081449000284, 81.26622779708474, -30.40671715635215, 73.34858292808171, 9.163194636532362, 59.61134038501156, 41.80178093992962, 63.17702096911065, 114.91046402782553, 71.1144548100277, 80.81218420116458, -9.568427836373226, 47.7225670775718, 7.866223595347524, 68.23182274270248, 73.16637965129465, 42.31152737133258, 12.31496457046749, 56.37577532453895, 119.3732168561757, 114.69968134671305, 67.0996760937696, 68.94021930503253, 96.89797785549402, 27.708280976612063, -73.68538567980164, -332.6993869767052, 84.69082558458781, 80.67888365760217, 77.2733993014068, 64.0521819217548, 113.0895011577527, 52.681091676006744, -1.7926756348556514, 45.626070034901964, 26.491145032703756, 106.40999671997668, 124.9966419237986, 116.93618565949126, 89.16496449495969, 61.15240450263617, 62.974665560280336, 93.38588711326662, 85.20111624892309, 23.563891343282258, -515.0215983087189, 65.21867784316485, 62.3636188579131, 102.20566152465703, 35.950840939201846, 132.39230961363427, 116.44973027825723, -61.28605223471403, 107.65838741860064, -0.6125487789974899, 37.38177237998953, 93.03339270318077, 87.01585040823194, 44.00764230685003, -2.819694984417718, 80.80118117587861, 42.485052677870286, 99.67732186220141, 58.21598546497669, 69.4293505019896, 100.79644932468506, 1.2292802077018141, 55.898312797303966, 106.33151295117631, 99.06499648713725, 68.81903867577276, 75.95437884979495, 93.5724767344552, 67.66517425905863, 112.41112524798173, 73.74735088279472, 65.22435565982695, 53.52321184369718, 120.3820556685139, 126.49699940746392, 44.790785588382676, 77.69334919332819, 67.48603754056553, 118.57076045032242, 0.4920302364035917, 80.44723606233984, -11.901474718754557, 68.8680070076656, 86.51852493069865, 136.70207466563184, 86.59023440271876, 118.57460518288636, 48.71829244872044, 102.69504962562128, 30.60433895735442, 113.2527070921836, 53.61567251163905, 63.0455564474077, 29.53116602672177, 37.76654672968568, 114.27633223800864, 116.38205403947515, 129.9611733664814, 168.7382224688592, 10.754376506697955, 88.28464218346653, 105.23136392034472, 108.41179115330465, -31.11578082470067, 39.12783031662883, 77.80018388811618, 108.80651102007779, 65.99281483016557, 113.29533621184186, 54.34799481535426, 87.27473026015817, 55.05056506253836, 67.12436615995604, -5.716727090100493, 29.923990914311283, 83.28347168967927, 119.36191149188517, 73.8893809797166, 64.88078658366247, 113.05600031602428, 107.10659209047093, 112.33468441675609, 155.48116761993043, 69.13743034859309, 112.11165800377296, 60.708606111980835, 34.31853639882286, 142.95993082619688, -2.2058099913221287, -55.28459786989449, 79.66955366360327, -1.5617940302850282, 125.43527505415976, 144.54750687547943, 154.11026251151253, 168.97884008681757, 135.24782659031473, 106.40440908271033, 127.51076329506289, 134.70102021542505, 96.91525808034334, 95.0307633990276, 135.90787164207933, 139.5173866958832, 80.93595104689746, 52.00276065544344, 131.01839997458532, -9.219375805942635, 109.17887544984961, 73.05535251541768, 108.49892989188702, 160.20457432174666, 168.24774628045978, 109.38606972451123, 97.17537139684845, 138.50374153695554, -33.23941714282278, 132.9792951730602, 110.73887532537957, 118.9271352338185, 135.6296647539658, 142.17898784387657, 83.13795967323765, 138.07081431810417, 134.78114026132326, -46.18643502992675, 106.73437427103117, 138.01818682618142, 134.62641247160062, 134.6227416241396, 136.47214057866998, 61.99344719299999, 116.14533587719588, 83.90101974431613, 135.2186077076992], "policy_predator_policy_reward": [80.09487330221008, 108.92000766994623, 91.03509667794341, 142.0940080392799, 113.1038014896066, 140.91045385527897, 101.72278091597045, 69.72300384441145, 166.96677464037646, 127.59142813528186, 95.75088265605918, 77.41068154643284, 132.62485967468356, 96.63562574822208, 95.35470098538052, 99.83302511865323, 121.98970040415045, 162.18755211699133, 98.5987961459097, 158.01921260618974, 127.65642190348512, 108.73035376734167, 179.81640642906459, 95.09238891507742, 119.22485031885434, 112.93517969171666, 86.64030232732202, 130.02340579844363, 109.49203867982034, 92.61960368381949, 115.2897620771876, 156.77924653717088, 132.9946395312976, 151.54514300843047, 120.80061960939295, 147.33906226462295, 90.2432851203484, 165.96406462599458, 54.63780064412935, 116.74689748420107, 78.58793599018666, 87.1503902299815, 110.31424637761873, 94.43343907639942, 201.66055962775505, 217.13882548459787, 116.30065709132995, 521.4949134607448, 60.98047099048363, 84.67491095249166, 98.52663696838754, 101.69954242744717, 72.98240338455686, 70.32525392572535, 144.63692164720453, 142.86044068284392, 79.850522079344, 60.32578171054811, 62.01055877937286, 78.76564203625728, 121.38280754515009, 135.00410356797363, 102.77624567344371, 90.05052996808718, 142.86784388717822, 633.5106028481366, 78.5148832458532, 141.50713705721748, 141.5771004039464, 103.17883094282655, 55.566389308449025, 64.34306566970331, 108.72841528425292, 87.55602437186776, 129.88074980764762, 118.1803180537464, 55.49938867869432, 141.3673766063363, 170.72823691949023, 138.79206314543072, 101.48536767576647, 132.19346801167444, 106.2223182151186, 57.14854421912448, 71.51512770822872, 88.69539085149785, 38.171951324803246, 80.34081121809622, 33.442186243125356, 44.716609309527286, 107.49633399837296, 90.47500218759079, 63.00601961702955, 76.59097837255248, 16.415432352113456, 22.49301083671424, 137.43052015758528, 119.78253905993812, 36.7829308644605, 75.24219693283595, 120.79751248568914, 109.72478940649047, 94.31688350568456, 74.59147433731559, 77.34141081429355, 54.70739771185934, 9.927693972089658, 32.7171276029301, 26.302040930153744, 22.209721775626694, 68.58275326060458, 105.93362750790791, 126.38071461572959, 98.39828876288077, 148.1986542165802, 52.052586012950904, 132.33842561438328, 101.05573420461015, 135.4848139561764, 156.08923460200316, 48.65306139629075, 76.51007027836985, 46.14833902754565, 55.838775826230574, 74.63873963247637, 60.842147147647914, 53.63206160006197, 100.33410418081665, 141.07155250128622, 243.26840709570206, 102.73557507325205, 75.69454373423748, 89.37732527397743, 121.89172917620012, 24.145010118107624, 55.59089278333125, 103.59391155147523, 128.61906353317656, 96.0754448167147, 82.07499980293468, 49.891954587898326, 6.347072311016321, 95.33358403836294, 78.71034197949672, 70.35710299616406, 59.38075710994423, 43.96657956667528, 63.0223343034023, 80.09050628056036, 123.77407862969369, 116.79880256962444, 85.60668328330996, 10.566906790304452, 15.701453829403201, 85.39647174079383, 103.0724531177671, 27.506704440490076, 36.905899956754595, 50.191743339655666, 11.199435275382589, 43.253523243813234, 21.169085749430586, 63.06338133526699, 38.253923496469696, 19.283050092751818, 51.48370691085644, 85.21973707169865, 39.29291333325966, 82.62961527069695, 85.55473184220348, 16.369772475138493, 104.96904929701127, 28.45644395066846, 12.228426691868114, 85.63596385623536, 109.47198147120297, 15.913194283498667, 23.50365431017508, 50.75767379438168, 18.953801778921815, 108.91339521685553, 142.52412485831766, 54.473807959063535, 39.6446900070774, 23.775240153375954, 43.88793614451663, 88.1389562848725, 94.10697459494781, 49.21346175272744, 24.277142562612745, 69.36666438745931, 17.32016386886419, 22.575422215418115, 27.34494343609731, 28.21747583112349, 29.454101260667947, 16.52833610239314, 65.802672193057, 53.66406030222189, 46.196459542459856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6234370024096569, "mean_inference_ms": 1.9396698734875435, "mean_action_processing_ms": 0.2631369142627414, "mean_env_wait_ms": 0.235629371375183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006372570991516113, "StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.10047996044158936}, "num_episodes": 22, "episode_return_max": 409.5378842680131, "episode_return_min": 99.61135386393121, "episode_return_mean": 322.87568702958424, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 349.7919476707809, "num_env_steps_trained_throughput_per_sec": 349.7919476707809, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 11004.661, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11004.623, "sample_time_ms": 1401.944, "learn_time_ms": 9586.88, "learn_throughput": 417.237, "synch_weights_time_ms": 14.474}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "e552a_00000", "date": "2024-08-16_08-55-30", "timestamp": 1723778730, "time_this_iter_s": 11.494997024536133, "time_total_s": 539.8158311843872, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2251430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 539.8158311843872, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 34.7125, "ram_util_percent": 83.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.84313015849502, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.387481434887679, "policy_loss": -0.0032613464402005314, "vf_loss": 7.3879594086339235, "vf_explained_var": 0.18634857904343377, "kl": 0.00824701611921579, "entropy": 1.1265526312999625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.413079182748441, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.723535818271536, "policy_loss": -0.011610233645009065, "vf_loss": 7.734205796478918, "vf_explained_var": 0.33593329847174347, "kl": 0.012537015543765316, "entropy": 1.3112304809862974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 407.5628783969354, "episode_reward_min": 99.61135386393121, "episode_reward_mean": 322.9290579815981, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -515.0215983087189, "predator_policy": 5.0929044998903015}, "policy_reward_max": {"prey_policy": 191.89533029094622, "predator_policy": 633.5106028481366}, "policy_reward_mean": {"prey_policy": 90.45330298204985, "predator_policy": 71.01122600874928}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.78700915995756, 303.60766490198404, 377.367862475342, 194.19607335143294, 359.61457739765416, 371.5829424336676, 346.8773509700815, 380.5139811760405, 371.4137790037203, 284.9207397698778, 347.60431700414824, 382.9124338106322, 368.7514948700434, 242.6567748400072, 284.830291462386, 376.9160083964428, 350.70824738735325, 356.9650695411901, 321.2641697614211, 330.4363183864011, 175.64035554790487, 283.5553049909657, 342.7447537115316, 300.83464898309495, 225.06691931960177, 375.9606267210479, 358.904182873274, 353.0064366738907, 354.96515583388793, 212.98807482489565, 99.61135386393121, 271.73236230210995, 379.68122035411756, 376.19234545295177, 344.1082862790692, 350.05538877804, 358.8717613145871, 355.82151795214446, 400.68651068911703, 234.5199054702891, 367.60932085452805, 392.3520090889163, 365.036813715683, 390.5572054921843, 221.3586279769513, 354.3879063071465, 202.3577084438598, 258.88441008047835, 312.814093581239, 349.90045251260267, 374.80476590676375, 385.11367326261967, 297.4326283637379, 167.02248145458253, 212.85388065226968, 188.28608542111934, 360.0489480020302, 368.6492756703761, 335.23247720950997, 302.3830352993765, 355.4512854460652, 388.63768485568056, 304.35998240217845, 140.6443702864438, 376.6622277347423, 367.86916919588066, 276.2729166946637, 356.70184446930597, 337.83666846457976, 322.2199762856766, 407.5628783969354, 346.3425588947678, 147.23476749742807, 322.5649649492971, 328.7664592946006, 260.46979136564613, 318.9801472966964, 315.3369401415665, 355.09158928131365, 360.754727244743, 381.58263614652014, 365.2804101902405, 344.37715584441776, 343.01868123137785, 346.5637805710165, 339.6538387651206, 385.63477098451307, 345.0355989493078, 395.7206738086758, 395.7213579248994, 316.8064955574482, 291.2384341593538, 180.60285009270123, 356.7087044926529, 256.7185120157685, 251.31059221724934, 397.71442465180814, 352.305621450622, 378.7311214980539, 373.45917007763813], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-332.6993869767052, 84.69082558458781, 80.67888365760217, 77.2733993014068, 64.0521819217548, 113.0895011577527, 52.681091676006744, -1.7926756348556514, 45.626070034901964, 26.491145032703756, 106.40999671997668, 124.9966419237986, 116.93618565949126, 89.16496449495969, 61.15240450263617, 62.974665560280336, 93.38588711326662, 85.20111624892309, 23.563891343282258, -515.0215983087189, 65.21867784316485, 62.3636188579131, 102.20566152465703, 35.950840939201846, 132.39230961363427, 116.44973027825723, -61.28605223471403, 107.65838741860064, -0.6125487789974899, 37.38177237998953, 93.03339270318077, 87.01585040823194, 44.00764230685003, -2.819694984417718, 80.80118117587861, 42.485052677870286, 99.67732186220141, 58.21598546497669, 69.4293505019896, 100.79644932468506, 1.2292802077018141, 55.898312797303966, 106.33151295117631, 99.06499648713725, 68.81903867577276, 75.95437884979495, 93.5724767344552, 67.66517425905863, 112.41112524798173, 73.74735088279472, 65.22435565982695, 53.52321184369718, 120.3820556685139, 126.49699940746392, 44.790785588382676, 77.69334919332819, 67.48603754056553, 118.57076045032242, 0.4920302364035917, 80.44723606233984, -11.901474718754557, 68.8680070076656, 86.51852493069865, 136.70207466563184, 86.59023440271876, 118.57460518288636, 48.71829244872044, 102.69504962562128, 30.60433895735442, 113.2527070921836, 53.61567251163905, 63.0455564474077, 29.53116602672177, 37.76654672968568, 114.27633223800864, 116.38205403947515, 129.9611733664814, 168.7382224688592, 10.754376506697955, 88.28464218346653, 105.23136392034472, 108.41179115330465, -31.11578082470067, 39.12783031662883, 77.80018388811618, 108.80651102007779, 65.99281483016557, 113.29533621184186, 54.34799481535426, 87.27473026015817, 55.05056506253836, 67.12436615995604, -5.716727090100493, 29.923990914311283, 83.28347168967927, 119.36191149188517, 73.8893809797166, 64.88078658366247, 113.05600031602428, 107.10659209047093, 112.33468441675609, 155.48116761993043, 69.13743034859309, 112.11165800377296, 60.708606111980835, 34.31853639882286, 142.95993082619688, -2.2058099913221287, -55.28459786989449, 79.66955366360327, -1.5617940302850282, 125.43527505415976, 144.54750687547943, 154.11026251151253, 168.97884008681757, 135.24782659031473, 106.40440908271033, 127.51076329506289, 134.70102021542505, 96.91525808034334, 95.0307633990276, 135.90787164207933, 139.5173866958832, 80.93595104689746, 52.00276065544344, 131.01839997458532, -9.219375805942635, 109.17887544984961, 73.05535251541768, 108.49892989188702, 160.20457432174666, 168.24774628045978, 109.38606972451123, 97.17537139684845, 138.50374153695554, -33.23941714282278, 132.9792951730602, 110.73887532537957, 118.9271352338185, 135.6296647539658, 142.17898784387657, 83.13795967323765, 138.07081431810417, 134.78114026132326, -46.18643502992675, 106.73437427103117, 138.01818682618142, 134.62641247160062, 134.6227416241396, 136.47214057866998, 61.99344719299999, 116.14533587719588, 83.90101974431613, 135.2186077076992, 141.29080703218688, 143.74932996712607, 149.85753907435017, 150.9920327974332, 126.80560623181155, 149.55603259095182, 145.42058396769795, 159.92825593392615, 110.1706522692559, 151.0981470490043, 123.19414956002008, 154.3334981494688, 138.0868030145976, 103.99057405066867, 109.66876517139684, 159.6372617090388, 136.02642288428126, 114.4128026868836, 171.58437915320366, 169.650431461521, 160.92296351818933, 159.48820574381898, 182.80710388633932, 131.8023118659819, 184.65397849486064, 179.32644165842058, 113.2718482021424, 191.89533029094622, 25.065418315081235, 169.1811391022903, 2.0000000000000013, 150.34424773154728, 104.89351969695498, 145.67043640557463, 113.01689438146731, 90.99037559773244, 130.95874599982122, 54.838395113381814, 188.72117976978248, 179.04216545853367, 173.12368501724282, 121.73639591766437, 168.39899753825105, 188.75793755085792, 125.30283147722592, 120.14893525872293], "policy_predator_policy_reward": [116.30065709132995, 521.4949134607448, 60.98047099048363, 84.67491095249166, 98.52663696838754, 101.69954242744717, 72.98240338455686, 70.32525392572535, 144.63692164720453, 142.86044068284392, 79.850522079344, 60.32578171054811, 62.01055877937286, 78.76564203625728, 121.38280754515009, 135.00410356797363, 102.77624567344371, 90.05052996808718, 142.86784388717822, 633.5106028481366, 78.5148832458532, 141.50713705721748, 141.5771004039464, 103.17883094282655, 55.566389308449025, 64.34306566970331, 108.72841528425292, 87.55602437186776, 129.88074980764762, 118.1803180537464, 55.49938867869432, 141.3673766063363, 170.72823691949023, 138.79206314543072, 101.48536767576647, 132.19346801167444, 106.2223182151186, 57.14854421912448, 71.51512770822872, 88.69539085149785, 38.171951324803246, 80.34081121809622, 33.442186243125356, 44.716609309527286, 107.49633399837296, 90.47500218759079, 63.00601961702955, 76.59097837255248, 16.415432352113456, 22.49301083671424, 137.43052015758528, 119.78253905993812, 36.7829308644605, 75.24219693283595, 120.79751248568914, 109.72478940649047, 94.31688350568456, 74.59147433731559, 77.34141081429355, 54.70739771185934, 9.927693972089658, 32.7171276029301, 26.302040930153744, 22.209721775626694, 68.58275326060458, 105.93362750790791, 126.38071461572959, 98.39828876288077, 148.1986542165802, 52.052586012950904, 132.33842561438328, 101.05573420461015, 135.4848139561764, 156.08923460200316, 48.65306139629075, 76.51007027836985, 46.14833902754565, 55.838775826230574, 74.63873963247637, 60.842147147647914, 53.63206160006197, 100.33410418081665, 141.07155250128622, 243.26840709570206, 102.73557507325205, 75.69454373423748, 89.37732527397743, 121.89172917620012, 24.145010118107624, 55.59089278333125, 103.59391155147523, 128.61906353317656, 96.0754448167147, 82.07499980293468, 49.891954587898326, 6.347072311016321, 95.33358403836294, 78.71034197949672, 70.35710299616406, 59.38075710994423, 43.96657956667528, 63.0223343034023, 80.09050628056036, 123.77407862969369, 116.79880256962444, 85.60668328330996, 10.566906790304452, 15.701453829403201, 85.39647174079383, 103.0724531177671, 27.506704440490076, 36.905899956754595, 50.191743339655666, 11.199435275382589, 43.253523243813234, 21.169085749430586, 63.06338133526699, 38.253923496469696, 19.283050092751818, 51.48370691085644, 85.21973707169865, 39.29291333325966, 82.62961527069695, 85.55473184220348, 16.369772475138493, 104.96904929701127, 28.45644395066846, 12.228426691868114, 85.63596385623536, 109.47198147120297, 15.913194283498667, 23.50365431017508, 50.75767379438168, 18.953801778921815, 108.91339521685553, 142.52412485831766, 54.473807959063535, 39.6446900070774, 23.775240153375954, 43.88793614451663, 88.1389562848725, 94.10697459494781, 49.21346175272744, 24.277142562612745, 69.36666438745931, 17.32016386886419, 22.575422215418115, 27.34494343609731, 28.21747583112349, 29.454101260667947, 16.52833610239314, 65.802672193057, 53.66406030222189, 46.196459542459856, 18.063092397947752, 12.233710744305874, 23.93261113905111, 30.309406270479457, 52.985870777006795, 31.407217644972707, 39.25392723189118, 36.979869013005384, 53.569066864494545, 50.44254400748601, 36.19748359945352, 30.652024535475746, 68.87136860849978, 32.069935557612126, 46.73872191493648, 30.519031775644827, 53.20996350967522, 36.00464968428096, 19.9131188842305, 24.486841485557818, 15.564850321438742, 9.05957936586099, 53.588783727261216, 27.522474329092887, 15.797224671903411, 15.943713099714746, 6.546412564469586, 5.0929044998903015, 34.05249601275506, 62.93938072922696, 7.507662158557443, 20.750940202596855, 31.057782199664725, 75.08696619045874, 41.569693821381044, 11.141548215187772, 33.087918040884205, 32.42553306316251, 14.603160287424952, 15.347919136067102, 33.7433632029592, 23.702177312755794, 9.660020496479259, 11.91416591246567, 75.55002018205788, 52.45738315963171]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6235943570019985, "mean_inference_ms": 1.9327741574046278, "mean_action_processing_ms": 0.26268496177678985, "mean_env_wait_ms": 0.23532991657623317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006828188896179199, "StateBufferConnector_ms": 0.0034161806106567383, "ViewRequirementAgentConnector_ms": 0.09897637367248535}, "num_episodes": 23, "episode_return_max": 407.5628783969354, "episode_return_min": 99.61135386393121, "episode_return_mean": 322.9290579815981, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.0323564335365, "num_env_steps_trained_throughput_per_sec": 364.0323564335365, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 10988.564, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10988.525, "sample_time_ms": 1408.606, "learn_time_ms": 9563.647, "learn_throughput": 418.25, "synch_weights_time_ms": 14.918}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "e552a_00000", "date": "2024-08-16_08-55-41", "timestamp": 1723778741, "time_this_iter_s": 11.027029991149902, "time_total_s": 550.8428611755371, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 550.8428611755371, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 83.76875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.764806200902929, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.1292437553405765, "policy_loss": -0.006923991422139344, "vf_loss": 7.133524968384435, "vf_explained_var": 0.03398840622927146, "kl": 0.007830400681804758, "entropy": 1.1579570476970975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.2548465010981085, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.530038488226593, "policy_loss": -0.004319524387065223, "vf_loss": 7.533502972567523, "vf_explained_var": 0.2207511880095043, "kl": 0.01140037327995999, "entropy": 1.2905619773915205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 412.72130912658446, "episode_reward_min": 99.61135386393121, "episode_reward_mean": 327.0002348771959, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.28459786989449, "predator_policy": 5.0929044998903015}, "policy_reward_max": {"prey_policy": 192.50183246810772, "predator_policy": 243.26840709570206}, "policy_reward_mean": {"prey_policy": 109.83292520003126, "predator_policy": 53.66719223856678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.2641697614211, 330.4363183864011, 175.64035554790487, 283.5553049909657, 342.7447537115316, 300.83464898309495, 225.06691931960177, 375.9606267210479, 358.904182873274, 353.0064366738907, 354.96515583388793, 212.98807482489565, 99.61135386393121, 271.73236230210995, 379.68122035411756, 376.19234545295177, 344.1082862790692, 350.05538877804, 358.8717613145871, 355.82151795214446, 400.68651068911703, 234.5199054702891, 367.60932085452805, 392.3520090889163, 365.036813715683, 390.5572054921843, 221.3586279769513, 354.3879063071465, 202.3577084438598, 258.88441008047835, 312.814093581239, 349.90045251260267, 374.80476590676375, 385.11367326261967, 297.4326283637379, 167.02248145458253, 212.85388065226968, 188.28608542111934, 360.0489480020302, 368.6492756703761, 335.23247720950997, 302.3830352993765, 355.4512854460652, 388.63768485568056, 304.35998240217845, 140.6443702864438, 376.6622277347423, 367.86916919588066, 276.2729166946637, 356.70184446930597, 337.83666846457976, 322.2199762856766, 407.5628783969354, 346.3425588947678, 147.23476749742807, 322.5649649492971, 328.7664592946006, 260.46979136564613, 318.9801472966964, 315.3369401415665, 355.09158928131365, 360.754727244743, 381.58263614652014, 365.2804101902405, 344.37715584441776, 343.01868123137785, 346.5637805710165, 339.6538387651206, 385.63477098451307, 345.0355989493078, 395.7206738086758, 395.7213579248994, 316.8064955574482, 291.2384341593538, 180.60285009270123, 356.7087044926529, 256.7185120157685, 251.31059221724934, 397.71442465180814, 352.305621450622, 378.7311214980539, 373.45917007763813, 346.7284199949357, 361.0013080392894, 265.1464718799664, 393.7389567655298, 382.33690229148067, 374.7214579112826, 391.6370387574551, 343.87530426080076, 276.2513510979964, 412.72130912658446, 377.2327558368506, 372.95945054438704, 344.5109510000174, 368.6492673011794, 383.1122828573107, 352.29527072285157, 390.95783203029987, 360.4679770935285], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [99.67732186220141, 58.21598546497669, 69.4293505019896, 100.79644932468506, 1.2292802077018141, 55.898312797303966, 106.33151295117631, 99.06499648713725, 68.81903867577276, 75.95437884979495, 93.5724767344552, 67.66517425905863, 112.41112524798173, 73.74735088279472, 65.22435565982695, 53.52321184369718, 120.3820556685139, 126.49699940746392, 44.790785588382676, 77.69334919332819, 67.48603754056553, 118.57076045032242, 0.4920302364035917, 80.44723606233984, -11.901474718754557, 68.8680070076656, 86.51852493069865, 136.70207466563184, 86.59023440271876, 118.57460518288636, 48.71829244872044, 102.69504962562128, 30.60433895735442, 113.2527070921836, 53.61567251163905, 63.0455564474077, 29.53116602672177, 37.76654672968568, 114.27633223800864, 116.38205403947515, 129.9611733664814, 168.7382224688592, 10.754376506697955, 88.28464218346653, 105.23136392034472, 108.41179115330465, -31.11578082470067, 39.12783031662883, 77.80018388811618, 108.80651102007779, 65.99281483016557, 113.29533621184186, 54.34799481535426, 87.27473026015817, 55.05056506253836, 67.12436615995604, -5.716727090100493, 29.923990914311283, 83.28347168967927, 119.36191149188517, 73.8893809797166, 64.88078658366247, 113.05600031602428, 107.10659209047093, 112.33468441675609, 155.48116761993043, 69.13743034859309, 112.11165800377296, 60.708606111980835, 34.31853639882286, 142.95993082619688, -2.2058099913221287, -55.28459786989449, 79.66955366360327, -1.5617940302850282, 125.43527505415976, 144.54750687547943, 154.11026251151253, 168.97884008681757, 135.24782659031473, 106.40440908271033, 127.51076329506289, 134.70102021542505, 96.91525808034334, 95.0307633990276, 135.90787164207933, 139.5173866958832, 80.93595104689746, 52.00276065544344, 131.01839997458532, -9.219375805942635, 109.17887544984961, 73.05535251541768, 108.49892989188702, 160.20457432174666, 168.24774628045978, 109.38606972451123, 97.17537139684845, 138.50374153695554, -33.23941714282278, 132.9792951730602, 110.73887532537957, 118.9271352338185, 135.6296647539658, 142.17898784387657, 83.13795967323765, 138.07081431810417, 134.78114026132326, -46.18643502992675, 106.73437427103117, 138.01818682618142, 134.62641247160062, 134.6227416241396, 136.47214057866998, 61.99344719299999, 116.14533587719588, 83.90101974431613, 135.2186077076992, 141.29080703218688, 143.74932996712607, 149.85753907435017, 150.9920327974332, 126.80560623181155, 149.55603259095182, 145.42058396769795, 159.92825593392615, 110.1706522692559, 151.0981470490043, 123.19414956002008, 154.3334981494688, 138.0868030145976, 103.99057405066867, 109.66876517139684, 159.6372617090388, 136.02642288428126, 114.4128026868836, 171.58437915320366, 169.650431461521, 160.92296351818933, 159.48820574381898, 182.80710388633932, 131.8023118659819, 184.65397849486064, 179.32644165842058, 113.2718482021424, 191.89533029094622, 25.065418315081235, 169.1811391022903, 2.0000000000000013, 150.34424773154728, 104.89351969695498, 145.67043640557463, 113.01689438146731, 90.99037559773244, 130.95874599982122, 54.838395113381814, 188.72117976978248, 179.04216545853367, 173.12368501724282, 121.73639591766437, 168.39899753825105, 188.75793755085792, 125.30283147722592, 120.14893525872293, 150.50028294971474, 163.20132182981698, 148.79253336576613, 126.71991588426893, 44.13990488693067, 155.05581856357526, 192.50183246810772, 175.3027466963243, 163.26124111094194, 160.14066872613952, 169.3609668991012, 171.11160750282625, 119.15516721895894, 189.86432912285034, 150.56989106202207, 111.84797261082196, 19.613993153666776, 133.87606294803487, 137.27127035004264, 165.0940079263497, 161.6910256010933, 152.03889430140114, 169.6846745294175, 150.24210844989702, 170.54066124648574, 143.34651240879535, 149.9381297551484, 139.43199490978688, 105.96854827973198, 155.68654322439585, 166.57796427454045, 112.64078392843183, 166.64851551745468, 192.32614862467904, 141.52829819236845, 151.35311821875018], "policy_predator_policy_reward": [106.2223182151186, 57.14854421912448, 71.51512770822872, 88.69539085149785, 38.171951324803246, 80.34081121809622, 33.442186243125356, 44.716609309527286, 107.49633399837296, 90.47500218759079, 63.00601961702955, 76.59097837255248, 16.415432352113456, 22.49301083671424, 137.43052015758528, 119.78253905993812, 36.7829308644605, 75.24219693283595, 120.79751248568914, 109.72478940649047, 94.31688350568456, 74.59147433731559, 77.34141081429355, 54.70739771185934, 9.927693972089658, 32.7171276029301, 26.302040930153744, 22.209721775626694, 68.58275326060458, 105.93362750790791, 126.38071461572959, 98.39828876288077, 148.1986542165802, 52.052586012950904, 132.33842561438328, 101.05573420461015, 135.4848139561764, 156.08923460200316, 48.65306139629075, 76.51007027836985, 46.14833902754565, 55.838775826230574, 74.63873963247637, 60.842147147647914, 53.63206160006197, 100.33410418081665, 141.07155250128622, 243.26840709570206, 102.73557507325205, 75.69454373423748, 89.37732527397743, 121.89172917620012, 24.145010118107624, 55.59089278333125, 103.59391155147523, 128.61906353317656, 96.0754448167147, 82.07499980293468, 49.891954587898326, 6.347072311016321, 95.33358403836294, 78.71034197949672, 70.35710299616406, 59.38075710994423, 43.96657956667528, 63.0223343034023, 80.09050628056036, 123.77407862969369, 116.79880256962444, 85.60668328330996, 10.566906790304452, 15.701453829403201, 85.39647174079383, 103.0724531177671, 27.506704440490076, 36.905899956754595, 50.191743339655666, 11.199435275382589, 43.253523243813234, 21.169085749430586, 63.06338133526699, 38.253923496469696, 19.283050092751818, 51.48370691085644, 85.21973707169865, 39.29291333325966, 82.62961527069695, 85.55473184220348, 16.369772475138493, 104.96904929701127, 28.45644395066846, 12.228426691868114, 85.63596385623536, 109.47198147120297, 15.913194283498667, 23.50365431017508, 50.75767379438168, 18.953801778921815, 108.91339521685553, 142.52412485831766, 54.473807959063535, 39.6446900070774, 23.775240153375954, 43.88793614451663, 88.1389562848725, 94.10697459494781, 49.21346175272744, 24.277142562612745, 69.36666438745931, 17.32016386886419, 22.575422215418115, 27.34494343609731, 28.21747583112349, 29.454101260667947, 16.52833610239314, 65.802672193057, 53.66406030222189, 46.196459542459856, 18.063092397947752, 12.233710744305874, 23.93261113905111, 30.309406270479457, 52.985870777006795, 31.407217644972707, 39.25392723189118, 36.979869013005384, 53.569066864494545, 50.44254400748601, 36.19748359945352, 30.652024535475746, 68.87136860849978, 32.069935557612126, 46.73872191493648, 30.519031775644827, 53.20996350967522, 36.00464968428096, 19.9131188842305, 24.486841485557818, 15.564850321438742, 9.05957936586099, 53.588783727261216, 27.522474329092887, 15.797224671903411, 15.943713099714746, 6.546412564469586, 5.0929044998903015, 34.05249601275506, 62.93938072922696, 7.507662158557443, 20.750940202596855, 31.057782199664725, 75.08696619045874, 41.569693821381044, 11.141548215187772, 33.087918040884205, 32.42553306316251, 14.603160287424952, 15.347919136067102, 33.7433632029592, 23.702177312755794, 9.660020496479259, 11.91416591246567, 75.55002018205788, 52.45738315963171, 15.650415195550796, 17.376400019853214, 45.17193328123266, 40.316925508021995, 33.08755969163643, 32.863188737824046, 13.45265882577342, 12.481718775324426, 16.267150072420883, 42.66784238197845, 9.908393875917286, 24.34048963343801, 56.53659141438537, 26.080951001260768, 36.8996018943769, 44.55783869357997, 99.21668474248273, 23.544610253811946, 69.46229946504266, 40.89373138514932, 23.605287044536542, 39.897548889819674, 11.97940368177601, 41.053263883296395, 16.000689046917156, 14.623088297819491, 38.81997489227405, 40.459167743970525, 92.26285545364996, 29.194335899532813, 43.029806436118655, 30.046716083760547, 20.014449386885374, 11.968718501280913, 19.423158785242506, 48.163401897167724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6227075277984355, "mean_inference_ms": 1.9369811461956659, "mean_action_processing_ms": 0.2624371813372715, "mean_env_wait_ms": 0.23508895447610975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006232142448425293, "StateBufferConnector_ms": 0.0033119916915893555, "ViewRequirementAgentConnector_ms": 0.09581577777862549}, "num_episodes": 18, "episode_return_max": 412.72130912658446, "episode_return_min": 99.61135386393121, "episode_return_mean": 327.0002348771959, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.9145881008289, "num_env_steps_trained_throughput_per_sec": 356.9145881008289, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 11024.274, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11024.236, "sample_time_ms": 1415.436, "learn_time_ms": 9592.651, "learn_throughput": 416.986, "synch_weights_time_ms": 14.73}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "e552a_00000", "date": "2024-08-16_08-55-52", "timestamp": 1723778752, "time_this_iter_s": 11.261978149414062, "time_total_s": 562.1048393249512, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 562.1048393249512, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 33.825, "ram_util_percent": 83.55624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.77423931757609, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.962468551958679, "policy_loss": -0.01209307349158855, "vf_loss": 5.971657599343194, "vf_explained_var": 0.4468367271322422, "kl": 0.008604544367335381, "entropy": 1.1526952047827383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7273098846591965, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.456196614926454, "policy_loss": -0.004375488028083016, "vf_loss": 7.459559685086447, "vf_explained_var": 0.15554805328606297, "kl": 0.013498718608340003, "entropy": 1.2600261426476576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 412.72130912658446, "episode_reward_min": 140.6443702864438, "episode_reward_mean": 338.7473026471104, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -55.28459786989449, "predator_policy": 5.0929044998903015}, "policy_reward_max": {"prey_policy": 193.99034907907074, "predator_policy": 243.26840709570206}, "policy_reward_mean": {"prey_policy": 122.51712520725998, "predator_policy": 46.85652611629526}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.8717613145871, 355.82151795214446, 400.68651068911703, 234.5199054702891, 367.60932085452805, 392.3520090889163, 365.036813715683, 390.5572054921843, 221.3586279769513, 354.3879063071465, 202.3577084438598, 258.88441008047835, 312.814093581239, 349.90045251260267, 374.80476590676375, 385.11367326261967, 297.4326283637379, 167.02248145458253, 212.85388065226968, 188.28608542111934, 360.0489480020302, 368.6492756703761, 335.23247720950997, 302.3830352993765, 355.4512854460652, 388.63768485568056, 304.35998240217845, 140.6443702864438, 376.6622277347423, 367.86916919588066, 276.2729166946637, 356.70184446930597, 337.83666846457976, 322.2199762856766, 407.5628783969354, 346.3425588947678, 147.23476749742807, 322.5649649492971, 328.7664592946006, 260.46979136564613, 318.9801472966964, 315.3369401415665, 355.09158928131365, 360.754727244743, 381.58263614652014, 365.2804101902405, 344.37715584441776, 343.01868123137785, 346.5637805710165, 339.6538387651206, 385.63477098451307, 345.0355989493078, 395.7206738086758, 395.7213579248994, 316.8064955574482, 291.2384341593538, 180.60285009270123, 356.7087044926529, 256.7185120157685, 251.31059221724934, 397.71442465180814, 352.305621450622, 378.7311214980539, 373.45917007763813, 346.7284199949357, 361.0013080392894, 265.1464718799664, 393.7389567655298, 382.33690229148067, 374.7214579112826, 391.6370387574551, 343.87530426080076, 276.2513510979964, 412.72130912658446, 377.2327558368506, 372.95945054438704, 344.5109510000174, 368.6492673011794, 383.1122828573107, 352.29527072285157, 390.95783203029987, 360.4679770935285, 396.99270355546196, 340.3026564608352, 404.6044372730535, 302.95711702716727, 379.2916538198916, 380.855620052651, 395.63579953564204, 385.71557198725225, 383.6603754273528, 378.1437618649474, 367.4093811367371, 375.70724224255196, 353.4812448366817, 339.41393198838125, 368.21412906413514, 345.186414960755, 370.56095347713625, 363.3216869389451], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [29.53116602672177, 37.76654672968568, 114.27633223800864, 116.38205403947515, 129.9611733664814, 168.7382224688592, 10.754376506697955, 88.28464218346653, 105.23136392034472, 108.41179115330465, -31.11578082470067, 39.12783031662883, 77.80018388811618, 108.80651102007779, 65.99281483016557, 113.29533621184186, 54.34799481535426, 87.27473026015817, 55.05056506253836, 67.12436615995604, -5.716727090100493, 29.923990914311283, 83.28347168967927, 119.36191149188517, 73.8893809797166, 64.88078658366247, 113.05600031602428, 107.10659209047093, 112.33468441675609, 155.48116761993043, 69.13743034859309, 112.11165800377296, 60.708606111980835, 34.31853639882286, 142.95993082619688, -2.2058099913221287, -55.28459786989449, 79.66955366360327, -1.5617940302850282, 125.43527505415976, 144.54750687547943, 154.11026251151253, 168.97884008681757, 135.24782659031473, 106.40440908271033, 127.51076329506289, 134.70102021542505, 96.91525808034334, 95.0307633990276, 135.90787164207933, 139.5173866958832, 80.93595104689746, 52.00276065544344, 131.01839997458532, -9.219375805942635, 109.17887544984961, 73.05535251541768, 108.49892989188702, 160.20457432174666, 168.24774628045978, 109.38606972451123, 97.17537139684845, 138.50374153695554, -33.23941714282278, 132.9792951730602, 110.73887532537957, 118.9271352338185, 135.6296647539658, 142.17898784387657, 83.13795967323765, 138.07081431810417, 134.78114026132326, -46.18643502992675, 106.73437427103117, 138.01818682618142, 134.62641247160062, 134.6227416241396, 136.47214057866998, 61.99344719299999, 116.14533587719588, 83.90101974431613, 135.2186077076992, 141.29080703218688, 143.74932996712607, 149.85753907435017, 150.9920327974332, 126.80560623181155, 149.55603259095182, 145.42058396769795, 159.92825593392615, 110.1706522692559, 151.0981470490043, 123.19414956002008, 154.3334981494688, 138.0868030145976, 103.99057405066867, 109.66876517139684, 159.6372617090388, 136.02642288428126, 114.4128026868836, 171.58437915320366, 169.650431461521, 160.92296351818933, 159.48820574381898, 182.80710388633932, 131.8023118659819, 184.65397849486064, 179.32644165842058, 113.2718482021424, 191.89533029094622, 25.065418315081235, 169.1811391022903, 2.0000000000000013, 150.34424773154728, 104.89351969695498, 145.67043640557463, 113.01689438146731, 90.99037559773244, 130.95874599982122, 54.838395113381814, 188.72117976978248, 179.04216545853367, 173.12368501724282, 121.73639591766437, 168.39899753825105, 188.75793755085792, 125.30283147722592, 120.14893525872293, 150.50028294971474, 163.20132182981698, 148.79253336576613, 126.71991588426893, 44.13990488693067, 155.05581856357526, 192.50183246810772, 175.3027466963243, 163.26124111094194, 160.14066872613952, 169.3609668991012, 171.11160750282625, 119.15516721895894, 189.86432912285034, 150.56989106202207, 111.84797261082196, 19.613993153666776, 133.87606294803487, 137.27127035004264, 165.0940079263497, 161.6910256010933, 152.03889430140114, 169.6846745294175, 150.24210844989702, 170.54066124648574, 143.34651240879535, 149.9381297551484, 139.43199490978688, 105.96854827973198, 155.68654322439585, 166.57796427454045, 112.64078392843183, 166.64851551745468, 192.32614862467904, 141.52829819236845, 151.35311821875018, 186.25378489324657, 187.26709605265424, 98.89232512774416, 135.1861117210574, 111.78085029455767, 173.77424348573976, 103.63926698671492, 76.49995424471291, 171.16092371897972, 172.37049441281806, 163.3767638991322, 159.2855976965855, 173.74440949470178, 193.99034907907074, 189.7105291879819, 142.06909139258397, 181.1580647360852, 174.84504601963425, 163.6132225946264, 171.45392553916145, 136.67014757740273, 139.86609861799454, 171.08857489902167, 175.60469407791993, 144.49682529427267, 151.70208306352583, 137.54289666788577, 18.584780760606975, 129.59337993468898, 112.52287204022572, 121.34816974602685, 80.92512752752576, 157.32512600674835, 166.74621461092008, 164.71415955363963, 133.23996494119422], "policy_predator_policy_reward": [135.4848139561764, 156.08923460200316, 48.65306139629075, 76.51007027836985, 46.14833902754565, 55.838775826230574, 74.63873963247637, 60.842147147647914, 53.63206160006197, 100.33410418081665, 141.07155250128622, 243.26840709570206, 102.73557507325205, 75.69454373423748, 89.37732527397743, 121.89172917620012, 24.145010118107624, 55.59089278333125, 103.59391155147523, 128.61906353317656, 96.0754448167147, 82.07499980293468, 49.891954587898326, 6.347072311016321, 95.33358403836294, 78.71034197949672, 70.35710299616406, 59.38075710994423, 43.96657956667528, 63.0223343034023, 80.09050628056036, 123.77407862969369, 116.79880256962444, 85.60668328330996, 10.566906790304452, 15.701453829403201, 85.39647174079383, 103.0724531177671, 27.506704440490076, 36.905899956754595, 50.191743339655666, 11.199435275382589, 43.253523243813234, 21.169085749430586, 63.06338133526699, 38.253923496469696, 19.283050092751818, 51.48370691085644, 85.21973707169865, 39.29291333325966, 82.62961527069695, 85.55473184220348, 16.369772475138493, 104.96904929701127, 28.45644395066846, 12.228426691868114, 85.63596385623536, 109.47198147120297, 15.913194283498667, 23.50365431017508, 50.75767379438168, 18.953801778921815, 108.91339521685553, 142.52412485831766, 54.473807959063535, 39.6446900070774, 23.775240153375954, 43.88793614451663, 88.1389562848725, 94.10697459494781, 49.21346175272744, 24.277142562612745, 69.36666438745931, 17.32016386886419, 22.575422215418115, 27.34494343609731, 28.21747583112349, 29.454101260667947, 16.52833610239314, 65.802672193057, 53.66406030222189, 46.196459542459856, 18.063092397947752, 12.233710744305874, 23.93261113905111, 30.309406270479457, 52.985870777006795, 31.407217644972707, 39.25392723189118, 36.979869013005384, 53.569066864494545, 50.44254400748601, 36.19748359945352, 30.652024535475746, 68.87136860849978, 32.069935557612126, 46.73872191493648, 30.519031775644827, 53.20996350967522, 36.00464968428096, 19.9131188842305, 24.486841485557818, 15.564850321438742, 9.05957936586099, 53.588783727261216, 27.522474329092887, 15.797224671903411, 15.943713099714746, 6.546412564469586, 5.0929044998903015, 34.05249601275506, 62.93938072922696, 7.507662158557443, 20.750940202596855, 31.057782199664725, 75.08696619045874, 41.569693821381044, 11.141548215187772, 33.087918040884205, 32.42553306316251, 14.603160287424952, 15.347919136067102, 33.7433632029592, 23.702177312755794, 9.660020496479259, 11.91416591246567, 75.55002018205788, 52.45738315963171, 15.650415195550796, 17.376400019853214, 45.17193328123266, 40.316925508021995, 33.08755969163643, 32.863188737824046, 13.45265882577342, 12.481718775324426, 16.267150072420883, 42.66784238197845, 9.908393875917286, 24.34048963343801, 56.53659141438537, 26.080951001260768, 36.8996018943769, 44.55783869357997, 99.21668474248273, 23.544610253811946, 69.46229946504266, 40.89373138514932, 23.605287044536542, 39.897548889819674, 11.97940368177601, 41.053263883296395, 16.000689046917156, 14.623088297819491, 38.81997489227405, 40.459167743970525, 92.26285545364996, 29.194335899532813, 43.029806436118655, 30.046716083760547, 20.014449386885374, 11.968718501280913, 19.423158785242506, 48.163401897167724, 15.464214389870374, 8.007608219690523, 44.384327137261785, 61.83989247477228, 65.45869716992372, 53.590646322832434, 74.38367098000845, 48.43422481573094, 20.853888974233147, 14.906346713860854, 39.84836298747536, 18.344895469458244, 15.443282167981959, 12.457758793887585, 13.58739505979403, 40.348556346892046, 10.116393179311581, 17.54087149232205, 29.166601836178028, 13.910011894981968, 16.081341097974253, 74.79179384336554, 18.59005263223657, 10.423920633373273, 40.50538660881746, 16.776949870065323, 120.58610530954559, 62.70014925034328, 28.274907881549133, 97.82296920767156, 106.93177636906077, 35.981341318141574, 29.121322231290293, 17.368290628177782, 20.584215365414295, 44.78334707869698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6225257825037402, "mean_inference_ms": 1.9380757662149306, "mean_action_processing_ms": 0.26218683792270686, "mean_env_wait_ms": 0.23504375021377422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005810379981994629, "StateBufferConnector_ms": 0.0033500194549560547, "ViewRequirementAgentConnector_ms": 0.09736335277557373}, "num_episodes": 18, "episode_return_max": 412.72130912658446, "episode_return_min": 140.6443702864438, "episode_return_mean": 338.7473026471104, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.939462073426, "num_env_steps_trained_throughput_per_sec": 351.939462073426, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 11066.633, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11066.596, "sample_time_ms": 1417.622, "learn_time_ms": 9632.391, "learn_throughput": 415.266, "synch_weights_time_ms": 15.244}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "e552a_00000", "date": "2024-08-16_08-56-04", "timestamp": 1723778764, "time_this_iter_s": 11.372421026229858, "time_total_s": 573.477260351181, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72de430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 573.477260351181, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 32.3625, "ram_util_percent": 83.16875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.6163346810315655, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.493258308985877, "policy_loss": -0.010767635738073045, "vf_loss": 7.500891973354198, "vf_explained_var": 0.23464226602877258, "kl": 0.009285884218575407, "entropy": 1.1562166089103336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.245489311218262, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.321624296682852, "policy_loss": -0.006582861096923432, "vf_loss": 8.327330967232033, "vf_explained_var": 0.19386526201137158, "kl": 0.011682484883038462, "entropy": 1.249660908292841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 412.72130912658446, "episode_reward_min": 140.6443702864438, "episode_reward_mean": 340.84294085847876, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -81.08897050284644, "predator_policy": 5.0929044998903015}, "policy_reward_max": {"prey_policy": 193.99034907907074, "predator_policy": 154.1733488442849}, "policy_reward_mean": {"prey_policy": 126.3128665473599, "predator_policy": 44.108603881879574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [212.85388065226968, 188.28608542111934, 360.0489480020302, 368.6492756703761, 335.23247720950997, 302.3830352993765, 355.4512854460652, 388.63768485568056, 304.35998240217845, 140.6443702864438, 376.6622277347423, 367.86916919588066, 276.2729166946637, 356.70184446930597, 337.83666846457976, 322.2199762856766, 407.5628783969354, 346.3425588947678, 147.23476749742807, 322.5649649492971, 328.7664592946006, 260.46979136564613, 318.9801472966964, 315.3369401415665, 355.09158928131365, 360.754727244743, 381.58263614652014, 365.2804101902405, 344.37715584441776, 343.01868123137785, 346.5637805710165, 339.6538387651206, 385.63477098451307, 345.0355989493078, 395.7206738086758, 395.7213579248994, 316.8064955574482, 291.2384341593538, 180.60285009270123, 356.7087044926529, 256.7185120157685, 251.31059221724934, 397.71442465180814, 352.305621450622, 378.7311214980539, 373.45917007763813, 346.7284199949357, 361.0013080392894, 265.1464718799664, 393.7389567655298, 382.33690229148067, 374.7214579112826, 391.6370387574551, 343.87530426080076, 276.2513510979964, 412.72130912658446, 377.2327558368506, 372.95945054438704, 344.5109510000174, 368.6492673011794, 383.1122828573107, 352.29527072285157, 390.95783203029987, 360.4679770935285, 396.99270355546196, 340.3026564608352, 404.6044372730535, 302.95711702716727, 379.2916538198916, 380.855620052651, 395.63579953564204, 385.71557198725225, 383.6603754273528, 378.1437618649474, 367.4093811367371, 375.70724224255196, 353.4812448366817, 339.41393198838125, 368.21412906413514, 345.186414960755, 370.56095347713625, 363.3216869389451, 337.3128351127426, 374.74487663375254, 342.0639402882039, 265.5107109353617, 314.5824290205608, 359.5707061387791, 295.4873220229088, 192.08014097033669, 381.00776113570265, 365.12605282435146, 363.2323701416212, 344.24768638647527, 381.8976368724584, 353.2363058558513, 305.9875434559126, 295.61970814857546, 353.3548468277468, 374.0327408329392], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.28459786989449, 79.66955366360327, -1.5617940302850282, 125.43527505415976, 144.54750687547943, 154.11026251151253, 168.97884008681757, 135.24782659031473, 106.40440908271033, 127.51076329506289, 134.70102021542505, 96.91525808034334, 95.0307633990276, 135.90787164207933, 139.5173866958832, 80.93595104689746, 52.00276065544344, 131.01839997458532, -9.219375805942635, 109.17887544984961, 73.05535251541768, 108.49892989188702, 160.20457432174666, 168.24774628045978, 109.38606972451123, 97.17537139684845, 138.50374153695554, -33.23941714282278, 132.9792951730602, 110.73887532537957, 118.9271352338185, 135.6296647539658, 142.17898784387657, 83.13795967323765, 138.07081431810417, 134.78114026132326, -46.18643502992675, 106.73437427103117, 138.01818682618142, 134.62641247160062, 134.6227416241396, 136.47214057866998, 61.99344719299999, 116.14533587719588, 83.90101974431613, 135.2186077076992, 141.29080703218688, 143.74932996712607, 149.85753907435017, 150.9920327974332, 126.80560623181155, 149.55603259095182, 145.42058396769795, 159.92825593392615, 110.1706522692559, 151.0981470490043, 123.19414956002008, 154.3334981494688, 138.0868030145976, 103.99057405066867, 109.66876517139684, 159.6372617090388, 136.02642288428126, 114.4128026868836, 171.58437915320366, 169.650431461521, 160.92296351818933, 159.48820574381898, 182.80710388633932, 131.8023118659819, 184.65397849486064, 179.32644165842058, 113.2718482021424, 191.89533029094622, 25.065418315081235, 169.1811391022903, 2.0000000000000013, 150.34424773154728, 104.89351969695498, 145.67043640557463, 113.01689438146731, 90.99037559773244, 130.95874599982122, 54.838395113381814, 188.72117976978248, 179.04216545853367, 173.12368501724282, 121.73639591766437, 168.39899753825105, 188.75793755085792, 125.30283147722592, 120.14893525872293, 150.50028294971474, 163.20132182981698, 148.79253336576613, 126.71991588426893, 44.13990488693067, 155.05581856357526, 192.50183246810772, 175.3027466963243, 163.26124111094194, 160.14066872613952, 169.3609668991012, 171.11160750282625, 119.15516721895894, 189.86432912285034, 150.56989106202207, 111.84797261082196, 19.613993153666776, 133.87606294803487, 137.27127035004264, 165.0940079263497, 161.6910256010933, 152.03889430140114, 169.6846745294175, 150.24210844989702, 170.54066124648574, 143.34651240879535, 149.9381297551484, 139.43199490978688, 105.96854827973198, 155.68654322439585, 166.57796427454045, 112.64078392843183, 166.64851551745468, 192.32614862467904, 141.52829819236845, 151.35311821875018, 186.25378489324657, 187.26709605265424, 98.89232512774416, 135.1861117210574, 111.78085029455767, 173.77424348573976, 103.63926698671492, 76.49995424471291, 171.16092371897972, 172.37049441281806, 163.3767638991322, 159.2855976965855, 173.74440949470178, 193.99034907907074, 189.7105291879819, 142.06909139258397, 181.1580647360852, 174.84504601963425, 163.6132225946264, 171.45392553916145, 136.67014757740273, 139.86609861799454, 171.08857489902167, 175.60469407791993, 144.49682529427267, 151.70208306352583, 137.54289666788577, 18.584780760606975, 129.59337993468898, 112.52287204022572, 121.34816974602685, 80.92512752752576, 157.32512600674835, 166.74621461092008, 164.71415955363963, 133.23996494119422, 101.9751752017323, 132.75418639645497, 159.50988478993182, 180.6342240727802, 94.9186636735269, 105.23420667222047, 123.53708671128709, -81.08897050284644, 58.8849947939908, 51.186175879609436, 95.7717212059614, 143.88029486196874, 121.84517201142282, 51.80919812479819, 6.011094337250702, 36.50284174126967, 19.47685428035551, 176.71956273494865, 142.67634972771327, 127.3417034000537, 163.1363256464774, 119.90785602686496, 122.4367049848075, 101.170106491975, 158.8722480221443, 157.89484513012334, 86.61790735190789, 15.631850890864406, 119.30746040123897, 101.47705233659413, 55.838063359968636, 17.11874962046569, 95.75455836413211, 126.5068633221006, 141.16525445490123, 144.40583258455055], "policy_predator_policy_reward": [85.39647174079383, 103.0724531177671, 27.506704440490076, 36.905899956754595, 50.191743339655666, 11.199435275382589, 43.253523243813234, 21.169085749430586, 63.06338133526699, 38.253923496469696, 19.283050092751818, 51.48370691085644, 85.21973707169865, 39.29291333325966, 82.62961527069695, 85.55473184220348, 16.369772475138493, 104.96904929701127, 28.45644395066846, 12.228426691868114, 85.63596385623536, 109.47198147120297, 15.913194283498667, 23.50365431017508, 50.75767379438168, 18.953801778921815, 108.91339521685553, 142.52412485831766, 54.473807959063535, 39.6446900070774, 23.775240153375954, 43.88793614451663, 88.1389562848725, 94.10697459494781, 49.21346175272744, 24.277142562612745, 69.36666438745931, 17.32016386886419, 22.575422215418115, 27.34494343609731, 28.21747583112349, 29.454101260667947, 16.52833610239314, 65.802672193057, 53.66406030222189, 46.196459542459856, 18.063092397947752, 12.233710744305874, 23.93261113905111, 30.309406270479457, 52.985870777006795, 31.407217644972707, 39.25392723189118, 36.979869013005384, 53.569066864494545, 50.44254400748601, 36.19748359945352, 30.652024535475746, 68.87136860849978, 32.069935557612126, 46.73872191493648, 30.519031775644827, 53.20996350967522, 36.00464968428096, 19.9131188842305, 24.486841485557818, 15.564850321438742, 9.05957936586099, 53.588783727261216, 27.522474329092887, 15.797224671903411, 15.943713099714746, 6.546412564469586, 5.0929044998903015, 34.05249601275506, 62.93938072922696, 7.507662158557443, 20.750940202596855, 31.057782199664725, 75.08696619045874, 41.569693821381044, 11.141548215187772, 33.087918040884205, 32.42553306316251, 14.603160287424952, 15.347919136067102, 33.7433632029592, 23.702177312755794, 9.660020496479259, 11.91416591246567, 75.55002018205788, 52.45738315963171, 15.650415195550796, 17.376400019853214, 45.17193328123266, 40.316925508021995, 33.08755969163643, 32.863188737824046, 13.45265882577342, 12.481718775324426, 16.267150072420883, 42.66784238197845, 9.908393875917286, 24.34048963343801, 56.53659141438537, 26.080951001260768, 36.8996018943769, 44.55783869357997, 99.21668474248273, 23.544610253811946, 69.46229946504266, 40.89373138514932, 23.605287044536542, 39.897548889819674, 11.97940368177601, 41.053263883296395, 16.000689046917156, 14.623088297819491, 38.81997489227405, 40.459167743970525, 92.26285545364996, 29.194335899532813, 43.029806436118655, 30.046716083760547, 20.014449386885374, 11.968718501280913, 19.423158785242506, 48.163401897167724, 15.464214389870374, 8.007608219690523, 44.384327137261785, 61.83989247477228, 65.45869716992372, 53.590646322832434, 74.38367098000845, 48.43422481573094, 20.853888974233147, 14.906346713860854, 39.84836298747536, 18.344895469458244, 15.443282167981959, 12.457758793887585, 13.58739505979403, 40.348556346892046, 10.116393179311581, 17.54087149232205, 29.166601836178028, 13.910011894981968, 16.081341097974253, 74.79179384336554, 18.59005263223657, 10.423920633373273, 40.50538660881746, 16.776949870065323, 120.58610530954559, 62.70014925034328, 28.274907881549133, 97.82296920767156, 106.93177636906077, 35.981341318141574, 29.121322231290293, 17.368290628177782, 20.584215365414295, 44.78334707869698, 16.085299078555142, 86.49817443599974, 19.571991238284102, 15.028776532756863, 106.58829652318721, 35.322773419269716, 118.71239209178664, 104.35020263513456, 50.33790950267516, 154.1733488442849, 28.076300144608926, 91.84238992623972, 96.4002759245903, 25.432675962097377, 70.17046166333967, 79.3957432284767, 54.12892977379934, 130.68241434659916, 71.90815694771253, 23.199842748872054, 63.44583788202388, 16.742350586254787, 50.83517900901557, 69.8056959006773, 14.530176236738718, 50.60036748345203, 122.48540130536534, 128.50114630771355, 51.51840625443013, 33.684624463649484, 98.00633337328372, 124.6565617948577, 109.80717420407457, 21.2862509374394, 19.257897432597282, 69.20375636088994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6222674297469477, "mean_inference_ms": 1.9385076133227495, "mean_action_processing_ms": 0.26187119329338643, "mean_env_wait_ms": 0.23490639883846323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005098819732666016, "StateBufferConnector_ms": 0.004707932472229004, "ViewRequirementAgentConnector_ms": 0.09629249572753906}, "num_episodes": 18, "episode_return_max": 412.72130912658446, "episode_return_min": 140.6443702864438, "episode_return_mean": 340.84294085847876, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.8711953554412, "num_env_steps_trained_throughput_per_sec": 359.8711953554412, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 11110.59, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11110.551, "sample_time_ms": 1425.208, "learn_time_ms": 9668.87, "learn_throughput": 413.699, "synch_weights_time_ms": 15.007}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "e552a_00000", "date": "2024-08-16_08-56-15", "timestamp": 1723778775, "time_this_iter_s": 11.142437934875488, "time_total_s": 584.6196982860565, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7337f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.6196982860565, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 33.56875, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.824307936461515, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.396070363534191, "policy_loss": -0.009521152624347932, "vf_loss": 8.402722060743463, "vf_explained_var": 0.20635439444471287, "kl": 0.008502087084080193, "entropy": 1.117665366584031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.413099645622193, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.977033165522984, "policy_loss": -0.004659885133705324, "vf_loss": 8.980850231332123, "vf_explained_var": 0.062116256529691986, "kl": 0.01123776319566815, "entropy": 1.196889120624179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 412.72130912658446, "episode_reward_min": 180.60285009270123, "episode_reward_mean": 348.3283937114767, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -81.08897050284644, "predator_policy": 5.0929044998903015}, "policy_reward_max": {"prey_policy": 193.99034907907074, "predator_policy": 191.1283123028952}, "policy_reward_mean": {"prey_policy": 121.84919023976546, "predator_policy": 52.31500661597294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.9801472966964, 315.3369401415665, 355.09158928131365, 360.754727244743, 381.58263614652014, 365.2804101902405, 344.37715584441776, 343.01868123137785, 346.5637805710165, 339.6538387651206, 385.63477098451307, 345.0355989493078, 395.7206738086758, 395.7213579248994, 316.8064955574482, 291.2384341593538, 180.60285009270123, 356.7087044926529, 256.7185120157685, 251.31059221724934, 397.71442465180814, 352.305621450622, 378.7311214980539, 373.45917007763813, 346.7284199949357, 361.0013080392894, 265.1464718799664, 393.7389567655298, 382.33690229148067, 374.7214579112826, 391.6370387574551, 343.87530426080076, 276.2513510979964, 412.72130912658446, 377.2327558368506, 372.95945054438704, 344.5109510000174, 368.6492673011794, 383.1122828573107, 352.29527072285157, 390.95783203029987, 360.4679770935285, 396.99270355546196, 340.3026564608352, 404.6044372730535, 302.95711702716727, 379.2916538198916, 380.855620052651, 395.63579953564204, 385.71557198725225, 383.6603754273528, 378.1437618649474, 367.4093811367371, 375.70724224255196, 353.4812448366817, 339.41393198838125, 368.21412906413514, 345.186414960755, 370.56095347713625, 363.3216869389451, 337.3128351127426, 374.74487663375254, 342.0639402882039, 265.5107109353617, 314.5824290205608, 359.5707061387791, 295.4873220229088, 192.08014097033669, 381.00776113570265, 365.12605282435146, 363.2323701416212, 344.24768638647527, 381.8976368724584, 353.2363058558513, 305.9875434559126, 295.61970814857546, 353.3548468277468, 374.0327408329392, 351.7189975624017, 334.76139976179735, 352.9843625704835, 373.8228911912734, 322.48366081160174, 369.03536086004385, 335.9993073880805, 334.2491171373102, 319.69810547999504, 358.27936434071785, 371.83904207508743, 342.79443416755385, 302.39772379802605, 340.64742832481016, 352.79082788124606, 346.4371643936957, 344.7697506380848, 350.16272880722056, 384.5648884219064, 364.495146443894, 295.0844084566655, 306.58042327646854], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [83.90101974431613, 135.2186077076992, 141.29080703218688, 143.74932996712607, 149.85753907435017, 150.9920327974332, 126.80560623181155, 149.55603259095182, 145.42058396769795, 159.92825593392615, 110.1706522692559, 151.0981470490043, 123.19414956002008, 154.3334981494688, 138.0868030145976, 103.99057405066867, 109.66876517139684, 159.6372617090388, 136.02642288428126, 114.4128026868836, 171.58437915320366, 169.650431461521, 160.92296351818933, 159.48820574381898, 182.80710388633932, 131.8023118659819, 184.65397849486064, 179.32644165842058, 113.2718482021424, 191.89533029094622, 25.065418315081235, 169.1811391022903, 2.0000000000000013, 150.34424773154728, 104.89351969695498, 145.67043640557463, 113.01689438146731, 90.99037559773244, 130.95874599982122, 54.838395113381814, 188.72117976978248, 179.04216545853367, 173.12368501724282, 121.73639591766437, 168.39899753825105, 188.75793755085792, 125.30283147722592, 120.14893525872293, 150.50028294971474, 163.20132182981698, 148.79253336576613, 126.71991588426893, 44.13990488693067, 155.05581856357526, 192.50183246810772, 175.3027466963243, 163.26124111094194, 160.14066872613952, 169.3609668991012, 171.11160750282625, 119.15516721895894, 189.86432912285034, 150.56989106202207, 111.84797261082196, 19.613993153666776, 133.87606294803487, 137.27127035004264, 165.0940079263497, 161.6910256010933, 152.03889430140114, 169.6846745294175, 150.24210844989702, 170.54066124648574, 143.34651240879535, 149.9381297551484, 139.43199490978688, 105.96854827973198, 155.68654322439585, 166.57796427454045, 112.64078392843183, 166.64851551745468, 192.32614862467904, 141.52829819236845, 151.35311821875018, 186.25378489324657, 187.26709605265424, 98.89232512774416, 135.1861117210574, 111.78085029455767, 173.77424348573976, 103.63926698671492, 76.49995424471291, 171.16092371897972, 172.37049441281806, 163.3767638991322, 159.2855976965855, 173.74440949470178, 193.99034907907074, 189.7105291879819, 142.06909139258397, 181.1580647360852, 174.84504601963425, 163.6132225946264, 171.45392553916145, 136.67014757740273, 139.86609861799454, 171.08857489902167, 175.60469407791993, 144.49682529427267, 151.70208306352583, 137.54289666788577, 18.584780760606975, 129.59337993468898, 112.52287204022572, 121.34816974602685, 80.92512752752576, 157.32512600674835, 166.74621461092008, 164.71415955363963, 133.23996494119422, 101.9751752017323, 132.75418639645497, 159.50988478993182, 180.6342240727802, 94.9186636735269, 105.23420667222047, 123.53708671128709, -81.08897050284644, 58.8849947939908, 51.186175879609436, 95.7717212059614, 143.88029486196874, 121.84517201142282, 51.80919812479819, 6.011094337250702, 36.50284174126967, 19.47685428035551, 176.71956273494865, 142.67634972771327, 127.3417034000537, 163.1363256464774, 119.90785602686496, 122.4367049848075, 101.170106491975, 158.8722480221443, 157.89484513012334, 86.61790735190789, 15.631850890864406, 119.30746040123897, 101.47705233659413, 55.838063359968636, 17.11874962046569, 95.75455836413211, 126.5068633221006, 141.16525445490123, 144.40583258455055, 130.6309709406753, 126.90196018229814, 95.51204680144059, 96.57018529616248, 32.508878336180956, 69.91401211688729, 131.18284888694436, 149.52151909882514, 99.922879119212, 98.32453549284052, 135.18314081270074, 93.57832404939852, 100.95742033690681, 88.37089549996337, 41.40878796415422, -12.41234023371856, 61.38514466222796, 67.64477002901596, 106.36431908607, 77.7336646410862, 107.90671485351179, 89.15999427449651, 71.30600244394196, 88.51818267191167, 59.96438050166261, 33.19808059653153, 100.80826739260364, 75.0766742359564, 127.51756703644732, 99.79621428510598, 61.25028000388916, 92.87514990935203, 109.43679081253595, 75.07324001192943, 27.999468504123254, 51.71919206569376, 170.29324405935654, 148.25045569201694, 35.48798127319886, -33.06761363489492, 91.00808121416934, 69.65367865981676, 79.00049976028527, 35.577650270932985], "policy_predator_policy_reward": [53.66406030222189, 46.196459542459856, 18.063092397947752, 12.233710744305874, 23.93261113905111, 30.309406270479457, 52.985870777006795, 31.407217644972707, 39.25392723189118, 36.979869013005384, 53.569066864494545, 50.44254400748601, 36.19748359945352, 30.652024535475746, 68.87136860849978, 32.069935557612126, 46.73872191493648, 30.519031775644827, 53.20996350967522, 36.00464968428096, 19.9131188842305, 24.486841485557818, 15.564850321438742, 9.05957936586099, 53.588783727261216, 27.522474329092887, 15.797224671903411, 15.943713099714746, 6.546412564469586, 5.0929044998903015, 34.05249601275506, 62.93938072922696, 7.507662158557443, 20.750940202596855, 31.057782199664725, 75.08696619045874, 41.569693821381044, 11.141548215187772, 33.087918040884205, 32.42553306316251, 14.603160287424952, 15.347919136067102, 33.7433632029592, 23.702177312755794, 9.660020496479259, 11.91416591246567, 75.55002018205788, 52.45738315963171, 15.650415195550796, 17.376400019853214, 45.17193328123266, 40.316925508021995, 33.08755969163643, 32.863188737824046, 13.45265882577342, 12.481718775324426, 16.267150072420883, 42.66784238197845, 9.908393875917286, 24.34048963343801, 56.53659141438537, 26.080951001260768, 36.8996018943769, 44.55783869357997, 99.21668474248273, 23.544610253811946, 69.46229946504266, 40.89373138514932, 23.605287044536542, 39.897548889819674, 11.97940368177601, 41.053263883296395, 16.000689046917156, 14.623088297819491, 38.81997489227405, 40.459167743970525, 92.26285545364996, 29.194335899532813, 43.029806436118655, 30.046716083760547, 20.014449386885374, 11.968718501280913, 19.423158785242506, 48.163401897167724, 15.464214389870374, 8.007608219690523, 44.384327137261785, 61.83989247477228, 65.45869716992372, 53.590646322832434, 74.38367098000845, 48.43422481573094, 20.853888974233147, 14.906346713860854, 39.84836298747536, 18.344895469458244, 15.443282167981959, 12.457758793887585, 13.58739505979403, 40.348556346892046, 10.116393179311581, 17.54087149232205, 29.166601836178028, 13.910011894981968, 16.081341097974253, 74.79179384336554, 18.59005263223657, 10.423920633373273, 40.50538660881746, 16.776949870065323, 120.58610530954559, 62.70014925034328, 28.274907881549133, 97.82296920767156, 106.93177636906077, 35.981341318141574, 29.121322231290293, 17.368290628177782, 20.584215365414295, 44.78334707869698, 16.085299078555142, 86.49817443599974, 19.571991238284102, 15.028776532756863, 106.58829652318721, 35.322773419269716, 118.71239209178664, 104.35020263513456, 50.33790950267516, 154.1733488442849, 28.076300144608926, 91.84238992623972, 96.4002759245903, 25.432675962097377, 70.17046166333967, 79.3957432284767, 54.12892977379934, 130.68241434659916, 71.90815694771253, 23.199842748872054, 63.44583788202388, 16.742350586254787, 50.83517900901557, 69.8056959006773, 14.530176236738718, 50.60036748345203, 122.48540130536534, 128.50114630771355, 51.51840625443013, 33.684624463649484, 98.00633337328372, 124.6565617948577, 109.80717420407457, 21.2862509374394, 19.257897432597282, 69.20375636088994, 40.84982037707694, 53.33624606235109, 37.14734485440379, 105.53182280979074, 92.45535062413659, 158.10612149327824, 40.42334449564415, 52.69517870985956, 36.84137177078407, 87.39487442876508, 92.89186644542391, 47.382029552521054, 119.0483439077775, 27.622647643432924, 148.68536519686626, 156.5673042100085, 76.64723323760322, 114.02095755114794, 109.64181041881477, 64.53957019474696, 81.02816395292894, 93.74416899415012, 75.40569395413361, 107.56455509756637, 36.85144503378227, 172.38381766604945, 131.857319554068, 32.905167142182165, 50.326272768601264, 75.15077379109154, 72.0753789723337, 120.23635550812111, 142.46865963312393, 17.791060180494963, 105.58900857951717, 164.855059657886, 30.733020502708527, 35.28816816782435, 191.1283123028952, 170.9464665026944, 112.10317045079513, 22.31947813188412, 55.27075963779843, 136.7315136074517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6216973713998384, "mean_inference_ms": 1.938384771749466, "mean_action_processing_ms": 0.2614341782930454, "mean_env_wait_ms": 0.2346790965937525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004362583160400391, "StateBufferConnector_ms": 0.00474858283996582, "ViewRequirementAgentConnector_ms": 0.0964583158493042}, "num_episodes": 22, "episode_return_max": 412.72130912658446, "episode_return_min": 180.60285009270123, "episode_return_mean": 348.3283937114767, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 350.0039345468316, "num_env_steps_trained_throughput_per_sec": 350.0039345468316, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 11193.106, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11193.066, "sample_time_ms": 1428.52, "learn_time_ms": 9748.281, "learn_throughput": 410.329, "synch_weights_time_ms": 14.733}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "e552a_00000", "date": "2024-08-16_08-56-26", "timestamp": 1723778786, "time_this_iter_s": 11.48826289176941, "time_total_s": 596.1079611778259, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2251670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 596.1079611778259, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 34.911764705882355, "ram_util_percent": 83.16470588235293}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1899510114596636, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.118979676059945, "policy_loss": -0.009181966799158583, "vf_loss": 9.125419871516959, "vf_explained_var": 0.08161650669007074, "kl": 0.008123762815873, "entropy": 1.1086664319669128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.307103158998742, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.264846063038659, "policy_loss": -0.0062484578292314255, "vf_loss": 9.270273195498834, "vf_explained_var": 0.0031718345861586313, "kl": 0.01095111268068337, "entropy": 1.198964230471818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 412.72130912658446, "episode_reward_min": 192.08014097033669, "episode_reward_mean": 354.2098115240758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.4161311091796, "predator_policy": 8.007608219690523}, "policy_reward_max": {"prey_policy": 193.99034907907074, "predator_policy": 376.4850938927628}, "policy_reward_mean": {"prey_policy": 101.2669179053407, "predator_policy": 75.83798785669717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.45917007763813, 346.7284199949357, 361.0013080392894, 265.1464718799664, 393.7389567655298, 382.33690229148067, 374.7214579112826, 391.6370387574551, 343.87530426080076, 276.2513510979964, 412.72130912658446, 377.2327558368506, 372.95945054438704, 344.5109510000174, 368.6492673011794, 383.1122828573107, 352.29527072285157, 390.95783203029987, 360.4679770935285, 396.99270355546196, 340.3026564608352, 404.6044372730535, 302.95711702716727, 379.2916538198916, 380.855620052651, 395.63579953564204, 385.71557198725225, 383.6603754273528, 378.1437618649474, 367.4093811367371, 375.70724224255196, 353.4812448366817, 339.41393198838125, 368.21412906413514, 345.186414960755, 370.56095347713625, 363.3216869389451, 337.3128351127426, 374.74487663375254, 342.0639402882039, 265.5107109353617, 314.5824290205608, 359.5707061387791, 295.4873220229088, 192.08014097033669, 381.00776113570265, 365.12605282435146, 363.2323701416212, 344.24768638647527, 381.8976368724584, 353.2363058558513, 305.9875434559126, 295.61970814857546, 353.3548468277468, 374.0327408329392, 351.7189975624017, 334.76139976179735, 352.9843625704835, 373.8228911912734, 322.48366081160174, 369.03536086004385, 335.9993073880805, 334.2491171373102, 319.69810547999504, 358.27936434071785, 371.83904207508743, 342.79443416755385, 302.39772379802605, 340.64742832481016, 352.79082788124606, 346.4371643936957, 344.7697506380848, 350.16272880722056, 384.5648884219064, 364.495146443894, 295.0844084566655, 306.58042327646854, 389.9022196497651, 394.22044497208327, 354.99805639686554, 338.12400237625417, 362.8234686137773, 394.8332537738556, 389.0569335496829, 371.83947523744297, 356.7610723342418, 383.8869987479965, 342.3355305111401, 344.2690183284469, 340.63364006242136, 343.75811268442624, 326.80552943873425, 353.67764944473663, 338.5146280789677, 351.1785983207395, 366.5556279416547, 378.2331994013504, 377.257752278588, 382.7441617412323, 380.621471891566], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [125.30283147722592, 120.14893525872293, 150.50028294971474, 163.20132182981698, 148.79253336576613, 126.71991588426893, 44.13990488693067, 155.05581856357526, 192.50183246810772, 175.3027466963243, 163.26124111094194, 160.14066872613952, 169.3609668991012, 171.11160750282625, 119.15516721895894, 189.86432912285034, 150.56989106202207, 111.84797261082196, 19.613993153666776, 133.87606294803487, 137.27127035004264, 165.0940079263497, 161.6910256010933, 152.03889430140114, 169.6846745294175, 150.24210844989702, 170.54066124648574, 143.34651240879535, 149.9381297551484, 139.43199490978688, 105.96854827973198, 155.68654322439585, 166.57796427454045, 112.64078392843183, 166.64851551745468, 192.32614862467904, 141.52829819236845, 151.35311821875018, 186.25378489324657, 187.26709605265424, 98.89232512774416, 135.1861117210574, 111.78085029455767, 173.77424348573976, 103.63926698671492, 76.49995424471291, 171.16092371897972, 172.37049441281806, 163.3767638991322, 159.2855976965855, 173.74440949470178, 193.99034907907074, 189.7105291879819, 142.06909139258397, 181.1580647360852, 174.84504601963425, 163.6132225946264, 171.45392553916145, 136.67014757740273, 139.86609861799454, 171.08857489902167, 175.60469407791993, 144.49682529427267, 151.70208306352583, 137.54289666788577, 18.584780760606975, 129.59337993468898, 112.52287204022572, 121.34816974602685, 80.92512752752576, 157.32512600674835, 166.74621461092008, 164.71415955363963, 133.23996494119422, 101.9751752017323, 132.75418639645497, 159.50988478993182, 180.6342240727802, 94.9186636735269, 105.23420667222047, 123.53708671128709, -81.08897050284644, 58.8849947939908, 51.186175879609436, 95.7717212059614, 143.88029486196874, 121.84517201142282, 51.80919812479819, 6.011094337250702, 36.50284174126967, 19.47685428035551, 176.71956273494865, 142.67634972771327, 127.3417034000537, 163.1363256464774, 119.90785602686496, 122.4367049848075, 101.170106491975, 158.8722480221443, 157.89484513012334, 86.61790735190789, 15.631850890864406, 119.30746040123897, 101.47705233659413, 55.838063359968636, 17.11874962046569, 95.75455836413211, 126.5068633221006, 141.16525445490123, 144.40583258455055, 130.6309709406753, 126.90196018229814, 95.51204680144059, 96.57018529616248, 32.508878336180956, 69.91401211688729, 131.18284888694436, 149.52151909882514, 99.922879119212, 98.32453549284052, 135.18314081270074, 93.57832404939852, 100.95742033690681, 88.37089549996337, 41.40878796415422, -12.41234023371856, 61.38514466222796, 67.64477002901596, 106.36431908607, 77.7336646410862, 107.90671485351179, 89.15999427449651, 71.30600244394196, 88.51818267191167, 59.96438050166261, 33.19808059653153, 100.80826739260364, 75.0766742359564, 127.51756703644732, 99.79621428510598, 61.25028000388916, 92.87514990935203, 109.43679081253595, 75.07324001192943, 27.999468504123254, 51.71919206569376, 170.29324405935654, 148.25045569201694, 35.48798127319886, -33.06761363489492, 91.00808121416934, 69.65367865981676, 79.00049976028527, 35.577650270932985, 27.810101895693162, 1.1196148203621956, 13.158228743912666, -271.4161311091796, 15.599750240971149, 55.26849360958938, 72.51741973042672, 66.47964610640103, 83.30810163769472, 32.342730784366346, 142.65863093884585, 125.76063444584105, -42.54250585431426, 59.46385523784068, -133.42729013466558, 89.31021284087775, 79.44213345454584, 79.57489783188119, 20.148902772057692, 38.44368246239996, 15.374211851371935, 101.70404920143042, 52.99470525541273, 70.9178282557623, 59.62307347406998, 75.39835818521036, -4.029815014131772, 51.5270070015572, 56.6805175037744, 75.45826491767255, 93.15019631950481, 64.92959915749765, 17.165090026408873, -24.2058844636653, 110.14150901271283, 98.7197242293952, 139.67994259708493, 114.88450730274562, 106.64972552945225, 75.46810056968903, 103.02598770459977, 108.81430976245358, 35.39985609510188, 29.72094854769243, 18.611997885232135, 20.20203121518748], "policy_predator_policy_reward": [75.55002018205788, 52.45738315963171, 15.650415195550796, 17.376400019853214, 45.17193328123266, 40.316925508021995, 33.08755969163643, 32.863188737824046, 13.45265882577342, 12.481718775324426, 16.267150072420883, 42.66784238197845, 9.908393875917286, 24.34048963343801, 56.53659141438537, 26.080951001260768, 36.8996018943769, 44.55783869357997, 99.21668474248273, 23.544610253811946, 69.46229946504266, 40.89373138514932, 23.605287044536542, 39.897548889819674, 11.97940368177601, 41.053263883296395, 16.000689046917156, 14.623088297819491, 38.81997489227405, 40.459167743970525, 92.26285545364996, 29.194335899532813, 43.029806436118655, 30.046716083760547, 20.014449386885374, 11.968718501280913, 19.423158785242506, 48.163401897167724, 15.464214389870374, 8.007608219690523, 44.384327137261785, 61.83989247477228, 65.45869716992372, 53.590646322832434, 74.38367098000845, 48.43422481573094, 20.853888974233147, 14.906346713860854, 39.84836298747536, 18.344895469458244, 15.443282167981959, 12.457758793887585, 13.58739505979403, 40.348556346892046, 10.116393179311581, 17.54087149232205, 29.166601836178028, 13.910011894981968, 16.081341097974253, 74.79179384336554, 18.59005263223657, 10.423920633373273, 40.50538660881746, 16.776949870065323, 120.58610530954559, 62.70014925034328, 28.274907881549133, 97.82296920767156, 106.93177636906077, 35.981341318141574, 29.121322231290293, 17.368290628177782, 20.584215365414295, 44.78334707869698, 16.085299078555142, 86.49817443599974, 19.571991238284102, 15.028776532756863, 106.58829652318721, 35.322773419269716, 118.71239209178664, 104.35020263513456, 50.33790950267516, 154.1733488442849, 28.076300144608926, 91.84238992623972, 96.4002759245903, 25.432675962097377, 70.17046166333967, 79.3957432284767, 54.12892977379934, 130.68241434659916, 71.90815694771253, 23.199842748872054, 63.44583788202388, 16.742350586254787, 50.83517900901557, 69.8056959006773, 14.530176236738718, 50.60036748345203, 122.48540130536534, 128.50114630771355, 51.51840625443013, 33.684624463649484, 98.00633337328372, 124.6565617948577, 109.80717420407457, 21.2862509374394, 19.257897432597282, 69.20375636088994, 40.84982037707694, 53.33624606235109, 37.14734485440379, 105.53182280979074, 92.45535062413659, 158.10612149327824, 40.42334449564415, 52.69517870985956, 36.84137177078407, 87.39487442876508, 92.89186644542391, 47.382029552521054, 119.0483439077775, 27.622647643432924, 148.68536519686626, 156.5673042100085, 76.64723323760322, 114.02095755114794, 109.64181041881477, 64.53957019474696, 81.02816395292894, 93.74416899415012, 75.40569395413361, 107.56455509756637, 36.85144503378227, 172.38381766604945, 131.857319554068, 32.905167142182165, 50.326272768601264, 75.15077379109154, 72.0753789723337, 120.23635550812111, 142.46865963312393, 17.791060180494963, 105.58900857951717, 164.855059657886, 30.733020502708527, 35.28816816782435, 191.1283123028952, 170.9464665026944, 112.10317045079513, 22.31947813188412, 55.27075963779843, 136.7315136074517, 201.0989062550521, 159.8735966786568, 275.9932534445874, 376.4850938927628, 141.67345315431535, 142.4563593919898, 148.45505374874193, 50.67188279068391, 115.41558492381007, 131.75705126790618, 64.78746590776218, 61.626522481405814, 206.9405056794799, 165.19507848667627, 210.75595748036616, 205.20059505086465, 59.54882858399371, 138.19521246382078, 139.85446203041013, 185.43995148312865, 127.24952198117481, 98.00774747716314, 109.56831441421717, 110.78817040305469, 103.67462047229704, 101.93758793084346, 67.0694859073595, 229.19143478964105, 170.8987062387219, 23.76804077856503, 129.20816114815023, 66.38969281958386, 212.96431845909467, 132.59110405712917, 52.593554703269525, 89.72381037536171, 54.027060473988364, 57.96411756783628, 107.64262273282758, 88.4727505693816, 94.02944116372764, 71.38801364780728, 152.0109207867041, 165.61243631173363, 173.43886538186922, 168.36857740927672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6214346457517269, "mean_inference_ms": 1.9385650878131413, "mean_action_processing_ms": 0.26106257521838655, "mean_env_wait_ms": 0.23448170143296906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003741621971130371, "StateBufferConnector_ms": 0.004606962203979492, "ViewRequirementAgentConnector_ms": 0.10240757465362549}, "num_episodes": 23, "episode_return_max": 412.72130912658446, "episode_return_min": 192.08014097033669, "episode_return_mean": 354.2098115240758, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.8510267227317, "num_env_steps_trained_throughput_per_sec": 358.8510267227317, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 11197.313, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11197.273, "sample_time_ms": 1433.723, "learn_time_ms": 9747.278, "learn_throughput": 410.371, "synch_weights_time_ms": 14.619}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "e552a_00000", "date": "2024-08-16_08-56-37", "timestamp": 1723778797, "time_this_iter_s": 11.20452880859375, "time_total_s": 607.3124899864197, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2251b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 607.3124899864197, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 34.98125, "ram_util_percent": 83.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.074598087646343, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.156194691935545, "policy_loss": -0.005624663299836573, "vf_loss": 9.15994532398446, "vf_explained_var": -0.02675949868071016, "kl": 0.00555265425324209, "entropy": 1.0930592454299726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.676539319816721, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.189814476235203, "policy_loss": -0.0028726098303826003, "vf_loss": 9.19208270077983, "vf_explained_var": -0.02440845568974813, "kl": 0.008058619765856765, "entropy": 1.1754950677907026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 424.2478959284955, "episode_reward_min": 192.08014097033669, "episode_reward_mean": 356.4288083530975, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.4161311091796, "predator_policy": 8.007608219690523}, "policy_reward_max": {"prey_policy": 193.99034907907074, "predator_policy": 376.4850938927628}, "policy_reward_mean": {"prey_policy": 81.65676562761118, "predator_policy": 96.5576385489375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4679770935285, 396.99270355546196, 340.3026564608352, 404.6044372730535, 302.95711702716727, 379.2916538198916, 380.855620052651, 395.63579953564204, 385.71557198725225, 383.6603754273528, 378.1437618649474, 367.4093811367371, 375.70724224255196, 353.4812448366817, 339.41393198838125, 368.21412906413514, 345.186414960755, 370.56095347713625, 363.3216869389451, 337.3128351127426, 374.74487663375254, 342.0639402882039, 265.5107109353617, 314.5824290205608, 359.5707061387791, 295.4873220229088, 192.08014097033669, 381.00776113570265, 365.12605282435146, 363.2323701416212, 344.24768638647527, 381.8976368724584, 353.2363058558513, 305.9875434559126, 295.61970814857546, 353.3548468277468, 374.0327408329392, 351.7189975624017, 334.76139976179735, 352.9843625704835, 373.8228911912734, 322.48366081160174, 369.03536086004385, 335.9993073880805, 334.2491171373102, 319.69810547999504, 358.27936434071785, 371.83904207508743, 342.79443416755385, 302.39772379802605, 340.64742832481016, 352.79082788124606, 346.4371643936957, 344.7697506380848, 350.16272880722056, 384.5648884219064, 364.495146443894, 295.0844084566655, 306.58042327646854, 389.9022196497651, 394.22044497208327, 354.99805639686554, 338.12400237625417, 362.8234686137773, 394.8332537738556, 389.0569335496829, 371.83947523744297, 356.7610723342418, 383.8869987479965, 342.3355305111401, 344.2690183284469, 340.63364006242136, 343.75811268442624, 326.80552943873425, 353.67764944473663, 338.5146280789677, 351.1785983207395, 366.5556279416547, 378.2331994013504, 377.257752278588, 382.7441617412323, 380.621471891566, 364.9328670472543, 371.20300220365374, 424.2478959284955, 343.5916205858813, 395.7421136796924, 371.17855268349234, 333.5889239684307, 397.0197211327072, 354.7291908367033, 360.72250547494076, 370.4223834904334, 386.78603047225624, 383.8163722041093, 378.95562059194316, 372.2834896890204, 348.18451333524513, 410.1667393292902, 365.66364074447205], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [141.52829819236845, 151.35311821875018, 186.25378489324657, 187.26709605265424, 98.89232512774416, 135.1861117210574, 111.78085029455767, 173.77424348573976, 103.63926698671492, 76.49995424471291, 171.16092371897972, 172.37049441281806, 163.3767638991322, 159.2855976965855, 173.74440949470178, 193.99034907907074, 189.7105291879819, 142.06909139258397, 181.1580647360852, 174.84504601963425, 163.6132225946264, 171.45392553916145, 136.67014757740273, 139.86609861799454, 171.08857489902167, 175.60469407791993, 144.49682529427267, 151.70208306352583, 137.54289666788577, 18.584780760606975, 129.59337993468898, 112.52287204022572, 121.34816974602685, 80.92512752752576, 157.32512600674835, 166.74621461092008, 164.71415955363963, 133.23996494119422, 101.9751752017323, 132.75418639645497, 159.50988478993182, 180.6342240727802, 94.9186636735269, 105.23420667222047, 123.53708671128709, -81.08897050284644, 58.8849947939908, 51.186175879609436, 95.7717212059614, 143.88029486196874, 121.84517201142282, 51.80919812479819, 6.011094337250702, 36.50284174126967, 19.47685428035551, 176.71956273494865, 142.67634972771327, 127.3417034000537, 163.1363256464774, 119.90785602686496, 122.4367049848075, 101.170106491975, 158.8722480221443, 157.89484513012334, 86.61790735190789, 15.631850890864406, 119.30746040123897, 101.47705233659413, 55.838063359968636, 17.11874962046569, 95.75455836413211, 126.5068633221006, 141.16525445490123, 144.40583258455055, 130.6309709406753, 126.90196018229814, 95.51204680144059, 96.57018529616248, 32.508878336180956, 69.91401211688729, 131.18284888694436, 149.52151909882514, 99.922879119212, 98.32453549284052, 135.18314081270074, 93.57832404939852, 100.95742033690681, 88.37089549996337, 41.40878796415422, -12.41234023371856, 61.38514466222796, 67.64477002901596, 106.36431908607, 77.7336646410862, 107.90671485351179, 89.15999427449651, 71.30600244394196, 88.51818267191167, 59.96438050166261, 33.19808059653153, 100.80826739260364, 75.0766742359564, 127.51756703644732, 99.79621428510598, 61.25028000388916, 92.87514990935203, 109.43679081253595, 75.07324001192943, 27.999468504123254, 51.71919206569376, 170.29324405935654, 148.25045569201694, 35.48798127319886, -33.06761363489492, 91.00808121416934, 69.65367865981676, 79.00049976028527, 35.577650270932985, 27.810101895693162, 1.1196148203621956, 13.158228743912666, -271.4161311091796, 15.599750240971149, 55.26849360958938, 72.51741973042672, 66.47964610640103, 83.30810163769472, 32.342730784366346, 142.65863093884585, 125.76063444584105, -42.54250585431426, 59.46385523784068, -133.42729013466558, 89.31021284087775, 79.44213345454584, 79.57489783188119, 20.148902772057692, 38.44368246239996, 15.374211851371935, 101.70404920143042, 52.99470525541273, 70.9178282557623, 59.62307347406998, 75.39835818521036, -4.029815014131772, 51.5270070015572, 56.6805175037744, 75.45826491767255, 93.15019631950481, 64.92959915749765, 17.165090026408873, -24.2058844636653, 110.14150901271283, 98.7197242293952, 139.67994259708493, 114.88450730274562, 106.64972552945225, 75.46810056968903, 103.02598770459977, 108.81430976245358, 35.39985609510188, 29.72094854769243, 18.611997885232135, 20.20203121518748, 44.2800327895356, 7.00718384019072, 49.90767575798872, 48.80706444572294, -17.609597538611172, -151.28715848429246, 60.26548010332654, 86.44675233609622, 75.08668542717693, 36.87488173957637, 34.03114038224888, 49.6672336596296, -20.49899488730793, 6.143472522236951, 71.93982998794631, 82.77539073277224, 13.64022635969617, 12.771028826558908, 59.049797780463386, 46.349675165843024, 52.62505567757202, 95.68642199001161, 81.77271896979332, 101.55358578208761, 36.10658709423348, 52.98004921265709, -10.314392908495536, 75.593308246274, 45.45813731342667, 50.616286438773855, -39.76782188004193, 23.2011894974034, 51.55529292887458, 31.90774745014439, 44.15500346142983, 18.788381296621505], "policy_predator_policy_reward": [19.423158785242506, 48.163401897167724, 15.464214389870374, 8.007608219690523, 44.384327137261785, 61.83989247477228, 65.45869716992372, 53.590646322832434, 74.38367098000845, 48.43422481573094, 20.853888974233147, 14.906346713860854, 39.84836298747536, 18.344895469458244, 15.443282167981959, 12.457758793887585, 13.58739505979403, 40.348556346892046, 10.116393179311581, 17.54087149232205, 29.166601836178028, 13.910011894981968, 16.081341097974253, 74.79179384336554, 18.59005263223657, 10.423920633373273, 40.50538660881746, 16.776949870065323, 120.58610530954559, 62.70014925034328, 28.274907881549133, 97.82296920767156, 106.93177636906077, 35.981341318141574, 29.121322231290293, 17.368290628177782, 20.584215365414295, 44.78334707869698, 16.085299078555142, 86.49817443599974, 19.571991238284102, 15.028776532756863, 106.58829652318721, 35.322773419269716, 118.71239209178664, 104.35020263513456, 50.33790950267516, 154.1733488442849, 28.076300144608926, 91.84238992623972, 96.4002759245903, 25.432675962097377, 70.17046166333967, 79.3957432284767, 54.12892977379934, 130.68241434659916, 71.90815694771253, 23.199842748872054, 63.44583788202388, 16.742350586254787, 50.83517900901557, 69.8056959006773, 14.530176236738718, 50.60036748345203, 122.48540130536534, 128.50114630771355, 51.51840625443013, 33.684624463649484, 98.00633337328372, 124.6565617948577, 109.80717420407457, 21.2862509374394, 19.257897432597282, 69.20375636088994, 40.84982037707694, 53.33624606235109, 37.14734485440379, 105.53182280979074, 92.45535062413659, 158.10612149327824, 40.42334449564415, 52.69517870985956, 36.84137177078407, 87.39487442876508, 92.89186644542391, 47.382029552521054, 119.0483439077775, 27.622647643432924, 148.68536519686626, 156.5673042100085, 76.64723323760322, 114.02095755114794, 109.64181041881477, 64.53957019474696, 81.02816395292894, 93.74416899415012, 75.40569395413361, 107.56455509756637, 36.85144503378227, 172.38381766604945, 131.857319554068, 32.905167142182165, 50.326272768601264, 75.15077379109154, 72.0753789723337, 120.23635550812111, 142.46865963312393, 17.791060180494963, 105.58900857951717, 164.855059657886, 30.733020502708527, 35.28816816782435, 191.1283123028952, 170.9464665026944, 112.10317045079513, 22.31947813188412, 55.27075963779843, 136.7315136074517, 201.0989062550521, 159.8735966786568, 275.9932534445874, 376.4850938927628, 141.67345315431535, 142.4563593919898, 148.45505374874193, 50.67188279068391, 115.41558492381007, 131.75705126790618, 64.78746590776218, 61.626522481405814, 206.9405056794799, 165.19507848667627, 210.75595748036616, 205.20059505086465, 59.54882858399371, 138.19521246382078, 139.85446203041013, 185.43995148312865, 127.24952198117481, 98.00774747716314, 109.56831441421717, 110.78817040305469, 103.67462047229704, 101.93758793084346, 67.0694859073595, 229.19143478964105, 170.8987062387219, 23.76804077856503, 129.20816114815023, 66.38969281958386, 212.96431845909467, 132.59110405712917, 52.593554703269525, 89.72381037536171, 54.027060473988364, 57.96411756783628, 107.64262273282758, 88.4727505693816, 94.02944116372764, 71.38801364780728, 152.0109207867041, 165.61243631173363, 173.43886538186922, 168.36857740927672, 132.89824915128636, 180.7474012662408, 110.96775503038965, 161.52050696955254, 363.75301088964045, 229.39164106175875, 127.94478272922238, 68.93460541723594, 130.86997806524448, 152.91056844769525, 122.95432674790914, 164.5258518937048, 45.97139793123488, 301.97304840226616, 144.4392414011476, 97.86525901084103, 158.64272821318337, 169.67520743726467, 100.79131477123691, 154.53171775739722, 92.80007940906766, 129.31082641378208, 95.03849116950441, 108.42123455087042, 176.25346836851412, 118.4762675287045, 181.97712933131854, 131.69957592284675, 175.1322800539371, 101.07678588288321, 182.18325864750582, 182.56788707037762, 155.18628413128903, 171.5174148189816, 148.28271587222545, 154.4375401141958]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6211750690165507, "mean_inference_ms": 1.938441086493877, "mean_action_processing_ms": 0.26079707208578307, "mean_env_wait_ms": 0.2343799145726554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038776397705078125, "StateBufferConnector_ms": 0.0046994686126708984, "ViewRequirementAgentConnector_ms": 0.10346388816833496}, "num_episodes": 18, "episode_return_max": 424.2478959284955, "episode_return_min": 192.08014097033669, "episode_return_mean": 356.4288083530975, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 360.136515676738, "num_env_steps_trained_throughput_per_sec": 360.136515676738, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 11226.073, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11226.032, "sample_time_ms": 1439.881, "learn_time_ms": 9769.756, "learn_throughput": 409.427, "synch_weights_time_ms": 14.732}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "e552a_00000", "date": "2024-08-16_08-56-49", "timestamp": 1723778809, "time_this_iter_s": 11.123481035232544, "time_total_s": 618.4359710216522, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7347820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 618.4359710216522, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 33.67333333333333, "ram_util_percent": 83.29333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.938276946134668, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.955545548534898, "policy_loss": -0.0045412135243948016, "vf_loss": 8.957727796816952, "vf_explained_var": -0.10104891913277762, "kl": 0.0069895851622910204, "entropy": 1.0957909777681663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.762384996969233, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.89191621169842, "policy_loss": -0.00860860782919363, "vf_loss": 8.899653489753684, "vf_explained_var": 0.03573679548722726, "kl": 0.011618037203825657, "entropy": 1.1294754098962854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 424.2478959284955, "episode_reward_min": 192.08014097033669, "episode_reward_mean": 359.62252386793006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.4161311091796, "predator_policy": 14.530176236738718}, "policy_reward_max": {"prey_policy": 180.6342240727802, "predator_policy": 376.4850938927628}, "policy_reward_mean": {"prey_policy": 62.86726828350937, "predator_policy": 116.94399365045567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.3216869389451, 337.3128351127426, 374.74487663375254, 342.0639402882039, 265.5107109353617, 314.5824290205608, 359.5707061387791, 295.4873220229088, 192.08014097033669, 381.00776113570265, 365.12605282435146, 363.2323701416212, 344.24768638647527, 381.8976368724584, 353.2363058558513, 305.9875434559126, 295.61970814857546, 353.3548468277468, 374.0327408329392, 351.7189975624017, 334.76139976179735, 352.9843625704835, 373.8228911912734, 322.48366081160174, 369.03536086004385, 335.9993073880805, 334.2491171373102, 319.69810547999504, 358.27936434071785, 371.83904207508743, 342.79443416755385, 302.39772379802605, 340.64742832481016, 352.79082788124606, 346.4371643936957, 344.7697506380848, 350.16272880722056, 384.5648884219064, 364.495146443894, 295.0844084566655, 306.58042327646854, 389.9022196497651, 394.22044497208327, 354.99805639686554, 338.12400237625417, 362.8234686137773, 394.8332537738556, 389.0569335496829, 371.83947523744297, 356.7610723342418, 383.8869987479965, 342.3355305111401, 344.2690183284469, 340.63364006242136, 343.75811268442624, 326.80552943873425, 353.67764944473663, 338.5146280789677, 351.1785983207395, 366.5556279416547, 378.2331994013504, 377.257752278588, 382.7441617412323, 380.621471891566, 364.9328670472543, 371.20300220365374, 424.2478959284955, 343.5916205858813, 395.7421136796924, 371.17855268349234, 333.5889239684307, 397.0197211327072, 354.7291908367033, 360.72250547494076, 370.4223834904334, 386.78603047225624, 383.8163722041093, 378.95562059194316, 372.2834896890204, 348.18451333524513, 410.1667393292902, 365.66364074447205, 388.5624781156531, 393.0836541795004, 403.73070514636703, 389.47783424528853, 400.14076682398974, 402.72197091535776, 379.43389839612746, 370.19978492880347, 385.4143375015579, 344.8596487116162, 381.21265982641654, 406.86790044039424, 372.95260585347216, 368.00988823590757, 382.9453980979059, 399.23585768432076, 371.2731645026025, 407.84996968215285], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.71415955363963, 133.23996494119422, 101.9751752017323, 132.75418639645497, 159.50988478993182, 180.6342240727802, 94.9186636735269, 105.23420667222047, 123.53708671128709, -81.08897050284644, 58.8849947939908, 51.186175879609436, 95.7717212059614, 143.88029486196874, 121.84517201142282, 51.80919812479819, 6.011094337250702, 36.50284174126967, 19.47685428035551, 176.71956273494865, 142.67634972771327, 127.3417034000537, 163.1363256464774, 119.90785602686496, 122.4367049848075, 101.170106491975, 158.8722480221443, 157.89484513012334, 86.61790735190789, 15.631850890864406, 119.30746040123897, 101.47705233659413, 55.838063359968636, 17.11874962046569, 95.75455836413211, 126.5068633221006, 141.16525445490123, 144.40583258455055, 130.6309709406753, 126.90196018229814, 95.51204680144059, 96.57018529616248, 32.508878336180956, 69.91401211688729, 131.18284888694436, 149.52151909882514, 99.922879119212, 98.32453549284052, 135.18314081270074, 93.57832404939852, 100.95742033690681, 88.37089549996337, 41.40878796415422, -12.41234023371856, 61.38514466222796, 67.64477002901596, 106.36431908607, 77.7336646410862, 107.90671485351179, 89.15999427449651, 71.30600244394196, 88.51818267191167, 59.96438050166261, 33.19808059653153, 100.80826739260364, 75.0766742359564, 127.51756703644732, 99.79621428510598, 61.25028000388916, 92.87514990935203, 109.43679081253595, 75.07324001192943, 27.999468504123254, 51.71919206569376, 170.29324405935654, 148.25045569201694, 35.48798127319886, -33.06761363489492, 91.00808121416934, 69.65367865981676, 79.00049976028527, 35.577650270932985, 27.810101895693162, 1.1196148203621956, 13.158228743912666, -271.4161311091796, 15.599750240971149, 55.26849360958938, 72.51741973042672, 66.47964610640103, 83.30810163769472, 32.342730784366346, 142.65863093884585, 125.76063444584105, -42.54250585431426, 59.46385523784068, -133.42729013466558, 89.31021284087775, 79.44213345454584, 79.57489783188119, 20.148902772057692, 38.44368246239996, 15.374211851371935, 101.70404920143042, 52.99470525541273, 70.9178282557623, 59.62307347406998, 75.39835818521036, -4.029815014131772, 51.5270070015572, 56.6805175037744, 75.45826491767255, 93.15019631950481, 64.92959915749765, 17.165090026408873, -24.2058844636653, 110.14150901271283, 98.7197242293952, 139.67994259708493, 114.88450730274562, 106.64972552945225, 75.46810056968903, 103.02598770459977, 108.81430976245358, 35.39985609510188, 29.72094854769243, 18.611997885232135, 20.20203121518748, 44.2800327895356, 7.00718384019072, 49.90767575798872, 48.80706444572294, -17.609597538611172, -151.28715848429246, 60.26548010332654, 86.44675233609622, 75.08668542717693, 36.87488173957637, 34.03114038224888, 49.6672336596296, -20.49899488730793, 6.143472522236951, 71.93982998794631, 82.77539073277224, 13.64022635969617, 12.771028826558908, 59.049797780463386, 46.349675165843024, 52.62505567757202, 95.68642199001161, 81.77271896979332, 101.55358578208761, 36.10658709423348, 52.98004921265709, -10.314392908495536, 75.593308246274, 45.45813731342667, 50.616286438773855, -39.76782188004193, 23.2011894974034, 51.55529292887458, 31.90774745014439, 44.15500346142983, 18.788381296621505, 54.70478314194593, 61.668201271998626, 31.4668967809778, 48.717581840246964, 80.28611121596994, 7.697110302176043, -16.81640918435622, 38.87697798781425, 68.77801664416579, 32.65003348197203, 69.40597065772438, 95.01952235565633, 62.28971353687652, 58.51032223888166, 88.0846272305262, 68.91532165834025, 28.422737796903018, 81.48735451468657, 22.536252246475915, -8.039890890636475, 0.41617597720415556, 45.55422432328826, -13.171491148281774, 121.87489902269964, 15.509836373649646, -16.82986096214502, 59.29160435740932, 63.93349065473522, 39.98473675275833, -2.81687417230924, 72.81463844383629, 108.72942917211334, 37.120771582814875, 27.308980578340652, -38.740392616794146, 13.4295858256455], "policy_predator_policy_reward": [20.584215365414295, 44.78334707869698, 16.085299078555142, 86.49817443599974, 19.571991238284102, 15.028776532756863, 106.58829652318721, 35.322773419269716, 118.71239209178664, 104.35020263513456, 50.33790950267516, 154.1733488442849, 28.076300144608926, 91.84238992623972, 96.4002759245903, 25.432675962097377, 70.17046166333967, 79.3957432284767, 54.12892977379934, 130.68241434659916, 71.90815694771253, 23.199842748872054, 63.44583788202388, 16.742350586254787, 50.83517900901557, 69.8056959006773, 14.530176236738718, 50.60036748345203, 122.48540130536534, 128.50114630771355, 51.51840625443013, 33.684624463649484, 98.00633337328372, 124.6565617948577, 109.80717420407457, 21.2862509374394, 19.257897432597282, 69.20375636088994, 40.84982037707694, 53.33624606235109, 37.14734485440379, 105.53182280979074, 92.45535062413659, 158.10612149327824, 40.42334449564415, 52.69517870985956, 36.84137177078407, 87.39487442876508, 92.89186644542391, 47.382029552521054, 119.0483439077775, 27.622647643432924, 148.68536519686626, 156.5673042100085, 76.64723323760322, 114.02095755114794, 109.64181041881477, 64.53957019474696, 81.02816395292894, 93.74416899415012, 75.40569395413361, 107.56455509756637, 36.85144503378227, 172.38381766604945, 131.857319554068, 32.905167142182165, 50.326272768601264, 75.15077379109154, 72.0753789723337, 120.23635550812111, 142.46865963312393, 17.791060180494963, 105.58900857951717, 164.855059657886, 30.733020502708527, 35.28816816782435, 191.1283123028952, 170.9464665026944, 112.10317045079513, 22.31947813188412, 55.27075963779843, 136.7315136074517, 201.0989062550521, 159.8735966786568, 275.9932534445874, 376.4850938927628, 141.67345315431535, 142.4563593919898, 148.45505374874193, 50.67188279068391, 115.41558492381007, 131.75705126790618, 64.78746590776218, 61.626522481405814, 206.9405056794799, 165.19507848667627, 210.75595748036616, 205.20059505086465, 59.54882858399371, 138.19521246382078, 139.85446203041013, 185.43995148312865, 127.24952198117481, 98.00774747716314, 109.56831441421717, 110.78817040305469, 103.67462047229704, 101.93758793084346, 67.0694859073595, 229.19143478964105, 170.8987062387219, 23.76804077856503, 129.20816114815023, 66.38969281958386, 212.96431845909467, 132.59110405712917, 52.593554703269525, 89.72381037536171, 54.027060473988364, 57.96411756783628, 107.64262273282758, 88.4727505693816, 94.02944116372764, 71.38801364780728, 152.0109207867041, 165.61243631173363, 173.43886538186922, 168.36857740927672, 132.89824915128636, 180.7474012662408, 110.96775503038965, 161.52050696955254, 363.75301088964045, 229.39164106175875, 127.94478272922238, 68.93460541723594, 130.86997806524448, 152.91056844769525, 122.95432674790914, 164.5258518937048, 45.97139793123488, 301.97304840226616, 144.4392414011476, 97.86525901084103, 158.64272821318337, 169.67520743726467, 100.79131477123691, 154.53171775739722, 92.80007940906766, 129.31082641378208, 95.03849116950441, 108.42123455087042, 176.25346836851412, 118.4762675287045, 181.97712933131854, 131.69957592284675, 175.1322800539371, 101.07678588288321, 182.18325864750582, 182.56788707037762, 155.18628413128903, 171.5174148189816, 148.28271587222545, 154.4375401141958, 146.85177222176557, 125.33772147994296, 176.7213815754967, 136.17779398277838, 200.16729896898758, 115.58018465923307, 140.1390390405743, 227.27822640125632, 137.47160534652136, 161.2411113513309, 141.74512421340864, 96.55135368856821, 123.92028720409961, 134.71357541626935, 107.18846763062602, 106.01136840931123, 144.45327293596395, 131.0509722540045, 177.9656367429743, 152.3976506128024, 204.23488400012093, 131.00737552580244, 134.04664470108517, 164.1178478648912, 193.58586120532473, 180.6867692366425, 143.4408935055369, 101.34389971822563, 197.15991209087392, 148.6176234265831, 79.22257437708552, 138.46921569128583, 101.82458475756185, 205.01882758388467, 235.8596878374644, 197.30108863583743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208664013537712, "mean_inference_ms": 1.9379119615491214, "mean_action_processing_ms": 0.26051116077718234, "mean_env_wait_ms": 0.23426859908622014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038923025131225586, "StateBufferConnector_ms": 0.004915118217468262, "ViewRequirementAgentConnector_ms": 0.1069948673248291}, "num_episodes": 18, "episode_return_max": 424.2478959284955, "episode_return_min": 192.08014097033669, "episode_return_mean": 359.62252386793006, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.5329342091582, "num_env_steps_trained_throughput_per_sec": 361.5329342091582, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 11229.586, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11229.545, "sample_time_ms": 1452.683, "learn_time_ms": 9760.773, "learn_throughput": 409.804, "synch_weights_time_ms": 14.482}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-00", "timestamp": 1723778820, "time_this_iter_s": 11.133842945098877, "time_total_s": 629.5698139667511, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72d6a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 629.5698139667511, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 31.137500000000003, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0078636993176096, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.031532344868575, "policy_loss": -0.005258092142779518, "vf_loss": 8.033264057219975, "vf_explained_var": -0.1430535197573364, "kl": 0.010448518934480731, "entropy": 1.0622323899042039, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.600784816943779, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.55548121437194, "policy_loss": -0.011553505959146946, "vf_loss": 8.566013104827316, "vf_explained_var": -0.024651691396400412, "kl": 0.01362160306517286, "entropy": 1.0816104610761006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 467.6014319978015, "episode_reward_min": 295.0844084566655, "episode_reward_mean": 373.06845255536217, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.4161311091796, "predator_policy": 17.791060180494963}, "policy_reward_max": {"prey_policy": 170.29324405935654, "predator_policy": 376.4850938927628}, "policy_reward_mean": {"prey_policy": 54.92778247888691, "predator_policy": 131.60644379879417}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.8228911912734, 322.48366081160174, 369.03536086004385, 335.9993073880805, 334.2491171373102, 319.69810547999504, 358.27936434071785, 371.83904207508743, 342.79443416755385, 302.39772379802605, 340.64742832481016, 352.79082788124606, 346.4371643936957, 344.7697506380848, 350.16272880722056, 384.5648884219064, 364.495146443894, 295.0844084566655, 306.58042327646854, 389.9022196497651, 394.22044497208327, 354.99805639686554, 338.12400237625417, 362.8234686137773, 394.8332537738556, 389.0569335496829, 371.83947523744297, 356.7610723342418, 383.8869987479965, 342.3355305111401, 344.2690183284469, 340.63364006242136, 343.75811268442624, 326.80552943873425, 353.67764944473663, 338.5146280789677, 351.1785983207395, 366.5556279416547, 378.2331994013504, 377.257752278588, 382.7441617412323, 380.621471891566, 364.9328670472543, 371.20300220365374, 424.2478959284955, 343.5916205858813, 395.7421136796924, 371.17855268349234, 333.5889239684307, 397.0197211327072, 354.7291908367033, 360.72250547494076, 370.4223834904334, 386.78603047225624, 383.8163722041093, 378.95562059194316, 372.2834896890204, 348.18451333524513, 410.1667393292902, 365.66364074447205, 388.5624781156531, 393.0836541795004, 403.73070514636703, 389.47783424528853, 400.14076682398974, 402.72197091535776, 379.43389839612746, 370.19978492880347, 385.4143375015579, 344.8596487116162, 381.21265982641654, 406.86790044039424, 372.95260585347216, 368.00988823590757, 382.9453980979059, 399.23585768432076, 371.2731645026025, 407.84996968215285, 367.6587186871555, 438.6390125708521, 365.9512241574651, 356.4905788630989, 402.42352278011947, 431.89207738151737, 405.48903305065437, 392.9145242276296, 467.6014319978015, 379.5827924478827, 387.95009079308016, 411.4314867877689, 359.0380144130686, 381.31137016260055, 368.55605604094416, 456.3023524423931, 380.6684803052025, 423.925731844632, 383.42449758260733, 385.6121190910292, 393.5606434105173, 406.0511701430947], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [131.18284888694436, 149.52151909882514, 99.922879119212, 98.32453549284052, 135.18314081270074, 93.57832404939852, 100.95742033690681, 88.37089549996337, 41.40878796415422, -12.41234023371856, 61.38514466222796, 67.64477002901596, 106.36431908607, 77.7336646410862, 107.90671485351179, 89.15999427449651, 71.30600244394196, 88.51818267191167, 59.96438050166261, 33.19808059653153, 100.80826739260364, 75.0766742359564, 127.51756703644732, 99.79621428510598, 61.25028000388916, 92.87514990935203, 109.43679081253595, 75.07324001192943, 27.999468504123254, 51.71919206569376, 170.29324405935654, 148.25045569201694, 35.48798127319886, -33.06761363489492, 91.00808121416934, 69.65367865981676, 79.00049976028527, 35.577650270932985, 27.810101895693162, 1.1196148203621956, 13.158228743912666, -271.4161311091796, 15.599750240971149, 55.26849360958938, 72.51741973042672, 66.47964610640103, 83.30810163769472, 32.342730784366346, 142.65863093884585, 125.76063444584105, -42.54250585431426, 59.46385523784068, -133.42729013466558, 89.31021284087775, 79.44213345454584, 79.57489783188119, 20.148902772057692, 38.44368246239996, 15.374211851371935, 101.70404920143042, 52.99470525541273, 70.9178282557623, 59.62307347406998, 75.39835818521036, -4.029815014131772, 51.5270070015572, 56.6805175037744, 75.45826491767255, 93.15019631950481, 64.92959915749765, 17.165090026408873, -24.2058844636653, 110.14150901271283, 98.7197242293952, 139.67994259708493, 114.88450730274562, 106.64972552945225, 75.46810056968903, 103.02598770459977, 108.81430976245358, 35.39985609510188, 29.72094854769243, 18.611997885232135, 20.20203121518748, 44.2800327895356, 7.00718384019072, 49.90767575798872, 48.80706444572294, -17.609597538611172, -151.28715848429246, 60.26548010332654, 86.44675233609622, 75.08668542717693, 36.87488173957637, 34.03114038224888, 49.6672336596296, -20.49899488730793, 6.143472522236951, 71.93982998794631, 82.77539073277224, 13.64022635969617, 12.771028826558908, 59.049797780463386, 46.349675165843024, 52.62505567757202, 95.68642199001161, 81.77271896979332, 101.55358578208761, 36.10658709423348, 52.98004921265709, -10.314392908495536, 75.593308246274, 45.45813731342667, 50.616286438773855, -39.76782188004193, 23.2011894974034, 51.55529292887458, 31.90774745014439, 44.15500346142983, 18.788381296621505, 54.70478314194593, 61.668201271998626, 31.4668967809778, 48.717581840246964, 80.28611121596994, 7.697110302176043, -16.81640918435622, 38.87697798781425, 68.77801664416579, 32.65003348197203, 69.40597065772438, 95.01952235565633, 62.28971353687652, 58.51032223888166, 88.0846272305262, 68.91532165834025, 28.422737796903018, 81.48735451468657, 22.536252246475915, -8.039890890636475, 0.41617597720415556, 45.55422432328826, -13.171491148281774, 121.87489902269964, 15.509836373649646, -16.82986096214502, 59.29160435740932, 63.93349065473522, 39.98473675275833, -2.81687417230924, 72.81463844383629, 108.72942917211334, 37.120771582814875, 27.308980578340652, -38.740392616794146, 13.4295858256455, 47.1157168925622, 38.73115752393966, 134.4959482888922, 72.34953571819605, 37.35278500375499, 45.03880699768858, 64.71024495495809, -51.85636913730038, 44.53653798160003, 101.38073785889587, 48.79512957667912, 120.5745880016808, 39.083208012806956, 45.934594858248275, 136.16473016090575, 136.79263179738695, 84.59132972750383, 13.438257078372143, 76.61896099947481, 57.918463852533165, 99.2669829533664, 67.30825595738457, 69.52462379789245, 73.10192631918923, -40.458829586746276, 66.92640554780542, 58.80955863059391, 34.36499274860592, 34.18906801622665, 107.77493942980261, 144.17526106454056, 15.419139165021148, 17.05990503898978, 97.99879193917734, 96.3238224914206, 80.27172972689738, 99.51592155885092, 101.60045017927501, -30.350187978849306, -3.5009514228168386, 42.796207358058446, 71.37565593819608, 96.70242476737802, 144.95402655849523], "policy_predator_policy_reward": [40.42334449564415, 52.69517870985956, 36.84137177078407, 87.39487442876508, 92.89186644542391, 47.382029552521054, 119.0483439077775, 27.622647643432924, 148.68536519686626, 156.5673042100085, 76.64723323760322, 114.02095755114794, 109.64181041881477, 64.53957019474696, 81.02816395292894, 93.74416899415012, 75.40569395413361, 107.56455509756637, 36.85144503378227, 172.38381766604945, 131.857319554068, 32.905167142182165, 50.326272768601264, 75.15077379109154, 72.0753789723337, 120.23635550812111, 142.46865963312393, 17.791060180494963, 105.58900857951717, 164.855059657886, 30.733020502708527, 35.28816816782435, 191.1283123028952, 170.9464665026944, 112.10317045079513, 22.31947813188412, 55.27075963779843, 136.7315136074517, 201.0989062550521, 159.8735966786568, 275.9932534445874, 376.4850938927628, 141.67345315431535, 142.4563593919898, 148.45505374874193, 50.67188279068391, 115.41558492381007, 131.75705126790618, 64.78746590776218, 61.626522481405814, 206.9405056794799, 165.19507848667627, 210.75595748036616, 205.20059505086465, 59.54882858399371, 138.19521246382078, 139.85446203041013, 185.43995148312865, 127.24952198117481, 98.00774747716314, 109.56831441421717, 110.78817040305469, 103.67462047229704, 101.93758793084346, 67.0694859073595, 229.19143478964105, 170.8987062387219, 23.76804077856503, 129.20816114815023, 66.38969281958386, 212.96431845909467, 132.59110405712917, 52.593554703269525, 89.72381037536171, 54.027060473988364, 57.96411756783628, 107.64262273282758, 88.4727505693816, 94.02944116372764, 71.38801364780728, 152.0109207867041, 165.61243631173363, 173.43886538186922, 168.36857740927672, 132.89824915128636, 180.7474012662408, 110.96775503038965, 161.52050696955254, 363.75301088964045, 229.39164106175875, 127.94478272922238, 68.93460541723594, 130.86997806524448, 152.91056844769525, 122.95432674790914, 164.5258518937048, 45.97139793123488, 301.97304840226616, 144.4392414011476, 97.86525901084103, 158.64272821318337, 169.67520743726467, 100.79131477123691, 154.53171775739722, 92.80007940906766, 129.31082641378208, 95.03849116950441, 108.42123455087042, 176.25346836851412, 118.4762675287045, 181.97712933131854, 131.69957592284675, 175.1322800539371, 101.07678588288321, 182.18325864750582, 182.56788707037762, 155.18628413128903, 171.5174148189816, 148.28271587222545, 154.4375401141958, 146.85177222176557, 125.33772147994296, 176.7213815754967, 136.17779398277838, 200.16729896898758, 115.58018465923307, 140.1390390405743, 227.27822640125632, 137.47160534652136, 161.2411113513309, 141.74512421340864, 96.55135368856821, 123.92028720409961, 134.71357541626935, 107.18846763062602, 106.01136840931123, 144.45327293596395, 131.0509722540045, 177.9656367429743, 152.3976506128024, 204.23488400012093, 131.00737552580244, 134.04664470108517, 164.1178478648912, 193.58586120532473, 180.6867692366425, 143.4408935055369, 101.34389971822563, 197.15991209087392, 148.6176234265831, 79.22257437708552, 138.46921569128583, 101.82458475756185, 205.01882758388467, 235.8596878374644, 197.30108863583743, 183.45220416107398, 98.35964010957984, 146.91431162597354, 84.87921693779049, 175.13221224745135, 108.42741990857068, 161.56587940808924, 182.07082363735188, 143.8219450357848, 112.68430190383867, 155.56547067912908, 106.95688912402808, 158.22066413131645, 162.2505660482831, 51.612711614608266, 68.34445065472863, 201.61318448389454, 167.95866070803035, 119.65053042060823, 125.3948371752661, 133.50917929974844, 87.86567258258108, 143.59037793946376, 125.21455873122385, 207.31660698431025, 125.2538314676997, 139.24197761841916, 148.89484116498141, 133.71424032124665, 92.87780827366792, 155.17101839734704, 141.53693381548416, 109.89142720125994, 155.71835612577487, 122.98026789085881, 124.34991173545593, 94.71774783425525, 87.59037801022696, 174.900652332019, 244.56260616067595, 144.39781576080313, 134.99096435346007, 84.3542836251745, 80.04043519204707]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6198416526445345, "mean_inference_ms": 1.9386506008148399, "mean_action_processing_ms": 0.2599255137710519, "mean_env_wait_ms": 0.2341321150873367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003825068473815918, "StateBufferConnector_ms": 0.0033932924270629883, "ViewRequirementAgentConnector_ms": 0.10624969005584717}, "num_episodes": 22, "episode_return_max": 467.6014319978015, "episode_return_min": 295.0844084566655, "episode_return_mean": 373.06845255536217, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.5883139477827, "num_env_steps_trained_throughput_per_sec": 368.5883139477827, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 11170.956, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11170.916, "sample_time_ms": 1429.198, "learn_time_ms": 9725.742, "learn_throughput": 411.28, "synch_weights_time_ms": 14.552}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-11", "timestamp": 1723778831, "time_this_iter_s": 10.859111070632935, "time_total_s": 640.428925037384, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 640.428925037384, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.54375, "ram_util_percent": 83.50625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.875701075760776, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.368238105975761, "policy_loss": -0.001242746451559166, "vf_loss": 8.367818643933251, "vf_explained_var": -0.06571701134323443, "kl": 0.004924955471836771, "entropy": 1.0181475577215668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.517442372740891, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.638161398620202, "policy_loss": -0.010384862509152049, "vf_loss": 8.647512462656334, "vf_explained_var": 0.06335824103582473, "kl": 0.013783860015732827, "entropy": 1.0513812890443852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 467.6014319978015, "episode_reward_min": 306.58042327646854, "episode_reward_mean": 386.205703877055, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -271.4161311091796, "predator_policy": 23.76804077856503}, "policy_reward_max": {"prey_policy": 170.47713520840696, "predator_policy": 376.4850938927628}, "policy_reward_mean": {"prey_policy": 56.44844427012988, "predator_policy": 136.65440766839754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.58042327646854, 389.9022196497651, 394.22044497208327, 354.99805639686554, 338.12400237625417, 362.8234686137773, 394.8332537738556, 389.0569335496829, 371.83947523744297, 356.7610723342418, 383.8869987479965, 342.3355305111401, 344.2690183284469, 340.63364006242136, 343.75811268442624, 326.80552943873425, 353.67764944473663, 338.5146280789677, 351.1785983207395, 366.5556279416547, 378.2331994013504, 377.257752278588, 382.7441617412323, 380.621471891566, 364.9328670472543, 371.20300220365374, 424.2478959284955, 343.5916205858813, 395.7421136796924, 371.17855268349234, 333.5889239684307, 397.0197211327072, 354.7291908367033, 360.72250547494076, 370.4223834904334, 386.78603047225624, 383.8163722041093, 378.95562059194316, 372.2834896890204, 348.18451333524513, 410.1667393292902, 365.66364074447205, 388.5624781156531, 393.0836541795004, 403.73070514636703, 389.47783424528853, 400.14076682398974, 402.72197091535776, 379.43389839612746, 370.19978492880347, 385.4143375015579, 344.8596487116162, 381.21265982641654, 406.86790044039424, 372.95260585347216, 368.00988823590757, 382.9453980979059, 399.23585768432076, 371.2731645026025, 407.84996968215285, 367.6587186871555, 438.6390125708521, 365.9512241574651, 356.4905788630989, 402.42352278011947, 431.89207738151737, 405.48903305065437, 392.9145242276296, 467.6014319978015, 379.5827924478827, 387.95009079308016, 411.4314867877689, 359.0380144130686, 381.31137016260055, 368.55605604094416, 456.3023524423931, 380.6684803052025, 423.925731844632, 383.42449758260733, 385.6121190910292, 393.5606434105173, 406.0511701430947, 436.4617704095695, 445.40195016060306, 427.4661136812429, 396.6958490863319, 409.64939283053434, 416.3851689864231, 461.0725527964647, 428.8599611827134, 368.5951160032709, 393.0861318055483, 401.401497446755, 452.56244358516267, 409.0373384616157, 418.08802074524635, 402.71333966773045, 421.2671315144595, 422.0382421287618, 412.4944622940482], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.00049976028527, 35.577650270932985, 27.810101895693162, 1.1196148203621956, 13.158228743912666, -271.4161311091796, 15.599750240971149, 55.26849360958938, 72.51741973042672, 66.47964610640103, 83.30810163769472, 32.342730784366346, 142.65863093884585, 125.76063444584105, -42.54250585431426, 59.46385523784068, -133.42729013466558, 89.31021284087775, 79.44213345454584, 79.57489783188119, 20.148902772057692, 38.44368246239996, 15.374211851371935, 101.70404920143042, 52.99470525541273, 70.9178282557623, 59.62307347406998, 75.39835818521036, -4.029815014131772, 51.5270070015572, 56.6805175037744, 75.45826491767255, 93.15019631950481, 64.92959915749765, 17.165090026408873, -24.2058844636653, 110.14150901271283, 98.7197242293952, 139.67994259708493, 114.88450730274562, 106.64972552945225, 75.46810056968903, 103.02598770459977, 108.81430976245358, 35.39985609510188, 29.72094854769243, 18.611997885232135, 20.20203121518748, 44.2800327895356, 7.00718384019072, 49.90767575798872, 48.80706444572294, -17.609597538611172, -151.28715848429246, 60.26548010332654, 86.44675233609622, 75.08668542717693, 36.87488173957637, 34.03114038224888, 49.6672336596296, -20.49899488730793, 6.143472522236951, 71.93982998794631, 82.77539073277224, 13.64022635969617, 12.771028826558908, 59.049797780463386, 46.349675165843024, 52.62505567757202, 95.68642199001161, 81.77271896979332, 101.55358578208761, 36.10658709423348, 52.98004921265709, -10.314392908495536, 75.593308246274, 45.45813731342667, 50.616286438773855, -39.76782188004193, 23.2011894974034, 51.55529292887458, 31.90774745014439, 44.15500346142983, 18.788381296621505, 54.70478314194593, 61.668201271998626, 31.4668967809778, 48.717581840246964, 80.28611121596994, 7.697110302176043, -16.81640918435622, 38.87697798781425, 68.77801664416579, 32.65003348197203, 69.40597065772438, 95.01952235565633, 62.28971353687652, 58.51032223888166, 88.0846272305262, 68.91532165834025, 28.422737796903018, 81.48735451468657, 22.536252246475915, -8.039890890636475, 0.41617597720415556, 45.55422432328826, -13.171491148281774, 121.87489902269964, 15.509836373649646, -16.82986096214502, 59.29160435740932, 63.93349065473522, 39.98473675275833, -2.81687417230924, 72.81463844383629, 108.72942917211334, 37.120771582814875, 27.308980578340652, -38.740392616794146, 13.4295858256455, 47.1157168925622, 38.73115752393966, 134.4959482888922, 72.34953571819605, 37.35278500375499, 45.03880699768858, 64.71024495495809, -51.85636913730038, 44.53653798160003, 101.38073785889587, 48.79512957667912, 120.5745880016808, 39.083208012806956, 45.934594858248275, 136.16473016090575, 136.79263179738695, 84.59132972750383, 13.438257078372143, 76.61896099947481, 57.918463852533165, 99.2669829533664, 67.30825595738457, 69.52462379789245, 73.10192631918923, -40.458829586746276, 66.92640554780542, 58.80955863059391, 34.36499274860592, 34.18906801622665, 107.77493942980261, 144.17526106454056, 15.419139165021148, 17.05990503898978, 97.99879193917734, 96.3238224914206, 80.27172972689738, 99.51592155885092, 101.60045017927501, -30.350187978849306, -3.5009514228168386, 42.796207358058446, 71.37565593819608, 96.70242476737802, 144.95402655849523, 102.01478619979193, 170.47713520840696, 129.25005103795732, 71.56205554249802, 118.83180727593889, 38.121917273064184, -18.052588509728025, 58.696819401385326, 21.444785817483304, 89.15114907224226, 143.16621542856421, 86.38639369499454, 63.92454402057874, 149.69082057906698, 153.78028123022335, 88.00497797893276, 68.22282928130105, 122.62518640184283, 151.1380447223101, 164.01840995307438, 93.67389206125449, 93.6349447801683, 43.01298945800236, 161.89006741203718, 131.77717304924704, 84.3572686360426, 83.28543364638172, 156.35624614507282, 70.58713843257094, 26.026109614466275, 34.50022429112692, 113.95442563423101, 136.5899047554119, 75.640322969959, -5.172192312566241, 23.960724374244162], "policy_predator_policy_reward": [55.27075963779843, 136.7315136074517, 201.0989062550521, 159.8735966786568, 275.9932534445874, 376.4850938927628, 141.67345315431535, 142.4563593919898, 148.45505374874193, 50.67188279068391, 115.41558492381007, 131.75705126790618, 64.78746590776218, 61.626522481405814, 206.9405056794799, 165.19507848667627, 210.75595748036616, 205.20059505086465, 59.54882858399371, 138.19521246382078, 139.85446203041013, 185.43995148312865, 127.24952198117481, 98.00774747716314, 109.56831441421717, 110.78817040305469, 103.67462047229704, 101.93758793084346, 67.0694859073595, 229.19143478964105, 170.8987062387219, 23.76804077856503, 129.20816114815023, 66.38969281958386, 212.96431845909467, 132.59110405712917, 52.593554703269525, 89.72381037536171, 54.027060473988364, 57.96411756783628, 107.64262273282758, 88.4727505693816, 94.02944116372764, 71.38801364780728, 152.0109207867041, 165.61243631173363, 173.43886538186922, 168.36857740927672, 132.89824915128636, 180.7474012662408, 110.96775503038965, 161.52050696955254, 363.75301088964045, 229.39164106175875, 127.94478272922238, 68.93460541723594, 130.86997806524448, 152.91056844769525, 122.95432674790914, 164.5258518937048, 45.97139793123488, 301.97304840226616, 144.4392414011476, 97.86525901084103, 158.64272821318337, 169.67520743726467, 100.79131477123691, 154.53171775739722, 92.80007940906766, 129.31082641378208, 95.03849116950441, 108.42123455087042, 176.25346836851412, 118.4762675287045, 181.97712933131854, 131.69957592284675, 175.1322800539371, 101.07678588288321, 182.18325864750582, 182.56788707037762, 155.18628413128903, 171.5174148189816, 148.28271587222545, 154.4375401141958, 146.85177222176557, 125.33772147994296, 176.7213815754967, 136.17779398277838, 200.16729896898758, 115.58018465923307, 140.1390390405743, 227.27822640125632, 137.47160534652136, 161.2411113513309, 141.74512421340864, 96.55135368856821, 123.92028720409961, 134.71357541626935, 107.18846763062602, 106.01136840931123, 144.45327293596395, 131.0509722540045, 177.9656367429743, 152.3976506128024, 204.23488400012093, 131.00737552580244, 134.04664470108517, 164.1178478648912, 193.58586120532473, 180.6867692366425, 143.4408935055369, 101.34389971822563, 197.15991209087392, 148.6176234265831, 79.22257437708552, 138.46921569128583, 101.82458475756185, 205.01882758388467, 235.8596878374644, 197.30108863583743, 183.45220416107398, 98.35964010957984, 146.91431162597354, 84.87921693779049, 175.13221224745135, 108.42741990857068, 161.56587940808924, 182.07082363735188, 143.8219450357848, 112.68430190383867, 155.56547067912908, 106.95688912402808, 158.22066413131645, 162.2505660482831, 51.612711614608266, 68.34445065472863, 201.61318448389454, 167.95866070803035, 119.65053042060823, 125.3948371752661, 133.50917929974844, 87.86567258258108, 143.59037793946376, 125.21455873122385, 207.31660698431025, 125.2538314676997, 139.24197761841916, 148.89484116498141, 133.71424032124665, 92.87780827366792, 155.17101839734704, 141.53693381548416, 109.89142720125994, 155.71835612577487, 122.98026789085881, 124.34991173545593, 94.71774783425525, 87.59037801022696, 174.900652332019, 244.56260616067595, 144.39781576080313, 134.99096435346007, 84.3542836251745, 80.04043519204707, 93.62042998720516, 70.34941901416498, 132.09591847379107, 112.49392510635708, 156.10618886527266, 114.4062002669666, 182.81500377057387, 173.2366144241001, 114.82938300008533, 184.22407494072309, 87.42165921272564, 99.41090065013876, 131.86599440914216, 115.59119378767663, 96.83785863112016, 90.23684334243741, 67.29969889244279, 110.44740142768381, 52.30609121371363, 25.62358591645011, 106.7789899227956, 107.31367068253655, 116.1460023935282, 131.51338432159403, 78.1965929289311, 114.70630384739482, 81.44233870847259, 97.00400224531984, 151.12257394665815, 154.97751767403528, 137.4252315472187, 135.3872500418825, 78.65740795325337, 131.15060645013747, 187.70505055027198, 206.00087968209814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6198097204128967, "mean_inference_ms": 1.9351479501256386, "mean_action_processing_ms": 0.25974609695438766, "mean_env_wait_ms": 0.23399692876286185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039479732513427734, "StateBufferConnector_ms": 0.004755973815917969, "ViewRequirementAgentConnector_ms": 0.10883867740631104}, "num_episodes": 18, "episode_return_max": 467.6014319978015, "episode_return_min": 306.58042327646854, "episode_return_mean": 386.205703877055, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.73547494033664, "num_env_steps_trained_throughput_per_sec": 369.73547494033664, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 11109.274, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11109.234, "sample_time_ms": 1415.585, "learn_time_ms": 9677.464, "learn_throughput": 413.331, "synch_weights_time_ms": 14.822}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-22", "timestamp": 1723778842, "time_this_iter_s": 10.903109073638916, "time_total_s": 651.332034111023, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 651.332034111023, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 34.43333333333333, "ram_util_percent": 83.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.702394505026479, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.040977583486567, "policy_loss": -0.003975372255666468, "vf_loss": 8.043363455111388, "vf_explained_var": -0.0006489445292760456, "kl": 0.00941904791774957, "entropy": 0.972039395570755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.566364641416641, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.465089339049404, "policy_loss": -0.00648702380503651, "vf_loss": 8.4707868518022, "vf_explained_var": 0.050944909563771, "kl": 0.010526852999633034, "entropy": 1.0379408416924654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 574.433305725479, "episode_reward_min": 333.5889239684307, "episode_reward_mean": 398.89311796452307, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -246.79291488516617, "predator_policy": 25.62358591645011}, "policy_reward_max": {"prey_policy": 182.82788919302385, "predator_policy": 363.75301088964045}, "policy_reward_mean": {"prey_policy": 67.59306013416597, "predator_policy": 131.8534988480956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.621471891566, 364.9328670472543, 371.20300220365374, 424.2478959284955, 343.5916205858813, 395.7421136796924, 371.17855268349234, 333.5889239684307, 397.0197211327072, 354.7291908367033, 360.72250547494076, 370.4223834904334, 386.78603047225624, 383.8163722041093, 378.95562059194316, 372.2834896890204, 348.18451333524513, 410.1667393292902, 365.66364074447205, 388.5624781156531, 393.0836541795004, 403.73070514636703, 389.47783424528853, 400.14076682398974, 402.72197091535776, 379.43389839612746, 370.19978492880347, 385.4143375015579, 344.8596487116162, 381.21265982641654, 406.86790044039424, 372.95260585347216, 368.00988823590757, 382.9453980979059, 399.23585768432076, 371.2731645026025, 407.84996968215285, 367.6587186871555, 438.6390125708521, 365.9512241574651, 356.4905788630989, 402.42352278011947, 431.89207738151737, 405.48903305065437, 392.9145242276296, 467.6014319978015, 379.5827924478827, 387.95009079308016, 411.4314867877689, 359.0380144130686, 381.31137016260055, 368.55605604094416, 456.3023524423931, 380.6684803052025, 423.925731844632, 383.42449758260733, 385.6121190910292, 393.5606434105173, 406.0511701430947, 436.4617704095695, 445.40195016060306, 427.4661136812429, 396.6958490863319, 409.64939283053434, 416.3851689864231, 461.0725527964647, 428.8599611827134, 368.5951160032709, 393.0861318055483, 401.401497446755, 452.56244358516267, 409.0373384616157, 418.08802074524635, 402.71333966773045, 421.2671315144595, 422.0382421287618, 412.4944622940482, 367.06179904001465, 399.81106827957024, 412.26965861235936, 419.8601731253462, 398.5209425969888, 396.585177220132, 383.7057356241065, 398.54518817527656, 436.92375856400537, 450.0201290908301, 396.81806555359196, 414.99856647299066, 373.4714549254753, 427.52276968084374, 432.7138545186834, 574.433305725479, 373.90956842309254, 396.72042141196783, 450.3176875642234, 412.95817106128834, 426.7168006843946, 389.7958936629068, 424.0510158941213], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.611997885232135, 20.20203121518748, 44.2800327895356, 7.00718384019072, 49.90767575798872, 48.80706444572294, -17.609597538611172, -151.28715848429246, 60.26548010332654, 86.44675233609622, 75.08668542717693, 36.87488173957637, 34.03114038224888, 49.6672336596296, -20.49899488730793, 6.143472522236951, 71.93982998794631, 82.77539073277224, 13.64022635969617, 12.771028826558908, 59.049797780463386, 46.349675165843024, 52.62505567757202, 95.68642199001161, 81.77271896979332, 101.55358578208761, 36.10658709423348, 52.98004921265709, -10.314392908495536, 75.593308246274, 45.45813731342667, 50.616286438773855, -39.76782188004193, 23.2011894974034, 51.55529292887458, 31.90774745014439, 44.15500346142983, 18.788381296621505, 54.70478314194593, 61.668201271998626, 31.4668967809778, 48.717581840246964, 80.28611121596994, 7.697110302176043, -16.81640918435622, 38.87697798781425, 68.77801664416579, 32.65003348197203, 69.40597065772438, 95.01952235565633, 62.28971353687652, 58.51032223888166, 88.0846272305262, 68.91532165834025, 28.422737796903018, 81.48735451468657, 22.536252246475915, -8.039890890636475, 0.41617597720415556, 45.55422432328826, -13.171491148281774, 121.87489902269964, 15.509836373649646, -16.82986096214502, 59.29160435740932, 63.93349065473522, 39.98473675275833, -2.81687417230924, 72.81463844383629, 108.72942917211334, 37.120771582814875, 27.308980578340652, -38.740392616794146, 13.4295858256455, 47.1157168925622, 38.73115752393966, 134.4959482888922, 72.34953571819605, 37.35278500375499, 45.03880699768858, 64.71024495495809, -51.85636913730038, 44.53653798160003, 101.38073785889587, 48.79512957667912, 120.5745880016808, 39.083208012806956, 45.934594858248275, 136.16473016090575, 136.79263179738695, 84.59132972750383, 13.438257078372143, 76.61896099947481, 57.918463852533165, 99.2669829533664, 67.30825595738457, 69.52462379789245, 73.10192631918923, -40.458829586746276, 66.92640554780542, 58.80955863059391, 34.36499274860592, 34.18906801622665, 107.77493942980261, 144.17526106454056, 15.419139165021148, 17.05990503898978, 97.99879193917734, 96.3238224914206, 80.27172972689738, 99.51592155885092, 101.60045017927501, -30.350187978849306, -3.5009514228168386, 42.796207358058446, 71.37565593819608, 96.70242476737802, 144.95402655849523, 102.01478619979193, 170.47713520840696, 129.25005103795732, 71.56205554249802, 118.83180727593889, 38.121917273064184, -18.052588509728025, 58.696819401385326, 21.444785817483304, 89.15114907224226, 143.16621542856421, 86.38639369499454, 63.92454402057874, 149.69082057906698, 153.78028123022335, 88.00497797893276, 68.22282928130105, 122.62518640184283, 151.1380447223101, 164.01840995307438, 93.67389206125449, 93.6349447801683, 43.01298945800236, 161.89006741203718, 131.77717304924704, 84.3572686360426, 83.28543364638172, 156.35624614507282, 70.58713843257094, 26.026109614466275, 34.50022429112692, 113.95442563423101, 136.5899047554119, 75.640322969959, -5.172192312566241, 23.960724374244162, 105.71998914773484, 72.83594969384396, 147.3721924419472, 135.56214221931228, 127.05130567678695, 132.95361558210382, 77.84667808254854, 182.82788919302385, 155.07422087838097, 81.51029465068379, 80.75667765727441, 85.82462456565366, 170.8009945371477, 68.0746809118304, 173.04620644066034, 117.24057986429875, 159.51496080581995, 59.77481689150023, 77.56135524382141, 161.0203891896338, 159.3676008134162, 111.16210245833288, 59.09528071105079, 118.85212596516872, 107.32638291765252, 95.66078801991475, 133.07125543686269, 158.77435409892715, 34.16178508867004, 43.56554481787105, -246.79291488516617, 148.2060902534719, 83.21549412636949, 57.6027111869019, 35.15447832078729, 43.28325669608707, 32.06511388447907, 144.00970478650882, 74.33705369519299, 114.64305906639245, 70.14693038134455, 122.99536628017523, 81.50337985353238, 129.92146363049983, 108.38314083877907, 135.63313419955603], "policy_predator_policy_reward": [173.43886538186922, 168.36857740927672, 132.89824915128636, 180.7474012662408, 110.96775503038965, 161.52050696955254, 363.75301088964045, 229.39164106175875, 127.94478272922238, 68.93460541723594, 130.86997806524448, 152.91056844769525, 122.95432674790914, 164.5258518937048, 45.97139793123488, 301.97304840226616, 144.4392414011476, 97.86525901084103, 158.64272821318337, 169.67520743726467, 100.79131477123691, 154.53171775739722, 92.80007940906766, 129.31082641378208, 95.03849116950441, 108.42123455087042, 176.25346836851412, 118.4762675287045, 181.97712933131854, 131.69957592284675, 175.1322800539371, 101.07678588288321, 182.18325864750582, 182.56788707037762, 155.18628413128903, 171.5174148189816, 148.28271587222545, 154.4375401141958, 146.85177222176557, 125.33772147994296, 176.7213815754967, 136.17779398277838, 200.16729896898758, 115.58018465923307, 140.1390390405743, 227.27822640125632, 137.47160534652136, 161.2411113513309, 141.74512421340864, 96.55135368856821, 123.92028720409961, 134.71357541626935, 107.18846763062602, 106.01136840931123, 144.45327293596395, 131.0509722540045, 177.9656367429743, 152.3976506128024, 204.23488400012093, 131.00737552580244, 134.04664470108517, 164.1178478648912, 193.58586120532473, 180.6867692366425, 143.4408935055369, 101.34389971822563, 197.15991209087392, 148.6176234265831, 79.22257437708552, 138.46921569128583, 101.82458475756185, 205.01882758388467, 235.8596878374644, 197.30108863583743, 183.45220416107398, 98.35964010957984, 146.91431162597354, 84.87921693779049, 175.13221224745135, 108.42741990857068, 161.56587940808924, 182.07082363735188, 143.8219450357848, 112.68430190383867, 155.56547067912908, 106.95688912402808, 158.22066413131645, 162.2505660482831, 51.612711614608266, 68.34445065472863, 201.61318448389454, 167.95866070803035, 119.65053042060823, 125.3948371752661, 133.50917929974844, 87.86567258258108, 143.59037793946376, 125.21455873122385, 207.31660698431025, 125.2538314676997, 139.24197761841916, 148.89484116498141, 133.71424032124665, 92.87780827366792, 155.17101839734704, 141.53693381548416, 109.89142720125994, 155.71835612577487, 122.98026789085881, 124.34991173545593, 94.71774783425525, 87.59037801022696, 174.900652332019, 244.56260616067595, 144.39781576080313, 134.99096435346007, 84.3542836251745, 80.04043519204707, 93.62042998720516, 70.34941901416498, 132.09591847379107, 112.49392510635708, 156.10618886527266, 114.4062002669666, 182.81500377057387, 173.2366144241001, 114.82938300008533, 184.22407494072309, 87.42165921272564, 99.41090065013876, 131.86599440914216, 115.59119378767663, 96.83785863112016, 90.23684334243741, 67.29969889244279, 110.44740142768381, 52.30609121371363, 25.62358591645011, 106.7789899227956, 107.31367068253655, 116.1460023935282, 131.51338432159403, 78.1965929289311, 114.70630384739482, 81.44233870847259, 97.00400224531984, 151.12257394665815, 154.97751767403528, 137.4252315472187, 135.3872500418825, 78.65740795325337, 131.15060645013747, 187.70505055027198, 206.00087968209814, 74.33981391189269, 114.16604628654324, 67.42773495066176, 49.44899866764897, 78.852640914206, 73.41209643926271, 75.39270526003526, 83.7929005897387, 88.23617088274707, 73.70025618517695, 98.35424285019235, 131.64963214701154, 67.71521729418774, 77.11484288094125, 54.292921803256924, 53.96548006706016, 108.27931264296025, 109.35466822372558, 91.46258562387412, 119.97579903350129, 65.74449979429171, 60.54386248755155, 103.20970305962841, 133.84145673714386, 72.26808430122459, 98.21619968668344, 77.52390674131493, 58.15325340373903, 181.38013521336083, 173.60638939878103, 352.97868918477747, 320.0414411723975, 58.92004546265538, 174.17131764716618, 164.7047362357721, 153.57795015932146, 129.37403935501496, 144.86882953822044, 137.2622079448362, 86.7158503548676, 137.2433274766326, 96.3311765462423, 97.26443879616843, 81.10661138270675, 86.98043083215627, 93.05431002362994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6190912551431998, "mean_inference_ms": 1.93359212585358, "mean_action_processing_ms": 0.25926971604002563, "mean_env_wait_ms": 0.23387700439999531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004453897476196289, "StateBufferConnector_ms": 0.0054857730865478516, "ViewRequirementAgentConnector_ms": 0.10965919494628906}, "num_episodes": 23, "episode_return_max": 574.433305725479, "episode_return_min": 333.5889239684307, "episode_return_mean": 398.89311796452307, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.16335928177864, "num_env_steps_trained_throughput_per_sec": 355.16335928177864, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 11136.712, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11136.673, "sample_time_ms": 1424.341, "learn_time_ms": 9696.734, "learn_throughput": 412.51, "synch_weights_time_ms": 14.296}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-33", "timestamp": 1723778853, "time_this_iter_s": 11.31373381614685, "time_total_s": 662.6457679271698, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b224d550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 662.6457679271698, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.71875, "ram_util_percent": 83.6625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.765379466833892, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.959160525458199, "policy_loss": -0.0033474020926015716, "vf_loss": 7.961379250521382, "vf_explained_var": 0.047997633710740104, "kl": 0.00668851765148351, "entropy": 0.9466399864229575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.934430563765228, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.171777210286054, "policy_loss": -0.002783259273403221, "vf_loss": 8.173990513786437, "vf_explained_var": 0.042960240065105376, "kl": 0.007599649778743177, "entropy": 1.0594237799682313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 574.433305725479, "episode_reward_min": 344.8596487116162, "episode_reward_mean": 403.2575625337762, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -246.79291488516617, "predator_policy": 25.62358591645011}, "policy_reward_max": {"prey_policy": 184.2425450421955, "predator_policy": 352.97868918477747}, "policy_reward_mean": {"prey_policy": 84.46047474928652, "predator_policy": 117.1683065176016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.66364074447205, 388.5624781156531, 393.0836541795004, 403.73070514636703, 389.47783424528853, 400.14076682398974, 402.72197091535776, 379.43389839612746, 370.19978492880347, 385.4143375015579, 344.8596487116162, 381.21265982641654, 406.86790044039424, 372.95260585347216, 368.00988823590757, 382.9453980979059, 399.23585768432076, 371.2731645026025, 407.84996968215285, 367.6587186871555, 438.6390125708521, 365.9512241574651, 356.4905788630989, 402.42352278011947, 431.89207738151737, 405.48903305065437, 392.9145242276296, 467.6014319978015, 379.5827924478827, 387.95009079308016, 411.4314867877689, 359.0380144130686, 381.31137016260055, 368.55605604094416, 456.3023524423931, 380.6684803052025, 423.925731844632, 383.42449758260733, 385.6121190910292, 393.5606434105173, 406.0511701430947, 436.4617704095695, 445.40195016060306, 427.4661136812429, 396.6958490863319, 409.64939283053434, 416.3851689864231, 461.0725527964647, 428.8599611827134, 368.5951160032709, 393.0861318055483, 401.401497446755, 452.56244358516267, 409.0373384616157, 418.08802074524635, 402.71333966773045, 421.2671315144595, 422.0382421287618, 412.4944622940482, 367.06179904001465, 399.81106827957024, 412.26965861235936, 419.8601731253462, 398.5209425969888, 396.585177220132, 383.7057356241065, 398.54518817527656, 436.92375856400537, 450.0201290908301, 396.81806555359196, 414.99856647299066, 373.4714549254753, 427.52276968084374, 432.7138545186834, 574.433305725479, 373.90956842309254, 396.72042141196783, 450.3176875642234, 412.95817106128834, 426.7168006843946, 389.7958936629068, 424.0510158941213, 412.01808595295086, 376.72806556892067, 383.5312463090587, 379.4027357714328, 389.24618987904495, 394.4224176956632, 424.6459978973979, 388.99793527965284, 424.60046760156746, 441.82937325855943, 405.5097183135435, 377.2486105610825, 411.54646399176585, 396.6454912783692, 363.1343792413435, 403.5196724421766, 432.1031440824235, 379.5074763454746], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [44.15500346142983, 18.788381296621505, 54.70478314194593, 61.668201271998626, 31.4668967809778, 48.717581840246964, 80.28611121596994, 7.697110302176043, -16.81640918435622, 38.87697798781425, 68.77801664416579, 32.65003348197203, 69.40597065772438, 95.01952235565633, 62.28971353687652, 58.51032223888166, 88.0846272305262, 68.91532165834025, 28.422737796903018, 81.48735451468657, 22.536252246475915, -8.039890890636475, 0.41617597720415556, 45.55422432328826, -13.171491148281774, 121.87489902269964, 15.509836373649646, -16.82986096214502, 59.29160435740932, 63.93349065473522, 39.98473675275833, -2.81687417230924, 72.81463844383629, 108.72942917211334, 37.120771582814875, 27.308980578340652, -38.740392616794146, 13.4295858256455, 47.1157168925622, 38.73115752393966, 134.4959482888922, 72.34953571819605, 37.35278500375499, 45.03880699768858, 64.71024495495809, -51.85636913730038, 44.53653798160003, 101.38073785889587, 48.79512957667912, 120.5745880016808, 39.083208012806956, 45.934594858248275, 136.16473016090575, 136.79263179738695, 84.59132972750383, 13.438257078372143, 76.61896099947481, 57.918463852533165, 99.2669829533664, 67.30825595738457, 69.52462379789245, 73.10192631918923, -40.458829586746276, 66.92640554780542, 58.80955863059391, 34.36499274860592, 34.18906801622665, 107.77493942980261, 144.17526106454056, 15.419139165021148, 17.05990503898978, 97.99879193917734, 96.3238224914206, 80.27172972689738, 99.51592155885092, 101.60045017927501, -30.350187978849306, -3.5009514228168386, 42.796207358058446, 71.37565593819608, 96.70242476737802, 144.95402655849523, 102.01478619979193, 170.47713520840696, 129.25005103795732, 71.56205554249802, 118.83180727593889, 38.121917273064184, -18.052588509728025, 58.696819401385326, 21.444785817483304, 89.15114907224226, 143.16621542856421, 86.38639369499454, 63.92454402057874, 149.69082057906698, 153.78028123022335, 88.00497797893276, 68.22282928130105, 122.62518640184283, 151.1380447223101, 164.01840995307438, 93.67389206125449, 93.6349447801683, 43.01298945800236, 161.89006741203718, 131.77717304924704, 84.3572686360426, 83.28543364638172, 156.35624614507282, 70.58713843257094, 26.026109614466275, 34.50022429112692, 113.95442563423101, 136.5899047554119, 75.640322969959, -5.172192312566241, 23.960724374244162, 105.71998914773484, 72.83594969384396, 147.3721924419472, 135.56214221931228, 127.05130567678695, 132.95361558210382, 77.84667808254854, 182.82788919302385, 155.07422087838097, 81.51029465068379, 80.75667765727441, 85.82462456565366, 170.8009945371477, 68.0746809118304, 173.04620644066034, 117.24057986429875, 159.51496080581995, 59.77481689150023, 77.56135524382141, 161.0203891896338, 159.3676008134162, 111.16210245833288, 59.09528071105079, 118.85212596516872, 107.32638291765252, 95.66078801991475, 133.07125543686269, 158.77435409892715, 34.16178508867004, 43.56554481787105, -246.79291488516617, 148.2060902534719, 83.21549412636949, 57.6027111869019, 35.15447832078729, 43.28325669608707, 32.06511388447907, 144.00970478650882, 74.33705369519299, 114.64305906639245, 70.14693038134455, 122.99536628017523, 81.50337985353238, 129.92146363049983, 108.38314083877907, 135.63313419955603, 140.7155939793542, 112.078064867819, 128.69685306127099, 137.12381774119135, 114.3076890645062, 120.2401237040107, 128.81027367835767, 124.16298952766684, 151.2337883999691, 149.73000555383157, 136.68623933666333, 139.0205235524339, 67.18307696980887, 126.83201824399474, 157.4443048527709, 145.93584316568678, 184.2425450421955, 137.57915599260994, 131.1520408371643, 160.91310420370334, 149.59903671366982, 148.03398841222045, 139.76039693565707, 114.86141262323203, 134.87246075851147, 156.4235638100698, 168.2543572228741, 169.297564932455, 121.9709106692626, 136.4863220959865, 159.29490245172667, 144.42275388378434, 92.9880285981821, 53.25652654710708, 6.5671253985000035, 66.74151605579381], "policy_predator_policy_reward": [148.28271587222545, 154.4375401141958, 146.85177222176557, 125.33772147994296, 176.7213815754967, 136.17779398277838, 200.16729896898758, 115.58018465923307, 140.1390390405743, 227.27822640125632, 137.47160534652136, 161.2411113513309, 141.74512421340864, 96.55135368856821, 123.92028720409961, 134.71357541626935, 107.18846763062602, 106.01136840931123, 144.45327293596395, 131.0509722540045, 177.9656367429743, 152.3976506128024, 204.23488400012093, 131.00737552580244, 134.04664470108517, 164.1178478648912, 193.58586120532473, 180.6867692366425, 143.4408935055369, 101.34389971822563, 197.15991209087392, 148.6176234265831, 79.22257437708552, 138.46921569128583, 101.82458475756185, 205.01882758388467, 235.8596878374644, 197.30108863583743, 183.45220416107398, 98.35964010957984, 146.91431162597354, 84.87921693779049, 175.13221224745135, 108.42741990857068, 161.56587940808924, 182.07082363735188, 143.8219450357848, 112.68430190383867, 155.56547067912908, 106.95688912402808, 158.22066413131645, 162.2505660482831, 51.612711614608266, 68.34445065472863, 201.61318448389454, 167.95866070803035, 119.65053042060823, 125.3948371752661, 133.50917929974844, 87.86567258258108, 143.59037793946376, 125.21455873122385, 207.31660698431025, 125.2538314676997, 139.24197761841916, 148.89484116498141, 133.71424032124665, 92.87780827366792, 155.17101839734704, 141.53693381548416, 109.89142720125994, 155.71835612577487, 122.98026789085881, 124.34991173545593, 94.71774783425525, 87.59037801022696, 174.900652332019, 244.56260616067595, 144.39781576080313, 134.99096435346007, 84.3542836251745, 80.04043519204707, 93.62042998720516, 70.34941901416498, 132.09591847379107, 112.49392510635708, 156.10618886527266, 114.4062002669666, 182.81500377057387, 173.2366144241001, 114.82938300008533, 184.22407494072309, 87.42165921272564, 99.41090065013876, 131.86599440914216, 115.59119378767663, 96.83785863112016, 90.23684334243741, 67.29969889244279, 110.44740142768381, 52.30609121371363, 25.62358591645011, 106.7789899227956, 107.31367068253655, 116.1460023935282, 131.51338432159403, 78.1965929289311, 114.70630384739482, 81.44233870847259, 97.00400224531984, 151.12257394665815, 154.97751767403528, 137.4252315472187, 135.3872500418825, 78.65740795325337, 131.15060645013747, 187.70505055027198, 206.00087968209814, 74.33981391189269, 114.16604628654324, 67.42773495066176, 49.44899866764897, 78.852640914206, 73.41209643926271, 75.39270526003526, 83.7929005897387, 88.23617088274707, 73.70025618517695, 98.35424285019235, 131.64963214701154, 67.71521729418774, 77.11484288094125, 54.292921803256924, 53.96548006706016, 108.27931264296025, 109.35466822372558, 91.46258562387412, 119.97579903350129, 65.74449979429171, 60.54386248755155, 103.20970305962841, 133.84145673714386, 72.26808430122459, 98.21619968668344, 77.52390674131493, 58.15325340373903, 181.38013521336083, 173.60638939878103, 352.97868918477747, 320.0414411723975, 58.92004546265538, 174.17131764716618, 164.7047362357721, 153.57795015932146, 129.37403935501496, 144.86882953822044, 137.2622079448362, 86.7158503548676, 137.2433274766326, 96.3311765462423, 97.26443879616843, 81.10661138270675, 86.98043083215627, 93.05431002362994, 59.53552671074942, 99.68890039502813, 53.584717149262744, 57.32267761719543, 57.94971175686408, 91.03372178367754, 73.5600235206732, 52.869449044734914, 61.00891637033253, 27.273479554911532, 63.7506845728049, 54.96497023376157, 118.71683308680039, 111.91406959679372, 36.08721969666781, 49.53056756452758, 57.751850589646196, 45.02691597711588, 77.81573890663711, 71.94848931105487, 41.37388945276049, 66.50280373489247, 66.37161443109659, 56.255186571096736, 66.96867191382943, 53.281767509354445, 30.829299076289143, 28.264270046751065, 72.42074299355512, 32.25640348253921, 47.76752230819084, 52.03449379847489, 110.10762990389067, 175.75095903324345, 109.3621548616671, 196.8366800295135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.618578105246728, "mean_inference_ms": 1.932310867755387, "mean_action_processing_ms": 0.258902373786975, "mean_env_wait_ms": 0.23376747392136943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004404664039611816, "StateBufferConnector_ms": 0.005411505699157715, "ViewRequirementAgentConnector_ms": 0.10848569869995117}, "num_episodes": 18, "episode_return_max": 574.433305725479, "episode_return_min": 344.8596487116162, "episode_return_mean": 403.2575625337762, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.9094950862937, "num_env_steps_trained_throughput_per_sec": 365.9094950862937, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 11109.163, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11109.123, "sample_time_ms": 1420.495, "learn_time_ms": 9672.832, "learn_throughput": 413.529, "synch_weights_time_ms": 14.513}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-44", "timestamp": 1723778864, "time_this_iter_s": 10.98786211013794, "time_total_s": 673.6336300373077, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b224df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 673.6336300373077, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 30.543750000000003, "ram_util_percent": 83.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.683507115626461, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.21368432524343, "policy_loss": -0.007609648257247591, "vf_loss": 8.219623037368532, "vf_explained_var": 0.09348291205981421, "kl": 0.00990198419108435, "entropy": 0.9339615494801254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.561452394692355, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.115351681734518, "policy_loss": -0.0012389119261156313, "vf_loss": 8.116097604408466, "vf_explained_var": 0.059530172083112926, "kl": 0.006573144619995371, "entropy": 1.0935485847412594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 574.433305725479, "episode_reward_min": 341.6832023352787, "episode_reward_mean": 403.6304614074756, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -246.79291488516617, "predator_policy": 13.141439211348162}, "policy_reward_max": {"prey_policy": 184.2425450421955, "predator_policy": 352.97868918477747}, "policy_reward_mean": {"prey_policy": 100.59865024305593, "predator_policy": 101.21658046068188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.84996968215285, 367.6587186871555, 438.6390125708521, 365.9512241574651, 356.4905788630989, 402.42352278011947, 431.89207738151737, 405.48903305065437, 392.9145242276296, 467.6014319978015, 379.5827924478827, 387.95009079308016, 411.4314867877689, 359.0380144130686, 381.31137016260055, 368.55605604094416, 456.3023524423931, 380.6684803052025, 423.925731844632, 383.42449758260733, 385.6121190910292, 393.5606434105173, 406.0511701430947, 436.4617704095695, 445.40195016060306, 427.4661136812429, 396.6958490863319, 409.64939283053434, 416.3851689864231, 461.0725527964647, 428.8599611827134, 368.5951160032709, 393.0861318055483, 401.401497446755, 452.56244358516267, 409.0373384616157, 418.08802074524635, 402.71333966773045, 421.2671315144595, 422.0382421287618, 412.4944622940482, 367.06179904001465, 399.81106827957024, 412.26965861235936, 419.8601731253462, 398.5209425969888, 396.585177220132, 383.7057356241065, 398.54518817527656, 436.92375856400537, 450.0201290908301, 396.81806555359196, 414.99856647299066, 373.4714549254753, 427.52276968084374, 432.7138545186834, 574.433305725479, 373.90956842309254, 396.72042141196783, 450.3176875642234, 412.95817106128834, 426.7168006843946, 389.7958936629068, 424.0510158941213, 412.01808595295086, 376.72806556892067, 383.5312463090587, 379.4027357714328, 389.24618987904495, 394.4224176956632, 424.6459978973979, 388.99793527965284, 424.60046760156746, 441.82937325855943, 405.5097183135435, 377.2486105610825, 411.54646399176585, 396.6454912783692, 363.1343792413435, 403.5196724421766, 432.1031440824235, 379.5074763454746, 393.41351243136984, 380.4504451352904, 394.1795238254415, 416.6693808710752, 379.8398544714166, 391.04120570222995, 369.20624839347255, 356.94489811909455, 391.70681370405936, 392.50459263419765, 393.08702496451394, 396.1969572637928, 375.4389576868338, 341.6832023352787, 414.71896695124303, 388.9397101592747, 384.61292150020256, 382.4418655709066], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.740392616794146, 13.4295858256455, 47.1157168925622, 38.73115752393966, 134.4959482888922, 72.34953571819605, 37.35278500375499, 45.03880699768858, 64.71024495495809, -51.85636913730038, 44.53653798160003, 101.38073785889587, 48.79512957667912, 120.5745880016808, 39.083208012806956, 45.934594858248275, 136.16473016090575, 136.79263179738695, 84.59132972750383, 13.438257078372143, 76.61896099947481, 57.918463852533165, 99.2669829533664, 67.30825595738457, 69.52462379789245, 73.10192631918923, -40.458829586746276, 66.92640554780542, 58.80955863059391, 34.36499274860592, 34.18906801622665, 107.77493942980261, 144.17526106454056, 15.419139165021148, 17.05990503898978, 97.99879193917734, 96.3238224914206, 80.27172972689738, 99.51592155885092, 101.60045017927501, -30.350187978849306, -3.5009514228168386, 42.796207358058446, 71.37565593819608, 96.70242476737802, 144.95402655849523, 102.01478619979193, 170.47713520840696, 129.25005103795732, 71.56205554249802, 118.83180727593889, 38.121917273064184, -18.052588509728025, 58.696819401385326, 21.444785817483304, 89.15114907224226, 143.16621542856421, 86.38639369499454, 63.92454402057874, 149.69082057906698, 153.78028123022335, 88.00497797893276, 68.22282928130105, 122.62518640184283, 151.1380447223101, 164.01840995307438, 93.67389206125449, 93.6349447801683, 43.01298945800236, 161.89006741203718, 131.77717304924704, 84.3572686360426, 83.28543364638172, 156.35624614507282, 70.58713843257094, 26.026109614466275, 34.50022429112692, 113.95442563423101, 136.5899047554119, 75.640322969959, -5.172192312566241, 23.960724374244162, 105.71998914773484, 72.83594969384396, 147.3721924419472, 135.56214221931228, 127.05130567678695, 132.95361558210382, 77.84667808254854, 182.82788919302385, 155.07422087838097, 81.51029465068379, 80.75667765727441, 85.82462456565366, 170.8009945371477, 68.0746809118304, 173.04620644066034, 117.24057986429875, 159.51496080581995, 59.77481689150023, 77.56135524382141, 161.0203891896338, 159.3676008134162, 111.16210245833288, 59.09528071105079, 118.85212596516872, 107.32638291765252, 95.66078801991475, 133.07125543686269, 158.77435409892715, 34.16178508867004, 43.56554481787105, -246.79291488516617, 148.2060902534719, 83.21549412636949, 57.6027111869019, 35.15447832078729, 43.28325669608707, 32.06511388447907, 144.00970478650882, 74.33705369519299, 114.64305906639245, 70.14693038134455, 122.99536628017523, 81.50337985353238, 129.92146363049983, 108.38314083877907, 135.63313419955603, 140.7155939793542, 112.078064867819, 128.69685306127099, 137.12381774119135, 114.3076890645062, 120.2401237040107, 128.81027367835767, 124.16298952766684, 151.2337883999691, 149.73000555383157, 136.68623933666333, 139.0205235524339, 67.18307696980887, 126.83201824399474, 157.4443048527709, 145.93584316568678, 184.2425450421955, 137.57915599260994, 131.1520408371643, 160.91310420370334, 149.59903671366982, 148.03398841222045, 139.76039693565707, 114.86141262323203, 134.87246075851147, 156.4235638100698, 168.2543572228741, 169.297564932455, 121.9709106692626, 136.4863220959865, 159.29490245172667, 144.42275388378434, 92.9880285981821, 53.25652654710708, 6.5671253985000035, 66.74151605579381, 171.4408818988242, 154.56552070238448, 183.86593060645666, 148.6204189681819, 157.28730884031378, 117.23647404687682, 148.43973288940674, 149.03311415821653, 152.93060406253446, 153.46140894977123, 160.78548848247175, 96.58459352362235, 151.112257483495, 166.21617170844516, 80.6790375753879, 87.4958866830455, 175.6238759674457, 131.14252395898683, -11.252246405326126, 71.87842829104856, 142.7982153773124, 140.9805797278543, 107.527044372288, 117.20683749071809, 167.80242769567192, 150.91052395438345, 106.00990213106674, 63.035659692923, 153.5970269562198, 157.36747992144154, 135.06421541579314, 123.57969867182275, 153.4545124714888, 155.18813563212663, 179.7595425066262, 123.53106488706698], "policy_predator_policy_reward": [235.8596878374644, 197.30108863583743, 183.45220416107398, 98.35964010957984, 146.91431162597354, 84.87921693779049, 175.13221224745135, 108.42741990857068, 161.56587940808924, 182.07082363735188, 143.8219450357848, 112.68430190383867, 155.56547067912908, 106.95688912402808, 158.22066413131645, 162.2505660482831, 51.612711614608266, 68.34445065472863, 201.61318448389454, 167.95866070803035, 119.65053042060823, 125.3948371752661, 133.50917929974844, 87.86567258258108, 143.59037793946376, 125.21455873122385, 207.31660698431025, 125.2538314676997, 139.24197761841916, 148.89484116498141, 133.71424032124665, 92.87780827366792, 155.17101839734704, 141.53693381548416, 109.89142720125994, 155.71835612577487, 122.98026789085881, 124.34991173545593, 94.71774783425525, 87.59037801022696, 174.900652332019, 244.56260616067595, 144.39781576080313, 134.99096435346007, 84.3542836251745, 80.04043519204707, 93.62042998720516, 70.34941901416498, 132.09591847379107, 112.49392510635708, 156.10618886527266, 114.4062002669666, 182.81500377057387, 173.2366144241001, 114.82938300008533, 184.22407494072309, 87.42165921272564, 99.41090065013876, 131.86599440914216, 115.59119378767663, 96.83785863112016, 90.23684334243741, 67.29969889244279, 110.44740142768381, 52.30609121371363, 25.62358591645011, 106.7789899227956, 107.31367068253655, 116.1460023935282, 131.51338432159403, 78.1965929289311, 114.70630384739482, 81.44233870847259, 97.00400224531984, 151.12257394665815, 154.97751767403528, 137.4252315472187, 135.3872500418825, 78.65740795325337, 131.15060645013747, 187.70505055027198, 206.00087968209814, 74.33981391189269, 114.16604628654324, 67.42773495066176, 49.44899866764897, 78.852640914206, 73.41209643926271, 75.39270526003526, 83.7929005897387, 88.23617088274707, 73.70025618517695, 98.35424285019235, 131.64963214701154, 67.71521729418774, 77.11484288094125, 54.292921803256924, 53.96548006706016, 108.27931264296025, 109.35466822372558, 91.46258562387412, 119.97579903350129, 65.74449979429171, 60.54386248755155, 103.20970305962841, 133.84145673714386, 72.26808430122459, 98.21619968668344, 77.52390674131493, 58.15325340373903, 181.38013521336083, 173.60638939878103, 352.97868918477747, 320.0414411723975, 58.92004546265538, 174.17131764716618, 164.7047362357721, 153.57795015932146, 129.37403935501496, 144.86882953822044, 137.2622079448362, 86.7158503548676, 137.2433274766326, 96.3311765462423, 97.26443879616843, 81.10661138270675, 86.98043083215627, 93.05431002362994, 59.53552671074942, 99.68890039502813, 53.584717149262744, 57.32267761719543, 57.94971175686408, 91.03372178367754, 73.5600235206732, 52.869449044734914, 61.00891637033253, 27.273479554911532, 63.7506845728049, 54.96497023376157, 118.71683308680039, 111.91406959679372, 36.08721969666781, 49.53056756452758, 57.751850589646196, 45.02691597711588, 77.81573890663711, 71.94848931105487, 41.37388945276049, 66.50280373489247, 66.37161443109659, 56.255186571096736, 66.96867191382943, 53.281767509354445, 30.829299076289143, 28.264270046751065, 72.42074299355512, 32.25640348253921, 47.76752230819084, 52.03449379847489, 110.10762990389067, 175.75095903324345, 109.3621548616671, 196.8366800295135, 33.88993665046282, 33.51717317969831, 19.693442084298347, 28.270653476353743, 46.06916027886084, 73.58658065938981, 52.89050468385511, 66.30602913959656, 49.87307689486502, 23.574764564245392, 65.36498439733865, 68.3061392987972, 38.736379990184226, 13.141439211348162, 132.28607022492562, 56.48390363573572, 47.39510637429372, 37.54530740333278, 199.6303708414938, 132.24803990698106, 55.943785207223044, 53.36444465212463, 75.6087266224817, 95.85434877830495, 15.338249089265414, 41.38775694751277, 133.99756259850363, 38.64007791278583, 47.806543132379275, 55.94791694120271, 52.15178123574859, 78.1440148359098, 31.549741291193016, 44.42053210539411, 64.74120791175889, 14.410050265454649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6182378858353816, "mean_inference_ms": 1.9313564575199036, "mean_action_processing_ms": 0.25858852220937295, "mean_env_wait_ms": 0.2336997246932204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006971120834350586, "StateBufferConnector_ms": 0.005352139472961426, "ViewRequirementAgentConnector_ms": 0.11305344104766846}, "num_episodes": 18, "episode_return_max": 574.433305725479, "episode_return_min": 341.6832023352787, "episode_return_mean": 403.6304614074756, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.8472533094146, "num_env_steps_trained_throughput_per_sec": 369.8472533094146, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 11054.131, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11054.091, "sample_time_ms": 1422.668, "learn_time_ms": 9615.582, "learn_throughput": 415.991, "synch_weights_time_ms": 14.513}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "e552a_00000", "date": "2024-08-16_08-57-55", "timestamp": 1723778875, "time_this_iter_s": 10.86706805229187, "time_total_s": 684.5006980895996, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7368700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 684.5006980895996, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.99333333333334, "ram_util_percent": 83.81333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.330988722881942, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.68168249180708, "policy_loss": -0.0039833401016910715, "vf_loss": 7.684412958003857, "vf_explained_var": 0.31159673645382835, "kl": 0.007424432446484072, "entropy": 0.9110552821209822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.773196721959997, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.059976999343387, "policy_loss": -0.0019257746279614154, "vf_loss": 8.061398683780086, "vf_explained_var": 0.07150022094211882, "kl": 0.006721336664902192, "entropy": 1.1279157381839853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 574.433305725479, "episode_reward_min": 303.90868665316293, "episode_reward_mean": 399.6085476342313, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -246.79291488516617, "predator_policy": 13.141439211348162}, "policy_reward_max": {"prey_policy": 184.2425450421955, "predator_policy": 352.97868918477747}, "policy_reward_mean": {"prey_policy": 109.16018462821572, "predator_policy": 90.64408918889995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [406.0511701430947, 436.4617704095695, 445.40195016060306, 427.4661136812429, 396.6958490863319, 409.64939283053434, 416.3851689864231, 461.0725527964647, 428.8599611827134, 368.5951160032709, 393.0861318055483, 401.401497446755, 452.56244358516267, 409.0373384616157, 418.08802074524635, 402.71333966773045, 421.2671315144595, 422.0382421287618, 412.4944622940482, 367.06179904001465, 399.81106827957024, 412.26965861235936, 419.8601731253462, 398.5209425969888, 396.585177220132, 383.7057356241065, 398.54518817527656, 436.92375856400537, 450.0201290908301, 396.81806555359196, 414.99856647299066, 373.4714549254753, 427.52276968084374, 432.7138545186834, 574.433305725479, 373.90956842309254, 396.72042141196783, 450.3176875642234, 412.95817106128834, 426.7168006843946, 389.7958936629068, 424.0510158941213, 412.01808595295086, 376.72806556892067, 383.5312463090587, 379.4027357714328, 389.24618987904495, 394.4224176956632, 424.6459978973979, 388.99793527965284, 424.60046760156746, 441.82937325855943, 405.5097183135435, 377.2486105610825, 411.54646399176585, 396.6454912783692, 363.1343792413435, 403.5196724421766, 432.1031440824235, 379.5074763454746, 393.41351243136984, 380.4504451352904, 394.1795238254415, 416.6693808710752, 379.8398544714166, 391.04120570222995, 369.20624839347255, 356.94489811909455, 391.70681370405936, 392.50459263419765, 393.08702496451394, 396.1969572637928, 375.4389576868338, 341.6832023352787, 414.71896695124303, 388.9397101592747, 384.61292150020256, 382.4418655709066, 409.4480447941176, 344.51981085692603, 405.77944839370764, 383.88152653317195, 352.40300185916294, 303.90868665316293, 418.40719349489564, 372.69573395919184, 375.6833425152077, 396.6096838507755, 373.5964513727601, 380.0095853943723, 403.41191773797203, 346.35448666572194, 388.2665968545421, 394.3292003493855, 408.3061104261901, 390.939344074596, 365.9003581508632, 360.8129287518695, 354.5509217050083, 416.26797700214547], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [96.70242476737802, 144.95402655849523, 102.01478619979193, 170.47713520840696, 129.25005103795732, 71.56205554249802, 118.83180727593889, 38.121917273064184, -18.052588509728025, 58.696819401385326, 21.444785817483304, 89.15114907224226, 143.16621542856421, 86.38639369499454, 63.92454402057874, 149.69082057906698, 153.78028123022335, 88.00497797893276, 68.22282928130105, 122.62518640184283, 151.1380447223101, 164.01840995307438, 93.67389206125449, 93.6349447801683, 43.01298945800236, 161.89006741203718, 131.77717304924704, 84.3572686360426, 83.28543364638172, 156.35624614507282, 70.58713843257094, 26.026109614466275, 34.50022429112692, 113.95442563423101, 136.5899047554119, 75.640322969959, -5.172192312566241, 23.960724374244162, 105.71998914773484, 72.83594969384396, 147.3721924419472, 135.56214221931228, 127.05130567678695, 132.95361558210382, 77.84667808254854, 182.82788919302385, 155.07422087838097, 81.51029465068379, 80.75667765727441, 85.82462456565366, 170.8009945371477, 68.0746809118304, 173.04620644066034, 117.24057986429875, 159.51496080581995, 59.77481689150023, 77.56135524382141, 161.0203891896338, 159.3676008134162, 111.16210245833288, 59.09528071105079, 118.85212596516872, 107.32638291765252, 95.66078801991475, 133.07125543686269, 158.77435409892715, 34.16178508867004, 43.56554481787105, -246.79291488516617, 148.2060902534719, 83.21549412636949, 57.6027111869019, 35.15447832078729, 43.28325669608707, 32.06511388447907, 144.00970478650882, 74.33705369519299, 114.64305906639245, 70.14693038134455, 122.99536628017523, 81.50337985353238, 129.92146363049983, 108.38314083877907, 135.63313419955603, 140.7155939793542, 112.078064867819, 128.69685306127099, 137.12381774119135, 114.3076890645062, 120.2401237040107, 128.81027367835767, 124.16298952766684, 151.2337883999691, 149.73000555383157, 136.68623933666333, 139.0205235524339, 67.18307696980887, 126.83201824399474, 157.4443048527709, 145.93584316568678, 184.2425450421955, 137.57915599260994, 131.1520408371643, 160.91310420370334, 149.59903671366982, 148.03398841222045, 139.76039693565707, 114.86141262323203, 134.87246075851147, 156.4235638100698, 168.2543572228741, 169.297564932455, 121.9709106692626, 136.4863220959865, 159.29490245172667, 144.42275388378434, 92.9880285981821, 53.25652654710708, 6.5671253985000035, 66.74151605579381, 171.4408818988242, 154.56552070238448, 183.86593060645666, 148.6204189681819, 157.28730884031378, 117.23647404687682, 148.43973288940674, 149.03311415821653, 152.93060406253446, 153.46140894977123, 160.78548848247175, 96.58459352362235, 151.112257483495, 166.21617170844516, 80.6790375753879, 87.4958866830455, 175.6238759674457, 131.14252395898683, -11.252246405326126, 71.87842829104856, 142.7982153773124, 140.9805797278543, 107.527044372288, 117.20683749071809, 167.80242769567192, 150.91052395438345, 106.00990213106674, 63.035659692923, 153.5970269562198, 157.36747992144154, 135.06421541579314, 123.57969867182275, 153.4545124714888, 155.18813563212663, 179.7595425066262, 123.53106488706698, 160.68475813615984, 178.3543198846991, 77.88032670693268, 82.7024555023287, 151.06645493367367, 102.72217057449585, 79.24773994094062, 102.1858700809404, 107.87723506224675, 125.1427280628464, 44.70020978189452, 22.12422738504372, 87.53228540553478, 123.9497291170679, 97.17700605823849, 143.73948828833022, 120.98248041535217, 140.09684343021505, 102.67738443538806, 90.79684511904131, 88.30747940019074, 146.84121275776548, 88.12924648940778, 123.73561997646772, 113.31887198220106, 51.15994273911733, 9.794209180847732, 94.69554909368142, 130.29874308655613, 153.00924108544447, 61.78793635598102, 72.63492963654078, 139.19222560170542, 92.49491469870328, 163.52224016526023, 181.3130689158722, -42.007108994217646, 30.95494234733272, 13.761411113179967, 37.41508630284603, 155.79368519960863, 135.1117463077187, 42.38650118289114, 58.96448231599456], "policy_predator_policy_reward": [84.3542836251745, 80.04043519204707, 93.62042998720516, 70.34941901416498, 132.09591847379107, 112.49392510635708, 156.10618886527266, 114.4062002669666, 182.81500377057387, 173.2366144241001, 114.82938300008533, 184.22407494072309, 87.42165921272564, 99.41090065013876, 131.86599440914216, 115.59119378767663, 96.83785863112016, 90.23684334243741, 67.29969889244279, 110.44740142768381, 52.30609121371363, 25.62358591645011, 106.7789899227956, 107.31367068253655, 116.1460023935282, 131.51338432159403, 78.1965929289311, 114.70630384739482, 81.44233870847259, 97.00400224531984, 151.12257394665815, 154.97751767403528, 137.4252315472187, 135.3872500418825, 78.65740795325337, 131.15060645013747, 187.70505055027198, 206.00087968209814, 74.33981391189269, 114.16604628654324, 67.42773495066176, 49.44899866764897, 78.852640914206, 73.41209643926271, 75.39270526003526, 83.7929005897387, 88.23617088274707, 73.70025618517695, 98.35424285019235, 131.64963214701154, 67.71521729418774, 77.11484288094125, 54.292921803256924, 53.96548006706016, 108.27931264296025, 109.35466822372558, 91.46258562387412, 119.97579903350129, 65.74449979429171, 60.54386248755155, 103.20970305962841, 133.84145673714386, 72.26808430122459, 98.21619968668344, 77.52390674131493, 58.15325340373903, 181.38013521336083, 173.60638939878103, 352.97868918477747, 320.0414411723975, 58.92004546265538, 174.17131764716618, 164.7047362357721, 153.57795015932146, 129.37403935501496, 144.86882953822044, 137.2622079448362, 86.7158503548676, 137.2433274766326, 96.3311765462423, 97.26443879616843, 81.10661138270675, 86.98043083215627, 93.05431002362994, 59.53552671074942, 99.68890039502813, 53.584717149262744, 57.32267761719543, 57.94971175686408, 91.03372178367754, 73.5600235206732, 52.869449044734914, 61.00891637033253, 27.273479554911532, 63.7506845728049, 54.96497023376157, 118.71683308680039, 111.91406959679372, 36.08721969666781, 49.53056756452758, 57.751850589646196, 45.02691597711588, 77.81573890663711, 71.94848931105487, 41.37388945276049, 66.50280373489247, 66.37161443109659, 56.255186571096736, 66.96867191382943, 53.281767509354445, 30.829299076289143, 28.264270046751065, 72.42074299355512, 32.25640348253921, 47.76752230819084, 52.03449379847489, 110.10762990389067, 175.75095903324345, 109.3621548616671, 196.8366800295135, 33.88993665046282, 33.51717317969831, 19.693442084298347, 28.270653476353743, 46.06916027886084, 73.58658065938981, 52.89050468385511, 66.30602913959656, 49.87307689486502, 23.574764564245392, 65.36498439733865, 68.3061392987972, 38.736379990184226, 13.141439211348162, 132.28607022492562, 56.48390363573572, 47.39510637429372, 37.54530740333278, 199.6303708414938, 132.24803990698106, 55.943785207223044, 53.36444465212463, 75.6087266224817, 95.85434877830495, 15.338249089265414, 41.38775694751277, 133.99756259850363, 38.64007791278583, 47.806543132379275, 55.94791694120271, 52.15178123574859, 78.1440148359098, 31.549741291193016, 44.42053210539411, 64.74120791175889, 14.410050265454649, 33.51541533423272, 36.89355143902577, 124.28479471447153, 59.652233933193, 67.85537125336921, 84.13545163216901, 106.88173523489588, 95.56618127639553, 27.56812421812237, 91.81491451594721, 55.6171648280041, 181.46708465822013, 110.32763518971804, 96.597543782575, 50.53217747324104, 81.247062139382, 95.29367696488855, 19.310341704751824, 141.6274237193468, 61.50803057699964, 30.127752911717096, 108.32000630308698, 53.67732624366163, 114.46739268483493, 105.30098271749394, 133.6321202991594, 42.0724702254731, 199.79225816571986, 62.38868972989909, 42.56992295264248, 128.35886360936763, 131.5474707474961, 73.10327075210027, 103.51569937368144, 23.749278555775128, 22.354756437688334, 199.56577846233904, 177.3867463354093, 95.66877645098327, 213.9676548848605, 27.970479709292213, 35.67501048838862, 143.1760254273834, 171.74096807587577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6180078757519651, "mean_inference_ms": 1.9306540028108026, "mean_action_processing_ms": 0.25828588122606067, "mean_env_wait_ms": 0.23363595872974335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007321834564208984, "StateBufferConnector_ms": 0.005486249923706055, "ViewRequirementAgentConnector_ms": 0.11023223400115967}, "num_episodes": 22, "episode_return_max": 574.433305725479, "episode_return_min": 303.90868665316293, "episode_return_mean": 399.6085476342313, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.3952956710366, "num_env_steps_trained_throughput_per_sec": 364.3952956710366, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 11040.332, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11040.291, "sample_time_ms": 1418.374, "learn_time_ms": 9606.107, "learn_throughput": 416.402, "synch_weights_time_ms": 14.608}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "e552a_00000", "date": "2024-08-16_08-58-06", "timestamp": 1723778886, "time_this_iter_s": 10.982677936553955, "time_total_s": 695.4833760261536, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7347820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 695.4833760261536, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 32.44375, "ram_util_percent": 83.51875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.935070388279264, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.57181415330796, "policy_loss": -0.004430989030423382, "vf_loss": 7.574671923925006, "vf_explained_var": 0.24643120705766022, "kl": 0.009322723720483997, "entropy": 0.9049846762702578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.3396343947087646, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.57282021234906, "policy_loss": -0.003012771094180939, "vf_loss": 8.575315145714573, "vf_explained_var": 0.01831167144750161, "kl": 0.006904618891513749, "entropy": 1.1799206184962439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 574.433305725479, "episode_reward_min": 300.06846608023847, "episode_reward_mean": 389.46119194671735, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -646.0227667051049, "predator_policy": 13.141439211348162}, "policy_reward_max": {"prey_policy": 184.2425450421955, "predator_policy": 601.5043456532352}, "policy_reward_mean": {"prey_policy": 100.02367865503406, "predator_policy": 94.70691731832467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.5209425969888, 396.585177220132, 383.7057356241065, 398.54518817527656, 436.92375856400537, 450.0201290908301, 396.81806555359196, 414.99856647299066, 373.4714549254753, 427.52276968084374, 432.7138545186834, 574.433305725479, 373.90956842309254, 396.72042141196783, 450.3176875642234, 412.95817106128834, 426.7168006843946, 389.7958936629068, 424.0510158941213, 412.01808595295086, 376.72806556892067, 383.5312463090587, 379.4027357714328, 389.24618987904495, 394.4224176956632, 424.6459978973979, 388.99793527965284, 424.60046760156746, 441.82937325855943, 405.5097183135435, 377.2486105610825, 411.54646399176585, 396.6454912783692, 363.1343792413435, 403.5196724421766, 432.1031440824235, 379.5074763454746, 393.41351243136984, 380.4504451352904, 394.1795238254415, 416.6693808710752, 379.8398544714166, 391.04120570222995, 369.20624839347255, 356.94489811909455, 391.70681370405936, 392.50459263419765, 393.08702496451394, 396.1969572637928, 375.4389576868338, 341.6832023352787, 414.71896695124303, 388.9397101592747, 384.61292150020256, 382.4418655709066, 409.4480447941176, 344.51981085692603, 405.77944839370764, 383.88152653317195, 352.40300185916294, 303.90868665316293, 418.40719349489564, 372.69573395919184, 375.6833425152077, 396.6096838507755, 373.5964513727601, 380.0095853943723, 403.41191773797203, 346.35448666572194, 388.2665968545421, 394.3292003493855, 408.3061104261901, 390.939344074596, 365.9003581508632, 360.8129287518695, 354.5509217050083, 416.26797700214547, 347.08830293707604, 355.217689154623, 342.2367043412762, 327.0325916163537, 495.6484209682244, 397.271306792051, 340.36997184616234, 362.262551218757, 420.9078854930615, 402.6406205610013, 364.8180158255907, 384.64843746870446, 365.14754667273866, 368.64679970006586, 372.92079931000796, 427.42906802138333, 300.06846608023847, 379.41823411093924, 394.8953825164181, 335.51746002614925, 326.253226698961, 370.44243365064807, 332.7128682250433], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.07422087838097, 81.51029465068379, 80.75667765727441, 85.82462456565366, 170.8009945371477, 68.0746809118304, 173.04620644066034, 117.24057986429875, 159.51496080581995, 59.77481689150023, 77.56135524382141, 161.0203891896338, 159.3676008134162, 111.16210245833288, 59.09528071105079, 118.85212596516872, 107.32638291765252, 95.66078801991475, 133.07125543686269, 158.77435409892715, 34.16178508867004, 43.56554481787105, -246.79291488516617, 148.2060902534719, 83.21549412636949, 57.6027111869019, 35.15447832078729, 43.28325669608707, 32.06511388447907, 144.00970478650882, 74.33705369519299, 114.64305906639245, 70.14693038134455, 122.99536628017523, 81.50337985353238, 129.92146363049983, 108.38314083877907, 135.63313419955603, 140.7155939793542, 112.078064867819, 128.69685306127099, 137.12381774119135, 114.3076890645062, 120.2401237040107, 128.81027367835767, 124.16298952766684, 151.2337883999691, 149.73000555383157, 136.68623933666333, 139.0205235524339, 67.18307696980887, 126.83201824399474, 157.4443048527709, 145.93584316568678, 184.2425450421955, 137.57915599260994, 131.1520408371643, 160.91310420370334, 149.59903671366982, 148.03398841222045, 139.76039693565707, 114.86141262323203, 134.87246075851147, 156.4235638100698, 168.2543572228741, 169.297564932455, 121.9709106692626, 136.4863220959865, 159.29490245172667, 144.42275388378434, 92.9880285981821, 53.25652654710708, 6.5671253985000035, 66.74151605579381, 171.4408818988242, 154.56552070238448, 183.86593060645666, 148.6204189681819, 157.28730884031378, 117.23647404687682, 148.43973288940674, 149.03311415821653, 152.93060406253446, 153.46140894977123, 160.78548848247175, 96.58459352362235, 151.112257483495, 166.21617170844516, 80.6790375753879, 87.4958866830455, 175.6238759674457, 131.14252395898683, -11.252246405326126, 71.87842829104856, 142.7982153773124, 140.9805797278543, 107.527044372288, 117.20683749071809, 167.80242769567192, 150.91052395438345, 106.00990213106674, 63.035659692923, 153.5970269562198, 157.36747992144154, 135.06421541579314, 123.57969867182275, 153.4545124714888, 155.18813563212663, 179.7595425066262, 123.53106488706698, 160.68475813615984, 178.3543198846991, 77.88032670693268, 82.7024555023287, 151.06645493367367, 102.72217057449585, 79.24773994094062, 102.1858700809404, 107.87723506224675, 125.1427280628464, 44.70020978189452, 22.12422738504372, 87.53228540553478, 123.9497291170679, 97.17700605823849, 143.73948828833022, 120.98248041535217, 140.09684343021505, 102.67738443538806, 90.79684511904131, 88.30747940019074, 146.84121275776548, 88.12924648940778, 123.73561997646772, 113.31887198220106, 51.15994273911733, 9.794209180847732, 94.69554909368142, 130.29874308655613, 153.00924108544447, 61.78793635598102, 72.63492963654078, 139.19222560170542, 92.49491469870328, 163.52224016526023, 181.3130689158722, -42.007108994217646, 30.95494234733272, 13.761411113179967, 37.41508630284603, 155.79368519960863, 135.1117463077187, 42.38650118289114, 58.96448231599456, 45.63483256968701, 49.52350967033024, 104.508981085485, 107.45183958731324, 93.9176918250042, 68.0368171173078, 64.8487720790116, 63.560091374195665, -97.07467483629823, 26.124856510605174, 25.280622086800175, 52.31182005733314, 76.53359591898807, 103.23170050419719, -4.689235240587083, 53.07265526803441, 44.03974013985553, 62.15909333371993, 101.19452735709339, -44.49453018251724, 150.02658363119014, 152.60740142130635, 156.55666902967937, 147.03601945627216, 49.48624210830704, 16.25612510544437, 66.14381949578367, 118.08285567175356, 140.79225196497518, 126.45372977253629, 61.508184065071156, -49.783422445200365, 18.173127073119844, 11.576293289580045, 142.35109649633537, 165.58638416343516, 154.99610437415063, 167.3507005435877, -646.0227667051049, 10.90436406397666, 15.316950160287188, 36.84072251396382, 170.32332741750488, 158.86082534824328, 64.54659331655782, 91.91242572610797], "policy_predator_policy_reward": [88.23617088274707, 73.70025618517695, 98.35424285019235, 131.64963214701154, 67.71521729418774, 77.11484288094125, 54.292921803256924, 53.96548006706016, 108.27931264296025, 109.35466822372558, 91.46258562387412, 119.97579903350129, 65.74449979429171, 60.54386248755155, 103.20970305962841, 133.84145673714386, 72.26808430122459, 98.21619968668344, 77.52390674131493, 58.15325340373903, 181.38013521336083, 173.60638939878103, 352.97868918477747, 320.0414411723975, 58.92004546265538, 174.17131764716618, 164.7047362357721, 153.57795015932146, 129.37403935501496, 144.86882953822044, 137.2622079448362, 86.7158503548676, 137.2433274766326, 96.3311765462423, 97.26443879616843, 81.10661138270675, 86.98043083215627, 93.05431002362994, 59.53552671074942, 99.68890039502813, 53.584717149262744, 57.32267761719543, 57.94971175686408, 91.03372178367754, 73.5600235206732, 52.869449044734914, 61.00891637033253, 27.273479554911532, 63.7506845728049, 54.96497023376157, 118.71683308680039, 111.91406959679372, 36.08721969666781, 49.53056756452758, 57.751850589646196, 45.02691597711588, 77.81573890663711, 71.94848931105487, 41.37388945276049, 66.50280373489247, 66.37161443109659, 56.255186571096736, 66.96867191382943, 53.281767509354445, 30.829299076289143, 28.264270046751065, 72.42074299355512, 32.25640348253921, 47.76752230819084, 52.03449379847489, 110.10762990389067, 175.75095903324345, 109.3621548616671, 196.8366800295135, 33.88993665046282, 33.51717317969831, 19.693442084298347, 28.270653476353743, 46.06916027886084, 73.58658065938981, 52.89050468385511, 66.30602913959656, 49.87307689486502, 23.574764564245392, 65.36498439733865, 68.3061392987972, 38.736379990184226, 13.141439211348162, 132.28607022492562, 56.48390363573572, 47.39510637429372, 37.54530740333278, 199.6303708414938, 132.24803990698106, 55.943785207223044, 53.36444465212463, 75.6087266224817, 95.85434877830495, 15.338249089265414, 41.38775694751277, 133.99756259850363, 38.64007791278583, 47.806543132379275, 55.94791694120271, 52.15178123574859, 78.1440148359098, 31.549741291193016, 44.42053210539411, 64.74120791175889, 14.410050265454649, 33.51541533423272, 36.89355143902577, 124.28479471447153, 59.652233933193, 67.85537125336921, 84.13545163216901, 106.88173523489588, 95.56618127639553, 27.56812421812237, 91.81491451594721, 55.6171648280041, 181.46708465822013, 110.32763518971804, 96.597543782575, 50.53217747324104, 81.247062139382, 95.29367696488855, 19.310341704751824, 141.6274237193468, 61.50803057699964, 30.127752911717096, 108.32000630308698, 53.67732624366163, 114.46739268483493, 105.30098271749394, 133.6321202991594, 42.0724702254731, 199.79225816571986, 62.38868972989909, 42.56992295264248, 128.35886360936763, 131.5474707474961, 73.10327075210027, 103.51569937368144, 23.749278555775128, 22.354756437688334, 199.56577846233904, 177.3867463354093, 95.66877645098327, 213.9676548848605, 27.970479709292213, 35.67501048838862, 143.1760254273834, 171.74096807587577, 72.9824026582075, 178.94755803885099, 103.94587794066298, 39.31099054116149, 155.36358347517978, 24.91861192378454, 30.532879256953745, 168.09084890619303, 299.6914603346066, 266.9067789593112, 102.67068706025967, 217.00817758765783, 109.43595336209536, 51.16872206088183, 200.28091020179357, 113.5982209895162, 176.1360921067063, 138.5729599127797, 152.77326602894905, 193.1673573574765, 34.92569241142942, 27.25833836166502, 51.082148220309314, 29.97360076244325, 112.04035140670223, 187.36482805228533, 42.843976400049016, 141.57614813247952, 21.877501876948315, 83.79731569554818, 230.02299813621846, 185.68130826529395, 210.2541854153477, 60.064860302190624, 49.592272445416754, 21.888481005752237, 37.56842649415846, 34.98015110452162, 369.1315170140413, 601.5043456532352, 222.89267473113406, 51.20287929357587, 16.30657961261626, 24.951701272283685, 60.460905075522426, 115.79294410685482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6182021327158229, "mean_inference_ms": 1.925873950148889, "mean_action_processing_ms": 0.25784650386244534, "mean_env_wait_ms": 0.23355475315370622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007416725158691406, "StateBufferConnector_ms": 0.0041351318359375, "ViewRequirementAgentConnector_ms": 0.10809206962585449}, "num_episodes": 23, "episode_return_max": 574.433305725479, "episode_return_min": 300.06846608023847, "episode_return_mean": 389.46119194671735, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.36440033521217, "num_env_steps_trained_throughput_per_sec": 310.36440033521217, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 11186.295, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11186.256, "sample_time_ms": 1412.198, "learn_time_ms": 9757.945, "learn_throughput": 409.922, "synch_weights_time_ms": 14.978}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "e552a_00000", "date": "2024-08-16_08-58-19", "timestamp": 1723778899, "time_this_iter_s": 12.938797235488892, "time_total_s": 708.4221732616425, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b224df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 708.4221732616425, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 44.30526315789474, "ram_util_percent": 83.60526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.576093427655558, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.022538396038076, "policy_loss": -0.0073798076006357195, "vf_loss": 9.028236408586855, "vf_explained_var": 0.07473454844383966, "kl": 0.009966199409482143, "entropy": 0.8783470332937896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.377455945904293, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.314033679356651, "policy_loss": -0.006324273594236248, "vf_loss": 9.319060769661395, "vf_explained_var": 0.008014513197399322, "kl": 0.01729567840252794, "entropy": 1.0942711300320096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 495.6484209682244, "episode_reward_min": 300.06846608023847, "episode_reward_mean": 381.8752345717486, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -646.0227667051049, "predator_policy": 13.141439211348162}, "policy_reward_max": {"prey_policy": 184.2425450421955, "predator_policy": 601.5043456532352}, "policy_reward_mean": {"prey_policy": 88.55158210253343, "predator_policy": 102.38603518334085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [424.0510158941213, 412.01808595295086, 376.72806556892067, 383.5312463090587, 379.4027357714328, 389.24618987904495, 394.4224176956632, 424.6459978973979, 388.99793527965284, 424.60046760156746, 441.82937325855943, 405.5097183135435, 377.2486105610825, 411.54646399176585, 396.6454912783692, 363.1343792413435, 403.5196724421766, 432.1031440824235, 379.5074763454746, 393.41351243136984, 380.4504451352904, 394.1795238254415, 416.6693808710752, 379.8398544714166, 391.04120570222995, 369.20624839347255, 356.94489811909455, 391.70681370405936, 392.50459263419765, 393.08702496451394, 396.1969572637928, 375.4389576868338, 341.6832023352787, 414.71896695124303, 388.9397101592747, 384.61292150020256, 382.4418655709066, 409.4480447941176, 344.51981085692603, 405.77944839370764, 383.88152653317195, 352.40300185916294, 303.90868665316293, 418.40719349489564, 372.69573395919184, 375.6833425152077, 396.6096838507755, 373.5964513727601, 380.0095853943723, 403.41191773797203, 346.35448666572194, 388.2665968545421, 394.3292003493855, 408.3061104261901, 390.939344074596, 365.9003581508632, 360.8129287518695, 354.5509217050083, 416.26797700214547, 347.08830293707604, 355.217689154623, 342.2367043412762, 327.0325916163537, 495.6484209682244, 397.271306792051, 340.36997184616234, 362.262551218757, 420.9078854930615, 402.6406205610013, 364.8180158255907, 384.64843746870446, 365.14754667273866, 368.64679970006586, 372.92079931000796, 427.42906802138333, 300.06846608023847, 379.41823411093924, 394.8953825164181, 335.51746002614925, 326.253226698961, 370.44243365064807, 332.7128682250433, 314.55604059208895, 337.2291946427178, 394.15597050078134, 430.13645379926226, 387.0143045562459, 378.3628185615242, 327.859233217395, 371.32017776467836, 415.5039066884835, 387.7287035907949, 330.3310093897711, 417.84457892779164, 346.9712818509024, 340.27483872146007, 408.79316286858904, 439.2672979100801, 324.56036008700664, 424.1724197898229], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [108.38314083877907, 135.63313419955603, 140.7155939793542, 112.078064867819, 128.69685306127099, 137.12381774119135, 114.3076890645062, 120.2401237040107, 128.81027367835767, 124.16298952766684, 151.2337883999691, 149.73000555383157, 136.68623933666333, 139.0205235524339, 67.18307696980887, 126.83201824399474, 157.4443048527709, 145.93584316568678, 184.2425450421955, 137.57915599260994, 131.1520408371643, 160.91310420370334, 149.59903671366982, 148.03398841222045, 139.76039693565707, 114.86141262323203, 134.87246075851147, 156.4235638100698, 168.2543572228741, 169.297564932455, 121.9709106692626, 136.4863220959865, 159.29490245172667, 144.42275388378434, 92.9880285981821, 53.25652654710708, 6.5671253985000035, 66.74151605579381, 171.4408818988242, 154.56552070238448, 183.86593060645666, 148.6204189681819, 157.28730884031378, 117.23647404687682, 148.43973288940674, 149.03311415821653, 152.93060406253446, 153.46140894977123, 160.78548848247175, 96.58459352362235, 151.112257483495, 166.21617170844516, 80.6790375753879, 87.4958866830455, 175.6238759674457, 131.14252395898683, -11.252246405326126, 71.87842829104856, 142.7982153773124, 140.9805797278543, 107.527044372288, 117.20683749071809, 167.80242769567192, 150.91052395438345, 106.00990213106674, 63.035659692923, 153.5970269562198, 157.36747992144154, 135.06421541579314, 123.57969867182275, 153.4545124714888, 155.18813563212663, 179.7595425066262, 123.53106488706698, 160.68475813615984, 178.3543198846991, 77.88032670693268, 82.7024555023287, 151.06645493367367, 102.72217057449585, 79.24773994094062, 102.1858700809404, 107.87723506224675, 125.1427280628464, 44.70020978189452, 22.12422738504372, 87.53228540553478, 123.9497291170679, 97.17700605823849, 143.73948828833022, 120.98248041535217, 140.09684343021505, 102.67738443538806, 90.79684511904131, 88.30747940019074, 146.84121275776548, 88.12924648940778, 123.73561997646772, 113.31887198220106, 51.15994273911733, 9.794209180847732, 94.69554909368142, 130.29874308655613, 153.00924108544447, 61.78793635598102, 72.63492963654078, 139.19222560170542, 92.49491469870328, 163.52224016526023, 181.3130689158722, -42.007108994217646, 30.95494234733272, 13.761411113179967, 37.41508630284603, 155.79368519960863, 135.1117463077187, 42.38650118289114, 58.96448231599456, 45.63483256968701, 49.52350967033024, 104.508981085485, 107.45183958731324, 93.9176918250042, 68.0368171173078, 64.8487720790116, 63.560091374195665, -97.07467483629823, 26.124856510605174, 25.280622086800175, 52.31182005733314, 76.53359591898807, 103.23170050419719, -4.689235240587083, 53.07265526803441, 44.03974013985553, 62.15909333371993, 101.19452735709339, -44.49453018251724, 150.02658363119014, 152.60740142130635, 156.55666902967937, 147.03601945627216, 49.48624210830704, 16.25612510544437, 66.14381949578367, 118.08285567175356, 140.79225196497518, 126.45372977253629, 61.508184065071156, -49.783422445200365, 18.173127073119844, 11.576293289580045, 142.35109649633537, 165.58638416343516, 154.99610437415063, 167.3507005435877, -646.0227667051049, 10.90436406397666, 15.316950160287188, 36.84072251396382, 170.32332741750488, 158.86082534824328, 64.54659331655782, 91.91242572610797, 43.032440528683686, 71.60089205148182, 87.25768291077796, 84.85436092088368, 50.49605969095109, -10.965104393634585, 39.73938210009916, 17.770697966853508, 22.810879547242067, -3.1007383121567003, -31.78380867596084, 42.592058588557855, -55.01757056500681, -105.65638388204415, 98.3242125031417, 93.22585555678178, 9.374604126858703, 78.5797951724186, 48.28967950542281, -10.94242810161369, 49.61087733817144, 37.515172084336484, 9.370583232378868, 41.952086313826115, 48.44489523301003, 23.303593665211707, 83.5409991746191, 70.83141847884764, 35.18312267082638, 59.973808928557645, 21.88501344760167, -57.10670002158701, -20.413630207608282, 10.638373435329306, 15.871187390853176, 6.025530336912843], "policy_predator_policy_reward": [86.98043083215627, 93.05431002362994, 59.53552671074942, 99.68890039502813, 53.584717149262744, 57.32267761719543, 57.94971175686408, 91.03372178367754, 73.5600235206732, 52.869449044734914, 61.00891637033253, 27.273479554911532, 63.7506845728049, 54.96497023376157, 118.71683308680039, 111.91406959679372, 36.08721969666781, 49.53056756452758, 57.751850589646196, 45.02691597711588, 77.81573890663711, 71.94848931105487, 41.37388945276049, 66.50280373489247, 66.37161443109659, 56.255186571096736, 66.96867191382943, 53.281767509354445, 30.829299076289143, 28.264270046751065, 72.42074299355512, 32.25640348253921, 47.76752230819084, 52.03449379847489, 110.10762990389067, 175.75095903324345, 109.3621548616671, 196.8366800295135, 33.88993665046282, 33.51717317969831, 19.693442084298347, 28.270653476353743, 46.06916027886084, 73.58658065938981, 52.89050468385511, 66.30602913959656, 49.87307689486502, 23.574764564245392, 65.36498439733865, 68.3061392987972, 38.736379990184226, 13.141439211348162, 132.28607022492562, 56.48390363573572, 47.39510637429372, 37.54530740333278, 199.6303708414938, 132.24803990698106, 55.943785207223044, 53.36444465212463, 75.6087266224817, 95.85434877830495, 15.338249089265414, 41.38775694751277, 133.99756259850363, 38.64007791278583, 47.806543132379275, 55.94791694120271, 52.15178123574859, 78.1440148359098, 31.549741291193016, 44.42053210539411, 64.74120791175889, 14.410050265454649, 33.51541533423272, 36.89355143902577, 124.28479471447153, 59.652233933193, 67.85537125336921, 84.13545163216901, 106.88173523489588, 95.56618127639553, 27.56812421812237, 91.81491451594721, 55.6171648280041, 181.46708465822013, 110.32763518971804, 96.597543782575, 50.53217747324104, 81.247062139382, 95.29367696488855, 19.310341704751824, 141.6274237193468, 61.50803057699964, 30.127752911717096, 108.32000630308698, 53.67732624366163, 114.46739268483493, 105.30098271749394, 133.6321202991594, 42.0724702254731, 199.79225816571986, 62.38868972989909, 42.56992295264248, 128.35886360936763, 131.5474707474961, 73.10327075210027, 103.51569937368144, 23.749278555775128, 22.354756437688334, 199.56577846233904, 177.3867463354093, 95.66877645098327, 213.9676548848605, 27.970479709292213, 35.67501048838862, 143.1760254273834, 171.74096807587577, 72.9824026582075, 178.94755803885099, 103.94587794066298, 39.31099054116149, 155.36358347517978, 24.91861192378454, 30.532879256953745, 168.09084890619303, 299.6914603346066, 266.9067789593112, 102.67068706025967, 217.00817758765783, 109.43595336209536, 51.16872206088183, 200.28091020179357, 113.5982209895162, 176.1360921067063, 138.5729599127797, 152.77326602894905, 193.1673573574765, 34.92569241142942, 27.25833836166502, 51.082148220309314, 29.97360076244325, 112.04035140670223, 187.36482805228533, 42.843976400049016, 141.57614813247952, 21.877501876948315, 83.79731569554818, 230.02299813621846, 185.68130826529395, 210.2541854153477, 60.064860302190624, 49.592272445416754, 21.888481005752237, 37.56842649415846, 34.98015110452162, 369.1315170140413, 601.5043456532352, 222.89267473113406, 51.20287929357587, 16.30657961261626, 24.951701272283685, 60.460905075522426, 115.79294410685482, 19.449666477738667, 180.47304153418514, 127.1905119919764, 37.92663881907963, 175.35364783334947, 179.27136737011554, 179.8739841229316, 192.7523896093772, 218.06962442684627, 149.2345388943148, 214.89339584719195, 152.66117280173486, 113.09495757303124, 375.4382300914149, 72.66056491508435, 107.10954478967088, 167.77820723749258, 159.77130015171394, 150.46655723789678, 199.91489494908814, 47.81302375273973, 195.39193621452299, 188.40384904501934, 178.11806033656717, 195.21604272762383, 80.00675022505617, 48.06017914573362, 137.84224192225997, 150.0644322843415, 163.57179898486336, 257.0300678444377, 217.45891663962763, 241.00327221373357, 93.33234464555176, 184.93461600286594, 217.341086059191]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6173696231262491, "mean_inference_ms": 1.9290317407222093, "mean_action_processing_ms": 0.2577303224629426, "mean_env_wait_ms": 0.23349146362554202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006961464881896973, "StateBufferConnector_ms": 0.003511667251586914, "ViewRequirementAgentConnector_ms": 0.10322391986846924}, "num_episodes": 18, "episode_return_max": 495.6484209682244, "episode_return_min": 300.06846608023847, "episode_return_mean": 381.8752345717486, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.18250771158574, "num_env_steps_trained_throughput_per_sec": 291.18250771158574, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 11445.335, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11445.295, "sample_time_ms": 1401.473, "learn_time_ms": 10026.873, "learn_throughput": 398.928, "synch_weights_time_ms": 15.609}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "e552a_00000", "date": "2024-08-16_08-58-33", "timestamp": 1723778913, "time_this_iter_s": 13.78541898727417, "time_total_s": 722.2075922489166, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 722.2075922489166, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 50.536842105263155, "ram_util_percent": 83.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.315339384602491, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.185710174822933, "policy_loss": -0.0027314233221606447, "vf_loss": 9.186598745477262, "vf_explained_var": -0.014363389954995857, "kl": 0.010920610784052388, "entropy": 0.8403592866249185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.869195437935925, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.013194295338222, "policy_loss": -0.004959065868228516, "vf_loss": 9.017354497455415, "vf_explained_var": 0.015160641972980803, "kl": 0.010651678518884124, "entropy": 1.1268681838398888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 701.3332458927531, "episode_reward_min": 300.06846608023847, "episode_reward_mean": 388.4243093672272, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1356.1571590845754, "predator_policy": 13.141439211348162}, "policy_reward_max": {"prey_policy": 183.86593060645666, "predator_policy": 1068.6972222731924}, "policy_reward_mean": {"prey_policy": 63.15767787272778, "predator_policy": 131.05447681088575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.5074763454746, 393.41351243136984, 380.4504451352904, 394.1795238254415, 416.6693808710752, 379.8398544714166, 391.04120570222995, 369.20624839347255, 356.94489811909455, 391.70681370405936, 392.50459263419765, 393.08702496451394, 396.1969572637928, 375.4389576868338, 341.6832023352787, 414.71896695124303, 388.9397101592747, 384.61292150020256, 382.4418655709066, 409.4480447941176, 344.51981085692603, 405.77944839370764, 383.88152653317195, 352.40300185916294, 303.90868665316293, 418.40719349489564, 372.69573395919184, 375.6833425152077, 396.6096838507755, 373.5964513727601, 380.0095853943723, 403.41191773797203, 346.35448666572194, 388.2665968545421, 394.3292003493855, 408.3061104261901, 390.939344074596, 365.9003581508632, 360.8129287518695, 354.5509217050083, 416.26797700214547, 347.08830293707604, 355.217689154623, 342.2367043412762, 327.0325916163537, 495.6484209682244, 397.271306792051, 340.36997184616234, 362.262551218757, 420.9078854930615, 402.6406205610013, 364.8180158255907, 384.64843746870446, 365.14754667273866, 368.64679970006586, 372.92079931000796, 427.42906802138333, 300.06846608023847, 379.41823411093924, 394.8953825164181, 335.51746002614925, 326.253226698961, 370.44243365064807, 332.7128682250433, 314.55604059208895, 337.2291946427178, 394.15597050078134, 430.13645379926226, 387.0143045562459, 378.3628185615242, 327.859233217395, 371.32017776467836, 415.5039066884835, 387.7287035907949, 330.3310093897711, 417.84457892779164, 346.9712818509024, 340.27483872146007, 408.79316286858904, 439.2672979100801, 324.56036008700664, 424.1724197898229, 394.8739913154319, 401.5785920746269, 445.48279785449705, 450.25918677222984, 422.77611121972166, 399.3181928543411, 701.3332458927531, 467.5300471872626, 465.5115122566141, 439.426177909025, 458.4715655919613, 448.36254670373035, 397.4303236330602, 436.5057650575234, 362.84416623094916, 377.6171397489213, 388.192566858556, 426.5745614057203], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.5671253985000035, 66.74151605579381, 171.4408818988242, 154.56552070238448, 183.86593060645666, 148.6204189681819, 157.28730884031378, 117.23647404687682, 148.43973288940674, 149.03311415821653, 152.93060406253446, 153.46140894977123, 160.78548848247175, 96.58459352362235, 151.112257483495, 166.21617170844516, 80.6790375753879, 87.4958866830455, 175.6238759674457, 131.14252395898683, -11.252246405326126, 71.87842829104856, 142.7982153773124, 140.9805797278543, 107.527044372288, 117.20683749071809, 167.80242769567192, 150.91052395438345, 106.00990213106674, 63.035659692923, 153.5970269562198, 157.36747992144154, 135.06421541579314, 123.57969867182275, 153.4545124714888, 155.18813563212663, 179.7595425066262, 123.53106488706698, 160.68475813615984, 178.3543198846991, 77.88032670693268, 82.7024555023287, 151.06645493367367, 102.72217057449585, 79.24773994094062, 102.1858700809404, 107.87723506224675, 125.1427280628464, 44.70020978189452, 22.12422738504372, 87.53228540553478, 123.9497291170679, 97.17700605823849, 143.73948828833022, 120.98248041535217, 140.09684343021505, 102.67738443538806, 90.79684511904131, 88.30747940019074, 146.84121275776548, 88.12924648940778, 123.73561997646772, 113.31887198220106, 51.15994273911733, 9.794209180847732, 94.69554909368142, 130.29874308655613, 153.00924108544447, 61.78793635598102, 72.63492963654078, 139.19222560170542, 92.49491469870328, 163.52224016526023, 181.3130689158722, -42.007108994217646, 30.95494234733272, 13.761411113179967, 37.41508630284603, 155.79368519960863, 135.1117463077187, 42.38650118289114, 58.96448231599456, 45.63483256968701, 49.52350967033024, 104.508981085485, 107.45183958731324, 93.9176918250042, 68.0368171173078, 64.8487720790116, 63.560091374195665, -97.07467483629823, 26.124856510605174, 25.280622086800175, 52.31182005733314, 76.53359591898807, 103.23170050419719, -4.689235240587083, 53.07265526803441, 44.03974013985553, 62.15909333371993, 101.19452735709339, -44.49453018251724, 150.02658363119014, 152.60740142130635, 156.55666902967937, 147.03601945627216, 49.48624210830704, 16.25612510544437, 66.14381949578367, 118.08285567175356, 140.79225196497518, 126.45372977253629, 61.508184065071156, -49.783422445200365, 18.173127073119844, 11.576293289580045, 142.35109649633537, 165.58638416343516, 154.99610437415063, 167.3507005435877, -646.0227667051049, 10.90436406397666, 15.316950160287188, 36.84072251396382, 170.32332741750488, 158.86082534824328, 64.54659331655782, 91.91242572610797, 43.032440528683686, 71.60089205148182, 87.25768291077796, 84.85436092088368, 50.49605969095109, -10.965104393634585, 39.73938210009916, 17.770697966853508, 22.810879547242067, -3.1007383121567003, -31.78380867596084, 42.592058588557855, -55.01757056500681, -105.65638388204415, 98.3242125031417, 93.22585555678178, 9.374604126858703, 78.5797951724186, 48.28967950542281, -10.94242810161369, 49.61087733817144, 37.515172084336484, 9.370583232378868, 41.952086313826115, 48.44489523301003, 23.303593665211707, 83.5409991746191, 70.83141847884764, 35.18312267082638, 59.973808928557645, 21.88501344760167, -57.10670002158701, -20.413630207608282, 10.638373435329306, 15.871187390853176, 6.025530336912843, 48.395578741263215, 42.66686014120858, 13.331265040806922, 96.15723918834435, 20.30184012727652, 60.18170367950736, 1.1528459928973158, 96.76227072211952, 50.87705473703639, 51.82261207238731, 14.784601618761563, 54.8777907381774, -1356.1571590845754, 128.53956479087665, 101.49052501735467, -16.513071047722626, 39.18946187920494, -346.9417557098125, 50.02132046877276, 85.34807923740085, 75.27791718330111, -189.58489159976938, 69.85740419078105, 21.04708120238985, 44.805108424349335, 45.92390188276502, 47.37158278655512, -33.34635194774329, 66.21870820786043, 15.713248626168221, 42.311213297997526, 66.30397406992644, 10.306160198590602, 64.2526151674423, 89.81488622246702, 76.28452024258794], "policy_predator_policy_reward": [109.3621548616671, 196.8366800295135, 33.88993665046282, 33.51717317969831, 19.693442084298347, 28.270653476353743, 46.06916027886084, 73.58658065938981, 52.89050468385511, 66.30602913959656, 49.87307689486502, 23.574764564245392, 65.36498439733865, 68.3061392987972, 38.736379990184226, 13.141439211348162, 132.28607022492562, 56.48390363573572, 47.39510637429372, 37.54530740333278, 199.6303708414938, 132.24803990698106, 55.943785207223044, 53.36444465212463, 75.6087266224817, 95.85434877830495, 15.338249089265414, 41.38775694751277, 133.99756259850363, 38.64007791278583, 47.806543132379275, 55.94791694120271, 52.15178123574859, 78.1440148359098, 31.549741291193016, 44.42053210539411, 64.74120791175889, 14.410050265454649, 33.51541533423272, 36.89355143902577, 124.28479471447153, 59.652233933193, 67.85537125336921, 84.13545163216901, 106.88173523489588, 95.56618127639553, 27.56812421812237, 91.81491451594721, 55.6171648280041, 181.46708465822013, 110.32763518971804, 96.597543782575, 50.53217747324104, 81.247062139382, 95.29367696488855, 19.310341704751824, 141.6274237193468, 61.50803057699964, 30.127752911717096, 108.32000630308698, 53.67732624366163, 114.46739268483493, 105.30098271749394, 133.6321202991594, 42.0724702254731, 199.79225816571986, 62.38868972989909, 42.56992295264248, 128.35886360936763, 131.5474707474961, 73.10327075210027, 103.51569937368144, 23.749278555775128, 22.354756437688334, 199.56577846233904, 177.3867463354093, 95.66877645098327, 213.9676548848605, 27.970479709292213, 35.67501048838862, 143.1760254273834, 171.74096807587577, 72.9824026582075, 178.94755803885099, 103.94587794066298, 39.31099054116149, 155.36358347517978, 24.91861192378454, 30.532879256953745, 168.09084890619303, 299.6914603346066, 266.9067789593112, 102.67068706025967, 217.00817758765783, 109.43595336209536, 51.16872206088183, 200.28091020179357, 113.5982209895162, 176.1360921067063, 138.5729599127797, 152.77326602894905, 193.1673573574765, 34.92569241142942, 27.25833836166502, 51.082148220309314, 29.97360076244325, 112.04035140670223, 187.36482805228533, 42.843976400049016, 141.57614813247952, 21.877501876948315, 83.79731569554818, 230.02299813621846, 185.68130826529395, 210.2541854153477, 60.064860302190624, 49.592272445416754, 21.888481005752237, 37.56842649415846, 34.98015110452162, 369.1315170140413, 601.5043456532352, 222.89267473113406, 51.20287929357587, 16.30657961261626, 24.951701272283685, 60.460905075522426, 115.79294410685482, 19.449666477738667, 180.47304153418514, 127.1905119919764, 37.92663881907963, 175.35364783334947, 179.27136737011554, 179.8739841229316, 192.7523896093772, 218.06962442684627, 149.2345388943148, 214.89339584719195, 152.66117280173486, 113.09495757303124, 375.4382300914149, 72.66056491508435, 107.10954478967088, 167.77820723749258, 159.77130015171394, 150.46655723789678, 199.91489494908814, 47.81302375273973, 195.39193621452299, 188.40384904501934, 178.11806033656717, 195.21604272762383, 80.00675022505617, 48.06017914573362, 137.84224192225997, 150.0644322843415, 163.57179898486336, 257.0300678444377, 217.45891663962763, 241.00327221373357, 93.33234464555176, 184.93461600286594, 217.341086059191, 174.39807437638711, 129.41347805657304, 128.1895518985707, 163.9005359469049, 172.17649471803344, 192.82275932967883, 160.4616407496154, 191.8824293075971, 150.24110555074182, 169.83533885955615, 183.2374213248628, 146.41837917253994, 860.2536179132615, 1068.6972222731924, 184.5200606551768, 198.0325325624532, 341.83724870998003, 431.4265573772415, 143.94788189944543, 160.10889630340574, 257.4282766455893, 315.35026336284005, 181.26645999772563, 176.19160131283445, 137.55501781420787, 169.14629551173797, 188.72050225966683, 233.76003195904428, 149.59531129643054, 131.3168981004901, 113.26975941096666, 155.7321929700299, 171.40253269404073, 142.2312587984821, 130.72143745627702, 129.7537174843885]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6179318748436213, "mean_inference_ms": 1.9310812769090788, "mean_action_processing_ms": 0.2578667187026232, "mean_env_wait_ms": 0.2338244492517859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076073408126831055, "StateBufferConnector_ms": 0.004367351531982422, "ViewRequirementAgentConnector_ms": 0.11667752265930176}, "num_episodes": 18, "episode_return_max": 701.3332458927531, "episode_return_min": 300.06846608023847, "episode_return_mean": 388.4243093672272, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.04700191719735, "num_env_steps_trained_throughput_per_sec": 306.04700191719735, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 11641.633, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11641.594, "sample_time_ms": 1478.251, "learn_time_ms": 10146.631, "learn_throughput": 394.22, "synch_weights_time_ms": 15.251}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "e552a_00000", "date": "2024-08-16_08-58-46", "timestamp": 1723778926, "time_this_iter_s": 13.113655090332031, "time_total_s": 735.3212473392487, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 735.3212473392487, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 50.07894736842106, "ram_util_percent": 83.6421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.824894077815706, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.864761577081428, "policy_loss": -0.0037302076878154245, "vf_loss": 8.867240850509159, "vf_explained_var": -0.013330015524354562, "kl": 0.007412974217062362, "entropy": 0.794179237614233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.246282588552545, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.102642359556976, "policy_loss": -0.008660102032233405, "vf_loss": 9.110526456277837, "vf_explained_var": -0.007946042818997903, "kl": 0.010347033052588852, "entropy": 1.11327730663239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 701.3332458927531, "episode_reward_min": 300.06846608023847, "episode_reward_mean": 395.4153429220373, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1356.1571590845754, "predator_policy": 16.30657961261626}, "policy_reward_max": {"prey_policy": 181.3130689158722, "predator_policy": 1068.6972222731924}, "policy_reward_mean": {"prey_policy": 45.925560762730186, "predator_policy": 151.78211069828845}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.88152653317195, 352.40300185916294, 303.90868665316293, 418.40719349489564, 372.69573395919184, 375.6833425152077, 396.6096838507755, 373.5964513727601, 380.0095853943723, 403.41191773797203, 346.35448666572194, 388.2665968545421, 394.3292003493855, 408.3061104261901, 390.939344074596, 365.9003581508632, 360.8129287518695, 354.5509217050083, 416.26797700214547, 347.08830293707604, 355.217689154623, 342.2367043412762, 327.0325916163537, 495.6484209682244, 397.271306792051, 340.36997184616234, 362.262551218757, 420.9078854930615, 402.6406205610013, 364.8180158255907, 384.64843746870446, 365.14754667273866, 368.64679970006586, 372.92079931000796, 427.42906802138333, 300.06846608023847, 379.41823411093924, 394.8953825164181, 335.51746002614925, 326.253226698961, 370.44243365064807, 332.7128682250433, 314.55604059208895, 337.2291946427178, 394.15597050078134, 430.13645379926226, 387.0143045562459, 378.3628185615242, 327.859233217395, 371.32017776467836, 415.5039066884835, 387.7287035907949, 330.3310093897711, 417.84457892779164, 346.9712818509024, 340.27483872146007, 408.79316286858904, 439.2672979100801, 324.56036008700664, 424.1724197898229, 394.8739913154319, 401.5785920746269, 445.48279785449705, 450.25918677222984, 422.77611121972166, 399.3181928543411, 701.3332458927531, 467.5300471872626, 465.5115122566141, 439.426177909025, 458.4715655919613, 448.36254670373035, 397.4303236330602, 436.5057650575234, 362.84416623094916, 377.6171397489213, 388.192566858556, 426.5745614057203, 434.3088960240631, 404.99136322739815, 430.2272346794701, 368.79641942939514, 407.3230812377075, 409.18184451313437, 392.3252942689855, 412.19576544950104, 425.6218917779189, 504.27404408962684, 441.61586094639955, 375.6310459745167, 412.903111654568, 417.0980739086461, 399.33888732561445, 413.2731550220488, 400.02185126989156, 460.6001695815279, 421.7436939339185, 382.1893407847631, 429.18925321966015, 438.5839392721879], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.24773994094062, 102.1858700809404, 107.87723506224675, 125.1427280628464, 44.70020978189452, 22.12422738504372, 87.53228540553478, 123.9497291170679, 97.17700605823849, 143.73948828833022, 120.98248041535217, 140.09684343021505, 102.67738443538806, 90.79684511904131, 88.30747940019074, 146.84121275776548, 88.12924648940778, 123.73561997646772, 113.31887198220106, 51.15994273911733, 9.794209180847732, 94.69554909368142, 130.29874308655613, 153.00924108544447, 61.78793635598102, 72.63492963654078, 139.19222560170542, 92.49491469870328, 163.52224016526023, 181.3130689158722, -42.007108994217646, 30.95494234733272, 13.761411113179967, 37.41508630284603, 155.79368519960863, 135.1117463077187, 42.38650118289114, 58.96448231599456, 45.63483256968701, 49.52350967033024, 104.508981085485, 107.45183958731324, 93.9176918250042, 68.0368171173078, 64.8487720790116, 63.560091374195665, -97.07467483629823, 26.124856510605174, 25.280622086800175, 52.31182005733314, 76.53359591898807, 103.23170050419719, -4.689235240587083, 53.07265526803441, 44.03974013985553, 62.15909333371993, 101.19452735709339, -44.49453018251724, 150.02658363119014, 152.60740142130635, 156.55666902967937, 147.03601945627216, 49.48624210830704, 16.25612510544437, 66.14381949578367, 118.08285567175356, 140.79225196497518, 126.45372977253629, 61.508184065071156, -49.783422445200365, 18.173127073119844, 11.576293289580045, 142.35109649633537, 165.58638416343516, 154.99610437415063, 167.3507005435877, -646.0227667051049, 10.90436406397666, 15.316950160287188, 36.84072251396382, 170.32332741750488, 158.86082534824328, 64.54659331655782, 91.91242572610797, 43.032440528683686, 71.60089205148182, 87.25768291077796, 84.85436092088368, 50.49605969095109, -10.965104393634585, 39.73938210009916, 17.770697966853508, 22.810879547242067, -3.1007383121567003, -31.78380867596084, 42.592058588557855, -55.01757056500681, -105.65638388204415, 98.3242125031417, 93.22585555678178, 9.374604126858703, 78.5797951724186, 48.28967950542281, -10.94242810161369, 49.61087733817144, 37.515172084336484, 9.370583232378868, 41.952086313826115, 48.44489523301003, 23.303593665211707, 83.5409991746191, 70.83141847884764, 35.18312267082638, 59.973808928557645, 21.88501344760167, -57.10670002158701, -20.413630207608282, 10.638373435329306, 15.871187390853176, 6.025530336912843, 48.395578741263215, 42.66686014120858, 13.331265040806922, 96.15723918834435, 20.30184012727652, 60.18170367950736, 1.1528459928973158, 96.76227072211952, 50.87705473703639, 51.82261207238731, 14.784601618761563, 54.8777907381774, -1356.1571590845754, 128.53956479087665, 101.49052501735467, -16.513071047722626, 39.18946187920494, -346.9417557098125, 50.02132046877276, 85.34807923740085, 75.27791718330111, -189.58489159976938, 69.85740419078105, 21.04708120238985, 44.805108424349335, 45.92390188276502, 47.37158278655512, -33.34635194774329, 66.21870820786043, 15.713248626168221, 42.311213297997526, 66.30397406992644, 10.306160198590602, 64.2526151674423, 89.81488622246702, 76.28452024258794, 8.833884329313383, 16.20142470427114, 95.84507059514985, 65.67944948226614, 102.43166286132188, 29.65802763708835, 20.711556509846293, 55.841640015544655, 73.07484603826455, 10.382964178700893, 96.51980317212806, 90.32106167459371, 67.41133066881008, 45.60614268509254, 72.88703870472418, 23.3927338764404, 104.12573896400302, 71.19050595988233, -30.98812514116033, 113.59245929208305, 38.893718576618475, 15.684594795345289, 56.18690193903308, 15.365680152583204, 38.11699418720019, 69.46826800292975, 72.34829657863195, 65.33160365364232, 69.44081854080919, -100.97565592673259, 58.636935280337084, 32.662457617108835, 16.208842083858105, 55.27698813568787, 69.65719374035294, 41.06698161854967, 56.13465094683269, -2.9928607235146307, 83.42488849591554, 17.669197626827835, 108.11558437737618, 97.43097240787046, 43.76249648737275, 55.621219686456904], "policy_predator_policy_reward": [106.88173523489588, 95.56618127639553, 27.56812421812237, 91.81491451594721, 55.6171648280041, 181.46708465822013, 110.32763518971804, 96.597543782575, 50.53217747324104, 81.247062139382, 95.29367696488855, 19.310341704751824, 141.6274237193468, 61.50803057699964, 30.127752911717096, 108.32000630308698, 53.67732624366163, 114.46739268483493, 105.30098271749394, 133.6321202991594, 42.0724702254731, 199.79225816571986, 62.38868972989909, 42.56992295264248, 128.35886360936763, 131.5474707474961, 73.10327075210027, 103.51569937368144, 23.749278555775128, 22.354756437688334, 199.56577846233904, 177.3867463354093, 95.66877645098327, 213.9676548848605, 27.970479709292213, 35.67501048838862, 143.1760254273834, 171.74096807587577, 72.9824026582075, 178.94755803885099, 103.94587794066298, 39.31099054116149, 155.36358347517978, 24.91861192378454, 30.532879256953745, 168.09084890619303, 299.6914603346066, 266.9067789593112, 102.67068706025967, 217.00817758765783, 109.43595336209536, 51.16872206088183, 200.28091020179357, 113.5982209895162, 176.1360921067063, 138.5729599127797, 152.77326602894905, 193.1673573574765, 34.92569241142942, 27.25833836166502, 51.082148220309314, 29.97360076244325, 112.04035140670223, 187.36482805228533, 42.843976400049016, 141.57614813247952, 21.877501876948315, 83.79731569554818, 230.02299813621846, 185.68130826529395, 210.2541854153477, 60.064860302190624, 49.592272445416754, 21.888481005752237, 37.56842649415846, 34.98015110452162, 369.1315170140413, 601.5043456532352, 222.89267473113406, 51.20287929357587, 16.30657961261626, 24.951701272283685, 60.460905075522426, 115.79294410685482, 19.449666477738667, 180.47304153418514, 127.1905119919764, 37.92663881907963, 175.35364783334947, 179.27136737011554, 179.8739841229316, 192.7523896093772, 218.06962442684627, 149.2345388943148, 214.89339584719195, 152.66117280173486, 113.09495757303124, 375.4382300914149, 72.66056491508435, 107.10954478967088, 167.77820723749258, 159.77130015171394, 150.46655723789678, 199.91489494908814, 47.81302375273973, 195.39193621452299, 188.40384904501934, 178.11806033656717, 195.21604272762383, 80.00675022505617, 48.06017914573362, 137.84224192225997, 150.0644322843415, 163.57179898486336, 257.0300678444377, 217.45891663962763, 241.00327221373357, 93.33234464555176, 184.93461600286594, 217.341086059191, 174.39807437638711, 129.41347805657304, 128.1895518985707, 163.9005359469049, 172.17649471803344, 192.82275932967883, 160.4616407496154, 191.8824293075971, 150.24110555074182, 169.83533885955615, 183.2374213248628, 146.41837917253994, 860.2536179132615, 1068.6972222731924, 184.5200606551768, 198.0325325624532, 341.83724870998003, 431.4265573772415, 143.94788189944543, 160.10889630340574, 257.4282766455893, 315.35026336284005, 181.26645999772563, 176.19160131283445, 137.55501781420787, 169.14629551173797, 188.72050225966683, 233.76003195904428, 149.59531129643054, 131.3168981004901, 113.26975941096666, 155.7321929700299, 171.40253269404073, 142.2312587984821, 130.72143745627702, 129.7537174843885, 184.38246693615827, 224.89112005432048, 118.39305196102372, 125.07379118895841, 157.39355661568774, 140.7439875653713, 130.27802048044634, 161.96520242355814, 129.5589336248497, 194.30633739589283, 121.37385984877629, 100.96711981763646, 124.20737586157824, 155.10044505350487, 155.06955821475955, 160.8464346535771, 117.32045753447086, 132.9851893195624, 204.75878161964854, 216.91092831905442, 180.9696567314558, 206.06789084297966, 140.02161933103164, 164.05684455186872, 156.78102997770077, 148.53681948673722, 150.2642251098428, 129.15394856652975, 276.6339279132258, 154.23979679831194, 172.88139753707304, 149.09236458753008, 168.38226372712822, 160.15375732321726, 166.33676677721883, 183.53922744540665, 197.38069822233265, 171.22120548826842, 162.97787373316913, 118.11738092884951, 108.86289156037944, 114.77980487403367, 163.8214883927303, 175.37873470562818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6190064546214009, "mean_inference_ms": 1.9390387625142975, "mean_action_processing_ms": 0.25819840595320265, "mean_env_wait_ms": 0.23482573292923412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005040287971496582, "StateBufferConnector_ms": 0.004179716110229492, "ViewRequirementAgentConnector_ms": 0.10908496379852295}, "num_episodes": 22, "episode_return_max": 701.3332458927531, "episode_return_min": 300.06846608023847, "episode_return_mean": 395.4153429220373, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 346.4082222464762, "num_env_steps_trained_throughput_per_sec": 346.4082222464762, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 11689.941, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11689.9, "sample_time_ms": 1551.265, "learn_time_ms": 10121.286, "learn_throughput": 395.207, "synch_weights_time_ms": 15.802}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "e552a_00000", "date": "2024-08-16_08-58-57", "timestamp": 1723778937, "time_this_iter_s": 11.599991798400879, "time_total_s": 746.9212391376495, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2291d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 746.9212391376495, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 39.24375, "ram_util_percent": 83.58125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.0534728219900185, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.594355633145287, "policy_loss": -0.0016457473920786349, "vf_loss": 7.595133661593079, "vf_explained_var": -0.31747865036681844, "kl": 0.005141962644093962, "entropy": 0.735176557523233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.158260504152409, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.226918837380788, "policy_loss": -0.010474681701984198, "vf_loss": 8.236450615131035, "vf_explained_var": 0.021186788372261813, "kl": 0.012572297169120956, "entropy": 1.0734582059913211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 701.3332458927531, "episode_reward_min": 300.06846608023847, "episode_reward_mean": 404.0647807637287, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1356.1571590845754, "predator_policy": 16.30657961261626}, "policy_reward_max": {"prey_policy": 170.32332741750488, "predator_policy": 1068.6972222731924}, "policy_reward_mean": {"prey_policy": 42.81838740603955, "predator_policy": 159.21400297582474}, "custom_metrics": {}, "hist_stats": {"episode_reward": [416.26797700214547, 347.08830293707604, 355.217689154623, 342.2367043412762, 327.0325916163537, 495.6484209682244, 397.271306792051, 340.36997184616234, 362.262551218757, 420.9078854930615, 402.6406205610013, 364.8180158255907, 384.64843746870446, 365.14754667273866, 368.64679970006586, 372.92079931000796, 427.42906802138333, 300.06846608023847, 379.41823411093924, 394.8953825164181, 335.51746002614925, 326.253226698961, 370.44243365064807, 332.7128682250433, 314.55604059208895, 337.2291946427178, 394.15597050078134, 430.13645379926226, 387.0143045562459, 378.3628185615242, 327.859233217395, 371.32017776467836, 415.5039066884835, 387.7287035907949, 330.3310093897711, 417.84457892779164, 346.9712818509024, 340.27483872146007, 408.79316286858904, 439.2672979100801, 324.56036008700664, 424.1724197898229, 394.8739913154319, 401.5785920746269, 445.48279785449705, 450.25918677222984, 422.77611121972166, 399.3181928543411, 701.3332458927531, 467.5300471872626, 465.5115122566141, 439.426177909025, 458.4715655919613, 448.36254670373035, 397.4303236330602, 436.5057650575234, 362.84416623094916, 377.6171397489213, 388.192566858556, 426.5745614057203, 434.3088960240631, 404.99136322739815, 430.2272346794701, 368.79641942939514, 407.3230812377075, 409.18184451313437, 392.3252942689855, 412.19576544950104, 425.6218917779189, 504.27404408962684, 441.61586094639955, 375.6310459745167, 412.903111654568, 417.0980739086461, 399.33888732561445, 413.2731550220488, 400.02185126989156, 460.6001695815279, 421.7436939339185, 382.1893407847631, 429.18925321966015, 438.5839392721879, 452.61878191483515, 414.3857824089609, 421.2050667201967, 441.99885655536184, 413.49975490437146, 467.25307003191693, 414.33558438631593, 428.82934339631225, 399.9258028441314, 409.7331206839355, 398.59031886923333, 449.69758092229534, 370.70538442172364, 420.6662759433811, 366.89822397761503, 446.4700869764702, 464.0008323243798, 454.1969872365416], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [42.38650118289114, 58.96448231599456, 45.63483256968701, 49.52350967033024, 104.508981085485, 107.45183958731324, 93.9176918250042, 68.0368171173078, 64.8487720790116, 63.560091374195665, -97.07467483629823, 26.124856510605174, 25.280622086800175, 52.31182005733314, 76.53359591898807, 103.23170050419719, -4.689235240587083, 53.07265526803441, 44.03974013985553, 62.15909333371993, 101.19452735709339, -44.49453018251724, 150.02658363119014, 152.60740142130635, 156.55666902967937, 147.03601945627216, 49.48624210830704, 16.25612510544437, 66.14381949578367, 118.08285567175356, 140.79225196497518, 126.45372977253629, 61.508184065071156, -49.783422445200365, 18.173127073119844, 11.576293289580045, 142.35109649633537, 165.58638416343516, 154.99610437415063, 167.3507005435877, -646.0227667051049, 10.90436406397666, 15.316950160287188, 36.84072251396382, 170.32332741750488, 158.86082534824328, 64.54659331655782, 91.91242572610797, 43.032440528683686, 71.60089205148182, 87.25768291077796, 84.85436092088368, 50.49605969095109, -10.965104393634585, 39.73938210009916, 17.770697966853508, 22.810879547242067, -3.1007383121567003, -31.78380867596084, 42.592058588557855, -55.01757056500681, -105.65638388204415, 98.3242125031417, 93.22585555678178, 9.374604126858703, 78.5797951724186, 48.28967950542281, -10.94242810161369, 49.61087733817144, 37.515172084336484, 9.370583232378868, 41.952086313826115, 48.44489523301003, 23.303593665211707, 83.5409991746191, 70.83141847884764, 35.18312267082638, 59.973808928557645, 21.88501344760167, -57.10670002158701, -20.413630207608282, 10.638373435329306, 15.871187390853176, 6.025530336912843, 48.395578741263215, 42.66686014120858, 13.331265040806922, 96.15723918834435, 20.30184012727652, 60.18170367950736, 1.1528459928973158, 96.76227072211952, 50.87705473703639, 51.82261207238731, 14.784601618761563, 54.8777907381774, -1356.1571590845754, 128.53956479087665, 101.49052501735467, -16.513071047722626, 39.18946187920494, -346.9417557098125, 50.02132046877276, 85.34807923740085, 75.27791718330111, -189.58489159976938, 69.85740419078105, 21.04708120238985, 44.805108424349335, 45.92390188276502, 47.37158278655512, -33.34635194774329, 66.21870820786043, 15.713248626168221, 42.311213297997526, 66.30397406992644, 10.306160198590602, 64.2526151674423, 89.81488622246702, 76.28452024258794, 8.833884329313383, 16.20142470427114, 95.84507059514985, 65.67944948226614, 102.43166286132188, 29.65802763708835, 20.711556509846293, 55.841640015544655, 73.07484603826455, 10.382964178700893, 96.51980317212806, 90.32106167459371, 67.41133066881008, 45.60614268509254, 72.88703870472418, 23.3927338764404, 104.12573896400302, 71.19050595988233, -30.98812514116033, 113.59245929208305, 38.893718576618475, 15.684594795345289, 56.18690193903308, 15.365680152583204, 38.11699418720019, 69.46826800292975, 72.34829657863195, 65.33160365364232, 69.44081854080919, -100.97565592673259, 58.636935280337084, 32.662457617108835, 16.208842083858105, 55.27698813568787, 69.65719374035294, 41.06698161854967, 56.13465094683269, -2.9928607235146307, 83.42488849591554, 17.669197626827835, 108.11558437737618, 97.43097240787046, 43.76249648737275, 55.621219686456904, 72.88777786853831, 164.63069496373652, 65.17505990234308, 108.64883067806251, 155.6691623710547, 99.14824187054602, 128.6730001090316, 43.00932745714673, 105.93734161650694, 88.5893210799124, 6.246666568748056, 92.00099843103509, 116.76936041231687, 58.69625619197671, 101.85533171511803, 111.21199027609062, 38.74736546732675, 6.188904114261006, 92.77978049373482, 90.00381884837597, 54.59354649406313, 73.13311702491659, 84.28715857612453, 151.65156758606298, 5.2064736168728185, 77.3049669626914, 66.16610541834483, 86.26903836130867, -13.621081453323297, 59.310951045828105, 16.02794019463931, 113.31321991959626, 86.56319975867349, -1.015163911678197, 55.316557011828905, 146.68376764535046], "policy_predator_policy_reward": [143.1760254273834, 171.74096807587577, 72.9824026582075, 178.94755803885099, 103.94587794066298, 39.31099054116149, 155.36358347517978, 24.91861192378454, 30.532879256953745, 168.09084890619303, 299.6914603346066, 266.9067789593112, 102.67068706025967, 217.00817758765783, 109.43595336209536, 51.16872206088183, 200.28091020179357, 113.5982209895162, 176.1360921067063, 138.5729599127797, 152.77326602894905, 193.1673573574765, 34.92569241142942, 27.25833836166502, 51.082148220309314, 29.97360076244325, 112.04035140670223, 187.36482805228533, 42.843976400049016, 141.57614813247952, 21.877501876948315, 83.79731569554818, 230.02299813621846, 185.68130826529395, 210.2541854153477, 60.064860302190624, 49.592272445416754, 21.888481005752237, 37.56842649415846, 34.98015110452162, 369.1315170140413, 601.5043456532352, 222.89267473113406, 51.20287929357587, 16.30657961261626, 24.951701272283685, 60.460905075522426, 115.79294410685482, 19.449666477738667, 180.47304153418514, 127.1905119919764, 37.92663881907963, 175.35364783334947, 179.27136737011554, 179.8739841229316, 192.7523896093772, 218.06962442684627, 149.2345388943148, 214.89339584719195, 152.66117280173486, 113.09495757303124, 375.4382300914149, 72.66056491508435, 107.10954478967088, 167.77820723749258, 159.77130015171394, 150.46655723789678, 199.91489494908814, 47.81302375273973, 195.39193621452299, 188.40384904501934, 178.11806033656717, 195.21604272762383, 80.00675022505617, 48.06017914573362, 137.84224192225997, 150.0644322843415, 163.57179898486336, 257.0300678444377, 217.45891663962763, 241.00327221373357, 93.33234464555176, 184.93461600286594, 217.341086059191, 174.39807437638711, 129.41347805657304, 128.1895518985707, 163.9005359469049, 172.17649471803344, 192.82275932967883, 160.4616407496154, 191.8824293075971, 150.24110555074182, 169.83533885955615, 183.2374213248628, 146.41837917253994, 860.2536179132615, 1068.6972222731924, 184.5200606551768, 198.0325325624532, 341.83724870998003, 431.4265573772415, 143.94788189944543, 160.10889630340574, 257.4282766455893, 315.35026336284005, 181.26645999772563, 176.19160131283445, 137.55501781420787, 169.14629551173797, 188.72050225966683, 233.76003195904428, 149.59531129643054, 131.3168981004901, 113.26975941096666, 155.7321929700299, 171.40253269404073, 142.2312587984821, 130.72143745627702, 129.7537174843885, 184.38246693615827, 224.89112005432048, 118.39305196102372, 125.07379118895841, 157.39355661568774, 140.7439875653713, 130.27802048044634, 161.96520242355814, 129.5589336248497, 194.30633739589283, 121.37385984877629, 100.96711981763646, 124.20737586157824, 155.10044505350487, 155.06955821475955, 160.8464346535771, 117.32045753447086, 132.9851893195624, 204.75878161964854, 216.91092831905442, 180.9696567314558, 206.06789084297966, 140.02161933103164, 164.05684455186872, 156.78102997770077, 148.53681948673722, 150.2642251098428, 129.15394856652975, 276.6339279132258, 154.23979679831194, 172.88139753707304, 149.09236458753008, 168.38226372712822, 160.15375732321726, 166.33676677721883, 183.53922744540665, 197.38069822233265, 171.22120548826842, 162.97787373316913, 118.11738092884951, 108.86289156037944, 114.77980487403367, 163.8214883927303, 175.37873470562818, 109.43001170735843, 105.67029737520174, 114.7467343515853, 125.81515747697014, 89.7418000818581, 76.64586239673818, 140.46450811494455, 129.85202087423795, 107.8695307815997, 111.10356142635274, 183.88948715780958, 185.11591787432468, 114.08779001694187, 124.78217776508035, 105.15138348221325, 110.61063792289045, 155.0368587826707, 199.95267447987328, 117.5185157889176, 109.43100555290816, 139.90297522335402, 130.96068012689983, 98.41132973975317, 115.34752502035525, 91.20746131560594, 196.9864825265533, 131.9492177653903, 136.28191439833665, 206.27978387848154, 114.92857050662928, 162.58735992338913, 154.54156693884553, 177.90546473344588, 200.54733174393843, 129.99945194605587, 122.19721063330658]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6204092863353398, "mean_inference_ms": 1.9415656126155545, "mean_action_processing_ms": 0.2586887415009374, "mean_env_wait_ms": 0.2355572805830666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004799246788024902, "StateBufferConnector_ms": 0.004074454307556152, "ViewRequirementAgentConnector_ms": 0.10869991779327393}, "num_episodes": 18, "episode_return_max": 701.3332458927531, "episode_return_min": 300.06846608023847, "episode_return_mean": 404.0647807637287, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.00344096946793, "num_env_steps_trained_throughput_per_sec": 382.00344096946793, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 11651.83, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11651.79, "sample_time_ms": 1553.239, "learn_time_ms": 10081.341, "learn_throughput": 396.773, "synch_weights_time_ms": 15.667}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "e552a_00000", "date": "2024-08-16_08-59-08", "timestamp": 1723778948, "time_this_iter_s": 10.475803852081299, "time_total_s": 757.3970429897308, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2291dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 757.3970429897308, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 30.279999999999994, "ram_util_percent": 83.16666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.591828728920568, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.017597690208879, "policy_loss": -0.002250887273204705, "vf_loss": 7.01885917628253, "vf_explained_var": -0.1681435625073771, "kl": 0.00586308666826054, "entropy": 0.7475354799833247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.64246834989578, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8677231278999775, "policy_loss": -0.009953837065770237, "vf_loss": 7.876687890007382, "vf_explained_var": 0.153186949630263, "kl": 0.013187812461432757, "entropy": 1.1096041276341393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 701.3332458927531, "episode_reward_min": 314.55604059208895, "episode_reward_mean": 417.4494927551894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1356.1571590845754, "predator_policy": 19.449666477738667}, "policy_reward_max": {"prey_policy": 172.56982922391205, "predator_policy": 1068.6972222731924}, "policy_reward_mean": {"prey_policy": 53.496242589943485, "predator_policy": 155.22850378765116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.7128682250433, 314.55604059208895, 337.2291946427178, 394.15597050078134, 430.13645379926226, 387.0143045562459, 378.3628185615242, 327.859233217395, 371.32017776467836, 415.5039066884835, 387.7287035907949, 330.3310093897711, 417.84457892779164, 346.9712818509024, 340.27483872146007, 408.79316286858904, 439.2672979100801, 324.56036008700664, 424.1724197898229, 394.8739913154319, 401.5785920746269, 445.48279785449705, 450.25918677222984, 422.77611121972166, 399.3181928543411, 701.3332458927531, 467.5300471872626, 465.5115122566141, 439.426177909025, 458.4715655919613, 448.36254670373035, 397.4303236330602, 436.5057650575234, 362.84416623094916, 377.6171397489213, 388.192566858556, 426.5745614057203, 434.3088960240631, 404.99136322739815, 430.2272346794701, 368.79641942939514, 407.3230812377075, 409.18184451313437, 392.3252942689855, 412.19576544950104, 425.6218917779189, 504.27404408962684, 441.61586094639955, 375.6310459745167, 412.903111654568, 417.0980739086461, 399.33888732561445, 413.2731550220488, 400.02185126989156, 460.6001695815279, 421.7436939339185, 382.1893407847631, 429.18925321966015, 438.5839392721879, 452.61878191483515, 414.3857824089609, 421.2050667201967, 441.99885655536184, 413.49975490437146, 467.25307003191693, 414.33558438631593, 428.82934339631225, 399.9258028441314, 409.7331206839355, 398.59031886923333, 449.69758092229534, 370.70538442172364, 420.6662759433811, 366.89822397761503, 446.4700869764702, 464.0008323243798, 454.1969872365416, 458.99008604704505, 484.35505748454426, 424.2575047734241, 432.9684633401057, 438.58447754098313, 437.46009508391154, 463.5097686889988, 415.3535977985944, 419.6065400699657, 406.3854656343621, 428.04065495987254, 393.6766911303649, 425.5514568801304, 422.25461468549634, 419.31095095165443, 466.5005512736898, 456.73652855817403, 413.27347020990896, 428.1574605951127, 401.85250453364824, 432.66190662653867, 438.08352924887606, 428.0497150432514], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.54659331655782, 91.91242572610797, 43.032440528683686, 71.60089205148182, 87.25768291077796, 84.85436092088368, 50.49605969095109, -10.965104393634585, 39.73938210009916, 17.770697966853508, 22.810879547242067, -3.1007383121567003, -31.78380867596084, 42.592058588557855, -55.01757056500681, -105.65638388204415, 98.3242125031417, 93.22585555678178, 9.374604126858703, 78.5797951724186, 48.28967950542281, -10.94242810161369, 49.61087733817144, 37.515172084336484, 9.370583232378868, 41.952086313826115, 48.44489523301003, 23.303593665211707, 83.5409991746191, 70.83141847884764, 35.18312267082638, 59.973808928557645, 21.88501344760167, -57.10670002158701, -20.413630207608282, 10.638373435329306, 15.871187390853176, 6.025530336912843, 48.395578741263215, 42.66686014120858, 13.331265040806922, 96.15723918834435, 20.30184012727652, 60.18170367950736, 1.1528459928973158, 96.76227072211952, 50.87705473703639, 51.82261207238731, 14.784601618761563, 54.8777907381774, -1356.1571590845754, 128.53956479087665, 101.49052501735467, -16.513071047722626, 39.18946187920494, -346.9417557098125, 50.02132046877276, 85.34807923740085, 75.27791718330111, -189.58489159976938, 69.85740419078105, 21.04708120238985, 44.805108424349335, 45.92390188276502, 47.37158278655512, -33.34635194774329, 66.21870820786043, 15.713248626168221, 42.311213297997526, 66.30397406992644, 10.306160198590602, 64.2526151674423, 89.81488622246702, 76.28452024258794, 8.833884329313383, 16.20142470427114, 95.84507059514985, 65.67944948226614, 102.43166286132188, 29.65802763708835, 20.711556509846293, 55.841640015544655, 73.07484603826455, 10.382964178700893, 96.51980317212806, 90.32106167459371, 67.41133066881008, 45.60614268509254, 72.88703870472418, 23.3927338764404, 104.12573896400302, 71.19050595988233, -30.98812514116033, 113.59245929208305, 38.893718576618475, 15.684594795345289, 56.18690193903308, 15.365680152583204, 38.11699418720019, 69.46826800292975, 72.34829657863195, 65.33160365364232, 69.44081854080919, -100.97565592673259, 58.636935280337084, 32.662457617108835, 16.208842083858105, 55.27698813568787, 69.65719374035294, 41.06698161854967, 56.13465094683269, -2.9928607235146307, 83.42488849591554, 17.669197626827835, 108.11558437737618, 97.43097240787046, 43.76249648737275, 55.621219686456904, 72.88777786853831, 164.63069496373652, 65.17505990234308, 108.64883067806251, 155.6691623710547, 99.14824187054602, 128.6730001090316, 43.00932745714673, 105.93734161650694, 88.5893210799124, 6.246666568748056, 92.00099843103509, 116.76936041231687, 58.69625619197671, 101.85533171511803, 111.21199027609062, 38.74736546732675, 6.188904114261006, 92.77978049373482, 90.00381884837597, 54.59354649406313, 73.13311702491659, 84.28715857612453, 151.65156758606298, 5.2064736168728185, 77.3049669626914, 66.16610541834483, 86.26903836130867, -13.621081453323297, 59.310951045828105, 16.02794019463931, 113.31321991959626, 86.56319975867349, -1.015163911678197, 55.316557011828905, 146.68376764535046, 42.57761141164784, 114.89446502385157, -32.65047019091132, 133.28837873068474, 105.05263272881297, 151.98908019304983, 61.18070430392454, 141.5916534748793, 126.5345324371849, 102.89175352985077, 131.25334113573075, 172.56982922391205, 34.87051104638959, 151.12569694657918, 105.8494688168371, 44.323407643609585, 79.19905765310361, 97.5963495010568, 121.25747009027208, 104.1051848230211, 154.90818136073122, 87.45182220031428, 95.2459489215869, 150.3691720192741, 117.29162339150608, 158.188176675651, 75.91693574620962, 113.7084576701812, 56.796547758720585, 127.84634217496378, 121.70288482018091, 71.21231876507662, 143.61371381686433, 83.65645806219908, 105.20480343071377, 111.14754077463495, 78.83496850843702, 159.60596433956502, 100.92067817670478, 110.20552384912013, 116.94271043624053, 67.27159471502418, 151.91900221720155, -26.293451072665203, 153.9145613485548, 96.43517589095588], "policy_predator_policy_reward": [60.460905075522426, 115.79294410685482, 19.449666477738667, 180.47304153418514, 127.1905119919764, 37.92663881907963, 175.35364783334947, 179.27136737011554, 179.8739841229316, 192.7523896093772, 218.06962442684627, 149.2345388943148, 214.89339584719195, 152.66117280173486, 113.09495757303124, 375.4382300914149, 72.66056491508435, 107.10954478967088, 167.77820723749258, 159.77130015171394, 150.46655723789678, 199.91489494908814, 47.81302375273973, 195.39193621452299, 188.40384904501934, 178.11806033656717, 195.21604272762383, 80.00675022505617, 48.06017914573362, 137.84224192225997, 150.0644322843415, 163.57179898486336, 257.0300678444377, 217.45891663962763, 241.00327221373357, 93.33234464555176, 184.93461600286594, 217.341086059191, 174.39807437638711, 129.41347805657304, 128.1895518985707, 163.9005359469049, 172.17649471803344, 192.82275932967883, 160.4616407496154, 191.8824293075971, 150.24110555074182, 169.83533885955615, 183.2374213248628, 146.41837917253994, 860.2536179132615, 1068.6972222731924, 184.5200606551768, 198.0325325624532, 341.83724870998003, 431.4265573772415, 143.94788189944543, 160.10889630340574, 257.4282766455893, 315.35026336284005, 181.26645999772563, 176.19160131283445, 137.55501781420787, 169.14629551173797, 188.72050225966683, 233.76003195904428, 149.59531129643054, 131.3168981004901, 113.26975941096666, 155.7321929700299, 171.40253269404073, 142.2312587984821, 130.72143745627702, 129.7537174843885, 184.38246693615827, 224.89112005432048, 118.39305196102372, 125.07379118895841, 157.39355661568774, 140.7439875653713, 130.27802048044634, 161.96520242355814, 129.5589336248497, 194.30633739589283, 121.37385984877629, 100.96711981763646, 124.20737586157824, 155.10044505350487, 155.06955821475955, 160.8464346535771, 117.32045753447086, 132.9851893195624, 204.75878161964854, 216.91092831905442, 180.9696567314558, 206.06789084297966, 140.02161933103164, 164.05684455186872, 156.78102997770077, 148.53681948673722, 150.2642251098428, 129.15394856652975, 276.6339279132258, 154.23979679831194, 172.88139753707304, 149.09236458753008, 168.38226372712822, 160.15375732321726, 166.33676677721883, 183.53922744540665, 197.38069822233265, 171.22120548826842, 162.97787373316913, 118.11738092884951, 108.86289156037944, 114.77980487403367, 163.8214883927303, 175.37873470562818, 109.43001170735843, 105.67029737520174, 114.7467343515853, 125.81515747697014, 89.7418000818581, 76.64586239673818, 140.46450811494455, 129.85202087423795, 107.8695307815997, 111.10356142635274, 183.88948715780958, 185.11591787432468, 114.08779001694187, 124.78217776508035, 105.15138348221325, 110.61063792289045, 155.0368587826707, 199.95267447987328, 117.5185157889176, 109.43100555290816, 139.90297522335402, 130.96068012689983, 98.41132973975317, 115.34752502035525, 91.20746131560594, 196.9864825265533, 131.9492177653903, 136.28191439833665, 206.27978387848154, 114.92857050662928, 162.58735992338913, 154.54156693884553, 177.90546473344588, 200.54733174393843, 129.99945194605587, 122.19721063330658, 150.81205175146206, 150.70595786008388, 199.92057980905577, 183.79656913571517, 83.62731257774276, 83.58847927381885, 106.31030359896144, 123.88580196234014, 91.38724254758014, 117.77094902636664, 65.54980989353811, 68.08711483072983, 135.25666377107538, 142.25689692495408, 125.05395566330331, 140.12676567484465, 127.82925585722707, 114.98187705857796, 89.61986454574752, 91.4029461753202, 92.45361349423787, 93.22703790458978, 65.5803330295365, 82.48123715996819, 76.43887068260526, 73.63278613036819, 121.96976880836836, 110.65945246073751, 113.348123967112, 121.31993705085787, 133.86617074160765, 139.7191769468238, 109.9537321374422, 119.51262454166861, 109.96754081474906, 86.95358518981034, 79.88126027146262, 109.83526747564791, 95.19893524063315, 95.52736726719029, 129.4746454516905, 118.97295602358285, 220.44772898835777, 92.01024911598257, 94.8407197649571, 82.85925803878318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6217493144510118, "mean_inference_ms": 1.9477081006608885, "mean_action_processing_ms": 0.2591469713666422, "mean_env_wait_ms": 0.23650250127828476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005387783050537109, "StateBufferConnector_ms": 0.004323840141296387, "ViewRequirementAgentConnector_ms": 0.11045575141906738}, "num_episodes": 23, "episode_return_max": 701.3332458927531, "episode_return_min": 314.55604059208895, "episode_return_mean": 417.4494927551894, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.123857319503, "num_env_steps_trained_throughput_per_sec": 384.123857319503, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 11611.306, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11611.266, "sample_time_ms": 1561.376, "learn_time_ms": 10033.237, "learn_throughput": 398.675, "synch_weights_time_ms": 15.141}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "e552a_00000", "date": "2024-08-16_08-59-18", "timestamp": 1723778958, "time_this_iter_s": 10.422552824020386, "time_total_s": 767.8195958137512, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 767.8195958137512, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 33.739999999999995, "ram_util_percent": 83.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.2423560520328545, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.448633288832569, "policy_loss": -0.003016906070508181, "vf_loss": 6.450101765375289, "vf_explained_var": -0.19176981035994475, "kl": 0.009175895171976303, "entropy": 0.7291435505347277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.970623131529996, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.595019316042542, "policy_loss": -0.007756614962237931, "vf_loss": 7.601489665016295, "vf_explained_var": 0.33277444145666857, "kl": 0.017150319372536162, "entropy": 1.1483211480751239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 701.3332458927531, "episode_reward_min": 204.4172228550063, "episode_reward_mean": 425.3327160076845, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1356.1571590845754, "predator_policy": 39.85244027623785}, "policy_reward_max": {"prey_policy": 172.56982922391205, "predator_policy": 1068.6972222731924}, "policy_reward_mean": {"prey_policy": 69.19332490748029, "predator_policy": 143.47303309636197}, "custom_metrics": {}, "hist_stats": {"episode_reward": [424.1724197898229, 394.8739913154319, 401.5785920746269, 445.48279785449705, 450.25918677222984, 422.77611121972166, 399.3181928543411, 701.3332458927531, 467.5300471872626, 465.5115122566141, 439.426177909025, 458.4715655919613, 448.36254670373035, 397.4303236330602, 436.5057650575234, 362.84416623094916, 377.6171397489213, 388.192566858556, 426.5745614057203, 434.3088960240631, 404.99136322739815, 430.2272346794701, 368.79641942939514, 407.3230812377075, 409.18184451313437, 392.3252942689855, 412.19576544950104, 425.6218917779189, 504.27404408962684, 441.61586094639955, 375.6310459745167, 412.903111654568, 417.0980739086461, 399.33888732561445, 413.2731550220488, 400.02185126989156, 460.6001695815279, 421.7436939339185, 382.1893407847631, 429.18925321966015, 438.5839392721879, 452.61878191483515, 414.3857824089609, 421.2050667201967, 441.99885655536184, 413.49975490437146, 467.25307003191693, 414.33558438631593, 428.82934339631225, 399.9258028441314, 409.7331206839355, 398.59031886923333, 449.69758092229534, 370.70538442172364, 420.6662759433811, 366.89822397761503, 446.4700869764702, 464.0008323243798, 454.1969872365416, 458.99008604704505, 484.35505748454426, 424.2575047734241, 432.9684633401057, 438.58447754098313, 437.46009508391154, 463.5097686889988, 415.3535977985944, 419.6065400699657, 406.3854656343621, 428.04065495987254, 393.6766911303649, 425.5514568801304, 422.25461468549634, 419.31095095165443, 466.5005512736898, 456.73652855817403, 413.27347020990896, 428.1574605951127, 401.85250453364824, 432.66190662653867, 438.08352924887606, 428.0497150432514, 422.4727370717299, 445.3885809018352, 439.16120685494036, 443.62924899125017, 417.6803695137398, 410.4324490247379, 466.5634038054318, 413.2381232144185, 384.48620738570895, 425.704699666629, 435.4138235235191, 204.4172228550063, 430.85176464385984, 433.4536534995542, 421.9376917299367, 438.58698326793916, 411.75403696145065, 427.77232423244214], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [15.871187390853176, 6.025530336912843, 48.395578741263215, 42.66686014120858, 13.331265040806922, 96.15723918834435, 20.30184012727652, 60.18170367950736, 1.1528459928973158, 96.76227072211952, 50.87705473703639, 51.82261207238731, 14.784601618761563, 54.8777907381774, -1356.1571590845754, 128.53956479087665, 101.49052501735467, -16.513071047722626, 39.18946187920494, -346.9417557098125, 50.02132046877276, 85.34807923740085, 75.27791718330111, -189.58489159976938, 69.85740419078105, 21.04708120238985, 44.805108424349335, 45.92390188276502, 47.37158278655512, -33.34635194774329, 66.21870820786043, 15.713248626168221, 42.311213297997526, 66.30397406992644, 10.306160198590602, 64.2526151674423, 89.81488622246702, 76.28452024258794, 8.833884329313383, 16.20142470427114, 95.84507059514985, 65.67944948226614, 102.43166286132188, 29.65802763708835, 20.711556509846293, 55.841640015544655, 73.07484603826455, 10.382964178700893, 96.51980317212806, 90.32106167459371, 67.41133066881008, 45.60614268509254, 72.88703870472418, 23.3927338764404, 104.12573896400302, 71.19050595988233, -30.98812514116033, 113.59245929208305, 38.893718576618475, 15.684594795345289, 56.18690193903308, 15.365680152583204, 38.11699418720019, 69.46826800292975, 72.34829657863195, 65.33160365364232, 69.44081854080919, -100.97565592673259, 58.636935280337084, 32.662457617108835, 16.208842083858105, 55.27698813568787, 69.65719374035294, 41.06698161854967, 56.13465094683269, -2.9928607235146307, 83.42488849591554, 17.669197626827835, 108.11558437737618, 97.43097240787046, 43.76249648737275, 55.621219686456904, 72.88777786853831, 164.63069496373652, 65.17505990234308, 108.64883067806251, 155.6691623710547, 99.14824187054602, 128.6730001090316, 43.00932745714673, 105.93734161650694, 88.5893210799124, 6.246666568748056, 92.00099843103509, 116.76936041231687, 58.69625619197671, 101.85533171511803, 111.21199027609062, 38.74736546732675, 6.188904114261006, 92.77978049373482, 90.00381884837597, 54.59354649406313, 73.13311702491659, 84.28715857612453, 151.65156758606298, 5.2064736168728185, 77.3049669626914, 66.16610541834483, 86.26903836130867, -13.621081453323297, 59.310951045828105, 16.02794019463931, 113.31321991959626, 86.56319975867349, -1.015163911678197, 55.316557011828905, 146.68376764535046, 42.57761141164784, 114.89446502385157, -32.65047019091132, 133.28837873068474, 105.05263272881297, 151.98908019304983, 61.18070430392454, 141.5916534748793, 126.5345324371849, 102.89175352985077, 131.25334113573075, 172.56982922391205, 34.87051104638959, 151.12569694657918, 105.8494688168371, 44.323407643609585, 79.19905765310361, 97.5963495010568, 121.25747009027208, 104.1051848230211, 154.90818136073122, 87.45182220031428, 95.2459489215869, 150.3691720192741, 117.29162339150608, 158.188176675651, 75.91693574620962, 113.7084576701812, 56.796547758720585, 127.84634217496378, 121.70288482018091, 71.21231876507662, 143.61371381686433, 83.65645806219908, 105.20480343071377, 111.14754077463495, 78.83496850843702, 159.60596433956502, 100.92067817670478, 110.20552384912013, 116.94271043624053, 67.27159471502418, 151.91900221720155, -26.293451072665203, 153.9145613485548, 96.43517589095588, 163.07117198775046, 94.5782320018699, 169.61530947292735, 88.7429820139811, 158.4722737991726, 92.37227148602976, 161.00608168997923, 108.79980581636256, 109.88441339799385, 133.65782646489123, 112.4130130328681, 147.21494859289336, 76.17022321729024, 153.1530168157226, 104.80945417130484, 135.25937643754736, 127.3886469179018, 118.78070852771613, 96.72163459110513, 147.00892778252575, 150.6491100991944, 109.05426230680388, 83.71457046937117, 36.07103085818146, 137.70750720478944, 113.43765919128782, 169.92753650928282, 88.84522475374197, 154.53773057861392, 69.14270736708659, 12.470116306940563, 143.98825713567263, 140.30784425591597, 135.12917680882, 102.75724850979056, 134.22736298995434], "policy_predator_policy_reward": [184.93461600286594, 217.341086059191, 174.39807437638711, 129.41347805657304, 128.1895518985707, 163.9005359469049, 172.17649471803344, 192.82275932967883, 160.4616407496154, 191.8824293075971, 150.24110555074182, 169.83533885955615, 183.2374213248628, 146.41837917253994, 860.2536179132615, 1068.6972222731924, 184.5200606551768, 198.0325325624532, 341.83724870998003, 431.4265573772415, 143.94788189944543, 160.10889630340574, 257.4282766455893, 315.35026336284005, 181.26645999772563, 176.19160131283445, 137.55501781420787, 169.14629551173797, 188.72050225966683, 233.76003195904428, 149.59531129643054, 131.3168981004901, 113.26975941096666, 155.7321929700299, 171.40253269404073, 142.2312587984821, 130.72143745627702, 129.7537174843885, 184.38246693615827, 224.89112005432048, 118.39305196102372, 125.07379118895841, 157.39355661568774, 140.7439875653713, 130.27802048044634, 161.96520242355814, 129.5589336248497, 194.30633739589283, 121.37385984877629, 100.96711981763646, 124.20737586157824, 155.10044505350487, 155.06955821475955, 160.8464346535771, 117.32045753447086, 132.9851893195624, 204.75878161964854, 216.91092831905442, 180.9696567314558, 206.06789084297966, 140.02161933103164, 164.05684455186872, 156.78102997770077, 148.53681948673722, 150.2642251098428, 129.15394856652975, 276.6339279132258, 154.23979679831194, 172.88139753707304, 149.09236458753008, 168.38226372712822, 160.15375732321726, 166.33676677721883, 183.53922744540665, 197.38069822233265, 171.22120548826842, 162.97787373316913, 118.11738092884951, 108.86289156037944, 114.77980487403367, 163.8214883927303, 175.37873470562818, 109.43001170735843, 105.67029737520174, 114.7467343515853, 125.81515747697014, 89.7418000818581, 76.64586239673818, 140.46450811494455, 129.85202087423795, 107.8695307815997, 111.10356142635274, 183.88948715780958, 185.11591787432468, 114.08779001694187, 124.78217776508035, 105.15138348221325, 110.61063792289045, 155.0368587826707, 199.95267447987328, 117.5185157889176, 109.43100555290816, 139.90297522335402, 130.96068012689983, 98.41132973975317, 115.34752502035525, 91.20746131560594, 196.9864825265533, 131.9492177653903, 136.28191439833665, 206.27978387848154, 114.92857050662928, 162.58735992338913, 154.54156693884553, 177.90546473344588, 200.54733174393843, 129.99945194605587, 122.19721063330658, 150.81205175146206, 150.70595786008388, 199.92057980905577, 183.79656913571517, 83.62731257774276, 83.58847927381885, 106.31030359896144, 123.88580196234014, 91.38724254758014, 117.77094902636664, 65.54980989353811, 68.08711483072983, 135.25666377107538, 142.25689692495408, 125.05395566330331, 140.12676567484465, 127.82925585722707, 114.98187705857796, 89.61986454574752, 91.4029461753202, 92.45361349423787, 93.22703790458978, 65.5803330295365, 82.48123715996819, 76.43887068260526, 73.63278613036819, 121.96976880836836, 110.65945246073751, 113.348123967112, 121.31993705085787, 133.86617074160765, 139.7191769468238, 109.9537321374422, 119.51262454166861, 109.96754081474906, 86.95358518981034, 79.88126027146262, 109.83526747564791, 95.19893524063315, 95.52736726719029, 129.4746454516905, 118.97295602358285, 220.44772898835777, 92.01024911598257, 94.8407197649571, 82.85925803878318, 83.8369189890114, 80.9864140930976, 90.48577524358235, 96.54451417134501, 88.95999673618104, 99.3566648335569, 90.18049908713552, 83.64286239777255, 82.37928915272408, 91.75884049813, 63.31933760332849, 87.48514979564814, 123.79090827440632, 113.44925549801344, 89.3582311070342, 83.81106149853271, 78.29905157706446, 60.01780036302673, 108.32547933139028, 73.64865796160882, 85.9219882892555, 89.78846282826514, 39.85244027623785, 44.7791812512157, 90.14656036822359, 89.56003787955994, 99.74190017540924, 74.93899206112026, 97.35060610197309, 100.9066476822625, 102.41822689360407, 179.7103829317216, 67.71252389305836, 68.60449200365638, 91.17568592449275, 99.61202680820413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6227490616485362, "mean_inference_ms": 1.9522980845581344, "mean_action_processing_ms": 0.2594727559349611, "mean_env_wait_ms": 0.23724001570191183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005819201469421387, "StateBufferConnector_ms": 0.0045871734619140625, "ViewRequirementAgentConnector_ms": 0.10793781280517578}, "num_episodes": 18, "episode_return_max": 701.3332458927531, "episode_return_min": 204.4172228550063, "episode_return_mean": 425.3327160076845, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 378.7912931549702, "num_env_steps_trained_throughput_per_sec": 378.7912931549702, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 11541.055, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11541.012, "sample_time_ms": 1544.687, "learn_time_ms": 9979.912, "learn_throughput": 400.805, "synch_weights_time_ms": 14.891}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "e552a_00000", "date": "2024-08-16_08-59-29", "timestamp": 1723778969, "time_this_iter_s": 10.593135833740234, "time_total_s": 778.4127316474915, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2291d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 778.4127316474915, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 30.846666666666668, "ram_util_percent": 83.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.856631857440585, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.919272114233996, "policy_loss": -0.0033005833867247457, "vf_loss": 7.921713324703236, "vf_explained_var": -0.019855543419166847, "kl": 0.005092655727739543, "entropy": 0.719554469162825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.025606177345155, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.225834682504967, "policy_loss": -0.004201301541573629, "vf_loss": 7.229165424619402, "vf_explained_var": 0.09660095036345184, "kl": 0.011607379818664987, "entropy": 1.153744555402685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 504.27404408962684, "episode_reward_min": 204.4172228550063, "episode_reward_mean": 423.1705855167137, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -100.97565592673259, "predator_policy": 35.936243274833124}, "policy_reward_max": {"prey_policy": 184.5697736943801, "predator_policy": 276.6339279132258}, "policy_reward_mean": {"prey_policy": 91.84834986017171, "predator_policy": 119.73694289818512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.5745614057203, 434.3088960240631, 404.99136322739815, 430.2272346794701, 368.79641942939514, 407.3230812377075, 409.18184451313437, 392.3252942689855, 412.19576544950104, 425.6218917779189, 504.27404408962684, 441.61586094639955, 375.6310459745167, 412.903111654568, 417.0980739086461, 399.33888732561445, 413.2731550220488, 400.02185126989156, 460.6001695815279, 421.7436939339185, 382.1893407847631, 429.18925321966015, 438.5839392721879, 452.61878191483515, 414.3857824089609, 421.2050667201967, 441.99885655536184, 413.49975490437146, 467.25307003191693, 414.33558438631593, 428.82934339631225, 399.9258028441314, 409.7331206839355, 398.59031886923333, 449.69758092229534, 370.70538442172364, 420.6662759433811, 366.89822397761503, 446.4700869764702, 464.0008323243798, 454.1969872365416, 458.99008604704505, 484.35505748454426, 424.2575047734241, 432.9684633401057, 438.58447754098313, 437.46009508391154, 463.5097686889988, 415.3535977985944, 419.6065400699657, 406.3854656343621, 428.04065495987254, 393.6766911303649, 425.5514568801304, 422.25461468549634, 419.31095095165443, 466.5005512736898, 456.73652855817403, 413.27347020990896, 428.1574605951127, 401.85250453364824, 432.66190662653867, 438.08352924887606, 428.0497150432514, 422.4727370717299, 445.3885809018352, 439.16120685494036, 443.62924899125017, 417.6803695137398, 410.4324490247379, 466.5634038054318, 413.2381232144185, 384.48620738570895, 425.704699666629, 435.4138235235191, 204.4172228550063, 430.85176464385984, 433.4536534995542, 421.9376917299367, 438.58698326793916, 411.75403696145065, 427.77232423244214, 427.66953506823756, 466.75686711839944, 408.2083449913834, 392.7160411476196, 392.5731744024002, 330.6076909721726, 423.4754698692943, 439.52510491329446, 429.3504764228669, 452.753828891305, 430.69916863623564, 433.73197413249676, 390.64071513268084, 436.2117165179347, 478.9222429552906, 450.50551903778126, 432.7362328440427, 448.38919680050327], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [89.81488622246702, 76.28452024258794, 8.833884329313383, 16.20142470427114, 95.84507059514985, 65.67944948226614, 102.43166286132188, 29.65802763708835, 20.711556509846293, 55.841640015544655, 73.07484603826455, 10.382964178700893, 96.51980317212806, 90.32106167459371, 67.41133066881008, 45.60614268509254, 72.88703870472418, 23.3927338764404, 104.12573896400302, 71.19050595988233, -30.98812514116033, 113.59245929208305, 38.893718576618475, 15.684594795345289, 56.18690193903308, 15.365680152583204, 38.11699418720019, 69.46826800292975, 72.34829657863195, 65.33160365364232, 69.44081854080919, -100.97565592673259, 58.636935280337084, 32.662457617108835, 16.208842083858105, 55.27698813568787, 69.65719374035294, 41.06698161854967, 56.13465094683269, -2.9928607235146307, 83.42488849591554, 17.669197626827835, 108.11558437737618, 97.43097240787046, 43.76249648737275, 55.621219686456904, 72.88777786853831, 164.63069496373652, 65.17505990234308, 108.64883067806251, 155.6691623710547, 99.14824187054602, 128.6730001090316, 43.00932745714673, 105.93734161650694, 88.5893210799124, 6.246666568748056, 92.00099843103509, 116.76936041231687, 58.69625619197671, 101.85533171511803, 111.21199027609062, 38.74736546732675, 6.188904114261006, 92.77978049373482, 90.00381884837597, 54.59354649406313, 73.13311702491659, 84.28715857612453, 151.65156758606298, 5.2064736168728185, 77.3049669626914, 66.16610541834483, 86.26903836130867, -13.621081453323297, 59.310951045828105, 16.02794019463931, 113.31321991959626, 86.56319975867349, -1.015163911678197, 55.316557011828905, 146.68376764535046, 42.57761141164784, 114.89446502385157, -32.65047019091132, 133.28837873068474, 105.05263272881297, 151.98908019304983, 61.18070430392454, 141.5916534748793, 126.5345324371849, 102.89175352985077, 131.25334113573075, 172.56982922391205, 34.87051104638959, 151.12569694657918, 105.8494688168371, 44.323407643609585, 79.19905765310361, 97.5963495010568, 121.25747009027208, 104.1051848230211, 154.90818136073122, 87.45182220031428, 95.2459489215869, 150.3691720192741, 117.29162339150608, 158.188176675651, 75.91693574620962, 113.7084576701812, 56.796547758720585, 127.84634217496378, 121.70288482018091, 71.21231876507662, 143.61371381686433, 83.65645806219908, 105.20480343071377, 111.14754077463495, 78.83496850843702, 159.60596433956502, 100.92067817670478, 110.20552384912013, 116.94271043624053, 67.27159471502418, 151.91900221720155, -26.293451072665203, 153.9145613485548, 96.43517589095588, 163.07117198775046, 94.5782320018699, 169.61530947292735, 88.7429820139811, 158.4722737991726, 92.37227148602976, 161.00608168997923, 108.79980581636256, 109.88441339799385, 133.65782646489123, 112.4130130328681, 147.21494859289336, 76.17022321729024, 153.1530168157226, 104.80945417130484, 135.25937643754736, 127.3886469179018, 118.78070852771613, 96.72163459110513, 147.00892778252575, 150.6491100991944, 109.05426230680388, 83.71457046937117, 36.07103085818146, 137.70750720478944, 113.43765919128782, 169.92753650928282, 88.84522475374197, 154.53773057861392, 69.14270736708659, 12.470116306940563, 143.98825713567263, 140.30784425591597, 135.12917680882, 102.75724850979056, 134.22736298995434, 131.5771519771377, 120.65030701741483, -53.918572387229176, 151.20285626947148, 140.27309444452885, 117.57255904828168, 143.36862376621826, 124.12366729829296, 151.56917931278412, 35.24631411351547, 131.74317203322275, 57.818490651345456, 71.6857055620971, 137.9775148720288, 184.5697736943801, 82.47654450570275, 167.08766162934634, 127.58043037750782, 163.06329612141002, 62.48486119241295, 177.6960644092102, 85.61927445948473, 109.65331885204787, 156.57936571419506, 162.81574134541043, 138.61506411183393, 143.21722377642288, 40.12744782584197, 170.70681572088924, -30.996916887492183, 148.19622281440715, 113.68029173728097, 122.28071521735978, 143.17925883927919, 63.660696611057254, 142.46479226085214], "policy_predator_policy_reward": [130.72143745627702, 129.7537174843885, 184.38246693615827, 224.89112005432048, 118.39305196102372, 125.07379118895841, 157.39355661568774, 140.7439875653713, 130.27802048044634, 161.96520242355814, 129.5589336248497, 194.30633739589283, 121.37385984877629, 100.96711981763646, 124.20737586157824, 155.10044505350487, 155.06955821475955, 160.8464346535771, 117.32045753447086, 132.9851893195624, 204.75878161964854, 216.91092831905442, 180.9696567314558, 206.06789084297966, 140.02161933103164, 164.05684455186872, 156.78102997770077, 148.53681948673722, 150.2642251098428, 129.15394856652975, 276.6339279132258, 154.23979679831194, 172.88139753707304, 149.09236458753008, 168.38226372712822, 160.15375732321726, 166.33676677721883, 183.53922744540665, 197.38069822233265, 171.22120548826842, 162.97787373316913, 118.11738092884951, 108.86289156037944, 114.77980487403367, 163.8214883927303, 175.37873470562818, 109.43001170735843, 105.67029737520174, 114.7467343515853, 125.81515747697014, 89.7418000818581, 76.64586239673818, 140.46450811494455, 129.85202087423795, 107.8695307815997, 111.10356142635274, 183.88948715780958, 185.11591787432468, 114.08779001694187, 124.78217776508035, 105.15138348221325, 110.61063792289045, 155.0368587826707, 199.95267447987328, 117.5185157889176, 109.43100555290816, 139.90297522335402, 130.96068012689983, 98.41132973975317, 115.34752502035525, 91.20746131560594, 196.9864825265533, 131.9492177653903, 136.28191439833665, 206.27978387848154, 114.92857050662928, 162.58735992338913, 154.54156693884553, 177.90546473344588, 200.54733174393843, 129.99945194605587, 122.19721063330658, 150.81205175146206, 150.70595786008388, 199.92057980905577, 183.79656913571517, 83.62731257774276, 83.58847927381885, 106.31030359896144, 123.88580196234014, 91.38724254758014, 117.77094902636664, 65.54980989353811, 68.08711483072983, 135.25666377107538, 142.25689692495408, 125.05395566330331, 140.12676567484465, 127.82925585722707, 114.98187705857796, 89.61986454574752, 91.4029461753202, 92.45361349423787, 93.22703790458978, 65.5803330295365, 82.48123715996819, 76.43887068260526, 73.63278613036819, 121.96976880836836, 110.65945246073751, 113.348123967112, 121.31993705085787, 133.86617074160765, 139.7191769468238, 109.9537321374422, 119.51262454166861, 109.96754081474906, 86.95358518981034, 79.88126027146262, 109.83526747564791, 95.19893524063315, 95.52736726719029, 129.4746454516905, 118.97295602358285, 220.44772898835777, 92.01024911598257, 94.8407197649571, 82.85925803878318, 83.8369189890114, 80.9864140930976, 90.48577524358235, 96.54451417134501, 88.95999673618104, 99.3566648335569, 90.18049908713552, 83.64286239777255, 82.37928915272408, 91.75884049813, 63.31933760332849, 87.48514979564814, 123.79090827440632, 113.44925549801344, 89.3582311070342, 83.81106149853271, 78.29905157706446, 60.01780036302673, 108.32547933139028, 73.64865796160882, 85.9219882892555, 89.78846282826514, 39.85244027623785, 44.7791812512157, 90.14656036822359, 89.56003787955994, 99.74190017540924, 74.93899206112026, 97.35060610197309, 100.9066476822625, 102.41822689360407, 179.7103829317216, 67.71252389305836, 68.60449200365638, 91.17568592449275, 99.61202680820413, 81.19196025720767, 94.2501158164779, 205.00530314397784, 164.4672800921795, 76.67100656792785, 73.69168493064515, 72.56100598480062, 52.662744098307996, 110.59090258710654, 95.16677838899396, 68.61984757833224, 72.42618070927165, 106.77929745401701, 107.03295198115242, 95.13460809394623, 77.34417861926585, 68.80036771397421, 65.88201670203854, 96.45836564883622, 130.7473059286458, 75.26200068306281, 92.12182908447723, 87.21074112878189, 80.28854843747163, 35.936243274833124, 53.27366640060312, 104.90811903113125, 147.9589258845393, 141.42196002823442, 197.79038409366004, 98.5692068782317, 90.05979760786107, 88.73642697867862, 78.53983180872507, 123.64509538896593, 118.61861253962799]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6229072946803779, "mean_inference_ms": 1.954537667152592, "mean_action_processing_ms": 0.2594766181716494, "mean_env_wait_ms": 0.23761427004474464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005798459053039551, "StateBufferConnector_ms": 0.0037573575973510742, "ViewRequirementAgentConnector_ms": 0.09574615955352783}, "num_episodes": 18, "episode_return_max": 504.27404408962684, "episode_return_min": 204.4172228550063, "episode_return_mean": 423.1705855167137, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.6043922250174, "num_env_steps_trained_throughput_per_sec": 385.6043922250174, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 11485.221, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11485.179, "sample_time_ms": 1555.165, "learn_time_ms": 9913.759, "learn_throughput": 403.48, "synch_weights_time_ms": 14.784}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "e552a_00000", "date": "2024-08-16_08-59-39", "timestamp": 1723778979, "time_this_iter_s": 10.378225088119507, "time_total_s": 788.790956735611, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2251dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 788.790956735611, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 31.40666666666667, "ram_util_percent": 82.04666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3395100580952155, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.94052015662824, "policy_loss": -0.0028529905151112606, "vf_loss": 7.942191410064697, "vf_explained_var": 0.02062970440854471, "kl": 0.007002865860923536, "entropy": 0.7583222560150914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.479838372601403, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.286874458020327, "policy_loss": -0.010333847461721647, "vf_loss": 6.296157752647602, "vf_explained_var": 0.2696602562432567, "kl": 0.01400716099719902, "entropy": 1.1551934497066276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 484.35505748454426, "episode_reward_min": 204.4172228550063, "episode_reward_mean": 423.6047494688057, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.08859701974826, "predator_policy": 23.647604839811798}, "policy_reward_max": {"prey_policy": 184.5697736943801, "predator_policy": 220.44772898835777}, "policy_reward_mean": {"prey_policy": 110.11445450109426, "predator_policy": 101.68792023330862}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.5839392721879, 452.61878191483515, 414.3857824089609, 421.2050667201967, 441.99885655536184, 413.49975490437146, 467.25307003191693, 414.33558438631593, 428.82934339631225, 399.9258028441314, 409.7331206839355, 398.59031886923333, 449.69758092229534, 370.70538442172364, 420.6662759433811, 366.89822397761503, 446.4700869764702, 464.0008323243798, 454.1969872365416, 458.99008604704505, 484.35505748454426, 424.2575047734241, 432.9684633401057, 438.58447754098313, 437.46009508391154, 463.5097686889988, 415.3535977985944, 419.6065400699657, 406.3854656343621, 428.04065495987254, 393.6766911303649, 425.5514568801304, 422.25461468549634, 419.31095095165443, 466.5005512736898, 456.73652855817403, 413.27347020990896, 428.1574605951127, 401.85250453364824, 432.66190662653867, 438.08352924887606, 428.0497150432514, 422.4727370717299, 445.3885809018352, 439.16120685494036, 443.62924899125017, 417.6803695137398, 410.4324490247379, 466.5634038054318, 413.2381232144185, 384.48620738570895, 425.704699666629, 435.4138235235191, 204.4172228550063, 430.85176464385984, 433.4536534995542, 421.9376917299367, 438.58698326793916, 411.75403696145065, 427.77232423244214, 427.66953506823756, 466.75686711839944, 408.2083449913834, 392.7160411476196, 392.5731744024002, 330.6076909721726, 423.4754698692943, 439.52510491329446, 429.3504764228669, 452.753828891305, 430.69916863623564, 433.73197413249676, 390.64071513268084, 436.2117165179347, 478.9222429552906, 450.50551903778126, 432.7362328440427, 448.38919680050327, 413.24268227260023, 399.61312960065453, 395.9413871983405, 443.8920611093563, 448.27663664342975, 387.0262760710815, 423.0714378627417, 396.6271668659987, 424.4423957002376, 391.2410813795755, 406.11362726991393, 433.60255808625834, 445.49539225009954, 426.3763479853168, 427.24892120787507, 413.4474408026602, 423.98562775810933, 414.0755305741185, 443.57157949384674, 416.9671223251621, 403.46433789639894, 435.11849457991184], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [43.76249648737275, 55.621219686456904, 72.88777786853831, 164.63069496373652, 65.17505990234308, 108.64883067806251, 155.6691623710547, 99.14824187054602, 128.6730001090316, 43.00932745714673, 105.93734161650694, 88.5893210799124, 6.246666568748056, 92.00099843103509, 116.76936041231687, 58.69625619197671, 101.85533171511803, 111.21199027609062, 38.74736546732675, 6.188904114261006, 92.77978049373482, 90.00381884837597, 54.59354649406313, 73.13311702491659, 84.28715857612453, 151.65156758606298, 5.2064736168728185, 77.3049669626914, 66.16610541834483, 86.26903836130867, -13.621081453323297, 59.310951045828105, 16.02794019463931, 113.31321991959626, 86.56319975867349, -1.015163911678197, 55.316557011828905, 146.68376764535046, 42.57761141164784, 114.89446502385157, -32.65047019091132, 133.28837873068474, 105.05263272881297, 151.98908019304983, 61.18070430392454, 141.5916534748793, 126.5345324371849, 102.89175352985077, 131.25334113573075, 172.56982922391205, 34.87051104638959, 151.12569694657918, 105.8494688168371, 44.323407643609585, 79.19905765310361, 97.5963495010568, 121.25747009027208, 104.1051848230211, 154.90818136073122, 87.45182220031428, 95.2459489215869, 150.3691720192741, 117.29162339150608, 158.188176675651, 75.91693574620962, 113.7084576701812, 56.796547758720585, 127.84634217496378, 121.70288482018091, 71.21231876507662, 143.61371381686433, 83.65645806219908, 105.20480343071377, 111.14754077463495, 78.83496850843702, 159.60596433956502, 100.92067817670478, 110.20552384912013, 116.94271043624053, 67.27159471502418, 151.91900221720155, -26.293451072665203, 153.9145613485548, 96.43517589095588, 163.07117198775046, 94.5782320018699, 169.61530947292735, 88.7429820139811, 158.4722737991726, 92.37227148602976, 161.00608168997923, 108.79980581636256, 109.88441339799385, 133.65782646489123, 112.4130130328681, 147.21494859289336, 76.17022321729024, 153.1530168157226, 104.80945417130484, 135.25937643754736, 127.3886469179018, 118.78070852771613, 96.72163459110513, 147.00892778252575, 150.6491100991944, 109.05426230680388, 83.71457046937117, 36.07103085818146, 137.70750720478944, 113.43765919128782, 169.92753650928282, 88.84522475374197, 154.53773057861392, 69.14270736708659, 12.470116306940563, 143.98825713567263, 140.30784425591597, 135.12917680882, 102.75724850979056, 134.22736298995434, 131.5771519771377, 120.65030701741483, -53.918572387229176, 151.20285626947148, 140.27309444452885, 117.57255904828168, 143.36862376621826, 124.12366729829296, 151.56917931278412, 35.24631411351547, 131.74317203322275, 57.818490651345456, 71.6857055620971, 137.9775148720288, 184.5697736943801, 82.47654450570275, 167.08766162934634, 127.58043037750782, 163.06329612141002, 62.48486119241295, 177.6960644092102, 85.61927445948473, 109.65331885204787, 156.57936571419506, 162.81574134541043, 138.61506411183393, 143.21722377642288, 40.12744782584197, 170.70681572088924, -30.996916887492183, 148.19622281440715, 113.68029173728097, 122.28071521735978, 143.17925883927919, 63.660696611057254, 142.46479226085214, 155.8309300899995, 95.37270119123694, 170.1627623853567, 151.15357264585353, 134.6748648388199, 169.28719487717058, -89.08859701974826, 170.18192271678714, 140.12542145280767, 138.11534839222142, 137.19015989452632, 117.11199978480855, 153.7237868571197, 90.09122296213957, 175.16715146323187, 165.2231886206608, 101.91961477891276, 97.5970935764301, 158.59189967571297, 170.41021020638163, 178.38276157128888, 172.99861984143257, 168.7526234260366, 70.99693133469337, 77.27485614719485, 152.32101545465065, 178.38275289548858, 128.6579941643105, 163.46294893188366, 119.38211250209407, 165.67912981952665, 102.6698960269569, 96.08873731080594, 164.6164784976641, 161.14519739711065, 139.75992768749614, 163.8627635067782, 108.1385293378143, 177.1299138981656, 97.52566101860079, 102.16042828548845, 176.82857688569743, 176.39348009189976, 79.73881754168671], "policy_predator_policy_reward": [163.8214883927303, 175.37873470562818, 109.43001170735843, 105.67029737520174, 114.7467343515853, 125.81515747697014, 89.7418000818581, 76.64586239673818, 140.46450811494455, 129.85202087423795, 107.8695307815997, 111.10356142635274, 183.88948715780958, 185.11591787432468, 114.08779001694187, 124.78217776508035, 105.15138348221325, 110.61063792289045, 155.0368587826707, 199.95267447987328, 117.5185157889176, 109.43100555290816, 139.90297522335402, 130.96068012689983, 98.41132973975317, 115.34752502035525, 91.20746131560594, 196.9864825265533, 131.9492177653903, 136.28191439833665, 206.27978387848154, 114.92857050662928, 162.58735992338913, 154.54156693884553, 177.90546473344588, 200.54733174393843, 129.99945194605587, 122.19721063330658, 150.81205175146206, 150.70595786008388, 199.92057980905577, 183.79656913571517, 83.62731257774276, 83.58847927381885, 106.31030359896144, 123.88580196234014, 91.38724254758014, 117.77094902636664, 65.54980989353811, 68.08711483072983, 135.25666377107538, 142.25689692495408, 125.05395566330331, 140.12676567484465, 127.82925585722707, 114.98187705857796, 89.61986454574752, 91.4029461753202, 92.45361349423787, 93.22703790458978, 65.5803330295365, 82.48123715996819, 76.43887068260526, 73.63278613036819, 121.96976880836836, 110.65945246073751, 113.348123967112, 121.31993705085787, 133.86617074160765, 139.7191769468238, 109.9537321374422, 119.51262454166861, 109.96754081474906, 86.95358518981034, 79.88126027146262, 109.83526747564791, 95.19893524063315, 95.52736726719029, 129.4746454516905, 118.97295602358285, 220.44772898835777, 92.01024911598257, 94.8407197649571, 82.85925803878318, 83.8369189890114, 80.9864140930976, 90.48577524358235, 96.54451417134501, 88.95999673618104, 99.3566648335569, 90.18049908713552, 83.64286239777255, 82.37928915272408, 91.75884049813, 63.31933760332849, 87.48514979564814, 123.79090827440632, 113.44925549801344, 89.3582311070342, 83.81106149853271, 78.29905157706446, 60.01780036302673, 108.32547933139028, 73.64865796160882, 85.9219882892555, 89.78846282826514, 39.85244027623785, 44.7791812512157, 90.14656036822359, 89.56003787955994, 99.74190017540924, 74.93899206112026, 97.35060610197309, 100.9066476822625, 102.41822689360407, 179.7103829317216, 67.71252389305836, 68.60449200365638, 91.17568592449275, 99.61202680820413, 81.19196025720767, 94.2501158164779, 205.00530314397784, 164.4672800921795, 76.67100656792785, 73.69168493064515, 72.56100598480062, 52.662744098307996, 110.59090258710654, 95.16677838899396, 68.61984757833224, 72.42618070927165, 106.77929745401701, 107.03295198115242, 95.13460809394623, 77.34417861926585, 68.80036771397421, 65.88201670203854, 96.45836564883622, 130.7473059286458, 75.26200068306281, 92.12182908447723, 87.21074112878189, 80.28854843747163, 35.936243274833124, 53.27366640060312, 104.90811903113125, 147.9589258845393, 141.42196002823442, 197.79038409366004, 98.5692068782317, 90.05979760786107, 88.73642697867862, 78.53983180872507, 123.64509538896593, 118.61861253962799, 73.25384300431553, 88.78520798704761, 39.53300903115731, 38.763785538287, 42.30384583523988, 49.67548164711, 145.1028644229766, 217.69587098934048, 85.92480440529881, 84.11106239310249, 66.50037202164577, 66.22374437010126, 85.89742714512552, 93.35900089835677, 27.743481554070737, 28.49334522803505, 89.07419623811006, 135.85149110678427, 30.537148362384446, 31.7018231350963, 31.084641017380903, 23.647604839811798, 106.66502200251585, 87.18798132301295, 107.47685954303265, 108.42266110522147, 58.51795559922984, 60.817645326288265, 69.87676926141569, 74.5270905124814, 80.36753978557425, 64.73087517060229, 78.24689708570166, 85.03351486393677, 48.776044246530915, 64.39436124298095, 82.33931016989959, 89.23097647935455, 66.74118265722042, 75.57036475117484, 62.04378951243209, 62.43154321278018, 89.26707617736938, 89.71912076895563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6221974617871064, "mean_inference_ms": 1.9527805428145957, "mean_action_processing_ms": 0.2590898136325509, "mean_env_wait_ms": 0.23737610441515133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006354212760925293, "StateBufferConnector_ms": 0.0037840604782104492, "ViewRequirementAgentConnector_ms": 0.09461116790771484}, "num_episodes": 22, "episode_return_max": 484.35505748454426, "episode_return_min": 204.4172228550063, "episode_return_mean": 423.6047494688057, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 385.22889286499236, "num_env_steps_trained_throughput_per_sec": 385.22889286499236, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 11442.037, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11441.996, "sample_time_ms": 1533.316, "learn_time_ms": 9892.562, "learn_throughput": 404.344, "synch_weights_time_ms": 14.67}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "e552a_00000", "date": "2024-08-16_08-59-50", "timestamp": 1723778990, "time_this_iter_s": 10.41999101638794, "time_total_s": 799.2109477519989, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72dee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 799.2109477519989, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 29.67333333333333, "ram_util_percent": 82.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.958340841184848, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.364451756553045, "policy_loss": -0.0007502529846514186, "vf_loss": 8.36343352075607, "vf_explained_var": -0.0051587177962853165, "kl": 0.010479947434355406, "entropy": 0.746992750174154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.476644776107142, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.052810282177395, "policy_loss": -0.008653779974621204, "vf_loss": 5.060535091193265, "vf_explained_var": 0.6483526747062723, "kl": 0.012386424275471307, "entropy": 1.1734187638318097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 478.9222429552906, "episode_reward_min": 204.4172228550063, "episode_reward_mean": 413.0987788906592, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.08859701974826, "predator_policy": 15.659930017509518}, "policy_reward_max": {"prey_policy": 186.67147810422034, "predator_policy": 220.44772898835777}, "policy_reward_mean": {"prey_policy": 124.88965992673104, "predator_policy": 81.65972951859852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.58447754098313, 437.46009508391154, 463.5097686889988, 415.3535977985944, 419.6065400699657, 406.3854656343621, 428.04065495987254, 393.6766911303649, 425.5514568801304, 422.25461468549634, 419.31095095165443, 466.5005512736898, 456.73652855817403, 413.27347020990896, 428.1574605951127, 401.85250453364824, 432.66190662653867, 438.08352924887606, 428.0497150432514, 422.4727370717299, 445.3885809018352, 439.16120685494036, 443.62924899125017, 417.6803695137398, 410.4324490247379, 466.5634038054318, 413.2381232144185, 384.48620738570895, 425.704699666629, 435.4138235235191, 204.4172228550063, 430.85176464385984, 433.4536534995542, 421.9376917299367, 438.58698326793916, 411.75403696145065, 427.77232423244214, 427.66953506823756, 466.75686711839944, 408.2083449913834, 392.7160411476196, 392.5731744024002, 330.6076909721726, 423.4754698692943, 439.52510491329446, 429.3504764228669, 452.753828891305, 430.69916863623564, 433.73197413249676, 390.64071513268084, 436.2117165179347, 478.9222429552906, 450.50551903778126, 432.7362328440427, 448.38919680050327, 413.24268227260023, 399.61312960065453, 395.9413871983405, 443.8920611093563, 448.27663664342975, 387.0262760710815, 423.0714378627417, 396.6271668659987, 424.4423957002376, 391.2410813795755, 406.11362726991393, 433.60255808625834, 445.49539225009954, 426.3763479853168, 427.24892120787507, 413.4474408026602, 423.98562775810933, 414.0755305741185, 443.57157949384674, 416.9671223251621, 403.46433789639894, 435.11849457991184, 412.9954645807386, 381.5288621514379, 405.4797084606418, 412.00023164376915, 404.606356788651, 207.06388352307113, 376.4584532452461, 395.48604827993546, 427.69563118765075, 396.76863766020216, 402.3066789904024, 426.2913173447991, 443.47826117034873, 263.1014379528766, 398.01437100242555, 379.07999852908534, 438.115462393433, 400.8540345365453, 362.72980191737236, 314.4566661773338, 407.10056601863386, 391.20883936339163, 376.7481347026365], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [126.5345324371849, 102.89175352985077, 131.25334113573075, 172.56982922391205, 34.87051104638959, 151.12569694657918, 105.8494688168371, 44.323407643609585, 79.19905765310361, 97.5963495010568, 121.25747009027208, 104.1051848230211, 154.90818136073122, 87.45182220031428, 95.2459489215869, 150.3691720192741, 117.29162339150608, 158.188176675651, 75.91693574620962, 113.7084576701812, 56.796547758720585, 127.84634217496378, 121.70288482018091, 71.21231876507662, 143.61371381686433, 83.65645806219908, 105.20480343071377, 111.14754077463495, 78.83496850843702, 159.60596433956502, 100.92067817670478, 110.20552384912013, 116.94271043624053, 67.27159471502418, 151.91900221720155, -26.293451072665203, 153.9145613485548, 96.43517589095588, 163.07117198775046, 94.5782320018699, 169.61530947292735, 88.7429820139811, 158.4722737991726, 92.37227148602976, 161.00608168997923, 108.79980581636256, 109.88441339799385, 133.65782646489123, 112.4130130328681, 147.21494859289336, 76.17022321729024, 153.1530168157226, 104.80945417130484, 135.25937643754736, 127.3886469179018, 118.78070852771613, 96.72163459110513, 147.00892778252575, 150.6491100991944, 109.05426230680388, 83.71457046937117, 36.07103085818146, 137.70750720478944, 113.43765919128782, 169.92753650928282, 88.84522475374197, 154.53773057861392, 69.14270736708659, 12.470116306940563, 143.98825713567263, 140.30784425591597, 135.12917680882, 102.75724850979056, 134.22736298995434, 131.5771519771377, 120.65030701741483, -53.918572387229176, 151.20285626947148, 140.27309444452885, 117.57255904828168, 143.36862376621826, 124.12366729829296, 151.56917931278412, 35.24631411351547, 131.74317203322275, 57.818490651345456, 71.6857055620971, 137.9775148720288, 184.5697736943801, 82.47654450570275, 167.08766162934634, 127.58043037750782, 163.06329612141002, 62.48486119241295, 177.6960644092102, 85.61927445948473, 109.65331885204787, 156.57936571419506, 162.81574134541043, 138.61506411183393, 143.21722377642288, 40.12744782584197, 170.70681572088924, -30.996916887492183, 148.19622281440715, 113.68029173728097, 122.28071521735978, 143.17925883927919, 63.660696611057254, 142.46479226085214, 155.8309300899995, 95.37270119123694, 170.1627623853567, 151.15357264585353, 134.6748648388199, 169.28719487717058, -89.08859701974826, 170.18192271678714, 140.12542145280767, 138.11534839222142, 137.19015989452632, 117.11199978480855, 153.7237868571197, 90.09122296213957, 175.16715146323187, 165.2231886206608, 101.91961477891276, 97.5970935764301, 158.59189967571297, 170.41021020638163, 178.38276157128888, 172.99861984143257, 168.7526234260366, 70.99693133469337, 77.27485614719485, 152.32101545465065, 178.38275289548858, 128.6579941643105, 163.46294893188366, 119.38211250209407, 165.67912981952665, 102.6698960269569, 96.08873731080594, 164.6164784976641, 161.14519739711065, 139.75992768749614, 163.8627635067782, 108.1385293378143, 177.1299138981656, 97.52566101860079, 102.16042828548845, 176.82857688569743, 176.39348009189976, 79.73881754168671, 169.2495851256791, 145.05768942292804, 155.72015371838845, 157.0601352886178, 122.45972099969039, 156.58878510100314, 146.79314681237295, 154.62536890179376, 143.92364263522407, 186.67147810422034, 2.0000000000000013, 161.29878604130914, 118.3228686208069, 150.94725879410393, 145.32512377032953, 156.66742232904377, 161.3030230336058, 139.1959326267613, 170.73261916894404, 136.45677020852327, 139.69837316756715, 167.0340604983994, 127.44546699249936, 127.51723927232845, 133.53975071596233, 172.18892277177255, 51.20560228016305, 149.361587532529, 161.0337707246898, 171.17921262204524, 169.9652559689358, 152.91865759801485, 97.38924916652203, 176.69887630726814, 99.34385171371441, 171.6650773925693, 123.92814600668656, 134.84104310291846, 94.01088377918929, 138.78861064785997, 162.7452615702581, 135.3957165948015, 145.98407356703459, 164.91858422026664, 163.67259035659052, 167.54007639035567], "policy_predator_policy_reward": [91.38724254758014, 117.77094902636664, 65.54980989353811, 68.08711483072983, 135.25666377107538, 142.25689692495408, 125.05395566330331, 140.12676567484465, 127.82925585722707, 114.98187705857796, 89.61986454574752, 91.4029461753202, 92.45361349423787, 93.22703790458978, 65.5803330295365, 82.48123715996819, 76.43887068260526, 73.63278613036819, 121.96976880836836, 110.65945246073751, 113.348123967112, 121.31993705085787, 133.86617074160765, 139.7191769468238, 109.9537321374422, 119.51262454166861, 109.96754081474906, 86.95358518981034, 79.88126027146262, 109.83526747564791, 95.19893524063315, 95.52736726719029, 129.4746454516905, 118.97295602358285, 220.44772898835777, 92.01024911598257, 94.8407197649571, 82.85925803878318, 83.8369189890114, 80.9864140930976, 90.48577524358235, 96.54451417134501, 88.95999673618104, 99.3566648335569, 90.18049908713552, 83.64286239777255, 82.37928915272408, 91.75884049813, 63.31933760332849, 87.48514979564814, 123.79090827440632, 113.44925549801344, 89.3582311070342, 83.81106149853271, 78.29905157706446, 60.01780036302673, 108.32547933139028, 73.64865796160882, 85.9219882892555, 89.78846282826514, 39.85244027623785, 44.7791812512157, 90.14656036822359, 89.56003787955994, 99.74190017540924, 74.93899206112026, 97.35060610197309, 100.9066476822625, 102.41822689360407, 179.7103829317216, 67.71252389305836, 68.60449200365638, 91.17568592449275, 99.61202680820413, 81.19196025720767, 94.2501158164779, 205.00530314397784, 164.4672800921795, 76.67100656792785, 73.69168493064515, 72.56100598480062, 52.662744098307996, 110.59090258710654, 95.16677838899396, 68.61984757833224, 72.42618070927165, 106.77929745401701, 107.03295198115242, 95.13460809394623, 77.34417861926585, 68.80036771397421, 65.88201670203854, 96.45836564883622, 130.7473059286458, 75.26200068306281, 92.12182908447723, 87.21074112878189, 80.28854843747163, 35.936243274833124, 53.27366640060312, 104.90811903113125, 147.9589258845393, 141.42196002823442, 197.79038409366004, 98.5692068782317, 90.05979760786107, 88.73642697867862, 78.53983180872507, 123.64509538896593, 118.61861253962799, 73.25384300431553, 88.78520798704761, 39.53300903115731, 38.763785538287, 42.30384583523988, 49.67548164711, 145.1028644229766, 217.69587098934048, 85.92480440529881, 84.11106239310249, 66.50037202164577, 66.22374437010126, 85.89742714512552, 93.35900089835677, 27.743481554070737, 28.49334522803505, 89.07419623811006, 135.85149110678427, 30.537148362384446, 31.7018231350963, 31.084641017380903, 23.647604839811798, 106.66502200251585, 87.18798132301295, 107.47685954303265, 108.42266110522147, 58.51795559922984, 60.817645326288265, 69.87676926141569, 74.5270905124814, 80.36753978557425, 64.73087517060229, 78.24689708570166, 85.03351486393677, 48.776044246530915, 64.39436124298095, 82.33931016989959, 89.23097647935455, 66.74118265722042, 75.57036475117484, 62.04378951243209, 62.43154321278018, 89.26707617736938, 89.71912076895563, 49.583634721567215, 49.10455531056406, 19.124587876783288, 49.623985267648784, 61.14670276863426, 65.28449959131352, 52.548251934384425, 58.03346399521816, 33.94627885273881, 40.06495719646777, 15.659930017509518, 28.105167464252954, 55.21314924962093, 51.97517658071414, 43.454310555786634, 50.03919162477537, 68.46594594066319, 58.73072958662039, 35.000194836782484, 54.579053445952276, 37.23542392329011, 58.338821401145886, 76.37711806240351, 94.95149301756754, 68.20934119166677, 69.540246490947, 30.972875282800203, 31.561372857384175, 30.422802451251595, 35.378585204438835, 33.84083207279048, 22.355252889344317, 80.50301974278044, 83.52431717686241, 92.9127491881887, 36.93235624207296, 57.48291931787919, 46.47769348988829, 34.57898155133545, 47.07819019894899, 43.07527625807835, 65.88431159549579, 46.22765140692195, 34.07853016916843, 18.128659881529686, 27.406808074160626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6218855105441391, "mean_inference_ms": 1.9465278007272995, "mean_action_processing_ms": 0.2585102716839807, "mean_env_wait_ms": 0.2370756314133386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064040422439575195, "StateBufferConnector_ms": 0.0037407875061035156, "ViewRequirementAgentConnector_ms": 0.09249639511108398}, "num_episodes": 23, "episode_return_max": 478.9222429552906, "episode_return_min": 204.4172228550063, "episode_return_mean": 413.0987788906592, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.80205357842607, "num_env_steps_trained_throughput_per_sec": 384.80205357842607, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 11383.824, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11383.783, "sample_time_ms": 1525.053, "learn_time_ms": 9842.546, "learn_throughput": 406.399, "synch_weights_time_ms": 14.746}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-00", "timestamp": 1723779000, "time_this_iter_s": 10.401695013046265, "time_total_s": 809.6126427650452, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b224de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 809.6126427650452, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 31.406666666666663, "ram_util_percent": 82.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.083681572618938, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.434263072442756, "policy_loss": -0.0017242841562995362, "vf_loss": 7.434383729399827, "vf_explained_var": -0.09158833282334464, "kl": 0.009502978452318666, "entropy": 0.7190976724422798, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.7593380632854645, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2576667194013242, "policy_loss": -0.011532202406007816, "vf_loss": 3.2680279818792193, "vf_explained_var": 0.5238146384557089, "kl": 0.015612536474894368, "entropy": 1.1887297089137727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 478.9222429552906, "episode_reward_min": 204.4172228550063, "episode_reward_mean": 405.62850914919795, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.08859701974826, "predator_policy": 15.659930017509518}, "policy_reward_max": {"prey_policy": 186.67147810422034, "predator_policy": 217.69587098934048}, "policy_reward_mean": {"prey_policy": 133.3237190259647, "predator_policy": 69.49053554863426}, "custom_metrics": {}, "hist_stats": {"episode_reward": [428.0497150432514, 422.4727370717299, 445.3885809018352, 439.16120685494036, 443.62924899125017, 417.6803695137398, 410.4324490247379, 466.5634038054318, 413.2381232144185, 384.48620738570895, 425.704699666629, 435.4138235235191, 204.4172228550063, 430.85176464385984, 433.4536534995542, 421.9376917299367, 438.58698326793916, 411.75403696145065, 427.77232423244214, 427.66953506823756, 466.75686711839944, 408.2083449913834, 392.7160411476196, 392.5731744024002, 330.6076909721726, 423.4754698692943, 439.52510491329446, 429.3504764228669, 452.753828891305, 430.69916863623564, 433.73197413249676, 390.64071513268084, 436.2117165179347, 478.9222429552906, 450.50551903778126, 432.7362328440427, 448.38919680050327, 413.24268227260023, 399.61312960065453, 395.9413871983405, 443.8920611093563, 448.27663664342975, 387.0262760710815, 423.0714378627417, 396.6271668659987, 424.4423957002376, 391.2410813795755, 406.11362726991393, 433.60255808625834, 445.49539225009954, 426.3763479853168, 427.24892120787507, 413.4474408026602, 423.98562775810933, 414.0755305741185, 443.57157949384674, 416.9671223251621, 403.46433789639894, 435.11849457991184, 412.9954645807386, 381.5288621514379, 405.4797084606418, 412.00023164376915, 404.606356788651, 207.06388352307113, 376.4584532452461, 395.48604827993546, 427.69563118765075, 396.76863766020216, 402.3066789904024, 426.2913173447991, 443.47826117034873, 263.1014379528766, 398.01437100242555, 379.07999852908534, 438.115462393433, 400.8540345365453, 362.72980191737236, 314.4566661773338, 407.10056601863386, 391.20883936339163, 376.7481347026365, 302.9575850662322, 397.71105363147365, 404.8429078607578, 386.9280480588672, 402.73746286167164, 394.24728792684516, 416.8592270771812, 372.7803907584128, 369.73920207798176, 405.75732209926696, 350.07835484014174, 386.02270903997254, 384.9263055085262, 402.28588449429634, 403.99737350004943, 402.963081380134, 383.55822145058283, 391.58087269176093], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.9145613485548, 96.43517589095588, 163.07117198775046, 94.5782320018699, 169.61530947292735, 88.7429820139811, 158.4722737991726, 92.37227148602976, 161.00608168997923, 108.79980581636256, 109.88441339799385, 133.65782646489123, 112.4130130328681, 147.21494859289336, 76.17022321729024, 153.1530168157226, 104.80945417130484, 135.25937643754736, 127.3886469179018, 118.78070852771613, 96.72163459110513, 147.00892778252575, 150.6491100991944, 109.05426230680388, 83.71457046937117, 36.07103085818146, 137.70750720478944, 113.43765919128782, 169.92753650928282, 88.84522475374197, 154.53773057861392, 69.14270736708659, 12.470116306940563, 143.98825713567263, 140.30784425591597, 135.12917680882, 102.75724850979056, 134.22736298995434, 131.5771519771377, 120.65030701741483, -53.918572387229176, 151.20285626947148, 140.27309444452885, 117.57255904828168, 143.36862376621826, 124.12366729829296, 151.56917931278412, 35.24631411351547, 131.74317203322275, 57.818490651345456, 71.6857055620971, 137.9775148720288, 184.5697736943801, 82.47654450570275, 167.08766162934634, 127.58043037750782, 163.06329612141002, 62.48486119241295, 177.6960644092102, 85.61927445948473, 109.65331885204787, 156.57936571419506, 162.81574134541043, 138.61506411183393, 143.21722377642288, 40.12744782584197, 170.70681572088924, -30.996916887492183, 148.19622281440715, 113.68029173728097, 122.28071521735978, 143.17925883927919, 63.660696611057254, 142.46479226085214, 155.8309300899995, 95.37270119123694, 170.1627623853567, 151.15357264585353, 134.6748648388199, 169.28719487717058, -89.08859701974826, 170.18192271678714, 140.12542145280767, 138.11534839222142, 137.19015989452632, 117.11199978480855, 153.7237868571197, 90.09122296213957, 175.16715146323187, 165.2231886206608, 101.91961477891276, 97.5970935764301, 158.59189967571297, 170.41021020638163, 178.38276157128888, 172.99861984143257, 168.7526234260366, 70.99693133469337, 77.27485614719485, 152.32101545465065, 178.38275289548858, 128.6579941643105, 163.46294893188366, 119.38211250209407, 165.67912981952665, 102.6698960269569, 96.08873731080594, 164.6164784976641, 161.14519739711065, 139.75992768749614, 163.8627635067782, 108.1385293378143, 177.1299138981656, 97.52566101860079, 102.16042828548845, 176.82857688569743, 176.39348009189976, 79.73881754168671, 169.2495851256791, 145.05768942292804, 155.72015371838845, 157.0601352886178, 122.45972099969039, 156.58878510100314, 146.79314681237295, 154.62536890179376, 143.92364263522407, 186.67147810422034, 2.0000000000000013, 161.29878604130914, 118.3228686208069, 150.94725879410393, 145.32512377032953, 156.66742232904377, 161.3030230336058, 139.1959326267613, 170.73261916894404, 136.45677020852327, 139.69837316756715, 167.0340604983994, 127.44546699249936, 127.51723927232845, 133.53975071596233, 172.18892277177255, 51.20560228016305, 149.361587532529, 161.0337707246898, 171.17921262204524, 169.9652559689358, 152.91865759801485, 97.38924916652203, 176.69887630726814, 99.34385171371441, 171.6650773925693, 123.92814600668656, 134.84104310291846, 94.01088377918929, 138.78861064785997, 162.7452615702581, 135.3957165948015, 145.98407356703459, 164.91858422026664, 163.67259035659052, 167.54007639035567, 133.67000921131276, 99.94703537147545, 141.62227271521306, 177.20880692580207, 179.16862780460687, 112.22745829169635, 155.82506053524475, 136.21787207882073, 143.68563787924268, 182.77615526203678, 167.2272795896382, 174.03364804631005, 169.73438627625484, 150.35183419450647, 135.11727547129783, 150.93751916657178, 176.192241740011, 73.70344711708367, 180.05590273218067, 151.2758048508451, 127.9766886235248, 145.3465993251379, 146.54606538963216, 142.6707300122136, 145.86926827793718, 180.1476252828131, 159.02634070885452, 156.078576837823, 176.5394909179953, 159.3669295438774, 158.34170059897735, 169.24690653044678, 158.23247231324515, 160.10673396062165, 150.93804596451594, 164.6438919049456], "policy_predator_policy_reward": [94.8407197649571, 82.85925803878318, 83.8369189890114, 80.9864140930976, 90.48577524358235, 96.54451417134501, 88.95999673618104, 99.3566648335569, 90.18049908713552, 83.64286239777255, 82.37928915272408, 91.75884049813, 63.31933760332849, 87.48514979564814, 123.79090827440632, 113.44925549801344, 89.3582311070342, 83.81106149853271, 78.29905157706446, 60.01780036302673, 108.32547933139028, 73.64865796160882, 85.9219882892555, 89.78846282826514, 39.85244027623785, 44.7791812512157, 90.14656036822359, 89.56003787955994, 99.74190017540924, 74.93899206112026, 97.35060610197309, 100.9066476822625, 102.41822689360407, 179.7103829317216, 67.71252389305836, 68.60449200365638, 91.17568592449275, 99.61202680820413, 81.19196025720767, 94.2501158164779, 205.00530314397784, 164.4672800921795, 76.67100656792785, 73.69168493064515, 72.56100598480062, 52.662744098307996, 110.59090258710654, 95.16677838899396, 68.61984757833224, 72.42618070927165, 106.77929745401701, 107.03295198115242, 95.13460809394623, 77.34417861926585, 68.80036771397421, 65.88201670203854, 96.45836564883622, 130.7473059286458, 75.26200068306281, 92.12182908447723, 87.21074112878189, 80.28854843747163, 35.936243274833124, 53.27366640060312, 104.90811903113125, 147.9589258845393, 141.42196002823442, 197.79038409366004, 98.5692068782317, 90.05979760786107, 88.73642697867862, 78.53983180872507, 123.64509538896593, 118.61861253962799, 73.25384300431553, 88.78520798704761, 39.53300903115731, 38.763785538287, 42.30384583523988, 49.67548164711, 145.1028644229766, 217.69587098934048, 85.92480440529881, 84.11106239310249, 66.50037202164577, 66.22374437010126, 85.89742714512552, 93.35900089835677, 27.743481554070737, 28.49334522803505, 89.07419623811006, 135.85149110678427, 30.537148362384446, 31.7018231350963, 31.084641017380903, 23.647604839811798, 106.66502200251585, 87.18798132301295, 107.47685954303265, 108.42266110522147, 58.51795559922984, 60.817645326288265, 69.87676926141569, 74.5270905124814, 80.36753978557425, 64.73087517060229, 78.24689708570166, 85.03351486393677, 48.776044246530915, 64.39436124298095, 82.33931016989959, 89.23097647935455, 66.74118265722042, 75.57036475117484, 62.04378951243209, 62.43154321278018, 89.26707617736938, 89.71912076895563, 49.583634721567215, 49.10455531056406, 19.124587876783288, 49.623985267648784, 61.14670276863426, 65.28449959131352, 52.548251934384425, 58.03346399521816, 33.94627885273881, 40.06495719646777, 15.659930017509518, 28.105167464252954, 55.21314924962093, 51.97517658071414, 43.454310555786634, 50.03919162477537, 68.46594594066319, 58.73072958662039, 35.000194836782484, 54.579053445952276, 37.23542392329011, 58.338821401145886, 76.37711806240351, 94.95149301756754, 68.20934119166677, 69.540246490947, 30.972875282800203, 31.561372857384175, 30.422802451251595, 35.378585204438835, 33.84083207279048, 22.355252889344317, 80.50301974278044, 83.52431717686241, 92.9127491881887, 36.93235624207296, 57.48291931787919, 46.47769348988829, 34.57898155133545, 47.07819019894899, 43.07527625807835, 65.88431159549579, 46.22765140692195, 34.07853016916843, 18.128659881529686, 27.406808074160626, 39.09937657924722, 30.241163904196796, 34.53368298050065, 44.346291009957945, 60.298125038524425, 53.14869672593032, 66.72535792425477, 28.15975752054675, 51.109508727916364, 25.166160992475824, 21.961435175497755, 31.02492511539899, 42.65968433980247, 54.11332226661707, 42.219209663719724, 44.50638645682372, 41.634458883582916, 78.20905433730445, 32.82435127255063, 41.601263243690724, 34.26866901653604, 42.48639787494308, 45.968700158573064, 50.8372134795537, 29.950882573330375, 28.95852937444572, 30.246460891921238, 56.93450605569751, 30.472039432029618, 37.61891360614714, 32.43630112175771, 42.938173128952194, 28.0128052845012, 37.20620989221441, 34.324398550131384, 41.67453627216818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6207075929307794, "mean_inference_ms": 1.9489986419152665, "mean_action_processing_ms": 0.2583942159484077, "mean_env_wait_ms": 0.23688715308259223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005695462226867676, "StateBufferConnector_ms": 0.0034679174423217773, "ViewRequirementAgentConnector_ms": 0.09119045734405518}, "num_episodes": 18, "episode_return_max": 478.9222429552906, "episode_return_min": 204.4172228550063, "episode_return_mean": 405.62850914919795, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.17086180539843, "num_env_steps_trained_throughput_per_sec": 336.17086180539843, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 11284.888, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11284.838, "sample_time_ms": 1529.443, "learn_time_ms": 9738.439, "learn_throughput": 410.743, "synch_weights_time_ms": 15.354}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-12", "timestamp": 1723779012, "time_this_iter_s": 11.953001022338867, "time_total_s": 821.565643787384, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72dea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 821.565643787384, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 43.78235294117647, "ram_util_percent": 82.99411764705881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.526906455761541, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.847826934491516, "policy_loss": -0.006530796645687173, "vf_loss": 5.851881338048864, "vf_explained_var": -0.2215624971995278, "kl": 0.014674872028310273, "entropy": 0.7392099670947544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.05528107421108, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.235889858165115, "policy_loss": -0.009074968458079393, "vf_loss": 3.2438738385205546, "vf_explained_var": 0.38414576659126887, "kl": 0.014546567135337548, "entropy": 1.2256784861680692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 478.9222429552906, "episode_reward_min": 207.06388352307113, "episode_reward_mean": 401.13683966839983, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.08859701974826, "predator_policy": 13.856784110123515}, "policy_reward_max": {"prey_policy": 186.67147810422034, "predator_policy": 217.69587098934048}, "policy_reward_mean": {"prey_policy": 141.50281976258105, "predator_policy": 59.06560007161888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [427.77232423244214, 427.66953506823756, 466.75686711839944, 408.2083449913834, 392.7160411476196, 392.5731744024002, 330.6076909721726, 423.4754698692943, 439.52510491329446, 429.3504764228669, 452.753828891305, 430.69916863623564, 433.73197413249676, 390.64071513268084, 436.2117165179347, 478.9222429552906, 450.50551903778126, 432.7362328440427, 448.38919680050327, 413.24268227260023, 399.61312960065453, 395.9413871983405, 443.8920611093563, 448.27663664342975, 387.0262760710815, 423.0714378627417, 396.6271668659987, 424.4423957002376, 391.2410813795755, 406.11362726991393, 433.60255808625834, 445.49539225009954, 426.3763479853168, 427.24892120787507, 413.4474408026602, 423.98562775810933, 414.0755305741185, 443.57157949384674, 416.9671223251621, 403.46433789639894, 435.11849457991184, 412.9954645807386, 381.5288621514379, 405.4797084606418, 412.00023164376915, 404.606356788651, 207.06388352307113, 376.4584532452461, 395.48604827993546, 427.69563118765075, 396.76863766020216, 402.3066789904024, 426.2913173447991, 443.47826117034873, 263.1014379528766, 398.01437100242555, 379.07999852908534, 438.115462393433, 400.8540345365453, 362.72980191737236, 314.4566661773338, 407.10056601863386, 391.20883936339163, 376.7481347026365, 302.9575850662322, 397.71105363147365, 404.8429078607578, 386.9280480588672, 402.73746286167164, 394.24728792684516, 416.8592270771812, 372.7803907584128, 369.73920207798176, 405.75732209926696, 350.07835484014174, 386.02270903997254, 384.9263055085262, 402.28588449429634, 403.99737350004943, 402.963081380134, 383.55822145058283, 391.58087269176093, 389.931603431101, 392.1595818585996, 395.54922557745897, 374.11160425703787, 414.28221187177905, 392.51975881169795, 404.6342827679076, 392.25835773640796, 389.21567880910663, 395.6284251970312, 392.00458681909157, 387.10633285085214, 388.5818262966956, 387.50146236367436, 376.5319175270263, 355.90271877073, 398.13504702651227, 398.00034790242677], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [102.75724850979056, 134.22736298995434, 131.5771519771377, 120.65030701741483, -53.918572387229176, 151.20285626947148, 140.27309444452885, 117.57255904828168, 143.36862376621826, 124.12366729829296, 151.56917931278412, 35.24631411351547, 131.74317203322275, 57.818490651345456, 71.6857055620971, 137.9775148720288, 184.5697736943801, 82.47654450570275, 167.08766162934634, 127.58043037750782, 163.06329612141002, 62.48486119241295, 177.6960644092102, 85.61927445948473, 109.65331885204787, 156.57936571419506, 162.81574134541043, 138.61506411183393, 143.21722377642288, 40.12744782584197, 170.70681572088924, -30.996916887492183, 148.19622281440715, 113.68029173728097, 122.28071521735978, 143.17925883927919, 63.660696611057254, 142.46479226085214, 155.8309300899995, 95.37270119123694, 170.1627623853567, 151.15357264585353, 134.6748648388199, 169.28719487717058, -89.08859701974826, 170.18192271678714, 140.12542145280767, 138.11534839222142, 137.19015989452632, 117.11199978480855, 153.7237868571197, 90.09122296213957, 175.16715146323187, 165.2231886206608, 101.91961477891276, 97.5970935764301, 158.59189967571297, 170.41021020638163, 178.38276157128888, 172.99861984143257, 168.7526234260366, 70.99693133469337, 77.27485614719485, 152.32101545465065, 178.38275289548858, 128.6579941643105, 163.46294893188366, 119.38211250209407, 165.67912981952665, 102.6698960269569, 96.08873731080594, 164.6164784976641, 161.14519739711065, 139.75992768749614, 163.8627635067782, 108.1385293378143, 177.1299138981656, 97.52566101860079, 102.16042828548845, 176.82857688569743, 176.39348009189976, 79.73881754168671, 169.2495851256791, 145.05768942292804, 155.72015371838845, 157.0601352886178, 122.45972099969039, 156.58878510100314, 146.79314681237295, 154.62536890179376, 143.92364263522407, 186.67147810422034, 2.0000000000000013, 161.29878604130914, 118.3228686208069, 150.94725879410393, 145.32512377032953, 156.66742232904377, 161.3030230336058, 139.1959326267613, 170.73261916894404, 136.45677020852327, 139.69837316756715, 167.0340604983994, 127.44546699249936, 127.51723927232845, 133.53975071596233, 172.18892277177255, 51.20560228016305, 149.361587532529, 161.0337707246898, 171.17921262204524, 169.9652559689358, 152.91865759801485, 97.38924916652203, 176.69887630726814, 99.34385171371441, 171.6650773925693, 123.92814600668656, 134.84104310291846, 94.01088377918929, 138.78861064785997, 162.7452615702581, 135.3957165948015, 145.98407356703459, 164.91858422026664, 163.67259035659052, 167.54007639035567, 133.67000921131276, 99.94703537147545, 141.62227271521306, 177.20880692580207, 179.16862780460687, 112.22745829169635, 155.82506053524475, 136.21787207882073, 143.68563787924268, 182.77615526203678, 167.2272795896382, 174.03364804631005, 169.73438627625484, 150.35183419450647, 135.11727547129783, 150.93751916657178, 176.192241740011, 73.70344711708367, 180.05590273218067, 151.2758048508451, 127.9766886235248, 145.3465993251379, 146.54606538963216, 142.6707300122136, 145.86926827793718, 180.1476252828131, 159.02634070885452, 156.078576837823, 176.5394909179953, 159.3669295438774, 158.34170059897735, 169.24690653044678, 158.23247231324515, 160.10673396062165, 150.93804596451594, 164.6438919049456, 163.75650461857927, 174.5426217188352, 176.34637595612477, 172.71637978384504, 164.3301941432867, 140.88113542180662, 122.7314043941761, 184.70015449677788, 177.07326606892715, 135.48168840337658, 170.09134815557175, 172.32242677640838, 119.49866013678016, 168.08854794676228, 173.84522203777874, 177.3171211280727, 166.96705495775774, 171.0658686648307, 180.9651878130412, 170.7733991655183, 155.30498905861955, 173.11693533973673, 166.34973963754857, 160.27936882840993, 183.08528684318253, 173.89991694552086, 177.14766825618702, 164.21855833437465, 156.4836662701097, 148.54574009335587, 159.10316523369656, 164.26573751496292, 179.51596974276973, 142.2851012219715, 177.9489964821209, 165.22753503549617], "policy_predator_policy_reward": [91.17568592449275, 99.61202680820413, 81.19196025720767, 94.2501158164779, 205.00530314397784, 164.4672800921795, 76.67100656792785, 73.69168493064515, 72.56100598480062, 52.662744098307996, 110.59090258710654, 95.16677838899396, 68.61984757833224, 72.42618070927165, 106.77929745401701, 107.03295198115242, 95.13460809394623, 77.34417861926585, 68.80036771397421, 65.88201670203854, 96.45836564883622, 130.7473059286458, 75.26200068306281, 92.12182908447723, 87.21074112878189, 80.28854843747163, 35.936243274833124, 53.27366640060312, 104.90811903113125, 147.9589258845393, 141.42196002823442, 197.79038409366004, 98.5692068782317, 90.05979760786107, 88.73642697867862, 78.53983180872507, 123.64509538896593, 118.61861253962799, 73.25384300431553, 88.78520798704761, 39.53300903115731, 38.763785538287, 42.30384583523988, 49.67548164711, 145.1028644229766, 217.69587098934048, 85.92480440529881, 84.11106239310249, 66.50037202164577, 66.22374437010126, 85.89742714512552, 93.35900089835677, 27.743481554070737, 28.49334522803505, 89.07419623811006, 135.85149110678427, 30.537148362384446, 31.7018231350963, 31.084641017380903, 23.647604839811798, 106.66502200251585, 87.18798132301295, 107.47685954303265, 108.42266110522147, 58.51795559922984, 60.817645326288265, 69.87676926141569, 74.5270905124814, 80.36753978557425, 64.73087517060229, 78.24689708570166, 85.03351486393677, 48.776044246530915, 64.39436124298095, 82.33931016989959, 89.23097647935455, 66.74118265722042, 75.57036475117484, 62.04378951243209, 62.43154321278018, 89.26707617736938, 89.71912076895563, 49.583634721567215, 49.10455531056406, 19.124587876783288, 49.623985267648784, 61.14670276863426, 65.28449959131352, 52.548251934384425, 58.03346399521816, 33.94627885273881, 40.06495719646777, 15.659930017509518, 28.105167464252954, 55.21314924962093, 51.97517658071414, 43.454310555786634, 50.03919162477537, 68.46594594066319, 58.73072958662039, 35.000194836782484, 54.579053445952276, 37.23542392329011, 58.338821401145886, 76.37711806240351, 94.95149301756754, 68.20934119166677, 69.540246490947, 30.972875282800203, 31.561372857384175, 30.422802451251595, 35.378585204438835, 33.84083207279048, 22.355252889344317, 80.50301974278044, 83.52431717686241, 92.9127491881887, 36.93235624207296, 57.48291931787919, 46.47769348988829, 34.57898155133545, 47.07819019894899, 43.07527625807835, 65.88431159549579, 46.22765140692195, 34.07853016916843, 18.128659881529686, 27.406808074160626, 39.09937657924722, 30.241163904196796, 34.53368298050065, 44.346291009957945, 60.298125038524425, 53.14869672593032, 66.72535792425477, 28.15975752054675, 51.109508727916364, 25.166160992475824, 21.961435175497755, 31.02492511539899, 42.65968433980247, 54.11332226661707, 42.219209663719724, 44.50638645682372, 41.634458883582916, 78.20905433730445, 32.82435127255063, 41.601263243690724, 34.26866901653604, 42.48639787494308, 45.968700158573064, 50.8372134795537, 29.950882573330375, 28.95852937444572, 30.246460891921238, 56.93450605569751, 30.472039432029618, 37.61891360614714, 32.43630112175771, 42.938173128952194, 28.0128052845012, 37.20620989221441, 34.324398550131384, 41.67453627216818, 30.079033459099136, 21.553443634587822, 24.193899242494197, 18.90292687613569, 40.20472036149046, 50.13317565087508, 41.29673545029406, 25.383309915789777, 57.81371228145184, 43.913545118023144, 24.500959624364704, 25.60502425535303, 55.439590987340345, 61.60748369702464, 20.239136889307407, 20.85687768124914, 23.429267403969003, 27.753487782549055, 27.411351541709816, 16.478486676762117, 28.958598297476943, 34.624064123258606, 30.889096654118052, 29.58812773077542, 15.625600511659451, 15.971021996332983, 17.332823919898825, 28.80241185321429, 36.01239767439151, 35.49011348916963, 18.677031911947005, 13.856784110123515, 34.18894450274118, 42.145031559029945, 29.7279100799866, 25.09590630482305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6205469197544184, "mean_inference_ms": 1.9487582039390128, "mean_action_processing_ms": 0.25828021280011404, "mean_env_wait_ms": 0.2368510647758194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005434393882751465, "StateBufferConnector_ms": 0.003450751304626465, "ViewRequirementAgentConnector_ms": 0.10135269165039062}, "num_episodes": 18, "episode_return_max": 478.9222429552906, "episode_return_min": 207.06388352307113, "episode_return_mean": 401.13683966839983, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.44085910689, "num_env_steps_trained_throughput_per_sec": 337.44085910689, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 11096.572, "restore_workers_time_ms": 0.013, "training_step_time_ms": 11096.52, "sample_time_ms": 1566.013, "learn_time_ms": 9514.27, "learn_throughput": 420.421, "synch_weights_time_ms": 14.778}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-24", "timestamp": 1723779024, "time_this_iter_s": 11.90896201133728, "time_total_s": 833.4746057987213, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2251820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 833.4746057987213, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 42.44375, "ram_util_percent": 82.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.139580632202209, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.87459553032325, "policy_loss": -0.00543546054879371, "vf_loss": 4.878821949479441, "vf_explained_var": 0.07170695564734242, "kl": 0.007164730009987994, "entropy": 0.6884084455235294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.631071925541711, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9510030872607356, "policy_loss": -0.0033783605093106865, "vf_loss": 3.953864013328754, "vf_explained_var": 0.053081009154597285, "kl": 0.006898959470930419, "entropy": 1.2654350576577362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 448.27663664342975, "episode_reward_min": 207.06388352307113, "episode_reward_mean": 391.9923772265513, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -89.08859701974826, "predator_policy": 13.856784110123515}, "policy_reward_max": {"prey_policy": 186.67147810422034, "predator_policy": 217.69587098934048}, "policy_reward_mean": {"prey_policy": 149.4427990826082, "predator_policy": 46.5533895306675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.8920611093563, 448.27663664342975, 387.0262760710815, 423.0714378627417, 396.6271668659987, 424.4423957002376, 391.2410813795755, 406.11362726991393, 433.60255808625834, 445.49539225009954, 426.3763479853168, 427.24892120787507, 413.4474408026602, 423.98562775810933, 414.0755305741185, 443.57157949384674, 416.9671223251621, 403.46433789639894, 435.11849457991184, 412.9954645807386, 381.5288621514379, 405.4797084606418, 412.00023164376915, 404.606356788651, 207.06388352307113, 376.4584532452461, 395.48604827993546, 427.69563118765075, 396.76863766020216, 402.3066789904024, 426.2913173447991, 443.47826117034873, 263.1014379528766, 398.01437100242555, 379.07999852908534, 438.115462393433, 400.8540345365453, 362.72980191737236, 314.4566661773338, 407.10056601863386, 391.20883936339163, 376.7481347026365, 302.9575850662322, 397.71105363147365, 404.8429078607578, 386.9280480588672, 402.73746286167164, 394.24728792684516, 416.8592270771812, 372.7803907584128, 369.73920207798176, 405.75732209926696, 350.07835484014174, 386.02270903997254, 384.9263055085262, 402.28588449429634, 403.99737350004943, 402.963081380134, 383.55822145058283, 391.58087269176093, 389.931603431101, 392.1595818585996, 395.54922557745897, 374.11160425703787, 414.28221187177905, 392.51975881169795, 404.6342827679076, 392.25835773640796, 389.21567880910663, 395.6284251970312, 392.00458681909157, 387.10633285085214, 388.5818262966956, 387.50146236367436, 376.5319175270263, 355.90271877073, 398.13504702651227, 398.00034790242677, 396.6771872890286, 411.8733431280012, 403.92812936922905, 378.47102627244277, 393.0500970422288, 371.9441979386611, 392.3994703912474, 390.26582754519217, 396.23203612408554, 386.1742785351536, 395.83349257680004, 373.83638719293094, 375.2859426203951, 381.2289481529385, 351.45334019975223, 396.03055490753326, 376.70087327788616, 395.77716972603037, 296.8950361549021, 390.11614927847324, 342.94128157587244, 390.4818096743402], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-89.08859701974826, 170.18192271678714, 140.12542145280767, 138.11534839222142, 137.19015989452632, 117.11199978480855, 153.7237868571197, 90.09122296213957, 175.16715146323187, 165.2231886206608, 101.91961477891276, 97.5970935764301, 158.59189967571297, 170.41021020638163, 178.38276157128888, 172.99861984143257, 168.7526234260366, 70.99693133469337, 77.27485614719485, 152.32101545465065, 178.38275289548858, 128.6579941643105, 163.46294893188366, 119.38211250209407, 165.67912981952665, 102.6698960269569, 96.08873731080594, 164.6164784976641, 161.14519739711065, 139.75992768749614, 163.8627635067782, 108.1385293378143, 177.1299138981656, 97.52566101860079, 102.16042828548845, 176.82857688569743, 176.39348009189976, 79.73881754168671, 169.2495851256791, 145.05768942292804, 155.72015371838845, 157.0601352886178, 122.45972099969039, 156.58878510100314, 146.79314681237295, 154.62536890179376, 143.92364263522407, 186.67147810422034, 2.0000000000000013, 161.29878604130914, 118.3228686208069, 150.94725879410393, 145.32512377032953, 156.66742232904377, 161.3030230336058, 139.1959326267613, 170.73261916894404, 136.45677020852327, 139.69837316756715, 167.0340604983994, 127.44546699249936, 127.51723927232845, 133.53975071596233, 172.18892277177255, 51.20560228016305, 149.361587532529, 161.0337707246898, 171.17921262204524, 169.9652559689358, 152.91865759801485, 97.38924916652203, 176.69887630726814, 99.34385171371441, 171.6650773925693, 123.92814600668656, 134.84104310291846, 94.01088377918929, 138.78861064785997, 162.7452615702581, 135.3957165948015, 145.98407356703459, 164.91858422026664, 163.67259035659052, 167.54007639035567, 133.67000921131276, 99.94703537147545, 141.62227271521306, 177.20880692580207, 179.16862780460687, 112.22745829169635, 155.82506053524475, 136.21787207882073, 143.68563787924268, 182.77615526203678, 167.2272795896382, 174.03364804631005, 169.73438627625484, 150.35183419450647, 135.11727547129783, 150.93751916657178, 176.192241740011, 73.70344711708367, 180.05590273218067, 151.2758048508451, 127.9766886235248, 145.3465993251379, 146.54606538963216, 142.6707300122136, 145.86926827793718, 180.1476252828131, 159.02634070885452, 156.078576837823, 176.5394909179953, 159.3669295438774, 158.34170059897735, 169.24690653044678, 158.23247231324515, 160.10673396062165, 150.93804596451594, 164.6438919049456, 163.75650461857927, 174.5426217188352, 176.34637595612477, 172.71637978384504, 164.3301941432867, 140.88113542180662, 122.7314043941761, 184.70015449677788, 177.07326606892715, 135.48168840337658, 170.09134815557175, 172.32242677640838, 119.49866013678016, 168.08854794676228, 173.84522203777874, 177.3171211280727, 166.96705495775774, 171.0658686648307, 180.9651878130412, 170.7733991655183, 155.30498905861955, 173.11693533973673, 166.34973963754857, 160.27936882840993, 183.08528684318253, 173.89991694552086, 177.14766825618702, 164.21855833437465, 156.4836662701097, 148.54574009335587, 159.10316523369656, 164.26573751496292, 179.51596974276973, 142.2851012219715, 177.9489964821209, 165.22753503549617, 173.80392234589283, 178.69440093967498, 151.75928564743674, 185.54157474395612, 176.63961664437923, 151.48430083636907, 116.74177456086275, 160.70802694994242, 138.7012072147695, 167.80228409611647, 161.51419405282806, 170.02791714422605, 167.72995884139965, 170.34545459446693, 179.00604894530505, 172.47367197358943, 172.5039308845792, 173.5845509905402, 168.0734102751071, 163.9884364973071, 92.71857011650876, 176.6243431267241, 146.56100502065246, 155.60303064641042, 150.0642059533632, 137.26979688650246, 164.69864864296488, 132.07121927648154, 136.45555756406847, 132.84602484892844, 181.19733211055492, 153.93898806973195, 159.416243271216, 126.43960049035574, 180.2872671377202, 179.11803820997594, 86.14501866495493, 137.120165279908, 139.13843290656217, 164.30821914794316, 127.62573137381314, 160.17354558716193, 156.84030622425865, 159.3252511060465], "policy_predator_policy_reward": [145.1028644229766, 217.69587098934048, 85.92480440529881, 84.11106239310249, 66.50037202164577, 66.22374437010126, 85.89742714512552, 93.35900089835677, 27.743481554070737, 28.49334522803505, 89.07419623811006, 135.85149110678427, 30.537148362384446, 31.7018231350963, 31.084641017380903, 23.647604839811798, 106.66502200251585, 87.18798132301295, 107.47685954303265, 108.42266110522147, 58.51795559922984, 60.817645326288265, 69.87676926141569, 74.5270905124814, 80.36753978557425, 64.73087517060229, 78.24689708570166, 85.03351486393677, 48.776044246530915, 64.39436124298095, 82.33931016989959, 89.23097647935455, 66.74118265722042, 75.57036475117484, 62.04378951243209, 62.43154321278018, 89.26707617736938, 89.71912076895563, 49.583634721567215, 49.10455531056406, 19.124587876783288, 49.623985267648784, 61.14670276863426, 65.28449959131352, 52.548251934384425, 58.03346399521816, 33.94627885273881, 40.06495719646777, 15.659930017509518, 28.105167464252954, 55.21314924962093, 51.97517658071414, 43.454310555786634, 50.03919162477537, 68.46594594066319, 58.73072958662039, 35.000194836782484, 54.579053445952276, 37.23542392329011, 58.338821401145886, 76.37711806240351, 94.95149301756754, 68.20934119166677, 69.540246490947, 30.972875282800203, 31.561372857384175, 30.422802451251595, 35.378585204438835, 33.84083207279048, 22.355252889344317, 80.50301974278044, 83.52431717686241, 92.9127491881887, 36.93235624207296, 57.48291931787919, 46.47769348988829, 34.57898155133545, 47.07819019894899, 43.07527625807835, 65.88431159549579, 46.22765140692195, 34.07853016916843, 18.128659881529686, 27.406808074160626, 39.09937657924722, 30.241163904196796, 34.53368298050065, 44.346291009957945, 60.298125038524425, 53.14869672593032, 66.72535792425477, 28.15975752054675, 51.109508727916364, 25.166160992475824, 21.961435175497755, 31.02492511539899, 42.65968433980247, 54.11332226661707, 42.219209663719724, 44.50638645682372, 41.634458883582916, 78.20905433730445, 32.82435127255063, 41.601263243690724, 34.26866901653604, 42.48639787494308, 45.968700158573064, 50.8372134795537, 29.950882573330375, 28.95852937444572, 30.246460891921238, 56.93450605569751, 30.472039432029618, 37.61891360614714, 32.43630112175771, 42.938173128952194, 28.0128052845012, 37.20620989221441, 34.324398550131384, 41.67453627216818, 30.079033459099136, 21.553443634587822, 24.193899242494197, 18.90292687613569, 40.20472036149046, 50.13317565087508, 41.29673545029406, 25.383309915789777, 57.81371228145184, 43.913545118023144, 24.500959624364704, 25.60502425535303, 55.439590987340345, 61.60748369702464, 20.239136889307407, 20.85687768124914, 23.429267403969003, 27.753487782549055, 27.411351541709816, 16.478486676762117, 28.958598297476943, 34.624064123258606, 30.889096654118052, 29.58812773077542, 15.625600511659451, 15.971021996332983, 17.332823919898825, 28.80241185321429, 36.01239767439151, 35.49011348916963, 18.677031911947005, 13.856784110123515, 34.18894450274118, 42.145031559029945, 29.7279100799866, 25.09590630482305, 26.48119750972415, 17.69766649373692, 47.615547020007, 26.95693571660135, 42.81785630617851, 32.986355582302245, 63.87490310934109, 37.14632165229661, 39.097242403940776, 47.4493633274022, 19.30284743376863, 21.099239307838197, 21.47054057759766, 32.85351637778313, 18.05966541635706, 20.726441209940774, 27.07908213245073, 23.064472116515308, 33.2248912113518, 20.887540551387573, 51.187751071539, 75.3028282620283, 42.63071626130896, 29.041635264559012, 54.44882877225652, 33.50311100827287, 42.32812576088072, 42.130954472611236, 62.363327890762896, 19.788429895992493, 28.236362152115536, 32.657872575130945, 25.99706406620381, 64.84796545011055, 19.549752193782457, 16.822112184551948, 38.35938268881813, 35.270469521220974, 43.522136754503336, 43.14736046946464, 29.255590731556687, 25.886413883340882, 35.78971704533548, 38.52653529869942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6200606604177724, "mean_inference_ms": 1.9500752323746824, "mean_action_processing_ms": 0.2578767371654166, "mean_env_wait_ms": 0.2367939906223716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047293901443481445, "StateBufferConnector_ms": 0.0034574270248413086, "ViewRequirementAgentConnector_ms": 0.10426485538482666}, "num_episodes": 22, "episode_return_max": 448.27663664342975, "episode_return_min": 207.06388352307113, "episode_return_mean": 391.9923772265513, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 367.00678397082356, "num_env_steps_trained_throughput_per_sec": 367.00678397082356, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 10879.481, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10879.429, "sample_time_ms": 1491.518, "learn_time_ms": 9370.94, "learn_throughput": 426.852, "synch_weights_time_ms": 15.424}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-35", "timestamp": 1723779035, "time_this_iter_s": 10.964643955230713, "time_total_s": 844.439249753952, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 844.439249753952, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 34.18125, "ram_util_percent": 82.7625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.127156163018848, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.268239675501667, "policy_loss": -0.012069557287863323, "vf_loss": 5.278500329880488, "vf_explained_var": 0.07168209600070166, "kl": 0.010719558753083168, "entropy": 0.6849892131235233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.996787528449265, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.003119084443996, "policy_loss": -0.004928583510481216, "vf_loss": 6.007295768727701, "vf_explained_var": 0.053411097595931364, "kl": 0.010025272661332166, "entropy": 1.3077150074893205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 443.47826117034873, "episode_reward_min": 207.06388352307113, "episode_reward_mean": 384.1505876609363, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -13.329752352225077, "predator_policy": 13.856784110123515}, "policy_reward_max": {"prey_policy": 186.67147810422034, "predator_policy": 246.57390444532163}, "policy_reward_mean": {"prey_policy": 148.96000698943806, "predator_policy": 43.11528684103012}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.11849457991184, 412.9954645807386, 381.5288621514379, 405.4797084606418, 412.00023164376915, 404.606356788651, 207.06388352307113, 376.4584532452461, 395.48604827993546, 427.69563118765075, 396.76863766020216, 402.3066789904024, 426.2913173447991, 443.47826117034873, 263.1014379528766, 398.01437100242555, 379.07999852908534, 438.115462393433, 400.8540345365453, 362.72980191737236, 314.4566661773338, 407.10056601863386, 391.20883936339163, 376.7481347026365, 302.9575850662322, 397.71105363147365, 404.8429078607578, 386.9280480588672, 402.73746286167164, 394.24728792684516, 416.8592270771812, 372.7803907584128, 369.73920207798176, 405.75732209926696, 350.07835484014174, 386.02270903997254, 384.9263055085262, 402.28588449429634, 403.99737350004943, 402.963081380134, 383.55822145058283, 391.58087269176093, 389.931603431101, 392.1595818585996, 395.54922557745897, 374.11160425703787, 414.28221187177905, 392.51975881169795, 404.6342827679076, 392.25835773640796, 389.21567880910663, 395.6284251970312, 392.00458681909157, 387.10633285085214, 388.5818262966956, 387.50146236367436, 376.5319175270263, 355.90271877073, 398.13504702651227, 398.00034790242677, 396.6771872890286, 411.8733431280012, 403.92812936922905, 378.47102627244277, 393.0500970422288, 371.9441979386611, 392.3994703912474, 390.26582754519217, 396.23203612408554, 386.1742785351536, 395.83349257680004, 373.83638719293094, 375.2859426203951, 381.2289481529385, 351.45334019975223, 396.03055490753326, 376.70087327788616, 395.77716972603037, 296.8950361549021, 390.11614927847324, 342.94128157587244, 390.4818096743402, 363.71547180065556, 401.03114371029915, 399.7800434891391, 378.35451540170914, 366.32022736117636, 311.4706387968239, 394.208410234593, 390.09296699809636, 396.87339874499827, 409.5606372808429, 366.87453688590347, 367.7763228551814, 322.0596271945645, 370.18527639319325, 386.9168012890032, 396.48966071491634, 379.80000200930635, 383.23690356027487], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.39348009189976, 79.73881754168671, 169.2495851256791, 145.05768942292804, 155.72015371838845, 157.0601352886178, 122.45972099969039, 156.58878510100314, 146.79314681237295, 154.62536890179376, 143.92364263522407, 186.67147810422034, 2.0000000000000013, 161.29878604130914, 118.3228686208069, 150.94725879410393, 145.32512377032953, 156.66742232904377, 161.3030230336058, 139.1959326267613, 170.73261916894404, 136.45677020852327, 139.69837316756715, 167.0340604983994, 127.44546699249936, 127.51723927232845, 133.53975071596233, 172.18892277177255, 51.20560228016305, 149.361587532529, 161.0337707246898, 171.17921262204524, 169.9652559689358, 152.91865759801485, 97.38924916652203, 176.69887630726814, 99.34385171371441, 171.6650773925693, 123.92814600668656, 134.84104310291846, 94.01088377918929, 138.78861064785997, 162.7452615702581, 135.3957165948015, 145.98407356703459, 164.91858422026664, 163.67259035659052, 167.54007639035567, 133.67000921131276, 99.94703537147545, 141.62227271521306, 177.20880692580207, 179.16862780460687, 112.22745829169635, 155.82506053524475, 136.21787207882073, 143.68563787924268, 182.77615526203678, 167.2272795896382, 174.03364804631005, 169.73438627625484, 150.35183419450647, 135.11727547129783, 150.93751916657178, 176.192241740011, 73.70344711708367, 180.05590273218067, 151.2758048508451, 127.9766886235248, 145.3465993251379, 146.54606538963216, 142.6707300122136, 145.86926827793718, 180.1476252828131, 159.02634070885452, 156.078576837823, 176.5394909179953, 159.3669295438774, 158.34170059897735, 169.24690653044678, 158.23247231324515, 160.10673396062165, 150.93804596451594, 164.6438919049456, 163.75650461857927, 174.5426217188352, 176.34637595612477, 172.71637978384504, 164.3301941432867, 140.88113542180662, 122.7314043941761, 184.70015449677788, 177.07326606892715, 135.48168840337658, 170.09134815557175, 172.32242677640838, 119.49866013678016, 168.08854794676228, 173.84522203777874, 177.3171211280727, 166.96705495775774, 171.0658686648307, 180.9651878130412, 170.7733991655183, 155.30498905861955, 173.11693533973673, 166.34973963754857, 160.27936882840993, 183.08528684318253, 173.89991694552086, 177.14766825618702, 164.21855833437465, 156.4836662701097, 148.54574009335587, 159.10316523369656, 164.26573751496292, 179.51596974276973, 142.2851012219715, 177.9489964821209, 165.22753503549617, 173.80392234589283, 178.69440093967498, 151.75928564743674, 185.54157474395612, 176.63961664437923, 151.48430083636907, 116.74177456086275, 160.70802694994242, 138.7012072147695, 167.80228409611647, 161.51419405282806, 170.02791714422605, 167.72995884139965, 170.34545459446693, 179.00604894530505, 172.47367197358943, 172.5039308845792, 173.5845509905402, 168.0734102751071, 163.9884364973071, 92.71857011650876, 176.6243431267241, 146.56100502065246, 155.60303064641042, 150.0642059533632, 137.26979688650246, 164.69864864296488, 132.07121927648154, 136.45555756406847, 132.84602484892844, 181.19733211055492, 153.93898806973195, 159.416243271216, 126.43960049035574, 180.2872671377202, 179.11803820997594, 86.14501866495493, 137.120165279908, 139.13843290656217, 164.30821914794316, 127.62573137381314, 160.17354558716193, 156.84030622425865, 159.3252511060465, 106.8807978324071, 127.67353280123251, 171.26027088830944, 165.43776402999197, 174.57535504554025, 144.09422615218108, 173.8144896467532, 162.74445217376427, 154.5421375918673, 142.54397574039277, 34.46405706022541, 42.48436954164542, 152.65052452243168, 169.41098711622607, 173.2912057339244, 165.53436520874743, -8.401868177712512, 46.44731239442417, 168.28975871029397, 112.45906310075517, 124.54336991711172, 60.600210286755114, 157.57146104262034, 149.56922641773096, -13.329752352225077, 53.15393464416058, 134.01234396036625, 146.6671916097298, 161.93441201677624, 168.81969214490198, 167.7701122655418, 172.14147497667997, 153.35744985120934, 159.277226832965, 156.19723808224265, 163.53749185918048], "policy_predator_policy_reward": [89.26707617736938, 89.71912076895563, 49.583634721567215, 49.10455531056406, 19.124587876783288, 49.623985267648784, 61.14670276863426, 65.28449959131352, 52.548251934384425, 58.03346399521816, 33.94627885273881, 40.06495719646777, 15.659930017509518, 28.105167464252954, 55.21314924962093, 51.97517658071414, 43.454310555786634, 50.03919162477537, 68.46594594066319, 58.73072958662039, 35.000194836782484, 54.579053445952276, 37.23542392329011, 58.338821401145886, 76.37711806240351, 94.95149301756754, 68.20934119166677, 69.540246490947, 30.972875282800203, 31.561372857384175, 30.422802451251595, 35.378585204438835, 33.84083207279048, 22.355252889344317, 80.50301974278044, 83.52431717686241, 92.9127491881887, 36.93235624207296, 57.48291931787919, 46.47769348988829, 34.57898155133545, 47.07819019894899, 43.07527625807835, 65.88431159549579, 46.22765140692195, 34.07853016916843, 18.128659881529686, 27.406808074160626, 39.09937657924722, 30.241163904196796, 34.53368298050065, 44.346291009957945, 60.298125038524425, 53.14869672593032, 66.72535792425477, 28.15975752054675, 51.109508727916364, 25.166160992475824, 21.961435175497755, 31.02492511539899, 42.65968433980247, 54.11332226661707, 42.219209663719724, 44.50638645682372, 41.634458883582916, 78.20905433730445, 32.82435127255063, 41.601263243690724, 34.26866901653604, 42.48639787494308, 45.968700158573064, 50.8372134795537, 29.950882573330375, 28.95852937444572, 30.246460891921238, 56.93450605569751, 30.472039432029618, 37.61891360614714, 32.43630112175771, 42.938173128952194, 28.0128052845012, 37.20620989221441, 34.324398550131384, 41.67453627216818, 30.079033459099136, 21.553443634587822, 24.193899242494197, 18.90292687613569, 40.20472036149046, 50.13317565087508, 41.29673545029406, 25.383309915789777, 57.81371228145184, 43.913545118023144, 24.500959624364704, 25.60502425535303, 55.439590987340345, 61.60748369702464, 20.239136889307407, 20.85687768124914, 23.429267403969003, 27.753487782549055, 27.411351541709816, 16.478486676762117, 28.958598297476943, 34.624064123258606, 30.889096654118052, 29.58812773077542, 15.625600511659451, 15.971021996332983, 17.332823919898825, 28.80241185321429, 36.01239767439151, 35.49011348916963, 18.677031911947005, 13.856784110123515, 34.18894450274118, 42.145031559029945, 29.7279100799866, 25.09590630482305, 26.48119750972415, 17.69766649373692, 47.615547020007, 26.95693571660135, 42.81785630617851, 32.986355582302245, 63.87490310934109, 37.14632165229661, 39.097242403940776, 47.4493633274022, 19.30284743376863, 21.099239307838197, 21.47054057759766, 32.85351637778313, 18.05966541635706, 20.726441209940774, 27.07908213245073, 23.064472116515308, 33.2248912113518, 20.887540551387573, 51.187751071539, 75.3028282620283, 42.63071626130896, 29.041635264559012, 54.44882877225652, 33.50311100827287, 42.32812576088072, 42.130954472611236, 62.363327890762896, 19.788429895992493, 28.236362152115536, 32.657872575130945, 25.99706406620381, 64.84796545011055, 19.549752193782457, 16.822112184551948, 38.35938268881813, 35.270469521220974, 43.522136754503336, 43.14736046946464, 29.255590731556687, 25.886413883340882, 35.78971704533548, 38.52653529869942, 41.07354582652286, 88.08759534049275, 35.20191264652939, 29.131196145468387, 44.922145680739774, 36.188316610678086, 16.710994637987426, 25.084578943204217, 26.369519034518643, 42.86459499439776, 61.7165819295782, 172.80563026537527, 43.34324961458024, 28.803648981354858, 27.04427581432079, 24.223120241103867, 199.63255604351863, 159.19539848476828, 76.25480986418873, 52.55700560560539, 50.579103727007265, 131.15185295502954, 36.986407577244464, 23.64922781758605, 246.57390444532163, 35.66154045730736, 54.83885824065894, 34.66688258243849, 23.75812077213488, 32.40457635519013, 25.679669795057052, 30.898403677637358, 35.7096032567595, 31.455722068372502, 42.71598939197825, 20.786184226873434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6203353313033249, "mean_inference_ms": 1.9486781845476155, "mean_action_processing_ms": 0.2580638820424285, "mean_env_wait_ms": 0.2367583211442873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00437009334564209, "StateBufferConnector_ms": 0.0034475326538085938, "ViewRequirementAgentConnector_ms": 0.10560297966003418}, "num_episodes": 18, "episode_return_max": 443.47826117034873, "episode_return_min": 207.06388352307113, "episode_return_mean": 384.1505876609363, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.71024412512634, "num_env_steps_trained_throughput_per_sec": 359.71024412512634, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 10836.78, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10836.727, "sample_time_ms": 1434.252, "learn_time_ms": 9385.903, "learn_throughput": 426.171, "synch_weights_time_ms": 15.038}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-46", "timestamp": 1723779046, "time_this_iter_s": 11.166170835494995, "time_total_s": 855.605420589447, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2291ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 855.605420589447, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 37.975, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.137479902638329, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.571485352894617, "policy_loss": -0.010060478062935608, "vf_loss": 6.579838108890271, "vf_explained_var": 0.07680200839799547, "kl": 0.010119776803167998, "entropy": 0.6719013842325362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.586437855069599, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.595445628897854, "policy_loss": -0.008266115521952984, "vf_loss": 7.6024010421107056, "vf_explained_var": 0.029580703109660475, "kl": 0.01747616061581066, "entropy": 1.3139736664989008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 416.8592270771812, "episode_reward_min": 296.8950361549021, "episode_reward_mean": 376.92144743298394, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -13.329752352225077, "predator_policy": 13.856784110123515}, "policy_reward_max": {"prey_policy": 185.54157474395612, "predator_policy": 246.57390444532163}, "policy_reward_mean": {"prey_policy": 140.59399187311482, "predator_policy": 47.86673184337715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.7481347026365, 302.9575850662322, 397.71105363147365, 404.8429078607578, 386.9280480588672, 402.73746286167164, 394.24728792684516, 416.8592270771812, 372.7803907584128, 369.73920207798176, 405.75732209926696, 350.07835484014174, 386.02270903997254, 384.9263055085262, 402.28588449429634, 403.99737350004943, 402.963081380134, 383.55822145058283, 391.58087269176093, 389.931603431101, 392.1595818585996, 395.54922557745897, 374.11160425703787, 414.28221187177905, 392.51975881169795, 404.6342827679076, 392.25835773640796, 389.21567880910663, 395.6284251970312, 392.00458681909157, 387.10633285085214, 388.5818262966956, 387.50146236367436, 376.5319175270263, 355.90271877073, 398.13504702651227, 398.00034790242677, 396.6771872890286, 411.8733431280012, 403.92812936922905, 378.47102627244277, 393.0500970422288, 371.9441979386611, 392.3994703912474, 390.26582754519217, 396.23203612408554, 386.1742785351536, 395.83349257680004, 373.83638719293094, 375.2859426203951, 381.2289481529385, 351.45334019975223, 396.03055490753326, 376.70087327788616, 395.77716972603037, 296.8950361549021, 390.11614927847324, 342.94128157587244, 390.4818096743402, 363.71547180065556, 401.03114371029915, 399.7800434891391, 378.35451540170914, 366.32022736117636, 311.4706387968239, 394.208410234593, 390.09296699809636, 396.87339874499827, 409.5606372808429, 366.87453688590347, 367.7763228551814, 322.0596271945645, 370.18527639319325, 386.9168012890032, 396.48966071491634, 379.80000200930635, 383.23690356027487, 361.3229671914574, 365.7846959183195, 382.35742917282, 376.906957784831, 386.99546947228333, 368.0983156663845, 364.51265658639807, 350.5704084807246, 351.8004542077443, 363.8455901173791, 365.99182925208976, 365.9340130774674, 302.4312962728021, 314.2762489598096, 383.0545217589919, 350.75012972340295, 328.42005585113566, 367.5001618971199, 324.56413119094145, 367.6927783434613, 301.4007231178755, 355.08874111041183, 359.72560954881266], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.67259035659052, 167.54007639035567, 133.67000921131276, 99.94703537147545, 141.62227271521306, 177.20880692580207, 179.16862780460687, 112.22745829169635, 155.82506053524475, 136.21787207882073, 143.68563787924268, 182.77615526203678, 167.2272795896382, 174.03364804631005, 169.73438627625484, 150.35183419450647, 135.11727547129783, 150.93751916657178, 176.192241740011, 73.70344711708367, 180.05590273218067, 151.2758048508451, 127.9766886235248, 145.3465993251379, 146.54606538963216, 142.6707300122136, 145.86926827793718, 180.1476252828131, 159.02634070885452, 156.078576837823, 176.5394909179953, 159.3669295438774, 158.34170059897735, 169.24690653044678, 158.23247231324515, 160.10673396062165, 150.93804596451594, 164.6438919049456, 163.75650461857927, 174.5426217188352, 176.34637595612477, 172.71637978384504, 164.3301941432867, 140.88113542180662, 122.7314043941761, 184.70015449677788, 177.07326606892715, 135.48168840337658, 170.09134815557175, 172.32242677640838, 119.49866013678016, 168.08854794676228, 173.84522203777874, 177.3171211280727, 166.96705495775774, 171.0658686648307, 180.9651878130412, 170.7733991655183, 155.30498905861955, 173.11693533973673, 166.34973963754857, 160.27936882840993, 183.08528684318253, 173.89991694552086, 177.14766825618702, 164.21855833437465, 156.4836662701097, 148.54574009335587, 159.10316523369656, 164.26573751496292, 179.51596974276973, 142.2851012219715, 177.9489964821209, 165.22753503549617, 173.80392234589283, 178.69440093967498, 151.75928564743674, 185.54157474395612, 176.63961664437923, 151.48430083636907, 116.74177456086275, 160.70802694994242, 138.7012072147695, 167.80228409611647, 161.51419405282806, 170.02791714422605, 167.72995884139965, 170.34545459446693, 179.00604894530505, 172.47367197358943, 172.5039308845792, 173.5845509905402, 168.0734102751071, 163.9884364973071, 92.71857011650876, 176.6243431267241, 146.56100502065246, 155.60303064641042, 150.0642059533632, 137.26979688650246, 164.69864864296488, 132.07121927648154, 136.45555756406847, 132.84602484892844, 181.19733211055492, 153.93898806973195, 159.416243271216, 126.43960049035574, 180.2872671377202, 179.11803820997594, 86.14501866495493, 137.120165279908, 139.13843290656217, 164.30821914794316, 127.62573137381314, 160.17354558716193, 156.84030622425865, 159.3252511060465, 106.8807978324071, 127.67353280123251, 171.26027088830944, 165.43776402999197, 174.57535504554025, 144.09422615218108, 173.8144896467532, 162.74445217376427, 154.5421375918673, 142.54397574039277, 34.46405706022541, 42.48436954164542, 152.65052452243168, 169.41098711622607, 173.2912057339244, 165.53436520874743, -8.401868177712512, 46.44731239442417, 168.28975871029397, 112.45906310075517, 124.54336991711172, 60.600210286755114, 157.57146104262034, 149.56922641773096, -13.329752352225077, 53.15393464416058, 134.01234396036625, 146.6671916097298, 161.93441201677624, 168.81969214490198, 167.7701122655418, 172.14147497667997, 153.35744985120934, 159.277226832965, 156.19723808224265, 163.53749185918048, 136.46265838181665, 123.53708761351191, 64.56974886325669, 47.885815308223606, 149.4441325958543, 168.64787862462484, 139.69667437889316, 148.18888378809618, 156.8922202326047, 160.68338639045248, 136.30933575723472, 172.1056586655468, 139.1079416814459, 171.62633428057924, 61.771593880454716, 61.47965063330479, 103.96388138211383, 125.9563262453597, 140.553772871313, 152.2739911886659, 109.11710465717167, 104.60010910295148, 106.91654194747036, 120.69579516316135, 83.49936356055915, 37.817617236168346, -7.163404294522637, 67.02535772668257, 125.44499346621369, 159.86964276329547, 56.955706071663414, 86.55268602611376, 73.39524508664917, 87.54236063868423, 132.19043291398447, 138.09713015444305, -4.248186457172504, 31.92928882505429, 95.12997207861966, 101.74523435023934, 35.984363188860506, 9.509026619525496, 128.9700605665507, 112.55044726548842, 119.54539481768018, 157.29680304739227], "policy_predator_policy_reward": [18.128659881529686, 27.406808074160626, 39.09937657924722, 30.241163904196796, 34.53368298050065, 44.346291009957945, 60.298125038524425, 53.14869672593032, 66.72535792425477, 28.15975752054675, 51.109508727916364, 25.166160992475824, 21.961435175497755, 31.02492511539899, 42.65968433980247, 54.11332226661707, 42.219209663719724, 44.50638645682372, 41.634458883582916, 78.20905433730445, 32.82435127255063, 41.601263243690724, 34.26866901653604, 42.48639787494308, 45.968700158573064, 50.8372134795537, 29.950882573330375, 28.95852937444572, 30.246460891921238, 56.93450605569751, 30.472039432029618, 37.61891360614714, 32.43630112175771, 42.938173128952194, 28.0128052845012, 37.20620989221441, 34.324398550131384, 41.67453627216818, 30.079033459099136, 21.553443634587822, 24.193899242494197, 18.90292687613569, 40.20472036149046, 50.13317565087508, 41.29673545029406, 25.383309915789777, 57.81371228145184, 43.913545118023144, 24.500959624364704, 25.60502425535303, 55.439590987340345, 61.60748369702464, 20.239136889307407, 20.85687768124914, 23.429267403969003, 27.753487782549055, 27.411351541709816, 16.478486676762117, 28.958598297476943, 34.624064123258606, 30.889096654118052, 29.58812773077542, 15.625600511659451, 15.971021996332983, 17.332823919898825, 28.80241185321429, 36.01239767439151, 35.49011348916963, 18.677031911947005, 13.856784110123515, 34.18894450274118, 42.145031559029945, 29.7279100799866, 25.09590630482305, 26.48119750972415, 17.69766649373692, 47.615547020007, 26.95693571660135, 42.81785630617851, 32.986355582302245, 63.87490310934109, 37.14632165229661, 39.097242403940776, 47.4493633274022, 19.30284743376863, 21.099239307838197, 21.47054057759766, 32.85351637778313, 18.05966541635706, 20.726441209940774, 27.07908213245073, 23.064472116515308, 33.2248912113518, 20.887540551387573, 51.187751071539, 75.3028282620283, 42.63071626130896, 29.041635264559012, 54.44882877225652, 33.50311100827287, 42.32812576088072, 42.130954472611236, 62.363327890762896, 19.788429895992493, 28.236362152115536, 32.657872575130945, 25.99706406620381, 64.84796545011055, 19.549752193782457, 16.822112184551948, 38.35938268881813, 35.270469521220974, 43.522136754503336, 43.14736046946464, 29.255590731556687, 25.886413883340882, 35.78971704533548, 38.52653529869942, 41.07354582652286, 88.08759534049275, 35.20191264652939, 29.131196145468387, 44.922145680739774, 36.188316610678086, 16.710994637987426, 25.084578943204217, 26.369519034518643, 42.86459499439776, 61.7165819295782, 172.80563026537527, 43.34324961458024, 28.803648981354858, 27.04427581432079, 24.223120241103867, 199.63255604351863, 159.19539848476828, 76.25480986418873, 52.55700560560539, 50.579103727007265, 131.15185295502954, 36.986407577244464, 23.64922781758605, 246.57390444532163, 35.66154045730736, 54.83885824065894, 34.66688258243849, 23.75812077213488, 32.40457635519013, 25.679669795057052, 30.898403677637358, 35.7096032567595, 31.455722068372502, 42.71598939197825, 20.786184226873434, 49.110939534329894, 52.212281661799686, 178.4203039062959, 74.90882784054295, 30.90789615816068, 33.35752179418046, 40.512764930476116, 48.50863468736551, 35.831196438731496, 33.588666410494994, 24.65712748379444, 35.02619375980851, 27.980373833928137, 25.798006790444735, 72.79188766708606, 154.52727629987962, 94.97841345259882, 26.901833127672113, 48.277208383438236, 22.74061767396194, 39.95077313515179, 112.32384235681451, 106.21923742631034, 32.10243854052507, 149.11153697608316, 32.002778499991535, 25.71009465823853, 228.7042008694111, 58.77817796440013, 38.96170756508288, 150.46998869941686, 56.77174892620905, 67.6247045412564, 99.85774558454611, 58.120905356830875, 39.09169347186139, 237.6395110166659, 59.24351780639275, 105.12213073886853, 65.69544117573388, 226.0623889646001, 29.84494434488913, 29.815077510771566, 83.75315576760103, 50.5417509134844, 32.34166077025574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6208660639354482, "mean_inference_ms": 1.9509418701677774, "mean_action_processing_ms": 0.25820928132211884, "mean_env_wait_ms": 0.23700676375752242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004197120666503906, "StateBufferConnector_ms": 0.0035638809204101562, "ViewRequirementAgentConnector_ms": 0.1105426549911499}, "num_episodes": 23, "episode_return_max": 416.8592270771812, "episode_return_min": 296.8950361549021, "episode_return_mean": 376.92144743298394, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.9806742163708, "num_env_steps_trained_throughput_per_sec": 353.9806742163708, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 10919.675, "restore_workers_time_ms": 0.013, "training_step_time_ms": 10919.616, "sample_time_ms": 1468.3, "learn_time_ms": 9432.682, "learn_throughput": 424.058, "synch_weights_time_ms": 16.746}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "e552a_00000", "date": "2024-08-16_09-00-58", "timestamp": 1723779058, "time_this_iter_s": 11.373857021331787, "time_total_s": 866.9792776107788, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20cd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 866.9792776107788, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 42.8, "ram_util_percent": 83.2125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.796189286090709, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.402888759481844, "policy_loss": -0.007986819787966039, "vf_loss": 8.409829123562606, "vf_explained_var": 0.06761875001211015, "kl": 0.00620123275240887, "entropy": 0.6055401258683079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2620395197439445, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.356991135127961, "policy_loss": -0.0028486102868719074, "vf_loss": 9.359205620377152, "vf_explained_var": 0.017384090404661875, "kl": 0.00845514249209609, "entropy": 1.344536992418703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 414.28221187177905, "episode_reward_min": 296.8950361549021, "episode_reward_mean": 372.391604930765, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -80.91093231798821, "predator_policy": 13.856784110123515}, "policy_reward_max": {"prey_policy": 185.54157474395612, "predator_policy": 246.57390444532163}, "policy_reward_mean": {"prey_policy": 123.88855033253398, "predator_policy": 62.307252132848504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.58087269176093, 389.931603431101, 392.1595818585996, 395.54922557745897, 374.11160425703787, 414.28221187177905, 392.51975881169795, 404.6342827679076, 392.25835773640796, 389.21567880910663, 395.6284251970312, 392.00458681909157, 387.10633285085214, 388.5818262966956, 387.50146236367436, 376.5319175270263, 355.90271877073, 398.13504702651227, 398.00034790242677, 396.6771872890286, 411.8733431280012, 403.92812936922905, 378.47102627244277, 393.0500970422288, 371.9441979386611, 392.3994703912474, 390.26582754519217, 396.23203612408554, 386.1742785351536, 395.83349257680004, 373.83638719293094, 375.2859426203951, 381.2289481529385, 351.45334019975223, 396.03055490753326, 376.70087327788616, 395.77716972603037, 296.8950361549021, 390.11614927847324, 342.94128157587244, 390.4818096743402, 363.71547180065556, 401.03114371029915, 399.7800434891391, 378.35451540170914, 366.32022736117636, 311.4706387968239, 394.208410234593, 390.09296699809636, 396.87339874499827, 409.5606372808429, 366.87453688590347, 367.7763228551814, 322.0596271945645, 370.18527639319325, 386.9168012890032, 396.48966071491634, 379.80000200930635, 383.23690356027487, 361.3229671914574, 365.7846959183195, 382.35742917282, 376.906957784831, 386.99546947228333, 368.0983156663845, 364.51265658639807, 350.5704084807246, 351.8004542077443, 363.8455901173791, 365.99182925208976, 365.9340130774674, 302.4312962728021, 314.2762489598096, 383.0545217589919, 350.75012972340295, 328.42005585113566, 367.5001618971199, 324.56413119094145, 367.6927783434613, 301.4007231178755, 355.08874111041183, 359.72560954881266, 359.28061733832834, 373.3897061980369, 347.6145219094652, 327.1098877174609, 366.6759438013994, 337.0430935715643, 389.8720008520453, 348.20621505939346, 353.79000520175686, 353.91836403869195, 395.35849278785986, 386.9080350373209, 361.5080901895668, 349.77414833631, 376.96939214287426, 383.28964031071575, 356.0792118273926, 325.36893579295287], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [150.93804596451594, 164.6438919049456, 163.75650461857927, 174.5426217188352, 176.34637595612477, 172.71637978384504, 164.3301941432867, 140.88113542180662, 122.7314043941761, 184.70015449677788, 177.07326606892715, 135.48168840337658, 170.09134815557175, 172.32242677640838, 119.49866013678016, 168.08854794676228, 173.84522203777874, 177.3171211280727, 166.96705495775774, 171.0658686648307, 180.9651878130412, 170.7733991655183, 155.30498905861955, 173.11693533973673, 166.34973963754857, 160.27936882840993, 183.08528684318253, 173.89991694552086, 177.14766825618702, 164.21855833437465, 156.4836662701097, 148.54574009335587, 159.10316523369656, 164.26573751496292, 179.51596974276973, 142.2851012219715, 177.9489964821209, 165.22753503549617, 173.80392234589283, 178.69440093967498, 151.75928564743674, 185.54157474395612, 176.63961664437923, 151.48430083636907, 116.74177456086275, 160.70802694994242, 138.7012072147695, 167.80228409611647, 161.51419405282806, 170.02791714422605, 167.72995884139965, 170.34545459446693, 179.00604894530505, 172.47367197358943, 172.5039308845792, 173.5845509905402, 168.0734102751071, 163.9884364973071, 92.71857011650876, 176.6243431267241, 146.56100502065246, 155.60303064641042, 150.0642059533632, 137.26979688650246, 164.69864864296488, 132.07121927648154, 136.45555756406847, 132.84602484892844, 181.19733211055492, 153.93898806973195, 159.416243271216, 126.43960049035574, 180.2872671377202, 179.11803820997594, 86.14501866495493, 137.120165279908, 139.13843290656217, 164.30821914794316, 127.62573137381314, 160.17354558716193, 156.84030622425865, 159.3252511060465, 106.8807978324071, 127.67353280123251, 171.26027088830944, 165.43776402999197, 174.57535504554025, 144.09422615218108, 173.8144896467532, 162.74445217376427, 154.5421375918673, 142.54397574039277, 34.46405706022541, 42.48436954164542, 152.65052452243168, 169.41098711622607, 173.2912057339244, 165.53436520874743, -8.401868177712512, 46.44731239442417, 168.28975871029397, 112.45906310075517, 124.54336991711172, 60.600210286755114, 157.57146104262034, 149.56922641773096, -13.329752352225077, 53.15393464416058, 134.01234396036625, 146.6671916097298, 161.93441201677624, 168.81969214490198, 167.7701122655418, 172.14147497667997, 153.35744985120934, 159.277226832965, 156.19723808224265, 163.53749185918048, 136.46265838181665, 123.53708761351191, 64.56974886325669, 47.885815308223606, 149.4441325958543, 168.64787862462484, 139.69667437889316, 148.18888378809618, 156.8922202326047, 160.68338639045248, 136.30933575723472, 172.1056586655468, 139.1079416814459, 171.62633428057924, 61.771593880454716, 61.47965063330479, 103.96388138211383, 125.9563262453597, 140.553772871313, 152.2739911886659, 109.11710465717167, 104.60010910295148, 106.91654194747036, 120.69579516316135, 83.49936356055915, 37.817617236168346, -7.163404294522637, 67.02535772668257, 125.44499346621369, 159.86964276329547, 56.955706071663414, 86.55268602611376, 73.39524508664917, 87.54236063868423, 132.19043291398447, 138.09713015444305, -4.248186457172504, 31.92928882505429, 95.12997207861966, 101.74523435023934, 35.984363188860506, 9.509026619525496, 128.9700605665507, 112.55044726548842, 119.54539481768018, 157.29680304739227, 98.29633112976308, 126.03889857608182, 9.664208824746137, 51.31086455273545, 68.95813274427951, 35.701690466591494, 52.38796379166181, 43.403034747236, 98.77324207069861, 125.20762903618399, 8.26765994500273, -80.91093231798821, 132.02906706337274, 110.38313232791297, -13.310002210112932, 43.63470600201011, 71.36548436777258, 49.01879985695348, 26.687519955388158, 75.53108467342885, 84.01046562472771, 48.28819589744542, 80.40376622785466, 72.86952861364644, 41.23264791682882, 46.97340320598556, 39.77486517787966, 12.074959310332297, 131.81266614207232, 152.5350652568448, 35.913779561067464, 14.756210246014675, 92.5802310710909, 107.65115451147982, 45.475520789787666, 27.807787057253076], "policy_predator_policy_reward": [34.324398550131384, 41.67453627216818, 30.079033459099136, 21.553443634587822, 24.193899242494197, 18.90292687613569, 40.20472036149046, 50.13317565087508, 41.29673545029406, 25.383309915789777, 57.81371228145184, 43.913545118023144, 24.500959624364704, 25.60502425535303, 55.439590987340345, 61.60748369702464, 20.239136889307407, 20.85687768124914, 23.429267403969003, 27.753487782549055, 27.411351541709816, 16.478486676762117, 28.958598297476943, 34.624064123258606, 30.889096654118052, 29.58812773077542, 15.625600511659451, 15.971021996332983, 17.332823919898825, 28.80241185321429, 36.01239767439151, 35.49011348916963, 18.677031911947005, 13.856784110123515, 34.18894450274118, 42.145031559029945, 29.7279100799866, 25.09590630482305, 26.48119750972415, 17.69766649373692, 47.615547020007, 26.95693571660135, 42.81785630617851, 32.986355582302245, 63.87490310934109, 37.14632165229661, 39.097242403940776, 47.4493633274022, 19.30284743376863, 21.099239307838197, 21.47054057759766, 32.85351637778313, 18.05966541635706, 20.726441209940774, 27.07908213245073, 23.064472116515308, 33.2248912113518, 20.887540551387573, 51.187751071539, 75.3028282620283, 42.63071626130896, 29.041635264559012, 54.44882877225652, 33.50311100827287, 42.32812576088072, 42.130954472611236, 62.363327890762896, 19.788429895992493, 28.236362152115536, 32.657872575130945, 25.99706406620381, 64.84796545011055, 19.549752193782457, 16.822112184551948, 38.35938268881813, 35.270469521220974, 43.522136754503336, 43.14736046946464, 29.255590731556687, 25.886413883340882, 35.78971704533548, 38.52653529869942, 41.07354582652286, 88.08759534049275, 35.20191264652939, 29.131196145468387, 44.922145680739774, 36.188316610678086, 16.710994637987426, 25.084578943204217, 26.369519034518643, 42.86459499439776, 61.7165819295782, 172.80563026537527, 43.34324961458024, 28.803648981354858, 27.04427581432079, 24.223120241103867, 199.63255604351863, 159.19539848476828, 76.25480986418873, 52.55700560560539, 50.579103727007265, 131.15185295502954, 36.986407577244464, 23.64922781758605, 246.57390444532163, 35.66154045730736, 54.83885824065894, 34.66688258243849, 23.75812077213488, 32.40457635519013, 25.679669795057052, 30.898403677637358, 35.7096032567595, 31.455722068372502, 42.71598939197825, 20.786184226873434, 49.110939534329894, 52.212281661799686, 178.4203039062959, 74.90882784054295, 30.90789615816068, 33.35752179418046, 40.512764930476116, 48.50863468736551, 35.831196438731496, 33.588666410494994, 24.65712748379444, 35.02619375980851, 27.980373833928137, 25.798006790444735, 72.79188766708606, 154.52727629987962, 94.97841345259882, 26.901833127672113, 48.277208383438236, 22.74061767396194, 39.95077313515179, 112.32384235681451, 106.21923742631034, 32.10243854052507, 149.11153697608316, 32.002778499991535, 25.71009465823853, 228.7042008694111, 58.77817796440013, 38.96170756508288, 150.46998869941686, 56.77174892620905, 67.6247045412564, 99.85774558454611, 58.120905356830875, 39.09169347186139, 237.6395110166659, 59.24351780639275, 105.12213073886853, 65.69544117573388, 226.0623889646001, 29.84494434488913, 29.815077510771566, 83.75315576760103, 50.5417509134844, 32.34166077025574, 52.275812787799715, 82.66957484468402, 152.33729469965638, 160.0773381208989, 196.35344393467264, 46.601254763920856, 151.2102646875001, 80.10862449106283, 57.23940266596711, 85.45567002854949, 218.57629085796822, 191.11007508658142, 57.85680309527577, 89.60299836548344, 95.52037321889138, 222.36113804860477, 181.88812765973753, 51.51759331729251, 66.6911649362552, 185.00859447361967, 122.54032392813208, 140.51950733755424, 127.51071222672007, 106.12402796909966, 185.71788566769004, 87.58415339906195, 229.16285815115899, 68.76146569693903, 38.47847780004585, 54.143182943911526, 188.34857583382674, 144.2710746698069, 98.46700231032521, 57.38082393449651, 180.32749690363752, 71.75813104227429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6228157349067078, "mean_inference_ms": 1.958002989508796, "mean_action_processing_ms": 0.25898881731427553, "mean_env_wait_ms": 0.23786030871404443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005008578300476074, "StateBufferConnector_ms": 0.004221558570861816, "ViewRequirementAgentConnector_ms": 0.12681782245635986}, "num_episodes": 18, "episode_return_max": 414.28221187177905, "episode_return_min": 296.8950361549021, "episode_return_mean": 372.391604930765, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.77507688860786, "num_env_steps_trained_throughput_per_sec": 253.77507688860786, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 11454.543, "restore_workers_time_ms": 0.014, "training_step_time_ms": 11454.483, "sample_time_ms": 1623.419, "learn_time_ms": 9812.106, "learn_throughput": 407.66, "synch_weights_time_ms": 16.945}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "e552a_00000", "date": "2024-08-16_09-01-14", "timestamp": 1723779074, "time_this_iter_s": 15.815069913864136, "time_total_s": 882.794347524643, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c11f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 882.794347524643, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 78.65217391304348, "ram_util_percent": 83.35652173913043}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1012877875061893, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35805954907937, "policy_loss": -0.004298819817119727, "vf_loss": 9.36134174235914, "vf_explained_var": 0.0029506463222402743, "kl": 0.00602453126209422, "entropy": 0.5326903507034615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6994279380513246, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.518571814784297, "policy_loss": -0.004383585174572925, "vf_loss": 9.522187255677723, "vf_explained_var": 0.00841706256387095, "kl": 0.010241815991948849, "entropy": 1.3583653239346054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 608.5047667542789, "episode_reward_min": 294.49622467564615, "episode_reward_mean": 372.9798194318309, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.28762998555624, "predator_policy": 16.710994637987426}, "policy_reward_max": {"prey_policy": 181.19733211055492, "predator_policy": 440.7761603098653}, "policy_reward_mean": {"prey_policy": 93.64571604725059, "predator_policy": 92.84419366866489}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.47102627244277, 393.0500970422288, 371.9441979386611, 392.3994703912474, 390.26582754519217, 396.23203612408554, 386.1742785351536, 395.83349257680004, 373.83638719293094, 375.2859426203951, 381.2289481529385, 351.45334019975223, 396.03055490753326, 376.70087327788616, 395.77716972603037, 296.8950361549021, 390.11614927847324, 342.94128157587244, 390.4818096743402, 363.71547180065556, 401.03114371029915, 399.7800434891391, 378.35451540170914, 366.32022736117636, 311.4706387968239, 394.208410234593, 390.09296699809636, 396.87339874499827, 409.5606372808429, 366.87453688590347, 367.7763228551814, 322.0596271945645, 370.18527639319325, 386.9168012890032, 396.48966071491634, 379.80000200930635, 383.23690356027487, 361.3229671914574, 365.7846959183195, 382.35742917282, 376.906957784831, 386.99546947228333, 368.0983156663845, 364.51265658639807, 350.5704084807246, 351.8004542077443, 363.8455901173791, 365.99182925208976, 365.9340130774674, 302.4312962728021, 314.2762489598096, 383.0545217589919, 350.75012972340295, 328.42005585113566, 367.5001618971199, 324.56413119094145, 367.6927783434613, 301.4007231178755, 355.08874111041183, 359.72560954881266, 359.28061733832834, 373.3897061980369, 347.6145219094652, 327.1098877174609, 366.6759438013994, 337.0430935715643, 389.8720008520453, 348.20621505939346, 353.79000520175686, 353.91836403869195, 395.35849278785986, 386.9080350373209, 361.5080901895668, 349.77414833631, 376.96939214287426, 383.28964031071575, 356.0792118273926, 325.36893579295287, 387.403457825009, 337.368113695636, 351.29368687532434, 392.9162095362186, 375.18796374185985, 385.6707643379253, 294.49622467564615, 608.5047667542789, 387.2396683001021, 454.04223036118213, 445.7564809090247, 413.65965056051226, 330.75612579346387, 370.9499525102055, 414.928296370855, 388.261827773309, 399.70925952691175, 395.6303033776451, 344.71818389609916, 397.4467912110776, 389.46600530299264, 421.52998912447316], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [116.74177456086275, 160.70802694994242, 138.7012072147695, 167.80228409611647, 161.51419405282806, 170.02791714422605, 167.72995884139965, 170.34545459446693, 179.00604894530505, 172.47367197358943, 172.5039308845792, 173.5845509905402, 168.0734102751071, 163.9884364973071, 92.71857011650876, 176.6243431267241, 146.56100502065246, 155.60303064641042, 150.0642059533632, 137.26979688650246, 164.69864864296488, 132.07121927648154, 136.45555756406847, 132.84602484892844, 181.19733211055492, 153.93898806973195, 159.416243271216, 126.43960049035574, 180.2872671377202, 179.11803820997594, 86.14501866495493, 137.120165279908, 139.13843290656217, 164.30821914794316, 127.62573137381314, 160.17354558716193, 156.84030622425865, 159.3252511060465, 106.8807978324071, 127.67353280123251, 171.26027088830944, 165.43776402999197, 174.57535504554025, 144.09422615218108, 173.8144896467532, 162.74445217376427, 154.5421375918673, 142.54397574039277, 34.46405706022541, 42.48436954164542, 152.65052452243168, 169.41098711622607, 173.2912057339244, 165.53436520874743, -8.401868177712512, 46.44731239442417, 168.28975871029397, 112.45906310075517, 124.54336991711172, 60.600210286755114, 157.57146104262034, 149.56922641773096, -13.329752352225077, 53.15393464416058, 134.01234396036625, 146.6671916097298, 161.93441201677624, 168.81969214490198, 167.7701122655418, 172.14147497667997, 153.35744985120934, 159.277226832965, 156.19723808224265, 163.53749185918048, 136.46265838181665, 123.53708761351191, 64.56974886325669, 47.885815308223606, 149.4441325958543, 168.64787862462484, 139.69667437889316, 148.18888378809618, 156.8922202326047, 160.68338639045248, 136.30933575723472, 172.1056586655468, 139.1079416814459, 171.62633428057924, 61.771593880454716, 61.47965063330479, 103.96388138211383, 125.9563262453597, 140.553772871313, 152.2739911886659, 109.11710465717167, 104.60010910295148, 106.91654194747036, 120.69579516316135, 83.49936356055915, 37.817617236168346, -7.163404294522637, 67.02535772668257, 125.44499346621369, 159.86964276329547, 56.955706071663414, 86.55268602611376, 73.39524508664917, 87.54236063868423, 132.19043291398447, 138.09713015444305, -4.248186457172504, 31.92928882505429, 95.12997207861966, 101.74523435023934, 35.984363188860506, 9.509026619525496, 128.9700605665507, 112.55044726548842, 119.54539481768018, 157.29680304739227, 98.29633112976308, 126.03889857608182, 9.664208824746137, 51.31086455273545, 68.95813274427951, 35.701690466591494, 52.38796379166181, 43.403034747236, 98.77324207069861, 125.20762903618399, 8.26765994500273, -80.91093231798821, 132.02906706337274, 110.38313232791297, -13.310002210112932, 43.63470600201011, 71.36548436777258, 49.01879985695348, 26.687519955388158, 75.53108467342885, 84.01046562472771, 48.28819589744542, 80.40376622785466, 72.86952861364644, 41.23264791682882, 46.97340320598556, 39.77486517787966, 12.074959310332297, 131.81266614207232, 152.5350652568448, 35.913779561067464, 14.756210246014675, 92.5802310710909, 107.65115451147982, 45.475520789787666, 27.807787057253076, 47.97376000663251, 47.01872992125842, 7.419389296095478, -2.7771799630815464, 24.590226645937108, 1.7471800184944093, 35.7688207595366, 59.934592003505266, 15.630295947694561, -21.79422518742605, 40.81974327210955, 102.40951869185196, 28.325407362389292, 28.273334859879835, -297.28762998555624, 51.15004804457541, -81.0892579765047, 36.55281978603078, 40.65588648375784, -8.776894422241908, 19.028387414477976, 12.164532637434077, 50.83705106777502, 92.77954186940056, -1.3610847033857745, 45.787143507652985, 45.450834916808326, 73.3178580851619, 59.7379495153344, 34.77757184787383, 18.602283341949523, 13.551824711386043, 11.871600949750839, 44.35734544298285, 72.58384050821222, 37.49058867311719, 86.31021565815234, 117.34111153610057, 37.80374442990929, 5.677358782973949, 59.32084766667185, 77.94595429220547, 33.52340986450078, 9.766641015427266], "policy_predator_policy_reward": [63.87490310934109, 37.14632165229661, 39.097242403940776, 47.4493633274022, 19.30284743376863, 21.099239307838197, 21.47054057759766, 32.85351637778313, 18.05966541635706, 20.726441209940774, 27.07908213245073, 23.064472116515308, 33.2248912113518, 20.887540551387573, 51.187751071539, 75.3028282620283, 42.63071626130896, 29.041635264559012, 54.44882877225652, 33.50311100827287, 42.32812576088072, 42.130954472611236, 62.363327890762896, 19.788429895992493, 28.236362152115536, 32.657872575130945, 25.99706406620381, 64.84796545011055, 19.549752193782457, 16.822112184551948, 38.35938268881813, 35.270469521220974, 43.522136754503336, 43.14736046946464, 29.255590731556687, 25.886413883340882, 35.78971704533548, 38.52653529869942, 41.07354582652286, 88.08759534049275, 35.20191264652939, 29.131196145468387, 44.922145680739774, 36.188316610678086, 16.710994637987426, 25.084578943204217, 26.369519034518643, 42.86459499439776, 61.7165819295782, 172.80563026537527, 43.34324961458024, 28.803648981354858, 27.04427581432079, 24.223120241103867, 199.63255604351863, 159.19539848476828, 76.25480986418873, 52.55700560560539, 50.579103727007265, 131.15185295502954, 36.986407577244464, 23.64922781758605, 246.57390444532163, 35.66154045730736, 54.83885824065894, 34.66688258243849, 23.75812077213488, 32.40457635519013, 25.679669795057052, 30.898403677637358, 35.7096032567595, 31.455722068372502, 42.71598939197825, 20.786184226873434, 49.110939534329894, 52.212281661799686, 178.4203039062959, 74.90882784054295, 30.90789615816068, 33.35752179418046, 40.512764930476116, 48.50863468736551, 35.831196438731496, 33.588666410494994, 24.65712748379444, 35.02619375980851, 27.980373833928137, 25.798006790444735, 72.79188766708606, 154.52727629987962, 94.97841345259882, 26.901833127672113, 48.277208383438236, 22.74061767396194, 39.95077313515179, 112.32384235681451, 106.21923742631034, 32.10243854052507, 149.11153697608316, 32.002778499991535, 25.71009465823853, 228.7042008694111, 58.77817796440013, 38.96170756508288, 150.46998869941686, 56.77174892620905, 67.6247045412564, 99.85774558454611, 58.120905356830875, 39.09169347186139, 237.6395110166659, 59.24351780639275, 105.12213073886853, 65.69544117573388, 226.0623889646001, 29.84494434488913, 29.815077510771566, 83.75315576760103, 50.5417509134844, 32.34166077025574, 52.275812787799715, 82.66957484468402, 152.33729469965638, 160.0773381208989, 196.35344393467264, 46.601254763920856, 151.2102646875001, 80.10862449106283, 57.23940266596711, 85.45567002854949, 218.57629085796822, 191.11007508658142, 57.85680309527577, 89.60299836548344, 95.52037321889138, 222.36113804860477, 181.88812765973753, 51.51759331729251, 66.6911649362552, 185.00859447361967, 122.54032392813208, 140.51950733755424, 127.51071222672007, 106.12402796909966, 185.71788566769004, 87.58415339906195, 229.16285815115899, 68.76146569693903, 38.47847780004585, 54.143182943911526, 188.34857583382674, 144.2710746698069, 98.46700231032521, 57.38082393449651, 180.32749690363752, 71.75813104227429, 135.37084148739712, 157.0401264097212, 240.5929724589003, 92.13293190372104, 181.30637476879792, 143.64990544209522, 171.84069179700472, 125.37210497617181, 187.1474920402094, 194.20440094138144, 127.15829233746081, 115.2832100365028, 29.127482940721947, 208.7699995126548, 440.7761603098653, 413.86618838539374, 259.1989852595352, 172.57712123104147, 203.1537460733959, 219.0094922262711, 216.27838793656696, 198.2851729205447, 144.11203880004328, 125.9310188232937, 175.44025195125997, 110.8898150379372, 72.66853844939412, 179.51272105884087, 196.91711051916997, 123.49566448847764, 203.2787718913529, 152.82894782862093, 207.09469282706934, 136.3856203071089, 164.42786875133328, 121.12800544498234, 102.58105565929198, 38.48580104255351, 189.72380080507995, 164.24188719311402, 99.62407060299279, 152.5751327411228, 199.3316434562179, 178.90829478832734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6266766090989823, "mean_inference_ms": 1.9730380394954654, "mean_action_processing_ms": 0.26042915903324154, "mean_env_wait_ms": 0.23960862481839995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005209684371948242, "StateBufferConnector_ms": 0.004048466682434082, "ViewRequirementAgentConnector_ms": 0.1321183443069458}, "num_episodes": 22, "episode_return_max": 608.5047667542789, "episode_return_min": 294.49622467564615, "episode_return_mean": 372.9798194318309, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.9122637629753, "num_env_steps_trained_throughput_per_sec": 290.9122637629753, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 11773.538, "restore_workers_time_ms": 0.015, "training_step_time_ms": 11773.473, "sample_time_ms": 1796.355, "learn_time_ms": 9954.88, "learn_throughput": 401.813, "synch_weights_time_ms": 19.824}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "e552a_00000", "date": "2024-08-16_09-01-28", "timestamp": 1723779088, "time_this_iter_s": 13.831647157669067, "time_total_s": 896.625994682312, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20cd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 896.625994682312, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 62.735, "ram_util_percent": 84.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.198895654381898, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.242101262612318, "policy_loss": -0.002716709839219533, "vf_loss": 9.24385450857657, "vf_explained_var": -0.14115050107082994, "kl": 0.005709330973443255, "entropy": 0.49613186739109183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.345027412750103, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.151911503928048, "policy_loss": -0.007794066980510714, "vf_loss": 9.158600557922686, "vf_explained_var": 0.05415323707792494, "kl": 0.01473304560107137, "entropy": 1.3134337557055962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 608.5047667542789, "episode_reward_min": 294.49622467564615, "episode_reward_mean": 375.4019524116531, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.28762998555624, "predator_policy": 16.710994637987426}, "policy_reward_max": {"prey_policy": 174.57535504554025, "predator_policy": 440.7761603098653}, "policy_reward_mean": {"prey_policy": 73.6897202360544, "predator_policy": 114.01125596977214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.4818096743402, 363.71547180065556, 401.03114371029915, 399.7800434891391, 378.35451540170914, 366.32022736117636, 311.4706387968239, 394.208410234593, 390.09296699809636, 396.87339874499827, 409.5606372808429, 366.87453688590347, 367.7763228551814, 322.0596271945645, 370.18527639319325, 386.9168012890032, 396.48966071491634, 379.80000200930635, 383.23690356027487, 361.3229671914574, 365.7846959183195, 382.35742917282, 376.906957784831, 386.99546947228333, 368.0983156663845, 364.51265658639807, 350.5704084807246, 351.8004542077443, 363.8455901173791, 365.99182925208976, 365.9340130774674, 302.4312962728021, 314.2762489598096, 383.0545217589919, 350.75012972340295, 328.42005585113566, 367.5001618971199, 324.56413119094145, 367.6927783434613, 301.4007231178755, 355.08874111041183, 359.72560954881266, 359.28061733832834, 373.3897061980369, 347.6145219094652, 327.1098877174609, 366.6759438013994, 337.0430935715643, 389.8720008520453, 348.20621505939346, 353.79000520175686, 353.91836403869195, 395.35849278785986, 386.9080350373209, 361.5080901895668, 349.77414833631, 376.96939214287426, 383.28964031071575, 356.0792118273926, 325.36893579295287, 387.403457825009, 337.368113695636, 351.29368687532434, 392.9162095362186, 375.18796374185985, 385.6707643379253, 294.49622467564615, 608.5047667542789, 387.2396683001021, 454.04223036118213, 445.7564809090247, 413.65965056051226, 330.75612579346387, 370.9499525102055, 414.928296370855, 388.261827773309, 399.70925952691175, 395.6303033776451, 344.71818389609916, 397.4467912110776, 389.46600530299264, 421.52998912447316, 408.8328751180815, 349.53568853210976, 389.6729936670341, 419.67037135149616, 417.45682063464716, 392.1001372157913, 365.351656715784, 407.08495465612907, 377.53831983358924, 326.2023147783461, 365.20191253828636, 433.9813182937276, 394.0901682845115, 397.12089551325414, 362.95226522262885, 402.7627679619388, 406.44410391767707, 410.8498432597133], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.84030622425865, 159.3252511060465, 106.8807978324071, 127.67353280123251, 171.26027088830944, 165.43776402999197, 174.57535504554025, 144.09422615218108, 173.8144896467532, 162.74445217376427, 154.5421375918673, 142.54397574039277, 34.46405706022541, 42.48436954164542, 152.65052452243168, 169.41098711622607, 173.2912057339244, 165.53436520874743, -8.401868177712512, 46.44731239442417, 168.28975871029397, 112.45906310075517, 124.54336991711172, 60.600210286755114, 157.57146104262034, 149.56922641773096, -13.329752352225077, 53.15393464416058, 134.01234396036625, 146.6671916097298, 161.93441201677624, 168.81969214490198, 167.7701122655418, 172.14147497667997, 153.35744985120934, 159.277226832965, 156.19723808224265, 163.53749185918048, 136.46265838181665, 123.53708761351191, 64.56974886325669, 47.885815308223606, 149.4441325958543, 168.64787862462484, 139.69667437889316, 148.18888378809618, 156.8922202326047, 160.68338639045248, 136.30933575723472, 172.1056586655468, 139.1079416814459, 171.62633428057924, 61.771593880454716, 61.47965063330479, 103.96388138211383, 125.9563262453597, 140.553772871313, 152.2739911886659, 109.11710465717167, 104.60010910295148, 106.91654194747036, 120.69579516316135, 83.49936356055915, 37.817617236168346, -7.163404294522637, 67.02535772668257, 125.44499346621369, 159.86964276329547, 56.955706071663414, 86.55268602611376, 73.39524508664917, 87.54236063868423, 132.19043291398447, 138.09713015444305, -4.248186457172504, 31.92928882505429, 95.12997207861966, 101.74523435023934, 35.984363188860506, 9.509026619525496, 128.9700605665507, 112.55044726548842, 119.54539481768018, 157.29680304739227, 98.29633112976308, 126.03889857608182, 9.664208824746137, 51.31086455273545, 68.95813274427951, 35.701690466591494, 52.38796379166181, 43.403034747236, 98.77324207069861, 125.20762903618399, 8.26765994500273, -80.91093231798821, 132.02906706337274, 110.38313232791297, -13.310002210112932, 43.63470600201011, 71.36548436777258, 49.01879985695348, 26.687519955388158, 75.53108467342885, 84.01046562472771, 48.28819589744542, 80.40376622785466, 72.86952861364644, 41.23264791682882, 46.97340320598556, 39.77486517787966, 12.074959310332297, 131.81266614207232, 152.5350652568448, 35.913779561067464, 14.756210246014675, 92.5802310710909, 107.65115451147982, 45.475520789787666, 27.807787057253076, 47.97376000663251, 47.01872992125842, 7.419389296095478, -2.7771799630815464, 24.590226645937108, 1.7471800184944093, 35.7688207595366, 59.934592003505266, 15.630295947694561, -21.79422518742605, 40.81974327210955, 102.40951869185196, 28.325407362389292, 28.273334859879835, -297.28762998555624, 51.15004804457541, -81.0892579765047, 36.55281978603078, 40.65588648375784, -8.776894422241908, 19.028387414477976, 12.164532637434077, 50.83705106777502, 92.77954186940056, -1.3610847033857745, 45.787143507652985, 45.450834916808326, 73.3178580851619, 59.7379495153344, 34.77757184787383, 18.602283341949523, 13.551824711386043, 11.871600949750839, 44.35734544298285, 72.58384050821222, 37.49058867311719, 86.31021565815234, 117.34111153610057, 37.80374442990929, 5.677358782973949, 59.32084766667185, 77.94595429220547, 33.52340986450078, 9.766641015427266, 28.97135011122895, 60.66675978418079, 98.32873303960996, -41.06409420779029, 33.330498275931284, -19.68957597451156, 63.627264567168986, 49.045099305478935, 69.87447203676518, 43.302453953804296, 54.39895335800085, 66.47662436116477, 31.007782968305285, 63.66251733252271, 15.565430138188992, 59.85314980714167, 28.839218171804177, 44.61485639013839, 5.703014973546266, -12.888515807252798, -4.504022403042011, 41.275664179538865, 87.1092500279541, 58.214250972930735, 27.206781062019136, 18.423336820777607, 70.79357138067789, 40.33123329906113, 50.26951446873482, 61.05583104167932, 67.40293167134065, 50.271198083298586, 31.822955586185667, 7.743838177691787, 85.52654671042357, 75.25381544960656], "policy_predator_policy_reward": [35.78971704533548, 38.52653529869942, 41.07354582652286, 88.08759534049275, 35.20191264652939, 29.131196145468387, 44.922145680739774, 36.188316610678086, 16.710994637987426, 25.084578943204217, 26.369519034518643, 42.86459499439776, 61.7165819295782, 172.80563026537527, 43.34324961458024, 28.803648981354858, 27.04427581432079, 24.223120241103867, 199.63255604351863, 159.19539848476828, 76.25480986418873, 52.55700560560539, 50.579103727007265, 131.15185295502954, 36.986407577244464, 23.64922781758605, 246.57390444532163, 35.66154045730736, 54.83885824065894, 34.66688258243849, 23.75812077213488, 32.40457635519013, 25.679669795057052, 30.898403677637358, 35.7096032567595, 31.455722068372502, 42.71598939197825, 20.786184226873434, 49.110939534329894, 52.212281661799686, 178.4203039062959, 74.90882784054295, 30.90789615816068, 33.35752179418046, 40.512764930476116, 48.50863468736551, 35.831196438731496, 33.588666410494994, 24.65712748379444, 35.02619375980851, 27.980373833928137, 25.798006790444735, 72.79188766708606, 154.52727629987962, 94.97841345259882, 26.901833127672113, 48.277208383438236, 22.74061767396194, 39.95077313515179, 112.32384235681451, 106.21923742631034, 32.10243854052507, 149.11153697608316, 32.002778499991535, 25.71009465823853, 228.7042008694111, 58.77817796440013, 38.96170756508288, 150.46998869941686, 56.77174892620905, 67.6247045412564, 99.85774558454611, 58.120905356830875, 39.09169347186139, 237.6395110166659, 59.24351780639275, 105.12213073886853, 65.69544117573388, 226.0623889646001, 29.84494434488913, 29.815077510771566, 83.75315576760103, 50.5417509134844, 32.34166077025574, 52.275812787799715, 82.66957484468402, 152.33729469965638, 160.0773381208989, 196.35344393467264, 46.601254763920856, 151.2102646875001, 80.10862449106283, 57.23940266596711, 85.45567002854949, 218.57629085796822, 191.11007508658142, 57.85680309527577, 89.60299836548344, 95.52037321889138, 222.36113804860477, 181.88812765973753, 51.51759331729251, 66.6911649362552, 185.00859447361967, 122.54032392813208, 140.51950733755424, 127.51071222672007, 106.12402796909966, 185.71788566769004, 87.58415339906195, 229.16285815115899, 68.76146569693903, 38.47847780004585, 54.143182943911526, 188.34857583382674, 144.2710746698069, 98.46700231032521, 57.38082393449651, 180.32749690363752, 71.75813104227429, 135.37084148739712, 157.0401264097212, 240.5929724589003, 92.13293190372104, 181.30637476879792, 143.64990544209522, 171.84069179700472, 125.37210497617181, 187.1474920402094, 194.20440094138144, 127.15829233746081, 115.2832100365028, 29.127482940721947, 208.7699995126548, 440.7761603098653, 413.86618838539374, 259.1989852595352, 172.57712123104147, 203.1537460733959, 219.0094922262711, 216.27838793656696, 198.2851729205447, 144.11203880004328, 125.9310188232937, 175.44025195125997, 110.8898150379372, 72.66853844939412, 179.51272105884087, 196.91711051916997, 123.49566448847764, 203.2787718913529, 152.82894782862093, 207.09469282706934, 136.3856203071089, 164.42786875133328, 121.12800544498234, 102.58105565929198, 38.48580104255351, 189.72380080507995, 164.24188719311402, 99.62407060299279, 152.5751327411228, 199.3316434562179, 178.90829478832734, 173.27510356977004, 145.91966165290242, 198.89987068089079, 93.37117901939928, 180.89378172934465, 195.13828963626986, 157.19739526215773, 149.80061221669098, 139.21611773253505, 165.06377691154316, 139.39204660282294, 131.83251289380183, 126.13157067917157, 144.54978573578487, 150.47000298120548, 181.19637172959287, 168.00667585758498, 136.07756941406177, 201.94915713340876, 131.43865847864353, 150.4636997272966, 177.96657103449257, 139.29609205915398, 149.36172523368856, 169.86746110891937, 178.59258929279494, 167.62987920610178, 118.36621162741308, 137.27103714287136, 114.35588256934301, 140.32738902952843, 144.7612491777706, 165.8050778783322, 201.07223227546743, 117.61371251277794, 132.4557685869042]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6306035698193603, "mean_inference_ms": 1.982958796860101, "mean_action_processing_ms": 0.26211263616654956, "mean_env_wait_ms": 0.24116301099671844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005282163619995117, "StateBufferConnector_ms": 0.004154801368713379, "ViewRequirementAgentConnector_ms": 0.13363635540008545}, "num_episodes": 18, "episode_return_max": 608.5047667542789, "episode_return_min": 294.49622467564615, "episode_return_mean": 375.4019524116531, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 354.65243272434395, "num_env_steps_trained_throughput_per_sec": 354.65243272434395, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 11864.071, "restore_workers_time_ms": 0.016, "training_step_time_ms": 11863.98, "sample_time_ms": 1825.111, "learn_time_ms": 10016.453, "learn_throughput": 399.343, "synch_weights_time_ms": 19.723}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "e552a_00000", "date": "2024-08-16_09-01-39", "timestamp": 1723779099, "time_this_iter_s": 11.3314688205719, "time_total_s": 907.9574635028839, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20cd3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 907.9574635028839, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 37.9625, "ram_util_percent": 83.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.819719045439725, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.31116391414057, "policy_loss": -0.001740784258901994, "vf_loss": 8.309925992652852, "vf_explained_var": -0.13215998792774464, "kl": 0.017651569515576317, "entropy": 0.4585575331928869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.222466827763451, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.700482800145629, "policy_loss": -0.004402703928352191, "vf_loss": 8.703883966819319, "vf_explained_var": 0.0587000949042184, "kl": 0.013353923684652843, "entropy": 1.3309722667648678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 608.5047667542789, "episode_reward_min": 278.9046301317982, "episode_reward_mean": 380.47981659144517, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.28762998555624, "predator_policy": 22.74061767396194}, "policy_reward_max": {"prey_policy": 172.1056586655468, "predator_policy": 440.7761603098653}, "policy_reward_mean": {"prey_policy": 59.24592947689734, "predator_policy": 130.99397881882524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.99546947228333, 368.0983156663845, 364.51265658639807, 350.5704084807246, 351.8004542077443, 363.8455901173791, 365.99182925208976, 365.9340130774674, 302.4312962728021, 314.2762489598096, 383.0545217589919, 350.75012972340295, 328.42005585113566, 367.5001618971199, 324.56413119094145, 367.6927783434613, 301.4007231178755, 355.08874111041183, 359.72560954881266, 359.28061733832834, 373.3897061980369, 347.6145219094652, 327.1098877174609, 366.6759438013994, 337.0430935715643, 389.8720008520453, 348.20621505939346, 353.79000520175686, 353.91836403869195, 395.35849278785986, 386.9080350373209, 361.5080901895668, 349.77414833631, 376.96939214287426, 383.28964031071575, 356.0792118273926, 325.36893579295287, 387.403457825009, 337.368113695636, 351.29368687532434, 392.9162095362186, 375.18796374185985, 385.6707643379253, 294.49622467564615, 608.5047667542789, 387.2396683001021, 454.04223036118213, 445.7564809090247, 413.65965056051226, 330.75612579346387, 370.9499525102055, 414.928296370855, 388.261827773309, 399.70925952691175, 395.6303033776451, 344.71818389609916, 397.4467912110776, 389.46600530299264, 421.52998912447316, 408.8328751180815, 349.53568853210976, 389.6729936670341, 419.67037135149616, 417.45682063464716, 392.1001372157913, 365.351656715784, 407.08495465612907, 377.53831983358924, 326.2023147783461, 365.20191253828636, 433.9813182937276, 394.0901682845115, 397.12089551325414, 362.95226522262885, 402.7627679619388, 406.44410391767707, 410.8498432597133, 423.43190344238644, 402.7184680526636, 398.4152752136259, 383.55852445375194, 411.71485514185525, 434.5285389481013, 357.7412074709783, 410.62497858731484, 399.33897561022627, 384.3143537937962, 400.55424988369145, 350.294998555855, 395.7055581293674, 429.66778375550086, 439.2632708045397, 278.9046301317982, 325.03347207235595, 442.41713580903127, 425.01581715353285, 396.9390301155748, 421.6568638856884, 419.5642413557714, 437.9827300742476], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.8922202326047, 160.68338639045248, 136.30933575723472, 172.1056586655468, 139.1079416814459, 171.62633428057924, 61.771593880454716, 61.47965063330479, 103.96388138211383, 125.9563262453597, 140.553772871313, 152.2739911886659, 109.11710465717167, 104.60010910295148, 106.91654194747036, 120.69579516316135, 83.49936356055915, 37.817617236168346, -7.163404294522637, 67.02535772668257, 125.44499346621369, 159.86964276329547, 56.955706071663414, 86.55268602611376, 73.39524508664917, 87.54236063868423, 132.19043291398447, 138.09713015444305, -4.248186457172504, 31.92928882505429, 95.12997207861966, 101.74523435023934, 35.984363188860506, 9.509026619525496, 128.9700605665507, 112.55044726548842, 119.54539481768018, 157.29680304739227, 98.29633112976308, 126.03889857608182, 9.664208824746137, 51.31086455273545, 68.95813274427951, 35.701690466591494, 52.38796379166181, 43.403034747236, 98.77324207069861, 125.20762903618399, 8.26765994500273, -80.91093231798821, 132.02906706337274, 110.38313232791297, -13.310002210112932, 43.63470600201011, 71.36548436777258, 49.01879985695348, 26.687519955388158, 75.53108467342885, 84.01046562472771, 48.28819589744542, 80.40376622785466, 72.86952861364644, 41.23264791682882, 46.97340320598556, 39.77486517787966, 12.074959310332297, 131.81266614207232, 152.5350652568448, 35.913779561067464, 14.756210246014675, 92.5802310710909, 107.65115451147982, 45.475520789787666, 27.807787057253076, 47.97376000663251, 47.01872992125842, 7.419389296095478, -2.7771799630815464, 24.590226645937108, 1.7471800184944093, 35.7688207595366, 59.934592003505266, 15.630295947694561, -21.79422518742605, 40.81974327210955, 102.40951869185196, 28.325407362389292, 28.273334859879835, -297.28762998555624, 51.15004804457541, -81.0892579765047, 36.55281978603078, 40.65588648375784, -8.776894422241908, 19.028387414477976, 12.164532637434077, 50.83705106777502, 92.77954186940056, -1.3610847033857745, 45.787143507652985, 45.450834916808326, 73.3178580851619, 59.7379495153344, 34.77757184787383, 18.602283341949523, 13.551824711386043, 11.871600949750839, 44.35734544298285, 72.58384050821222, 37.49058867311719, 86.31021565815234, 117.34111153610057, 37.80374442990929, 5.677358782973949, 59.32084766667185, 77.94595429220547, 33.52340986450078, 9.766641015427266, 28.97135011122895, 60.66675978418079, 98.32873303960996, -41.06409420779029, 33.330498275931284, -19.68957597451156, 63.627264567168986, 49.045099305478935, 69.87447203676518, 43.302453953804296, 54.39895335800085, 66.47662436116477, 31.007782968305285, 63.66251733252271, 15.565430138188992, 59.85314980714167, 28.839218171804177, 44.61485639013839, 5.703014973546266, -12.888515807252798, -4.504022403042011, 41.275664179538865, 87.1092500279541, 58.214250972930735, 27.206781062019136, 18.423336820777607, 70.79357138067789, 40.33123329906113, 50.26951446873482, 61.05583104167932, 67.40293167134065, 50.271198083298586, 31.822955586185667, 7.743838177691787, 85.52654671042357, 75.25381544960656, 74.70880932551474, 104.7116672010971, 90.7947036275585, 95.78162432084365, 85.64914935311236, 119.05061744530175, 66.54192296782949, 75.32775527926594, 63.36979070533655, 104.43635408494616, 87.05193248779116, 117.7029011642791, 72.18640209716982, 50.49060044214338, 89.75326728296474, 92.29186562301116, 31.60100460823578, 74.59177110413899, 64.6305517234366, 67.43932198479435, 92.50583351436761, 102.00533274836708, 43.05461534446608, 30.44252494663054, 85.96326531297886, 41.11989175530492, 30.16597932673398, 33.78113076393233, 28.831410349150396, 80.83881300579421, 73.10559958604497, 20.694652493494576, 31.62414346292374, 33.806414774858034, 47.398634294139384, 73.4259542900965, 84.18854550625028, 100.83070159886533, 106.1007853523259, 82.08645381904185, 44.999103004716936, 29.675667477783428, 78.88257248889964, 50.3062625308761, 21.75100756767574, 26.162837577826206], "policy_predator_policy_reward": [35.831196438731496, 33.588666410494994, 24.65712748379444, 35.02619375980851, 27.980373833928137, 25.798006790444735, 72.79188766708606, 154.52727629987962, 94.97841345259882, 26.901833127672113, 48.277208383438236, 22.74061767396194, 39.95077313515179, 112.32384235681451, 106.21923742631034, 32.10243854052507, 149.11153697608316, 32.002778499991535, 25.71009465823853, 228.7042008694111, 58.77817796440013, 38.96170756508288, 150.46998869941686, 56.77174892620905, 67.6247045412564, 99.85774558454611, 58.120905356830875, 39.09169347186139, 237.6395110166659, 59.24351780639275, 105.12213073886853, 65.69544117573388, 226.0623889646001, 29.84494434488913, 29.815077510771566, 83.75315576760103, 50.5417509134844, 32.34166077025574, 52.275812787799715, 82.66957484468402, 152.33729469965638, 160.0773381208989, 196.35344393467264, 46.601254763920856, 151.2102646875001, 80.10862449106283, 57.23940266596711, 85.45567002854949, 218.57629085796822, 191.11007508658142, 57.85680309527577, 89.60299836548344, 95.52037321889138, 222.36113804860477, 181.88812765973753, 51.51759331729251, 66.6911649362552, 185.00859447361967, 122.54032392813208, 140.51950733755424, 127.51071222672007, 106.12402796909966, 185.71788566769004, 87.58415339906195, 229.16285815115899, 68.76146569693903, 38.47847780004585, 54.143182943911526, 188.34857583382674, 144.2710746698069, 98.46700231032521, 57.38082393449651, 180.32749690363752, 71.75813104227429, 135.37084148739712, 157.0401264097212, 240.5929724589003, 92.13293190372104, 181.30637476879792, 143.64990544209522, 171.84069179700472, 125.37210497617181, 187.1474920402094, 194.20440094138144, 127.15829233746081, 115.2832100365028, 29.127482940721947, 208.7699995126548, 440.7761603098653, 413.86618838539374, 259.1989852595352, 172.57712123104147, 203.1537460733959, 219.0094922262711, 216.27838793656696, 198.2851729205447, 144.11203880004328, 125.9310188232937, 175.44025195125997, 110.8898150379372, 72.66853844939412, 179.51272105884087, 196.91711051916997, 123.49566448847764, 203.2787718913529, 152.82894782862093, 207.09469282706934, 136.3856203071089, 164.42786875133328, 121.12800544498234, 102.58105565929198, 38.48580104255351, 189.72380080507995, 164.24188719311402, 99.62407060299279, 152.5751327411228, 199.3316434562179, 178.90829478832734, 173.27510356977004, 145.91966165290242, 198.89987068089079, 93.37117901939928, 180.89378172934465, 195.13828963626986, 157.19739526215773, 149.80061221669098, 139.21611773253505, 165.06377691154316, 139.39204660282294, 131.83251289380183, 126.13157067917157, 144.54978573578487, 150.47000298120548, 181.19637172959287, 168.00667585758498, 136.07756941406177, 201.94915713340876, 131.43865847864353, 150.4636997272966, 177.96657103449257, 139.29609205915398, 149.36172523368856, 169.86746110891937, 178.59258929279494, 167.62987920610178, 118.36621162741308, 137.27103714287136, 114.35588256934301, 140.32738902952843, 144.7612491777706, 165.8050778783322, 201.07223227546743, 117.61371251277794, 132.4557685869042, 117.95236053311501, 126.05906638265944, 109.00371525262112, 107.13842485164083, 101.87978995515984, 91.83571846005195, 135.3106387478288, 106.37820745882789, 116.16827597463121, 127.74043437694057, 113.54092482226963, 116.23278047376009, 125.8398968763353, 109.2243080553294, 111.23523958297528, 117.34460609836336, 151.75042097176998, 141.39577892608074, 120.91208329297127, 131.33239679259373, 102.68157399779638, 103.36150962316093, 124.84484922539403, 151.95300903936436, 133.2201197926412, 135.40228126844147, 186.8382905179171, 178.8823831469169, 172.35735704457653, 157.2356904050187, 102.93072926343402, 82.17364878882452, 154.090726623402, 105.51218721117246, 155.60949282772634, 165.98305439706928, 123.1920293585329, 116.80454068988472, 107.01730663052307, 101.73448431368348, 138.21451001507927, 208.76758338810848, 177.63230673768464, 112.74309959831098, 215.46893517487706, 174.5999497538696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6354378790250561, "mean_inference_ms": 1.9927202608052528, "mean_action_processing_ms": 0.26366966075326653, "mean_env_wait_ms": 0.24307436646704259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005067110061645508, "StateBufferConnector_ms": 0.004536032676696777, "ViewRequirementAgentConnector_ms": 0.13043606281280518}, "num_episodes": 23, "episode_return_max": 608.5047667542789, "episode_return_min": 278.9046301317982, "episode_return_mean": 380.47981659144517, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 383.7903079291379, "num_env_steps_trained_throughput_per_sec": 383.7903079291379, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 11867.963, "restore_workers_time_ms": 0.017, "training_step_time_ms": 11867.871, "sample_time_ms": 1839.642, "learn_time_ms": 10005.342, "learn_throughput": 399.786, "synch_weights_time_ms": 19.87}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "e552a_00000", "date": "2024-08-16_09-01-50", "timestamp": 1723779110, "time_this_iter_s": 10.471590757369995, "time_total_s": 918.4290542602539, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2291f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 918.4290542602539, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 32.74666666666666, "ram_util_percent": 83.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.039702382478764, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.01345130350224, "policy_loss": -0.001573799044834992, "vf_loss": 8.012017838664786, "vf_explained_var": -0.06714138836456986, "kl": 0.017820873300571232, "entropy": 0.5203115213169622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.569655505311552, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.310753095969952, "policy_loss": -0.008851991430733097, "vf_loss": 8.318513116887006, "vf_explained_var": 0.006004161904097865, "kl": 0.014559839193166155, "entropy": 1.3373907323236818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 608.5047667542789, "episode_reward_min": 278.9046301317982, "episode_reward_mean": 385.2158549829366, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.28762998555624, "predator_policy": 29.127482940721947}, "policy_reward_max": {"prey_policy": 157.29680304739227, "predator_policy": 440.7761603098653}, "policy_reward_mean": {"prey_policy": 53.686517252255236, "predator_policy": 138.921410239213}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.72560954881266, 359.28061733832834, 373.3897061980369, 347.6145219094652, 327.1098877174609, 366.6759438013994, 337.0430935715643, 389.8720008520453, 348.20621505939346, 353.79000520175686, 353.91836403869195, 395.35849278785986, 386.9080350373209, 361.5080901895668, 349.77414833631, 376.96939214287426, 383.28964031071575, 356.0792118273926, 325.36893579295287, 387.403457825009, 337.368113695636, 351.29368687532434, 392.9162095362186, 375.18796374185985, 385.6707643379253, 294.49622467564615, 608.5047667542789, 387.2396683001021, 454.04223036118213, 445.7564809090247, 413.65965056051226, 330.75612579346387, 370.9499525102055, 414.928296370855, 388.261827773309, 399.70925952691175, 395.6303033776451, 344.71818389609916, 397.4467912110776, 389.46600530299264, 421.52998912447316, 408.8328751180815, 349.53568853210976, 389.6729936670341, 419.67037135149616, 417.45682063464716, 392.1001372157913, 365.351656715784, 407.08495465612907, 377.53831983358924, 326.2023147783461, 365.20191253828636, 433.9813182937276, 394.0901682845115, 397.12089551325414, 362.95226522262885, 402.7627679619388, 406.44410391767707, 410.8498432597133, 423.43190344238644, 402.7184680526636, 398.4152752136259, 383.55852445375194, 411.71485514185525, 434.5285389481013, 357.7412074709783, 410.62497858731484, 399.33897561022627, 384.3143537937962, 400.55424988369145, 350.294998555855, 395.7055581293674, 429.66778375550086, 439.2632708045397, 278.9046301317982, 325.03347207235595, 442.41713580903127, 425.01581715353285, 396.9390301155748, 421.6568638856884, 419.5642413557714, 437.9827300742476, 402.83570112527474, 401.00108067014554, 374.820347102944, 378.95704957834005, 347.5530506756776, 397.4272477714639, 359.1994265041824, 396.7565920986754, 356.79999762748645, 397.25536470719254, 372.6524508935218, 300.9742952313937, 381.3464875043066, 402.813541954948, 347.07921727017833, 359.04538585876537, 402.3211680026032, 407.6929596584561], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.54539481768018, 157.29680304739227, 98.29633112976308, 126.03889857608182, 9.664208824746137, 51.31086455273545, 68.95813274427951, 35.701690466591494, 52.38796379166181, 43.403034747236, 98.77324207069861, 125.20762903618399, 8.26765994500273, -80.91093231798821, 132.02906706337274, 110.38313232791297, -13.310002210112932, 43.63470600201011, 71.36548436777258, 49.01879985695348, 26.687519955388158, 75.53108467342885, 84.01046562472771, 48.28819589744542, 80.40376622785466, 72.86952861364644, 41.23264791682882, 46.97340320598556, 39.77486517787966, 12.074959310332297, 131.81266614207232, 152.5350652568448, 35.913779561067464, 14.756210246014675, 92.5802310710909, 107.65115451147982, 45.475520789787666, 27.807787057253076, 47.97376000663251, 47.01872992125842, 7.419389296095478, -2.7771799630815464, 24.590226645937108, 1.7471800184944093, 35.7688207595366, 59.934592003505266, 15.630295947694561, -21.79422518742605, 40.81974327210955, 102.40951869185196, 28.325407362389292, 28.273334859879835, -297.28762998555624, 51.15004804457541, -81.0892579765047, 36.55281978603078, 40.65588648375784, -8.776894422241908, 19.028387414477976, 12.164532637434077, 50.83705106777502, 92.77954186940056, -1.3610847033857745, 45.787143507652985, 45.450834916808326, 73.3178580851619, 59.7379495153344, 34.77757184787383, 18.602283341949523, 13.551824711386043, 11.871600949750839, 44.35734544298285, 72.58384050821222, 37.49058867311719, 86.31021565815234, 117.34111153610057, 37.80374442990929, 5.677358782973949, 59.32084766667185, 77.94595429220547, 33.52340986450078, 9.766641015427266, 28.97135011122895, 60.66675978418079, 98.32873303960996, -41.06409420779029, 33.330498275931284, -19.68957597451156, 63.627264567168986, 49.045099305478935, 69.87447203676518, 43.302453953804296, 54.39895335800085, 66.47662436116477, 31.007782968305285, 63.66251733252271, 15.565430138188992, 59.85314980714167, 28.839218171804177, 44.61485639013839, 5.703014973546266, -12.888515807252798, -4.504022403042011, 41.275664179538865, 87.1092500279541, 58.214250972930735, 27.206781062019136, 18.423336820777607, 70.79357138067789, 40.33123329906113, 50.26951446873482, 61.05583104167932, 67.40293167134065, 50.271198083298586, 31.822955586185667, 7.743838177691787, 85.52654671042357, 75.25381544960656, 74.70880932551474, 104.7116672010971, 90.7947036275585, 95.78162432084365, 85.64914935311236, 119.05061744530175, 66.54192296782949, 75.32775527926594, 63.36979070533655, 104.43635408494616, 87.05193248779116, 117.7029011642791, 72.18640209716982, 50.49060044214338, 89.75326728296474, 92.29186562301116, 31.60100460823578, 74.59177110413899, 64.6305517234366, 67.43932198479435, 92.50583351436761, 102.00533274836708, 43.05461534446608, 30.44252494663054, 85.96326531297886, 41.11989175530492, 30.16597932673398, 33.78113076393233, 28.831410349150396, 80.83881300579421, 73.10559958604497, 20.694652493494576, 31.62414346292374, 33.806414774858034, 47.398634294139384, 73.4259542900965, 84.18854550625028, 100.83070159886533, 106.1007853523259, 82.08645381904185, 44.999103004716936, 29.675667477783428, 78.88257248889964, 50.3062625308761, 21.75100756767574, 26.162837577826206, 78.641682342496, 37.77673656205817, 76.6708135562266, 72.01310814687001, 75.46652933937793, 63.21022073199806, 47.93695711254511, 90.37785720205909, -19.19487231521606, 63.83407433355656, 108.23357668094039, 89.78443431470143, 51.37496228763744, 73.28699330833493, 68.02890588250592, 64.83197922940496, 56.16725656880212, 77.91799550630965, 110.41541746657211, 63.31604999050435, 97.4348735289691, 114.30365990276037, 2.5378767261939164, 46.07820102780035, 115.42365978710446, 77.41881177560948, 56.93295520541374, 29.48024601873928, 93.89636076986592, 88.3901301390843, 44.475853944860674, 20.916779542176258, 74.32850413653895, 69.86212506770912, 122.59464980861257, 60.80317130938704], "policy_predator_policy_reward": [50.5417509134844, 32.34166077025574, 52.275812787799715, 82.66957484468402, 152.33729469965638, 160.0773381208989, 196.35344393467264, 46.601254763920856, 151.2102646875001, 80.10862449106283, 57.23940266596711, 85.45567002854949, 218.57629085796822, 191.11007508658142, 57.85680309527577, 89.60299836548344, 95.52037321889138, 222.36113804860477, 181.88812765973753, 51.51759331729251, 66.6911649362552, 185.00859447361967, 122.54032392813208, 140.51950733755424, 127.51071222672007, 106.12402796909966, 185.71788566769004, 87.58415339906195, 229.16285815115899, 68.76146569693903, 38.47847780004585, 54.143182943911526, 188.34857583382674, 144.2710746698069, 98.46700231032521, 57.38082393449651, 180.32749690363752, 71.75813104227429, 135.37084148739712, 157.0401264097212, 240.5929724589003, 92.13293190372104, 181.30637476879792, 143.64990544209522, 171.84069179700472, 125.37210497617181, 187.1474920402094, 194.20440094138144, 127.15829233746081, 115.2832100365028, 29.127482940721947, 208.7699995126548, 440.7761603098653, 413.86618838539374, 259.1989852595352, 172.57712123104147, 203.1537460733959, 219.0094922262711, 216.27838793656696, 198.2851729205447, 144.11203880004328, 125.9310188232937, 175.44025195125997, 110.8898150379372, 72.66853844939412, 179.51272105884087, 196.91711051916997, 123.49566448847764, 203.2787718913529, 152.82894782862093, 207.09469282706934, 136.3856203071089, 164.42786875133328, 121.12800544498234, 102.58105565929198, 38.48580104255351, 189.72380080507995, 164.24188719311402, 99.62407060299279, 152.5751327411228, 199.3316434562179, 178.90829478832734, 173.27510356977004, 145.91966165290242, 198.89987068089079, 93.37117901939928, 180.89378172934465, 195.13828963626986, 157.19739526215773, 149.80061221669098, 139.21611773253505, 165.06377691154316, 139.39204660282294, 131.83251289380183, 126.13157067917157, 144.54978573578487, 150.47000298120548, 181.19637172959287, 168.00667585758498, 136.07756941406177, 201.94915713340876, 131.43865847864353, 150.4636997272966, 177.96657103449257, 139.29609205915398, 149.36172523368856, 169.86746110891937, 178.59258929279494, 167.62987920610178, 118.36621162741308, 137.27103714287136, 114.35588256934301, 140.32738902952843, 144.7612491777706, 165.8050778783322, 201.07223227546743, 117.61371251277794, 132.4557685869042, 117.95236053311501, 126.05906638265944, 109.00371525262112, 107.13842485164083, 101.87978995515984, 91.83571846005195, 135.3106387478288, 106.37820745882789, 116.16827597463121, 127.74043437694057, 113.54092482226963, 116.23278047376009, 125.8398968763353, 109.2243080553294, 111.23523958297528, 117.34460609836336, 151.75042097176998, 141.39577892608074, 120.91208329297127, 131.33239679259373, 102.68157399779638, 103.36150962316093, 124.84484922539403, 151.95300903936436, 133.2201197926412, 135.40228126844147, 186.8382905179171, 178.8823831469169, 172.35735704457653, 157.2356904050187, 102.93072926343402, 82.17364878882452, 154.090726623402, 105.51218721117246, 155.60949282772634, 165.98305439706928, 123.1920293585329, 116.80454068988472, 107.01730663052307, 101.73448431368348, 138.21451001507927, 208.76758338810848, 177.63230673768464, 112.74309959831098, 215.46893517487706, 174.5999497538696, 136.65584499387555, 149.76143722684486, 146.6176786086066, 105.69948035844295, 117.98590040851538, 118.15769662305303, 104.57450450961511, 136.0677307541217, 113.07101584054168, 189.84283281679535, 84.55059858350673, 114.85863819231541, 139.63765450040358, 94.89981640780638, 119.42723013105132, 144.46847685571356, 171.3331877278033, 51.38155782457075, 126.31812932969126, 97.20576792042459, 70.8985321074369, 90.01538535435478, 102.04222831195865, 150.31598916544073, 113.11141380602146, 75.39260213557124, 131.49094721903128, 184.909393511763, 95.2677309684372, 69.52499539279123, 118.96641898077213, 174.68633339095643, 132.86908456826583, 125.2614542300896, 124.69613464857213, 99.5990038918844]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6381805003151894, "mean_inference_ms": 2.006622709087348, "mean_action_processing_ms": 0.2650301238476365, "mean_env_wait_ms": 0.24447327249845854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004999279975891113, "StateBufferConnector_ms": 0.005125880241394043, "ViewRequirementAgentConnector_ms": 0.12768888473510742}, "num_episodes": 18, "episode_return_max": 608.5047667542789, "episode_return_min": 278.9046301317982, "episode_return_mean": 385.2158549829366, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.7552834633265, "num_env_steps_trained_throughput_per_sec": 394.7552834633265, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 11841.754, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11841.657, "sample_time_ms": 1843.012, "learn_time_ms": 9975.885, "learn_throughput": 400.967, "synch_weights_time_ms": 19.744}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-00", "timestamp": 1723779120, "time_this_iter_s": 10.137853145599365, "time_total_s": 928.5669074058533, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 928.5669074058533, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.721428571428568, "ram_util_percent": 83.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.908949662327136, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.137517811003185, "policy_loss": -0.003854917229163071, "vf_loss": 8.139902841477166, "vf_explained_var": -0.023587416719507287, "kl": 0.00871029064259604, "entropy": 0.5006330927686086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4780127209330365, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.383180373307889, "policy_loss": -0.011827564850897976, "vf_loss": 8.393688481446928, "vf_explained_var": 0.053248737444953315, "kl": 0.017592646308890278, "entropy": 1.3154400287481842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 608.5047667542789, "episode_reward_min": 278.9046301317982, "episode_reward_mean": 392.09844259138686, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -297.28762998555624, "predator_policy": 29.127482940721947}, "policy_reward_max": {"prey_policy": 139.07910261517344, "predator_policy": 440.7761603098653}, "policy_reward_mean": {"prey_policy": 55.63812892595219, "predator_policy": 140.4110923697413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.36893579295287, 387.403457825009, 337.368113695636, 351.29368687532434, 392.9162095362186, 375.18796374185985, 385.6707643379253, 294.49622467564615, 608.5047667542789, 387.2396683001021, 454.04223036118213, 445.7564809090247, 413.65965056051226, 330.75612579346387, 370.9499525102055, 414.928296370855, 388.261827773309, 399.70925952691175, 395.6303033776451, 344.71818389609916, 397.4467912110776, 389.46600530299264, 421.52998912447316, 408.8328751180815, 349.53568853210976, 389.6729936670341, 419.67037135149616, 417.45682063464716, 392.1001372157913, 365.351656715784, 407.08495465612907, 377.53831983358924, 326.2023147783461, 365.20191253828636, 433.9813182937276, 394.0901682845115, 397.12089551325414, 362.95226522262885, 402.7627679619388, 406.44410391767707, 410.8498432597133, 423.43190344238644, 402.7184680526636, 398.4152752136259, 383.55852445375194, 411.71485514185525, 434.5285389481013, 357.7412074709783, 410.62497858731484, 399.33897561022627, 384.3143537937962, 400.55424988369145, 350.294998555855, 395.7055581293674, 429.66778375550086, 439.2632708045397, 278.9046301317982, 325.03347207235595, 442.41713580903127, 425.01581715353285, 396.9390301155748, 421.6568638856884, 419.5642413557714, 437.9827300742476, 402.83570112527474, 401.00108067014554, 374.820347102944, 378.95704957834005, 347.5530506756776, 397.4272477714639, 359.1994265041824, 396.7565920986754, 356.79999762748645, 397.25536470719254, 372.6524508935218, 300.9742952313937, 381.3464875043066, 402.813541954948, 347.07921727017833, 359.04538585876537, 402.3211680026032, 407.6929596584561, 369.1983868831916, 419.1784107943741, 354.57472418349323, 414.7939139095763, 398.16440831715533, 402.6541956019821, 402.3946795758438, 421.4441149466072, 328.7951651446103, 392.49064306200165, 419.8742412007359, 422.48913310121156, 438.39056544328713, 416.5075022971404, 387.57336124772934, 423.7571643993521, 436.5225056807718, 365.96862092497315], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [45.475520789787666, 27.807787057253076, 47.97376000663251, 47.01872992125842, 7.419389296095478, -2.7771799630815464, 24.590226645937108, 1.7471800184944093, 35.7688207595366, 59.934592003505266, 15.630295947694561, -21.79422518742605, 40.81974327210955, 102.40951869185196, 28.325407362389292, 28.273334859879835, -297.28762998555624, 51.15004804457541, -81.0892579765047, 36.55281978603078, 40.65588648375784, -8.776894422241908, 19.028387414477976, 12.164532637434077, 50.83705106777502, 92.77954186940056, -1.3610847033857745, 45.787143507652985, 45.450834916808326, 73.3178580851619, 59.7379495153344, 34.77757184787383, 18.602283341949523, 13.551824711386043, 11.871600949750839, 44.35734544298285, 72.58384050821222, 37.49058867311719, 86.31021565815234, 117.34111153610057, 37.80374442990929, 5.677358782973949, 59.32084766667185, 77.94595429220547, 33.52340986450078, 9.766641015427266, 28.97135011122895, 60.66675978418079, 98.32873303960996, -41.06409420779029, 33.330498275931284, -19.68957597451156, 63.627264567168986, 49.045099305478935, 69.87447203676518, 43.302453953804296, 54.39895335800085, 66.47662436116477, 31.007782968305285, 63.66251733252271, 15.565430138188992, 59.85314980714167, 28.839218171804177, 44.61485639013839, 5.703014973546266, -12.888515807252798, -4.504022403042011, 41.275664179538865, 87.1092500279541, 58.214250972930735, 27.206781062019136, 18.423336820777607, 70.79357138067789, 40.33123329906113, 50.26951446873482, 61.05583104167932, 67.40293167134065, 50.271198083298586, 31.822955586185667, 7.743838177691787, 85.52654671042357, 75.25381544960656, 74.70880932551474, 104.7116672010971, 90.7947036275585, 95.78162432084365, 85.64914935311236, 119.05061744530175, 66.54192296782949, 75.32775527926594, 63.36979070533655, 104.43635408494616, 87.05193248779116, 117.7029011642791, 72.18640209716982, 50.49060044214338, 89.75326728296474, 92.29186562301116, 31.60100460823578, 74.59177110413899, 64.6305517234366, 67.43932198479435, 92.50583351436761, 102.00533274836708, 43.05461534446608, 30.44252494663054, 85.96326531297886, 41.11989175530492, 30.16597932673398, 33.78113076393233, 28.831410349150396, 80.83881300579421, 73.10559958604497, 20.694652493494576, 31.62414346292374, 33.806414774858034, 47.398634294139384, 73.4259542900965, 84.18854550625028, 100.83070159886533, 106.1007853523259, 82.08645381904185, 44.999103004716936, 29.675667477783428, 78.88257248889964, 50.3062625308761, 21.75100756767574, 26.162837577826206, 78.641682342496, 37.77673656205817, 76.6708135562266, 72.01310814687001, 75.46652933937793, 63.21022073199806, 47.93695711254511, 90.37785720205909, -19.19487231521606, 63.83407433355656, 108.23357668094039, 89.78443431470143, 51.37496228763744, 73.28699330833493, 68.02890588250592, 64.83197922940496, 56.16725656880212, 77.91799550630965, 110.41541746657211, 63.31604999050435, 97.4348735289691, 114.30365990276037, 2.5378767261939164, 46.07820102780035, 115.42365978710446, 77.41881177560948, 56.93295520541374, 29.48024601873928, 93.89636076986592, 88.3901301390843, 44.475853944860674, 20.916779542176258, 74.32850413653895, 69.86212506770912, 122.59464980861257, 60.80317130938704, 101.77381964230484, 72.51121967837965, 82.97230446340842, 37.75248752197665, 67.11021514726987, 12.887667610201479, 79.24510405038914, 117.08679438379515, 82.92955058109047, 78.61364131078619, 113.12058183745681, 87.23144031704645, 82.37238870291063, 112.62467484811152, 40.40744193454995, 95.8837204367817, 121.55235071458085, 58.795249447275054, 89.44938924992718, 29.900698105061522, 64.16018547015591, 29.659917567265158, 41.94535903773096, 139.07910261517344, 130.7581303613935, 100.66165939372785, 30.546430786094383, 107.05477399778442, 80.60611463154248, 56.96179556087821, 104.14417594219192, 42.480615725520984, 75.91806634590829, 99.89894637221488, 31.00300980681229, 61.38096337375388], "policy_predator_policy_reward": [180.32749690363752, 71.75813104227429, 135.37084148739712, 157.0401264097212, 240.5929724589003, 92.13293190372104, 181.30637476879792, 143.64990544209522, 171.84069179700472, 125.37210497617181, 187.1474920402094, 194.20440094138144, 127.15829233746081, 115.2832100365028, 29.127482940721947, 208.7699995126548, 440.7761603098653, 413.86618838539374, 259.1989852595352, 172.57712123104147, 203.1537460733959, 219.0094922262711, 216.27838793656696, 198.2851729205447, 144.11203880004328, 125.9310188232937, 175.44025195125997, 110.8898150379372, 72.66853844939412, 179.51272105884087, 196.91711051916997, 123.49566448847764, 203.2787718913529, 152.82894782862093, 207.09469282706934, 136.3856203071089, 164.42786875133328, 121.12800544498234, 102.58105565929198, 38.48580104255351, 189.72380080507995, 164.24188719311402, 99.62407060299279, 152.5751327411228, 199.3316434562179, 178.90829478832734, 173.27510356977004, 145.91966165290242, 198.89987068089079, 93.37117901939928, 180.89378172934465, 195.13828963626986, 157.19739526215773, 149.80061221669098, 139.21611773253505, 165.06377691154316, 139.39204660282294, 131.83251289380183, 126.13157067917157, 144.54978573578487, 150.47000298120548, 181.19637172959287, 168.00667585758498, 136.07756941406177, 201.94915713340876, 131.43865847864353, 150.4636997272966, 177.96657103449257, 139.29609205915398, 149.36172523368856, 169.86746110891937, 178.59258929279494, 167.62987920610178, 118.36621162741308, 137.27103714287136, 114.35588256934301, 140.32738902952843, 144.7612491777706, 165.8050778783322, 201.07223227546743, 117.61371251277794, 132.4557685869042, 117.95236053311501, 126.05906638265944, 109.00371525262112, 107.13842485164083, 101.87978995515984, 91.83571846005195, 135.3106387478288, 106.37820745882789, 116.16827597463121, 127.74043437694057, 113.54092482226963, 116.23278047376009, 125.8398968763353, 109.2243080553294, 111.23523958297528, 117.34460609836336, 151.75042097176998, 141.39577892608074, 120.91208329297127, 131.33239679259373, 102.68157399779638, 103.36150962316093, 124.84484922539403, 151.95300903936436, 133.2201197926412, 135.40228126844147, 186.8382905179171, 178.8823831469169, 172.35735704457653, 157.2356904050187, 102.93072926343402, 82.17364878882452, 154.090726623402, 105.51218721117246, 155.60949282772634, 165.98305439706928, 123.1920293585329, 116.80454068988472, 107.01730663052307, 101.73448431368348, 138.21451001507927, 208.76758338810848, 177.63230673768464, 112.74309959831098, 215.46893517487706, 174.5999497538696, 136.65584499387555, 149.76143722684486, 146.6176786086066, 105.69948035844295, 117.98590040851538, 118.15769662305303, 104.57450450961511, 136.0677307541217, 113.07101584054168, 189.84283281679535, 84.55059858350673, 114.85863819231541, 139.63765450040358, 94.89981640780638, 119.42723013105132, 144.46847685571356, 171.3331877278033, 51.38155782457075, 126.31812932969126, 97.20576792042459, 70.8985321074369, 90.01538535435478, 102.04222831195865, 150.31598916544073, 113.11141380602146, 75.39260213557124, 131.49094721903128, 184.909393511763, 95.2677309684372, 69.52499539279123, 118.96641898077213, 174.68633339095643, 132.86908456826583, 125.2614542300896, 124.69613464857213, 99.5990038918844, 106.02836084562547, 88.88498671688208, 147.92704457899015, 150.5265742299983, 89.13244612737682, 185.4443952986451, 115.06580382018709, 103.39621165520437, 149.5751801466444, 87.04603627863312, 114.78910208858224, 87.5130713588963, 93.87121005679424, 113.52640596802746, 135.4673198115058, 149.68563276376932, 81.36005181310362, 67.08751316965044, 148.39065651596871, 124.74989919104429, 231.5184089352416, 94.53572922807314, 118.84435675570545, 122.62031469260181, 102.15976111802992, 104.81101457013634, 118.10398738774693, 160.80231012551525, 128.2968006857958, 121.70865036951318, 133.40814418147133, 143.72422855016808, 130.70080238053438, 130.00469058211465, 103.12351805170067, 170.46112969270683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6397736110961845, "mean_inference_ms": 2.0111554024003633, "mean_action_processing_ms": 0.2655814276176016, "mean_env_wait_ms": 0.24518645183777224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042182207107543945, "StateBufferConnector_ms": 0.004463076591491699, "ViewRequirementAgentConnector_ms": 0.11070847511291504}, "num_episodes": 18, "episode_return_max": 608.5047667542789, "episode_return_min": 278.9046301317982, "episode_return_mean": 392.09844259138686, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 397.27461331638267, "num_env_steps_trained_throughput_per_sec": 397.27461331638267, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 11658.743, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11658.654, "sample_time_ms": 1834.9, "learn_time_ms": 9801.318, "learn_throughput": 408.108, "synch_weights_time_ms": 19.42}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-10", "timestamp": 1723779130, "time_this_iter_s": 10.110838890075684, "time_total_s": 938.677746295929, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a72de3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 938.677746295929, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 31.764285714285712, "ram_util_percent": 83.47142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.364958568477126, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.777732353109531, "policy_loss": -0.0021711531674203574, "vf_loss": 7.778744668809194, "vf_explained_var": 0.019204825225961272, "kl": 0.006867274631393122, "entropy": 0.48267107222761424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.818278731114019, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.593435825115789, "policy_loss": -0.007278239466594877, "vf_loss": 8.599558321887223, "vf_explained_var": 0.09368839995570914, "kl": 0.01540990516382621, "entropy": 1.287307719704966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 542.8215315753168, "episode_reward_min": 278.9046301317982, "episode_reward_mean": 398.9124051133611, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.02876510626227, "predator_policy": 51.38155782457075}, "policy_reward_max": {"prey_policy": 171.93469483118665, "predator_policy": 269.0399337206882}, "policy_reward_mean": {"prey_policy": 65.824546192085, "predator_policy": 133.63165636459556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [421.52998912447316, 408.8328751180815, 349.53568853210976, 389.6729936670341, 419.67037135149616, 417.45682063464716, 392.1001372157913, 365.351656715784, 407.08495465612907, 377.53831983358924, 326.2023147783461, 365.20191253828636, 433.9813182937276, 394.0901682845115, 397.12089551325414, 362.95226522262885, 402.7627679619388, 406.44410391767707, 410.8498432597133, 423.43190344238644, 402.7184680526636, 398.4152752136259, 383.55852445375194, 411.71485514185525, 434.5285389481013, 357.7412074709783, 410.62497858731484, 399.33897561022627, 384.3143537937962, 400.55424988369145, 350.294998555855, 395.7055581293674, 429.66778375550086, 439.2632708045397, 278.9046301317982, 325.03347207235595, 442.41713580903127, 425.01581715353285, 396.9390301155748, 421.6568638856884, 419.5642413557714, 437.9827300742476, 402.83570112527474, 401.00108067014554, 374.820347102944, 378.95704957834005, 347.5530506756776, 397.4272477714639, 359.1994265041824, 396.7565920986754, 356.79999762748645, 397.25536470719254, 372.6524508935218, 300.9742952313937, 381.3464875043066, 402.813541954948, 347.07921727017833, 359.04538585876537, 402.3211680026032, 407.6929596584561, 369.1983868831916, 419.1784107943741, 354.57472418349323, 414.7939139095763, 398.16440831715533, 402.6541956019821, 402.3946795758438, 421.4441149466072, 328.7951651446103, 392.49064306200165, 419.8742412007359, 422.48913310121156, 438.39056544328713, 416.5075022971404, 387.57336124772934, 423.7571643993521, 436.5225056807718, 365.96862092497315, 398.61361853378946, 404.27380910016205, 426.77110660756085, 423.5062017684073, 414.7720466394346, 542.8215315753168, 394.42929174966895, 428.34104637612927, 440.7764106268426, 403.07054211761624, 403.11722760739104, 426.17061853905386, 427.55919194595765, 387.93508961971594, 459.13089495083955, 406.9875383252284, 412.8877694272343, 430.04527784680835, 390.16178196058854, 426.9000132974325, 380.63816169980356, 443.2619810106623], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [33.52340986450078, 9.766641015427266, 28.97135011122895, 60.66675978418079, 98.32873303960996, -41.06409420779029, 33.330498275931284, -19.68957597451156, 63.627264567168986, 49.045099305478935, 69.87447203676518, 43.302453953804296, 54.39895335800085, 66.47662436116477, 31.007782968305285, 63.66251733252271, 15.565430138188992, 59.85314980714167, 28.839218171804177, 44.61485639013839, 5.703014973546266, -12.888515807252798, -4.504022403042011, 41.275664179538865, 87.1092500279541, 58.214250972930735, 27.206781062019136, 18.423336820777607, 70.79357138067789, 40.33123329906113, 50.26951446873482, 61.05583104167932, 67.40293167134065, 50.271198083298586, 31.822955586185667, 7.743838177691787, 85.52654671042357, 75.25381544960656, 74.70880932551474, 104.7116672010971, 90.7947036275585, 95.78162432084365, 85.64914935311236, 119.05061744530175, 66.54192296782949, 75.32775527926594, 63.36979070533655, 104.43635408494616, 87.05193248779116, 117.7029011642791, 72.18640209716982, 50.49060044214338, 89.75326728296474, 92.29186562301116, 31.60100460823578, 74.59177110413899, 64.6305517234366, 67.43932198479435, 92.50583351436761, 102.00533274836708, 43.05461534446608, 30.44252494663054, 85.96326531297886, 41.11989175530492, 30.16597932673398, 33.78113076393233, 28.831410349150396, 80.83881300579421, 73.10559958604497, 20.694652493494576, 31.62414346292374, 33.806414774858034, 47.398634294139384, 73.4259542900965, 84.18854550625028, 100.83070159886533, 106.1007853523259, 82.08645381904185, 44.999103004716936, 29.675667477783428, 78.88257248889964, 50.3062625308761, 21.75100756767574, 26.162837577826206, 78.641682342496, 37.77673656205817, 76.6708135562266, 72.01310814687001, 75.46652933937793, 63.21022073199806, 47.93695711254511, 90.37785720205909, -19.19487231521606, 63.83407433355656, 108.23357668094039, 89.78443431470143, 51.37496228763744, 73.28699330833493, 68.02890588250592, 64.83197922940496, 56.16725656880212, 77.91799550630965, 110.41541746657211, 63.31604999050435, 97.4348735289691, 114.30365990276037, 2.5378767261939164, 46.07820102780035, 115.42365978710446, 77.41881177560948, 56.93295520541374, 29.48024601873928, 93.89636076986592, 88.3901301390843, 44.475853944860674, 20.916779542176258, 74.32850413653895, 69.86212506770912, 122.59464980861257, 60.80317130938704, 101.77381964230484, 72.51121967837965, 82.97230446340842, 37.75248752197665, 67.11021514726987, 12.887667610201479, 79.24510405038914, 117.08679438379515, 82.92955058109047, 78.61364131078619, 113.12058183745681, 87.23144031704645, 82.37238870291063, 112.62467484811152, 40.40744193454995, 95.8837204367817, 121.55235071458085, 58.795249447275054, 89.44938924992718, 29.900698105061522, 64.16018547015591, 29.659917567265158, 41.94535903773096, 139.07910261517344, 130.7581303613935, 100.66165939372785, 30.546430786094383, 107.05477399778442, 80.60611463154248, 56.96179556087821, 104.14417594219192, 42.480615725520984, 75.91806634590829, 99.89894637221488, 31.00300980681229, 61.38096337375388, 95.940978334466, 112.65132774015109, 47.38765964952292, 52.735958675087204, 138.56071663893135, 18.013930592050077, -37.2025348044795, 73.22232404517703, 78.79531396773113, 13.397134527833174, -121.02876510626227, 171.93469483118665, 19.145449484737078, 3.0401120821772896, 91.14736109676691, 109.88392684336009, 87.37008059286984, 22.13404819307824, 48.008441755997445, 95.9525653252533, 157.76453734298596, 53.965396463460664, 60.24150951895487, 112.0068916540746, 118.35424968579356, 157.72799567425943, 29.49782604516897, 88.39475418173657, 51.61565131941007, 19.013453520948083, 117.89591554097656, 61.89272089950541, 81.95830623389514, 92.19920757651042, 129.7972122613551, 98.30629503434949, 116.71670283057531, 104.26157960631662, 121.47859504960991, 42.942749338837636, 123.63096762939745, 60.78152355503066, 120.90573913817086, 40.04732422352774], "policy_predator_policy_reward": [199.3316434562179, 178.90829478832734, 173.27510356977004, 145.91966165290242, 198.89987068089079, 93.37117901939928, 180.89378172934465, 195.13828963626986, 157.19739526215773, 149.80061221669098, 139.21611773253505, 165.06377691154316, 139.39204660282294, 131.83251289380183, 126.13157067917157, 144.54978573578487, 150.47000298120548, 181.19637172959287, 168.00667585758498, 136.07756941406177, 201.94915713340876, 131.43865847864353, 150.4636997272966, 177.96657103449257, 139.29609205915398, 149.36172523368856, 169.86746110891937, 178.59258929279494, 167.62987920610178, 118.36621162741308, 137.27103714287136, 114.35588256934301, 140.32738902952843, 144.7612491777706, 165.8050778783322, 201.07223227546743, 117.61371251277794, 132.4557685869042, 117.95236053311501, 126.05906638265944, 109.00371525262112, 107.13842485164083, 101.87978995515984, 91.83571846005195, 135.3106387478288, 106.37820745882789, 116.16827597463121, 127.74043437694057, 113.54092482226963, 116.23278047376009, 125.8398968763353, 109.2243080553294, 111.23523958297528, 117.34460609836336, 151.75042097176998, 141.39577892608074, 120.91208329297127, 131.33239679259373, 102.68157399779638, 103.36150962316093, 124.84484922539403, 151.95300903936436, 133.2201197926412, 135.40228126844147, 186.8382905179171, 178.8823831469169, 172.35735704457653, 157.2356904050187, 102.93072926343402, 82.17364878882452, 154.090726623402, 105.51218721117246, 155.60949282772634, 165.98305439706928, 123.1920293585329, 116.80454068988472, 107.01730663052307, 101.73448431368348, 138.21451001507927, 208.76758338810848, 177.63230673768464, 112.74309959831098, 215.46893517487706, 174.5999497538696, 136.65584499387555, 149.76143722684486, 146.6176786086066, 105.69948035844295, 117.98590040851538, 118.15769662305303, 104.57450450961511, 136.0677307541217, 113.07101584054168, 189.84283281679535, 84.55059858350673, 114.85863819231541, 139.63765450040358, 94.89981640780638, 119.42723013105132, 144.46847685571356, 171.3331877278033, 51.38155782457075, 126.31812932969126, 97.20576792042459, 70.8985321074369, 90.01538535435478, 102.04222831195865, 150.31598916544073, 113.11141380602146, 75.39260213557124, 131.49094721903128, 184.909393511763, 95.2677309684372, 69.52499539279123, 118.96641898077213, 174.68633339095643, 132.86908456826583, 125.2614542300896, 124.69613464857213, 99.5990038918844, 106.02836084562547, 88.88498671688208, 147.92704457899015, 150.5265742299983, 89.13244612737682, 185.4443952986451, 115.06580382018709, 103.39621165520437, 149.5751801466444, 87.04603627863312, 114.78910208858224, 87.5130713588963, 93.87121005679424, 113.52640596802746, 135.4673198115058, 149.68563276376932, 81.36005181310362, 67.08751316965044, 148.39065651596871, 124.74989919104429, 231.5184089352416, 94.53572922807314, 118.84435675570545, 122.62031469260181, 102.15976111802992, 104.81101457013634, 118.10398738774693, 160.80231012551525, 128.2968006857958, 121.70865036951318, 133.40814418147133, 143.72422855016808, 130.70080238053438, 130.00469058211465, 103.12351805170067, 170.46112969270683, 99.89160864682414, 90.12970381234838, 143.59643301431774, 160.5537577612338, 166.48327700699417, 103.71318236958575, 148.66923887730664, 238.8171736504035, 151.79259319060282, 170.7870049532676, 269.0399337206882, 222.875668129704, 159.53458114047635, 212.70914904227848, 139.0487696727229, 88.26098876327981, 164.80378426610656, 166.46849757478824, 115.6250797942843, 143.4844552420803, 77.6294804961078, 113.75781330483724, 115.16182741316611, 138.76038995285802, 83.51647540731517, 67.96047117859013, 150.39276671738523, 119.64974267542526, 185.20113912843905, 203.30065098204156, 105.171537100932, 122.02736478381355, 117.6711033951329, 121.05915222169607, 100.799007591696, 101.14276295940756, 89.2635339860112, 79.9199655376844, 138.23651270486562, 124.24215620411965, 85.83526777037864, 110.39040274499658, 140.03164947610415, 142.27726817285944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6394421382186904, "mean_inference_ms": 2.0103011631398284, "mean_action_processing_ms": 0.26535506546394266, "mean_env_wait_ms": 0.24509812278418813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003702878952026367, "StateBufferConnector_ms": 0.004159450531005859, "ViewRequirementAgentConnector_ms": 0.0917586088180542}, "num_episodes": 22, "episode_return_max": 542.8215315753168, "episode_return_min": 278.9046301317982, "episode_return_mean": 398.9124051133611, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 407.021731968347, "num_env_steps_trained_throughput_per_sec": 407.021731968347, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 11456.099, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11456.013, "sample_time_ms": 1794.477, "learn_time_ms": 9639.359, "learn_throughput": 414.965, "synch_weights_time_ms": 19.353}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-20", "timestamp": 1723779140, "time_this_iter_s": 9.833360195159912, "time_total_s": 948.5111064910889, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20deaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 948.5111064910889, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 31.271428571428572, "ram_util_percent": 83.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.165898524831842, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.759557105624487, "policy_loss": -0.0009009792898145933, "vf_loss": 7.759099164337077, "vf_explained_var": 0.01982040626031381, "kl": 0.008052722075297405, "entropy": 0.47830478012877164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.058228269329778, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.548409869178894, "policy_loss": -0.012300123197701636, "vf_loss": 8.559622076579503, "vf_explained_var": 0.13551294270646635, "kl": 0.014505528055793962, "entropy": 1.2960916081433573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 542.8215315753168, "episode_reward_min": 278.9046301317982, "episode_reward_mean": 403.91265027338324, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.02876510626227, "predator_policy": 51.38155782457075}, "policy_reward_max": {"prey_policy": 176.00491129845815, "predator_policy": 269.0399337206882}, "policy_reward_mean": {"prey_policy": 76.10931544337467, "predator_policy": 125.84700969331692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.8498432597133, 423.43190344238644, 402.7184680526636, 398.4152752136259, 383.55852445375194, 411.71485514185525, 434.5285389481013, 357.7412074709783, 410.62497858731484, 399.33897561022627, 384.3143537937962, 400.55424988369145, 350.294998555855, 395.7055581293674, 429.66778375550086, 439.2632708045397, 278.9046301317982, 325.03347207235595, 442.41713580903127, 425.01581715353285, 396.9390301155748, 421.6568638856884, 419.5642413557714, 437.9827300742476, 402.83570112527474, 401.00108067014554, 374.820347102944, 378.95704957834005, 347.5530506756776, 397.4272477714639, 359.1994265041824, 396.7565920986754, 356.79999762748645, 397.25536470719254, 372.6524508935218, 300.9742952313937, 381.3464875043066, 402.813541954948, 347.07921727017833, 359.04538585876537, 402.3211680026032, 407.6929596584561, 369.1983868831916, 419.1784107943741, 354.57472418349323, 414.7939139095763, 398.16440831715533, 402.6541956019821, 402.3946795758438, 421.4441149466072, 328.7951651446103, 392.49064306200165, 419.8742412007359, 422.48913310121156, 438.39056544328713, 416.5075022971404, 387.57336124772934, 423.7571643993521, 436.5225056807718, 365.96862092497315, 398.61361853378946, 404.27380910016205, 426.77110660756085, 423.5062017684073, 414.7720466394346, 542.8215315753168, 394.42929174966895, 428.34104637612927, 440.7764106268426, 403.07054211761624, 403.11722760739104, 426.17061853905386, 427.55919194595765, 387.93508961971594, 459.13089495083955, 406.9875383252284, 412.8877694272343, 430.04527784680835, 390.16178196058854, 426.9000132974325, 380.63816169980356, 443.2619810106623, 441.8265540330012, 416.11099167545973, 410.21855176983183, 416.40085418771304, 431.69495682242376, 430.49636641532567, 428.7856078773729, 436.91856301644924, 395.44397301844833, 402.22134643697325, 449.66859759721046, 436.82058121575955, 445.43359100598724, 461.88686778636065, 439.5757725267796, 400.01167419684555, 313.84393964239126, 380.1952801373864], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.52654671042357, 75.25381544960656, 74.70880932551474, 104.7116672010971, 90.7947036275585, 95.78162432084365, 85.64914935311236, 119.05061744530175, 66.54192296782949, 75.32775527926594, 63.36979070533655, 104.43635408494616, 87.05193248779116, 117.7029011642791, 72.18640209716982, 50.49060044214338, 89.75326728296474, 92.29186562301116, 31.60100460823578, 74.59177110413899, 64.6305517234366, 67.43932198479435, 92.50583351436761, 102.00533274836708, 43.05461534446608, 30.44252494663054, 85.96326531297886, 41.11989175530492, 30.16597932673398, 33.78113076393233, 28.831410349150396, 80.83881300579421, 73.10559958604497, 20.694652493494576, 31.62414346292374, 33.806414774858034, 47.398634294139384, 73.4259542900965, 84.18854550625028, 100.83070159886533, 106.1007853523259, 82.08645381904185, 44.999103004716936, 29.675667477783428, 78.88257248889964, 50.3062625308761, 21.75100756767574, 26.162837577826206, 78.641682342496, 37.77673656205817, 76.6708135562266, 72.01310814687001, 75.46652933937793, 63.21022073199806, 47.93695711254511, 90.37785720205909, -19.19487231521606, 63.83407433355656, 108.23357668094039, 89.78443431470143, 51.37496228763744, 73.28699330833493, 68.02890588250592, 64.83197922940496, 56.16725656880212, 77.91799550630965, 110.41541746657211, 63.31604999050435, 97.4348735289691, 114.30365990276037, 2.5378767261939164, 46.07820102780035, 115.42365978710446, 77.41881177560948, 56.93295520541374, 29.48024601873928, 93.89636076986592, 88.3901301390843, 44.475853944860674, 20.916779542176258, 74.32850413653895, 69.86212506770912, 122.59464980861257, 60.80317130938704, 101.77381964230484, 72.51121967837965, 82.97230446340842, 37.75248752197665, 67.11021514726987, 12.887667610201479, 79.24510405038914, 117.08679438379515, 82.92955058109047, 78.61364131078619, 113.12058183745681, 87.23144031704645, 82.37238870291063, 112.62467484811152, 40.40744193454995, 95.8837204367817, 121.55235071458085, 58.795249447275054, 89.44938924992718, 29.900698105061522, 64.16018547015591, 29.659917567265158, 41.94535903773096, 139.07910261517344, 130.7581303613935, 100.66165939372785, 30.546430786094383, 107.05477399778442, 80.60611463154248, 56.96179556087821, 104.14417594219192, 42.480615725520984, 75.91806634590829, 99.89894637221488, 31.00300980681229, 61.38096337375388, 95.940978334466, 112.65132774015109, 47.38765964952292, 52.735958675087204, 138.56071663893135, 18.013930592050077, -37.2025348044795, 73.22232404517703, 78.79531396773113, 13.397134527833174, -121.02876510626227, 171.93469483118665, 19.145449484737078, 3.0401120821772896, 91.14736109676691, 109.88392684336009, 87.37008059286984, 22.13404819307824, 48.008441755997445, 95.9525653252533, 157.76453734298596, 53.965396463460664, 60.24150951895487, 112.0068916540746, 118.35424968579356, 157.72799567425943, 29.49782604516897, 88.39475418173657, 51.61565131941007, 19.013453520948083, 117.89591554097656, 61.89272089950541, 81.95830623389514, 92.19920757651042, 129.7972122613551, 98.30629503434949, 116.71670283057531, 104.26157960631662, 121.47859504960991, 42.942749338837636, 123.63096762939745, 60.78152355503066, 120.90573913817086, 40.04732422352774, 136.73073787493462, 67.71460643419495, 129.03550202426226, 106.97159650395878, 70.88157572960927, 151.54727161172633, 145.83669930772984, 98.56570746560624, 71.05800485363262, 130.27675953320173, 32.062329599984395, 119.67423913662071, 125.70270030963088, 57.41698708158669, 55.58917430740872, 118.29392016024622, 77.91290213843847, 118.34594111748004, 112.42802074076026, 51.078293052063465, 72.17716832595073, 148.98791923421658, 54.040925109178104, 110.53465203923182, 102.26230957357305, 35.396309480911306, 176.00491129845815, 62.015065559562785, 32.752625960680504, 134.7333350430139, 53.78379257712124, 145.08966331267823, 35.76419620810495, 111.68519849056999, 114.20404694383414, 84.73113995197647], "policy_predator_policy_reward": [117.61371251277794, 132.4557685869042, 117.95236053311501, 126.05906638265944, 109.00371525262112, 107.13842485164083, 101.87978995515984, 91.83571846005195, 135.3106387478288, 106.37820745882789, 116.16827597463121, 127.74043437694057, 113.54092482226963, 116.23278047376009, 125.8398968763353, 109.2243080553294, 111.23523958297528, 117.34460609836336, 151.75042097176998, 141.39577892608074, 120.91208329297127, 131.33239679259373, 102.68157399779638, 103.36150962316093, 124.84484922539403, 151.95300903936436, 133.2201197926412, 135.40228126844147, 186.8382905179171, 178.8823831469169, 172.35735704457653, 157.2356904050187, 102.93072926343402, 82.17364878882452, 154.090726623402, 105.51218721117246, 155.60949282772634, 165.98305439706928, 123.1920293585329, 116.80454068988472, 107.01730663052307, 101.73448431368348, 138.21451001507927, 208.76758338810848, 177.63230673768464, 112.74309959831098, 215.46893517487706, 174.5999497538696, 136.65584499387555, 149.76143722684486, 146.6176786086066, 105.69948035844295, 117.98590040851538, 118.15769662305303, 104.57450450961511, 136.0677307541217, 113.07101584054168, 189.84283281679535, 84.55059858350673, 114.85863819231541, 139.63765450040358, 94.89981640780638, 119.42723013105132, 144.46847685571356, 171.3331877278033, 51.38155782457075, 126.31812932969126, 97.20576792042459, 70.8985321074369, 90.01538535435478, 102.04222831195865, 150.31598916544073, 113.11141380602146, 75.39260213557124, 131.49094721903128, 184.909393511763, 95.2677309684372, 69.52499539279123, 118.96641898077213, 174.68633339095643, 132.86908456826583, 125.2614542300896, 124.69613464857213, 99.5990038918844, 106.02836084562547, 88.88498671688208, 147.92704457899015, 150.5265742299983, 89.13244612737682, 185.4443952986451, 115.06580382018709, 103.39621165520437, 149.5751801466444, 87.04603627863312, 114.78910208858224, 87.5130713588963, 93.87121005679424, 113.52640596802746, 135.4673198115058, 149.68563276376932, 81.36005181310362, 67.08751316965044, 148.39065651596871, 124.74989919104429, 231.5184089352416, 94.53572922807314, 118.84435675570545, 122.62031469260181, 102.15976111802992, 104.81101457013634, 118.10398738774693, 160.80231012551525, 128.2968006857958, 121.70865036951318, 133.40814418147133, 143.72422855016808, 130.70080238053438, 130.00469058211465, 103.12351805170067, 170.46112969270683, 99.89160864682414, 90.12970381234838, 143.59643301431774, 160.5537577612338, 166.48327700699417, 103.71318236958575, 148.66923887730664, 238.8171736504035, 151.79259319060282, 170.7870049532676, 269.0399337206882, 222.875668129704, 159.53458114047635, 212.70914904227848, 139.0487696727229, 88.26098876327981, 164.80378426610656, 166.46849757478824, 115.6250797942843, 143.4844552420803, 77.6294804961078, 113.75781330483724, 115.16182741316611, 138.76038995285802, 83.51647540731517, 67.96047117859013, 150.39276671738523, 119.64974267542526, 185.20113912843905, 203.30065098204156, 105.171537100932, 122.02736478381355, 117.6711033951329, 121.05915222169607, 100.799007591696, 101.14276295940756, 89.2635339860112, 79.9199655376844, 138.23651270486562, 124.24215620411965, 85.83526777037864, 110.39040274499658, 140.03164947610415, 142.27726817285944, 119.48760689446839, 117.89360282940345, 93.57805266226879, 86.52584048496978, 98.70765244453494, 89.08205198396062, 82.92528309023821, 89.07316432413869, 114.06070709621325, 116.29948533937616, 106.90284151238995, 171.85695616632992, 114.98994531104368, 130.67597517511112, 124.54856127375761, 138.4869072750368, 106.006252590876, 93.17887717165412, 106.9285307034444, 131.78650194070616, 119.23441546850141, 109.26909456854138, 148.68533712670208, 123.55966694064715, 147.25478423166092, 160.52018771984083, 115.36475169417393, 108.50213923416575, 116.38989015163291, 155.6999213714518, 98.4583271044514, 102.67989120259469, 112.56380809590935, 53.830736847806925, 108.33382274103221, 72.92627050054355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6386207711102418, "mean_inference_ms": 2.0076743292814796, "mean_action_processing_ms": 0.2649582536031423, "mean_env_wait_ms": 0.24474685577236066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.08791983127593994}, "num_episodes": 18, "episode_return_max": 542.8215315753168, "episode_return_min": 278.9046301317982, "episode_return_mean": 403.91265027338324, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.424413589592, "num_env_steps_trained_throughput_per_sec": 390.424413589592, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 11390.727, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11390.641, "sample_time_ms": 1779.416, "learn_time_ms": 9589.548, "learn_throughput": 417.121, "synch_weights_time_ms": 18.992}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-30", "timestamp": 1723779150, "time_this_iter_s": 10.277740955352783, "time_total_s": 958.7888474464417, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20deb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 958.7888474464417, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 30.753333333333337, "ram_util_percent": 82.79333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.001607577321391, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.146895351107158, "policy_loss": -0.0026277838210777317, "vf_loss": 8.148118118255857, "vf_explained_var": 0.05807372319004523, "kl": 0.00832605001723692, "entropy": 0.4962632010538111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.095108040426143, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.714779510195292, "policy_loss": -0.013471478336520256, "vf_loss": 8.727103032258453, "vf_explained_var": 0.09206097072394437, "kl": 0.015306144322344175, "entropy": 1.2452972021052446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 542.8215315753168, "episode_reward_min": 250.2088926214758, "episode_reward_mean": 401.66727632521406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.02876510626227, "predator_policy": 36.24715131484174}, "policy_reward_max": {"prey_policy": 176.00491129845815, "predator_policy": 269.0399337206882}, "policy_reward_mean": {"prey_policy": 85.96508110007359, "predator_policy": 114.8685570625334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [437.9827300742476, 402.83570112527474, 401.00108067014554, 374.820347102944, 378.95704957834005, 347.5530506756776, 397.4272477714639, 359.1994265041824, 396.7565920986754, 356.79999762748645, 397.25536470719254, 372.6524508935218, 300.9742952313937, 381.3464875043066, 402.813541954948, 347.07921727017833, 359.04538585876537, 402.3211680026032, 407.6929596584561, 369.1983868831916, 419.1784107943741, 354.57472418349323, 414.7939139095763, 398.16440831715533, 402.6541956019821, 402.3946795758438, 421.4441149466072, 328.7951651446103, 392.49064306200165, 419.8742412007359, 422.48913310121156, 438.39056544328713, 416.5075022971404, 387.57336124772934, 423.7571643993521, 436.5225056807718, 365.96862092497315, 398.61361853378946, 404.27380910016205, 426.77110660756085, 423.5062017684073, 414.7720466394346, 542.8215315753168, 394.42929174966895, 428.34104637612927, 440.7764106268426, 403.07054211761624, 403.11722760739104, 426.17061853905386, 427.55919194595765, 387.93508961971594, 459.13089495083955, 406.9875383252284, 412.8877694272343, 430.04527784680835, 390.16178196058854, 426.9000132974325, 380.63816169980356, 443.2619810106623, 441.8265540330012, 416.11099167545973, 410.21855176983183, 416.40085418771304, 431.69495682242376, 430.49636641532567, 428.7856078773729, 436.91856301644924, 395.44397301844833, 402.22134643697325, 449.66859759721046, 436.82058121575955, 445.43359100598724, 461.88686778636065, 439.5757725267796, 400.01167419684555, 313.84393964239126, 380.1952801373864, 387.98479169336457, 420.1000158239114, 391.6978299358023, 376.06704764437103, 356.74892647521904, 416.8334816901622, 398.8719041138042, 376.89903824231715, 394.7590908135256, 250.2088926214758, 412.92296195219393, 410.8967877854019, 382.66835551216957, 377.0491459658372, 429.6173883678553, 417.7723193708417, 397.6475309094674, 395.03497001294124, 335.0603133780897, 383.7969820184631, 398.6781050583876, 385.77512605271, 420.62557537188843], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [21.75100756767574, 26.162837577826206, 78.641682342496, 37.77673656205817, 76.6708135562266, 72.01310814687001, 75.46652933937793, 63.21022073199806, 47.93695711254511, 90.37785720205909, -19.19487231521606, 63.83407433355656, 108.23357668094039, 89.78443431470143, 51.37496228763744, 73.28699330833493, 68.02890588250592, 64.83197922940496, 56.16725656880212, 77.91799550630965, 110.41541746657211, 63.31604999050435, 97.4348735289691, 114.30365990276037, 2.5378767261939164, 46.07820102780035, 115.42365978710446, 77.41881177560948, 56.93295520541374, 29.48024601873928, 93.89636076986592, 88.3901301390843, 44.475853944860674, 20.916779542176258, 74.32850413653895, 69.86212506770912, 122.59464980861257, 60.80317130938704, 101.77381964230484, 72.51121967837965, 82.97230446340842, 37.75248752197665, 67.11021514726987, 12.887667610201479, 79.24510405038914, 117.08679438379515, 82.92955058109047, 78.61364131078619, 113.12058183745681, 87.23144031704645, 82.37238870291063, 112.62467484811152, 40.40744193454995, 95.8837204367817, 121.55235071458085, 58.795249447275054, 89.44938924992718, 29.900698105061522, 64.16018547015591, 29.659917567265158, 41.94535903773096, 139.07910261517344, 130.7581303613935, 100.66165939372785, 30.546430786094383, 107.05477399778442, 80.60611463154248, 56.96179556087821, 104.14417594219192, 42.480615725520984, 75.91806634590829, 99.89894637221488, 31.00300980681229, 61.38096337375388, 95.940978334466, 112.65132774015109, 47.38765964952292, 52.735958675087204, 138.56071663893135, 18.013930592050077, -37.2025348044795, 73.22232404517703, 78.79531396773113, 13.397134527833174, -121.02876510626227, 171.93469483118665, 19.145449484737078, 3.0401120821772896, 91.14736109676691, 109.88392684336009, 87.37008059286984, 22.13404819307824, 48.008441755997445, 95.9525653252533, 157.76453734298596, 53.965396463460664, 60.24150951895487, 112.0068916540746, 118.35424968579356, 157.72799567425943, 29.49782604516897, 88.39475418173657, 51.61565131941007, 19.013453520948083, 117.89591554097656, 61.89272089950541, 81.95830623389514, 92.19920757651042, 129.7972122613551, 98.30629503434949, 116.71670283057531, 104.26157960631662, 121.47859504960991, 42.942749338837636, 123.63096762939745, 60.78152355503066, 120.90573913817086, 40.04732422352774, 136.73073787493462, 67.71460643419495, 129.03550202426226, 106.97159650395878, 70.88157572960927, 151.54727161172633, 145.83669930772984, 98.56570746560624, 71.05800485363262, 130.27675953320173, 32.062329599984395, 119.67423913662071, 125.70270030963088, 57.41698708158669, 55.58917430740872, 118.29392016024622, 77.91290213843847, 118.34594111748004, 112.42802074076026, 51.078293052063465, 72.17716832595073, 148.98791923421658, 54.040925109178104, 110.53465203923182, 102.26230957357305, 35.396309480911306, 176.00491129845815, 62.015065559562785, 32.752625960680504, 134.7333350430139, 53.78379257712124, 145.08966331267823, 35.76419620810495, 111.68519849056999, 114.20404694383414, 84.73113995197647, 107.73822803767517, 139.77631549384986, 148.72337959115129, 73.06684667908857, 133.64886806533255, 71.32009331278519, 91.59042004321799, 88.51607944015232, 77.37385666588763, 65.5039901527279, 86.63043518788407, 152.2265474036546, 132.29539818530185, 141.98939026899734, 160.85356795500803, 127.69661006493315, 88.92567174972214, 157.45667011190847, 44.978479654910615, -41.4433402129006, 147.11186462654535, 73.22627616566223, 59.105967389643006, 153.82982890799943, 85.7047517536423, 138.8689300105537, 1.8287640140049923, 152.18116009656532, 166.51505236925124, 106.90133410943847, 159.9199520064603, 126.30701466290326, 170.12063081875914, 139.86758534532163, 49.009384774789716, 137.10649908666147, 68.86879825458963, 68.39168520928662, 145.84538378310964, 139.1633117199736, 142.2253761404654, 91.83176982113007, 157.32111048552676, 142.81904834115238, 146.77938880947417, 166.16141752243274], "policy_predator_policy_reward": [215.46893517487706, 174.5999497538696, 136.65584499387555, 149.76143722684486, 146.6176786086066, 105.69948035844295, 117.98590040851538, 118.15769662305303, 104.57450450961511, 136.0677307541217, 113.07101584054168, 189.84283281679535, 84.55059858350673, 114.85863819231541, 139.63765450040358, 94.89981640780638, 119.42723013105132, 144.46847685571356, 171.3331877278033, 51.38155782457075, 126.31812932969126, 97.20576792042459, 70.8985321074369, 90.01538535435478, 102.04222831195865, 150.31598916544073, 113.11141380602146, 75.39260213557124, 131.49094721903128, 184.909393511763, 95.2677309684372, 69.52499539279123, 118.96641898077213, 174.68633339095643, 132.86908456826583, 125.2614542300896, 124.69613464857213, 99.5990038918844, 106.02836084562547, 88.88498671688208, 147.92704457899015, 150.5265742299983, 89.13244612737682, 185.4443952986451, 115.06580382018709, 103.39621165520437, 149.5751801466444, 87.04603627863312, 114.78910208858224, 87.5130713588963, 93.87121005679424, 113.52640596802746, 135.4673198115058, 149.68563276376932, 81.36005181310362, 67.08751316965044, 148.39065651596871, 124.74989919104429, 231.5184089352416, 94.53572922807314, 118.84435675570545, 122.62031469260181, 102.15976111802992, 104.81101457013634, 118.10398738774693, 160.80231012551525, 128.2968006857958, 121.70865036951318, 133.40814418147133, 143.72422855016808, 130.70080238053438, 130.00469058211465, 103.12351805170067, 170.46112969270683, 99.89160864682414, 90.12970381234838, 143.59643301431774, 160.5537577612338, 166.48327700699417, 103.71318236958575, 148.66923887730664, 238.8171736504035, 151.79259319060282, 170.7870049532676, 269.0399337206882, 222.875668129704, 159.53458114047635, 212.70914904227848, 139.0487696727229, 88.26098876327981, 164.80378426610656, 166.46849757478824, 115.6250797942843, 143.4844552420803, 77.6294804961078, 113.75781330483724, 115.16182741316611, 138.76038995285802, 83.51647540731517, 67.96047117859013, 150.39276671738523, 119.64974267542526, 185.20113912843905, 203.30065098204156, 105.171537100932, 122.02736478381355, 117.6711033951329, 121.05915222169607, 100.799007591696, 101.14276295940756, 89.2635339860112, 79.9199655376844, 138.23651270486562, 124.24215620411965, 85.83526777037864, 110.39040274499658, 140.03164947610415, 142.27726817285944, 119.48760689446839, 117.89360282940345, 93.57805266226879, 86.52584048496978, 98.70765244453494, 89.08205198396062, 82.92528309023821, 89.07316432413869, 114.06070709621325, 116.29948533937616, 106.90284151238995, 171.85695616632992, 114.98994531104368, 130.67597517511112, 124.54856127375761, 138.4869072750368, 106.006252590876, 93.17887717165412, 106.9285307034444, 131.78650194070616, 119.23441546850141, 109.26909456854138, 148.68533712670208, 123.55966694064715, 147.25478423166092, 160.52018771984083, 115.36475169417393, 108.50213923416575, 116.38989015163291, 155.6999213714518, 98.4583271044514, 102.67989120259469, 112.56380809590935, 53.830736847806925, 108.33382274103221, 72.92627050054355, 87.69706244044977, 52.77318572138942, 98.29487521573773, 100.01491433793441, 96.18039153830651, 90.54847701937804, 103.56971621462418, 92.39083194637612, 115.57791598210376, 98.2931636744999, 107.26042408003892, 70.71607501858502, 63.27338382928937, 61.31373183021561, 44.098345419967956, 44.25051480240772, 75.3001452581838, 73.07660369371166, 94.04823484300559, 152.62551833645992, 94.48931346972444, 98.09550769026144, 112.51320688893104, 85.4477845988284, 56.90885906764894, 101.18581468032451, 177.13111031264467, 45.908111542622805, 72.87849960049905, 83.32250228866606, 65.82625787711343, 65.7190948243646, 51.412163430544815, 36.24715131484174, 107.6297216746301, 101.28936447685952, 117.15859625101754, 80.64123366319556, 61.35288597522116, 37.435400540158675, 100.3300804759509, 64.29087862084215, 48.237849677911164, 37.397117548120065, 58.391133098463904, 49.293635941517145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6374079225434252, "mean_inference_ms": 2.0042699319760815, "mean_action_processing_ms": 0.2644611230661421, "mean_env_wait_ms": 0.2442734032766955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038208961486816406, "StateBufferConnector_ms": 0.00361788272857666, "ViewRequirementAgentConnector_ms": 0.0887221097946167}, "num_episodes": 23, "episode_return_max": 542.8215315753168, "episode_return_min": 250.2088926214758, "episode_return_mean": 401.66727632521406, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.1315861529417, "num_env_steps_trained_throughput_per_sec": 390.1315861529417, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 11304.016, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11303.93, "sample_time_ms": 1755.21, "learn_time_ms": 9526.526, "learn_throughput": 419.88, "synch_weights_time_ms": 19.491}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-40", "timestamp": 1723779160, "time_this_iter_s": 10.262318849563599, "time_total_s": 969.0511662960052, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20de160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 969.0511662960052, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 32.03333333333334, "ram_util_percent": 83.0133333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.553690419878278, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.761437276809934, "policy_loss": -0.005164048439581637, "vf_loss": 8.76518677605523, "vf_explained_var": 0.12945753739624427, "kl": 0.008382403437406805, "entropy": 0.454006185843831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.908259279418875, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.009111941806854, "policy_loss": -0.0071051658084369685, "vf_loss": 9.01534862013721, "vf_explained_var": 0.047694461812417974, "kl": 0.011579934864555455, "entropy": 1.2139605660917898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 542.8215315753168, "episode_reward_min": 250.2088926214758, "episode_reward_mean": 401.9911366729864, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.02876510626227, "predator_policy": 7.330532388554973}, "policy_reward_max": {"prey_policy": 185.06557148360403, "predator_policy": 269.0399337206882}, "policy_reward_mean": {"prey_policy": 99.41716704847055, "predator_policy": 101.57840128802265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.6929596584561, 369.1983868831916, 419.1784107943741, 354.57472418349323, 414.7939139095763, 398.16440831715533, 402.6541956019821, 402.3946795758438, 421.4441149466072, 328.7951651446103, 392.49064306200165, 419.8742412007359, 422.48913310121156, 438.39056544328713, 416.5075022971404, 387.57336124772934, 423.7571643993521, 436.5225056807718, 365.96862092497315, 398.61361853378946, 404.27380910016205, 426.77110660756085, 423.5062017684073, 414.7720466394346, 542.8215315753168, 394.42929174966895, 428.34104637612927, 440.7764106268426, 403.07054211761624, 403.11722760739104, 426.17061853905386, 427.55919194595765, 387.93508961971594, 459.13089495083955, 406.9875383252284, 412.8877694272343, 430.04527784680835, 390.16178196058854, 426.9000132974325, 380.63816169980356, 443.2619810106623, 441.8265540330012, 416.11099167545973, 410.21855176983183, 416.40085418771304, 431.69495682242376, 430.49636641532567, 428.7856078773729, 436.91856301644924, 395.44397301844833, 402.22134643697325, 449.66859759721046, 436.82058121575955, 445.43359100598724, 461.88686778636065, 439.5757725267796, 400.01167419684555, 313.84393964239126, 380.1952801373864, 387.98479169336457, 420.1000158239114, 391.6978299358023, 376.06704764437103, 356.74892647521904, 416.8334816901622, 398.8719041138042, 376.89903824231715, 394.7590908135256, 250.2088926214758, 412.92296195219393, 410.8967877854019, 382.66835551216957, 377.0491459658372, 429.6173883678553, 417.7723193708417, 397.6475309094674, 395.03497001294124, 335.0603133780897, 383.7969820184631, 398.6781050583876, 385.77512605271, 420.62557537188843, 392.84048972755625, 390.42723592158814, 424.3409328839524, 372.80298890399104, 406.32940857731415, 392.7274837570321, 459.6878443390186, 377.9872579728262, 395.3508067394322, 380.9226709197866, 286.9491146639242, 323.39546521269756, 384.4713644580059, 332.55411950952583, 362.51883005090275, 368.12528242580936, 384.3432970629096, 413.4325763023171], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [122.59464980861257, 60.80317130938704, 101.77381964230484, 72.51121967837965, 82.97230446340842, 37.75248752197665, 67.11021514726987, 12.887667610201479, 79.24510405038914, 117.08679438379515, 82.92955058109047, 78.61364131078619, 113.12058183745681, 87.23144031704645, 82.37238870291063, 112.62467484811152, 40.40744193454995, 95.8837204367817, 121.55235071458085, 58.795249447275054, 89.44938924992718, 29.900698105061522, 64.16018547015591, 29.659917567265158, 41.94535903773096, 139.07910261517344, 130.7581303613935, 100.66165939372785, 30.546430786094383, 107.05477399778442, 80.60611463154248, 56.96179556087821, 104.14417594219192, 42.480615725520984, 75.91806634590829, 99.89894637221488, 31.00300980681229, 61.38096337375388, 95.940978334466, 112.65132774015109, 47.38765964952292, 52.735958675087204, 138.56071663893135, 18.013930592050077, -37.2025348044795, 73.22232404517703, 78.79531396773113, 13.397134527833174, -121.02876510626227, 171.93469483118665, 19.145449484737078, 3.0401120821772896, 91.14736109676691, 109.88392684336009, 87.37008059286984, 22.13404819307824, 48.008441755997445, 95.9525653252533, 157.76453734298596, 53.965396463460664, 60.24150951895487, 112.0068916540746, 118.35424968579356, 157.72799567425943, 29.49782604516897, 88.39475418173657, 51.61565131941007, 19.013453520948083, 117.89591554097656, 61.89272089950541, 81.95830623389514, 92.19920757651042, 129.7972122613551, 98.30629503434949, 116.71670283057531, 104.26157960631662, 121.47859504960991, 42.942749338837636, 123.63096762939745, 60.78152355503066, 120.90573913817086, 40.04732422352774, 136.73073787493462, 67.71460643419495, 129.03550202426226, 106.97159650395878, 70.88157572960927, 151.54727161172633, 145.83669930772984, 98.56570746560624, 71.05800485363262, 130.27675953320173, 32.062329599984395, 119.67423913662071, 125.70270030963088, 57.41698708158669, 55.58917430740872, 118.29392016024622, 77.91290213843847, 118.34594111748004, 112.42802074076026, 51.078293052063465, 72.17716832595073, 148.98791923421658, 54.040925109178104, 110.53465203923182, 102.26230957357305, 35.396309480911306, 176.00491129845815, 62.015065559562785, 32.752625960680504, 134.7333350430139, 53.78379257712124, 145.08966331267823, 35.76419620810495, 111.68519849056999, 114.20404694383414, 84.73113995197647, 107.73822803767517, 139.77631549384986, 148.72337959115129, 73.06684667908857, 133.64886806533255, 71.32009331278519, 91.59042004321799, 88.51607944015232, 77.37385666588763, 65.5039901527279, 86.63043518788407, 152.2265474036546, 132.29539818530185, 141.98939026899734, 160.85356795500803, 127.69661006493315, 88.92567174972214, 157.45667011190847, 44.978479654910615, -41.4433402129006, 147.11186462654535, 73.22627616566223, 59.105967389643006, 153.82982890799943, 85.7047517536423, 138.8689300105537, 1.8287640140049923, 152.18116009656532, 166.51505236925124, 106.90133410943847, 159.9199520064603, 126.30701466290326, 170.12063081875914, 139.86758534532163, 49.009384774789716, 137.10649908666147, 68.86879825458963, 68.39168520928662, 145.84538378310964, 139.1633117199736, 142.2253761404654, 91.83176982113007, 157.32111048552676, 142.81904834115238, 146.77938880947417, 166.16141752243274, 144.1274505615055, 185.06557148360403, 184.01283526909774, 180.65972790609433, 154.5383230127732, 160.64322132894682, 170.5789800905035, 176.97543475623695, 143.01842750416873, 168.72403389265713, 177.05365258049832, 172.32601554551988, 148.18933116543877, 0.6791195852480001, 155.88847208918594, 171.9074231745797, 177.4955630805233, 168.5190020190972, 142.3842907549981, 147.3010380485574, 56.87726898480099, 87.8498114429118, 47.236736258097025, 70.4515540302766, 157.32925409172339, 177.4757752751918, 85.31429615775706, 94.32826190333843, 41.38887714378148, 138.84049461716137, 96.66103037982589, 153.79257362885699, 180.37172634104806, 180.07322199444482, 175.10552647052512, 146.71742807642875], "policy_predator_policy_reward": [124.69613464857213, 99.5990038918844, 106.02836084562547, 88.88498671688208, 147.92704457899015, 150.5265742299983, 89.13244612737682, 185.4443952986451, 115.06580382018709, 103.39621165520437, 149.5751801466444, 87.04603627863312, 114.78910208858224, 87.5130713588963, 93.87121005679424, 113.52640596802746, 135.4673198115058, 149.68563276376932, 81.36005181310362, 67.08751316965044, 148.39065651596871, 124.74989919104429, 231.5184089352416, 94.53572922807314, 118.84435675570545, 122.62031469260181, 102.15976111802992, 104.81101457013634, 118.10398738774693, 160.80231012551525, 128.2968006857958, 121.70865036951318, 133.40814418147133, 143.72422855016808, 130.70080238053438, 130.00469058211465, 103.12351805170067, 170.46112969270683, 99.89160864682414, 90.12970381234838, 143.59643301431774, 160.5537577612338, 166.48327700699417, 103.71318236958575, 148.66923887730664, 238.8171736504035, 151.79259319060282, 170.7870049532676, 269.0399337206882, 222.875668129704, 159.53458114047635, 212.70914904227848, 139.0487696727229, 88.26098876327981, 164.80378426610656, 166.46849757478824, 115.6250797942843, 143.4844552420803, 77.6294804961078, 113.75781330483724, 115.16182741316611, 138.76038995285802, 83.51647540731517, 67.96047117859013, 150.39276671738523, 119.64974267542526, 185.20113912843905, 203.30065098204156, 105.171537100932, 122.02736478381355, 117.6711033951329, 121.05915222169607, 100.799007591696, 101.14276295940756, 89.2635339860112, 79.9199655376844, 138.23651270486562, 124.24215620411965, 85.83526777037864, 110.39040274499658, 140.03164947610415, 142.27726817285944, 119.48760689446839, 117.89360282940345, 93.57805266226879, 86.52584048496978, 98.70765244453494, 89.08205198396062, 82.92528309023821, 89.07316432413869, 114.06070709621325, 116.29948533937616, 106.90284151238995, 171.85695616632992, 114.98994531104368, 130.67597517511112, 124.54856127375761, 138.4869072750368, 106.006252590876, 93.17887717165412, 106.9285307034444, 131.78650194070616, 119.23441546850141, 109.26909456854138, 148.68533712670208, 123.55966694064715, 147.25478423166092, 160.52018771984083, 115.36475169417393, 108.50213923416575, 116.38989015163291, 155.6999213714518, 98.4583271044514, 102.67989120259469, 112.56380809590935, 53.830736847806925, 108.33382274103221, 72.92627050054355, 87.69706244044977, 52.77318572138942, 98.29487521573773, 100.01491433793441, 96.18039153830651, 90.54847701937804, 103.56971621462418, 92.39083194637612, 115.57791598210376, 98.2931636744999, 107.26042408003892, 70.71607501858502, 63.27338382928937, 61.31373183021561, 44.098345419967956, 44.25051480240772, 75.3001452581838, 73.07660369371166, 94.04823484300559, 152.62551833645992, 94.48931346972444, 98.09550769026144, 112.51320688893104, 85.4477845988284, 56.90885906764894, 101.18581468032451, 177.13111031264467, 45.908111542622805, 72.87849960049905, 83.32250228866606, 65.82625787711343, 65.7190948243646, 51.412163430544815, 36.24715131484174, 107.6297216746301, 101.28936447685952, 117.15859625101754, 80.64123366319556, 61.35288597522116, 37.435400540158675, 100.3300804759509, 64.29087862084215, 48.237849677911164, 37.397117548120065, 58.391133098463904, 49.293635941517145, 43.546306767611036, 20.101160914835763, 14.872529646198451, 10.882143100197515, 55.7263868736087, 53.43300166862359, 15.804380512078586, 9.444193545171881, 51.0166372320791, 43.57030994840882, 18.966579875386536, 24.381235755627376, 166.71979162969015, 144.09960195864176, 32.09529760244927, 18.09606510661129, 21.258302642603642, 28.077938997208093, 44.08955890092599, 47.14778321530503, 115.69725455847588, 26.524779677735648, 162.21716367070673, 43.490011253617716, 30.514540749940736, 19.15179434114984, 39.47106010783917, 113.44050134059115, 41.28833796123274, 141.00112032872667, 52.212573003236734, 65.45910541389, 7.330532388554973, 16.567816338861665, 55.48037768287164, 36.12924407249159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6363949913932962, "mean_inference_ms": 2.001354253201369, "mean_action_processing_ms": 0.2640525533794658, "mean_env_wait_ms": 0.24384184231571843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00377810001373291, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.08860838413238525}, "num_episodes": 18, "episode_return_max": 542.8215315753168, "episode_return_min": 250.2088926214758, "episode_return_mean": 401.9911366729864, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 398.59300405465814, "num_env_steps_trained_throughput_per_sec": 398.59300405465814, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 11177.54, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11177.46, "sample_time_ms": 1712.181, "learn_time_ms": 9445.262, "learn_throughput": 423.493, "synch_weights_time_ms": 17.653}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "e552a_00000", "date": "2024-08-16_09-02-50", "timestamp": 1723779170, "time_this_iter_s": 10.071648120880127, "time_total_s": 979.1228144168854, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20de0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 979.1228144168854, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.314285714285717, "ram_util_percent": 83.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.7894761662634595, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.764710436170063, "policy_loss": -0.002654752135030413, "vf_loss": 8.766617932395329, "vf_explained_var": 0.1134581000085861, "kl": 0.0044281406582014704, "entropy": 0.4226903377859681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.407827117802605, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.05179359446127, "policy_loss": -0.004124433788465996, "vf_loss": 9.05529513737512, "vf_explained_var": 0.019051662702409048, "kl": 0.008305434868425143, "entropy": 1.1335896621936212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 542.8215315753168, "episode_reward_min": 250.2088926214758, "episode_reward_mean": 393.69787790394, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.02876510626227, "predator_policy": 5.664038131171388}, "policy_reward_max": {"prey_policy": 191.87801648377183, "predator_policy": 269.0399337206882}, "policy_reward_mean": {"prey_policy": 108.97870216372087, "predator_policy": 87.87023678824913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [423.5062017684073, 414.7720466394346, 542.8215315753168, 394.42929174966895, 428.34104637612927, 440.7764106268426, 403.07054211761624, 403.11722760739104, 426.17061853905386, 427.55919194595765, 387.93508961971594, 459.13089495083955, 406.9875383252284, 412.8877694272343, 430.04527784680835, 390.16178196058854, 426.9000132974325, 380.63816169980356, 443.2619810106623, 441.8265540330012, 416.11099167545973, 410.21855176983183, 416.40085418771304, 431.69495682242376, 430.49636641532567, 428.7856078773729, 436.91856301644924, 395.44397301844833, 402.22134643697325, 449.66859759721046, 436.82058121575955, 445.43359100598724, 461.88686778636065, 439.5757725267796, 400.01167419684555, 313.84393964239126, 380.1952801373864, 387.98479169336457, 420.1000158239114, 391.6978299358023, 376.06704764437103, 356.74892647521904, 416.8334816901622, 398.8719041138042, 376.89903824231715, 394.7590908135256, 250.2088926214758, 412.92296195219393, 410.8967877854019, 382.66835551216957, 377.0491459658372, 429.6173883678553, 417.7723193708417, 397.6475309094674, 395.03497001294124, 335.0603133780897, 383.7969820184631, 398.6781050583876, 385.77512605271, 420.62557537188843, 392.84048972755625, 390.42723592158814, 424.3409328839524, 372.80298890399104, 406.32940857731415, 392.7274837570321, 459.6878443390186, 377.9872579728262, 395.3508067394322, 380.9226709197866, 286.9491146639242, 323.39546521269756, 384.4713644580059, 332.55411950952583, 362.51883005090275, 368.12528242580936, 384.3432970629096, 413.4325763023171, 403.4893362759366, 387.5374174851573, 293.9693355886637, 409.7466374273851, 309.7675758845114, 368.56156104962923, 399.4438238649419, 391.46099682177396, 333.26884379792205, 314.44427473801636, 396.37368923553424, 391.31875979618127, 423.8177729995685, 426.5118377914063, 377.02067784082493, 294.8129781978479, 373.990587222544, 365.9827686007405, 356.4303956054789, 289.2156482586397, 337.0670453540839, 378.56538987257727], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-37.2025348044795, 73.22232404517703, 78.79531396773113, 13.397134527833174, -121.02876510626227, 171.93469483118665, 19.145449484737078, 3.0401120821772896, 91.14736109676691, 109.88392684336009, 87.37008059286984, 22.13404819307824, 48.008441755997445, 95.9525653252533, 157.76453734298596, 53.965396463460664, 60.24150951895487, 112.0068916540746, 118.35424968579356, 157.72799567425943, 29.49782604516897, 88.39475418173657, 51.61565131941007, 19.013453520948083, 117.89591554097656, 61.89272089950541, 81.95830623389514, 92.19920757651042, 129.7972122613551, 98.30629503434949, 116.71670283057531, 104.26157960631662, 121.47859504960991, 42.942749338837636, 123.63096762939745, 60.78152355503066, 120.90573913817086, 40.04732422352774, 136.73073787493462, 67.71460643419495, 129.03550202426226, 106.97159650395878, 70.88157572960927, 151.54727161172633, 145.83669930772984, 98.56570746560624, 71.05800485363262, 130.27675953320173, 32.062329599984395, 119.67423913662071, 125.70270030963088, 57.41698708158669, 55.58917430740872, 118.29392016024622, 77.91290213843847, 118.34594111748004, 112.42802074076026, 51.078293052063465, 72.17716832595073, 148.98791923421658, 54.040925109178104, 110.53465203923182, 102.26230957357305, 35.396309480911306, 176.00491129845815, 62.015065559562785, 32.752625960680504, 134.7333350430139, 53.78379257712124, 145.08966331267823, 35.76419620810495, 111.68519849056999, 114.20404694383414, 84.73113995197647, 107.73822803767517, 139.77631549384986, 148.72337959115129, 73.06684667908857, 133.64886806533255, 71.32009331278519, 91.59042004321799, 88.51607944015232, 77.37385666588763, 65.5039901527279, 86.63043518788407, 152.2265474036546, 132.29539818530185, 141.98939026899734, 160.85356795500803, 127.69661006493315, 88.92567174972214, 157.45667011190847, 44.978479654910615, -41.4433402129006, 147.11186462654535, 73.22627616566223, 59.105967389643006, 153.82982890799943, 85.7047517536423, 138.8689300105537, 1.8287640140049923, 152.18116009656532, 166.51505236925124, 106.90133410943847, 159.9199520064603, 126.30701466290326, 170.12063081875914, 139.86758534532163, 49.009384774789716, 137.10649908666147, 68.86879825458963, 68.39168520928662, 145.84538378310964, 139.1633117199736, 142.2253761404654, 91.83176982113007, 157.32111048552676, 142.81904834115238, 146.77938880947417, 166.16141752243274, 144.1274505615055, 185.06557148360403, 184.01283526909774, 180.65972790609433, 154.5383230127732, 160.64322132894682, 170.5789800905035, 176.97543475623695, 143.01842750416873, 168.72403389265713, 177.05365258049832, 172.32601554551988, 148.18933116543877, 0.6791195852480001, 155.88847208918594, 171.9074231745797, 177.4955630805233, 168.5190020190972, 142.3842907549981, 147.3010380485574, 56.87726898480099, 87.8498114429118, 47.236736258097025, 70.4515540302766, 157.32925409172339, 177.4757752751918, 85.31429615775706, 94.32826190333843, 41.38887714378148, 138.84049461716137, 96.66103037982589, 153.79257362885699, 180.37172634104806, 180.07322199444482, 175.10552647052512, 146.71742807642875, 188.0032010577616, 154.80954197298766, 178.53167941746432, 170.51769007742865, 67.96542658800209, 73.25671917862469, 156.14409813712993, 185.11097714838456, 56.45014772870287, 52.04032090907246, 168.08740632962414, 163.07433280225104, 142.5271678899022, 187.3085267451003, 191.87801648377183, 125.97638033027314, 40.79654826768726, 81.2423661104907, 71.33670244552107, 46.51250710245098, 110.8051753328919, 100.92120615008635, 173.00010854901282, 138.52977509382032, 159.3289113764776, 155.93451826543046, 137.51385940828442, 181.7601473553929, 183.96918127089495, 166.14378946153164, 32.397100007700544, 16.726283148622706, 120.00473398618507, 146.49629213709875, 145.29715587593117, 148.8172330570283, 156.68794652581084, 143.4544490911253, 39.9605811919057, 37.19557321881186, 0.1452330227319465, -22.476481038782378, 176.48888320610376, 170.80399035299627], "policy_predator_policy_reward": [148.66923887730664, 238.8171736504035, 151.79259319060282, 170.7870049532676, 269.0399337206882, 222.875668129704, 159.53458114047635, 212.70914904227848, 139.0487696727229, 88.26098876327981, 164.80378426610656, 166.46849757478824, 115.6250797942843, 143.4844552420803, 77.6294804961078, 113.75781330483724, 115.16182741316611, 138.76038995285802, 83.51647540731517, 67.96047117859013, 150.39276671738523, 119.64974267542526, 185.20113912843905, 203.30065098204156, 105.171537100932, 122.02736478381355, 117.6711033951329, 121.05915222169607, 100.799007591696, 101.14276295940756, 89.2635339860112, 79.9199655376844, 138.23651270486562, 124.24215620411965, 85.83526777037864, 110.39040274499658, 140.03164947610415, 142.27726817285944, 119.48760689446839, 117.89360282940345, 93.57805266226879, 86.52584048496978, 98.70765244453494, 89.08205198396062, 82.92528309023821, 89.07316432413869, 114.06070709621325, 116.29948533937616, 106.90284151238995, 171.85695616632992, 114.98994531104368, 130.67597517511112, 124.54856127375761, 138.4869072750368, 106.006252590876, 93.17887717165412, 106.9285307034444, 131.78650194070616, 119.23441546850141, 109.26909456854138, 148.68533712670208, 123.55966694064715, 147.25478423166092, 160.52018771984083, 115.36475169417393, 108.50213923416575, 116.38989015163291, 155.6999213714518, 98.4583271044514, 102.67989120259469, 112.56380809590935, 53.830736847806925, 108.33382274103221, 72.92627050054355, 87.69706244044977, 52.77318572138942, 98.29487521573773, 100.01491433793441, 96.18039153830651, 90.54847701937804, 103.56971621462418, 92.39083194637612, 115.57791598210376, 98.2931636744999, 107.26042408003892, 70.71607501858502, 63.27338382928937, 61.31373183021561, 44.098345419967956, 44.25051480240772, 75.3001452581838, 73.07660369371166, 94.04823484300559, 152.62551833645992, 94.48931346972444, 98.09550769026144, 112.51320688893104, 85.4477845988284, 56.90885906764894, 101.18581468032451, 177.13111031264467, 45.908111542622805, 72.87849960049905, 83.32250228866606, 65.82625787711343, 65.7190948243646, 51.412163430544815, 36.24715131484174, 107.6297216746301, 101.28936447685952, 117.15859625101754, 80.64123366319556, 61.35288597522116, 37.435400540158675, 100.3300804759509, 64.29087862084215, 48.237849677911164, 37.397117548120065, 58.391133098463904, 49.293635941517145, 43.546306767611036, 20.101160914835763, 14.872529646198451, 10.882143100197515, 55.7263868736087, 53.43300166862359, 15.804380512078586, 9.444193545171881, 51.0166372320791, 43.57030994840882, 18.966579875386536, 24.381235755627376, 166.71979162969015, 144.09960195864176, 32.09529760244927, 18.09606510661129, 21.258302642603642, 28.077938997208093, 44.08955890092599, 47.14778321530503, 115.69725455847588, 26.524779677735648, 162.21716367070673, 43.490011253617716, 30.514540749940736, 19.15179434114984, 39.47106010783917, 113.44050134059115, 41.28833796123274, 141.00112032872667, 52.212573003236734, 65.45910541389, 7.330532388554973, 16.567816338861665, 55.48037768287164, 36.12924407249159, 40.636707825641, 20.039885419546493, 15.070971515913257, 23.417076474350942, 138.70740858913095, 14.039781232905638, 39.87125439888842, 28.620307742982202, 172.46914942389373, 28.807957822842788, 5.664038131171388, 31.73578378658279, 40.30130583580528, 29.306823394134085, 24.564548205106043, 49.042051802623234, 155.49864084428188, 55.731288575462024, 159.51840153411052, 37.0766636559341, 85.39225187925217, 99.25505587330397, 48.998669892104004, 30.790206261244272, 68.63423255034633, 39.9201108073138, 51.707710616436465, 55.53012041129274, 18.205462993311134, 8.702244115087186, 228.58973684882724, 17.099858192697297, 43.348889168355626, 64.1406719309048, 25.773447115278422, 46.09493255250273, 24.830406113594247, 31.457593874948657, 21.81233876940197, 190.24715507852034, 130.66801188441693, 228.73028148571734, 16.722957347150956, 14.549558966326265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6351137938521447, "mean_inference_ms": 1.9998813831977214, "mean_action_processing_ms": 0.2633125112840298, "mean_env_wait_ms": 0.2434584481908155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039136409759521484, "StateBufferConnector_ms": 0.0032303333282470703, "ViewRequirementAgentConnector_ms": 0.09321033954620361}, "num_episodes": 22, "episode_return_max": 542.8215315753168, "episode_return_min": 250.2088926214758, "episode_return_mean": 393.69787790394, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 399.38275365257215, "num_env_steps_trained_throughput_per_sec": 399.38275365257215, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 10602.887, "restore_workers_time_ms": 0.02, "training_step_time_ms": 10602.808, "sample_time_ms": 1548.577, "learn_time_ms": 9034.275, "learn_throughput": 442.758, "synch_weights_time_ms": 17.759}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-00", "timestamp": 1723779180, "time_this_iter_s": 10.02051305770874, "time_total_s": 989.1433274745941, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 989.1433274745941, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 30.857142857142854, "ram_util_percent": 83.34285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.936116997148625, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.51481416919244, "policy_loss": -0.0011571941562194042, "vf_loss": 8.5147218686563, "vf_explained_var": 0.11072636344445445, "kl": 0.014809201727952002, "entropy": 0.41851692696412407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.407878831959275, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.995494037456613, "policy_loss": -0.0027846403015905586, "vf_loss": 8.99742262502196, "vf_explained_var": 0.08630512375680227, "kl": 0.011413940007032435, "entropy": 1.0742504327700881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 461.88686778636065, "episode_reward_min": 250.2088926214758, "episode_reward_mean": 380.618133976461, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -41.4433402129006, "predator_policy": 4.100035514080281}, "policy_reward_max": {"prey_policy": 191.87801648377183, "predator_policy": 228.73028148571734}, "policy_reward_mean": {"prey_policy": 117.70437374739112, "predator_policy": 72.60469324083941}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.2619810106623, 441.8265540330012, 416.11099167545973, 410.21855176983183, 416.40085418771304, 431.69495682242376, 430.49636641532567, 428.7856078773729, 436.91856301644924, 395.44397301844833, 402.22134643697325, 449.66859759721046, 436.82058121575955, 445.43359100598724, 461.88686778636065, 439.5757725267796, 400.01167419684555, 313.84393964239126, 380.1952801373864, 387.98479169336457, 420.1000158239114, 391.6978299358023, 376.06704764437103, 356.74892647521904, 416.8334816901622, 398.8719041138042, 376.89903824231715, 394.7590908135256, 250.2088926214758, 412.92296195219393, 410.8967877854019, 382.66835551216957, 377.0491459658372, 429.6173883678553, 417.7723193708417, 397.6475309094674, 395.03497001294124, 335.0603133780897, 383.7969820184631, 398.6781050583876, 385.77512605271, 420.62557537188843, 392.84048972755625, 390.42723592158814, 424.3409328839524, 372.80298890399104, 406.32940857731415, 392.7274837570321, 459.6878443390186, 377.9872579728262, 395.3508067394322, 380.9226709197866, 286.9491146639242, 323.39546521269756, 384.4713644580059, 332.55411950952583, 362.51883005090275, 368.12528242580936, 384.3432970629096, 413.4325763023171, 403.4893362759366, 387.5374174851573, 293.9693355886637, 409.7466374273851, 309.7675758845114, 368.56156104962923, 399.4438238649419, 391.46099682177396, 333.26884379792205, 314.44427473801636, 396.37368923553424, 391.31875979618127, 423.8177729995685, 426.5118377914063, 377.02067784082493, 294.8129781978479, 373.990587222544, 365.9827686007405, 356.4303956054789, 289.2156482586397, 337.0670453540839, 378.56538987257727, 394.4748760745467, 385.3592752914693, 316.02779447469163, 370.33402811632504, 383.8924507798946, 312.7418094834699, 393.817806776512, 410.3244552732436, 376.3157584387769, 291.84765418330403, 255.19694356434002, 363.71969525524435, 389.6303148243604, 307.5302285730763, 383.14947300819455, 293.1475179238424, 365.52530408784105, 298.24085719643534], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [120.90573913817086, 40.04732422352774, 136.73073787493462, 67.71460643419495, 129.03550202426226, 106.97159650395878, 70.88157572960927, 151.54727161172633, 145.83669930772984, 98.56570746560624, 71.05800485363262, 130.27675953320173, 32.062329599984395, 119.67423913662071, 125.70270030963088, 57.41698708158669, 55.58917430740872, 118.29392016024622, 77.91290213843847, 118.34594111748004, 112.42802074076026, 51.078293052063465, 72.17716832595073, 148.98791923421658, 54.040925109178104, 110.53465203923182, 102.26230957357305, 35.396309480911306, 176.00491129845815, 62.015065559562785, 32.752625960680504, 134.7333350430139, 53.78379257712124, 145.08966331267823, 35.76419620810495, 111.68519849056999, 114.20404694383414, 84.73113995197647, 107.73822803767517, 139.77631549384986, 148.72337959115129, 73.06684667908857, 133.64886806533255, 71.32009331278519, 91.59042004321799, 88.51607944015232, 77.37385666588763, 65.5039901527279, 86.63043518788407, 152.2265474036546, 132.29539818530185, 141.98939026899734, 160.85356795500803, 127.69661006493315, 88.92567174972214, 157.45667011190847, 44.978479654910615, -41.4433402129006, 147.11186462654535, 73.22627616566223, 59.105967389643006, 153.82982890799943, 85.7047517536423, 138.8689300105537, 1.8287640140049923, 152.18116009656532, 166.51505236925124, 106.90133410943847, 159.9199520064603, 126.30701466290326, 170.12063081875914, 139.86758534532163, 49.009384774789716, 137.10649908666147, 68.86879825458963, 68.39168520928662, 145.84538378310964, 139.1633117199736, 142.2253761404654, 91.83176982113007, 157.32111048552676, 142.81904834115238, 146.77938880947417, 166.16141752243274, 144.1274505615055, 185.06557148360403, 184.01283526909774, 180.65972790609433, 154.5383230127732, 160.64322132894682, 170.5789800905035, 176.97543475623695, 143.01842750416873, 168.72403389265713, 177.05365258049832, 172.32601554551988, 148.18933116543877, 0.6791195852480001, 155.88847208918594, 171.9074231745797, 177.4955630805233, 168.5190020190972, 142.3842907549981, 147.3010380485574, 56.87726898480099, 87.8498114429118, 47.236736258097025, 70.4515540302766, 157.32925409172339, 177.4757752751918, 85.31429615775706, 94.32826190333843, 41.38887714378148, 138.84049461716137, 96.66103037982589, 153.79257362885699, 180.37172634104806, 180.07322199444482, 175.10552647052512, 146.71742807642875, 188.0032010577616, 154.80954197298766, 178.53167941746432, 170.51769007742865, 67.96542658800209, 73.25671917862469, 156.14409813712993, 185.11097714838456, 56.45014772870287, 52.04032090907246, 168.08740632962414, 163.07433280225104, 142.5271678899022, 187.3085267451003, 191.87801648377183, 125.97638033027314, 40.79654826768726, 81.2423661104907, 71.33670244552107, 46.51250710245098, 110.8051753328919, 100.92120615008635, 173.00010854901282, 138.52977509382032, 159.3289113764776, 155.93451826543046, 137.51385940828442, 181.7601473553929, 183.96918127089495, 166.14378946153164, 32.397100007700544, 16.726283148622706, 120.00473398618507, 146.49629213709875, 145.29715587593117, 148.8172330570283, 156.68794652581084, 143.4544490911253, 39.9605811919057, 37.19557321881186, 0.1452330227319465, -22.476481038782378, 176.48888320610376, 170.80399035299627, 169.28833455270845, 184.3915637387675, 133.6312927180066, 161.96352378711927, 87.4204441785489, 49.9483013711749, 164.2679744649504, 185.4813218065446, 185.60495802971099, 173.828663984311, 93.42471559792588, 114.27430039604899, 185.4803902756512, 146.09106927938203, 169.16112104968968, 154.69981419744158, 175.27251413138393, 161.18587258597506, 67.90040427423793, 33.510166234450985, 27.332776444933515, 22.132616271352525, 153.81129236913347, 181.42369659989964, 163.06619367864226, 176.48173546419866, -4.739586206646457, 78.7611976300923, 165.87695540407134, 137.2447133490588, 64.69316445557529, 33.00690091819251, 173.30723553810267, 166.8668591835647, 54.77648898394281, 10.509523794480847], "policy_predator_policy_reward": [140.03164947610415, 142.27726817285944, 119.48760689446839, 117.89360282940345, 93.57805266226879, 86.52584048496978, 98.70765244453494, 89.08205198396062, 82.92528309023821, 89.07316432413869, 114.06070709621325, 116.29948533937616, 106.90284151238995, 171.85695616632992, 114.98994531104368, 130.67597517511112, 124.54856127375761, 138.4869072750368, 106.006252590876, 93.17887717165412, 106.9285307034444, 131.78650194070616, 119.23441546850141, 109.26909456854138, 148.68533712670208, 123.55966694064715, 147.25478423166092, 160.52018771984083, 115.36475169417393, 108.50213923416575, 116.38989015163291, 155.6999213714518, 98.4583271044514, 102.67989120259469, 112.56380809590935, 53.830736847806925, 108.33382274103221, 72.92627050054355, 87.69706244044977, 52.77318572138942, 98.29487521573773, 100.01491433793441, 96.18039153830651, 90.54847701937804, 103.56971621462418, 92.39083194637612, 115.57791598210376, 98.2931636744999, 107.26042408003892, 70.71607501858502, 63.27338382928937, 61.31373183021561, 44.098345419967956, 44.25051480240772, 75.3001452581838, 73.07660369371166, 94.04823484300559, 152.62551833645992, 94.48931346972444, 98.09550769026144, 112.51320688893104, 85.4477845988284, 56.90885906764894, 101.18581468032451, 177.13111031264467, 45.908111542622805, 72.87849960049905, 83.32250228866606, 65.82625787711343, 65.7190948243646, 51.412163430544815, 36.24715131484174, 107.6297216746301, 101.28936447685952, 117.15859625101754, 80.64123366319556, 61.35288597522116, 37.435400540158675, 100.3300804759509, 64.29087862084215, 48.237849677911164, 37.397117548120065, 58.391133098463904, 49.293635941517145, 43.546306767611036, 20.101160914835763, 14.872529646198451, 10.882143100197515, 55.7263868736087, 53.43300166862359, 15.804380512078586, 9.444193545171881, 51.0166372320791, 43.57030994840882, 18.966579875386536, 24.381235755627376, 166.71979162969015, 144.09960195864176, 32.09529760244927, 18.09606510661129, 21.258302642603642, 28.077938997208093, 44.08955890092599, 47.14778321530503, 115.69725455847588, 26.524779677735648, 162.21716367070673, 43.490011253617716, 30.514540749940736, 19.15179434114984, 39.47106010783917, 113.44050134059115, 41.28833796123274, 141.00112032872667, 52.212573003236734, 65.45910541389, 7.330532388554973, 16.567816338861665, 55.48037768287164, 36.12924407249159, 40.636707825641, 20.039885419546493, 15.070971515913257, 23.417076474350942, 138.70740858913095, 14.039781232905638, 39.87125439888842, 28.620307742982202, 172.46914942389373, 28.807957822842788, 5.664038131171388, 31.73578378658279, 40.30130583580528, 29.306823394134085, 24.564548205106043, 49.042051802623234, 155.49864084428188, 55.731288575462024, 159.51840153411052, 37.0766636559341, 85.39225187925217, 99.25505587330397, 48.998669892104004, 30.790206261244272, 68.63423255034633, 39.9201108073138, 51.707710616436465, 55.53012041129274, 18.205462993311134, 8.702244115087186, 228.58973684882724, 17.099858192697297, 43.348889168355626, 64.1406719309048, 25.773447115278422, 46.09493255250273, 24.830406113594247, 31.457593874948657, 21.81233876940197, 190.24715507852034, 130.66801188441693, 228.73028148571734, 16.722957347150956, 14.549558966326265, 30.954466551514493, 9.84051123155639, 31.22754983964662, 58.53690894669691, 166.11589117058136, 12.543157754386108, 9.926457499074381, 10.658274345755398, 4.318425083114353, 20.140403682758357, 96.77384067846222, 8.268952811033195, 20.26316221542931, 41.983185006049574, 27.81681277747103, 58.646707248641384, 18.805588152550804, 21.051783568867137, 166.8960804512858, 23.541003223329735, 201.63151533397402, 4.100035514080281, 15.267188918854291, 13.217517367356873, 15.99141707806926, 34.09096860345032, 218.25852307719327, 15.250094072437518, 59.06352466908168, 20.964279585982705, 5.722500037028164, 189.72495251304636, 18.51863576999129, 6.83257359618227, 202.7386011369486, 30.21624328106221]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6343967021031862, "mean_inference_ms": 1.9952892149107453, "mean_action_processing_ms": 0.26316170411237894, "mean_env_wait_ms": 0.24291731538655284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955960273742676, "StateBufferConnector_ms": 0.0032722949981689453, "ViewRequirementAgentConnector_ms": 0.09507012367248535}, "num_episodes": 18, "episode_return_max": 461.88686778636065, "episode_return_min": 250.2088926214758, "episode_return_mean": 380.618133976461, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.1202754123783, "num_env_steps_trained_throughput_per_sec": 400.1202754123783, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 10227.6, "restore_workers_time_ms": 0.018, "training_step_time_ms": 10227.53, "sample_time_ms": 1371.06, "learn_time_ms": 8839.535, "learn_throughput": 452.512, "synch_weights_time_ms": 15.248}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-11", "timestamp": 1723779191, "time_this_iter_s": 10.003988981246948, "time_total_s": 999.1473164558411, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20db940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 999.1473164558411, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 29.23333333333333, "ram_util_percent": 83.48666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.043279431673585, "cur_kl_coeff": 0.084375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.972110903452313, "policy_loss": -0.0033590644482207836, "vf_loss": 7.97508401895957, "vf_explained_var": 0.03460098826696002, "kl": 0.004574571515275851, "entropy": 0.35519851939703423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.600916584269711, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.782547287713914, "policy_loss": -0.0009131941022893423, "vf_loss": 8.782875924892526, "vf_explained_var": 0.13476491977298072, "kl": 0.007794095500246349, "entropy": 1.0469217631236587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 459.6878443390186, "episode_reward_min": 250.2088926214758, "episode_reward_mean": 364.33325971572015, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -74.17367844310458, "predator_policy": 4.100035514080281}, "policy_reward_max": {"prey_policy": 191.87801648377183, "predator_policy": 370.31439527532496}, "policy_reward_mean": {"prey_policy": 116.2785610641987, "predator_policy": 65.88806879366135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.74892647521904, 416.8334816901622, 398.8719041138042, 376.89903824231715, 394.7590908135256, 250.2088926214758, 412.92296195219393, 410.8967877854019, 382.66835551216957, 377.0491459658372, 429.6173883678553, 417.7723193708417, 397.6475309094674, 395.03497001294124, 335.0603133780897, 383.7969820184631, 398.6781050583876, 385.77512605271, 420.62557537188843, 392.84048972755625, 390.42723592158814, 424.3409328839524, 372.80298890399104, 406.32940857731415, 392.7274837570321, 459.6878443390186, 377.9872579728262, 395.3508067394322, 380.9226709197866, 286.9491146639242, 323.39546521269756, 384.4713644580059, 332.55411950952583, 362.51883005090275, 368.12528242580936, 384.3432970629096, 413.4325763023171, 403.4893362759366, 387.5374174851573, 293.9693355886637, 409.7466374273851, 309.7675758845114, 368.56156104962923, 399.4438238649419, 391.46099682177396, 333.26884379792205, 314.44427473801636, 396.37368923553424, 391.31875979618127, 423.8177729995685, 426.5118377914063, 377.02067784082493, 294.8129781978479, 373.990587222544, 365.9827686007405, 356.4303956054789, 289.2156482586397, 337.0670453540839, 378.56538987257727, 394.4748760745467, 385.3592752914693, 316.02779447469163, 370.33402811632504, 383.8924507798946, 312.7418094834699, 393.817806776512, 410.3244552732436, 376.3157584387769, 291.84765418330403, 255.19694356434002, 363.71969525524435, 389.6303148243604, 307.5302285730763, 383.14947300819455, 293.1475179238424, 365.52530408784105, 298.24085719643534, 376.20514981844406, 353.7952588879554, 302.23849670853684, 379.0309399364015, 453.5935592201362, 391.92246089605203, 361.1381933417346, 358.72120092162294, 394.5296936638714, 261.4462586201947, 387.55270601076097, 379.3774143139766, 334.7568974555293, 259.1560316716172, 371.4001520737931, 342.72238446376895, 332.314836682088, 264.06175436227, 321.8244052582313, 383.6653669204643, 304.8583040939533, 292.0060752040378, 321.86076887028884], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [77.37385666588763, 65.5039901527279, 86.63043518788407, 152.2265474036546, 132.29539818530185, 141.98939026899734, 160.85356795500803, 127.69661006493315, 88.92567174972214, 157.45667011190847, 44.978479654910615, -41.4433402129006, 147.11186462654535, 73.22627616566223, 59.105967389643006, 153.82982890799943, 85.7047517536423, 138.8689300105537, 1.8287640140049923, 152.18116009656532, 166.51505236925124, 106.90133410943847, 159.9199520064603, 126.30701466290326, 170.12063081875914, 139.86758534532163, 49.009384774789716, 137.10649908666147, 68.86879825458963, 68.39168520928662, 145.84538378310964, 139.1633117199736, 142.2253761404654, 91.83176982113007, 157.32111048552676, 142.81904834115238, 146.77938880947417, 166.16141752243274, 144.1274505615055, 185.06557148360403, 184.01283526909774, 180.65972790609433, 154.5383230127732, 160.64322132894682, 170.5789800905035, 176.97543475623695, 143.01842750416873, 168.72403389265713, 177.05365258049832, 172.32601554551988, 148.18933116543877, 0.6791195852480001, 155.88847208918594, 171.9074231745797, 177.4955630805233, 168.5190020190972, 142.3842907549981, 147.3010380485574, 56.87726898480099, 87.8498114429118, 47.236736258097025, 70.4515540302766, 157.32925409172339, 177.4757752751918, 85.31429615775706, 94.32826190333843, 41.38887714378148, 138.84049461716137, 96.66103037982589, 153.79257362885699, 180.37172634104806, 180.07322199444482, 175.10552647052512, 146.71742807642875, 188.0032010577616, 154.80954197298766, 178.53167941746432, 170.51769007742865, 67.96542658800209, 73.25671917862469, 156.14409813712993, 185.11097714838456, 56.45014772870287, 52.04032090907246, 168.08740632962414, 163.07433280225104, 142.5271678899022, 187.3085267451003, 191.87801648377183, 125.97638033027314, 40.79654826768726, 81.2423661104907, 71.33670244552107, 46.51250710245098, 110.8051753328919, 100.92120615008635, 173.00010854901282, 138.52977509382032, 159.3289113764776, 155.93451826543046, 137.51385940828442, 181.7601473553929, 183.96918127089495, 166.14378946153164, 32.397100007700544, 16.726283148622706, 120.00473398618507, 146.49629213709875, 145.29715587593117, 148.8172330570283, 156.68794652581084, 143.4544490911253, 39.9605811919057, 37.19557321881186, 0.1452330227319465, -22.476481038782378, 176.48888320610376, 170.80399035299627, 169.28833455270845, 184.3915637387675, 133.6312927180066, 161.96352378711927, 87.4204441785489, 49.9483013711749, 164.2679744649504, 185.4813218065446, 185.60495802971099, 173.828663984311, 93.42471559792588, 114.27430039604899, 185.4803902756512, 146.09106927938203, 169.16112104968968, 154.69981419744158, 175.27251413138393, 161.18587258597506, 67.90040427423793, 33.510166234450985, 27.332776444933515, 22.132616271352525, 153.81129236913347, 181.42369659989964, 163.06619367864226, 176.48173546419866, -4.739586206646457, 78.7611976300923, 165.87695540407134, 137.2447133490588, 64.69316445557529, 33.00690091819251, 173.30723553810267, 166.8668591835647, 54.77648898394281, 10.509523794480847, 135.01408724283587, 161.5971896811504, 139.71512135498273, 170.06589407750062, 46.478224315725065, 12.66855425032098, 148.40378251256516, 167.11394942748365, -58.8206222821025, -74.17367844310458, 178.66821606306988, 172.89144890361334, -5.776654171489123, 79.00911587442383, 142.32485849694098, 122.57256960715041, 84.38910220807972, 106.86571321937218, -72.32557838209533, 54.19169917132329, 148.2208895718306, 148.49398095317864, 178.51831582173347, 147.51440381479514, 130.3915713069656, 168.7601019891734, -8.932451609872025, 37.55813618476188, 188.19211395690962, 151.60373636507344, 131.95841666833124, 112.0366728570034, 87.51499043383254, 66.39106265249666, -4.249457106742734, 53.96356686877897, 65.64278562086119, 48.84130957587581, 153.8259969019841, 171.6609126844528, 41.818078982123176, 59.35189008240122, 175.98955511817516, 84.2218109703156, -68.83245633978183, 0.12805802620086887], "policy_predator_policy_reward": [115.57791598210376, 98.2931636744999, 107.26042408003892, 70.71607501858502, 63.27338382928937, 61.31373183021561, 44.098345419967956, 44.25051480240772, 75.3001452581838, 73.07660369371166, 94.04823484300559, 152.62551833645992, 94.48931346972444, 98.09550769026144, 112.51320688893104, 85.4477845988284, 56.90885906764894, 101.18581468032451, 177.13111031264467, 45.908111542622805, 72.87849960049905, 83.32250228866606, 65.82625787711343, 65.7190948243646, 51.412163430544815, 36.24715131484174, 107.6297216746301, 101.28936447685952, 117.15859625101754, 80.64123366319556, 61.35288597522116, 37.435400540158675, 100.3300804759509, 64.29087862084215, 48.237849677911164, 37.397117548120065, 58.391133098463904, 49.293635941517145, 43.546306767611036, 20.101160914835763, 14.872529646198451, 10.882143100197515, 55.7263868736087, 53.43300166862359, 15.804380512078586, 9.444193545171881, 51.0166372320791, 43.57030994840882, 18.966579875386536, 24.381235755627376, 166.71979162969015, 144.09960195864176, 32.09529760244927, 18.09606510661129, 21.258302642603642, 28.077938997208093, 44.08955890092599, 47.14778321530503, 115.69725455847588, 26.524779677735648, 162.21716367070673, 43.490011253617716, 30.514540749940736, 19.15179434114984, 39.47106010783917, 113.44050134059115, 41.28833796123274, 141.00112032872667, 52.212573003236734, 65.45910541389, 7.330532388554973, 16.567816338861665, 55.48037768287164, 36.12924407249159, 40.636707825641, 20.039885419546493, 15.070971515913257, 23.417076474350942, 138.70740858913095, 14.039781232905638, 39.87125439888842, 28.620307742982202, 172.46914942389373, 28.807957822842788, 5.664038131171388, 31.73578378658279, 40.30130583580528, 29.306823394134085, 24.564548205106043, 49.042051802623234, 155.49864084428188, 55.731288575462024, 159.51840153411052, 37.0766636559341, 85.39225187925217, 99.25505587330397, 48.998669892104004, 30.790206261244272, 68.63423255034633, 39.9201108073138, 51.707710616436465, 55.53012041129274, 18.205462993311134, 8.702244115087186, 228.58973684882724, 17.099858192697297, 43.348889168355626, 64.1406719309048, 25.773447115278422, 46.09493255250273, 24.830406113594247, 31.457593874948657, 21.81233876940197, 190.24715507852034, 130.66801188441693, 228.73028148571734, 16.722957347150956, 14.549558966326265, 30.954466551514493, 9.84051123155639, 31.22754983964662, 58.53690894669691, 166.11589117058136, 12.543157754386108, 9.926457499074381, 10.658274345755398, 4.318425083114353, 20.140403682758357, 96.77384067846222, 8.268952811033195, 20.26316221542931, 41.983185006049574, 27.81681277747103, 58.646707248641384, 18.805588152550804, 21.051783568867137, 166.8960804512858, 23.541003223329735, 201.63151533397402, 4.100035514080281, 15.267188918854291, 13.217517367356873, 15.99141707806926, 34.09096860345032, 218.25852307719327, 15.250094072437518, 59.06352466908168, 20.964279585982705, 5.722500037028164, 189.72495251304636, 18.51863576999129, 6.83257359618227, 202.7386011369486, 30.21624328106221, 36.813366632400545, 42.78050626205695, 13.277448974150943, 30.736794481321194, 34.94985682098786, 208.14186132150311, 31.78956495591447, 31.723643040438315, 370.31439527532496, 216.27346467001692, 21.78840852161415, 18.574387407754823, 82.89380833906097, 205.01192329973938, 54.47906967588923, 39.34470314164283, 80.9801112094398, 122.29476702698014, 4.720578796282968, 274.8595590346836, 44.624191392794835, 46.2136440929569, 28.893387482930155, 24.451307194517966, 27.627792911018993, 7.977431248371387, 8.915285900547126, 221.6150611961805, 16.886017716792434, 14.718284035017543, 83.07855654427644, 15.648738394157952, 141.84440952073896, 36.564374075019565, 10.399322983690041, 203.94832161654404, 171.14553312414512, 36.194776937348855, 34.481759253205524, 23.696698080821886, 173.89704276691674, 29.791292262512584, 15.091990788120242, 16.702718327426606, 192.54998379936893, 198.01518338450143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6335173316183005, "mean_inference_ms": 1.9880185893183224, "mean_action_processing_ms": 0.26244429539695263, "mean_env_wait_ms": 0.24241848718009343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042650699615478516, "StateBufferConnector_ms": 0.003281116485595703, "ViewRequirementAgentConnector_ms": 0.09365332126617432}, "num_episodes": 23, "episode_return_max": 459.6878443390186, "episode_return_min": 250.2088926214758, "episode_return_mean": 364.33325971572015, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 400.4701411664733, "num_env_steps_trained_throughput_per_sec": 400.4701411664733, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 10098.561, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10098.517, "sample_time_ms": 1319.685, "learn_time_ms": 8761.948, "learn_throughput": 456.519, "synch_weights_time_ms": 15.457}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-21", "timestamp": 1723779201, "time_this_iter_s": 9.9952392578125, "time_total_s": 1009.1425557136536, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20cd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1009.1425557136536, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 32.714285714285715, "ram_util_percent": 83.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.587601368294822, "cur_kl_coeff": 0.0421875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.619894143513271, "policy_loss": -0.003052067596751152, "vf_loss": 8.622786488861003, "vf_explained_var": 0.025007430870066245, "kl": 0.0037861911071642123, "entropy": 0.32176587064430195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.521031085587053, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.113513786073716, "policy_loss": -0.002039348991173837, "vf_loss": 9.1152188079067, "vf_explained_var": 0.09448041275695518, "kl": 0.004457882333814008, "entropy": 1.035541809866668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 459.6878443390186, "episode_reward_min": 255.19694356434002, "episode_reward_mean": 361.52239615816006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -131.93153282844565, "predator_policy": 4.100035514080281}, "policy_reward_max": {"prey_policy": 191.87801648377183, "predator_policy": 370.31439527532496}, "policy_reward_mean": {"prey_policy": 104.48974335822967, "predator_policy": 76.27145472085039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.62557537188843, 392.84048972755625, 390.42723592158814, 424.3409328839524, 372.80298890399104, 406.32940857731415, 392.7274837570321, 459.6878443390186, 377.9872579728262, 395.3508067394322, 380.9226709197866, 286.9491146639242, 323.39546521269756, 384.4713644580059, 332.55411950952583, 362.51883005090275, 368.12528242580936, 384.3432970629096, 413.4325763023171, 403.4893362759366, 387.5374174851573, 293.9693355886637, 409.7466374273851, 309.7675758845114, 368.56156104962923, 399.4438238649419, 391.46099682177396, 333.26884379792205, 314.44427473801636, 396.37368923553424, 391.31875979618127, 423.8177729995685, 426.5118377914063, 377.02067784082493, 294.8129781978479, 373.990587222544, 365.9827686007405, 356.4303956054789, 289.2156482586397, 337.0670453540839, 378.56538987257727, 394.4748760745467, 385.3592752914693, 316.02779447469163, 370.33402811632504, 383.8924507798946, 312.7418094834699, 393.817806776512, 410.3244552732436, 376.3157584387769, 291.84765418330403, 255.19694356434002, 363.71969525524435, 389.6303148243604, 307.5302285730763, 383.14947300819455, 293.1475179238424, 365.52530408784105, 298.24085719643534, 376.20514981844406, 353.7952588879554, 302.23849670853684, 379.0309399364015, 453.5935592201362, 391.92246089605203, 361.1381933417346, 358.72120092162294, 394.5296936638714, 261.4462586201947, 387.55270601076097, 379.3774143139766, 334.7568974555293, 259.1560316716172, 371.4001520737931, 342.72238446376895, 332.314836682088, 264.06175436227, 321.8244052582313, 383.6653669204643, 304.8583040939533, 292.0060752040378, 321.86076887028884, 399.8556205084934, 410.5085087446748, 373.34791427495867, 374.61966240837467, 395.9777909061249, 401.20774297307025, 392.1010156419282, 320.3660165293343, 428.2059071633005, 377.36751364940505, 371.6441054460225, 424.1479560880554, 402.82379380259584, 368.7095258941449, 286.03433177720376, 297.6229993953694, 279.3271529455105, 336.2874064363008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [146.77938880947417, 166.16141752243274, 144.1274505615055, 185.06557148360403, 184.01283526909774, 180.65972790609433, 154.5383230127732, 160.64322132894682, 170.5789800905035, 176.97543475623695, 143.01842750416873, 168.72403389265713, 177.05365258049832, 172.32601554551988, 148.18933116543877, 0.6791195852480001, 155.88847208918594, 171.9074231745797, 177.4955630805233, 168.5190020190972, 142.3842907549981, 147.3010380485574, 56.87726898480099, 87.8498114429118, 47.236736258097025, 70.4515540302766, 157.32925409172339, 177.4757752751918, 85.31429615775706, 94.32826190333843, 41.38887714378148, 138.84049461716137, 96.66103037982589, 153.79257362885699, 180.37172634104806, 180.07322199444482, 175.10552647052512, 146.71742807642875, 188.0032010577616, 154.80954197298766, 178.53167941746432, 170.51769007742865, 67.96542658800209, 73.25671917862469, 156.14409813712993, 185.11097714838456, 56.45014772870287, 52.04032090907246, 168.08740632962414, 163.07433280225104, 142.5271678899022, 187.3085267451003, 191.87801648377183, 125.97638033027314, 40.79654826768726, 81.2423661104907, 71.33670244552107, 46.51250710245098, 110.8051753328919, 100.92120615008635, 173.00010854901282, 138.52977509382032, 159.3289113764776, 155.93451826543046, 137.51385940828442, 181.7601473553929, 183.96918127089495, 166.14378946153164, 32.397100007700544, 16.726283148622706, 120.00473398618507, 146.49629213709875, 145.29715587593117, 148.8172330570283, 156.68794652581084, 143.4544490911253, 39.9605811919057, 37.19557321881186, 0.1452330227319465, -22.476481038782378, 176.48888320610376, 170.80399035299627, 169.28833455270845, 184.3915637387675, 133.6312927180066, 161.96352378711927, 87.4204441785489, 49.9483013711749, 164.2679744649504, 185.4813218065446, 185.60495802971099, 173.828663984311, 93.42471559792588, 114.27430039604899, 185.4803902756512, 146.09106927938203, 169.16112104968968, 154.69981419744158, 175.27251413138393, 161.18587258597506, 67.90040427423793, 33.510166234450985, 27.332776444933515, 22.132616271352525, 153.81129236913347, 181.42369659989964, 163.06619367864226, 176.48173546419866, -4.739586206646457, 78.7611976300923, 165.87695540407134, 137.2447133490588, 64.69316445557529, 33.00690091819251, 173.30723553810267, 166.8668591835647, 54.77648898394281, 10.509523794480847, 135.01408724283587, 161.5971896811504, 139.71512135498273, 170.06589407750062, 46.478224315725065, 12.66855425032098, 148.40378251256516, 167.11394942748365, -58.8206222821025, -74.17367844310458, 178.66821606306988, 172.89144890361334, -5.776654171489123, 79.00911587442383, 142.32485849694098, 122.57256960715041, 84.38910220807972, 106.86571321937218, -72.32557838209533, 54.19169917132329, 148.2208895718306, 148.49398095317864, 178.51831582173347, 147.51440381479514, 130.3915713069656, 168.7601019891734, -8.932451609872025, 37.55813618476188, 188.19211395690962, 151.60373636507344, 131.95841666833124, 112.0366728570034, 87.51499043383254, 66.39106265249666, -4.249457106742734, 53.96356686877897, 65.64278562086119, 48.84130957587581, 153.8259969019841, 171.6609126844528, 41.818078982123176, 59.35189008240122, 175.98955511817516, 84.2218109703156, -68.83245633978183, 0.12805802620086887, 167.76283882129025, 163.74391652241502, -9.48286098246199, 37.390341634029326, 176.77474803664308, 153.0440887512307, -81.73032563166565, -63.32591606084958, 182.45717032333675, 176.90006548003828, 74.28897429611864, 30.195886405460733, 176.7868877090768, 141.70944598644238, -26.244391171920505, -36.495873101399, -28.898087691442925, 7.56269288812984, 155.319385484487, 170.10807829161362, 171.08073639129967, 171.64775413167385, 1.3730166744674808, -67.04848910854712, -131.93153282844565, -31.210971783594722, -66.58837061945007, 21.1653150178943, -129.9085702696031, 13.2742511530485, -105.45913212043304, 23.671880609941773, -64.81341819638436, -27.44818945225912, 186.66508167929746, 128.4587886181896], "policy_predator_policy_reward": [58.391133098463904, 49.293635941517145, 43.546306767611036, 20.101160914835763, 14.872529646198451, 10.882143100197515, 55.7263868736087, 53.43300166862359, 15.804380512078586, 9.444193545171881, 51.0166372320791, 43.57030994840882, 18.966579875386536, 24.381235755627376, 166.71979162969015, 144.09960195864176, 32.09529760244927, 18.09606510661129, 21.258302642603642, 28.077938997208093, 44.08955890092599, 47.14778321530503, 115.69725455847588, 26.524779677735648, 162.21716367070673, 43.490011253617716, 30.514540749940736, 19.15179434114984, 39.47106010783917, 113.44050134059115, 41.28833796123274, 141.00112032872667, 52.212573003236734, 65.45910541389, 7.330532388554973, 16.567816338861665, 55.48037768287164, 36.12924407249159, 40.636707825641, 20.039885419546493, 15.070971515913257, 23.417076474350942, 138.70740858913095, 14.039781232905638, 39.87125439888842, 28.620307742982202, 172.46914942389373, 28.807957822842788, 5.664038131171388, 31.73578378658279, 40.30130583580528, 29.306823394134085, 24.564548205106043, 49.042051802623234, 155.49864084428188, 55.731288575462024, 159.51840153411052, 37.0766636559341, 85.39225187925217, 99.25505587330397, 48.998669892104004, 30.790206261244272, 68.63423255034633, 39.9201108073138, 51.707710616436465, 55.53012041129274, 18.205462993311134, 8.702244115087186, 228.58973684882724, 17.099858192697297, 43.348889168355626, 64.1406719309048, 25.773447115278422, 46.09493255250273, 24.830406113594247, 31.457593874948657, 21.81233876940197, 190.24715507852034, 130.66801188441693, 228.73028148571734, 16.722957347150956, 14.549558966326265, 30.954466551514493, 9.84051123155639, 31.22754983964662, 58.53690894669691, 166.11589117058136, 12.543157754386108, 9.926457499074381, 10.658274345755398, 4.318425083114353, 20.140403682758357, 96.77384067846222, 8.268952811033195, 20.26316221542931, 41.983185006049574, 27.81681277747103, 58.646707248641384, 18.805588152550804, 21.051783568867137, 166.8960804512858, 23.541003223329735, 201.63151533397402, 4.100035514080281, 15.267188918854291, 13.217517367356873, 15.99141707806926, 34.09096860345032, 218.25852307719327, 15.250094072437518, 59.06352466908168, 20.964279585982705, 5.722500037028164, 189.72495251304636, 18.51863576999129, 6.83257359618227, 202.7386011369486, 30.21624328106221, 36.813366632400545, 42.78050626205695, 13.277448974150943, 30.736794481321194, 34.94985682098786, 208.14186132150311, 31.78956495591447, 31.723643040438315, 370.31439527532496, 216.27346467001692, 21.78840852161415, 18.574387407754823, 82.89380833906097, 205.01192329973938, 54.47906967588923, 39.34470314164283, 80.9801112094398, 122.29476702698014, 4.720578796282968, 274.8595590346836, 44.624191392794835, 46.2136440929569, 28.893387482930155, 24.451307194517966, 27.627792911018993, 7.977431248371387, 8.915285900547126, 221.6150611961805, 16.886017716792434, 14.718284035017543, 83.07855654427644, 15.648738394157952, 141.84440952073896, 36.564374075019565, 10.399322983690041, 203.94832161654404, 171.14553312414512, 36.194776937348855, 34.481759253205524, 23.696698080821886, 173.89704276691674, 29.791292262512584, 15.091990788120242, 16.702718327426606, 192.54998379936893, 198.01518338450143, 43.662506521941, 24.68635864284772, 153.1211303060834, 229.47989778702484, 28.05060027819335, 15.478477208890933, 196.53264208895234, 323.1432620119374, 20.95724336436484, 15.663311738384662, 135.24687782507726, 161.47600444641273, 35.18910481548047, 38.4155771309284, 154.94536662138722, 228.16091418126717, 256.2650000834539, 193.27630188315956, 24.47881857459663, 27.461231298707833, 11.162626228494956, 17.75298869455397, 225.70954688598744, 264.11388163614805, 345.68592192191454, 220.28037649272162, 230.05166501742798, 184.0809164782716, 61.96471314980574, 340.7039377439524, 43.78783808281881, 335.62241282304166, 350.6950539634538, 20.893706630701097, 5.859005749222351, 15.304530389591246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.632397974852297, "mean_inference_ms": 1.989814677726502, "mean_action_processing_ms": 0.262302781763176, "mean_env_wait_ms": 0.2420201978357969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004696249961853027, "StateBufferConnector_ms": 0.0032848119735717773, "ViewRequirementAgentConnector_ms": 0.09398913383483887}, "num_episodes": 18, "episode_return_max": 459.6878443390186, "episode_return_min": 255.19694356434002, "episode_return_mean": 361.52239615816006, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 376.17262632624255, "num_env_steps_trained_throughput_per_sec": 376.17262632624255, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 10119.667, "restore_workers_time_ms": 0.017, "training_step_time_ms": 10119.622, "sample_time_ms": 1321.681, "learn_time_ms": 8780.966, "learn_throughput": 455.531, "synch_weights_time_ms": 15.425}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-31", "timestamp": 1723779211, "time_this_iter_s": 10.691349983215332, "time_total_s": 1019.8339056968689, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b22f9790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1019.8339056968689, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 31.693333333333335, "ram_util_percent": 83.10666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.520446963379623, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.628693869504978, "policy_loss": -0.0025988319710084293, "vf_loss": 8.631227274294252, "vf_explained_var": 0.04334159395682118, "kl": 0.0031006665209101763, "entropy": 0.3027194033145274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.95708194416036, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.315936959988226, "policy_loss": -0.003429987267270763, "vf_loss": 9.319015484259873, "vf_explained_var": -0.01795472502708435, "kl": 0.009372932871095342, "entropy": 1.0129676884444303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 453.5935592201362, "episode_reward_min": 211.8519015435368, "episode_reward_mean": 356.47002161927134, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -221.62216441373758, "predator_policy": 4.100035514080281}, "policy_reward_max": {"prey_policy": 191.87801648377183, "predator_policy": 407.78282649702186}, "policy_reward_mean": {"prey_policy": 85.88281917721626, "predator_policy": 92.35219163241949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.4325763023171, 403.4893362759366, 387.5374174851573, 293.9693355886637, 409.7466374273851, 309.7675758845114, 368.56156104962923, 399.4438238649419, 391.46099682177396, 333.26884379792205, 314.44427473801636, 396.37368923553424, 391.31875979618127, 423.8177729995685, 426.5118377914063, 377.02067784082493, 294.8129781978479, 373.990587222544, 365.9827686007405, 356.4303956054789, 289.2156482586397, 337.0670453540839, 378.56538987257727, 394.4748760745467, 385.3592752914693, 316.02779447469163, 370.33402811632504, 383.8924507798946, 312.7418094834699, 393.817806776512, 410.3244552732436, 376.3157584387769, 291.84765418330403, 255.19694356434002, 363.71969525524435, 389.6303148243604, 307.5302285730763, 383.14947300819455, 293.1475179238424, 365.52530408784105, 298.24085719643534, 376.20514981844406, 353.7952588879554, 302.23849670853684, 379.0309399364015, 453.5935592201362, 391.92246089605203, 361.1381933417346, 358.72120092162294, 394.5296936638714, 261.4462586201947, 387.55270601076097, 379.3774143139766, 334.7568974555293, 259.1560316716172, 371.4001520737931, 342.72238446376895, 332.314836682088, 264.06175436227, 321.8244052582313, 383.6653669204643, 304.8583040939533, 292.0060752040378, 321.86076887028884, 399.8556205084934, 410.5085087446748, 373.34791427495867, 374.61966240837467, 395.9777909061249, 401.20774297307025, 392.1010156419282, 320.3660165293343, 428.2059071633005, 377.36751364940505, 371.6441054460225, 424.1479560880554, 402.82379380259584, 368.7095258941449, 286.03433177720376, 297.6229993953694, 279.3271529455105, 336.2874064363008, 320.49993365513797, 401.6788203458062, 392.37553062265306, 367.7879978590796, 396.51221061387093, 347.3062633265183, 374.2481041920225, 335.5234658785626, 248.49361002027743, 400.4663986825909, 211.8519015435368, 300.73482106246087, 358.9031838028928, 435.04470994645493, 315.4916668740515, 381.6705851035003, 453.13799561778393, 309.4355154620955], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [175.10552647052512, 146.71742807642875, 188.0032010577616, 154.80954197298766, 178.53167941746432, 170.51769007742865, 67.96542658800209, 73.25671917862469, 156.14409813712993, 185.11097714838456, 56.45014772870287, 52.04032090907246, 168.08740632962414, 163.07433280225104, 142.5271678899022, 187.3085267451003, 191.87801648377183, 125.97638033027314, 40.79654826768726, 81.2423661104907, 71.33670244552107, 46.51250710245098, 110.8051753328919, 100.92120615008635, 173.00010854901282, 138.52977509382032, 159.3289113764776, 155.93451826543046, 137.51385940828442, 181.7601473553929, 183.96918127089495, 166.14378946153164, 32.397100007700544, 16.726283148622706, 120.00473398618507, 146.49629213709875, 145.29715587593117, 148.8172330570283, 156.68794652581084, 143.4544490911253, 39.9605811919057, 37.19557321881186, 0.1452330227319465, -22.476481038782378, 176.48888320610376, 170.80399035299627, 169.28833455270845, 184.3915637387675, 133.6312927180066, 161.96352378711927, 87.4204441785489, 49.9483013711749, 164.2679744649504, 185.4813218065446, 185.60495802971099, 173.828663984311, 93.42471559792588, 114.27430039604899, 185.4803902756512, 146.09106927938203, 169.16112104968968, 154.69981419744158, 175.27251413138393, 161.18587258597506, 67.90040427423793, 33.510166234450985, 27.332776444933515, 22.132616271352525, 153.81129236913347, 181.42369659989964, 163.06619367864226, 176.48173546419866, -4.739586206646457, 78.7611976300923, 165.87695540407134, 137.2447133490588, 64.69316445557529, 33.00690091819251, 173.30723553810267, 166.8668591835647, 54.77648898394281, 10.509523794480847, 135.01408724283587, 161.5971896811504, 139.71512135498273, 170.06589407750062, 46.478224315725065, 12.66855425032098, 148.40378251256516, 167.11394942748365, -58.8206222821025, -74.17367844310458, 178.66821606306988, 172.89144890361334, -5.776654171489123, 79.00911587442383, 142.32485849694098, 122.57256960715041, 84.38910220807972, 106.86571321937218, -72.32557838209533, 54.19169917132329, 148.2208895718306, 148.49398095317864, 178.51831582173347, 147.51440381479514, 130.3915713069656, 168.7601019891734, -8.932451609872025, 37.55813618476188, 188.19211395690962, 151.60373636507344, 131.95841666833124, 112.0366728570034, 87.51499043383254, 66.39106265249666, -4.249457106742734, 53.96356686877897, 65.64278562086119, 48.84130957587581, 153.8259969019841, 171.6609126844528, 41.818078982123176, 59.35189008240122, 175.98955511817516, 84.2218109703156, -68.83245633978183, 0.12805802620086887, 167.76283882129025, 163.74391652241502, -9.48286098246199, 37.390341634029326, 176.77474803664308, 153.0440887512307, -81.73032563166565, -63.32591606084958, 182.45717032333675, 176.90006548003828, 74.28897429611864, 30.195886405460733, 176.7868877090768, 141.70944598644238, -26.244391171920505, -36.495873101399, -28.898087691442925, 7.56269288812984, 155.319385484487, 170.10807829161362, 171.08073639129967, 171.64775413167385, 1.3730166744674808, -67.04848910854712, -131.93153282844565, -31.210971783594722, -66.58837061945007, 21.1653150178943, -129.9085702696031, 13.2742511530485, -105.45913212043304, 23.671880609941773, -64.81341819638436, -27.44818945225912, 186.66508167929746, 128.4587886181896, 36.16506376927252, 51.60921042197918, 56.42539205647011, 50.42893406151078, 157.10133875139834, 174.35467308022575, 36.282688580940125, 58.18633188128823, -1.2446798038325542, -4.0718690344494295, -11.888067987634974, -4.922743557313975, 153.23320568464638, 159.27982848708675, 105.59775100864555, 81.59440044743822, -12.355353795759036, -27.61794220495006, 4.489172916373986, 7.11684493508105, -221.62216441373758, -1.6044154134971318, 53.878844662205296, 13.619786929950962, 144.89646517204673, 163.47421262593568, 22.672730916886394, 27.343144110013416, 1.0526553049067238, 34.105616853899335, 36.422378079769906, 26.314491123429956, -92.81776672419579, -35.42424559428399, 25.673095105525388, 21.88575779040211], "policy_predator_policy_reward": [55.48037768287164, 36.12924407249159, 40.636707825641, 20.039885419546493, 15.070971515913257, 23.417076474350942, 138.70740858913095, 14.039781232905638, 39.87125439888842, 28.620307742982202, 172.46914942389373, 28.807957822842788, 5.664038131171388, 31.73578378658279, 40.30130583580528, 29.306823394134085, 24.564548205106043, 49.042051802623234, 155.49864084428188, 55.731288575462024, 159.51840153411052, 37.0766636559341, 85.39225187925217, 99.25505587330397, 48.998669892104004, 30.790206261244272, 68.63423255034633, 39.9201108073138, 51.707710616436465, 55.53012041129274, 18.205462993311134, 8.702244115087186, 228.58973684882724, 17.099858192697297, 43.348889168355626, 64.1406719309048, 25.773447115278422, 46.09493255250273, 24.830406113594247, 31.457593874948657, 21.81233876940197, 190.24715507852034, 130.66801188441693, 228.73028148571734, 16.722957347150956, 14.549558966326265, 30.954466551514493, 9.84051123155639, 31.22754983964662, 58.53690894669691, 166.11589117058136, 12.543157754386108, 9.926457499074381, 10.658274345755398, 4.318425083114353, 20.140403682758357, 96.77384067846222, 8.268952811033195, 20.26316221542931, 41.983185006049574, 27.81681277747103, 58.646707248641384, 18.805588152550804, 21.051783568867137, 166.8960804512858, 23.541003223329735, 201.63151533397402, 4.100035514080281, 15.267188918854291, 13.217517367356873, 15.99141707806926, 34.09096860345032, 218.25852307719327, 15.250094072437518, 59.06352466908168, 20.964279585982705, 5.722500037028164, 189.72495251304636, 18.51863576999129, 6.83257359618227, 202.7386011369486, 30.21624328106221, 36.813366632400545, 42.78050626205695, 13.277448974150943, 30.736794481321194, 34.94985682098786, 208.14186132150311, 31.78956495591447, 31.723643040438315, 370.31439527532496, 216.27346467001692, 21.78840852161415, 18.574387407754823, 82.89380833906097, 205.01192329973938, 54.47906967588923, 39.34470314164283, 80.9801112094398, 122.29476702698014, 4.720578796282968, 274.8595590346836, 44.624191392794835, 46.2136440929569, 28.893387482930155, 24.451307194517966, 27.627792911018993, 7.977431248371387, 8.915285900547126, 221.6150611961805, 16.886017716792434, 14.718284035017543, 83.07855654427644, 15.648738394157952, 141.84440952073896, 36.564374075019565, 10.399322983690041, 203.94832161654404, 171.14553312414512, 36.194776937348855, 34.481759253205524, 23.696698080821886, 173.89704276691674, 29.791292262512584, 15.091990788120242, 16.702718327426606, 192.54998379936893, 198.01518338450143, 43.662506521941, 24.68635864284772, 153.1211303060834, 229.47989778702484, 28.05060027819335, 15.478477208890933, 196.53264208895234, 323.1432620119374, 20.95724336436484, 15.663311738384662, 135.24687782507726, 161.47600444641273, 35.18910481548047, 38.4155771309284, 154.94536662138722, 228.16091418126717, 256.2650000834539, 193.27630188315956, 24.47881857459663, 27.461231298707833, 11.162626228494956, 17.75298869455397, 225.70954688598744, 264.11388163614805, 345.68592192191454, 220.28037649272162, 230.05166501742798, 184.0809164782716, 61.96471314980574, 340.7039377439524, 43.78783808281881, 335.62241282304166, 350.6950539634538, 20.893706630701097, 5.859005749222351, 15.304530389591246, 42.54065156293286, 190.1850079009538, 150.7563895530967, 144.06810467472883, 18.706438699786577, 42.21308009124257, 172.5228116638181, 100.79616573303235, 168.11764428666032, 233.7111151654922, 257.93976711303975, 106.17730775842767, 18.126713597289292, 43.60835642299992, 108.59537564667937, 39.735938775799276, 9.903399844694736, 278.56350617629244, 173.82703834488763, 215.03334248624878, 27.295654873751698, 407.78282649702186, 205.35883760033497, 27.87735186996981, 26.64588952018252, 23.886616484727888, 188.03008642811298, 196.99874849144177, 37.08105525544416, 243.25233945980102, 161.50847240529149, 157.42524349500928, 279.6612616681102, 301.71874626815344, 200.1504875844507, 61.72617498171729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6316161400149611, "mean_inference_ms": 1.9879109520486755, "mean_action_processing_ms": 0.2619781500408303, "mean_env_wait_ms": 0.24172770514372502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005206942558288574, "StateBufferConnector_ms": 0.003243684768676758, "ViewRequirementAgentConnector_ms": 0.09892356395721436}, "num_episodes": 18, "episode_return_max": 453.5935592201362, "episode_return_min": 211.8519015435368, "episode_return_mean": 356.47002161927134, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.21346169123694, "num_env_steps_trained_throughput_per_sec": 394.21346169123694, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 10121.058, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10121.019, "sample_time_ms": 1328.459, "learn_time_ms": 8775.084, "learn_throughput": 455.836, "synch_weights_time_ms": 15.897}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-41", "timestamp": 1723779221, "time_this_iter_s": 10.155653953552246, "time_total_s": 1029.9895596504211, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20cd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1029.9895596504211, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 30.828571428571422, "ram_util_percent": 83.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.192558217048645, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.842918471179942, "policy_loss": -0.006019200116923207, "vf_loss": 8.848886101334184, "vf_explained_var": 0.08018847502097881, "kl": 0.004890245192299594, "entropy": 0.3109276278624459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.984133313446448, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.424412379189143, "policy_loss": -0.003874657268601435, "vf_loss": 9.427978399064806, "vf_explained_var": -0.03332574446365316, "kl": 0.008229939274650763, "entropy": 1.0497773796793015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 573.7699432335947, "episode_reward_min": 211.8519015435368, "episode_reward_mean": 355.3332229012275, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -482.94085627306634, "predator_policy": 4.100035514080281}, "policy_reward_max": {"prey_policy": 188.19211395690962, "predator_policy": 620.3101723336724}, "policy_reward_mean": {"prey_policy": 57.26673214892697, "predator_policy": 120.39987930168684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.56538987257727, 394.4748760745467, 385.3592752914693, 316.02779447469163, 370.33402811632504, 383.8924507798946, 312.7418094834699, 393.817806776512, 410.3244552732436, 376.3157584387769, 291.84765418330403, 255.19694356434002, 363.71969525524435, 389.6303148243604, 307.5302285730763, 383.14947300819455, 293.1475179238424, 365.52530408784105, 298.24085719643534, 376.20514981844406, 353.7952588879554, 302.23849670853684, 379.0309399364015, 453.5935592201362, 391.92246089605203, 361.1381933417346, 358.72120092162294, 394.5296936638714, 261.4462586201947, 387.55270601076097, 379.3774143139766, 334.7568974555293, 259.1560316716172, 371.4001520737931, 342.72238446376895, 332.314836682088, 264.06175436227, 321.8244052582313, 383.6653669204643, 304.8583040939533, 292.0060752040378, 321.86076887028884, 399.8556205084934, 410.5085087446748, 373.34791427495867, 374.61966240837467, 395.9777909061249, 401.20774297307025, 392.1010156419282, 320.3660165293343, 428.2059071633005, 377.36751364940505, 371.6441054460225, 424.1479560880554, 402.82379380259584, 368.7095258941449, 286.03433177720376, 297.6229993953694, 279.3271529455105, 336.2874064363008, 320.49993365513797, 401.6788203458062, 392.37553062265306, 367.7879978590796, 396.51221061387093, 347.3062633265183, 374.2481041920225, 335.5234658785626, 248.49361002027743, 400.4663986825909, 211.8519015435368, 300.73482106246087, 358.9031838028928, 435.04470994645493, 315.4916668740515, 381.6705851035003, 453.13799561778393, 309.4355154620955, 309.39508970999185, 411.99330126680826, 324.79002447910915, 259.14266166837353, 380.61588119869094, 446.05342570883397, 573.7699432335947, 261.8987268994479, 282.43475947201415, 273.007872564036, 534.9844084639511, 272.4248758261344, 239.21309505535552, 318.8811432102172, 349.1558309020099, 416.40452372373113, 396.9681688009283, 285.80772365155354, 381.5750425578677, 456.8559777081854, 380.6516959682597, 387.96049626561836], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.48888320610376, 170.80399035299627, 169.28833455270845, 184.3915637387675, 133.6312927180066, 161.96352378711927, 87.4204441785489, 49.9483013711749, 164.2679744649504, 185.4813218065446, 185.60495802971099, 173.828663984311, 93.42471559792588, 114.27430039604899, 185.4803902756512, 146.09106927938203, 169.16112104968968, 154.69981419744158, 175.27251413138393, 161.18587258597506, 67.90040427423793, 33.510166234450985, 27.332776444933515, 22.132616271352525, 153.81129236913347, 181.42369659989964, 163.06619367864226, 176.48173546419866, -4.739586206646457, 78.7611976300923, 165.87695540407134, 137.2447133490588, 64.69316445557529, 33.00690091819251, 173.30723553810267, 166.8668591835647, 54.77648898394281, 10.509523794480847, 135.01408724283587, 161.5971896811504, 139.71512135498273, 170.06589407750062, 46.478224315725065, 12.66855425032098, 148.40378251256516, 167.11394942748365, -58.8206222821025, -74.17367844310458, 178.66821606306988, 172.89144890361334, -5.776654171489123, 79.00911587442383, 142.32485849694098, 122.57256960715041, 84.38910220807972, 106.86571321937218, -72.32557838209533, 54.19169917132329, 148.2208895718306, 148.49398095317864, 178.51831582173347, 147.51440381479514, 130.3915713069656, 168.7601019891734, -8.932451609872025, 37.55813618476188, 188.19211395690962, 151.60373636507344, 131.95841666833124, 112.0366728570034, 87.51499043383254, 66.39106265249666, -4.249457106742734, 53.96356686877897, 65.64278562086119, 48.84130957587581, 153.8259969019841, 171.6609126844528, 41.818078982123176, 59.35189008240122, 175.98955511817516, 84.2218109703156, -68.83245633978183, 0.12805802620086887, 167.76283882129025, 163.74391652241502, -9.48286098246199, 37.390341634029326, 176.77474803664308, 153.0440887512307, -81.73032563166565, -63.32591606084958, 182.45717032333675, 176.90006548003828, 74.28897429611864, 30.195886405460733, 176.7868877090768, 141.70944598644238, -26.244391171920505, -36.495873101399, -28.898087691442925, 7.56269288812984, 155.319385484487, 170.10807829161362, 171.08073639129967, 171.64775413167385, 1.3730166744674808, -67.04848910854712, -131.93153282844565, -31.210971783594722, -66.58837061945007, 21.1653150178943, -129.9085702696031, 13.2742511530485, -105.45913212043304, 23.671880609941773, -64.81341819638436, -27.44818945225912, 186.66508167929746, 128.4587886181896, 36.16506376927252, 51.60921042197918, 56.42539205647011, 50.42893406151078, 157.10133875139834, 174.35467308022575, 36.282688580940125, 58.18633188128823, -1.2446798038325542, -4.0718690344494295, -11.888067987634974, -4.922743557313975, 153.23320568464638, 159.27982848708675, 105.59775100864555, 81.59440044743822, -12.355353795759036, -27.61794220495006, 4.489172916373986, 7.11684493508105, -221.62216441373758, -1.6044154134971318, 53.878844662205296, 13.619786929950962, 144.89646517204673, 163.47421262593568, 22.672730916886394, 27.343144110013416, 1.0526553049067238, 34.105616853899335, 36.422378079769906, 26.314491123429956, -92.81776672419579, -35.42424559428399, 25.673095105525388, 21.88575779040211, 25.725578917205087, -43.27551229613961, 36.36296037050405, -19.049573032605757, 72.3793634733661, -0.2044844421513098, 17.09497699775996, 43.936051170591114, -8.475744469683336, 18.12374060761104, 67.93005174438309, 34.736373133659114, 28.152291022077932, -482.94085627306634, 11.93825730328619, -1.814304748142178, 11.234756320468232, 10.093331255449911, -88.0283983167422, 13.678185670151953, 5.484734783375879, -87.47958795872644, 41.633390928972624, 2.0000000000000013, -75.34278841936735, -48.58603563430941, 27.802158059680963, 46.45935473656534, -48.18124015150666, -19.225316786469037, -122.77439598780164, -36.691716413704036, 43.90590079706609, -17.302533622165157, 1.5983506473061622, 42.00330821587116, 172.59806592620842, 175.99674472463082, 22.99111741272021, -57.45241453643708, -50.69243645857637, -20.17907835609867, -121.23474256485724, -52.139805650642934], "policy_predator_policy_reward": [16.722957347150956, 14.549558966326265, 30.954466551514493, 9.84051123155639, 31.22754983964662, 58.53690894669691, 166.11589117058136, 12.543157754386108, 9.926457499074381, 10.658274345755398, 4.318425083114353, 20.140403682758357, 96.77384067846222, 8.268952811033195, 20.26316221542931, 41.983185006049574, 27.81681277747103, 58.646707248641384, 18.805588152550804, 21.051783568867137, 166.8960804512858, 23.541003223329735, 201.63151533397402, 4.100035514080281, 15.267188918854291, 13.217517367356873, 15.99141707806926, 34.09096860345032, 218.25852307719327, 15.250094072437518, 59.06352466908168, 20.964279585982705, 5.722500037028164, 189.72495251304636, 18.51863576999129, 6.83257359618227, 202.7386011369486, 30.21624328106221, 36.813366632400545, 42.78050626205695, 13.277448974150943, 30.736794481321194, 34.94985682098786, 208.14186132150311, 31.78956495591447, 31.723643040438315, 370.31439527532496, 216.27346467001692, 21.78840852161415, 18.574387407754823, 82.89380833906097, 205.01192329973938, 54.47906967588923, 39.34470314164283, 80.9801112094398, 122.29476702698014, 4.720578796282968, 274.8595590346836, 44.624191392794835, 46.2136440929569, 28.893387482930155, 24.451307194517966, 27.627792911018993, 7.977431248371387, 8.915285900547126, 221.6150611961805, 16.886017716792434, 14.718284035017543, 83.07855654427644, 15.648738394157952, 141.84440952073896, 36.564374075019565, 10.399322983690041, 203.94832161654404, 171.14553312414512, 36.194776937348855, 34.481759253205524, 23.696698080821886, 173.89704276691674, 29.791292262512584, 15.091990788120242, 16.702718327426606, 192.54998379936893, 198.01518338450143, 43.662506521941, 24.68635864284772, 153.1211303060834, 229.47989778702484, 28.05060027819335, 15.478477208890933, 196.53264208895234, 323.1432620119374, 20.95724336436484, 15.663311738384662, 135.24687782507726, 161.47600444641273, 35.18910481548047, 38.4155771309284, 154.94536662138722, 228.16091418126717, 256.2650000834539, 193.27630188315956, 24.47881857459663, 27.461231298707833, 11.162626228494956, 17.75298869455397, 225.70954688598744, 264.11388163614805, 345.68592192191454, 220.28037649272162, 230.05166501742798, 184.0809164782716, 61.96471314980574, 340.7039377439524, 43.78783808281881, 335.62241282304166, 350.6950539634538, 20.893706630701097, 5.859005749222351, 15.304530389591246, 42.54065156293286, 190.1850079009538, 150.7563895530967, 144.06810467472883, 18.706438699786577, 42.21308009124257, 172.5228116638181, 100.79616573303235, 168.11764428666032, 233.7111151654922, 257.93976711303975, 106.17730775842767, 18.126713597289292, 43.60835642299992, 108.59537564667937, 39.735938775799276, 9.903399844694736, 278.56350617629244, 173.82703834488763, 215.03334248624878, 27.295654873751698, 407.78282649702186, 205.35883760033497, 27.87735186996981, 26.64588952018252, 23.886616484727888, 188.03008642811298, 196.99874849144177, 37.08105525544416, 243.25233945980102, 161.50847240529149, 157.42524349500928, 279.6612616681102, 301.71874626815344, 200.1504875844507, 61.72617498171729, 40.60830094329182, 286.3367221456342, 218.91183409366104, 175.76807983524827, 46.11343198413313, 206.50171346376047, 184.57262601514677, 13.53900748487556, 152.02964486037135, 218.9382402003922, 168.36515441836403, 175.0218464124275, 620.3101723336724, 408.24833615091086, 240.1375465614521, 11.637227782852031, 219.61170012577315, 41.49497177032327, 10.836086795180172, 336.521998415447, 320.7872821674891, 296.191979471812, 141.52723576871398, 87.26424912844797, 20.69655371583427, 342.4453653931986, 58.250418621088485, 186.36921179288254, 120.04271221442461, 296.51967562556047, 292.0589644187443, 283.81167170649275, 163.81396378484104, 206.55083784118608, 213.82699587152425, 28.379068916851846, 16.624176935402886, 16.356054971625824, 246.97047290287122, 244.34680192902988, 176.1774245481403, 275.3457862347942, 302.2783633460634, 259.05668113505635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6306126715440719, "mean_inference_ms": 1.9856887240416343, "mean_action_processing_ms": 0.2615904312622908, "mean_env_wait_ms": 0.24137676864048402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006020307540893555, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.10770535469055176}, "num_episodes": 22, "episode_return_max": 573.7699432335947, "episode_return_min": 211.8519015435368, "episode_return_mean": 355.3332229012275, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.3998441789744, "num_env_steps_trained_throughput_per_sec": 352.3998441789744, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 10249.273, "restore_workers_time_ms": 0.014, "training_step_time_ms": 10249.232, "sample_time_ms": 1334.61, "learn_time_ms": 8896.071, "learn_throughput": 449.637, "synch_weights_time_ms": 16.596}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "e552a_00000", "date": "2024-08-16_09-03-53", "timestamp": 1723779233, "time_this_iter_s": 11.386895895004272, "time_total_s": 1041.3764555454254, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20de430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1041.3764555454254, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 34.206250000000004, "ram_util_percent": 83.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.825611280921906, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.193725845296546, "policy_loss": -0.0022174485978823173, "vf_loss": 9.19591405353849, "vf_explained_var": 0.01699811683760749, "kl": 0.00554940700602947, "entropy": 0.2765423650385211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.140783454028387, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.612383992835959, "policy_loss": -0.0037699144000985793, "vf_loss": 9.61585263650884, "vf_explained_var": 0.009517550436907975, "kl": 0.008033618552820854, "entropy": 1.0759048014721542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 573.7699432335947, "episode_reward_min": 101.95244161179396, "episode_reward_mean": 360.07847330594467, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -482.94085627306634, "predator_policy": 4.720578796282968}, "policy_reward_max": {"prey_policy": 188.19211395690962, "predator_policy": 620.3101723336724}, "policy_reward_mean": {"prey_policy": 25.989400386729493, "predator_policy": 154.04983626624286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [298.24085719643534, 376.20514981844406, 353.7952588879554, 302.23849670853684, 379.0309399364015, 453.5935592201362, 391.92246089605203, 361.1381933417346, 358.72120092162294, 394.5296936638714, 261.4462586201947, 387.55270601076097, 379.3774143139766, 334.7568974555293, 259.1560316716172, 371.4001520737931, 342.72238446376895, 332.314836682088, 264.06175436227, 321.8244052582313, 383.6653669204643, 304.8583040939533, 292.0060752040378, 321.86076887028884, 399.8556205084934, 410.5085087446748, 373.34791427495867, 374.61966240837467, 395.9777909061249, 401.20774297307025, 392.1010156419282, 320.3660165293343, 428.2059071633005, 377.36751364940505, 371.6441054460225, 424.1479560880554, 402.82379380259584, 368.7095258941449, 286.03433177720376, 297.6229993953694, 279.3271529455105, 336.2874064363008, 320.49993365513797, 401.6788203458062, 392.37553062265306, 367.7879978590796, 396.51221061387093, 347.3062633265183, 374.2481041920225, 335.5234658785626, 248.49361002027743, 400.4663986825909, 211.8519015435368, 300.73482106246087, 358.9031838028928, 435.04470994645493, 315.4916668740515, 381.6705851035003, 453.13799561778393, 309.4355154620955, 309.39508970999185, 411.99330126680826, 324.79002447910915, 259.14266166837353, 380.61588119869094, 446.05342570883397, 573.7699432335947, 261.8987268994479, 282.43475947201415, 273.007872564036, 534.9844084639511, 272.4248758261344, 239.21309505535552, 318.8811432102172, 349.1558309020099, 416.40452372373113, 396.9681688009283, 285.80772365155354, 381.5750425578677, 456.8559777081854, 380.6516959682597, 387.96049626561836, 299.5575343416453, 342.40361575409344, 506.655754050045, 101.95244161179396, 453.23376745181474, 436.9325634908533, 486.3293319263926, 378.47767715797676, 383.96331733208785, 425.539472245461, 285.2607080706704, 380.9430310932874, 349.6513261703252, 334.7575466652832, 422.0414878344032, 450.9958332157026, 396.8721208164887, 410.5582872451037], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [54.77648898394281, 10.509523794480847, 135.01408724283587, 161.5971896811504, 139.71512135498273, 170.06589407750062, 46.478224315725065, 12.66855425032098, 148.40378251256516, 167.11394942748365, -58.8206222821025, -74.17367844310458, 178.66821606306988, 172.89144890361334, -5.776654171489123, 79.00911587442383, 142.32485849694098, 122.57256960715041, 84.38910220807972, 106.86571321937218, -72.32557838209533, 54.19169917132329, 148.2208895718306, 148.49398095317864, 178.51831582173347, 147.51440381479514, 130.3915713069656, 168.7601019891734, -8.932451609872025, 37.55813618476188, 188.19211395690962, 151.60373636507344, 131.95841666833124, 112.0366728570034, 87.51499043383254, 66.39106265249666, -4.249457106742734, 53.96356686877897, 65.64278562086119, 48.84130957587581, 153.8259969019841, 171.6609126844528, 41.818078982123176, 59.35189008240122, 175.98955511817516, 84.2218109703156, -68.83245633978183, 0.12805802620086887, 167.76283882129025, 163.74391652241502, -9.48286098246199, 37.390341634029326, 176.77474803664308, 153.0440887512307, -81.73032563166565, -63.32591606084958, 182.45717032333675, 176.90006548003828, 74.28897429611864, 30.195886405460733, 176.7868877090768, 141.70944598644238, -26.244391171920505, -36.495873101399, -28.898087691442925, 7.56269288812984, 155.319385484487, 170.10807829161362, 171.08073639129967, 171.64775413167385, 1.3730166744674808, -67.04848910854712, -131.93153282844565, -31.210971783594722, -66.58837061945007, 21.1653150178943, -129.9085702696031, 13.2742511530485, -105.45913212043304, 23.671880609941773, -64.81341819638436, -27.44818945225912, 186.66508167929746, 128.4587886181896, 36.16506376927252, 51.60921042197918, 56.42539205647011, 50.42893406151078, 157.10133875139834, 174.35467308022575, 36.282688580940125, 58.18633188128823, -1.2446798038325542, -4.0718690344494295, -11.888067987634974, -4.922743557313975, 153.23320568464638, 159.27982848708675, 105.59775100864555, 81.59440044743822, -12.355353795759036, -27.61794220495006, 4.489172916373986, 7.11684493508105, -221.62216441373758, -1.6044154134971318, 53.878844662205296, 13.619786929950962, 144.89646517204673, 163.47421262593568, 22.672730916886394, 27.343144110013416, 1.0526553049067238, 34.105616853899335, 36.422378079769906, 26.314491123429956, -92.81776672419579, -35.42424559428399, 25.673095105525388, 21.88575779040211, 25.725578917205087, -43.27551229613961, 36.36296037050405, -19.049573032605757, 72.3793634733661, -0.2044844421513098, 17.09497699775996, 43.936051170591114, -8.475744469683336, 18.12374060761104, 67.93005174438309, 34.736373133659114, 28.152291022077932, -482.94085627306634, 11.93825730328619, -1.814304748142178, 11.234756320468232, 10.093331255449911, -88.0283983167422, 13.678185670151953, 5.484734783375879, -87.47958795872644, 41.633390928972624, 2.0000000000000013, -75.34278841936735, -48.58603563430941, 27.802158059680963, 46.45935473656534, -48.18124015150666, -19.225316786469037, -122.77439598780164, -36.691716413704036, 43.90590079706609, -17.302533622165157, 1.5983506473061622, 42.00330821587116, 172.59806592620842, 175.99674472463082, 22.99111741272021, -57.45241453643708, -50.69243645857637, -20.17907835609867, -121.23474256485724, -52.139805650642934, 0.15915545895490485, -17.083787651170493, -72.40890757098299, -48.726870424475074, -188.36451751069248, -279.8773998473191, -10.271185666708634, -58.16602157634475, 46.20851380946242, -20.085230638487587, -11.888670685733372, -7.0791283994767555, -35.22727217557608, -201.74355179526682, -53.95953840991144, 56.20464767349665, 166.56765069879154, 164.34235371520555, -125.4715526875631, -0.1256097381029182, -35.14105224277855, 34.27699247548578, -34.057865281990104, -33.67600679466089, 103.04569666321643, 107.60158123062017, -17.341673671420345, -332.21568654190264, 7.221372162493221, -106.2429759702646, -70.46334511359494, -91.38068103829026, -58.6855324781728, 27.705440630713174, -102.98491735855633, -272.74540437518664], "policy_predator_policy_reward": [202.7386011369486, 30.21624328106221, 36.813366632400545, 42.78050626205695, 13.277448974150943, 30.736794481321194, 34.94985682098786, 208.14186132150311, 31.78956495591447, 31.723643040438315, 370.31439527532496, 216.27346467001692, 21.78840852161415, 18.574387407754823, 82.89380833906097, 205.01192329973938, 54.47906967588923, 39.34470314164283, 80.9801112094398, 122.29476702698014, 4.720578796282968, 274.8595590346836, 44.624191392794835, 46.2136440929569, 28.893387482930155, 24.451307194517966, 27.627792911018993, 7.977431248371387, 8.915285900547126, 221.6150611961805, 16.886017716792434, 14.718284035017543, 83.07855654427644, 15.648738394157952, 141.84440952073896, 36.564374075019565, 10.399322983690041, 203.94832161654404, 171.14553312414512, 36.194776937348855, 34.481759253205524, 23.696698080821886, 173.89704276691674, 29.791292262512584, 15.091990788120242, 16.702718327426606, 192.54998379936893, 198.01518338450143, 43.662506521941, 24.68635864284772, 153.1211303060834, 229.47989778702484, 28.05060027819335, 15.478477208890933, 196.53264208895234, 323.1432620119374, 20.95724336436484, 15.663311738384662, 135.24687782507726, 161.47600444641273, 35.18910481548047, 38.4155771309284, 154.94536662138722, 228.16091418126717, 256.2650000834539, 193.27630188315956, 24.47881857459663, 27.461231298707833, 11.162626228494956, 17.75298869455397, 225.70954688598744, 264.11388163614805, 345.68592192191454, 220.28037649272162, 230.05166501742798, 184.0809164782716, 61.96471314980574, 340.7039377439524, 43.78783808281881, 335.62241282304166, 350.6950539634538, 20.893706630701097, 5.859005749222351, 15.304530389591246, 42.54065156293286, 190.1850079009538, 150.7563895530967, 144.06810467472883, 18.706438699786577, 42.21308009124257, 172.5228116638181, 100.79616573303235, 168.11764428666032, 233.7111151654922, 257.93976711303975, 106.17730775842767, 18.126713597289292, 43.60835642299992, 108.59537564667937, 39.735938775799276, 9.903399844694736, 278.56350617629244, 173.82703834488763, 215.03334248624878, 27.295654873751698, 407.78282649702186, 205.35883760033497, 27.87735186996981, 26.64588952018252, 23.886616484727888, 188.03008642811298, 196.99874849144177, 37.08105525544416, 243.25233945980102, 161.50847240529149, 157.42524349500928, 279.6612616681102, 301.71874626815344, 200.1504875844507, 61.72617498171729, 40.60830094329182, 286.3367221456342, 218.91183409366104, 175.76807983524827, 46.11343198413313, 206.50171346376047, 184.57262601514677, 13.53900748487556, 152.02964486037135, 218.9382402003922, 168.36515441836403, 175.0218464124275, 620.3101723336724, 408.24833615091086, 240.1375465614521, 11.637227782852031, 219.61170012577315, 41.49497177032327, 10.836086795180172, 336.521998415447, 320.7872821674891, 296.191979471812, 141.52723576871398, 87.26424912844797, 20.69655371583427, 342.4453653931986, 58.250418621088485, 186.36921179288254, 120.04271221442461, 296.51967562556047, 292.0589644187443, 283.81167170649275, 163.81396378484104, 206.55083784118608, 213.82699587152425, 28.379068916851846, 16.624176935402886, 16.356054971625824, 246.97047290287122, 244.34680192902988, 176.1774245481403, 275.3457862347942, 302.2783633460634, 259.05668113505635, 109.41461864162625, 207.06754789223538, 218.7594660092784, 244.77992774027226, 463.46014328420324, 511.4375281238538, 76.93965825910576, 93.44999059574175, 199.2730813825451, 227.83740289829458, 231.93795997894466, 223.9624025971186, 375.9510854898566, 347.34907040737835, 204.48270643718973, 171.74986145720192, 34.53952535759776, 18.513787560492815, 253.40954574249236, 297.7270889286344, 25.157485066755516, 260.9672827712074, 191.30160153471485, 257.375301635224, 37.4775231297995, 101.5265251466891, 410.4931207839509, 273.8217860946563, 296.09914704766516, 224.96394459451002, 311.02472799474566, 301.815131372842, 250.55893103315617, 177.2932816307921, 505.94151632851344, 280.3470926503319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6298842800788936, "mean_inference_ms": 1.984326999316774, "mean_action_processing_ms": 0.2613082620397416, "mean_env_wait_ms": 0.24118852597698223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006841182708740234, "StateBufferConnector_ms": 0.0040514469146728516, "ViewRequirementAgentConnector_ms": 0.11049795150756836}, "num_episodes": 18, "episode_return_max": 573.7699432335947, "episode_return_min": 101.95244161179396, "episode_return_mean": 360.07847330594467, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.59905490522345, "num_env_steps_trained_throughput_per_sec": 393.59905490522345, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 10282.787, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10282.746, "sample_time_ms": 1341.12, "learn_time_ms": 8922.813, "learn_throughput": 448.289, "synch_weights_time_ms": 16.856}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-03", "timestamp": 1723779243, "time_this_iter_s": 10.168614149093628, "time_total_s": 1051.545069694519, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20deca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1051.545069694519, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.300000000000004, "ram_util_percent": 83.35333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.719051130833449, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.086582180305763, "policy_loss": -0.0020700909049501497, "vf_loss": 9.088625375051347, "vf_explained_var": 0.08423182730952268, "kl": 0.005096081878463572, "entropy": 0.3272374736490073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.56356499434779, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.439212774851965, "policy_loss": -0.003565459669981566, "vf_loss": 9.44249178618981, "vf_explained_var": 0.05406016035685463, "kl": 0.007638688707683636, "entropy": 1.1165018345943833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 573.7699432335947, "episode_reward_min": 101.95244161179396, "episode_reward_mean": 368.00177580921985, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -581.6707350133277, "predator_policy": 5.859005749222351}, "policy_reward_max": {"prey_policy": 186.66508167929746, "predator_policy": 622.1182534996873}, "policy_reward_mean": {"prey_policy": 0.7186430030605198, "predator_policy": 183.28224490154946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [321.86076887028884, 399.8556205084934, 410.5085087446748, 373.34791427495867, 374.61966240837467, 395.9777909061249, 401.20774297307025, 392.1010156419282, 320.3660165293343, 428.2059071633005, 377.36751364940505, 371.6441054460225, 424.1479560880554, 402.82379380259584, 368.7095258941449, 286.03433177720376, 297.6229993953694, 279.3271529455105, 336.2874064363008, 320.49993365513797, 401.6788203458062, 392.37553062265306, 367.7879978590796, 396.51221061387093, 347.3062633265183, 374.2481041920225, 335.5234658785626, 248.49361002027743, 400.4663986825909, 211.8519015435368, 300.73482106246087, 358.9031838028928, 435.04470994645493, 315.4916668740515, 381.6705851035003, 453.13799561778393, 309.4355154620955, 309.39508970999185, 411.99330126680826, 324.79002447910915, 259.14266166837353, 380.61588119869094, 446.05342570883397, 573.7699432335947, 261.8987268994479, 282.43475947201415, 273.007872564036, 534.9844084639511, 272.4248758261344, 239.21309505535552, 318.8811432102172, 349.1558309020099, 416.40452372373113, 396.9681688009283, 285.80772365155354, 381.5750425578677, 456.8559777081854, 380.6516959682597, 387.96049626561836, 299.5575343416453, 342.40361575409344, 506.655754050045, 101.95244161179396, 453.23376745181474, 436.9325634908533, 486.3293319263926, 378.47767715797676, 383.96331733208785, 425.539472245461, 285.2607080706704, 380.9430310932874, 349.6513261703252, 334.7575466652832, 422.0414878344032, 450.9958332157026, 396.8721208164887, 410.5582872451037, 382.53069335267276, 435.2191382085958, 259.56517035786305, 338.4499101154375, 388.5318864376748, 462.76322359823536, 362.3492264855493, 468.70411225655664, 501.22232740680454, 413.63851022771604, 370.86818715013123, 335.2179069824369, 390.1455464678707, 250.3214245769776, 300.1254308857694, 478.7253330945147, 351.5768918034672, 400.0147985697773, 315.05341344333715, 378.2339271607859, 388.24577480364894, 327.99720951375747, 397.3886051498181], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-68.83245633978183, 0.12805802620086887, 167.76283882129025, 163.74391652241502, -9.48286098246199, 37.390341634029326, 176.77474803664308, 153.0440887512307, -81.73032563166565, -63.32591606084958, 182.45717032333675, 176.90006548003828, 74.28897429611864, 30.195886405460733, 176.7868877090768, 141.70944598644238, -26.244391171920505, -36.495873101399, -28.898087691442925, 7.56269288812984, 155.319385484487, 170.10807829161362, 171.08073639129967, 171.64775413167385, 1.3730166744674808, -67.04848910854712, -131.93153282844565, -31.210971783594722, -66.58837061945007, 21.1653150178943, -129.9085702696031, 13.2742511530485, -105.45913212043304, 23.671880609941773, -64.81341819638436, -27.44818945225912, 186.66508167929746, 128.4587886181896, 36.16506376927252, 51.60921042197918, 56.42539205647011, 50.42893406151078, 157.10133875139834, 174.35467308022575, 36.282688580940125, 58.18633188128823, -1.2446798038325542, -4.0718690344494295, -11.888067987634974, -4.922743557313975, 153.23320568464638, 159.27982848708675, 105.59775100864555, 81.59440044743822, -12.355353795759036, -27.61794220495006, 4.489172916373986, 7.11684493508105, -221.62216441373758, -1.6044154134971318, 53.878844662205296, 13.619786929950962, 144.89646517204673, 163.47421262593568, 22.672730916886394, 27.343144110013416, 1.0526553049067238, 34.105616853899335, 36.422378079769906, 26.314491123429956, -92.81776672419579, -35.42424559428399, 25.673095105525388, 21.88575779040211, 25.725578917205087, -43.27551229613961, 36.36296037050405, -19.049573032605757, 72.3793634733661, -0.2044844421513098, 17.09497699775996, 43.936051170591114, -8.475744469683336, 18.12374060761104, 67.93005174438309, 34.736373133659114, 28.152291022077932, -482.94085627306634, 11.93825730328619, -1.814304748142178, 11.234756320468232, 10.093331255449911, -88.0283983167422, 13.678185670151953, 5.484734783375879, -87.47958795872644, 41.633390928972624, 2.0000000000000013, -75.34278841936735, -48.58603563430941, 27.802158059680963, 46.45935473656534, -48.18124015150666, -19.225316786469037, -122.77439598780164, -36.691716413704036, 43.90590079706609, -17.302533622165157, 1.5983506473061622, 42.00330821587116, 172.59806592620842, 175.99674472463082, 22.99111741272021, -57.45241453643708, -50.69243645857637, -20.17907835609867, -121.23474256485724, -52.139805650642934, 0.15915545895490485, -17.083787651170493, -72.40890757098299, -48.726870424475074, -188.36451751069248, -279.8773998473191, -10.271185666708634, -58.16602157634475, 46.20851380946242, -20.085230638487587, -11.888670685733372, -7.0791283994767555, -35.22727217557608, -201.74355179526682, -53.95953840991144, 56.20464767349665, 166.56765069879154, 164.34235371520555, -125.4715526875631, -0.1256097381029182, -35.14105224277855, 34.27699247548578, -34.057865281990104, -33.67600679466089, 103.04569666321643, 107.60158123062017, -17.341673671420345, -332.21568654190264, 7.221372162493221, -106.2429759702646, -70.46334511359494, -91.38068103829026, -58.6855324781728, 27.705440630713174, -102.98491735855633, -272.74540437518664, -124.1937160611242, -44.64543649370915, -79.8857881346554, -74.04867004825459, -40.91336953222655, -303.3597009786507, -43.03347107194862, 9.70432324756122, 135.5113295758311, 160.1179492763509, -24.108724798299136, 103.91491331239, -88.7375685522791, -252.62927395117754, 22.207678358233856, -42.57511176102797, 38.978081266522, -581.6707350133277, 73.73983196391073, 108.59786259976634, -31.952848021073752, 2.434803018649581, 83.98107901328045, 17.60664762199939, -208.16126519828939, -69.4745897700659, -45.26275933875207, -69.5146940727689, 59.78992013454584, 28.134022989355145, 86.27054004654262, -51.311754453861, 66.08256649589342, 32.99756211892689, 181.00287709692958, 184.07956383046547, -33.4397373293911, 42.60962648590292, -59.33638777297431, 68.56970235148967, 30.80284344975285, 35.85767173576466, -0.8864466813263117, -41.02094064531875, 1.9470842515551698, -3.4795707243045793], "policy_predator_policy_reward": [192.54998379936893, 198.01518338450143, 43.662506521941, 24.68635864284772, 153.1211303060834, 229.47989778702484, 28.05060027819335, 15.478477208890933, 196.53264208895234, 323.1432620119374, 20.95724336436484, 15.663311738384662, 135.24687782507726, 161.47600444641273, 35.18910481548047, 38.4155771309284, 154.94536662138722, 228.16091418126717, 256.2650000834539, 193.27630188315956, 24.47881857459663, 27.461231298707833, 11.162626228494956, 17.75298869455397, 225.70954688598744, 264.11388163614805, 345.68592192191454, 220.28037649272162, 230.05166501742798, 184.0809164782716, 61.96471314980574, 340.7039377439524, 43.78783808281881, 335.62241282304166, 350.6950539634538, 20.893706630701097, 5.859005749222351, 15.304530389591246, 42.54065156293286, 190.1850079009538, 150.7563895530967, 144.06810467472883, 18.706438699786577, 42.21308009124257, 172.5228116638181, 100.79616573303235, 168.11764428666032, 233.7111151654922, 257.93976711303975, 106.17730775842767, 18.126713597289292, 43.60835642299992, 108.59537564667937, 39.735938775799276, 9.903399844694736, 278.56350617629244, 173.82703834488763, 215.03334248624878, 27.295654873751698, 407.78282649702186, 205.35883760033497, 27.87735186996981, 26.64588952018252, 23.886616484727888, 188.03008642811298, 196.99874849144177, 37.08105525544416, 243.25233945980102, 161.50847240529149, 157.42524349500928, 279.6612616681102, 301.71874626815344, 200.1504875844507, 61.72617498171729, 40.60830094329182, 286.3367221456342, 218.91183409366104, 175.76807983524827, 46.11343198413313, 206.50171346376047, 184.57262601514677, 13.53900748487556, 152.02964486037135, 218.9382402003922, 168.36515441836403, 175.0218464124275, 620.3101723336724, 408.24833615091086, 240.1375465614521, 11.637227782852031, 219.61170012577315, 41.49497177032327, 10.836086795180172, 336.521998415447, 320.7872821674891, 296.191979471812, 141.52723576871398, 87.26424912844797, 20.69655371583427, 342.4453653931986, 58.250418621088485, 186.36921179288254, 120.04271221442461, 296.51967562556047, 292.0589644187443, 283.81167170649275, 163.81396378484104, 206.55083784118608, 213.82699587152425, 28.379068916851846, 16.624176935402886, 16.356054971625824, 246.97047290287122, 244.34680192902988, 176.1774245481403, 275.3457862347942, 302.2783633460634, 259.05668113505635, 109.41461864162625, 207.06754789223538, 218.7594660092784, 244.77992774027226, 463.46014328420324, 511.4375281238538, 76.93965825910576, 93.44999059574175, 199.2730813825451, 227.83740289829458, 231.93795997894466, 223.9624025971186, 375.9510854898566, 347.34907040737835, 204.48270643718973, 171.74986145720192, 34.53952535759776, 18.513787560492815, 253.40954574249236, 297.7270889286344, 25.157485066755516, 260.9672827712074, 191.30160153471485, 257.375301635224, 37.4775231297995, 101.5265251466891, 410.4931207839509, 273.8217860946563, 296.09914704766516, 224.96394459451002, 311.02472799474566, 301.815131372842, 250.55893103315617, 177.2932816307921, 505.94151632851344, 280.3470926503319, 315.07241662906347, 236.29742927844273, 300.5329454357968, 288.62065095570927, 556.9052009953105, 46.93303987342931, 114.38865574723576, 257.3904021925896, 43.80791222105117, 49.09469536444145, 183.65821569075663, 199.29881939338816, 295.5522501483397, 408.16381884066556, 230.49497604634337, 258.5765696130071, 421.7967276539229, 622.1182534996873, 117.34965124792689, 113.95116441611212, 142.02107704158055, 258.3651551109748, 189.50147043621695, 44.128709910939676, 249.46339041700182, 418.318011019224, 23.524240283595667, 341.57463770490386, 20.316464946018016, 191.88502281585048, 200.1512435698406, 243.61530393199277, 182.19666511354828, 70.3000980750997, 23.07220793007184, 11.86014971231051, 140.6810972863464, 165.2024270004795, 88.21695280736682, 280.7836597749033, 120.72176931237951, 200.86349030575155, 269.80012493550186, 100.10447190490044, 188.41167076782952, 210.50942085473767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6289600088695269, "mean_inference_ms": 1.9825944520480854, "mean_action_processing_ms": 0.2609501147768306, "mean_env_wait_ms": 0.24097189625731785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006379246711730957, "StateBufferConnector_ms": 0.004141807556152344, "ViewRequirementAgentConnector_ms": 0.11109542846679688}, "num_episodes": 23, "episode_return_max": 573.7699432335947, "episode_return_min": 101.95244161179396, "episode_return_mean": 368.00177580921985, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 391.39947528369913, "num_env_steps_trained_throughput_per_sec": 391.39947528369913, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 10280.235, "restore_workers_time_ms": 0.016, "training_step_time_ms": 10280.193, "sample_time_ms": 1349.501, "learn_time_ms": 8912.039, "learn_throughput": 448.831, "synch_weights_time_ms": 16.76}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-13", "timestamp": 1723779253, "time_this_iter_s": 10.225379943847656, "time_total_s": 1061.7704496383667, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b23144c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1061.7704496383667, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 30.550000000000004, "ram_util_percent": 83.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.619511316141123, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.440605420410318, "policy_loss": 0.00017174350593002544, "vf_loss": 9.440375654028838, "vf_explained_var": -0.052109490878998285, "kl": 0.011002115485411457, "entropy": 0.3258634548496317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.360019326146949, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.887390567638256, "policy_loss": -0.007069889589079789, "vf_loss": 8.893943064301101, "vf_explained_var": 0.15130397075067753, "kl": 0.013797645027103584, "entropy": 1.115349278941987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 608.6610688763811, "episode_reward_min": 101.95244161179396, "episode_reward_mean": 382.2776416496908, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -581.6707350133277, "predator_policy": 5.859005749222351}, "policy_reward_max": {"prey_policy": 186.66508167929746, "predator_policy": 622.1182534996873}, "policy_reward_mean": {"prey_policy": -1.470496275966476, "predator_policy": 192.6093171008119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.2874064363008, 320.49993365513797, 401.6788203458062, 392.37553062265306, 367.7879978590796, 396.51221061387093, 347.3062633265183, 374.2481041920225, 335.5234658785626, 248.49361002027743, 400.4663986825909, 211.8519015435368, 300.73482106246087, 358.9031838028928, 435.04470994645493, 315.4916668740515, 381.6705851035003, 453.13799561778393, 309.4355154620955, 309.39508970999185, 411.99330126680826, 324.79002447910915, 259.14266166837353, 380.61588119869094, 446.05342570883397, 573.7699432335947, 261.8987268994479, 282.43475947201415, 273.007872564036, 534.9844084639511, 272.4248758261344, 239.21309505535552, 318.8811432102172, 349.1558309020099, 416.40452372373113, 396.9681688009283, 285.80772365155354, 381.5750425578677, 456.8559777081854, 380.6516959682597, 387.96049626561836, 299.5575343416453, 342.40361575409344, 506.655754050045, 101.95244161179396, 453.23376745181474, 436.9325634908533, 486.3293319263926, 378.47767715797676, 383.96331733208785, 425.539472245461, 285.2607080706704, 380.9430310932874, 349.6513261703252, 334.7575466652832, 422.0414878344032, 450.9958332157026, 396.8721208164887, 410.5582872451037, 382.53069335267276, 435.2191382085958, 259.56517035786305, 338.4499101154375, 388.5318864376748, 462.76322359823536, 362.3492264855493, 468.70411225655664, 501.22232740680454, 413.63851022771604, 370.86818715013123, 335.2179069824369, 390.1455464678707, 250.3214245769776, 300.1254308857694, 478.7253330945147, 351.5768918034672, 400.0147985697773, 315.05341344333715, 378.2339271607859, 388.24577480364894, 327.99720951375747, 397.3886051498181, 485.5259144443172, 483.1248714051358, 399.1355264098756, 420.04399796515224, 435.50470414050073, 425.9033342063706, 315.3350480771216, 397.7091018833887, 525.9764179286014, 222.78095378866502, 502.08596785453744, 497.97043430158277, 608.6610688763811, 416.9550837103472, 458.4995922619972, 485.455451204161, 505.3005868001235, 467.34685580768786], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.66508167929746, 128.4587886181896, 36.16506376927252, 51.60921042197918, 56.42539205647011, 50.42893406151078, 157.10133875139834, 174.35467308022575, 36.282688580940125, 58.18633188128823, -1.2446798038325542, -4.0718690344494295, -11.888067987634974, -4.922743557313975, 153.23320568464638, 159.27982848708675, 105.59775100864555, 81.59440044743822, -12.355353795759036, -27.61794220495006, 4.489172916373986, 7.11684493508105, -221.62216441373758, -1.6044154134971318, 53.878844662205296, 13.619786929950962, 144.89646517204673, 163.47421262593568, 22.672730916886394, 27.343144110013416, 1.0526553049067238, 34.105616853899335, 36.422378079769906, 26.314491123429956, -92.81776672419579, -35.42424559428399, 25.673095105525388, 21.88575779040211, 25.725578917205087, -43.27551229613961, 36.36296037050405, -19.049573032605757, 72.3793634733661, -0.2044844421513098, 17.09497699775996, 43.936051170591114, -8.475744469683336, 18.12374060761104, 67.93005174438309, 34.736373133659114, 28.152291022077932, -482.94085627306634, 11.93825730328619, -1.814304748142178, 11.234756320468232, 10.093331255449911, -88.0283983167422, 13.678185670151953, 5.484734783375879, -87.47958795872644, 41.633390928972624, 2.0000000000000013, -75.34278841936735, -48.58603563430941, 27.802158059680963, 46.45935473656534, -48.18124015150666, -19.225316786469037, -122.77439598780164, -36.691716413704036, 43.90590079706609, -17.302533622165157, 1.5983506473061622, 42.00330821587116, 172.59806592620842, 175.99674472463082, 22.99111741272021, -57.45241453643708, -50.69243645857637, -20.17907835609867, -121.23474256485724, -52.139805650642934, 0.15915545895490485, -17.083787651170493, -72.40890757098299, -48.726870424475074, -188.36451751069248, -279.8773998473191, -10.271185666708634, -58.16602157634475, 46.20851380946242, -20.085230638487587, -11.888670685733372, -7.0791283994767555, -35.22727217557608, -201.74355179526682, -53.95953840991144, 56.20464767349665, 166.56765069879154, 164.34235371520555, -125.4715526875631, -0.1256097381029182, -35.14105224277855, 34.27699247548578, -34.057865281990104, -33.67600679466089, 103.04569666321643, 107.60158123062017, -17.341673671420345, -332.21568654190264, 7.221372162493221, -106.2429759702646, -70.46334511359494, -91.38068103829026, -58.6855324781728, 27.705440630713174, -102.98491735855633, -272.74540437518664, -124.1937160611242, -44.64543649370915, -79.8857881346554, -74.04867004825459, -40.91336953222655, -303.3597009786507, -43.03347107194862, 9.70432324756122, 135.5113295758311, 160.1179492763509, -24.108724798299136, 103.91491331239, -88.7375685522791, -252.62927395117754, 22.207678358233856, -42.57511176102797, 38.978081266522, -581.6707350133277, 73.73983196391073, 108.59786259976634, -31.952848021073752, 2.434803018649581, 83.98107901328045, 17.60664762199939, -208.16126519828939, -69.4745897700659, -45.26275933875207, -69.5146940727689, 59.78992013454584, 28.134022989355145, 86.27054004654262, -51.311754453861, 66.08256649589342, 32.99756211892689, 181.00287709692958, 184.07956383046547, -33.4397373293911, 42.60962648590292, -59.33638777297431, 68.56970235148967, 30.80284344975285, 35.85767173576466, -0.8864466813263117, -41.02094064531875, 1.9470842515551698, -3.4795707243045793, 25.765946196110953, 70.29434049413906, 151.31000820144774, -46.36662747426915, -34.42241297110738, -49.87571448547833, 98.95223908213974, 136.79934399176486, 103.28244943769958, 42.79539208512969, -74.96822590245687, -97.83992007566637, 61.80951215001086, 9.908269216011606, 64.1829285141174, 110.55186613832791, -30.62324118125479, -2.987102632041818, -108.59414754780762, -2.603795377460252, -1.9095598795595692, 75.51015523053672, 168.18661351785684, -86.79546298226118, -164.3626114815217, 163.3547540320508, -42.79022986454568, -28.048619526977213, 72.0307668735628, -57.48407043805087, 99.9404653295189, -23.230626628527073, 18.249661092624464, 115.52596017336175, 11.22658938294307, 92.36419878083262], "policy_predator_policy_reward": [5.859005749222351, 15.304530389591246, 42.54065156293286, 190.1850079009538, 150.7563895530967, 144.06810467472883, 18.706438699786577, 42.21308009124257, 172.5228116638181, 100.79616573303235, 168.11764428666032, 233.7111151654922, 257.93976711303975, 106.17730775842767, 18.126713597289292, 43.60835642299992, 108.59537564667937, 39.735938775799276, 9.903399844694736, 278.56350617629244, 173.82703834488763, 215.03334248624878, 27.295654873751698, 407.78282649702186, 205.35883760033497, 27.87735186996981, 26.64588952018252, 23.886616484727888, 188.03008642811298, 196.99874849144177, 37.08105525544416, 243.25233945980102, 161.50847240529149, 157.42524349500928, 279.6612616681102, 301.71874626815344, 200.1504875844507, 61.72617498171729, 40.60830094329182, 286.3367221456342, 218.91183409366104, 175.76807983524827, 46.11343198413313, 206.50171346376047, 184.57262601514677, 13.53900748487556, 152.02964486037135, 218.9382402003922, 168.36515441836403, 175.0218464124275, 620.3101723336724, 408.24833615091086, 240.1375465614521, 11.637227782852031, 219.61170012577315, 41.49497177032327, 10.836086795180172, 336.521998415447, 320.7872821674891, 296.191979471812, 141.52723576871398, 87.26424912844797, 20.69655371583427, 342.4453653931986, 58.250418621088485, 186.36921179288254, 120.04271221442461, 296.51967562556047, 292.0589644187443, 283.81167170649275, 163.81396378484104, 206.55083784118608, 213.82699587152425, 28.379068916851846, 16.624176935402886, 16.356054971625824, 246.97047290287122, 244.34680192902988, 176.1774245481403, 275.3457862347942, 302.2783633460634, 259.05668113505635, 109.41461864162625, 207.06754789223538, 218.7594660092784, 244.77992774027226, 463.46014328420324, 511.4375281238538, 76.93965825910576, 93.44999059574175, 199.2730813825451, 227.83740289829458, 231.93795997894466, 223.9624025971186, 375.9510854898566, 347.34907040737835, 204.48270643718973, 171.74986145720192, 34.53952535759776, 18.513787560492815, 253.40954574249236, 297.7270889286344, 25.157485066755516, 260.9672827712074, 191.30160153471485, 257.375301635224, 37.4775231297995, 101.5265251466891, 410.4931207839509, 273.8217860946563, 296.09914704766516, 224.96394459451002, 311.02472799474566, 301.815131372842, 250.55893103315617, 177.2932816307921, 505.94151632851344, 280.3470926503319, 315.07241662906347, 236.29742927844273, 300.5329454357968, 288.62065095570927, 556.9052009953105, 46.93303987342931, 114.38865574723576, 257.3904021925896, 43.80791222105117, 49.09469536444145, 183.65821569075663, 199.29881939338816, 295.5522501483397, 408.16381884066556, 230.49497604634337, 258.5765696130071, 421.7967276539229, 622.1182534996873, 117.34965124792689, 113.95116441611212, 142.02107704158055, 258.3651551109748, 189.50147043621695, 44.128709910939676, 249.46339041700182, 418.318011019224, 23.524240283595667, 341.57463770490386, 20.316464946018016, 191.88502281585048, 200.1512435698406, 243.61530393199277, 182.19666511354828, 70.3000980750997, 23.07220793007184, 11.86014971231051, 140.6810972863464, 165.2024270004795, 88.21695280736682, 280.7836597749033, 120.72176931237951, 200.86349030575155, 269.80012493550186, 100.10447190490044, 188.41167076782952, 210.50942085473767, 211.10082944560241, 178.3647983084628, 185.02964412464402, 193.15184655331387, 260.5618635310364, 222.871790335425, 98.29727610158868, 85.99513878965956, 129.3155486687055, 160.11131394896643, 432.77846551426995, 165.9330146702244, 42.32874995685045, 201.2885167542481, 149.699141265477, 73.27516596546666, 250.12721248179434, 309.4595492601042, 126.43414754780757, 207.54474916612503, 198.14306864317254, 230.34230386038794, 216.04181693572545, 200.53746683026262, 300.9459944456333, 308.72293188021894, 233.26045933527513, 254.53347376659562, 250.73698987913735, 193.21590594734684, 202.99965339305746, 205.74595911011227, 191.51426888727158, 180.01069664686682, 162.91512527280653, 200.84094237110548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6283484187754422, "mean_inference_ms": 1.9813233217764177, "mean_action_processing_ms": 0.2607034050198393, "mean_env_wait_ms": 0.24083250139032905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005924582481384277, "StateBufferConnector_ms": 0.004116654396057129, "ViewRequirementAgentConnector_ms": 0.10991847515106201}, "num_episodes": 18, "episode_return_max": 608.6610688763811, "episode_return_min": 101.95244161179396, "episode_return_mean": 382.2776416496908, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 386.9157153813887, "num_env_steps_trained_throughput_per_sec": 386.9157153813887, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 10288.757, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10288.714, "sample_time_ms": 1359.447, "learn_time_ms": 8911.226, "learn_throughput": 448.872, "synch_weights_time_ms": 16.173}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-24", "timestamp": 1723779264, "time_this_iter_s": 10.398959875106812, "time_total_s": 1072.1694095134735, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2314ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1072.1694095134735, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 32.053333333333335, "ram_util_percent": 83.61333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.802417241265534, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.290731084409845, "policy_loss": -0.003344608955922975, "vf_loss": 9.294046795557415, "vf_explained_var": -0.007124951434513879, "kl": 0.005481759283561563, "entropy": 0.31909238508454074, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.374734568532812, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.972595334936071, "policy_loss": -0.0027430957244837253, "vf_loss": 7.974966048437452, "vf_explained_var": 0.09035156394438769, "kl": 0.009929867451086389, "entropy": 1.1470885976912484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 1055.3580370722816, "episode_reward_min": 51.09247119434217, "episode_reward_mean": 410.4443965948347, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1070.7179888628064, "predator_policy": 10.836086795180172}, "policy_reward_max": {"prey_policy": 184.07956383046547, "predator_policy": 1104.0059726172083}, "policy_reward_mean": {"prey_policy": -9.721146109202328, "predator_policy": 214.9433444066196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [259.14266166837353, 380.61588119869094, 446.05342570883397, 573.7699432335947, 261.8987268994479, 282.43475947201415, 273.007872564036, 534.9844084639511, 272.4248758261344, 239.21309505535552, 318.8811432102172, 349.1558309020099, 416.40452372373113, 396.9681688009283, 285.80772365155354, 381.5750425578677, 456.8559777081854, 380.6516959682597, 387.96049626561836, 299.5575343416453, 342.40361575409344, 506.655754050045, 101.95244161179396, 453.23376745181474, 436.9325634908533, 486.3293319263926, 378.47767715797676, 383.96331733208785, 425.539472245461, 285.2607080706704, 380.9430310932874, 349.6513261703252, 334.7575466652832, 422.0414878344032, 450.9958332157026, 396.8721208164887, 410.5582872451037, 382.53069335267276, 435.2191382085958, 259.56517035786305, 338.4499101154375, 388.5318864376748, 462.76322359823536, 362.3492264855493, 468.70411225655664, 501.22232740680454, 413.63851022771604, 370.86818715013123, 335.2179069824369, 390.1455464678707, 250.3214245769776, 300.1254308857694, 478.7253330945147, 351.5768918034672, 400.0147985697773, 315.05341344333715, 378.2339271607859, 388.24577480364894, 327.99720951375747, 397.3886051498181, 485.5259144443172, 483.1248714051358, 399.1355264098756, 420.04399796515224, 435.50470414050073, 425.9033342063706, 315.3350480771216, 397.7091018833887, 525.9764179286014, 222.78095378866502, 502.08596785453744, 497.97043430158277, 608.6610688763811, 416.9550837103472, 458.4995922619972, 485.455451204161, 505.3005868001235, 467.34685580768786, 420.66793861031584, 459.3435529502046, 489.68585016053265, 457.3728256935871, 451.8745801009594, 538.9589459567653, 496.623571340223, 508.8147371045411, 516.2776583001909, 419.64361935255374, 374.9307239045132, 1055.3580370722816, 475.12538085468697, 404.1122461050558, 515.4405699392826, 533.6843093690101, 546.227030185741, 422.9614910699699, 288.3372976965235, 490.4206725298777, 633.3505215247175, 51.09247119434217], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [17.09497699775996, 43.936051170591114, -8.475744469683336, 18.12374060761104, 67.93005174438309, 34.736373133659114, 28.152291022077932, -482.94085627306634, 11.93825730328619, -1.814304748142178, 11.234756320468232, 10.093331255449911, -88.0283983167422, 13.678185670151953, 5.484734783375879, -87.47958795872644, 41.633390928972624, 2.0000000000000013, -75.34278841936735, -48.58603563430941, 27.802158059680963, 46.45935473656534, -48.18124015150666, -19.225316786469037, -122.77439598780164, -36.691716413704036, 43.90590079706609, -17.302533622165157, 1.5983506473061622, 42.00330821587116, 172.59806592620842, 175.99674472463082, 22.99111741272021, -57.45241453643708, -50.69243645857637, -20.17907835609867, -121.23474256485724, -52.139805650642934, 0.15915545895490485, -17.083787651170493, -72.40890757098299, -48.726870424475074, -188.36451751069248, -279.8773998473191, -10.271185666708634, -58.16602157634475, 46.20851380946242, -20.085230638487587, -11.888670685733372, -7.0791283994767555, -35.22727217557608, -201.74355179526682, -53.95953840991144, 56.20464767349665, 166.56765069879154, 164.34235371520555, -125.4715526875631, -0.1256097381029182, -35.14105224277855, 34.27699247548578, -34.057865281990104, -33.67600679466089, 103.04569666321643, 107.60158123062017, -17.341673671420345, -332.21568654190264, 7.221372162493221, -106.2429759702646, -70.46334511359494, -91.38068103829026, -58.6855324781728, 27.705440630713174, -102.98491735855633, -272.74540437518664, -124.1937160611242, -44.64543649370915, -79.8857881346554, -74.04867004825459, -40.91336953222655, -303.3597009786507, -43.03347107194862, 9.70432324756122, 135.5113295758311, 160.1179492763509, -24.108724798299136, 103.91491331239, -88.7375685522791, -252.62927395117754, 22.207678358233856, -42.57511176102797, 38.978081266522, -581.6707350133277, 73.73983196391073, 108.59786259976634, -31.952848021073752, 2.434803018649581, 83.98107901328045, 17.60664762199939, -208.16126519828939, -69.4745897700659, -45.26275933875207, -69.5146940727689, 59.78992013454584, 28.134022989355145, 86.27054004654262, -51.311754453861, 66.08256649589342, 32.99756211892689, 181.00287709692958, 184.07956383046547, -33.4397373293911, 42.60962648590292, -59.33638777297431, 68.56970235148967, 30.80284344975285, 35.85767173576466, -0.8864466813263117, -41.02094064531875, 1.9470842515551698, -3.4795707243045793, 25.765946196110953, 70.29434049413906, 151.31000820144774, -46.36662747426915, -34.42241297110738, -49.87571448547833, 98.95223908213974, 136.79934399176486, 103.28244943769958, 42.79539208512969, -74.96822590245687, -97.83992007566637, 61.80951215001086, 9.908269216011606, 64.1829285141174, 110.55186613832791, -30.62324118125479, -2.987102632041818, -108.59414754780762, -2.603795377460252, -1.9095598795595692, 75.51015523053672, 168.18661351785684, -86.79546298226118, -164.3626114815217, 163.3547540320508, -42.79022986454568, -28.048619526977213, 72.0307668735628, -57.48407043805087, 99.9404653295189, -23.230626628527073, 18.249661092624464, 115.52596017336175, 11.22658938294307, 92.36419878083262, -55.684574897552295, 93.71444622822396, -34.90310202187907, 118.92255256352662, 149.5664498533343, -13.580644387982947, 71.60592872730741, -17.686449923148075, 82.51319848176274, -50.38553848441067, 53.750916813906215, -39.11586523627148, -9.815270383021995, 149.82320429375974, 141.56287331045792, -140.48029684322017, 156.57579120742633, -37.641614826907585, -204.55859883672875, 103.88104387407368, -55.054057931093695, 3.21017153974081, -1070.7179888628064, 126.77175747231624, 129.48012284837995, -34.23437354827217, -27.141480579604636, 152.4655357465629, 169.28823006501062, -6.580188053886233, -60.79926668588078, 160.5467707167664, 142.2644613718582, -83.01490131918142, 111.37071318571748, 94.75108561255661, 56.50651573094447, -8.556240359623205, -50.2676829969703, 154.8694465502715, -245.11197431115087, 92.2214315391559, -129.38106198894945, -114.38447238634808], "policy_predator_policy_reward": [184.57262601514677, 13.53900748487556, 152.02964486037135, 218.9382402003922, 168.36515441836403, 175.0218464124275, 620.3101723336724, 408.24833615091086, 240.1375465614521, 11.637227782852031, 219.61170012577315, 41.49497177032327, 10.836086795180172, 336.521998415447, 320.7872821674891, 296.191979471812, 141.52723576871398, 87.26424912844797, 20.69655371583427, 342.4453653931986, 58.250418621088485, 186.36921179288254, 120.04271221442461, 296.51967562556047, 292.0589644187443, 283.81167170649275, 163.81396378484104, 206.55083784118608, 213.82699587152425, 28.379068916851846, 16.624176935402886, 16.356054971625824, 246.97047290287122, 244.34680192902988, 176.1774245481403, 275.3457862347942, 302.2783633460634, 259.05668113505635, 109.41461864162625, 207.06754789223538, 218.7594660092784, 244.77992774027226, 463.46014328420324, 511.4375281238538, 76.93965825910576, 93.44999059574175, 199.2730813825451, 227.83740289829458, 231.93795997894466, 223.9624025971186, 375.9510854898566, 347.34907040737835, 204.48270643718973, 171.74986145720192, 34.53952535759776, 18.513787560492815, 253.40954574249236, 297.7270889286344, 25.157485066755516, 260.9672827712074, 191.30160153471485, 257.375301635224, 37.4775231297995, 101.5265251466891, 410.4931207839509, 273.8217860946563, 296.09914704766516, 224.96394459451002, 311.02472799474566, 301.815131372842, 250.55893103315617, 177.2932816307921, 505.94151632851344, 280.3470926503319, 315.07241662906347, 236.29742927844273, 300.5329454357968, 288.62065095570927, 556.9052009953105, 46.93303987342931, 114.38865574723576, 257.3904021925896, 43.80791222105117, 49.09469536444145, 183.65821569075663, 199.29881939338816, 295.5522501483397, 408.16381884066556, 230.49497604634337, 258.5765696130071, 421.7967276539229, 622.1182534996873, 117.34965124792689, 113.95116441611212, 142.02107704158055, 258.3651551109748, 189.50147043621695, 44.128709910939676, 249.46339041700182, 418.318011019224, 23.524240283595667, 341.57463770490386, 20.316464946018016, 191.88502281585048, 200.1512435698406, 243.61530393199277, 182.19666511354828, 70.3000980750997, 23.07220793007184, 11.86014971231051, 140.6810972863464, 165.2024270004795, 88.21695280736682, 280.7836597749033, 120.72176931237951, 200.86349030575155, 269.80012493550186, 100.10447190490044, 188.41167076782952, 210.50942085473767, 211.10082944560241, 178.3647983084628, 185.02964412464402, 193.15184655331387, 260.5618635310364, 222.871790335425, 98.29727610158868, 85.99513878965956, 129.3155486687055, 160.11131394896643, 432.77846551426995, 165.9330146702244, 42.32874995685045, 201.2885167542481, 149.699141265477, 73.27516596546666, 250.12721248179434, 309.4595492601042, 126.43414754780757, 207.54474916612503, 198.14306864317254, 230.34230386038794, 216.04181693572545, 200.53746683026262, 300.9459944456333, 308.72293188021894, 233.26045933527513, 254.53347376659562, 250.73698987913735, 193.21590594734684, 202.99965339305746, 205.74595911011227, 191.51426888727158, 180.01069664686682, 162.91512527280653, 200.84094237110548, 221.18600819891847, 161.45205908072555, 191.86923470138234, 183.45486770717366, 188.923043307688, 164.77700138749387, 203.76806010914592, 199.6852867802817, 226.94868490179041, 192.7982352018172, 233.67562708468608, 290.6482672944442, 180.93079137158765, 175.68484605789777, 270.62642449395395, 237.10573614335004, 204.68023579654843, 192.66324612312374, 244.89383988646526, 275.42733442874345, 196.70537094083537, 230.06923935502945, 1104.0059726172083, 895.2982958455624, 191.06642128401916, 188.81321027056055, 138.95106995995621, 139.8371209781412, 178.27161061878635, 174.46091730937206, 205.63356344339536, 228.3032418947286, 253.79799654330034, 233.17947358976446, 76.9194595417767, 139.92023272991952, 153.52048577998553, 86.86653654521758, 195.7957358578109, 190.02317311876388, 393.5427370616207, 392.69832723509126, 212.03933927658744, 82.81866629305294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6274450471495484, "mean_inference_ms": 1.9813144609612514, "mean_action_processing_ms": 0.26016670208489934, "mean_env_wait_ms": 0.24074565633648903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053021907806396484, "StateBufferConnector_ms": 0.00396728515625, "ViewRequirementAgentConnector_ms": 0.10517740249633789}, "num_episodes": 22, "episode_return_max": 1055.3580370722816, "episode_return_min": 51.09247119434217, "episode_return_mean": 410.4443965948347, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 384.05599156145286, "num_env_steps_trained_throughput_per_sec": 384.05599156145286, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 10326.742, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10326.699, "sample_time_ms": 1363.354, "learn_time_ms": 8944.892, "learn_throughput": 447.183, "synch_weights_time_ms": 16.364}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-34", "timestamp": 1723779274, "time_this_iter_s": 10.447235107421875, "time_total_s": 1082.6166446208954, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20de310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1082.6166446208954, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 32.72, "ram_util_percent": 83.54666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.368995472095, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.464383152048423, "policy_loss": -0.0033340677302380007, "vf_loss": 9.46770258202124, "vf_explained_var": -0.0680986950321803, "kl": 0.0027708888023975924, "entropy": 0.2953516909054347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.725992171789603, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.911571126261716, "policy_loss": -0.006699506016497416, "vf_loss": 7.917766678017914, "vf_explained_var": 0.1642286443521106, "kl": 0.013438702329198794, "entropy": 1.2338133224103816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 1055.3580370722816, "episode_reward_min": 51.09247119434217, "episode_reward_mean": 428.7153563332758, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1070.7179888628064, "predator_policy": 11.86014971231051}, "policy_reward_max": {"prey_policy": 186.6622552511133, "predator_policy": 1104.0059726172083}, "policy_reward_mean": {"prey_policy": 1.7950469832613067, "predator_policy": 212.56263118337657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [387.96049626561836, 299.5575343416453, 342.40361575409344, 506.655754050045, 101.95244161179396, 453.23376745181474, 436.9325634908533, 486.3293319263926, 378.47767715797676, 383.96331733208785, 425.539472245461, 285.2607080706704, 380.9430310932874, 349.6513261703252, 334.7575466652832, 422.0414878344032, 450.9958332157026, 396.8721208164887, 410.5582872451037, 382.53069335267276, 435.2191382085958, 259.56517035786305, 338.4499101154375, 388.5318864376748, 462.76322359823536, 362.3492264855493, 468.70411225655664, 501.22232740680454, 413.63851022771604, 370.86818715013123, 335.2179069824369, 390.1455464678707, 250.3214245769776, 300.1254308857694, 478.7253330945147, 351.5768918034672, 400.0147985697773, 315.05341344333715, 378.2339271607859, 388.24577480364894, 327.99720951375747, 397.3886051498181, 485.5259144443172, 483.1248714051358, 399.1355264098756, 420.04399796515224, 435.50470414050073, 425.9033342063706, 315.3350480771216, 397.7091018833887, 525.9764179286014, 222.78095378866502, 502.08596785453744, 497.97043430158277, 608.6610688763811, 416.9550837103472, 458.4995922619972, 485.455451204161, 505.3005868001235, 467.34685580768786, 420.66793861031584, 459.3435529502046, 489.68585016053265, 457.3728256935871, 451.8745801009594, 538.9589459567653, 496.623571340223, 508.8147371045411, 516.2776583001909, 419.64361935255374, 374.9307239045132, 1055.3580370722816, 475.12538085468697, 404.1122461050558, 515.4405699392826, 533.6843093690101, 546.227030185741, 422.9614910699699, 288.3372976965235, 490.4206725298777, 633.3505215247175, 51.09247119434217, 493.10209134120606, 487.6056782098503, 509.77170917511893, 460.6923938211045, 472.64277665364864, 489.6119958177062, 574.5687283780255, 380.05780498643645, 529.7702061453722, 430.926787949284, 545.6455251958567, 496.6699378365215, 329.3963602607947, 490.06045331253796, 242.2889711408968, 500.3124206569749, 435.92941878036, 467.88847079561333], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-121.23474256485724, -52.139805650642934, 0.15915545895490485, -17.083787651170493, -72.40890757098299, -48.726870424475074, -188.36451751069248, -279.8773998473191, -10.271185666708634, -58.16602157634475, 46.20851380946242, -20.085230638487587, -11.888670685733372, -7.0791283994767555, -35.22727217557608, -201.74355179526682, -53.95953840991144, 56.20464767349665, 166.56765069879154, 164.34235371520555, -125.4715526875631, -0.1256097381029182, -35.14105224277855, 34.27699247548578, -34.057865281990104, -33.67600679466089, 103.04569666321643, 107.60158123062017, -17.341673671420345, -332.21568654190264, 7.221372162493221, -106.2429759702646, -70.46334511359494, -91.38068103829026, -58.6855324781728, 27.705440630713174, -102.98491735855633, -272.74540437518664, -124.1937160611242, -44.64543649370915, -79.8857881346554, -74.04867004825459, -40.91336953222655, -303.3597009786507, -43.03347107194862, 9.70432324756122, 135.5113295758311, 160.1179492763509, -24.108724798299136, 103.91491331239, -88.7375685522791, -252.62927395117754, 22.207678358233856, -42.57511176102797, 38.978081266522, -581.6707350133277, 73.73983196391073, 108.59786259976634, -31.952848021073752, 2.434803018649581, 83.98107901328045, 17.60664762199939, -208.16126519828939, -69.4745897700659, -45.26275933875207, -69.5146940727689, 59.78992013454584, 28.134022989355145, 86.27054004654262, -51.311754453861, 66.08256649589342, 32.99756211892689, 181.00287709692958, 184.07956383046547, -33.4397373293911, 42.60962648590292, -59.33638777297431, 68.56970235148967, 30.80284344975285, 35.85767173576466, -0.8864466813263117, -41.02094064531875, 1.9470842515551698, -3.4795707243045793, 25.765946196110953, 70.29434049413906, 151.31000820144774, -46.36662747426915, -34.42241297110738, -49.87571448547833, 98.95223908213974, 136.79934399176486, 103.28244943769958, 42.79539208512969, -74.96822590245687, -97.83992007566637, 61.80951215001086, 9.908269216011606, 64.1829285141174, 110.55186613832791, -30.62324118125479, -2.987102632041818, -108.59414754780762, -2.603795377460252, -1.9095598795595692, 75.51015523053672, 168.18661351785684, -86.79546298226118, -164.3626114815217, 163.3547540320508, -42.79022986454568, -28.048619526977213, 72.0307668735628, -57.48407043805087, 99.9404653295189, -23.230626628527073, 18.249661092624464, 115.52596017336175, 11.22658938294307, 92.36419878083262, -55.684574897552295, 93.71444622822396, -34.90310202187907, 118.92255256352662, 149.5664498533343, -13.580644387982947, 71.60592872730741, -17.686449923148075, 82.51319848176274, -50.38553848441067, 53.750916813906215, -39.11586523627148, -9.815270383021995, 149.82320429375974, 141.56287331045792, -140.48029684322017, 156.57579120742633, -37.641614826907585, -204.55859883672875, 103.88104387407368, -55.054057931093695, 3.21017153974081, -1070.7179888628064, 126.77175747231624, 129.48012284837995, -34.23437354827217, -27.141480579604636, 152.4655357465629, 169.28823006501062, -6.580188053886233, -60.79926668588078, 160.5467707167664, 142.2644613718582, -83.01490131918142, 111.37071318571748, 94.75108561255661, 56.50651573094447, -8.556240359623205, -50.2676829969703, 154.8694465502715, -245.11197431115087, 92.2214315391559, -129.38106198894945, -114.38447238634808, 180.2171029347154, -81.41145472157622, -108.66392490912146, 163.7825654808072, -18.016306324124095, 173.67905389842318, -13.286560549578649, 177.1328749965704, 108.95621985658376, 59.00649634156053, 126.52883667442593, -15.15772087314725, -89.50575225773667, 186.6622552511133, 15.921516069275015, -5.199866027018529, -29.534347309972485, 178.15938394222016, -59.62743310801893, 115.22177527190775, 158.17181805348343, -11.879068987089301, 162.0427629575564, -40.83015984862632, 11.648686106630969, 27.715416951307905, 160.3985597848489, 51.528153827239954, 81.97906489357027, 2.0000000000000013, 167.52222624975954, -189.60014816115256, 119.63786512501324, -60.860306966461906, 116.8170406220837, 156.30628657229445], "policy_predator_policy_reward": [302.2783633460634, 259.05668113505635, 109.41461864162625, 207.06754789223538, 218.7594660092784, 244.77992774027226, 463.46014328420324, 511.4375281238538, 76.93965825910576, 93.44999059574175, 199.2730813825451, 227.83740289829458, 231.93795997894466, 223.9624025971186, 375.9510854898566, 347.34907040737835, 204.48270643718973, 171.74986145720192, 34.53952535759776, 18.513787560492815, 253.40954574249236, 297.7270889286344, 25.157485066755516, 260.9672827712074, 191.30160153471485, 257.375301635224, 37.4775231297995, 101.5265251466891, 410.4931207839509, 273.8217860946563, 296.09914704766516, 224.96394459451002, 311.02472799474566, 301.815131372842, 250.55893103315617, 177.2932816307921, 505.94151632851344, 280.3470926503319, 315.07241662906347, 236.29742927844273, 300.5329454357968, 288.62065095570927, 556.9052009953105, 46.93303987342931, 114.38865574723576, 257.3904021925896, 43.80791222105117, 49.09469536444145, 183.65821569075663, 199.29881939338816, 295.5522501483397, 408.16381884066556, 230.49497604634337, 258.5765696130071, 421.7967276539229, 622.1182534996873, 117.34965124792689, 113.95116441611212, 142.02107704158055, 258.3651551109748, 189.50147043621695, 44.128709910939676, 249.46339041700182, 418.318011019224, 23.524240283595667, 341.57463770490386, 20.316464946018016, 191.88502281585048, 200.1512435698406, 243.61530393199277, 182.19666511354828, 70.3000980750997, 23.07220793007184, 11.86014971231051, 140.6810972863464, 165.2024270004795, 88.21695280736682, 280.7836597749033, 120.72176931237951, 200.86349030575155, 269.80012493550186, 100.10447190490044, 188.41167076782952, 210.50942085473767, 211.10082944560241, 178.3647983084628, 185.02964412464402, 193.15184655331387, 260.5618635310364, 222.871790335425, 98.29727610158868, 85.99513878965956, 129.3155486687055, 160.11131394896643, 432.77846551426995, 165.9330146702244, 42.32874995685045, 201.2885167542481, 149.699141265477, 73.27516596546666, 250.12721248179434, 309.4595492601042, 126.43414754780757, 207.54474916612503, 198.14306864317254, 230.34230386038794, 216.04181693572545, 200.53746683026262, 300.9459944456333, 308.72293188021894, 233.26045933527513, 254.53347376659562, 250.73698987913735, 193.21590594734684, 202.99965339305746, 205.74595911011227, 191.51426888727158, 180.01069664686682, 162.91512527280653, 200.84094237110548, 221.18600819891847, 161.45205908072555, 191.86923470138234, 183.45486770717366, 188.923043307688, 164.77700138749387, 203.76806010914592, 199.6852867802817, 226.94868490179041, 192.7982352018172, 233.67562708468608, 290.6482672944442, 180.93079137158765, 175.68484605789777, 270.62642449395395, 237.10573614335004, 204.68023579654843, 192.66324612312374, 244.89383988646526, 275.42733442874345, 196.70537094083537, 230.06923935502945, 1104.0059726172083, 895.2982958455624, 191.06642128401916, 188.81321027056055, 138.95106995995621, 139.8371209781412, 178.27161061878635, 174.46091730937206, 205.63356344339536, 228.3032418947286, 253.79799654330034, 233.17947358976446, 76.9194595417767, 139.92023272991952, 153.52048577998553, 86.86653654521758, 195.7957358578109, 190.02317311876388, 393.5427370616207, 392.69832723509126, 212.03933927658744, 82.81866629305294, 199.99222802511775, 194.30421510294846, 178.87047827785642, 253.61655936030908, 175.1363642884032, 178.9725973124167, 140.92102986535048, 155.92504950876219, 169.40209358654397, 135.27796686896028, 192.45924680993699, 185.78163320649165, 242.2405689366072, 235.1716564480422, 200.24986602701836, 169.08628891716188, 199.3474550316128, 181.7977144815108, 146.67876986145052, 228.65367592394426, 182.97034955190836, 216.38242657755416, 204.77290918641287, 170.68442554117982, 62.7482617450168, 227.2839954578383, 130.36446939584977, 147.7692703045994, 69.47542153248604, 88.83448471484154, 245.95099050579978, 276.4393520625679, 203.88941543689336, 173.26244518491538, 94.65396894848922, 100.1111746527456]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6271396235736683, "mean_inference_ms": 1.9783846781866308, "mean_action_processing_ms": 0.26016016544012677, "mean_env_wait_ms": 0.24054522747263818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004585981369018555, "StateBufferConnector_ms": 0.003929734230041504, "ViewRequirementAgentConnector_ms": 0.09753668308258057}, "num_episodes": 18, "episode_return_max": 1055.3580370722816, "episode_return_min": 51.09247119434217, "episode_return_mean": 428.7153563332758, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 388.9825659827266, "num_env_steps_trained_throughput_per_sec": 388.9825659827266, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 10353.52, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10353.477, "sample_time_ms": 1373.467, "learn_time_ms": 8961.624, "learn_throughput": 446.348, "synch_weights_time_ms": 16.296}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-45", "timestamp": 1723779285, "time_this_iter_s": 10.28755497932434, "time_total_s": 1092.9041996002197, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a736eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1092.9041996002197, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 30.580000000000002, "ram_util_percent": 83.64666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.83396812721535, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.161342489151728, "policy_loss": -0.0015737537005127817, "vf_loss": 9.162909437108922, "vf_explained_var": 0.003980731585669139, "kl": 0.0025854583277037163, "entropy": 0.3048464717294173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.451197057173996, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.234647759432515, "policy_loss": -0.00902827138243805, "vf_loss": 7.24282315950545, "vf_explained_var": 0.1508514867573188, "kl": 0.022742581559052153, "entropy": 1.2714885140852954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1055.3580370722816, "episode_reward_min": 51.09247119434217, "episode_reward_mean": 447.8141942046998, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1070.7179888628064, "predator_policy": 11.86014971231051}, "policy_reward_max": {"prey_policy": 186.6622552511133, "predator_policy": 1104.0059726172083}, "policy_reward_mean": {"prey_policy": 27.078986371243264, "predator_policy": 196.82811073110668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.5318864376748, 462.76322359823536, 362.3492264855493, 468.70411225655664, 501.22232740680454, 413.63851022771604, 370.86818715013123, 335.2179069824369, 390.1455464678707, 250.3214245769776, 300.1254308857694, 478.7253330945147, 351.5768918034672, 400.0147985697773, 315.05341344333715, 378.2339271607859, 388.24577480364894, 327.99720951375747, 397.3886051498181, 485.5259144443172, 483.1248714051358, 399.1355264098756, 420.04399796515224, 435.50470414050073, 425.9033342063706, 315.3350480771216, 397.7091018833887, 525.9764179286014, 222.78095378866502, 502.08596785453744, 497.97043430158277, 608.6610688763811, 416.9550837103472, 458.4995922619972, 485.455451204161, 505.3005868001235, 467.34685580768786, 420.66793861031584, 459.3435529502046, 489.68585016053265, 457.3728256935871, 451.8745801009594, 538.9589459567653, 496.623571340223, 508.8147371045411, 516.2776583001909, 419.64361935255374, 374.9307239045132, 1055.3580370722816, 475.12538085468697, 404.1122461050558, 515.4405699392826, 533.6843093690101, 546.227030185741, 422.9614910699699, 288.3372976965235, 490.4206725298777, 633.3505215247175, 51.09247119434217, 493.10209134120606, 487.6056782098503, 509.77170917511893, 460.6923938211045, 472.64277665364864, 489.6119958177062, 574.5687283780255, 380.05780498643645, 529.7702061453722, 430.926787949284, 545.6455251958567, 496.6699378365215, 329.3963602607947, 490.06045331253796, 242.2889711408968, 500.3124206569749, 435.92941878036, 467.88847079561333, 383.1503004787649, 378.04011102802815, 349.5628618930894, 530.9720618998016, 429.5481559799844, 499.42932162320585, 375.5175045487393, 503.68488899527443, 506.9792824543463, 530.48409453139, 505.89843573500224, 442.79016230062797, 453.7667071365792, 470.4170955376113, 433.5417478687682, 419.95656729038404, 529.7177249520535, 473.807622664053, 515.2438785678455, 516.2290387165554, 405.73179790491815, 448.146492898386, 457.1191569106166], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.5113295758311, 160.1179492763509, -24.108724798299136, 103.91491331239, -88.7375685522791, -252.62927395117754, 22.207678358233856, -42.57511176102797, 38.978081266522, -581.6707350133277, 73.73983196391073, 108.59786259976634, -31.952848021073752, 2.434803018649581, 83.98107901328045, 17.60664762199939, -208.16126519828939, -69.4745897700659, -45.26275933875207, -69.5146940727689, 59.78992013454584, 28.134022989355145, 86.27054004654262, -51.311754453861, 66.08256649589342, 32.99756211892689, 181.00287709692958, 184.07956383046547, -33.4397373293911, 42.60962648590292, -59.33638777297431, 68.56970235148967, 30.80284344975285, 35.85767173576466, -0.8864466813263117, -41.02094064531875, 1.9470842515551698, -3.4795707243045793, 25.765946196110953, 70.29434049413906, 151.31000820144774, -46.36662747426915, -34.42241297110738, -49.87571448547833, 98.95223908213974, 136.79934399176486, 103.28244943769958, 42.79539208512969, -74.96822590245687, -97.83992007566637, 61.80951215001086, 9.908269216011606, 64.1829285141174, 110.55186613832791, -30.62324118125479, -2.987102632041818, -108.59414754780762, -2.603795377460252, -1.9095598795595692, 75.51015523053672, 168.18661351785684, -86.79546298226118, -164.3626114815217, 163.3547540320508, -42.79022986454568, -28.048619526977213, 72.0307668735628, -57.48407043805087, 99.9404653295189, -23.230626628527073, 18.249661092624464, 115.52596017336175, 11.22658938294307, 92.36419878083262, -55.684574897552295, 93.71444622822396, -34.90310202187907, 118.92255256352662, 149.5664498533343, -13.580644387982947, 71.60592872730741, -17.686449923148075, 82.51319848176274, -50.38553848441067, 53.750916813906215, -39.11586523627148, -9.815270383021995, 149.82320429375974, 141.56287331045792, -140.48029684322017, 156.57579120742633, -37.641614826907585, -204.55859883672875, 103.88104387407368, -55.054057931093695, 3.21017153974081, -1070.7179888628064, 126.77175747231624, 129.48012284837995, -34.23437354827217, -27.141480579604636, 152.4655357465629, 169.28823006501062, -6.580188053886233, -60.79926668588078, 160.5467707167664, 142.2644613718582, -83.01490131918142, 111.37071318571748, 94.75108561255661, 56.50651573094447, -8.556240359623205, -50.2676829969703, 154.8694465502715, -245.11197431115087, 92.2214315391559, -129.38106198894945, -114.38447238634808, 180.2171029347154, -81.41145472157622, -108.66392490912146, 163.7825654808072, -18.016306324124095, 173.67905389842318, -13.286560549578649, 177.1328749965704, 108.95621985658376, 59.00649634156053, 126.52883667442593, -15.15772087314725, -89.50575225773667, 186.6622552511133, 15.921516069275015, -5.199866027018529, -29.534347309972485, 178.15938394222016, -59.62743310801893, 115.22177527190775, 158.17181805348343, -11.879068987089301, 162.0427629575564, -40.83015984862632, 11.648686106630969, 27.715416951307905, 160.3985597848489, 51.528153827239954, 81.97906489357027, 2.0000000000000013, 167.52222624975954, -189.60014816115256, 119.63786512501324, -60.860306966461906, 116.8170406220837, 156.30628657229445, 27.354043653850272, 54.180953005278084, 64.41158415768007, 143.01440748281541, -15.077662217032508, 167.39287548210262, 168.23128598355558, -298.3988961440007, 49.917869449906014, 174.428773064515, -33.75830862731784, 148.26898458511587, -11.144903951379522, 26.51792695711042, -59.35279495379373, 136.04354408379342, -37.917191392918305, 132.24892095586569, -42.35068397324576, 168.4929736904807, 78.8838397917728, 52.17272272101609, -15.720306877343985, 72.5896220857489, 180.75576685905128, 95.53523341619045, 131.33226451410573, 89.54501211460556, 50.66096174742377, 147.62016314666104, -9.90697532433962, 113.64884207962406, 169.39351427108352, -341.17683866159217, 155.13844485611364, 39.464805601848894, -44.893673301959915, 174.7076307879368, -46.94298391185638, 162.7982071194445, 50.4704939388853, -27.500795415164394, 165.3747840924555, -1.3776475416709104, 46.33345492926358, 159.54627485000796], "policy_predator_policy_reward": [43.80791222105117, 49.09469536444145, 183.65821569075663, 199.29881939338816, 295.5522501483397, 408.16381884066556, 230.49497604634337, 258.5765696130071, 421.7967276539229, 622.1182534996873, 117.34965124792689, 113.95116441611212, 142.02107704158055, 258.3651551109748, 189.50147043621695, 44.128709910939676, 249.46339041700182, 418.318011019224, 23.524240283595667, 341.57463770490386, 20.316464946018016, 191.88502281585048, 200.1512435698406, 243.61530393199277, 182.19666511354828, 70.3000980750997, 23.07220793007184, 11.86014971231051, 140.6810972863464, 165.2024270004795, 88.21695280736682, 280.7836597749033, 120.72176931237951, 200.86349030575155, 269.80012493550186, 100.10447190490044, 188.41167076782952, 210.50942085473767, 211.10082944560241, 178.3647983084628, 185.02964412464402, 193.15184655331387, 260.5618635310364, 222.871790335425, 98.29727610158868, 85.99513878965956, 129.3155486687055, 160.11131394896643, 432.77846551426995, 165.9330146702244, 42.32874995685045, 201.2885167542481, 149.699141265477, 73.27516596546666, 250.12721248179434, 309.4595492601042, 126.43414754780757, 207.54474916612503, 198.14306864317254, 230.34230386038794, 216.04181693572545, 200.53746683026262, 300.9459944456333, 308.72293188021894, 233.26045933527513, 254.53347376659562, 250.73698987913735, 193.21590594734684, 202.99965339305746, 205.74595911011227, 191.51426888727158, 180.01069664686682, 162.91512527280653, 200.84094237110548, 221.18600819891847, 161.45205908072555, 191.86923470138234, 183.45486770717366, 188.923043307688, 164.77700138749387, 203.76806010914592, 199.6852867802817, 226.94868490179041, 192.7982352018172, 233.67562708468608, 290.6482672944442, 180.93079137158765, 175.68484605789777, 270.62642449395395, 237.10573614335004, 204.68023579654843, 192.66324612312374, 244.89383988646526, 275.42733442874345, 196.70537094083537, 230.06923935502945, 1104.0059726172083, 895.2982958455624, 191.06642128401916, 188.81321027056055, 138.95106995995621, 139.8371209781412, 178.27161061878635, 174.46091730937206, 205.63356344339536, 228.3032418947286, 253.79799654330034, 233.17947358976446, 76.9194595417767, 139.92023272991952, 153.52048577998553, 86.86653654521758, 195.7957358578109, 190.02317311876388, 393.5427370616207, 392.69832723509126, 212.03933927658744, 82.81866629305294, 199.99222802511775, 194.30421510294846, 178.87047827785642, 253.61655936030908, 175.1363642884032, 178.9725973124167, 140.92102986535048, 155.92504950876219, 169.40209358654397, 135.27796686896028, 192.45924680993699, 185.78163320649165, 242.2405689366072, 235.1716564480422, 200.24986602701836, 169.08628891716188, 199.3474550316128, 181.7977144815108, 146.67876986145052, 228.65367592394426, 182.97034955190836, 216.38242657755416, 204.77290918641287, 170.68442554117982, 62.7482617450168, 227.2839954578383, 130.36446939584977, 147.7692703045994, 69.47542153248604, 88.83448471484154, 245.95099050579978, 276.4393520625679, 203.88941543689336, 173.26244518491538, 94.65396894848922, 100.1111746527456, 157.1181026655202, 144.49720115411642, 93.18771486886585, 77.42640451866698, 93.0285694545718, 104.21907917344743, 337.92226575835485, 323.21740630189055, 109.53304085509133, 95.66847261047224, 198.37758480667208, 186.5410608587345, 199.53240850011875, 160.61207304288942, 224.8699993827983, 202.12414048247604, 197.97216912588647, 214.67538376551238, 220.65300374176047, 183.68880107239391, 181.57915386160644, 193.26271936060755, 213.20092968419135, 172.71991740803105, 91.60642534193863, 85.86928151939901, 115.35488775503802, 134.18493115386266, 125.49926634787506, 109.76135662680831, 149.09737102627236, 167.11732950882774, 270.238399914006, 431.2626494285566, 140.7901680947882, 138.41420411130213, 195.32625527292882, 190.10366580894066, 197.22162568027915, 203.15218982868777, 168.36455484467965, 214.39754453651824, 139.4393331026823, 144.7100232449188, 124.81452125238805, 126.42490587895699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6267814232523411, "mean_inference_ms": 1.9729598059718814, "mean_action_processing_ms": 0.2596948338365878, "mean_env_wait_ms": 0.24040926306539234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003772735595703125, "StateBufferConnector_ms": 0.003179311752319336, "ViewRequirementAgentConnector_ms": 0.0968698263168335}, "num_episodes": 23, "episode_return_max": 1055.3580370722816, "episode_return_min": 51.09247119434217, "episode_return_mean": 447.8141942046998, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.1132825573049, "num_env_steps_trained_throughput_per_sec": 368.1132825573049, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 10440.443, "restore_workers_time_ms": 0.015, "training_step_time_ms": 10440.399, "sample_time_ms": 1387.637, "learn_time_ms": 9034.19, "learn_throughput": 442.762, "synch_weights_time_ms": 16.302}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "e552a_00000", "date": "2024-08-16_09-04-55", "timestamp": 1723779295, "time_this_iter_s": 10.91593599319458, "time_total_s": 1103.8201355934143, "pid": 25593, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a7307dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1103.8201355934143, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 32.80666666666667, "ram_util_percent": 83.56666666666666}}
