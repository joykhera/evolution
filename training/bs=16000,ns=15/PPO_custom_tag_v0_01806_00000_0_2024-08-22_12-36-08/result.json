{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9744290109664675, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.549358231176144, "policy_loss": -0.010995618692998374, "vf_loss": 7.5586243982668275, "vf_explained_var": 0.019212150699877865, "kl": 0.00864717591869295, "entropy": 1.6022588417012855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8028737651765662, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.643965935580945, "policy_loss": -0.010327754956645467, "vf_loss": 6.652325507068129, "vf_explained_var": 0.011474158461131747, "kl": 0.009841044552663646, "entropy": 1.6009081510008958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.1766147432946, "num_env_steps_trained_throughput_per_sec": 129.1766147432946, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 30965.383, "restore_workers_time_ms": 0.067, "training_step_time_ms": 30965.255, "sample_time_ms": 6592.566, "learn_time_ms": 24357.762, "learn_throughput": 164.219, "synch_weights_time_ms": 10.442}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "01806_00000", "date": "2024-08-22_12-41-06", "timestamp": 1724310666, "time_this_iter_s": 31.03034281730652, "time_total_s": 31.03034281730652, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.03034281730652, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.79555555555555, "ram_util_percent": 83.40666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9560154422881113, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.259540097675626, "policy_loss": -0.01667852292339953, "vf_loss": 6.274638003899307, "vf_explained_var": 0.11184461343856085, "kl": 0.007903039720766837, "entropy": 1.5950238038623143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312500000001}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5571041235848078, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.7093605722699845, "policy_loss": -0.012628246431864758, "vf_loss": 4.72042208272944, "vf_explained_var": 0.07962096885398583, "kl": 0.007833761210361171, "entropy": 1.5969949065062103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312500000001}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.75617443328025, "num_env_steps_trained_throughput_per_sec": 143.75617443328025, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 29395.145, "restore_workers_time_ms": 0.046, "training_step_time_ms": 29394.903, "sample_time_ms": 4989.41, "learn_time_ms": 24377.437, "learn_throughput": 164.086, "synch_weights_time_ms": 20.066}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "01806_00000", "date": "2024-08-22_12-41-36", "timestamp": 1724310696, "time_this_iter_s": 27.869651079177856, "time_total_s": 58.899993896484375, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3a1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.899993896484375, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.345454545454544, "ram_util_percent": 83.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.879201861411806, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.434843201359744, "policy_loss": -0.01473144765539223, "vf_loss": 5.447746027083624, "vf_explained_var": 0.1920429757032445, "kl": 0.00914316181876948, "entropy": 1.582949145256527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0323484516648387, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3111764090401787, "policy_loss": -0.014053730506982122, "vf_loss": 3.324051067059633, "vf_explained_var": 0.09265413587055508, "kl": 0.005895300696865119, "entropy": 1.5920620446482663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.21187299057428, "num_env_steps_trained_throughput_per_sec": 141.21187299057428, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 29038.855, "restore_workers_time_ms": 0.041, "training_step_time_ms": 29038.426, "sample_time_ms": 4339.107, "learn_time_ms": 24668.035, "learn_throughput": 162.153, "synch_weights_time_ms": 21.857}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "01806_00000", "date": "2024-08-22_12-42-05", "timestamp": 1724310725, "time_this_iter_s": 28.367079257965088, "time_total_s": 87.26707315444946, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3a1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.26707315444946, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 52.295, "ram_util_percent": 83.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.708316651349345, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.325829194084046, "policy_loss": -0.015677863693544788, "vf_loss": 5.339641874807852, "vf_explained_var": 0.24869933380651726, "kl": 0.009325895775553017, "entropy": 1.5750534415875792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000001}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1815347212963005, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.3659046521262517, "policy_loss": -0.01569577659623175, "vf_loss": 2.3799665164695214, "vf_explained_var": 0.11865564792875259, "kl": 0.00816953377551818, "entropy": 1.5825474066709084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000001}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.67752165588135, "num_env_steps_trained_throughput_per_sec": 138.67752165588135, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 28990.204, "restore_workers_time_ms": 0.049, "training_step_time_ms": 28989.767, "sample_time_ms": 4107.854, "learn_time_ms": 24852.604, "learn_throughput": 160.949, "synch_weights_time_ms": 20.347}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "01806_00000", "date": "2024-08-22_12-42-34", "timestamp": 1724310754, "time_this_iter_s": 28.88430404663086, "time_total_s": 116.15137720108032, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4955e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.15137720108032, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 43.347500000000004, "ram_util_percent": 83.3325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.367604286330087, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.759096920174897, "policy_loss": -0.013242875932094951, "vf_loss": 5.77013378799277, "vf_explained_var": 0.31355908137780647, "kl": 0.011029977699317945, "entropy": 1.5695045009491935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000001}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5999495482318615, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.8942530445320895, "policy_loss": -0.014842872764107095, "vf_loss": 1.9076813354694024, "vf_explained_var": 0.11820321253367833, "kl": 0.007072948146286229, "entropy": 1.5802545035326923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000001}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.77208820016554, "num_env_steps_trained_throughput_per_sec": 129.77208820016554, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 29356.819, "restore_workers_time_ms": 0.042, "training_step_time_ms": 29356.446, "sample_time_ms": 4410.217, "learn_time_ms": 24916.612, "learn_throughput": 160.535, "synch_weights_time_ms": 21.877}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "01806_00000", "date": "2024-08-22_12-43-05", "timestamp": 1724310785, "time_this_iter_s": 30.868308067321777, "time_total_s": 147.0196852684021, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae495f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 147.0196852684021, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 43.602272727272734, "ram_util_percent": 83.35227272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.0240457901248226, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.811149940793476, "policy_loss": -0.014401391426978445, "vf_loss": 5.823526615566678, "vf_explained_var": 0.3752650920676176, "kl": 0.010123545867169187, "entropy": 1.5718336643996063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.030749667006195, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.8873507240461924, "policy_loss": -0.015379472847081839, "vf_loss": 1.9014593555813744, "vf_explained_var": 0.13660901217233568, "kl": 0.006354229386018776, "entropy": 1.5730391284145375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.1902473385674, "num_env_steps_trained_throughput_per_sec": 144.1902473385674, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 29087.545, "restore_workers_time_ms": 0.041, "training_step_time_ms": 29087.216, "sample_time_ms": 4143.958, "learn_time_ms": 24915.157, "learn_throughput": 160.545, "synch_weights_time_ms": 21.273}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "01806_00000", "date": "2024-08-22_12-43-32", "timestamp": 1724310812, "time_this_iter_s": 27.800513982772827, "time_total_s": 174.82019925117493, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae45dee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 174.82019925117493, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.81794871794872, "ram_util_percent": 83.38974358974362}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.948172247599041, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.290186782110305, "policy_loss": -0.01165065714650881, "vf_loss": 6.300359659850913, "vf_explained_var": 0.3098455668757201, "kl": 0.00738900202750253, "entropy": 1.5606521899107273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2255108392427836, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.193856751603424, "policy_loss": -0.013820526851883168, "vf_loss": 2.205980066143016, "vf_explained_var": 0.11232380633631711, "kl": 0.008486075043954232, "entropy": 1.5521777381341924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.05397531115577, "num_env_steps_trained_throughput_per_sec": 142.05397531115577, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 28954.801, "restore_workers_time_ms": 0.037, "training_step_time_ms": 28954.467, "sample_time_ms": 3979.907, "learn_time_ms": 24945.523, "learn_throughput": 160.349, "synch_weights_time_ms": 22.734}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "01806_00000", "date": "2024-08-22_12-44-01", "timestamp": 1724310841, "time_this_iter_s": 28.223368883132935, "time_total_s": 203.04356813430786, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 203.04356813430786, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 40.355000000000004, "ram_util_percent": 83.29}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.564725990459402, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.012192488978148, "policy_loss": -0.014031035644766042, "vf_loss": 7.024853541359069, "vf_explained_var": 0.3745544268340661, "kl": 0.0068499051537069065, "entropy": 1.5495638754002001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4846565199276758, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.5332174544611936, "policy_loss": -0.01620459362775797, "vf_loss": 2.547490568261929, "vf_explained_var": 0.16710873520563518, "kl": 0.009657408831956446, "entropy": 1.5343004666938984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 502.99999999999983, "episode_reward_min": 57.80000000000059, "episode_reward_mean": 304.83325399150203, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 4400, "policy_reward_min": {"prey_policy": -259.0724001371349, "predator_policy": 5.939648019140687}, "policy_reward_max": {"prey_policy": 304.21454793091846, "predator_policy": 292.9233823955251}, "policy_reward_mean": {"prey_policy": 2.9098062978105887, "predator_policy": 149.5068206979399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.097968622748928, "mean_inference_ms": 6.896329761419775, "mean_action_processing_ms": 3.627265653636457, "mean_env_wait_ms": 11.98341079118636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037962740117853336, "StateBufferConnector_ms": 0.00422867861661044, "ViewRequirementAgentConnector_ms": 0.23772066289728339}, "num_episodes": 11, "episode_return_max": 502.99999999999983, "episode_return_min": 57.80000000000059, "episode_return_mean": 304.83325399150203, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.19932643646163, "num_env_steps_trained_throughput_per_sec": 141.19932643646163, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 28876.549, "restore_workers_time_ms": 0.036, "training_step_time_ms": 28876.19, "sample_time_ms": 3822.127, "learn_time_ms": 25025.093, "learn_throughput": 159.84, "synch_weights_time_ms": 22.949}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "01806_00000", "date": "2024-08-22_12-44-29", "timestamp": 1724310869, "time_this_iter_s": 28.38983988761902, "time_total_s": 231.43340802192688, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae49ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 231.43340802192688, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.465, "ram_util_percent": 83.16499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.138193073096098, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.306478043712636, "policy_loss": -0.01745479696592878, "vf_loss": 7.321947449981851, "vf_explained_var": 0.38729181434742355, "kl": 0.009927022683301142, "entropy": 1.5069237888174714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3291631516956146, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.404083724501272, "policy_loss": -0.014887440930953417, "vf_loss": 3.4168283205183725, "vf_explained_var": 0.17827869155419568, "kl": 0.010714256139619956, "entropy": 1.4939141506871219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000036}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 582.0999999999997, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 300.76914798275436, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 28000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -18.912256088861263, "predator_policy": 169.29683008023832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.163896202805113, "mean_inference_ms": 6.673067670185333, "mean_action_processing_ms": 3.331513917752036, "mean_env_wait_ms": 11.641307600168751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012246370315551758, "StateBufferConnector_ms": 0.01365201813834054, "ViewRequirementAgentConnector_ms": 0.2884587219783238}, "num_episodes": 59, "episode_return_max": 582.0999999999997, "episode_return_min": 12.375319177907244, "episode_return_mean": 300.76914798275436, "episodes_this_iter": 59}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.4210083129861, "num_env_steps_trained_throughput_per_sec": 142.4210083129861, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 28788.688, "restore_workers_time_ms": 0.037, "training_step_time_ms": 28788.355, "sample_time_ms": 3703.802, "learn_time_ms": 25056.713, "learn_throughput": 159.638, "synch_weights_time_ms": 22.229}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "01806_00000", "date": "2024-08-22_12-44-57", "timestamp": 1724310897, "time_this_iter_s": 28.130858898162842, "time_total_s": 259.5642669200897, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae49ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 259.5642669200897, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 40.777499999999996, "ram_util_percent": 83.2225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.718035447282135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.194736806173173, "policy_loss": -0.01706862250865294, "vf_loss": 7.209733485670948, "vf_explained_var": 0.3431245671378242, "kl": 0.01035966245363905, "entropy": 1.4510192834511004, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.679457650487385, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.9090932303635535, "policy_loss": -0.01735917693890986, "vf_loss": 4.923644987489811, "vf_explained_var": 0.19573269407585184, "kl": 0.014037055002338199, "entropy": 1.4090987891747206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 20, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.90009348775763, "num_env_steps_trained_throughput_per_sec": 141.90009348775763, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 28728.705, "restore_workers_time_ms": 0.034, "training_step_time_ms": 28728.393, "sample_time_ms": 3616.503, "learn_time_ms": 25083.854, "learn_throughput": 159.465, "synch_weights_time_ms": 22.574}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "01806_00000", "date": "2024-08-22_12-45-26", "timestamp": 1724310926, "time_this_iter_s": 28.270400047302246, "time_total_s": 287.83466696739197, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3a10d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 287.83466696739197, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.7975, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.431293335919658, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1604545219865425, "policy_loss": -0.013161923274614665, "vf_loss": 7.171692943068408, "vf_explained_var": 0.3146939968936658, "kl": 0.009617443436697598, "entropy": 1.447535687401181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5894298313156, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.442151473312782, "policy_loss": -0.01850088785387694, "vf_loss": 4.457620744604283, "vf_explained_var": 0.2326114703107763, "kl": 0.015158200922308775, "entropy": 1.400905430758441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 0, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.0386780038136, "num_env_steps_trained_throughput_per_sec": 144.0386780038136, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 28409.232, "restore_workers_time_ms": 0.058, "training_step_time_ms": 28408.866, "sample_time_ms": 3227.182, "learn_time_ms": 25153.115, "learn_throughput": 159.026, "synch_weights_time_ms": 23.291}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "01806_00000", "date": "2024-08-22_12-45-54", "timestamp": 1724310954, "time_this_iter_s": 27.820252895355225, "time_total_s": 315.6549198627472, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a6a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 315.6549198627472, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.764102564102565, "ram_util_percent": 82.59743589743587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.285728495840042, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.198116707675672, "policy_loss": -0.012916773438907016, "vf_loss": 7.209173062238744, "vf_explained_var": 0.33452908917078894, "kl": 0.009302238765956154, "entropy": 1.4642292186696693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.652083502370845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.8196913290276098, "policy_loss": -0.01576844773516453, "vf_loss": 3.8326766190705475, "vf_explained_var": 0.24896643660055898, "kl": 0.013915781670363335, "entropy": 1.4043409116684444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 0, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.68678526451515, "num_env_steps_trained_throughput_per_sec": 147.68678526451515, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 28335.178, "restore_workers_time_ms": 0.058, "training_step_time_ms": 28334.835, "sample_time_ms": 3121.079, "learn_time_ms": 25185.627, "learn_throughput": 158.821, "synch_weights_time_ms": 23.372}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "01806_00000", "date": "2024-08-22_12-46-21", "timestamp": 1724310981, "time_this_iter_s": 27.13014793395996, "time_total_s": 342.78506779670715, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 342.78506779670715, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.72307692307692, "ram_util_percent": 82.62820512820515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.62356138241985, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.060525262418878, "policy_loss": -0.014993135276787653, "vf_loss": 7.073761638762459, "vf_explained_var": 0.42319697690388514, "kl": 0.008783720128445163, "entropy": 1.4730031798125576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.0747417863083895, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.3651674972009404, "policy_loss": -0.01340989823940964, "vf_loss": 3.376394168662016, "vf_explained_var": 0.27202477228073846, "kl": 0.010916099891992947, "entropy": 1.425807966126336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 0, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.2533149008208, "num_env_steps_trained_throughput_per_sec": 145.2533149008208, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 28256.365, "restore_workers_time_ms": 0.058, "training_step_time_ms": 28256.076, "sample_time_ms": 3079.384, "learn_time_ms": 25149.104, "learn_throughput": 159.051, "synch_weights_time_ms": 23.481}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "01806_00000", "date": "2024-08-22_12-46-48", "timestamp": 1724311008, "time_this_iter_s": 27.629539966583252, "time_total_s": 370.4146077632904, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 370.4146077632904, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.90512820512821, "ram_util_percent": 82.90256410256413}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.181253285256643, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.222363811573654, "policy_loss": -0.012200024269186158, "vf_loss": 7.232282611806557, "vf_explained_var": 0.43799042531422205, "kl": 0.01140609411079259, "entropy": 1.4816234221534124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.654179855061587, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.487794189604502, "policy_loss": -0.011604282747283971, "vf_loss": 3.4969968455178395, "vf_explained_var": 0.2516085210931364, "kl": 0.012008130173420622, "entropy": 1.3980694442829757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 0, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.1069355089652, "num_env_steps_trained_throughput_per_sec": 143.1069355089652, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 28167.056, "restore_workers_time_ms": 0.053, "training_step_time_ms": 28166.804, "sample_time_ms": 3001.13, "learn_time_ms": 25138.304, "learn_throughput": 159.12, "synch_weights_time_ms": 23.627}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "01806_00000", "date": "2024-08-22_12-47-16", "timestamp": 1724311036, "time_this_iter_s": 28.014364004135132, "time_total_s": 398.42897176742554, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 398.42897176742554, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.77948717948718, "ram_util_percent": 83.26153846153844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.670242000509191, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.1269403583789, "policy_loss": -0.012268489695316742, "vf_loss": 7.137221051271631, "vf_explained_var": 0.5090019803198557, "kl": 0.009939053325997616, "entropy": 1.4596687618386808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.2795227181974544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.570157740860389, "policy_loss": -0.012564440044604006, "vf_loss": 3.5806224959237234, "vf_explained_var": 0.28585311414072756, "kl": 0.010498420274742539, "entropy": 1.3699592710172057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 631.342546298356, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 313.88179396665015, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 36000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -8.350408856042867, "predator_policy": 165.29130583936782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.153329838152278, "mean_inference_ms": 6.608741049344606, "mean_action_processing_ms": 3.2736926102855946, "mean_env_wait_ms": 11.592702868812268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013130903244018555, "StateBufferConnector_ms": 0.016088485717773438, "ViewRequirementAgentConnector_ms": 0.29332756996154785}, "num_episodes": 0, "episode_return_max": 631.342546298356, "episode_return_min": 12.375319177907244, "episode_return_mean": 313.88179396665015, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.50765346905376, "num_env_steps_trained_throughput_per_sec": 143.50765346905376, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 27872.037, "restore_workers_time_ms": 0.053, "training_step_time_ms": 27871.763, "sample_time_ms": 2739.303, "learn_time_ms": 25103.405, "learn_throughput": 159.341, "synch_weights_time_ms": 25.267}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "01806_00000", "date": "2024-08-22_12-47-44", "timestamp": 1724311064, "time_this_iter_s": 27.926798105239868, "time_total_s": 426.3557698726654, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3a15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 426.3557698726654, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.472500000000004, "ram_util_percent": 83.0025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.97514487927553, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.311625083539852, "policy_loss": -0.011479010154300976, "vf_loss": 7.321471544296022, "vf_explained_var": 0.4678482252454001, "kl": 0.008162767287816793, "entropy": 1.4230287250387605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.156519850221261, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.364745282117652, "policy_loss": -0.014052042356697183, "vf_loss": 4.376264238862134, "vf_explained_var": 0.3069419641974111, "kl": 0.012665472141215725, "entropy": 1.2860001369758889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 650.7479145524729, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 318.2523645772706, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 37600, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 652.9051043023304}, "policy_reward_mean": {"prey_policy": -7.388578188899501, "predator_policy": 166.51476047753468}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.49999999999895, 502.99999999999983, 349.70000000000107, 358.23452825233966, 329.9496012165497, 464.29999999999967, 350.4816644376309, 57.80000000000059, 196.2999999999998, 108.70000000000037, 385.2000000000027, 71.10000000000024, 295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [84.95801835255669, -74.68991859473682, 91.37343436136253, 124.04997833173745, -202.7511162636929, 304.21454793091846, -128.4089031088272, 205.47894922287793, -105.10798630347725, 68.02328199835299, 86.76165271465445, 89.3874449731673, 33.44801223124899, -75.87568808190797, -259.0724001371349, -193.10900114611908, -177.6233823955262, 69.17788298792999, 56.35381470751855, -126.6552962110868, 236.06035198085928, -41.97793899884261, 16.12376158921589, -110.06887965571242, 0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411], "policy_predator_policy_reward": [130.54198164744335, 108.68991859473493, 193.6265656386374, 93.95002166826175, 231.65111626369125, 16.585452069081636, 239.6381338457756, 41.52634829251301, 100.6890219452891, 266.34528357638453, 111.4383472853452, 176.71255502683258, 292.13680702454917, 100.77253326374007, 286.77240013713515, 223.2090011461174, 292.9233823955251, 11.822117012070029, 18.24618529248138, 160.75529621108487, 5.939648019140687, 185.1779389988426, 124.19801949201248, 40.847098574484264, 37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.1024952171883, "mean_inference_ms": 6.586382513086789, "mean_action_processing_ms": 3.2655299350827907, "mean_env_wait_ms": 11.614532998811805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012740175774756899, "StateBufferConnector_ms": 0.015628337860107422, "ViewRequirementAgentConnector_ms": 0.28818516021079205}, "num_episodes": 4, "episode_return_max": 650.7479145524729, "episode_return_min": 12.375319177907244, "episode_return_mean": 318.2523645772706, "episodes_this_iter": 4}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.2298416084408, "num_env_steps_trained_throughput_per_sec": 141.2298416084408, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 27930.186, "restore_workers_time_ms": 0.054, "training_step_time_ms": 27929.91, "sample_time_ms": 2772.243, "learn_time_ms": 25128.912, "learn_throughput": 159.179, "synch_weights_time_ms": 24.856}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "01806_00000", "date": "2024-08-22_12-48-13", "timestamp": 1724311093, "time_this_iter_s": 28.381455898284912, "time_total_s": 454.7372257709503, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48eaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 454.7372257709503, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.695, "ram_util_percent": 83.0275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.762538120986292, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.493209497260038, "policy_loss": -0.014930942070685209, "vf_loss": 7.506270505006982, "vf_explained_var": 0.5312860350129466, "kl": 0.009349742257800052, "entropy": 1.3799228026122643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.067293914663729, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.333471267942398, "policy_loss": -0.013793450094779175, "vf_loss": 5.344469291949398, "vf_explained_var": 0.27192611410504297, "kl": 0.013977085905415671, "entropy": 1.188719364827272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 650.7479145524729, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 338.71402880566745, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -624.2713977166031, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 391.4791967251825, "predator_policy": 881.5217354698633}, "policy_reward_mean": {"prey_policy": -19.545305063284488, "predator_policy": 188.9023194661182}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.9999999999999, 510.95786780989766, 225.0369833217696, 117.19999999999987, 416.1857937411974, 428.43623015359844, 357.542856518852, 562.0467223211879, 180.29999999999802, 537.0, 150.6323504434507, 368.66538965040866, 58.20000000000065, 457.7201449695109, 264.5740534202322, 320.9, 427.10000000000025, 486.70000000000016, 99.79146214204505, 87.97739404112458, 239.79999999999956, 108.39713826143652, 53.47002695763275, 562.3260828128266, 223.4999999999999, 72.38029536582538, 67.30000000000045, 497.1615670006963, 274.43212544773013, 217.22388816279346, 174.8446437645461, 98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [0.9381017392387219, 171.55791116638977, -120.21935487482779, 212.67776388104542, -19.750143818619406, -38.968135368856245, -135.45009525249694, -66.94503613737, -64.06316002806946, 15.800623182032865, 257.55466680476235, -159.89441035281442, -133.6762109468437, 19.399358029935875, 294.61154183846304, 160.67681552529422, -144.74683280195336, 51.026865289298385, -68.72504054131457, 179.5710570595773, -402.012099039639, -110.4316267914975, 190.18192824898608, -211.3553902233037, -312.852504753496, -90.74262603024145, 56.8963993360135, 87.2703716725871, -414.59191647632747, 200.67773115140085, 240.275305628314, -47.309005180331084, -59.25274064344565, 126.16810301434387, -43.499868811321676, 40.87999543968138, -179.1017236671639, -110.29334083030847, -151.0215569002075, -26.898167135140476, 30.289643080576663, -93.7305480244327, -147.02190823698265, -287.2178638573668, -67.95225624112041, -273.0911213027361, 202.99810991880278, 226.4077612365952, -595.0078692031948, 189.88446002398177, -56.43410874146521, -44.17602340714277, 1.557367051212603, -120.76685399469105, 132.2793754718332, 141.871637735081, -130.70324085429803, 55.40093713896093, -32.5244586482388, -203.21259525200293, -82.95490510122667, -36.91599348846539, 38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006], "policy_predator_policy_reward": [37.06189826076146, 86.4420888336097, 93.5370275060121, 324.9624312976682, 266.39153199816883, 17.36373051107813, 213.0500952524972, 106.54503613736803, 149.7906821338683, 314.6576484533654, 149.81006120791554, 180.96591249373472, 293.7357426177149, 178.08396681804712, 98.77420185455198, 7.9841631028784565, 176.24683280195177, 97.77313471070123, 285.62504054131466, 140.52894294042272, 516.5546313945158, 146.52144488007167, 305.67301559384106, 84.16583603088381, 337.2525047534947, 124.5426260302402, 46.33685329368804, 267.2165206672226, 429.0064198830871, 49.48181886207655, 45.4246943716861, 82.50900518033122, 187.67844593625986, 172.50619169284118, 262.2998688113211, 227.02000456031857, 180.99710910670044, 208.18941753281433, 233.53991963117375, 32.357198445298344, 5.798528993571373, 297.4423759502844, 260.8386887061557, 281.7982216496283, 54.699854295465336, 339.81355020602194, 120.30189008119716, 12.618321576231592, 613.2078692031962, 15.41553997601823, 41.185959459020424, 131.80446805541143, 47.97035012535333, 138.53913681812347, 83.1388041448885, 139.87174964889326, 165.23536630202761, 184.49906286103894, 117.91104851955987, 335.04989354347543, 239.47318388465777, 55.24235846957895, 10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.963012982216074, "mean_inference_ms": 6.468118734298338, "mean_action_processing_ms": 3.1008145577279675, "mean_env_wait_ms": 11.62220412725609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012075543403625488, "StateBufferConnector_ms": 0.015257477760314941, "ViewRequirementAgentConnector_ms": 0.310261607170105}, "num_episodes": 18, "episode_return_max": 650.7479145524729, "episode_return_min": 12.375319177907244, "episode_return_mean": 338.71402880566745, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.14824544165268, "num_env_steps_trained_throughput_per_sec": 143.14824544165268, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 27908.66, "restore_workers_time_ms": 0.054, "training_step_time_ms": 27908.389, "sample_time_ms": 2781.969, "learn_time_ms": 25098.013, "learn_throughput": 159.375, "synch_weights_time_ms": 24.441}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "01806_00000", "date": "2024-08-22_12-48-41", "timestamp": 1724311121, "time_this_iter_s": 28.007878065109253, "time_total_s": 482.74510383605957, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 482.74510383605957, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.746153846153845, "ram_util_percent": 83.35384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.88418708150349, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.909146054585775, "policy_loss": -0.010271979408171126, "vf_loss": 7.917762852219678, "vf_explained_var": 0.4757334544545128, "kl": 0.008275873790539446, "entropy": 1.3154280690289049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.13151603867768, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.256852457258437, "policy_loss": -0.014269708843024635, "vf_loss": 6.26834395474227, "vf_explained_var": 0.30769728800607105, "kl": 0.013890993418714042, "entropy": 1.0577625986129517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 12.375319177907244, "episode_reward_mean": 365.98093176499356, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -46.63574580044747, "predator_policy": 229.6262116829442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [98.49999999999956, 430.1421580343155, 250.80258265691992, 381.30000000000166, 369.9999999999994, 502.6459548169392, 146.29999999999964, 264.09999999999934, 429.436639735924, 159.1368853413479, 512.1000000000003, 336.5640852879998, 275.3999999999997, 131.67767647956563, 427.9000000000001, 304.29999999999944, 177.39999999999927, 426.42365965268783, 12.375319177907244, 361.3000000000003, 447.69999999999993, 293.4665873959192, 383.6999999999995, 512.1, 582.0999999999997, 173.29999999999688, 395.6000000000008, 330.1999999999999, 320.70000000000095, 631.342546298356, 116.10591690296982, 458.86390443145996, 273.5999999999994, 110.13543210859001, 297.59999999999974, 368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.626326575228326, -87.26292415175344, 81.27732729652203, -13.47070188265414, -521.1014624932794, 175.19292554055681, -100.25981203657598, 228.4714093423637, 203.42111006689106, -7.6390153922768755, 53.43701213739689, 143.95124310814046, -266.0121631237363, -238.4009370141156, 40.0000000000003, 219.62187892258598, 94.45243404073437, 37.32509516748817, -237.47099704354753, -206.47669981494417, 391.4791967251825, -33.98541838584953, 5.521147458366912, -22.24564676329566, 213.2715199016918, -268.29092107199136, -171.19144724194896, -151.7852365796662, 236.04438831261479, -8.49879531168233, 121.38537727209689, -192.84076039400952, -142.84681794427803, -216.97946392061579, -177.763785506047, 157.59046322855875, -230.43946763620744, -411.73850109487256, -624.2713977166031, 248.69420283726961, 277.8606828770412, 105.27613619728922, 188.9213248601967, -82.77587806133765, 124.12727270728521, -233.5442359057272, 33.61091100732805, -47.87058470142859, 323.05136174737197, 178.857480398773, -31.82798861474305, -27.242068297134157, -85.76460456813288, 297.3999343081113, 107.41969682425702, -66.31080093700172, 208.91026693704816, -213.93196632360286, 220.5318982432577, 227.48583219972338, -293.1021426038594, -8.23111140122358, 174.66590324274665, 64.51501353908667, -27.627612639912428, 123.70347658602086, 21.535278644176906, -161.56959827209351, -111.49192062333658, 61.878117685536886, -170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538], "policy_predator_policy_reward": [10.273673424772019, 136.86292415175336, 159.46053802221536, 202.8749945982317, 532.6737600411329, 64.03735956851395, 129.59026439333272, 123.49813830087759, 113.86519154993825, 60.35271377544747, 75.31561084848647, 229.94208872291486, 356.7121631237362, 294.00093701411464, 4.4781210774129185, 0.0, 140.50819429890618, 157.15091622879473, 350.2762572298706, 252.80832496996786, 4.520803274817529, 150.0854183858493, 269.3296805580543, 83.95890403487267, 22.528480098308126, 307.89092107199167, 235.2250601064127, 219.42930019476657, 50.31832781125225, 150.0360791878146, 156.71462272790302, 219.04076039400803, 344.6015953713306, 192.624686493561, 181.6916205037754, 264.9053614264014, 306.3093853137929, 348.2439025951944, 652.9051043023304, 83.97209057700594, 15.725315609998688, 48.837865315671046, 102.46874703423657, 84.8523935628222, 182.47272729271467, 310.64423590573074, 270.675856904865, 255.6838167892357, 40.648638252628004, 39.54251960122697, 178.43220662272037, 53.937850289157154, 64.05198943286362, 119.91268082715854, 90.88030317574317, 198.21080093700073, 84.88973306295189, 240.83196632360136, 81.49356142392348, 101.83125443145192, 94.06005201545773, 323.3791188925952, 87.1729370072915, 132.5100506423346, 62.42761263991274, 115.0965234139791, 63.20159993972945, 186.96815179677628, 172.39192062333694, 174.8218823144632, 266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.6635289902799455, "mean_inference_ms": 6.280271606126161, "mean_action_processing_ms": 2.8638180562346607, "mean_env_wait_ms": 11.61117104332859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013410449028015137, "StateBufferConnector_ms": 0.012766718864440918, "ViewRequirementAgentConnector_ms": 0.3087270259857178}, "num_episodes": 31, "episode_return_max": 736.8193162040834, "episode_return_min": 12.375319177907244, "episode_return_mean": 365.98093176499356, "episodes_this_iter": 31}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.27381239917915, "num_env_steps_trained_throughput_per_sec": 144.27381239917915, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 27848.29, "restore_workers_time_ms": 0.054, "training_step_time_ms": 27848.041, "sample_time_ms": 2798.535, "learn_time_ms": 25020.884, "learn_throughput": 159.866, "synch_weights_time_ms": 24.668}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "01806_00000", "date": "2024-08-22_12-49-09", "timestamp": 1724311149, "time_this_iter_s": 27.792589902877808, "time_total_s": 510.5376937389374, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae49ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 510.5376937389374, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.715384615384615, "ram_util_percent": 82.97435897435896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.510891215384953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.296722919726498, "policy_loss": -0.009665698391291751, "vf_loss": 8.304632802488943, "vf_explained_var": 0.39747370538257415, "kl": 0.008779189477443064, "entropy": 1.2504659565668257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.9939897889182685, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.774278358681492, "policy_loss": -0.008546537196352368, "vf_loss": 7.780764910783717, "vf_explained_var": 0.25830949557521354, "kl": 0.010299983099792843, "entropy": 0.9314342797117889, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 69.9964959793559, "episode_reward_mean": 395.5018199757321, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -88.59233252567468, "predator_policy": 286.3432425135406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [368.69999999999925, 403.2999999999993, 362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-170.4968041225439, 120.66970633121814, -2.645940873554693, 162.06806727011679, 115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041], "policy_predator_policy_reward": [266.3968041225443, 152.13029366878155, 139.29733325633993, 104.58054034709652, 61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.26968913110177, "mean_inference_ms": 6.15010987814556, "mean_action_processing_ms": 2.598102202334881, "mean_env_wait_ms": 11.771018319588752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007809638977050781, "StateBufferConnector_ms": 0.011030912399291992, "ViewRequirementAgentConnector_ms": 0.24945521354675293}, "num_episodes": 35, "episode_return_max": 736.8193162040834, "episode_return_min": 69.9964959793559, "episode_return_mean": 395.5018199757321, "episodes_this_iter": 35}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.74251529199074, "num_env_steps_trained_throughput_per_sec": 143.74251529199074, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 27822.5, "restore_workers_time_ms": 0.084, "training_step_time_ms": 27822.186, "sample_time_ms": 2791.687, "learn_time_ms": 25001.698, "learn_throughput": 159.989, "synch_weights_time_ms": 24.802}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "01806_00000", "date": "2024-08-22_12-49-37", "timestamp": 1724311177, "time_this_iter_s": 27.897107362747192, "time_total_s": 538.4348011016846, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 538.4348011016846, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.44, "ram_util_percent": 81.9725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.185469285268633, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.488245657259824, "policy_loss": -0.01386892801870114, "vf_loss": 8.499938018233689, "vf_explained_var": 0.24219867609165333, "kl": 0.010883033643452026, "entropy": 1.163974191776659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.784113033360274, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.226287208032355, "policy_loss": -0.014059562527293724, "vf_loss": 8.23838944611726, "vf_explained_var": 0.19052451464234205, "kl": 0.009786800729238956, "entropy": 0.8482980774193214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 69.9964959793559, "episode_reward_mean": 394.59044872245, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -94.80443831807881, "predator_policy": 292.0996626793037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178], "policy_predator_policy_reward": [61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.273448511651851, "mean_inference_ms": 6.140046185896541, "mean_action_processing_ms": 2.5800286172675033, "mean_env_wait_ms": 11.786337539026379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007790207862854004, "StateBufferConnector_ms": 0.008261799812316895, "ViewRequirementAgentConnector_ms": 0.2429828643798828}, "num_episodes": 2, "episode_return_max": 736.8193162040834, "episode_return_min": 69.9964959793559, "episode_return_mean": 394.59044872245, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.42825555330901, "num_env_steps_trained_throughput_per_sec": 134.42825555330901, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 27979.181, "restore_workers_time_ms": 0.084, "training_step_time_ms": 27978.82, "sample_time_ms": 3027.897, "learn_time_ms": 24921.192, "learn_throughput": 160.506, "synch_weights_time_ms": 25.557}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "01806_00000", "date": "2024-08-22_12-50-06", "timestamp": 1724311206, "time_this_iter_s": 29.827993869781494, "time_total_s": 568.2627949714661, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 568.2627949714661, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.63333333333333, "ram_util_percent": 83.27142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.369761604985232, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.175203744696562, "policy_loss": -0.01068581614554638, "vf_loss": 8.18377341063565, "vf_explained_var": 0.33626268137068976, "kl": 0.0105807320335535, "entropy": 1.211768083219175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.1059184793442, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.070433707464309, "policy_loss": -0.010111189535794356, "vf_loss": 8.078426674938706, "vf_explained_var": 0.2697614044108719, "kl": 0.010591198403447393, "entropy": 0.8439231548990522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 69.9964959793559, "episode_reward_mean": 394.59044872245, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -94.80443831807881, "predator_policy": 292.0996626793037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178], "policy_predator_policy_reward": [61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.273448511651851, "mean_inference_ms": 6.140046185896541, "mean_action_processing_ms": 2.5800286172675033, "mean_env_wait_ms": 11.786337539026379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007790207862854004, "StateBufferConnector_ms": 0.008261799812316895, "ViewRequirementAgentConnector_ms": 0.2429828643798828}, "num_episodes": 0, "episode_return_max": 736.8193162040834, "episode_return_min": 69.9964959793559, "episode_return_mean": 394.59044872245, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.41393562928556, "num_env_steps_trained_throughput_per_sec": 145.41393562928556, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 27952.888, "restore_workers_time_ms": 0.057, "training_step_time_ms": 27952.584, "sample_time_ms": 3024.541, "learn_time_ms": 24898.812, "learn_throughput": 160.65, "synch_weights_time_ms": 25.14}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "01806_00000", "date": "2024-08-22_12-50-34", "timestamp": 1724311234, "time_this_iter_s": 27.56773090362549, "time_total_s": 595.8305258750916, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4ac5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 595.8305258750916, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.371794871794876, "ram_util_percent": 83.30769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.752523304419544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.837169397949542, "policy_loss": -0.012067505156512929, "vf_loss": 7.847267417806797, "vf_explained_var": 0.4082130468711651, "kl": 0.00984738016890352, "entropy": 1.176837043913584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.704037601291818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.002427718752907, "policy_loss": -0.007609483293164029, "vf_loss": 8.008216246852168, "vf_explained_var": 0.28497571427986107, "kl": 0.00910476062387701, "entropy": 0.8207344021746721, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 69.9964959793559, "episode_reward_mean": 394.59044872245, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -94.80443831807881, "predator_policy": 292.0996626793037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178], "policy_predator_policy_reward": [61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.273448511651851, "mean_inference_ms": 6.140046185896541, "mean_action_processing_ms": 2.5800286172675033, "mean_env_wait_ms": 11.786337539026379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007790207862854004, "StateBufferConnector_ms": 0.008261799812316895, "ViewRequirementAgentConnector_ms": 0.2429828643798828}, "num_episodes": 0, "episode_return_max": 736.8193162040834, "episode_return_min": 69.9964959793559, "episode_return_mean": 394.59044872245, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.1060439156524, "num_env_steps_trained_throughput_per_sec": 147.1060439156524, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 27963.579, "restore_workers_time_ms": 0.057, "training_step_time_ms": 27963.28, "sample_time_ms": 3056.263, "learn_time_ms": 24878.784, "learn_throughput": 160.78, "synch_weights_time_ms": 24.607}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "01806_00000", "date": "2024-08-22_12-51-01", "timestamp": 1724311261, "time_this_iter_s": 27.213932037353516, "time_total_s": 623.0444579124451, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a7e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 623.0444579124451, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.92894736842105, "ram_util_percent": 83.29473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.518088018578828, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.240579470881709, "policy_loss": -0.011885405313125048, "vf_loss": 8.250468635054492, "vf_explained_var": 0.34447209261081835, "kl": 0.009981481967217945, "entropy": 1.128057948243681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.3302497356657, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.310487513567404, "policy_loss": -0.009879478017883326, "vf_loss": 8.31846546496033, "vf_explained_var": 0.23343762506252874, "kl": 0.009507675112900201, "entropy": 0.753456374703261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 69.9964959793559, "episode_reward_mean": 394.59044872245, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 954.297040617986}, "policy_reward_mean": {"prey_policy": -94.80443831807881, "predator_policy": 292.0996626793037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.4021988994809, 598.2999999999994, 291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [115.06641211999674, 24.85461914159252, 239.79539357887455, 301.5019978171611, -104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178], "policy_predator_policy_reward": [61.44359590652173, 161.0375717313712, 50.529014836393706, 6.47359376757073, 167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.273448511651851, "mean_inference_ms": 6.140046185896541, "mean_action_processing_ms": 2.5800286172675033, "mean_env_wait_ms": 11.786337539026379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007790207862854004, "StateBufferConnector_ms": 0.008261799812316895, "ViewRequirementAgentConnector_ms": 0.2429828643798828}, "num_episodes": 0, "episode_return_max": 736.8193162040834, "episode_return_min": 69.9964959793559, "episode_return_mean": 394.59044872245, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.90151742332162, "num_env_steps_trained_throughput_per_sec": 144.90151742332162, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 27970.266, "restore_workers_time_ms": 0.057, "training_step_time_ms": 27969.979, "sample_time_ms": 3052.708, "learn_time_ms": 24888.712, "learn_throughput": 160.715, "synch_weights_time_ms": 24.668}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "01806_00000", "date": "2024-08-22_12-51-29", "timestamp": 1724311289, "time_this_iter_s": 27.646823167800903, "time_total_s": 650.691281080246, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 650.691281080246, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 39.733333333333334, "ram_util_percent": 82.54871794871796}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.458366312551751, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.976179211732572, "policy_loss": -0.012292728276933155, "vf_loss": 7.986419101997658, "vf_explained_var": 0.3703470237671383, "kl": 0.010263983177750435, "entropy": 1.1008147293297703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.976400298164004, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.367439797820238, "policy_loss": -0.00898775572903336, "vf_loss": 8.374756724746138, "vf_explained_var": 0.26778579079915604, "kl": 0.00835398970832112, "entropy": 0.7180476642159558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 47.58703540797707, "episode_reward_mean": 387.7312197191037, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -927.0611309976158, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 1118.1217020451886}, "policy_reward_mean": {"prey_policy": -112.97909469286384, "predator_policy": 306.8447045524156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.29999999999984, 155.8335405127595, 365.30000000000234, 306.9526827763238, 455.9009364336931, 264.2643596706141, 465.3195801714584, 619.4, 83.19999999999993, 421.91289871245016, 650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-104.45406949502876, 81.39710896517126, 102.19717740368495, -30.60674740502011, 207.68821355191244, -55.4535065609486, 134.1874206749907, -342.54931937602646, 268.4300130049217, -300.6467442944544, -245.3839593836563, -103.85302066484564, -80.76325898575746, -66.25366581901969, 293.8274015520589, 267.68543282119344, 11.789963454283319, -253.41327666657034, -179.73390385350086, -297.5054345096671, -10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254], "policy_predator_policy_reward": [167.55406949502853, 146.80289103482812, 13.114023650630635, 71.12908686346556, 20.254201548685874, 192.81109146034987, 307.92433447294474, 207.39024700441456, 136.58706590961188, 351.5306018136182, 47.89233448436897, 565.6090052347467, 11.076050321717332, 601.2604546545182, 43.23920261847992, 14.647963008267755, 299.6265378624896, 25.19677534979753, 450.31238751658566, 448.83984955903315, 266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.253491175532449, "mean_inference_ms": 6.134370077289563, "mean_action_processing_ms": 2.5617547856838985, "mean_env_wait_ms": 11.792347965303847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007741451263427734, "StateBufferConnector_ms": 0.007898092269897461, "ViewRequirementAgentConnector_ms": 0.24016356468200684}, "num_episodes": 2, "episode_return_max": 736.8193162040834, "episode_return_min": 47.58703540797707, "episode_return_mean": 387.7312197191037, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.49397074491065, "num_env_steps_trained_throughput_per_sec": 151.49397074491065, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 27815.521, "restore_workers_time_ms": 0.056, "training_step_time_ms": 27815.236, "sample_time_ms": 3018.631, "learn_time_ms": 24768.637, "learn_throughput": 161.495, "synch_weights_time_ms": 24.284}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "01806_00000", "date": "2024-08-22_12-51-55", "timestamp": 1724311315, "time_this_iter_s": 26.415645837783813, "time_total_s": 677.1069269180298, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 677.1069269180298, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.810526315789474, "ram_util_percent": 82.77894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.580573350033433, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.647302418663388, "policy_loss": -0.011351017504634839, "vf_loss": 7.656805902814108, "vf_explained_var": 0.3718477194902127, "kl": 0.009237743277969971, "entropy": 1.090408932973468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999904}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.659720554427494, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.138810224886294, "policy_loss": -0.010778821471378838, "vf_loss": 8.147869240291534, "vf_explained_var": 0.26100018510112055, "kl": 0.008599208015702152, "entropy": 0.6609139747720547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999904}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": 0.02626320710225638, "episode_reward_mean": 374.0705455408112, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1168.4397573512313, "predator_policy": 0.9297539923588767}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 1168.4610279454869}, "policy_reward_mean": {"prey_policy": -173.86482814478194, "predator_policy": 360.9001009151875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [650.7479145524729, 510.5000000000004, 487.3798989726114, 565.9525958432647, 400.5000000000026, 296.74289352005354, 401.97027704960595, 544.3477799392801, 352.1703952343017, 438.03114132110977, 443.2217063821059, 391.12498063138173, 346.5780946007193, 469.72800157071754, 538.8645382300978, 230.65781572622478, 424.39289768514857, 441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-10.488472367582062, 357.86794011802436, 100.03383239198136, 385.4702460076411, -280.3787430226491, 148.70901272995195, 277.36872517780665, -9.848013030471236, 313.44266939494236, 33.823721976643256, -456.3186777263474, 108.16479267971228, -317.07190111465786, 34.83362409340289, 3.9363746909248505, 195.18969101682782, -250.72444404742348, -76.5106930352223, -111.43771169955906, -73.28109896542625, 305.3680710905812, -128.86389655051178, -22.502067806868908, -10.966258202622614, 82.7330525883576, -324.3578095259597, -162.290586837983, 215.97134217152097, 371.5010228315293, -238.0435941014574, 104.63723309704615, -604.1342294117932, -372.4670699571568, 27.25689996172941, 63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444], "policy_predator_policy_reward": [266.3953993474499, 36.97304745458073, 24.066167608018706, 0.9297539923588767, 176.47012486114448, 442.57950440416425, 123.68129188255682, 174.7505918133722, 47.55733060505758, 5.676278023356952, 212.820209113439, 432.0765694532529, 332.2321109407917, 351.9764431300703, 272.77133131869215, 72.45038291283463, 308.5724890238647, 370.8330432930814, 123.48260525726754, 499.26734672882725, 89.36863271478454, 177.34889912725217, 42.860859217241526, 381.73244742363096, 209.24747454186752, 378.95537699645604, 20.783701157472915, 395.26354507970643, 269.513443566957, 135.89366593306823, 507.35073659868135, 222.80407544229146, 501.34564843744397, 268.2574192431321, 33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.1344805714816975, "mean_inference_ms": 6.110620017460111, "mean_action_processing_ms": 2.5216645415245473, "mean_env_wait_ms": 11.813191635300573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075827836990356445, "StateBufferConnector_ms": 0.008479118347167969, "ViewRequirementAgentConnector_ms": 0.22478210926055908}, "num_episodes": 10, "episode_return_max": 736.8193162040834, "episode_return_min": 0.02626320710225638, "episode_return_mean": 374.0705455408112, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.7700149265064, "num_env_steps_trained_throughput_per_sec": 155.7700149265064, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 27596.102, "restore_workers_time_ms": 0.057, "training_step_time_ms": 27595.824, "sample_time_ms": 2944.03, "learn_time_ms": 24625.447, "learn_throughput": 162.434, "synch_weights_time_ms": 22.353}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "01806_00000", "date": "2024-08-22_12-52-21", "timestamp": 1724311341, "time_this_iter_s": 25.718914031982422, "time_total_s": 702.8258409500122, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 702.8258409500122, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 32.46388888888889, "ram_util_percent": 81.95277777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.824164498293841, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.095637308352838, "policy_loss": -0.015088867688324873, "vf_loss": 8.10860255004237, "vf_explained_var": 0.30163101620144317, "kl": 0.01061804868556835, "entropy": 1.0789736995621333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.054304615656536, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.12726054014983, "policy_loss": -0.009255483259678518, "vf_loss": 8.134737616241294, "vf_explained_var": 0.2813689105094425, "kl": 0.00889207044315756, "entropy": 0.6758736737190731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 736.8193162040834, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 329.5727730242103, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1315.5473517308105, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.5615655831421, "predator_policy": 1315.8473517308103}, "policy_reward_mean": {"prey_policy": -298.6997102598514, "predator_policy": 463.48609677195634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [441.11738529797987, 367.67037257276047, 239.49562963247604, 407.4999999999991, 301.5344084179461, 327.00481400201346, 179.44505931933693, 446.4000000000022, 649.9092943137431, 256.228741499489, 388.80901993534087, 83.30329415618743, 258.0000000000001, 108.359897938617, 284.00415174882875, 435.4000000000028, 277.81951413891267, 534.9244971296463, 458.0691281034227, 630.6320589870727, 736.8193162040834, 344.7380153027344, 286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [63.8395168208121, -100.4146212308328, -372.0541768471787, -231.58114768342318, -255.44994587129918, -438.01675631140006, -300.882378119497, 324.45336112138824, -38.17031327527455, -370.7690928578201, -789.7817243700068, -14.038741415874144, -76.35539344651059, -378.2723909041883, 384.5348630263873, 40.47599211082343, 253.6307006843988, 32.794790335311575, -298.7635712005715, -400.1541536593011, -549.2406742761916, 165.9503219901593, -129.89409413004276, 0.8213197084357912, 229.9525850481486, -633.3550210759039, -23.592218818210444, -889.7323262909666, -103.16257767246299, -664.6676600864746, 394.5615655831421, -8.452067941870332, 172.8946172038758, -422.6737196920403, 48.098680456734485, 329.2157605818242, -384.00962284045863, 63.56576528768437, 254.6758983905445, 158.82149367383164, 356.5805849629075, 292.2783129654342, -927.0611309976158, 267.4365691572384, -170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292], "policy_predator_policy_reward": [33.99235505956078, 443.7001346484384, 89.78396163349862, 881.5217354698633, 256.7614590769234, 676.2008727382525, 333.68237811949695, 50.24663887861177, 341.41884068046016, 369.0549738705798, 842.2381437280831, 288.587136059811, 275.0554130041874, 359.01743066584544, 5.065136973612674, 16.32400788917656, 107.17859362934426, 256.30520966468845, 386.716161078822, 568.430305280539, 370.19785198501984, 401.90152023635125, 56.973662731845664, 155.40240584594918, 6.647414951851388, 654.7550210759039, 166.74452544569394, 854.9399176021012, 286.59018132980157, 765.2442081779654, 2.438434416857878, 46.85206794187074, 65.05906375824122, 462.53955286883553, 7.445002302058586, 150.16505378902946, 425.0778333896875, 353.4351522665096, 147.8650195449571, 69.26964737773919, 68.25207767126435, 19.70834060447736, 954.297040617986, 50.0655365251259, 242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.099408101315612, "mean_inference_ms": 6.045639501131061, "mean_action_processing_ms": 2.513847183019367, "mean_env_wait_ms": 11.792648378371325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076062679290771484, "StateBufferConnector_ms": 0.008213639259338379, "ViewRequirementAgentConnector_ms": 0.17733097076416016}, "num_episodes": 17, "episode_return_max": 736.8193162040834, "episode_return_min": -1.5750526858544351, "episode_return_mean": 329.5727730242103, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.395331495724, "num_env_steps_trained_throughput_per_sec": 154.395331495724, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 27354.59, "restore_workers_time_ms": 0.06, "training_step_time_ms": 27354.268, "sample_time_ms": 2845.741, "learn_time_ms": 24481.316, "learn_throughput": 163.39, "synch_weights_time_ms": 23.247}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "01806_00000", "date": "2024-08-22_12-52-47", "timestamp": 1724311367, "time_this_iter_s": 25.96268916130066, "time_total_s": 728.7885301113129, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab30d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.7885301113129, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 34.278378378378385, "ram_util_percent": 82.73783783783783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.44437731687354, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.920660730896803, "policy_loss": -0.013240353333660297, "vf_loss": 7.931828567969105, "vf_explained_var": 0.36988028584333954, "kl": 0.010362578113932932, "entropy": 1.0784868005722288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.896453556560335, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.11544207719268, "policy_loss": -0.009706459809883088, "vf_loss": 8.123653205488093, "vf_explained_var": 0.29329123566390347, "kl": 0.007476615800063998, "entropy": 0.6327114869047095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 729.6, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 283.781518877004, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.8114326250303, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -444.8334169276015, "predator_policy": 586.7241763661035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.6473395632377, 211.02659949514992, 82.80032847569765, 308.38542545249993, 415.31527057563153, 311.7191802673034, 526.4399047231918, 517.6827141310097, 672.9000000000001, 342.2095725599439, 351.18826198097435, 435.2775038173424, 352.0952255523671, 353.5666901408391, 673.9474188159746, 471.1140324001242, 437.96888408872985, 351.32114847508296, 467.364679595288, 439.91262998101786, 334.11735319379966, 218.84799276608294, 375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-170.23077216869845, -382.4011140455453, -334.2445714148205, -141.1000989434754, -160.38211940443117, -216.2766174918869, -52.92778451322687, -389.1679859346076, -262.6110687478967, 220.3840376962612, -339.9764120211294, -456.66463924378405, 188.1088757504892, -660.3218198421584, 12.463979299003043, -503.1824172020049, 347.505681680753, 249.93063658702644, -73.81484327467666, -444.6491233128461, 209.1092213992264, -444.69422858308843, -122.66475031915621, 145.34857510654538, -330.20843288980524, -190.63528380286368, 134.00809279052592, 27.489982368891795, 183.521907294952, 365.01858100360255, 122.70063270172983, -182.30085853354322, 196.28530573984432, -238.3653871669934, -511.1225651526863, -133.30112011887815, -179.05786391252332, -127.22230947430543, -718.7916381971305, 26.63613699102703, -20.86924858660745, -911.3897988836633, -384.2985262681284, -693.0060428918569, -130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693], "policy_predator_policy_reward": [242.91272384030185, 596.3665019371788, 333.40539403351954, 352.9658758199272, 308.60062472096104, 150.85844065105314, 448.8780442456148, 301.6031516547199, 240.14622660501885, 217.3960750222482, 559.5018388938511, 548.858392638365, 529.5758780737959, 469.07697074106545, 315.42843968023857, 692.9727123537726, 22.99431831924702, 52.469363412973536, 772.325599961979, 88.34793918548714, 175.90829961329268, 410.8649695515432, 326.0961001510531, 86.49757887889764, 485.96941677071896, 386.96952547431596, 96.68606747805661, 95.38254750336415, 48.64588398709163, 76.7610465303284, 40.3073720092902, 490.4068862226482, 47.56858859576804, 432.4803769201112, 519.0079614914271, 476.7368722552198, 423.9737435494448, 349.6711094326722, 527.3274174694479, 604.7407137176737, 333.21474211752707, 933.1616585465432, 507.5145422443246, 788.6380196817431, 311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.011051084654374, "mean_inference_ms": 5.9690295681055785, "mean_action_processing_ms": 2.5525619213616304, "mean_env_wait_ms": 11.815697823695935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007413744926452637, "StateBufferConnector_ms": 0.005529999732971191, "ViewRequirementAgentConnector_ms": 0.1645907163619995}, "num_episodes": 22, "episode_return_max": 729.6, "episode_return_min": -1.5750526858544351, "episode_return_mean": 283.781518877004, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.9961966016726, "num_env_steps_trained_throughput_per_sec": 151.9961966016726, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 27191.932, "restore_workers_time_ms": 0.061, "training_step_time_ms": 27191.632, "sample_time_ms": 2815.07, "learn_time_ms": 24350.819, "learn_throughput": 164.266, "synch_weights_time_ms": 21.958}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "01806_00000", "date": "2024-08-22_12-53-14", "timestamp": 1724311394, "time_this_iter_s": 26.37357473373413, "time_total_s": 755.162104845047, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 755.162104845047, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 34.18108108108108, "ram_util_percent": 83.12702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.33879433826164, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.615754669431656, "policy_loss": -0.009116605368920814, "vf_loss": 7.622703920596491, "vf_explained_var": 0.4003955085441549, "kl": 0.010836793514825995, "entropy": 1.0073588943355298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.162715368800693, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.794282826418599, "policy_loss": -0.008104372003840076, "vf_loss": 7.800851064005856, "vf_explained_var": 0.31948641235866243, "kl": 0.007680615756867661, "entropy": 0.63397101945978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 493.2625000000007}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 729.6, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 237.29712271363408, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.8114326250303, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -565.129658651735, "predator_policy": 683.778220008552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.12034863328125, 416.6779495574705, 205.32294083557386, 327.9088775922378, 700.9388815338697, 600.1780157904436, 526.6315943654604, 719.5, 604.3568621615008, 700.9, 116.08521912695971, 368.54262930641437, 309.45330414234553, 729.6, 362.57824037269694, 364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-130.66659828630944, -95.83383427176041, -277.8242804818761, -233.19342185173363, -505.945201179865, -120.16752134061625, 30.873041914555536, -787.7144805331715, 331.83992981124095, 168.3077059115319, 159.69065096234579, 353.5841585197119, 68.11652974348485, 1.5506335248643097, 321.8556073879233, 295.12360687614165, -274.7416998710449, 276.55774188695614, 245.2741360747405, 333.59249219699944, -137.86994812901605, -98.89850920817938, -712.1877615544893, 272.99932303907656, -714.2157494693575, -5.656444980210738, 271.2152753715362, 303.931461459905, -162.48732107168144, -187.23344240561735, 54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615], "policy_predator_policy_reward": [311.9240296234321, 289.69675156791544, 869.990065509127, 57.70558638195255, 555.2433737652491, 276.19228959080436, 320.1074003172296, 764.6429158936238, 41.09895172262854, 159.69229408846812, 28.444792297953143, 58.45841401043339, 104.05181646881097, 352.91261462830045, 36.64439261207665, 65.87639312385838, 47.36636350491231, 555.1744566406774, 90.64784261009663, 31.38552911816341, 9.79912955804553, 343.0545469061076, 36.93653640266396, 770.7945314191637, 414.8012960215877, 614.5242025703262, 87.38472462846374, 67.068538540095, 273.5220247040289, 438.7769791459667, 313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.969928371615401, "mean_inference_ms": 5.908789991709418, "mean_action_processing_ms": 2.5226827464672543, "mean_env_wait_ms": 11.793647452263777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00636136531829834, "StateBufferConnector_ms": 0.008534550666809082, "ViewRequirementAgentConnector_ms": 0.1451432704925537}, "num_episodes": 22, "episode_return_max": 729.6, "episode_return_min": -1.5750526858544351, "episode_return_mean": 237.29712271363408, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.41665059120993, "num_env_steps_trained_throughput_per_sec": 156.41665059120993, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 26976.698, "restore_workers_time_ms": 0.06, "training_step_time_ms": 26976.414, "sample_time_ms": 2747.471, "learn_time_ms": 24203.766, "learn_throughput": 165.264, "synch_weights_time_ms": 21.424}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "01806_00000", "date": "2024-08-22_12-53-39", "timestamp": 1724311419, "time_this_iter_s": 25.64286518096924, "time_total_s": 780.8049700260162, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 780.8049700260162, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 32.0611111111111, "ram_util_percent": 82.53888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.754552810532706, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.75916722464183, "policy_loss": -0.010523637423597316, "vf_loss": 7.767732818038375, "vf_explained_var": 0.34027993231223375, "kl": 0.009790287648263589, "entropy": 0.9879635882756067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.582199213113734, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.948283406918642, "policy_loss": -0.010018278727869666, "vf_loss": 7.956528136843727, "vf_explained_var": 0.3794923834699802, "kl": 0.008867821276739792, "entropy": 0.6155466357236186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 201.57191338020107, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -666.9870752751792, "predator_policy": 767.77303196528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.95699275846283, 123.13642245823975, 69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [54.384560788763885, -223.78495083213895, 36.56792288688548, -836.569715591083, -212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121], "policy_predator_policy_reward": [313.9375596795962, 220.41982312224218, 812.3000329339399, 110.83818222849902, 39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.916702057722001, "mean_inference_ms": 5.863453172656204, "mean_action_processing_ms": 2.528061813959626, "mean_env_wait_ms": 11.793169862330428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006288051605224609, "StateBufferConnector_ms": 0.008152127265930176, "ViewRequirementAgentConnector_ms": 0.14994025230407715}, "num_episodes": 15, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 201.57191338020107, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.7124298908511, "num_env_steps_trained_throughput_per_sec": 153.7124298908511, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 26796.173, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26795.958, "sample_time_ms": 2699.272, "learn_time_ms": 24071.998, "learn_throughput": 166.168, "synch_weights_time_ms": 20.944}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "01806_00000", "date": "2024-08-22_12-54-05", "timestamp": 1724311445, "time_this_iter_s": 26.071949005126953, "time_total_s": 806.8769190311432, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa4310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 806.8769190311432, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.87027027027027, "ram_util_percent": 82.82702702702704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.133790048089608, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.982005813639, "policy_loss": -0.011045484387724803, "vf_loss": 7.99114728604675, "vf_explained_var": 0.26626188149527896, "kl": 0.00952008139470188, "entropy": 1.025207377867724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.967608725330818, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.184295789526884, "policy_loss": -0.006604706293474587, "vf_loss": 8.189346185815397, "vf_explained_var": 0.2681637372920122, "kl": 0.007771506098163112, "entropy": 0.5702189504784881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000004}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 198.73069415676804, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -680.0649739704382, "predator_policy": 779.4303210488225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943], "policy_predator_policy_reward": [39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.911575247835668, "mean_inference_ms": 5.854530447484248, "mean_action_processing_ms": 2.523023091494058, "mean_env_wait_ms": 11.80209590737244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006268858909606934, "StateBufferConnector_ms": 0.008140921592712402, "ViewRequirementAgentConnector_ms": 0.14999032020568848}, "num_episodes": 2, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 198.73069415676804, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.39808866974153, "num_env_steps_trained_throughput_per_sec": 156.39808866974153, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 26378.183, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26378.02, "sample_time_ms": 2411.22, "learn_time_ms": 23943.59, "learn_throughput": 167.059, "synch_weights_time_ms": 19.898}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "01806_00000", "date": "2024-08-22_12-54-31", "timestamp": 1724311471, "time_this_iter_s": 25.599101305007935, "time_total_s": 832.4760203361511, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a7b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 832.4760203361511, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 32.92222222222222, "ram_util_percent": 82.64166666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.027893118505125, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.237249013103506, "policy_loss": -0.01442250855237482, "vf_loss": 8.249266100686693, "vf_explained_var": 0.36748847418991976, "kl": 0.012027017158214692, "entropy": 0.9781305119474099, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.26854097414269, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.440735905763333, "policy_loss": -0.009340040950922581, "vf_loss": 8.448475481467272, "vf_explained_var": 0.2858055078163349, "kl": 0.008002387992200002, "entropy": 0.5192453380299624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 198.73069415676804, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -680.0649739704382, "predator_policy": 779.4303210488225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.9964959793559, 123.92799809645703, 582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-212.19759509848262, -374.061520097276, -670.3180633877851, -796.5605210808393, 311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943], "policy_predator_policy_reward": [39.30697323878671, 616.9486379363328, 848.2393929239922, 742.5671896410897, 407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.911575247835668, "mean_inference_ms": 5.854530447484248, "mean_action_processing_ms": 2.523023091494058, "mean_env_wait_ms": 11.80209590737244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006268858909606934, "StateBufferConnector_ms": 0.008140921592712402, "ViewRequirementAgentConnector_ms": 0.14999032020568848}, "num_episodes": 0, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 198.73069415676804, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.96372178262584, "num_env_steps_trained_throughput_per_sec": 157.96372178262584, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 26159.64, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26159.463, "sample_time_ms": 2369.882, "learn_time_ms": 23765.644, "learn_throughput": 168.31, "synch_weights_time_ms": 20.538}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "01806_00000", "date": "2024-08-22_12-54-56", "timestamp": 1724311496, "time_this_iter_s": 25.37565588951111, "time_total_s": 857.8516762256622, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 857.8516762256622, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.71388888888888, "ram_util_percent": 82.40555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.21958550700435, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.0390183569893, "policy_loss": -0.009543361570242615, "vf_loss": 8.046332458718114, "vf_explained_var": 0.4304622006164026, "kl": 0.011146300140196684, "entropy": 0.9668075316166752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.267876703146273, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.423225662695668, "policy_loss": -0.00951493711200932, "vf_loss": 8.431225580891605, "vf_explained_var": 0.24807454688208444, "kl": 0.007575108608595593, "entropy": 0.5151258878922337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 201.0598177326332, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -685.54122847714, "predator_policy": 786.0711373434566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [582.2418695346378, 467.1082297391286, 437.87416170329027, 540.4523304540247, 313.4627502435887, 89.2000000000003, 377.672757176232, 303.19011749556637, 227.19226315687348, 47.58703540797707, 310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [311.4126719455324, -220.38420142058803, -224.55042957050344, 138.16427664227794, 288.7368907840265, -409.74561538073993, -162.699396907464, 223.41094057270323, -411.13453122194704, -111.88675233581151, -251.10866312918543, -256.7095352000041, -154.30567767885324, -303.2514546473874, -535.708266385933, -139.5607311634178, -763.4391885927278, -765.1367765375215, -586.4060804527022, -838.7308067164254, -337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903], "policy_predator_policy_reward": [407.4524977596587, 83.76090125003489, 432.8516714922133, 120.64271117514058, 82.8557724073936, 476.0271138926096, 390.61562269879306, 89.12516408999257, 640.8595985975982, 195.62443520374885, 280.5086631291835, 316.5095352000032, 502.22213392336715, 333.0077555791043, 491.24910273399666, 487.210012310921, 637.6465262419326, 1118.1217020451886, 902.3687249729967, 570.3551976041078, 645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.9052023499085395, "mean_inference_ms": 5.848576865909033, "mean_action_processing_ms": 2.5154130987283123, "mean_env_wait_ms": 11.808400140449415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062770843505859375, "StateBufferConnector_ms": 0.00813281536102295, "ViewRequirementAgentConnector_ms": 0.14347660541534424}, "num_episodes": 2, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 201.0598177326332, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.25967770448992, "num_env_steps_trained_throughput_per_sec": 149.25967770448992, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 26120.41, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26120.227, "sample_time_ms": 2321.528, "learn_time_ms": 23773.602, "learn_throughput": 168.254, "synch_weights_time_ms": 21.438}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "01806_00000", "date": "2024-08-22_12-55-23", "timestamp": 1724311523, "time_this_iter_s": 26.841793060302734, "time_total_s": 884.693469285965, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 884.693469285965, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.36842105263159, "ram_util_percent": 82.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.678035367859735, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.998121241413096, "policy_loss": -0.012479240123044561, "vf_loss": 8.008546895829458, "vf_explained_var": 0.45261894205890635, "kl": 0.010267966366791852, "entropy": 0.9331414936711548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.283295167943157, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.46935318285826, "policy_loss": -0.0070923883613277835, "vf_loss": 8.475213401027457, "vf_explained_var": 0.3206900090136856, "kl": 0.006160803488578903, "entropy": 0.5011620196085128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 182.61686482056655, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -732.8472812311619, "predator_policy": 824.1557136414452}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.9374805254005, 280.59014257110965, 565.1021074674875, 0.02626320710225638, 30.828805451075695, 65.79999999999991, 283.10837714426606, 34.33467909718149, 239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-337.05297644434853, -612.7731298791907, -53.41062916022879, -779.355633957877, -696.4484681023457, 17.18499365548712, -1168.4397573512313, -1042.1238126013398, -741.3752106089545, -1004.231976609235, -588.9225739463408, -779.0085229866953, -708.7737595791413, -301.86256452992507, -862.3703178345277, -1001.1718235264054, -1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865], "policy_predator_policy_reward": [645.5726307758965, 615.190956073049, 397.0004309350678, 716.3559747541461, 451.5904187718613, 792.7751631424842, 1168.4610279454869, 1042.1288052141865, 786.9148123986704, 989.5211802705965, 606.8225739463438, 826.9085229866954, 458.58547764107084, 835.1592236122613, 860.5419033409024, 1037.3349171172124, 343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.785321573233102, "mean_inference_ms": 5.812608265573382, "mean_action_processing_ms": 2.533863923143223, "mean_env_wait_ms": 11.82495202432294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006716012954711914, "StateBufferConnector_ms": 0.009257912635803223, "ViewRequirementAgentConnector_ms": 0.15755021572113037}, "num_episodes": 10, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 182.61686482056655, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.35395461396203, "num_env_steps_trained_throughput_per_sec": 140.35395461396203, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 26209.851, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26209.643, "sample_time_ms": 2373.4, "learn_time_ms": 23811.967, "learn_throughput": 167.983, "synch_weights_time_ms": 21.096}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "01806_00000", "date": "2024-08-22_12-55-52", "timestamp": 1724311552, "time_this_iter_s": 28.551592111587524, "time_total_s": 913.2450613975525, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4be280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 913.2450613975525, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 46.2875, "ram_util_percent": 82.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.663009280124038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.05808246652916, "policy_loss": -0.012861682829402742, "vf_loss": 8.06894926949153, "vf_explained_var": 0.4508459433676705, "kl": 0.009974543405844579, "entropy": 0.9130818212473834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.41808162063518, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.023874121368246, "policy_loss": -0.00969673890285391, "vf_loss": 8.031981466686915, "vf_explained_var": 0.33285934817854057, "kl": 0.007946895906287763, "entropy": 0.5248838195409724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": -1.5750526858544351, "episode_reward_mean": 186.9402782820731, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -735.1267133721728, "predator_policy": 828.5968525132095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.2349765253625, 253.3537484590703, -1.5750526858544351, 365.9954771857351, 226.87075607484076, 181.61758990922118, 434.9663069175493, 506.7431264954094, 229.91462534819405, 472.7748301545912, 39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1005.1412285310855, -202.47436762086022, -215.77586139651464, -787.0332449591444, -1110.2057146038906, -1021.9913192123931, -444.93798436392336, -95.14227456162816, -816.482680816157, -827.6023831130899, -810.2615949193064, -605.4177467619801, -904.6051145604367, -131.31165860943827, -1066.332765444922, 389.8114326250303, -794.1743110208072, -774.3783117893091, -939.6906923915527, 333.01032531807573, -1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936], "policy_predator_policy_reward": [343.9145550628684, 1102.93601761444, 588.5731710575719, 667.5896837571585, 1110.406638311222, 1020.2153428192071, 659.288223418697, 246.78751269258302, 912.2094763129825, 958.7463436911052, 923.2724060914743, 674.0245254990357, 941.7528253077471, 529.1302547796766, 1057.5452237574566, 125.71923555784512, 1031.3834557814807, 767.0837923768293, 937.6772204911041, 141.77797673696122, 1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.767412687843179, "mean_inference_ms": 5.7836838254634095, "mean_action_processing_ms": 2.496032247240165, "mean_env_wait_ms": 11.832423240644475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006690382957458496, "StateBufferConnector_ms": 0.009106278419494629, "ViewRequirementAgentConnector_ms": 0.15367603302001953}, "num_episodes": 8, "episode_return_max": 726.7114018589236, "episode_return_min": -1.5750526858544351, "episode_return_mean": 186.9402782820731, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.38169253435407, "num_env_steps_trained_throughput_per_sec": 154.38169253435407, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 26160.463, "restore_workers_time_ms": 0.031, "training_step_time_ms": 26160.254, "sample_time_ms": 2364.034, "learn_time_ms": 23771.835, "learn_throughput": 168.266, "synch_weights_time_ms": 21.094}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "01806_00000", "date": "2024-08-22_12-56-18", "timestamp": 1724311578, "time_this_iter_s": 25.95728302001953, "time_total_s": 939.202344417572, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 939.202344417572, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.19729729729731, "ram_util_percent": 82.72702702702703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.55989424185778, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.736386272894642, "policy_loss": -0.010196584099460216, "vf_loss": 7.744910129668221, "vf_explained_var": 0.5444825405796999, "kl": 0.0083634957207968, "entropy": 0.8707938997833817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.598625780539537, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.766911285138004, "policy_loss": -0.006377553329778411, "vf_loss": 7.772142774592001, "vf_explained_var": 0.39996611889077244, "kl": 0.0057304437681244165, "entropy": 0.5280762794471923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": 0.2463091348511135, "episode_reward_mean": 182.22128971189355, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -743.2297546801922, "predator_policy": 834.3403995361389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.32206407007732, 15.262836538989834, 80.19999999999985, 25.500000000000004, 47.58632882202592, 0.2463091348511135, 319.29613376539925, 89.39169601212083, 9.020651855850222, 1.4338852116574972, 4.000000000000005, 8.310292172546998, 91.69785342252293, 34.84857879784433, 80.33139567595269, 179.27837144499844, 92.98568740887961, 243.4260780873234, 57.01161938964471, 483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1189.243184416601, -827.2700387443962, -1186.9876760616253, -1118.6080713357808, -298.17196191753504, 23.8619584983576, -1102.0918676859858, -1214.7850417271475, -879.7575472048221, -1208.3327319018163, -1134.0086221738702, -1315.5473517308105, -81.05053367365758, -908.0528662697104, -464.8001281087098, -675.7081502298848, -998.3096314976899, -1151.7771979915292, -1203.525626093536, -929.3607056733742, -1217.5910956250564, -1199.324277792532, -1140.772169660593, -1002.1568347333564, -753.4571511231217, -1137.151259697651, -1001.014192683581, -1051.8230603065865, -840.6238008078329, -731.1948488018377, -704.1905364748303, -202.74472873793513, -762.8911395680874, -642.2118502513553, -628.357747606617, -1083.7968009249005, -833.2916614901521, -849.6335275207177, -262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436], "policy_predator_policy_reward": [1191.541616634329, 864.2936705967454, 1184.4240963803175, 1136.4344875560787, 0.0, 354.5100034191774, 1127.091867685986, 1215.2850417271475, 956.2787126138768, 1179.3978953147875, 1133.9549313087214, 1315.8473517308103, 719.676708737712, 588.7228249710535, 715.4834914860102, 514.4164828647142, 1001.8302833535404, 1157.277197991529, 1200.9846671837072, 933.3355497948612, 1217.5910956250564, 1203.324277792532, 1140.3828289321925, 1010.8564676343038, 871.217556447985, 1111.0887077953123, 1015.5127549535889, 1072.1730768344241, 804.6714129642972, 847.478632321326, 698.622849514059, 387.5907871437055, 843.5584144743516, 654.5302627539743, 945.7977898830443, 1009.7828367357946, 773.9958394798689, 965.940968920647, 849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.724169373893044, "mean_inference_ms": 5.74455679745017, "mean_action_processing_ms": 2.4859394038813765, "mean_env_wait_ms": 11.855265024910357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00831449031829834, "StateBufferConnector_ms": 0.009222269058227539, "ViewRequirementAgentConnector_ms": 0.17356514930725098}, "num_episodes": 10, "episode_return_max": 726.7114018589236, "episode_return_min": 0.2463091348511135, "episode_return_mean": 182.22128971189355, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.96053574174005, "num_env_steps_trained_throughput_per_sec": 148.96053574174005, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 26277.85, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26277.65, "sample_time_ms": 2443.737, "learn_time_ms": 23809.708, "learn_throughput": 167.999, "synch_weights_time_ms": 20.969}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "01806_00000", "date": "2024-08-22_12-56-45", "timestamp": 1724311605, "time_this_iter_s": 26.9074969291687, "time_total_s": 966.1098413467407, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 966.1098413467407, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 36.21025641025642, "ram_util_percent": 82.63589743589745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.954172388586418, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.972010137668993, "policy_loss": -0.011449392031503733, "vf_loss": 7.981837696499294, "vf_explained_var": 0.4804634202094305, "kl": 0.008109197799835807, "entropy": 0.8125015349615188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.047043875537852, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.24194041610395, "policy_loss": -0.008016442087917495, "vf_loss": 8.248748791407024, "vf_explained_var": 0.2702072923776334, "kl": 0.006040549142379807, "entropy": 0.44571789626091246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": 0.19999999999999796, "episode_reward_mean": 205.04664263740347, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1392.8944604556057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1395.7944604556058}, "policy_reward_mean": {"prey_policy": -705.9728077762288, "predator_policy": 808.4961290949307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.5681223333636, 28.62354393680205, 45.87651342961167, 322.88027515849654, 313.7171843978914, 384.65903409911, 102.619105841861, 607.1733350951608, 252.95271835750276, 4.170891054928742, 140.3080100896928, 98.18668857418189, 203.29389263965734, 250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-262.8492867284856, -1077.2336207626088, -726.6810302366304, -1105.7550596580606, -1107.6545415160117, 35.488744768059924, -104.00728180243449, -1242.5740529963389, 299.16282207921006, -948.962933283147, -912.4674283711818, -0.802030903853765, -228.45407827737256, -996.4621593791198, -138.05974407460894, -768.6066048002091, -1008.5705668451902, -235.1293777218635, -1392.8944604556057, -1308.4839664828373, -843.1035028249877, -1187.622020531369, 40.0000000000003, -1055.8689590780693, -565.6383439919805, -223.0985818999004, -1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833], "policy_predator_policy_reward": [849.2592859236781, 974.3917439007806, 756.3502567634504, 1104.709377068043, 1110.6545415160117, 7.387768661551634, 568.2274973035411, 1101.2341126537303, 1.8543623186812073, 961.6629332831469, 831.3446408202061, 466.58385255393677, 324.82482590147634, 1002.7105175968762, 989.3087386727735, 524.5309452972058, 874.7181464002954, 621.9345165242602, 1395.7944604556058, 1309.754857537766, 994.7379275527833, 1176.2956058932664, 18.68668857418284, 1095.3689590780698, 422.57121190679356, 569.4596066247445, 278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.659418141231328, "mean_inference_ms": 5.689441858948633, "mean_action_processing_ms": 2.438291463109428, "mean_env_wait_ms": 11.895504853455998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01142895221710205, "StateBufferConnector_ms": 0.014191031455993652, "ViewRequirementAgentConnector_ms": 0.20510828495025635}, "num_episodes": 19, "episode_return_max": 726.7114018589236, "episode_return_min": 0.19999999999999796, "episode_return_mean": 205.04664263740347, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.06319555191195, "num_env_steps_trained_throughput_per_sec": 152.06319555191195, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 26317.584, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26317.429, "sample_time_ms": 2488.619, "learn_time_ms": 23804.833, "learn_throughput": 168.033, "synch_weights_time_ms": 20.11}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "01806_00000", "date": "2024-08-22_12-57-11", "timestamp": 1724311631, "time_this_iter_s": 26.368287801742554, "time_total_s": 992.4781291484833, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4a6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 992.4781291484833, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 41.14594594594595, "ram_util_percent": 83.25675675675677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.754708266384387, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.238459759162216, "policy_loss": -0.010428630116656817, "vf_loss": 8.247138695994382, "vf_explained_var": 0.4510943707965669, "kl": 0.008748660873247202, "entropy": 0.7800839978551107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.682092563941996, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.23024495896839, "policy_loss": -0.00656075133602061, "vf_loss": 8.235782954301783, "vf_explained_var": 0.27627522478658684, "kl": 0.005113847657949442, "entropy": 0.4338113590838417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 503.4212499999994}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 726.7114018589236, "episode_reward_min": 0.19999999999999796, "episode_reward_mean": 202.88579297430692, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1385.269001186851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1385.5004107344862}, "policy_reward_mean": {"prey_policy": -707.2595739263788, "predator_policy": 808.7024704135323}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0230007378267, 6.3115157561985065, 452.02145984949146, 180.82911847324783, 366.68993065822843, 1.2850116684931252, 481.63231037339045, 26.977380765171226, 114.64924095637178, 113.98948023752293, 0.37167377745307184, 726.7114018589236, 2.000000000000001, 289.43400576625845, 62.16037417967351, 12.905415074720203, 95.57590206136757, 5.400505059714952, 124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1054.5201771225813, -28.615156117998026, -941.9311363552474, -1054.6134914572892, 20.555384973259464, -1161.50620934339, -356.5562901969566, -906.7459106457364, -295.4524089702256, -516.8561077806144, -983.6104144215794, -1206.4748027247508, -965.0757760791389, -173.5735447401317, -1142.7078333735828, -900.3565952692671, -1129.3630652043887, 40.0000000000003, -868.1986865502874, -108.99125346078327, -1362.653857996689, -993.6318962334483, -885.318707617274, 281.68832299553173, -976.2140362563356, -1224.2001022735978, -1022.3017696688775, -450.49865890856864, -2.59406929741302, -638.6952783969734, -1234.0878950829685, -1115.3951991650245, -980.8671693845348, 15.340612320094678, -1088.0435578301528, -1011.1593206279907, -800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072], "policy_predator_policy_reward": [278.43815685582445, 1054.7201771225812, 847.0076851232959, 1155.8484584454357, 779.7431734430727, 813.2291107765493, 587.211643562243, 856.9196757537035, 578.4158090119812, 600.5826383970875, 983.8954260900725, 1207.4748027247508, 666.6267468099078, 953.6548843827543, 1142.6573120008738, 927.3844974071477, 163.85527189054267, 1040.15703427022, 874.5480899609279, 216.6313302876658, 1003.7718572631734, 1352.8855707444175, 531.8934294398451, 798.4483570408178, 978.2140362563357, 1224.2001022735978, 996.2169835997039, 766.0174507439999, 39.4544434770862, 663.9952783969734, 1242.7278918734683, 1119.6606174492454, 975.4992328023253, 85.60322632348459, 1088.1650360122028, 1016.4383475056558, 373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.5964674101752045, "mean_inference_ms": 5.644512223644052, "mean_action_processing_ms": 2.4204309816709575, "mean_env_wait_ms": 11.923250820231177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009261369705200195, "StateBufferConnector_ms": 0.014181971549987793, "ViewRequirementAgentConnector_ms": 0.18149638175964355}, "num_episodes": 13, "episode_return_max": 726.7114018589236, "episode_return_min": 0.19999999999999796, "episode_return_mean": 202.88579297430692, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.22307383173964, "num_env_steps_trained_throughput_per_sec": 154.22307383173964, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 26279.582, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26279.425, "sample_time_ms": 2453.283, "learn_time_ms": 23799.396, "learn_throughput": 168.071, "synch_weights_time_ms": 22.741}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "01806_00000", "date": "2024-08-22_12-57-37", "timestamp": 1724311657, "time_this_iter_s": 25.97814393043518, "time_total_s": 1018.4562730789185, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4b4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1018.4562730789185, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 38.71351351351352, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.650560561942044, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.1993521624772, "policy_loss": -0.01220744804986728, "vf_loss": 8.209781838472558, "vf_explained_var": 0.42502234543442097, "kl": 0.008888767270134792, "entropy": 0.7770086127614219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.961117221438695, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.100480824929697, "policy_loss": -0.0076679351675526175, "vf_loss": 8.106985174411188, "vf_explained_var": 0.3271385887943248, "kl": 0.0058180003104209115, "entropy": 0.4129052993166384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 199.57440468767197, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1385.269001186851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1385.5004107344862}, "policy_reward_mean": {"prey_policy": -713.3774646065524, "predator_policy": 813.1646669503883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [124.6595689586252, 382.1249769520556, 14.362373909898393, 134.45641346922736, 364.1429280991851, 102.7016990857026, 195.25963935307382, 513.3067503456538, 399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-800.3919370953938, -286.89956155652294, -1102.302799528533, 378.9607304529302, -1267.1741329713484, -1116.8454559035615, -504.33156483197104, -1067.7912461626308, -769.6518937062435, -638.9426346476348, -938.0268089606045, -528.7924731896512, -360.5470152875451, -1261.7951462110384, -694.9457196275403, 108.95237335398129, -1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673], "policy_predator_policy_reward": [373.9827970227593, 837.9682705877858, 1102.302799528533, 3.164246499125352, 1093.4187965513656, 1304.9631662334375, 736.5335312535547, 970.0456932102771, 1054.0609265477246, 718.6765299053409, 845.9159684439586, 723.6050127920042, 1158.0793588114705, 659.522442040186, 579.4534869190144, 519.846609700198, 1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.57158955927868, "mean_inference_ms": 5.608325169613354, "mean_action_processing_ms": 2.344340827920023, "mean_env_wait_ms": 11.979168155447656, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009947061538696289, "StateBufferConnector_ms": 0.011368870735168457, "ViewRequirementAgentConnector_ms": 0.23712313175201416}, "num_episodes": 18, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 199.57440468767197, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.53921351105987, "num_env_steps_trained_throughput_per_sec": 148.53921351105987, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 26415.201, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26415.045, "sample_time_ms": 2581.814, "learn_time_ms": 23805.945, "learn_throughput": 168.025, "synch_weights_time_ms": 23.167}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "01806_00000", "date": "2024-08-22_12-58-04", "timestamp": 1724311684, "time_this_iter_s": 26.991090774536133, "time_total_s": 1045.4473638534546, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1045.4473638534546, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 37.31842105263158, "ram_util_percent": 83.38157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.694226047727796, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.758058597423412, "policy_loss": -0.010197177091268477, "vf_loss": 7.766413955587558, "vf_explained_var": 0.5185986728264541, "kl": 0.009209025104988425, "entropy": 0.7725928567073963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.95800582794916, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.073725257348762, "policy_loss": -0.008431774554724889, "vf_loss": 8.08086076161218, "vf_explained_var": 0.3902960421547057, "kl": 0.006481404737544753, "entropy": 0.43118602510482545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 191.87031822442978, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1385.269001186851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.8, "predator_policy": 1385.5004107344862}, "policy_reward_mean": {"prey_policy": -716.2706339899361, "predator_policy": 812.2057931021509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [399.1, 37.188656296365245, 136.17538786081514, 244.26779377204247, 130.0850416504512, 108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1230.4637735481779, 392.8, -954.4188695533658, -1176.758199622234, -926.2342619758367, -974.9959835249763, -562.1136182625619, -1093.3372860044756, -1186.252540876301, -693.3131038906942, -863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496], "policy_predator_policy_reward": [1236.7637735481778, 0.0, 991.9400112813407, 1176.4257141906232, 1043.1322801908107, 994.2733531708171, 790.0950576344019, 1109.623640404681, 847.4212662837149, 1162.2294201337322, 1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.527730002132817, "mean_inference_ms": 5.575815329359848, "mean_action_processing_ms": 2.3519558528535986, "mean_env_wait_ms": 12.011043016249532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00985860824584961, "StateBufferConnector_ms": 0.01134037971496582, "ViewRequirementAgentConnector_ms": 0.23946857452392578}, "num_episodes": 8, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 191.87031822442978, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.84375700085764, "num_env_steps_trained_throughput_per_sec": 153.84375700085764, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 26412.981, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26412.821, "sample_time_ms": 2588.782, "learn_time_ms": 23796.794, "learn_throughput": 168.09, "synch_weights_time_ms": 23.199}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "01806_00000", "date": "2024-08-22_12-58-30", "timestamp": 1724311710, "time_this_iter_s": 26.06529688835144, "time_total_s": 1071.512660741806, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1071.512660741806, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.07297297297298, "ram_util_percent": 83.0135135135135}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.40177041626481, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.084806717262067, "policy_loss": -0.011229544450287466, "vf_loss": 8.094356938518544, "vf_explained_var": 0.48840465911481745, "kl": 0.00839655386091816, "entropy": 0.7514517635264725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.862867576609213, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.202093264160963, "policy_loss": -0.008457758444701395, "vf_loss": 8.209275004472682, "vf_explained_var": 0.27634682220125956, "kl": 0.006380108933619879, "entropy": 0.4078035964536919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 185.11080374087717, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 283.91277505708723, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -713.6288669112541, "predator_policy": 806.1842687816928}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.01846251343379, 66.1363281789216, 335.69977852198605, 233.46543190374032, 491.26961902435494, 173.04347127728983, 30.92802159610727, 263.530173116344, 163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-863.1862003099794, -1111.1611871298492, -923.9676630558437, -71.85584733025568, -920.9010094779558, -483.0831972183656, -422.0812289362358, -505.3974974100299, -11.072485393361038, -1007.9411618514121, -561.4361613209244, -859.9000543524413, -1108.0047449377141, -1055.6409611882943, -830.1498721641995, -756.5571082436003, -624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874], "policy_predator_policy_reward": [1098.3738308395887, 983.9920191136731, 917.7486037536883, 144.21123481133162, 1057.6607132329905, 682.0232719853219, 204.50403169855912, 956.4401265514459, 710.6751162134341, 799.60815005569, 739.1813635085022, 855.1983234421527, 1148.4459699694175, 1046.127757752698, 851.4968437717544, 998.7403097523907, 841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.5093816958256, "mean_inference_ms": 5.569397760465589, "mean_action_processing_ms": 2.3344596218900673, "mean_env_wait_ms": 12.035617831073353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013379812240600586, "StateBufferConnector_ms": 0.011561870574951172, "ViewRequirementAgentConnector_ms": 0.23421871662139893}, "num_episodes": 5, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 185.11080374087717, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.929312334674, "num_env_steps_trained_throughput_per_sec": 153.929312334674, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 26454.0, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26453.838, "sample_time_ms": 2577.666, "learn_time_ms": 23847.511, "learn_throughput": 167.732, "synch_weights_time_ms": 24.118}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "01806_00000", "date": "2024-08-22_12-58-56", "timestamp": 1724311736, "time_this_iter_s": 26.02772307395935, "time_total_s": 1097.5403838157654, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae447c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1097.5403838157654, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 34.62972972972973, "ram_util_percent": 83.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.634852874342094, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.827750020809274, "policy_loss": -0.011392759622404816, "vf_loss": 7.8376348122087105, "vf_explained_var": 0.47345833910836116, "kl": 0.007539877521672419, "entropy": 0.7039375407985909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.368544314904188, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.28021385051586, "policy_loss": -0.008148497299207424, "vf_loss": 8.287216575562008, "vf_explained_var": 0.3136054560620949, "kl": 0.00572882835056002, "entropy": 0.36490319388568715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 183.18833790010743, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -710.0357950937073, "predator_policy": 801.6299640437609}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.30667854598286, 9.042809562550687, 200.34210680541977, 37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-624.9408172394212, -936.7408033574903, -1196.480038704523, -1079.2708263021293, -947.2874849030688, -65.84607588024086, -864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208], "policy_predator_policy_reward": [841.1970298348962, 883.7912693079996, 1203.2228482670737, 1081.5708263021295, 894.7486653397686, 318.72700224895965, 864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.472950892391051, "mean_inference_ms": 5.55528732115356, "mean_action_processing_ms": 2.30788050782651, "mean_env_wait_ms": 12.071069589288163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013360381126403809, "StateBufferConnector_ms": 0.011621475219726562, "ViewRequirementAgentConnector_ms": 0.23963117599487305}, "num_episodes": 8, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 183.18833790010743, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.92005200855075, "num_env_steps_trained_throughput_per_sec": 149.92005200855075, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 26589.865, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26589.708, "sample_time_ms": 2593.261, "learn_time_ms": 23966.202, "learn_throughput": 166.902, "synch_weights_time_ms": 23.896}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "01806_00000", "date": "2024-08-22_12-59-23", "timestamp": 1724311763, "time_this_iter_s": 26.720389127731323, "time_total_s": 1124.2607729434967, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aab940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1124.2607729434967, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 41.55526315789473, "ram_util_percent": 83.41578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.732653499280334, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.981620428297255, "policy_loss": -0.010918030169639716, "vf_loss": 7.990724197266593, "vf_explained_var": 0.4248673020216523, "kl": 0.009071314426769735, "entropy": 0.7099884013650278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 503.6575000000011}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.008936407957128, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.152468026882756, "policy_loss": -0.009319041417073952, "vf_loss": 8.160565145179708, "vf_explained_var": 0.29752258592181735, "kl": 0.006109748073365717, "entropy": 0.38429089284763135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 503.6575000000011}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 181.08061149281156, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -708.4207568073757, "predator_policy": 798.9610625537816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.502770801237624, 433.3711897701989, 331.3734787917017, 289.22493507300675, 15.541703888790163, 141.38350314436843, 2.700000000000004, 81.20372586738591, 400.479864708412, 2.1999999999999993, 21.35838357815409, 277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-864.1529556914759, -1101.9122164126416, -994.6832996777027, -215.48412013843827, 189.43206472325193, -941.1582853726336, -631.279115632976, -143.36626034349723, -626.3591637119332, -915.8664447372246, -951.4121786769574, -882.561334335834, -1150.6379603137455, -1186.6040875781623, -941.633549140272, 12.319454629165865, -127.33051014461657, -263.684910832405, -1075.5983157618136, -1047.3649269124826, -993.2822760964586, -1211.1934612386144, 129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251], "policy_predator_policy_reward": [864.2996709054117, 1139.268271999941, 945.2224256957577, 698.3161838905797, 1033.683058165238, 49.41664127584611, 490.54151112520145, 573.3287999242731, 497.3580275998888, 1060.4092847380577, 1099.9182211001482, 875.4387950570099, 1152.8379603137444, 1187.1040875781623, 942.5335491402722, 67.98427123821995, 355.8964895307156, 435.59879615471186, 1077.5983157618136, 1047.5649269124826, 1011.4203588687877, 1214.413762044439, 145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.468322923362019, "mean_inference_ms": 5.548528086606943, "mean_action_processing_ms": 2.305443914974231, "mean_env_wait_ms": 12.08299666425569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01326596736907959, "StateBufferConnector_ms": 0.010471820831298828, "ViewRequirementAgentConnector_ms": 0.23299741744995117}, "num_episodes": 3, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 181.08061149281156, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.12947195351322, "num_env_steps_trained_throughput_per_sec": 145.12947195351322, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 26666.127, "restore_workers_time_ms": 0.034, "training_step_time_ms": 26665.978, "sample_time_ms": 2692.026, "learn_time_ms": 23943.676, "learn_throughput": 167.059, "synch_weights_time_ms": 24.163}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "01806_00000", "date": "2024-08-22_12-59-51", "timestamp": 1724311791, "time_this_iter_s": 27.608691215515137, "time_total_s": 1151.8694641590118, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae45dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1151.8694641590118, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 41.795, "ram_util_percent": 83.33999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.062219827137294, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.672116895201345, "policy_loss": -0.010572655993223032, "vf_loss": 7.681089618218639, "vf_explained_var": 0.578705409910313, "kl": 0.00799965917640341, "entropy": 0.6757841768718901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.787049505193398, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.060577979920403, "policy_loss": -0.004633517821551, "vf_loss": 8.06416911372432, "vf_explained_var": 0.3527113956749124, "kl": 0.0052118489531080715, "entropy": 0.36715539447844975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 183.45917765194673, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -685.631944377735, "predator_policy": 777.3615332037085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [277.6, 388.81761731752573, 529.1794966163758, 7.329334718533666, 376.10450467527266, 527.2494251651817, 487.943752996851, 14.058441381538717, 250.64722134644663, 85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [129.1807676265631, -1102.39587372738, 29.642583615467093, -865.2454343945805, 34.58431676770638, -711.893657622939, -1064.4117532215837, -1279.8865248007835, -529.1586012844919, -1037.9840136360936, -547.9377234605537, -7.249219409655836, -929.2191596475744, 110.25733823003335, -1301.1373842644716, -1011.4008068322877, -473.78703719220465, -932.5085853416099, -1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557], "policy_predator_policy_reward": [145.1192323734371, 1105.6958737273796, 455.80913315312523, 768.6113349435145, 635.4498806064347, 571.0389568651719, 1069.6410879401171, 1281.9865248007836, 905.6744340562323, 1037.5726855396265, 436.6687515439554, 645.7676164914363, 664.8356478283105, 642.0699265860791, 1301.1373842644716, 1025.459248213827, 943.2847842987281, 713.6580595815325, 1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.45026245588312, "mean_inference_ms": 5.526043526848769, "mean_action_processing_ms": 2.295209176515479, "mean_env_wait_ms": 12.129205291425968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012966632843017578, "StateBufferConnector_ms": 0.010511398315429688, "ViewRequirementAgentConnector_ms": 0.22077572345733643}, "num_episodes": 11, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 183.45917765194673, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.8341875815786, "num_env_steps_trained_throughput_per_sec": 151.8341875815786, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 26450.642, "restore_workers_time_ms": 0.034, "training_step_time_ms": 26450.523, "sample_time_ms": 2655.733, "learn_time_ms": 23765.36, "learn_throughput": 168.312, "synch_weights_time_ms": 23.239}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "01806_00000", "date": "2024-08-22_13-00-17", "timestamp": 1724311817, "time_this_iter_s": 26.385382890701294, "time_total_s": 1178.2548470497131, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1178.2548470497131, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 35.37027027027027, "ram_util_percent": 83.30000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.722514493629415, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.554276080358596, "policy_loss": -0.008775610891146162, "vf_loss": 7.561692489644207, "vf_explained_var": 0.5089726960848249, "kl": 0.00679607947785703, "entropy": 0.6400012075585663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.87356325886237, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.019605428201181, "policy_loss": -0.00734633834633444, "vf_loss": 8.02582933637831, "vf_explained_var": 0.17792186837978463, "kl": 0.0056120113815826475, "entropy": 0.33563304672796257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 653.5260025585942, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 174.12947406614842, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -687.8444171544713, "predator_policy": 774.9091541875458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.5903574258065, 1.5314095476351781, 28.844680724796547, 258.53651132336483, 420.6278610726969, 362.9678663818468, 6.318055772610084, 0.19999999999999796, 217.63625363064423, 653.5260025585942, 23.226739432639434, 133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1214.6909476514231, 33.78251302396925, -1151.2547406056829, -1385.269001186851, -724.0605563632932, -894.2830117454333, -449.8215352919559, -1199.0652023669797, -100.07648729393406, -557.3932506699701, -596.7686441548561, -118.86231611246436, -1022.3612203291669, -893.7494659952883, -1014.945682698107, -1136.2829717335553, -434.224717349506, 25.938560589183748, 239.67001943615668, -778.701579567461, -935.2017162508939, -10.803186168578915, -8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673], "policy_predator_policy_reward": [1206.4389529253835, 60.05983912787815, 1152.5547406056817, 1385.5004107344862, 726.9619371329716, 920.2263117005516, 743.9206314523303, 1163.5026175299706, 813.3352242130313, 264.7623748235731, 545.6984729050811, 532.9003537440789, 1022.3612203291669, 900.0675217678992, 1014.945682698107, 1136.4829717335554, 607.6529805290344, 18.269429861934405, 666.3701478562938, 526.1874148336046, 943.7853933836533, 25.4462484684588, 63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.420192369168497, "mean_inference_ms": 5.517495077353767, "mean_action_processing_ms": 2.2846477348291825, "mean_env_wait_ms": 12.168601801082184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012874603271484375, "StateBufferConnector_ms": 0.010002493858337402, "ViewRequirementAgentConnector_ms": 0.21277153491973877}, "num_episodes": 9, "episode_return_max": 653.5260025585942, "episode_return_min": 0.19999999999999574, "episode_return_mean": 174.12947406614842, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.3899935443599, "num_env_steps_trained_throughput_per_sec": 154.3899935443599, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 26450.5, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26450.362, "sample_time_ms": 2660.955, "learn_time_ms": 23758.167, "learn_throughput": 168.363, "synch_weights_time_ms": 24.641}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "01806_00000", "date": "2024-08-22_13-00-43", "timestamp": 1724311843, "time_this_iter_s": 25.949669122695923, "time_total_s": 1204.204516172409, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1204.204516172409, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 34.881081081081085, "ram_util_percent": 83.28378378378378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.197726304947384, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.7838604276142425, "policy_loss": -0.00988732439382051, "vf_loss": 7.792460373469761, "vf_explained_var": 0.45972006409256544, "kl": 0.006436862394203821, "entropy": 0.6125706762233109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.000876229654544, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.039812954897602, "policy_loss": -0.007102028100391623, "vf_loss": 8.045721184765851, "vf_explained_var": 0.2364591324140155, "kl": 0.005969046701297716, "entropy": 0.3107149951514744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 621.4137035832227, "episode_reward_min": 0.19999999999999574, "episode_reward_mean": 176.1411587580898, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -688.6412670844625, "predator_policy": 776.7118464635074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.0250769655205, 132.46937638796877, 8.275527169605299, 5.300000000000001, 173.74135150841494, 111.9295898117778, 74.94051859983439, 202.339806950394, 0.4330285513360992, 523.9281872131905, 513.8695336972062, 184.82568844864053, 591.2173442624453, 144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-8.740677279047398, -173.0555362284359, -1247.838273078232, -74.67009286736068, -996.5790749399682, -1216.2836992696816, -974.4874147927767, -1089.9091928157009, -1091.701962554, -603.0763831911565, -1272.040718686234, -635.7295155563619, -548.1043319230841, -519.3732100918655, -754.9394692686546, -172.6742558191641, -1184.9858807819662, -940.4912232966, -120.79812236748026, -911.0281177898258, -188.64934227464633, -563.0613763750785, -653.0610724328951, -763.6122021336413, -899.6221749809295, -249.572361740288, -1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042], "policy_predator_policy_reward": [63.78749585598337, 251.03379461702121, 745.8503291309091, 709.1274132026542, 1006.0629484142189, 1215.0753529650365, 979.7874147927768, 1089.9091928157009, 1063.920752667162, 804.5989445864138, 1244.968211644682, 774.7316124096956, 378.5001931492233, 763.9178674655624, 803.5292762190484, 326.4242558191648, 1184.9858807819662, 940.924251847936, 923.1845624298717, 632.5698649406273, 868.3371603768485, 397.2430919700827, 578.6371109753984, 1022.86185203978, 1005.878156448928, 734.5337245347343, 1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.39673336857891, "mean_inference_ms": 5.499857857415228, "mean_action_processing_ms": 2.267051909931942, "mean_env_wait_ms": 12.205302340382898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007932186126708984, "StateBufferConnector_ms": 0.004837512969970703, "ViewRequirementAgentConnector_ms": 0.19654595851898193}, "num_episodes": 11, "episode_return_max": 621.4137035832227, "episode_return_min": 0.19999999999999574, "episode_return_mean": 176.1411587580898, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.36158372485852, "num_env_steps_trained_throughput_per_sec": 154.36158372485852, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 26356.563, "restore_workers_time_ms": 0.039, "training_step_time_ms": 26356.405, "sample_time_ms": 2596.641, "learn_time_ms": 23727.598, "learn_throughput": 168.58, "synch_weights_time_ms": 25.826}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "01806_00000", "date": "2024-08-22_13-01-09", "timestamp": 1724311869, "time_this_iter_s": 25.976476192474365, "time_total_s": 1230.1809923648834, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ad13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1230.1809923648834, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 32.894594594594594, "ram_util_percent": 83.17027027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.466157935662245, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.349207261504319, "policy_loss": -0.010253425315022468, "vf_loss": 7.357991570265836, "vf_explained_var": 0.5689976036233246, "kl": 0.0073456357442650685, "entropy": 0.6311481457538706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.522599057293444, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.879432246293971, "policy_loss": -0.007570462318373814, "vf_loss": 7.886001185765342, "vf_explained_var": 0.29586506003425234, "kl": 0.005007478066044983, "entropy": 0.31022226580236323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 797.6867519860958, "episode_reward_min": -2.995272104325847, "episode_reward_mean": 171.77151458225578, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -679.8907241374603, "predator_policy": 765.7764814285885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [144.48299340086118, 266.77693182840676, 285.7055091268405, 36.54340154110692, 490.43657138847857, 157.58428984857437, 286.93158316682167, 621.4137035832227, 55.215878988490374, 352.97240984656406, 102.57471926019231, 32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1186.0802161380266, -1193.5364202138833, 6.706191614616248, -1099.201590770712, 56.56155252319078, -560.4052245764752, -512.4513208988473, -740.7892451396656, -995.6181359271382, 283.91277505708723, -767.1128224569877, -1247.2423582122863, -201.72584302387753, -660.1236448547199, 30.200531319139237, -1129.8313382238227, -747.406904908787, -909.1331180426318, 140.62805018468302, -740.4858653403659, -666.4781265670547, -867.7130141837933, -916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755], "policy_predator_policy_reward": [1189.612907013166, 1334.486722739605, 1036.3389386330339, 322.93339235147056, 182.17379298485469, 607.3753881952726, 530.5206500745718, 759.2633175050471, 552.9938436701108, 649.1480885884157, 1057.8848640973717, 1114.054606420473, 465.11230347473014, 683.6687675706895, 764.168987803185, 956.8755226847165, 789.6227838972766, 922.1331180426318, 952.830225002246, 0.0, 969.0715970085554, 667.6942630024834, 948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.3748422928992765, "mean_inference_ms": 5.481891369352172, "mean_action_processing_ms": 2.2306736929026845, "mean_env_wait_ms": 12.248399503246771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00785207748413086, "StateBufferConnector_ms": 0.004765152931213379, "ViewRequirementAgentConnector_ms": 0.1640331745147705}, "num_episodes": 13, "episode_return_max": 797.6867519860958, "episode_return_min": -2.995272104325847, "episode_return_mean": 171.77151458225578, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.37973781400132, "num_env_steps_trained_throughput_per_sec": 154.37973781400132, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 26317.091, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26316.935, "sample_time_ms": 2563.233, "learn_time_ms": 23722.238, "learn_throughput": 168.618, "synch_weights_time_ms": 25.685}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "01806_00000", "date": "2024-08-22_13-01-35", "timestamp": 1724311895, "time_this_iter_s": 25.956130027770996, "time_total_s": 1256.1371223926544, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1256.1371223926544, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.29189189189189, "ram_util_percent": 83.03243243243242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.279353372382108, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.698955234144099, "policy_loss": -0.008774656415596683, "vf_loss": 7.706670270142732, "vf_explained_var": 0.4375442170592212, "kl": 0.005298282520564657, "entropy": 0.5957928842968411, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.400384505085214, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.102139776724357, "policy_loss": -0.00773618857785271, "vf_loss": 8.108833930605934, "vf_explained_var": 0.12200097135765843, "kl": 0.005210396063405646, "entropy": 0.2798742102567481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 797.6867519860958, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 160.8828712213177, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -675.1843401317658, "predator_policy": 755.625775742425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.689350119902514, 1.4000000000000024, 81.69999999999999, 503.4907295676801, 2.6703964383283427, 48.73983128223629, 13.100000000000007, 83.8758232195132, 38.83777997049233, 182.46817066873317, 173.47868827535464, 5.13930836661897, 123.40009608889994, 0.2107117271364607, 536.3423228965687, 245.41610753407744, 430.54525193080326, 0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-916.3556038873598, -940.403930449799, -837.4122348542624, -1302.8134815440885, -729.8641944610179, -1269.1223981796072, 137.52203357347457, -738.0116993944106, -1151.5212035503355, -882.1995791146537, -1031.970602279657, -23.280107850277595, -1011.4704931406659, -715.9097070264206, -564.876203731497, -723.6540040344635, -1267.3244929382452, -1192.9142343471187, -925.873777846851, -633.9589399561025, -916.1458113521085, -194.88692009175023, -1019.6555452666094, -815.733750494176, -654.2145801107171, -197.23487641333065, -894.4965660148175, -1296.2373215893294, -871.914904665693, 254.08280168783068, -1070.9367687911715, -256.3605494591235, -117.26363156452372, -1102.5233158335582, -1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658], "policy_predator_policy_reward": [948.0449540072622, 941.403930449799, 837.8122348542624, 1303.8134815440885, 811.5641944610185, 1269.1223981796072, 649.005706469901, 454.9746889187139, 881.4296702964623, 1154.9615088068556, 304.80062301428745, 799.189918397883, 1012.5704931406661, 727.9097070264211, 666.4581904086538, 705.9478405768231, 1313.0952180958427, 1185.981289160013, 861.9837797493096, 880.31710872238, 857.3559012636762, 427.15551845553665, 1019.6555452666094, 820.8730588607959, 544.128233611124, 430.7213190018237, 894.6072777419539, 1296.3373215893296, 212.70021519784507, 941.4742106765848, 855.2777866506491, 717.4356391337245, 945.9956527230627, 704.3365466058227, 1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.347664050717491, "mean_inference_ms": 5.461446975073914, "mean_action_processing_ms": 2.2128858949880867, "mean_env_wait_ms": 12.292572441969801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008201956748962402, "StateBufferConnector_ms": 0.005430340766906738, "ViewRequirementAgentConnector_ms": 0.19397902488708496}, "num_episodes": 11, "episode_return_max": 797.6867519860958, "episode_return_min": -17.989147363597635, "episode_return_mean": 160.8828712213177, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.14260082437067, "num_env_steps_trained_throughput_per_sec": 152.14260082437067, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 26352.558, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26352.404, "sample_time_ms": 2589.545, "learn_time_ms": 23733.176, "learn_throughput": 168.54, "synch_weights_time_ms": 24.05}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "01806_00000", "date": "2024-08-22_13-02-02", "timestamp": 1724311922, "time_this_iter_s": 26.347190856933594, "time_total_s": 1282.484313249588, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1282.484313249588, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.627027027027026, "ram_util_percent": 83.25945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.790968054059952, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.662027347403229, "policy_loss": -0.011894232901453814, "vf_loss": 7.672321916509557, "vf_explained_var": 0.4439201522125769, "kl": 0.00799856300406631, "entropy": 0.5806483385739503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.53258314107461, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.251713033201833, "policy_loss": -0.006393429479517397, "vf_loss": 8.257213969457718, "vf_explained_var": 0.22597077813728778, "kl": 0.004462583728193764, "entropy": 0.2626685428713995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 797.6867519860958, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 167.41163944482392, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -646.9905299109903, "predator_policy": 730.6963496334025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.19999999999999574, 29.411305552589425, 245.28009501370963, 195.22228005781525, 141.9555312714005, 234.3952457760909, 2.1036727384695544, 81.55991904429608, 201.18782977897402, 42.891269506951915, 18.699999999999996, 337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1298.8215099720242, -904.2881276713528, -1167.420256835673, -1056.7177636111205, -1074.7735726647124, -942.5390272288448, -677.6765808383485, -645.6026038812673, 33.999476738487026, -1157.9172476810825, -952.8773241637865, -215.38621590188956, -1018.7249515041674, -1065.8184773513133, -1149.207070071348, -611.5763432379676, -754.0641742051866, -915.4804041643699, -899.694569566332, -9.098162079241552, -951.8624338595642, -505.6466320811561, -842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831], "policy_predator_policy_reward": [1298.8215099720242, 904.4881276713528, 1207.7960284823293, 1045.753297517053, 1030.0727653414249, 1232.519929565841, 728.8161455682022, 789.68531920923, 124.7513548338071, 1141.1219473801912, 416.7933655870935, 985.8654202546741, 1020.828624242637, 1065.8184773513133, 1154.8669891156442, 687.4763432379681, 750.1512999269387, 1120.581108221591, 921.791220708805, 29.89278044372088, 958.7624338595642, 517.4466320811588, 808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.292169690052233, "mean_inference_ms": 5.429569788168583, "mean_action_processing_ms": 2.1929098946391066, "mean_env_wait_ms": 12.337765547990184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007529020309448242, "StateBufferConnector_ms": 0.0053528547286987305, "ViewRequirementAgentConnector_ms": 0.15642499923706055}, "num_episodes": 17, "episode_return_max": 797.6867519860958, "episode_return_min": -17.989147363597635, "episode_return_mean": 167.41163944482392, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.62815049274928, "num_env_steps_trained_throughput_per_sec": 146.62815049274928, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 26387.657, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26387.461, "sample_time_ms": 2477.391, "learn_time_ms": 23879.619, "learn_throughput": 167.507, "synch_weights_time_ms": 24.649}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "01806_00000", "date": "2024-08-22_13-02-29", "timestamp": 1724311949, "time_this_iter_s": 27.37140989303589, "time_total_s": 1309.855723142624, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1309.855723142624, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 43.36153846153847, "ram_util_percent": 83.12564102564103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.361602709028457, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.82315386666192, "policy_loss": -0.00770438456484092, "vf_loss": 7.829205646716728, "vf_explained_var": 0.4325808594466517, "kl": 0.008263129785794902, "entropy": 0.5640134449989077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.624454783636427, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.168227345098263, "policy_loss": -0.007562788815863391, "vf_loss": 8.17514400128965, "vf_explained_var": 0.025412119696379968, "kl": 0.006461400846290407, "entropy": 0.26374066367981924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 797.6867519860958, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 181.44507502960317, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1455.7714395202872, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1456.1714395202873}, "policy_reward_mean": {"prey_policy": -615.986920688579, "predator_policy": 706.7094582033808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [337.812235733021, 9.016116523516798, 1.2630785901949548, 120.91611163169006, 99.20131086397761, 40.468813615028445, 1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-842.2459365457216, -413.55869687539496, -713.7807841584226, -950.6304807238942, -1073.6772669631393, -627.1923652879094, -542.6055790492557, -1017.4118676346878, -886.5307195234027, -523.3842188894575, -1455.7714395202872, -85.74949977180874, -1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211], "policy_predator_policy_reward": [808.5665909885, 785.0502781656385, 719.796900681941, 953.6304807238942, 1074.7772669631393, 627.3554438781044, 759.8155011080923, 921.1180572075418, 633.5942008841574, 875.5220483926847, 1456.1714395202873, 125.81831338683531, 1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.265777387336236, "mean_inference_ms": 5.422331290347102, "mean_action_processing_ms": 2.159426313200783, "mean_env_wait_ms": 12.3696996066706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007544398307800293, "StateBufferConnector_ms": 0.004976511001586914, "ViewRequirementAgentConnector_ms": 0.1391465663909912}, "num_episodes": 11, "episode_return_max": 797.6867519860958, "episode_return_min": -17.989147363597635, "episode_return_mean": 181.44507502960317, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 135.56217837576202, "num_env_steps_trained_throughput_per_sec": 135.56217837576202, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 26738.293, "restore_workers_time_ms": 0.038, "training_step_time_ms": 26738.095, "sample_time_ms": 2608.979, "learn_time_ms": 24097.223, "learn_throughput": 165.994, "synch_weights_time_ms": 25.935}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "01806_00000", "date": "2024-08-22_13-02-59", "timestamp": 1724311979, "time_this_iter_s": 29.55436420440674, "time_total_s": 1339.4100873470306, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ad1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1339.4100873470306, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 52.661904761904765, "ram_util_percent": 83.03571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.643844663276873, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.712459698934404, "policy_loss": -0.00832782515408422, "vf_loss": 7.719287162861496, "vf_explained_var": 0.39377271971374594, "kl": 0.007501836508147852, "entropy": 0.5604445793010571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.62934830352743, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.115293021429153, "policy_loss": -0.007978611247781566, "vf_loss": 8.122634494620025, "vf_explained_var": 0.10079126711244936, "kl": 0.006370935884486667, "entropy": 0.26890322730024024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 193.52370210903692, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1279.9303493835066, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 349.5660811287606, "predator_policy": 1287.3303493835062}, "policy_reward_mean": {"prey_policy": -601.8563397997455, "predator_policy": 698.6181908542643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.9186623209389517, 339.7742947040928, 39.66357229443321, 33.927943007555214, 451.8865442794088, 14.148872746809399, 278.9587315732106, 349.5660811287606, 1.6000000000000045, 79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1122.0097414840413, -1044.3386424808582, -682.4450629090285, 163.36554423358655, -571.281339904333, -962.3006990394192, -645.0230556551558, -829.4101883750874, -912.5536695479291, -545.5387445288662, -947.9993202519339, -1071.849573901622, 24.762447502258983, -858.957072910959, 349.5660811287606, -1117.7089786864208, -688.0473908186649, -993.1017482972701, -1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808], "policy_predator_policy_reward": [1123.9097414840414, 1044.3573048017972, 857.8547463075128, 0.999067072022413, 607.2449121987678, 966.0006990394193, 633.9916968642609, 874.3694901735383, 1029.2950241977674, 880.6839341584373, 992.712131442706, 1041.2856354576602, 288.2396472448869, 824.9137097370253, 0.0, 1117.7089786864208, 689.6473908186649, 993.1017482972701, 1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.250644271207186, "mean_inference_ms": 5.416412537037893, "mean_action_processing_ms": 2.161362533092107, "mean_env_wait_ms": 12.388752024180512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004989266395568848, "StateBufferConnector_ms": 0.005092740058898926, "ViewRequirementAgentConnector_ms": 0.1438767910003662}, "num_episodes": 6, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 193.52370210903692, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.22909774149508, "num_env_steps_trained_throughput_per_sec": 134.22909774149508, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 27119.68, "restore_workers_time_ms": 0.04, "training_step_time_ms": 27119.405, "sample_time_ms": 2730.052, "learn_time_ms": 24357.896, "learn_throughput": 164.218, "synch_weights_time_ms": 25.078}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "01806_00000", "date": "2024-08-22_13-03-29", "timestamp": 1724312009, "time_this_iter_s": 29.850194215774536, "time_total_s": 1369.2602815628052, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae4b4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1369.2602815628052, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 51.42558139534883, "ram_util_percent": 82.12558139534885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.457926943693213, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.780396538689023, "policy_loss": -0.006146798567678878, "vf_loss": 7.785387716848383, "vf_explained_var": 0.457633649041413, "kl": 0.0057780116126335485, "entropy": 0.5530945654268618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.419177890706944, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.196336566581929, "policy_loss": -0.005704588954036356, "vf_loss": 8.201500244241544, "vf_explained_var": 0.10365560180926449, "kl": 0.005409356816142069, "entropy": 0.2446594582663642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 193.01472051684453, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1279.9303493835066, "predator_policy": 2.7883612905885995}, "policy_reward_max": {"prey_policy": 318.970214465854, "predator_policy": 1287.3303493835062}, "policy_reward_mean": {"prey_policy": -599.3722195774097, "predator_policy": 695.8795798358324}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.32230847038704, 80.9966457139792, 68.48138118970438, 328.53737548805145, 84.02659456760723, 598.0777467361761, 150.51830833141156, 5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1072.0394630211342, -568.8667255585137, -1142.7693084428731, -62.73375298213251, -1086.6292798061268, -971.4209085768932, -397.74356262595813, -567.8511524993587, 37.8762058438196, -1211.2572519883988, -715.4162661533045, 49.35538917812246, -923.3239969101909, -135.37252795967805, -689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767], "policy_predator_policy_reward": [1008.5875258553214, 711.6409711947148, 469.40891310136647, 817.0907940376202, 1074.2824721891443, 1052.2490973835802, 514.2474311466598, 779.8846594667098, 1201.6695325757103, 55.73810813647693, 614.8539002447798, 649.2847234665766, 924.2239969101909, 284.9908362910895, 735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.243571116027755, "mean_inference_ms": 5.415680862765619, "mean_action_processing_ms": 2.1534761613047597, "mean_env_wait_ms": 12.403162425948542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066547393798828125, "StateBufferConnector_ms": 0.0050650835037231445, "ViewRequirementAgentConnector_ms": 0.14649295806884766}, "num_episodes": 9, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 193.01472051684453, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.70103148444502, "num_env_steps_trained_throughput_per_sec": 139.70103148444502, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 27314.847, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27314.577, "sample_time_ms": 2785.245, "learn_time_ms": 24499.235, "learn_throughput": 163.27, "synch_weights_time_ms": 25.321}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "01806_00000", "date": "2024-08-22_13-03-57", "timestamp": 1724312037, "time_this_iter_s": 28.699499130249023, "time_total_s": 1397.9597806930542, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1397.9597806930542, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 46.0925, "ram_util_percent": 81.2175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.627783916866967, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.5678430193946475, "policy_loss": -0.011384060004203724, "vf_loss": 7.577701083188335, "vf_explained_var": 0.4796059985009451, "kl": 0.007630038702190317, "entropy": 0.5636774205656909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.974821528682003, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.997143233263934, "policy_loss": -0.008596256423603605, "vf_loss": 8.005105023661619, "vf_explained_var": -0.0413591982195617, "kl": 0.006344687040136368, "entropy": 0.24146620612295847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 202.68397918882923, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1279.9303493835066, "predator_policy": 2.7883612905885995}, "policy_reward_max": {"prey_policy": 318.970214465854, "predator_policy": 1287.3303493835062}, "policy_reward_mean": {"prey_policy": -585.3370622463007, "predator_policy": 686.6790518407156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.540988083366382, 102.42333306710694, 42.754109318132144, 335.6935708494057, 67.41155679998383, 210.731207105825, 185.38647228005493, 10.400000000000002, 0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-689.0197333322554, -830.5801746566116, -820.3305756867102, -1.2336206788666981, -763.6082937102099, 21.65969338599928, 218.9630070607949, -797.9447594129068, -526.853655323653, -181.2764499980569, -377.29733541758134, -836.7461182012557, -221.30204002507332, -958.1644405701841, -1279.9303493835066, -994.93365454487, -1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979], "policy_predator_policy_reward": [735.0079727309652, 790.1329233412694, 822.2305756867106, 101.75695374597468, 774.012145659603, 10.690563982741503, 125.65924708030123, 789.0160761212176, 36.12551577562794, 739.4161463460688, 623.6561817901217, 801.1184789345486, 455.5775508904786, 909.2754019848318, 1287.3303493835062, 997.93365454487, 1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.224881371980174, "mean_inference_ms": 5.401193519988475, "mean_action_processing_ms": 2.1676605027505547, "mean_env_wait_ms": 12.412726722124196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006683826446533203, "StateBufferConnector_ms": 0.0051195621490478516, "ViewRequirementAgentConnector_ms": 0.14822566509246826}, "num_episodes": 7, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 202.68397918882923, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.79360932008163, "num_env_steps_trained_throughput_per_sec": 146.79360932008163, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 27283.602, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27283.284, "sample_time_ms": 2716.388, "learn_time_ms": 24537.065, "learn_throughput": 163.019, "synch_weights_time_ms": 24.214}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "01806_00000", "date": "2024-08-22_13-04-25", "timestamp": 1724312065, "time_this_iter_s": 27.29732394218445, "time_total_s": 1425.2571046352386, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1425.2571046352386, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 40.42564102564103, "ram_util_percent": 80.31025641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.170598454702468, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.660572627234081, "policy_loss": -0.010541242818845801, "vf_loss": 7.669294084316839, "vf_explained_var": 0.45484750504216187, "kl": 0.009098887893188962, "entropy": 0.5547379152169303, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.222422839977124, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.163195932983722, "policy_loss": -0.0060527649225184214, "vf_loss": 8.168671515631297, "vf_explained_var": -0.04475052306261012, "kl": 0.005771806420359228, "entropy": 0.2600662511650217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 208.28891073291572, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1186.2022029824063, "predator_policy": 2.7883612905885995}, "policy_reward_max": {"prey_policy": 318.970214465854, "predator_policy": 1183.3838372365935}, "policy_reward_mean": {"prey_policy": -584.4840988293495, "predator_policy": 688.6285541958076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5999999999999981, 443.6830300836477, 618.3889298490327, 2.3832920509872064, 91.8484553272902, 3.1574463730279074, 570.1118096738578, 1.1999999999999993, 35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1080.953171155812, -971.6544935976806, -153.32864474572204, -737.626489845837, -4.003422250053376, -664.8534451631472, -1060.0840273203146, -1145.8535218807904, -91.0392741064035, 25.06572849758256, -1186.2022029824063, -584.6419790610831, -860.7131837750202, 37.17328796658673, -897.3886254470412, -834.5896201673406, -781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977], "policy_predator_policy_reward": [1080.953171155812, 972.2544935976806, 599.6212760442531, 735.0168886309506, 607.8824651051553, 679.3633321570785, 1062.4840273203147, 1145.8368139317774, 120.63927410640181, 37.18272682970881, 1183.3838372365935, 590.617791179924, 801.6983948134341, 591.9533106688573, 898.5886254470413, 834.5896201673406, 782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.2168214170643346, "mean_inference_ms": 5.414218230002231, "mean_action_processing_ms": 2.15536175862716, "mean_env_wait_ms": 12.420109276373704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006621718406677246, "StateBufferConnector_ms": 0.0050269365310668945, "ViewRequirementAgentConnector_ms": 0.14156711101531982}, "num_episodes": 8, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 208.28891073291572, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.04044654557646, "num_env_steps_trained_throughput_per_sec": 145.04044654557646, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 27407.002, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27406.675, "sample_time_ms": 2707.917, "learn_time_ms": 24667.928, "learn_throughput": 162.154, "synch_weights_time_ms": 25.3}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "01806_00000", "date": "2024-08-22_13-04-52", "timestamp": 1724312092, "time_this_iter_s": 27.63526201248169, "time_total_s": 1452.8923666477203, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ac8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1452.8923666477203, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 39.347500000000004, "ram_util_percent": 80.1825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.26859300351017, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.625187091221885, "policy_loss": -0.009576042500575857, "vf_loss": 7.633275827781233, "vf_explained_var": 0.44783016588322067, "kl": 0.007436627222510873, "entropy": 0.5940356473758738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.52021474737339, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.780707995601432, "policy_loss": -0.007465245977300343, "vf_loss": 7.787566793532599, "vf_explained_var": 0.027207160942138188, "kl": 0.006064784258268971, "entropy": 0.2724336310038491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 211.35635029828842, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.3986970720766, "predator_policy": 2.7883612905885995}, "policy_reward_max": {"prey_policy": 318.970214465854, "predator_policy": 1169.478215721609}, "policy_reward_mean": {"prey_policy": -570.4082742629001, "predator_policy": 676.0864494120444}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.11329694731406, 60.06315129522267, 446.3341073093584, 1.748723663646072, 0.6999999999999935, 506.6427719773438, 234.353215390682, 2.624206007463457, 500.9448490870192, 470.44988538672396, 21.49576214247741, 0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-781.488756784045, 30.92493565672545, -381.5725828954086, -930.2774524761846, -888.8564304977823, -496.19114456645855, -760.3420429539754, -963.9686694180422, -871.4541658436411, -849.6354545791836, -787.6754200984159, 109.14342021572017, -396.5608897474236, -697.7868162366603, -858.5627214527868, -1088.3275124137197, -721.7193332533893, -55.845444306674366, -415.38527682877174, -940.2351223898042, -574.6390455415045, -552.2950543289056, -1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438], "policy_predator_policy_reward": [782.8887567840453, 2.7883612905885995, 441.63573419063067, 930.2774524761846, 790.7852720725085, 1040.5964103010945, 762.0907666176219, 963.9686694180422, 872.1541658436413, 849.6354545791836, 732.848898305824, 452.32587355421566, 593.5036759399164, 735.1972454348548, 780.0362241523584, 1169.478215721609, 764.483585473959, 514.0260411731234, 934.3803311386804, 891.6899534666192, 270.29901469846544, 878.1308473144277, 973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.214168843991656, "mean_inference_ms": 5.410248252923153, "mean_action_processing_ms": 2.1506574635891162, "mean_env_wait_ms": 12.41176486500684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006579756736755371, "StateBufferConnector_ms": 0.005042552947998047, "ViewRequirementAgentConnector_ms": 0.1472475528717041}, "num_episodes": 8, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 211.35635029828842, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.86136713625524, "num_env_steps_trained_throughput_per_sec": 147.86136713625524, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 27521.402, "restore_workers_time_ms": 0.039, "training_step_time_ms": 27521.09, "sample_time_ms": 2717.572, "learn_time_ms": 24774.156, "learn_throughput": 161.459, "synch_weights_time_ms": 24.439}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "01806_00000", "date": "2024-08-22_13-05-19", "timestamp": 1724312119, "time_this_iter_s": 27.060378074645996, "time_total_s": 1479.9527447223663, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1479.9527447223663, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 37.536842105263155, "ram_util_percent": 80.35526315789477}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.33868872400314, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.56703165700196, "policy_loss": -0.00786137996714503, "vf_loss": 7.573342280413108, "vf_explained_var": 0.5105285175262936, "kl": 0.007753757025711436, "entropy": 0.5710483914960629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.44667445339223, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.27563313428687, "policy_loss": -0.009137105830161581, "vf_loss": 8.284142808056382, "vf_explained_var": -0.1014626386935118, "kl": 0.006274258964522569, "entropy": 0.24071460065072176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 206.2613084804446, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.3986970720766, "predator_policy": 14.852149458119289}, "policy_reward_max": {"prey_policy": 318.970214465854, "predator_policy": 1169.3986970720766}, "policy_reward_mean": {"prey_policy": -555.2958449266303, "predator_policy": 658.4264991668528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8298817832420637, 401.28940975598744, 7.30071272281002, 2.2999999999999976, 329.6122461771738, 98.04004451645099, 45.44641785220358, 797.6867519860958, 445.30624815370066, -2.995272104325847, 6.399999999999992, 66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1005.305851275983, -646.0907640793669, -650.5044909741829, -261.44374694209324, -800.8345028090062, -951.1147138950358, -707.6277140521663, -1169.3986970720766, -408.8958756679741, 0.20450009947828418, -664.0214137048712, -631.0041694811692, 21.494268394083896, -496.7915569984398, 318.970214465854, -981.9499387834426, -993.9493647366004, -350.75108184875916, -901.5617094561792, -584.7686047371703, -775.2955796643018, -831.4570278574947, -930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428], "policy_predator_policy_reward": [973.7544688897203, 678.4720282488717, 603.3973383206736, 709.8403093515966, 807.135215531816, 952.1147138950358, 709.9277140521667, 1169.3986970720766, 83.6268097655237, 654.676811980147, 660.0875337573373, 732.9780939451575, 14.852149458119289, 505.8915569984394, 550.7089291704831, 909.9575471332043, 865.6159129973314, 924.3907817417316, 906.3370457416609, 576.9979963473626, 775.895579664302, 837.2570278574944, 933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.202824458248334, "mean_inference_ms": 5.401368023242768, "mean_action_processing_ms": 2.159179722516475, "mean_env_wait_ms": 12.414759004873472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064095258712768555, "StateBufferConnector_ms": 0.004878878593444824, "ViewRequirementAgentConnector_ms": 0.15339744091033936}, "num_episodes": 11, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 206.2613084804446, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.44414091026843, "num_env_steps_trained_throughput_per_sec": 144.44414091026843, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 27699.3, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27699.01, "sample_time_ms": 2710.755, "learn_time_ms": 24958.36, "learn_throughput": 160.267, "synch_weights_time_ms": 24.99}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "01806_00000", "date": "2024-08-22_13-05-47", "timestamp": 1724312147, "time_this_iter_s": 27.765995025634766, "time_total_s": 1507.718739748001, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3d6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1507.718739748001, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 42.29, "ram_util_percent": 80.48499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.216217124777497, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.919032057000216, "policy_loss": -0.009414587675460747, "vf_loss": 6.927060805931293, "vf_explained_var": 0.47559224726661803, "kl": 0.006929205646541305, "entropy": 0.5599137599190707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.484310003815505, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.813603395129007, "policy_loss": -0.00553536840946113, "vf_loss": 7.818703867392565, "vf_explained_var": 0.13964841857789054, "kl": 0.0043490055094783505, "entropy": 0.23181876280793437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -17.989147363597635, "episode_reward_mean": 198.60378324771824, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1155.6104357330523, "predator_policy": 28.69132259825544}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1155.507033588089}, "policy_reward_mean": {"prey_policy": -546.7983406672207, "predator_policy": 646.1002322910801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [66.61840899711052, 318.96358784497306, 62.58126646732363, 66.02917270023666, 3.900000000000002, 357.9623942006006, -17.989147363597635, 288.1443927781562, 351.77004028053244, 143.35135543453978, 104.14645500330569, 32.91413853968687, 97.1444179859279, 247.40099103886746, 333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-930.4972902772004, -574.4478819101755, -815.9862550228227, -223.29631169082262, -433.43128009577873, -586.4015156642923, -928.3017050701677, -691.2656194156299, -706.413617891233, -844.5440464477699, -17.450507908572572, -677.8726008112903, -716.5438776096152, -657.6415169289048, -22.906119655083273, -613.1042477886919, -754.2535435748722, -491.6503863110261, -694.2544048446046, -306.8189210486086, -607.8124049122773, -958.9671382111892, -52.46411699322887, -964.6691497449658, -226.23079394417957, -1003.5177991641353, -27.68670914191469, -769.812887096283, 187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393], "policy_predator_policy_reward": [933.7972902772004, 637.7662909072851, 573.5893184566122, 784.6568361020046, 498.58248407560353, 583.8315781517957, 892.816292955473, 792.78020423056, 709.813617891233, 845.0440464477699, 398.197289931768, 655.0882129886946, 742.2694493373392, 613.9267978375834, 304.4891521856231, 619.6656080363095, 877.0680134085595, 720.60595675787, 594.0988425317586, 550.3258387959983, 732.8623887838969, 938.0636093428744, 72.90205704498496, 977.1453482328981, 403.5654002155823, 923.3276108786577, 562.4822070833726, 482.41838019369203, 140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.197929896938786, "mean_inference_ms": 5.402466486143941, "mean_action_processing_ms": 2.157351821834735, "mean_env_wait_ms": 12.398192410287772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006483316421508789, "StateBufferConnector_ms": 0.005022764205932617, "ViewRequirementAgentConnector_ms": 0.17338895797729492}, "num_episodes": 11, "episode_return_max": 811.8516436161027, "episode_return_min": -17.989147363597635, "episode_return_mean": 198.60378324771824, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.01366574193338, "num_env_steps_trained_throughput_per_sec": 147.01366574193338, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 27829.123, "restore_workers_time_ms": 0.031, "training_step_time_ms": 27828.832, "sample_time_ms": 2725.665, "learn_time_ms": 25073.393, "learn_throughput": 159.532, "synch_weights_time_ms": 25.032}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "01806_00000", "date": "2024-08-22_13-06-15", "timestamp": 1724312175, "time_this_iter_s": 27.271640062332153, "time_total_s": 1534.9903798103333, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1534.9903798103333, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.96842105263157, "ram_util_percent": 81.8921052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.04975246247791, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3128070891849575, "policy_loss": -0.009822906735698106, "vf_loss": 7.321225704717889, "vf_explained_var": 0.5313667684005051, "kl": 0.007021561561881629, "entropy": 0.5793697132004632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.062473460606167, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.831106770227826, "policy_loss": -0.005245198841113104, "vf_loss": 7.836106177738735, "vf_explained_var": 0.14128487097523199, "kl": 0.004915454207362715, "entropy": 0.22232433062381846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 492.7900000000009}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -11.999999880533252, "episode_reward_mean": 205.39623078153463, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1155.6104357330523, "predator_policy": 12.571113814233046}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1155.507033588089}, "policy_reward_mean": {"prey_policy": -537.5550508648879, "predator_policy": 640.2531662556555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [333.1216178912284, 192.11493307647757, 183.44839955744908, 646.2989736525872, 123.52329008968876, 222.7917033737342, 32.177017570808694, 19.067470972107927, 44.162455683024184, 8.399999999999995, 226.52997360912138, 433.2834364245758, 351.1030000582092, -5.600542342962239, 1.4142517961140864, 461.58805684732556, 23.18733712643943, 539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [187.29574014568917, -623.6880078355425, -1001.66706119521, -243.78550771457608, -538.7576933781062, -1148.2167083054007, -982.9774304321567, -29.91653070675055, -921.8721732107335, -719.8242334707685, -274.26576724624505, -487.3700561530897, -417.251600401049, -973.3261284890211, -653.2404625578406, -1060.0099807735658, -335.21606479157856, -648.2683215199237, -867.7375162921757, -609.9669022939459, -293.450502231842, -248.740538569422, -277.3344231718879, -295.837226872336, -1090.252156324787, -206.41397400046768, -881.0817063941547, -852.1103703907906, -996.8737828845516, -716.7692740085831, -936.4930073865602, -177.07862808165478, -276.185632983479, -1155.6104357330523, -674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375], "policy_predator_policy_reward": [140.72587774553818, 628.7880078355437, 960.6279207332324, 476.9395812530289, 725.5415636023148, 1144.8812376386427, 821.886619659105, 837.306315132386, 858.8682583291171, 906.3514384420768, 496.57691706264507, 487.8506097104252, 941.9206213425513, 480.8341251183283, 672.4582487572917, 1059.8596655462215, 655.9241162204255, 371.7227257741007, 868.7375162921759, 617.3669022939475, 652.2382719871897, 116.48274242319539, 589.2220781461557, 417.23300832264795, 705.6534158085733, 942.1157145748891, 822.1845563970605, 905.4069780449206, 998.4505154494445, 716.6067932398045, 662.8724471495725, 912.2872451659648, 299.47637225488785, 1155.507033588089, 276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.219982214990471, "mean_inference_ms": 5.421812914061934, "mean_action_processing_ms": 2.156855432753072, "mean_env_wait_ms": 12.392972523669187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0086745023727417, "StateBufferConnector_ms": 0.0046329498291015625, "ViewRequirementAgentConnector_ms": 0.1642848253250122}, "num_episodes": 14, "episode_return_max": 811.8516436161027, "episode_return_min": -11.999999880533252, "episode_return_mean": 205.39623078153463, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 134.97458882858425, "num_env_steps_trained_throughput_per_sec": 134.97458882858425, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 28163.531, "restore_workers_time_ms": 0.031, "training_step_time_ms": 28163.205, "sample_time_ms": 2940.806, "learn_time_ms": 25192.0, "learn_throughput": 158.781, "synch_weights_time_ms": 25.195}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "01806_00000", "date": "2024-08-22_13-06-44", "timestamp": 1724312204, "time_this_iter_s": 29.667022943496704, "time_total_s": 1564.65740275383, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b85790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1564.65740275383, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 44.833333333333336, "ram_util_percent": 82.29285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.66561311565379, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.36158953570815, "policy_loss": -0.009982801519738382, "vf_loss": 7.37002953574771, "vf_explained_var": 0.4547475747961216, "kl": 0.007713946156331865, "entropy": 0.5668209602908483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.012845404690534, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.449585730941207, "policy_loss": -0.006717305470297419, "vf_loss": 7.456164306055301, "vf_explained_var": 0.31832698999889314, "kl": 0.00555045627853365, "entropy": 0.21816389409322587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 482.6312499999986}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -11.999999880533252, "episode_reward_mean": 216.1778344496387, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1066.6161586619705, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1092.5872937258898}, "policy_reward_mean": {"prey_policy": -516.5340288598544, "predator_policy": 624.6229460846739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [539.4068803855242, 60.10946011255621, 37.991861196043736, 2.4000000000000004, 4.999999999999998, 476.56274659771884, 673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-674.0011458311294, 286.606765889106, -477.8562541782684, -510.5629324019096, -655.153569054167, -30.63820081879784, -713.5787656717293, -672.0348032692103, -941.5036025253983, -805.1696427520053, -813.4113779122272, 225.79241838079133, 231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125], "policy_predator_policy_reward": [276.9185999255515, 649.8826604019957, 576.1638805908124, 472.3647661019224, 164.0373639905909, 559.746267078418, 714.0787656717293, 673.9348032692108, 942.5036025253983, 809.1696427520055, 777.3647865410513, 286.81691958810603, 557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.232948960229371, "mean_inference_ms": 5.427446222647653, "mean_action_processing_ms": 2.1673806769105948, "mean_env_wait_ms": 12.40115144757825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009844303131103516, "StateBufferConnector_ms": 0.01260066032409668, "ViewRequirementAgentConnector_ms": 0.18074357509613037}, "num_episodes": 17, "episode_return_max": 811.8516436161027, "episode_return_min": -11.999999880533252, "episode_return_mean": 216.1778344496387, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.21712129601343, "num_env_steps_trained_throughput_per_sec": 152.21712129601343, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 28063.392, "restore_workers_time_ms": 0.038, "training_step_time_ms": 28063.081, "sample_time_ms": 2937.12, "learn_time_ms": 25097.677, "learn_throughput": 159.377, "synch_weights_time_ms": 23.486}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "01806_00000", "date": "2024-08-22_13-07-11", "timestamp": 1724312231, "time_this_iter_s": 26.3440580368042, "time_total_s": 1591.0014607906342, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1591.0014607906342, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 33.82894736842105, "ram_util_percent": 82.00263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.45237984152698, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.260390342227996, "policy_loss": -0.009272401976256223, "vf_loss": 7.268084286886548, "vf_explained_var": 0.49500184160060984, "kl": 0.007892222448976503, "entropy": 0.6026569592889655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.465814499375682, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.3686649963338535, "policy_loss": -0.0034864729489618666, "vf_loss": 7.371987719258303, "vf_explained_var": 0.28956294520191417, "kl": 0.00655027707082727, "entropy": 0.25787563718185225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 811.8516436161027, "episode_reward_min": -11.999999880533252, "episode_reward_mean": 218.52898540211493, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1066.6161586619705, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1092.5872937258898}, "policy_reward_mean": {"prey_policy": -520.9007031026503, "predator_policy": 630.1651958037079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [673.9638114743301, 5.0, 311.0405534782862, 18.657023942417325, 811.8516436161027, 565.6628842740429, 335.03750932619596, 19.799999999999926, 65.53131374204423, 384.2263833535642, 13.496969649231009, 76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [231.98461296730184, -889.5518536878556, -636.6999833033303, -565.1053492363848, -875.6088553749028, -678.6118843851211, -861.2808716321314, -423.5482140854211, -736.291577663067, 189.83956670686274, -845.105785245211, -42.64204216481936, -72.23119853504078, -749.1218408838882, -939.1293103197174, -860.3168973551298, -762.3535340929877, -204.24097190614808, -633.6405359754125, -295.77810618769485, -901.6752929780332, -1064.8231371007662, -497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954], "policy_predator_policy_reward": [557.5513599918479, 773.9796922030337, 636.8999833033303, 569.9053492363846, 782.1315834541364, 1083.129709784175, 861.1566377528051, 442.32947190716993, 726.6904873340824, 631.6131672382229, 711.4666101341583, 741.9441015499148, 491.88716808931895, 664.5033806558077, 939.9293103197176, 879.3168973551299, 776.8715680817388, 255.25425165944065, 723.2803677338685, 590.3646577828018, 926.7330781274485, 1053.262321600576, 560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.243883107784734, "mean_inference_ms": 5.436394499689652, "mean_action_processing_ms": 2.1560623722969736, "mean_env_wait_ms": 12.395993978192045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009814739227294922, "StateBufferConnector_ms": 0.012622475624084473, "ViewRequirementAgentConnector_ms": 0.1794414520263672}, "num_episodes": 6, "episode_return_max": 811.8516436161027, "episode_return_min": -11.999999880533252, "episode_return_mean": 218.52898540211493, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.84138582188234, "num_env_steps_trained_throughput_per_sec": 148.84138582188234, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 27800.138, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27799.825, "sample_time_ms": 2800.577, "learn_time_ms": 24970.466, "learn_throughput": 160.189, "synch_weights_time_ms": 23.883}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "01806_00000", "date": "2024-08-22_13-07-38", "timestamp": 1724312258, "time_this_iter_s": 26.96774196624756, "time_total_s": 1617.9692027568817, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1617.9692027568817, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 39.12368421052632, "ram_util_percent": 81.60789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.33060276899388, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.417225609128438, "policy_loss": -0.009834594519010613, "vf_loss": 6.425596321449078, "vf_explained_var": 0.599498350847335, "kl": 0.007319346038506381, "entropy": 0.6136116996644035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.55822592185288, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.2293178220274585, "policy_loss": -0.008115713647197164, "vf_loss": 7.237288345357098, "vf_explained_var": 0.26157712955323476, "kl": 0.005807029425102488, "entropy": 0.23156921660143232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 754.6069504972796, "episode_reward_min": -11.999999880533252, "episode_reward_mean": 215.4848621689784, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1066.6161586619705, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1092.5872937258898}, "policy_reward_mean": {"prey_policy": -500.4987109627921, "predator_policy": 608.2411420472816}, "custom_metrics": {}, "hist_stats": {"episode_reward": [76.87698310233174, 99.39532497373547, 3.1086244689504383e-15, 39.437666660219406, 151.726774258177, 693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-497.1277409877839, -458.7180599990786, -756.859970286044, -842.8006140923642, -847.5751550258104, -1066.6161586619705, -0.25365593803613473, -738.153752897223, -895.6009229456749, -584.8262012486906, -988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414], "policy_predator_policy_reward": [560.6444952968504, 472.0782887923462, 661.3002476589562, 1037.7556616931895, 847.5751550258104, 1066.6161586619705, 28.69132259825544, 749.1537528972232, 895.3187863236983, 736.8351121288493, 880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.238686158680942, "mean_inference_ms": 5.439597259005733, "mean_action_processing_ms": 2.1592997879440334, "mean_env_wait_ms": 12.39556324051582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00890493392944336, "StateBufferConnector_ms": 0.012293457984924316, "ViewRequirementAgentConnector_ms": 0.18062853813171387}, "num_episodes": 11, "episode_return_max": 754.6069504972796, "episode_return_min": -11.999999880533252, "episode_return_mean": 215.4848621689784, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.51263721776021, "num_env_steps_trained_throughput_per_sec": 147.51263721776021, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 27531.79, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27531.544, "sample_time_ms": 2721.276, "learn_time_ms": 24780.582, "learn_throughput": 161.417, "synch_weights_time_ms": 25.544}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "01806_00000", "date": "2024-08-22_13-08-05", "timestamp": 1724312285, "time_this_iter_s": 27.174086809158325, "time_total_s": 1645.14328956604, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ad10d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.14328956604, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 38.72307692307694, "ram_util_percent": 81.55128205128204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.781956001816603, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.59726086571103, "policy_loss": -0.011196075185946135, "vf_loss": 6.606882019143887, "vf_explained_var": 0.5365620202488369, "kl": 0.007874726387302553, "entropy": 0.5934222214121037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.983218257137075, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.711858723655579, "policy_loss": -0.007631695813809832, "vf_loss": 7.719356193239727, "vf_explained_var": -0.018737052546607125, "kl": 0.00536877776473938, "entropy": 0.18509343302754497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 754.6069504972796, "episode_reward_min": -11.999999880533252, "episode_reward_mean": 222.39302084521555, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1037.1090522891582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1092.5872937258898}, "policy_reward_mean": {"prey_policy": -489.8675016036228, "predator_policy": 601.0640120262309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [693.6711170177049, 1.7153238210105068, 185.49497263142825, -11.999999880533252, 387.6334410082415, 439.41780653149306, 211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-988.2217276690508, 13.062212055177602, -641.9588086336051, -756.4794828877767, -567.6783871031648, -312.54739467013, -611.6075074135808, -866.9574202493596, -326.30182799510595, 81.32304348597498, -68.60338151886434, -543.6232886719546, -300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168], "policy_predator_policy_reward": [880.7176532276118, 788.1129794039607, 643.574132454616, 756.5794828877767, 547.3433827460761, 518.3773716586518, 876.2307014538577, 590.3342263285516, 287.19680431337054, 345.4154212040016, 513.3663874776156, 538.2780892446943, 525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.240400031791117, "mean_inference_ms": 5.440780217887562, "mean_action_processing_ms": 2.155984322318413, "mean_env_wait_ms": 12.385298414779934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007385373115539551, "StateBufferConnector_ms": 0.012317299842834473, "ViewRequirementAgentConnector_ms": 0.17731964588165283}, "num_episodes": 5, "episode_return_max": 754.6069504972796, "episode_return_min": -11.999999880533252, "episode_return_mean": 222.39302084521555, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.36932884521897, "num_env_steps_trained_throughput_per_sec": 147.36932884521897, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 27382.801, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27382.559, "sample_time_ms": 2671.136, "learn_time_ms": 24682.618, "learn_throughput": 162.057, "synch_weights_time_ms": 24.966}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "01806_00000", "date": "2024-08-22_13-08-32", "timestamp": 1724312312, "time_this_iter_s": 27.198188066482544, "time_total_s": 1672.3414776325226, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1672.3414776325226, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 37.86410256410256, "ram_util_percent": 81.1076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.829251771503024, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.499127753323348, "policy_loss": -0.008203528436620242, "vf_loss": 6.506195566389295, "vf_explained_var": 0.6088022241516718, "kl": 0.005678572057297936, "entropy": 0.6252005137779094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.11653605693232, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.154769244017424, "policy_loss": -0.007475149989246376, "vf_loss": 7.162065921763264, "vf_explained_var": 0.36635221596117373, "kl": 0.00713911001366026, "entropy": 0.22554492799062578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 754.6069504972796, "episode_reward_min": -6.868609544366359, "episode_reward_mean": 225.46187962876658, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1037.1090522891582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 306.74000089200047, "predator_policy": 1092.5872937258898}, "policy_reward_mean": {"prey_policy": -485.2873879932578, "predator_policy": 598.0183278076413}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.23263270905454, 514.1080338544158, 630.9993408416852, 223.9924905055589, 92.59047869137517, 155.9946281783913, 588.524151004768, 332.8015692386067, 133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-300.15966824090395, -700.1233640983355, -451.45919825685985, -430.60231142866826, 28.38804021096273, -891.2084693307979, -981.1119767715279, -903.8992883265365, -577.1514161219005, -851.8244868991596, -785.5059431017789, -18.332993329932158, -33.80384716147722, -975.0622401131853, -45.95999776401616, -153.6321329991489, -631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829], "policy_predator_policy_reward": [525.9006043465067, 685.6150607017856, 740.8611179998056, 655.3084255401441, 628.2865979053605, 865.5331720561626, 1092.5872937258898, 1016.4164618777318, 583.5011099849016, 938.0652717275364, 655.9888419271791, 303.8447226829251, 812.1304346137562, 785.2598036656734, 251.20967293563845, 281.1840270661338, 628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.236349817935878, "mean_inference_ms": 5.45235955402385, "mean_action_processing_ms": 2.151943170009761, "mean_env_wait_ms": 12.39555703773377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007441282272338867, "StateBufferConnector_ms": 0.012328743934631348, "ViewRequirementAgentConnector_ms": 0.17889225482940674}, "num_episodes": 6, "episode_return_max": 754.6069504972796, "episode_return_min": -6.868609544366359, "episode_return_mean": 225.46187962876658, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.44004785591179, "num_env_steps_trained_throughput_per_sec": 142.44004785591179, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 27466.086, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27465.881, "sample_time_ms": 2723.132, "learn_time_ms": 24714.306, "learn_throughput": 161.85, "synch_weights_time_ms": 25.15}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "01806_00000", "date": "2024-08-22_13-09-00", "timestamp": 1724312340, "time_this_iter_s": 28.17264986038208, "time_total_s": 1700.5141274929047, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1700.5141274929047, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 41.472500000000004, "ram_util_percent": 80.935}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.68777850292347, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.952656005173133, "policy_loss": -0.008597827681079112, "vf_loss": 6.959734921228318, "vf_explained_var": 0.5146264146244716, "kl": 0.007594635476550413, "entropy": 0.619571700550261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.936630854026351, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.337149711386867, "policy_loss": -0.00799482153610341, "vf_loss": 7.344939165266734, "vf_explained_var": 0.20927256963871144, "kl": 0.008214432523196574, "entropy": 0.1768678175788077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 493.0262500000026}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 797.1629889618661, "episode_reward_min": -6.868609544366359, "episode_reward_mean": 229.83716491355958, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1037.1090522891582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 363.8315693478838, "predator_policy": 1060.6927681396412}, "policy_reward_mean": {"prey_policy": -469.6965745657255, "predator_policy": 584.6151570225054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [133.79400877343068, 0.0056750647602126225, -6.868609544366359, 132.49999999999972, 425.96896797176424, 451.87702714973454, 299.3056843862104, 114.61795728081701, 63.8997547390587, 548.6080789407878, 1.339449426740293, 13.057954592071713, 163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-631.2911136869272, -365.4259183564132, -715.3340479614706, -895.6117864166273, -755.6862404122475, -178.3723876823977, -450.7886883267753, -462.00234949912505, -796.5629265430509, 306.74000089200047, -794.9946299421171, -84.88709539946123, -429.63371813078857, -641.750182370021, -765.5459142057051, -415.54735235020235, -501.27087741466914, -857.4560328828519, -444.5331579757398, 270.0469368425062, -608.2570749191378, -719.0851095194438, -725.7384211271348, -773.8931975128344, -133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218], "policy_predator_policy_reward": [628.4582125760774, 502.05282824069235, 715.3688214947024, 895.5826879481557, 211.19136096298666, 715.9986575872898, 552.1974494739179, 493.0935883519846, 170.80947474261094, 744.9824188802041, 649.9624298624444, 681.7963226288703, 802.4346966269782, 568.2548882600381, 545.7184959435123, 749.9927278932113, 680.978398214203, 741.6482668223728, 478.06719941271956, 245.02710066130174, 609.6658169324583, 719.0158169328638, 741.8384211271346, 770.8511521049063, 309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.238683235612468, "mean_inference_ms": 5.449083611884178, "mean_action_processing_ms": 2.1461737193642376, "mean_env_wait_ms": 12.38187170104429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007481575012207031, "StateBufferConnector_ms": 0.012367725372314453, "ViewRequirementAgentConnector_ms": 0.18464124202728271}, "num_episodes": 8, "episode_return_max": 797.1629889618661, "episode_return_min": -6.868609544366359, "episode_return_mean": 229.83716491355958, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.79258952740884, "num_env_steps_trained_throughput_per_sec": 146.79258952740884, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 27433.175, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27432.969, "sample_time_ms": 2689.965, "learn_time_ms": 24716.016, "learn_throughput": 161.838, "synch_weights_time_ms": 23.906}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "01806_00000", "date": "2024-08-22_13-09-28", "timestamp": 1724312368, "time_this_iter_s": 27.255858898162842, "time_total_s": 1727.7699863910675, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1727.7699863910675, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.62105263157895, "ram_util_percent": 79.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.676673952738444, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.6566593049064515, "policy_loss": -0.009613186896842702, "vf_loss": 6.664817525470068, "vf_explained_var": 0.6214942666588636, "kl": 0.007274878994073896, "entropy": 0.6108661857546953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.877625699774928, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.490866114096667, "policy_loss": -0.006731831115330496, "vf_loss": 7.497435284165478, "vf_explained_var": 0.3413362629199154, "kl": 0.006505845546495741, "entropy": 0.18795829200082356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -2.9539958061358518, "episode_reward_mean": 261.8326077769393, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1060.6927681396412}, "policy_reward_mean": {"prey_policy": -460.0026689641029, "predator_policy": 590.9189728525729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.91956838914444, 331.6710664017821, 153.02776316709085, 193.79452685992692, 3.6999999999999984, 344.0620623782165, 0.8476853157057984, 292.58250951487446, 243.9357359787972, 30.3669148252633, 386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-133.79909302093395, -613.6732518201143, -63.455004125044695, -288.6041408102563, -300.9629695169867, -197.72992141502382, -302.72785290840847, -428.68041155550554, -650.7223154630785, -634.2346052868091, -674.8548931637589, -43.25460359933522, -653.1858813857236, -682.1245014170371, -583.220007976759, -119.67199952179467, -675.3266918358061, -717.6878390634423, -1037.1090522891582, -549.608458671428, -357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888], "policy_predator_policy_reward": [309.3067881210204, 602.0851251091716, 371.0561156732066, 312.6740956638772, 266.03451353776296, 385.68614056134317, 514.6209492981072, 410.58184202573597, 651.2223154630786, 637.4346052868098, 342.9462934741802, 719.2252656671304, 653.027528128638, 683.1305399898289, 568.4908047416833, 426.9837122717426, 1013.8707106169226, 623.0795562611233, 1060.6927681396412, 556.3916576462076, 643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.25090523188175, "mean_inference_ms": 5.456149937054829, "mean_action_processing_ms": 2.132898770628926, "mean_env_wait_ms": 12.377835421952513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007705092430114746, "StateBufferConnector_ms": 0.012953996658325195, "ViewRequirementAgentConnector_ms": 0.4235210418701172}, "num_episodes": 12, "episode_return_max": 1204.8271343927536, "episode_return_min": -2.9539958061358518, "episode_return_mean": 261.8326077769393, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.43937912828557, "num_env_steps_trained_throughput_per_sec": 143.43937912828557, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 27516.569, "restore_workers_time_ms": 0.031, "training_step_time_ms": 27516.346, "sample_time_ms": 2752.239, "learn_time_ms": 24736.358, "learn_throughput": 161.705, "synch_weights_time_ms": 24.551}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "01806_00000", "date": "2024-08-22_13-09-56", "timestamp": 1724312396, "time_this_iter_s": 27.9564151763916, "time_total_s": 1755.726401567459, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3a13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1755.726401567459, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 40.495000000000005, "ram_util_percent": 79.54749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.33188505980073, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.706813270326645, "policy_loss": -0.008595793182276702, "vf_loss": 6.713856736945097, "vf_explained_var": 0.5919080188034703, "kl": 0.007761586423490256, "entropy": 0.6258770385747233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.807055524291187, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.233700781019907, "policy_loss": -0.005812262470720622, "vf_loss": 7.239297649847767, "vf_explained_var": 0.32529092402685256, "kl": 0.00861569546500625, "entropy": 0.20244963725723286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 482.39499999999674}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -2.9539958061358518, "episode_reward_mean": 270.47334404452346, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -451.6038502809538, "predator_policy": 586.8405223032157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.84249744714526, 58.89840221292214, 412.2964233348584, 1.8000000000000012, 103.47597299039434, 70.60121078034655, 11.510545128241082, 56.13268929824295, 196.59472410282223, 4.397834852210218, 62.9136174235148, 91.48456964084605, 11.299999999999995, 49.93669294891795, 135.83245987091632, 22.186966064400167, 15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-357.0325408269688, -155.8642006830226, -140.9257019903897, -604.0095398644652, -626.6790970908175, -321.05694926726267, -849.8299234323974, -657.5679839990777, -127.0278252690384, -205.9062800761962, -661.8152055039283, -770.5858074859041, -731.6262109451841, -734.3559588796311, -856.0853090844209, -635.7533186682282, -329.04634295610117, -277.1025289765262, -906.6398623398703, -491.22490876331875, -919.0652087667283, -413.39626432552393, -337.63381984535783, -799.3878241016362, -809.990784345201, -522.5008689795123, -976.4186418904832, -442.4128615804089, -455.21264645561104, -812.2597544750384, -257.85601589617244, -249.4549701996625, -837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246], "policy_predator_policy_reward": [643.72362837103, 256.01561058610474, 199.85001915848943, 603.9836249092867, 690.9914976455747, 669.0409720473625, 849.8299234323974, 659.3679839990781, 125.68819919891077, 310.7218791367179, 695.6447164490445, 807.3575073211374, 730.977717204121, 746.514997748935, 855.5159077735877, 692.4554092773049, 452.422666591794, 350.32092944366246, 907.5398623398705, 494.72274361552917, 583.0657413496857, 812.3093491660875, 428.518389486209, 799.9878241016363, 809.990784345201, 533.8008689795126, 486.59465454313784, 982.1735418766749, 581.7451063265277, 821.5597544750385, 12.571113814233046, 516.9268383460068, 838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.260405344156402, "mean_inference_ms": 5.468308474218845, "mean_action_processing_ms": 2.1278113422287577, "mean_env_wait_ms": 12.372903908776616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007763862609863281, "StateBufferConnector_ms": 0.012962102890014648, "ViewRequirementAgentConnector_ms": 0.4528137445449829}, "num_episodes": 10, "episode_return_max": 1204.8271343927536, "episode_return_min": -2.9539958061358518, "episode_return_mean": 270.47334404452346, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.0143055101784, "num_env_steps_trained_throughput_per_sec": 146.0143055101784, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 27486.793, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27486.574, "sample_time_ms": 2775.642, "learn_time_ms": 24686.346, "learn_throughput": 162.033, "synch_weights_time_ms": 21.57}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "01806_00000", "date": "2024-08-22_13-10-23", "timestamp": 1724312423, "time_this_iter_s": 27.44567084312439, "time_total_s": 1783.1720724105835, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1783.1720724105835, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 37.99999999999999, "ram_util_percent": 80.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.548788518754264, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.728164288858888, "policy_loss": -0.007536567067825999, "vf_loss": 6.73442548317884, "vf_explained_var": 0.4357366992683007, "kl": 0.006376859204222759, "entropy": 0.5554856037652051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.912672634225675, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.206227475625497, "policy_loss": -0.006092462424563352, "vf_loss": 7.212165593848657, "vf_explained_var": 0.1571115046581894, "kl": 0.006173103299267866, "entropy": 0.18122355496441878, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -2.9539958061358518, "episode_reward_mean": 293.2464968654407, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -430.99456591128603, "predator_policy": 577.6178143440065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.299999999999969, 443.98377279430673, 0.9881684158563224, 9.299999999999983, 455.3546610892338, 307.8034272481517, 591.834343660893, 495.8606412255524, 171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-837.1303702145111, -453.13701672795867, -807.9873473152296, 29.366937149833063, -745.5299427004435, -793.8385466769546, -884.9046752066894, -454.6075906547265, -232.68047366802202, -852.4313192651696, -48.75669836374643, -739.9130050954923, 152.25153581824878, -534.4271821522017, -491.85115033033065, -183.94131481213822, -607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407], "policy_predator_policy_reward": [838.2303702145114, 467.3370167279587, 729.2907443628004, 493.31343859690236, 746.3299427004437, 794.026715092811, 884.9046752066894, 463.90759065472724, 790.8410071112467, 749.625446911172, 519.9122476492272, 576.5608830581635, 408.59145804187096, 565.418531952979, 657.7829921741725, 513.8701141938462, 605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.258209857856894, "mean_inference_ms": 5.461882133922989, "mean_action_processing_ms": 2.1295917778182836, "mean_env_wait_ms": 12.377923479657099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265329360961914, "StateBufferConnector_ms": 0.012855291366577148, "ViewRequirementAgentConnector_ms": 0.42709100246429443}, "num_episodes": 16, "episode_return_max": 1204.8271343927536, "episode_return_min": -2.9539958061358518, "episode_return_mean": 293.2464968654407, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 145.15561464413634, "num_env_steps_trained_throughput_per_sec": 145.15561464413634, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 27521.617, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27521.308, "sample_time_ms": 2788.228, "learn_time_ms": 24704.732, "learn_throughput": 161.912, "synch_weights_time_ms": 23.892}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "01806_00000", "date": "2024-08-22_13-10-51", "timestamp": 1724312451, "time_this_iter_s": 27.63708782196045, "time_total_s": 1810.809160232544, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1810.809160232544, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 39.292307692307695, "ram_util_percent": 80.55384615384618}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.871179293072412, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.066061401871777, "policy_loss": -0.01086860224210396, "vf_loss": 7.075379192009174, "vf_explained_var": 0.46833748325469005, "kl": 0.007754078362427809, "entropy": 0.5197292633472927, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.01693894699137, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.316203277830094, "policy_loss": -0.007051621361206921, "vf_loss": 7.323113117520771, "vf_explained_var": 0.26237890196855734, "kl": 0.005670565093754145, "entropy": 0.16771601724719246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 287.71546062081995, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -428.13853659867, "predator_policy": 571.9962669090802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.0165243302266, 269.5806270605791, 64.12610501662819, -0.9254439670353758, 280.59175948492094, 7.479521788352114, -0.5081872125018205, 605.2990036763423, 220.18842273058777, 411.9262860780674, 529.8304082936003, 459.0456690312645, 648.6157159446547, 523.9658994773816, 328.04976100630887, 17.904507399376243, 6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-607.7056140237584, -299.23272670038375, -176.6437630241341, -718.2143592486724, -686.2278454854373, -1012.3956201226347, -716.3139984643097, -537.8954277150067, -634.0915622629533, -228.06587616022034, -5.0955348043529485, -490.9800775605295, -809.0692858325938, -531.5292067929931, -687.2922562062861, 166.8550698413826, -434.80159580827484, -505.54043886821285, -148.86849713292378, -710.2510990897183, -801.9092384813572, -106.67696038443776, -663.0479864164056, -121.69068938163508, -4.056940848915701, -591.7342948051406, -841.3710400965126, -249.92545415906494, -226.9446272310331, -707.3302511579309, -651.8608714635369, -38.33411676564073, -694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496], "policy_predator_policy_reward": [605.8156998769196, 472.13916517744946, 741.2817094990017, 423.15703983438414, 753.6549455977164, 1009.0946250269837, 725.1675663589932, 528.1164158532908, 536.1544062983435, 606.5947916097491, 0.0, 503.5551341532357, 813.7444440921258, 526.3458613209597, 563.5905907135017, 562.145599327739, 615.9676089364146, 544.562848470669, 568.076014652496, 702.9698676482149, 702.5669364247779, 735.8496707346136, 712.1071175558317, 531.6772272734685, 733.2713769149219, 511.135574683787, 793.3747381755794, 821.8876555573834, 475.48645817171933, 786.8381812235572, 671.3752355523574, 36.72426007619692, 698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.250730171871405, "mean_inference_ms": 5.460617787298279, "mean_action_processing_ms": 2.121799374226876, "mean_env_wait_ms": 12.359553521966662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005623579025268555, "StateBufferConnector_ms": 0.012725353240966797, "ViewRequirementAgentConnector_ms": 0.4171673059463501}, "num_episodes": 8, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 287.71546062081995, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.70413985060802, "num_env_steps_trained_throughput_per_sec": 146.70413985060802, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 27284.676, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27284.398, "sample_time_ms": 2551.534, "learn_time_ms": 24705.496, "learn_throughput": 161.907, "synch_weights_time_ms": 23.375}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "01806_00000", "date": "2024-08-22_13-11-18", "timestamp": 1724312478, "time_this_iter_s": 27.310906171798706, "time_total_s": 1838.1200664043427, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1838.1200664043427, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 40.81282051282051, "ram_util_percent": 81.11282051282052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.713433451627296, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.750890376075866, "policy_loss": -0.007809382986040815, "vf_loss": 6.757318177803484, "vf_explained_var": 0.5675841247593915, "kl": 0.006907990620170951, "entropy": 0.5436802507392944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.79041495272722, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.337177012206386, "policy_loss": -0.0069466247187592286, "vf_loss": 7.343991866439739, "vf_explained_var": 0.3123461718281741, "kl": 0.005271440839072167, "entropy": 0.16639254720753463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 293.962292946989, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -434.0709073272779, "predator_policy": 581.0520538007727}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.499999999999998, 3.101686387810304, 1.47464374963667, 754.6069504972796, -2.9539958061358518, 0.12860631655441468, 30.215758769972908, 573.1140800121623, 3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-694.4499148619933, -534.4463343073685, -636.8803104153963, -813.0092591346125, -484.512427084568, -825.7681583128397, 68.59130381360472, -594.8795447222105, -617.7593265557028, -501.618566219221, -836.4158155867295, -819.4408437972297, -733.5569422767869, -505.16278116158696, -706.9610277500357, -97.3618290507954, -550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328], "policy_predator_policy_reward": [698.3499148619935, 537.0463343073686, 651.8642292749386, 801.127026662883, 485.98707083420476, 825.7681583128397, 740.8702502358459, 540.0249411700406, 618.4145878443778, 498.009309124414, 836.5444219032839, 819.4408437972297, 739.0768038215374, 529.8586783868102, 743.96691515572, 633.470021657268, 552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.262252934780159, "mean_inference_ms": 5.455076188385554, "mean_action_processing_ms": 2.099352182851808, "mean_env_wait_ms": 12.321761494780457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005688190460205078, "StateBufferConnector_ms": 0.007828593254089355, "ViewRequirementAgentConnector_ms": 0.4298309087753296}, "num_episodes": 16, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 293.962292946989, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.92604944864627, "num_env_steps_trained_throughput_per_sec": 144.92604944864627, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 27416.897, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27416.6, "sample_time_ms": 2585.771, "learn_time_ms": 24803.201, "learn_throughput": 161.27, "synch_weights_time_ms": 23.389}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "01806_00000", "date": "2024-08-22_13-11-46", "timestamp": 1724312506, "time_this_iter_s": 27.67759609222412, "time_total_s": 1865.7976624965668, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1865.7976624965668, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 42.3825, "ram_util_percent": 81.4225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.174397813453876, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.902885145358939, "policy_loss": -0.008594486371628822, "vf_loss": 6.910192724258181, "vf_explained_var": 0.5831131589475763, "kl": 0.006434424360598087, "entropy": 0.5296740035216013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.382316537130446, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.411893221940944, "policy_loss": -0.006536154464754478, "vf_loss": 7.418288425162986, "vf_explained_var": 0.26683162507556735, "kl": 0.0056376991016179245, "entropy": 0.145076250872284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 299.5013292009281, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -411.68933036433793, "predator_policy": 561.4399949648023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.4000000000000004, 451.3610885895174, 491.43454034626825, 135.6347062723731, 13.499999999999968, 382.1721791893834, 365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-550.068593457766, -845.2660167637292, -285.9603908382752, 279.0401319208447, -478.0247084033448, 293.77510416026064, -278.45594062566624, -592.4558367056236, -375.8412755300795, -661.6216010355324, -168.00876253918725, 35.35946679004559, -444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624], "policy_predator_policy_reward": [552.4685934577661, 846.2660167637292, 201.21774152937402, 257.0636059775753, 447.0675895554697, 228.61655503388184, 606.5040687439637, 400.04241485970493, 388.84127553008193, 662.1216010355324, 256.4190854778389, 258.4023894606828, 594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.247366647400757, "mean_inference_ms": 5.449423112755942, "mean_action_processing_ms": 2.110166896849416, "mean_env_wait_ms": 12.322350384490912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007474780082702637, "StateBufferConnector_ms": 0.007923126220703125, "ViewRequirementAgentConnector_ms": 0.42977285385131836}, "num_episodes": 8, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 299.5013292009281, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.85129506575356, "num_env_steps_trained_throughput_per_sec": 139.85129506575356, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 27589.653, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27589.364, "sample_time_ms": 2662.966, "learn_time_ms": 24898.676, "learn_throughput": 160.651, "synch_weights_time_ms": 23.432}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "01806_00000", "date": "2024-08-22_13-12-14", "timestamp": 1724312534, "time_this_iter_s": 28.635812044143677, "time_total_s": 1894.4334745407104, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306a608b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1894.4334745407104, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 50.245000000000005, "ram_util_percent": 82.71499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.460326434947827, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.336502355747122, "policy_loss": -0.010345456666909355, "vf_loss": 7.345314083402119, "vf_explained_var": 0.5719202268060553, "kl": 0.007668658019974827, "entropy": 0.513337412082329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.703033172264302, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.526392146014663, "policy_loss": -0.009601768429721238, "vf_loss": 7.535802136274873, "vf_explained_var": 0.2280823028907574, "kl": 0.007670839490472443, "entropy": 0.14242179075246134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 299.3577613388893, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -410.710100991534, "predator_policy": 560.3889816609791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.28075243587705, 449.26654398996783, 66.61906042918818, 414.38814087447975, 126.79875741550623, 5.499999999999999, 403.7188332355734, 249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-444.1502531271922, -421.3404794350847, -287.34871983045474, -795.0917698733505, -691.1355058298127, -433.0387218370254, -252.91503670360558, -661.1073137385588, -356.7048623030084, -565.1735487611414, -610.5937006919082, -851.5720629187701, -530.9450594113979, -5.432218852898185, -31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408], "policy_predator_policy_reward": [594.2124055987708, 636.5590793993837, 761.4526297513856, 770.2544039423893, 688.8098929446717, 501.9833951513562, 619.9120808649183, 708.4984104517291, 607.7594908619756, 440.91767761768216, 616.0937006919081, 851.5720629187701, 530.3124973642336, 409.7836141356322, 296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.260224365416093, "mean_inference_ms": 5.466895936921353, "mean_action_processing_ms": 2.1138336199849577, "mean_env_wait_ms": 12.329843885046976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007502317428588867, "StateBufferConnector_ms": 0.008743643760681152, "ViewRequirementAgentConnector_ms": 0.43541717529296875}, "num_episodes": 6, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 299.3577613388893, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 112.72305020709511, "num_env_steps_trained_throughput_per_sec": 112.72305020709511, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 28426.542, "restore_workers_time_ms": 0.035, "training_step_time_ms": 28426.197, "sample_time_ms": 3425.535, "learn_time_ms": 24972.675, "learn_throughput": 160.175, "synch_weights_time_ms": 23.481}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "01806_00000", "date": "2024-08-22_13-12-50", "timestamp": 1724312570, "time_this_iter_s": 35.53257870674133, "time_total_s": 1929.9660532474518, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1929.9660532474518, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 54.51, "ram_util_percent": 81.86000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.089351436826917, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.112675659240238, "policy_loss": -0.007403760360524295, "vf_loss": 7.118664182935443, "vf_explained_var": 0.4529821190253767, "kl": 0.007076240088494997, "entropy": 0.5450684480881565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.361688580336395, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.185828494016455, "policy_loss": -0.009275410020792926, "vf_loss": 7.1949260368549, "vf_explained_var": 0.3321320950038849, "kl": 0.007114815343880938, "entropy": 0.15618317714601598, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 292.2389320548029, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -409.9053276888322, "predator_policy": 556.024793716234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.60215507097192, 398.63162831163237, 0.7999999999999974, 314.56591650755496, 429.87806052083647, 489.373298522685, 52.4, 224.55252840573885, 492.04873552762973, 306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-31.769175406141628, -672.3124299354067, 271.35774635749, -626.1413894915975, -612.4223593626729, -892.4597105355168, -80.13244864853209, -607.1424607875535, -274.75872276637324, -254.71691434753916, -328.9833548614871, -392.2834375770303, -683.7134404710848, -641.5454667546642, -566.4520941203374, -187.25958681668095, -684.72842488046, 28.14510283330829, -726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943], "policy_predator_policy_reward": [296.9231461881472, 656.760614224375, 262.6792658869382, 490.73600555879966, 613.2223593626729, 892.4597105355168, 395.2024486349274, 606.6383773087118, 317.4003800107199, 641.9533176240313, 590.2958711532223, 620.3442198079814, 772.6220741843293, 605.03683304142, 555.6380615244022, 422.6261478183562, 532.9469835618501, 615.6850740129277, 705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.280406980316167, "mean_inference_ms": 5.504144404268889, "mean_action_processing_ms": 2.1067438498204396, "mean_env_wait_ms": 12.344909445074329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007942438125610352, "StateBufferConnector_ms": 0.008754730224609375, "ViewRequirementAgentConnector_ms": 0.458176851272583}, "num_episodes": 7, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 292.2389320548029, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.24466531272589, "num_env_steps_trained_throughput_per_sec": 143.24466531272589, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 28504.699, "restore_workers_time_ms": 0.04, "training_step_time_ms": 28504.345, "sample_time_ms": 3453.508, "learn_time_ms": 25021.846, "learn_throughput": 159.86, "synch_weights_time_ms": 23.672}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "01806_00000", "date": "2024-08-22_13-13-18", "timestamp": 1724312598, "time_this_iter_s": 27.97384285926819, "time_total_s": 1957.93989610672, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aa43a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1957.93989610672, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 44.245000000000005, "ram_util_percent": 81.27250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.11624389577795, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.846259061621611, "policy_loss": -0.007205009741570663, "vf_loss": 6.852316066196987, "vf_explained_var": 0.5196238341154875, "kl": 0.005740047412278949, "entropy": 0.5653490352252173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.434951794336712, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.226944305783227, "policy_loss": -0.0069688132641314675, "vf_loss": 7.233755146006428, "vf_explained_var": 0.3144858140163321, "kl": 0.0063187266375977925, "entropy": 0.14378179727250306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 1204.8271343927536, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 279.0118027689721, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1141.7181789322738, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -413.5060509142926, "predator_policy": 553.011952298779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.689089954008, 129.95617641994275, 165.5653570031186, 791.3815868656645, 797.1629889618661, 197.05238971493418, 338.02411738464724, 461.94014719897046, 703.708383827014, 1204.8271343927536, 64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-726.4210215941758, -278.81899099440767, -59.951022628756675, -425.9087164294058, -405.7815118468236, -40.51789622981031, -240.23111904120952, -433.14597298512797, -693.1526711359993, 363.8315693478838, -335.60957870370606, -630.2068188309377, 67.8122554946273, -339.88269587938925, -66.30166444382807, -709.0007523257218, -824.3115096048234, 343.2126186854818, 335.9918336575166, -1141.7181789322738, -739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856], "policy_predator_policy_reward": [705.9108214795599, 606.0182810630337, 121.33211036136129, 494.4838051167462, 417.21978887872496, 194.64497620103242, 662.2210583339618, 802.5376205580436, 486.59961793083676, 639.8844728191431, 603.6043278489051, 559.264459400677, 490.5329557528771, 119.56160201653279, 559.8723888071975, 677.370175161322, 815.6637353005549, 369.14353944580074, 1051.950918241002, 958.6025614265043, 261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.312304766835468, "mean_inference_ms": 5.528608988092881, "mean_action_processing_ms": 2.0991447502799514, "mean_env_wait_ms": 12.360926785893009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0132066011428833, "StateBufferConnector_ms": 0.010759472846984863, "ViewRequirementAgentConnector_ms": 0.46376514434814453}, "num_episodes": 9, "episode_return_max": 1204.8271343927536, "episode_return_min": -20.255915918446874, "episode_return_mean": 279.0118027689721, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.2683718529866, "num_env_steps_trained_throughput_per_sec": 138.2683718529866, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 28589.427, "restore_workers_time_ms": 0.042, "training_step_time_ms": 28589.067, "sample_time_ms": 3407.323, "learn_time_ms": 25151.062, "learn_throughput": 159.039, "synch_weights_time_ms": 25.401}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "01806_00000", "date": "2024-08-22_13-13-47", "timestamp": 1724312627, "time_this_iter_s": 28.984740018844604, "time_total_s": 1986.9246361255646, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306a60c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1986.9246361255646, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 48.07073170731708, "ram_util_percent": 82.66341463414633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.265687584246276, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.98193128121593, "policy_loss": -0.01064563752644789, "vf_loss": 6.991095046391563, "vf_explained_var": 0.5078911940887492, "kl": 0.007409330175341989, "entropy": 0.5953905355047296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.97321415956689, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.312073674782243, "policy_loss": -0.00803262662172081, "vf_loss": 7.3199322720684075, "vf_explained_var": 0.35139681845114973, "kl": 0.00696175455820387, "entropy": 0.17574093341827393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 1001.9973782423317, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 257.5087728784626, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1036.482252615869, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 389.1790233784896, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -419.4517536018186, "predator_policy": 548.2061400410504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.08734327919532, 1001.9973782423317, 413.2719769866601, 411.00048902854326, 538.9869234612502, 246.72541614302864, 312.44612327300274, 136.16430875587494, 0.7999999999999989, 343.63475772933526, 137.0039950109032, 445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-739.7366187128415, -353.5371287783174, -1015.3361687526414, 389.1790233784896, -843.7355148243486, 107.20476997285982, -257.84341214390196, -527.2205688384729, -249.61518921753242, -794.8411428148476, -561.6554957372746, -166.82061125235174, -128.04197374427034, -556.5681850540617, -515.9397492303717, -452.12511360543505, -993.3570759185218, -659.445351603999, -66.33379830650162, -825.5056231976888, -460.9564427073123, -262.34737845308894, -113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513], "policy_predator_policy_reward": [261.68000258562074, 895.6810881847374, 761.7599763060714, 866.394547310412, 563.3481263994473, 586.4545954386967, 689.3630448126567, 506.70142519825896, 856.3958982405053, 727.047357253126, 425.02638917409297, 550.1751339585647, 506.8389332294234, 490.2173488419109, 662.6444774168599, 441.58469417482263, 993.4570759185218, 660.1453516039991, 426.01977891358854, 809.4544003199368, 491.5952416780088, 368.7125744932941, 595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.344500217726165, "mean_inference_ms": 5.557795540138617, "mean_action_processing_ms": 2.104076220524769, "mean_env_wait_ms": 12.400046996825989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01746511459350586, "StateBufferConnector_ms": 0.010801434516906738, "ViewRequirementAgentConnector_ms": 0.47523927688598633}, "num_episodes": 10, "episode_return_max": 1001.9973782423317, "episode_return_min": -20.255915918446874, "episode_return_mean": 257.5087728784626, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.1775838024576, "num_env_steps_trained_throughput_per_sec": 136.1775838024576, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 28801.829, "restore_workers_time_ms": 0.042, "training_step_time_ms": 28801.475, "sample_time_ms": 3590.226, "learn_time_ms": 25179.721, "learn_throughput": 158.858, "synch_weights_time_ms": 25.556}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "01806_00000", "date": "2024-08-22_13-14-17", "timestamp": 1724312657, "time_this_iter_s": 29.446864128112793, "time_total_s": 2016.3715002536774, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeec7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2016.3715002536774, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 46.95238095238095, "ram_util_percent": 83.18809523809523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.171282606780846, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.017491659537825, "policy_loss": -0.007947826765172144, "vf_loss": 7.024246325820842, "vf_explained_var": 0.5196498429964459, "kl": 0.005965817370698369, "entropy": 0.5561212542511168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.1535474083411, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.901990300637705, "policy_loss": -0.007866045460104942, "vf_loss": 6.909717496236166, "vf_explained_var": 0.2543126971633346, "kl": 0.005554232731210216, "entropy": 0.1753708626936983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 786.4543653491319, "episode_reward_min": -20.255915918446874, "episode_reward_mean": 256.64206393144366, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1036.482252615869, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35785159312303, "predator_policy": 1069.0909744270716}, "policy_reward_mean": {"prey_policy": -416.7365672715948, "predator_policy": 545.057599237317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.18366291929726, 66.91229699999221, 375.82071902391385, 391.58932821536195, 341.16866393943883, 48.30502811951805, 602.2475100165457, 77.32933167907069, 136.42092366517446, 25.171239452933712, 423.2779506126286, 300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-113.04946566005532, -689.209874291088, -421.43449980456626, -1036.482252615869, -687.5080131007526, -183.61240140074523, -209.10817678018606, 134.56370156475637, -45.8576021114499, -748.4956507457059, -236.5106895399856, -623.5271841056489, 346.7242999339653, -593.3075071776834, -720.4458387502635, -389.2351588751798, -610.0441221491434, -121.02550144657246, -672.0835623921857, 6.424515263507009, -45.61870816801984, -725.1860770344535, -275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945], "policy_predator_policy_reward": [595.6877655367482, 651.7552373336925, 455.7380749933569, 1069.0909744270716, 677.0151555504959, 569.9259779749174, 235.723680207363, 230.41012322342513, 577.9870834382438, 557.5348333583509, 260.2878074524922, 648.0550943126601, 270.4246115276401, 578.4061057326228, 697.7511394458116, 489.25918985870777, 613.0263551961777, 254.4641920647126, 672.5893184807583, 18.240968100854037, 536.404005734184, 657.6787300809142, 253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.426230800177866, "mean_inference_ms": 5.654459581046959, "mean_action_processing_ms": 2.1167712186666234, "mean_env_wait_ms": 12.483938398405485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022449731826782227, "StateBufferConnector_ms": 0.013077974319458008, "ViewRequirementAgentConnector_ms": 0.45918726921081543}, "num_episodes": 11, "episode_return_max": 786.4543653491319, "episode_return_min": -20.255915918446874, "episode_return_mean": 256.64206393144366, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 90.93805025498155, "num_env_steps_trained_throughput_per_sec": 90.93805025498155, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 30411.852, "restore_workers_time_ms": 0.041, "training_step_time_ms": 30411.403, "sample_time_ms": 4972.25, "learn_time_ms": 25401.466, "learn_throughput": 157.471, "synch_weights_time_ms": 30.841}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "01806_00000", "date": "2024-08-22_13-15-01", "timestamp": 1724312701, "time_this_iter_s": 44.1861310005188, "time_total_s": 2060.557631254196, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2060.557631254196, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 69.68387096774194, "ram_util_percent": 83.14516129032259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.696694591057994, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.103540881222518, "policy_loss": -0.010836127499936433, "vf_loss": 7.113080766970518, "vf_explained_var": 0.43014500242061715, "kl": 0.006481253944716795, "entropy": 0.485593346723173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.026423874860086, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.337730717532849, "policy_loss": -0.008259064861864009, "vf_loss": 7.3457458304349705, "vf_explained_var": 0.11141933398271994, "kl": 0.009758112254360365, "entropy": 0.1702161730597259, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 786.4543653491319, "episode_reward_min": -59.773723541410675, "episode_reward_mean": 237.17428079028457, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1004.9362619964755, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35785159312303, "predator_policy": 1003.6834248813584}, "policy_reward_mean": {"prey_policy": -426.6338465843274, "predator_policy": 545.22098697947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.9839693323195, 537.5827510051959, 459.9168645257318, 143.30870069719447, 140.6220456151064, 153.0235134894851, 2.5000000000000044, 242.24170866446445, 427.1302214167868, 587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-275.2622992533472, -372.0911403626888, -3.38083484179, -735.7946340344449, -303.50013654204093, -591.0828991413847, -681.322775394579, -349.9626984302932, -251.050568670821, -661.0264064039983, -443.9024482197474, -924.4454848388249, -526.983772557491, -807.2612602099553, -152.80729260416834, -462.7754063991566, -964.0802853724057, 37.55672061130357, -425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653], "policy_predator_policy_reward": [253.59054993059198, 694.7468590177612, 568.4386737427985, 708.3195461386306, 754.7979577444919, 599.7019424646682, 496.5066758156523, 678.0874987064151, 391.3244695551663, 661.374551134761, 696.1568679979459, 825.2145785501166, 529.0837725574914, 807.6612602099553, 355.53943195684985, 502.2849757109409, 516.0539324439687, 837.59985373392, 788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.525096043990499, "mean_inference_ms": 5.747039608823147, "mean_action_processing_ms": 2.1288521745243294, "mean_env_wait_ms": 12.594202741731563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02527618408203125, "StateBufferConnector_ms": 0.02376854419708252, "ViewRequirementAgentConnector_ms": 0.48427557945251465}, "num_episodes": 11, "episode_return_max": 786.4543653491319, "episode_return_min": -59.773723541410675, "episode_return_mean": 237.17428079028457, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.83860403306791, "num_env_steps_trained_throughput_per_sec": 126.83860403306791, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 30826.008, "restore_workers_time_ms": 0.041, "training_step_time_ms": 30825.555, "sample_time_ms": 5404.381, "learn_time_ms": 25381.064, "learn_throughput": 157.598, "synch_weights_time_ms": 31.886}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "01806_00000", "date": "2024-08-22_13-15-32", "timestamp": 1724312732, "time_this_iter_s": 31.55500602722168, "time_total_s": 2092.112637281418, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306ab3b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2092.112637281418, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 49.22888888888888, "ram_util_percent": 83.31777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.141070035147287, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.3978485097330084, "policy_loss": -0.008776743487065667, "vf_loss": 7.405076635956133, "vf_explained_var": 0.45574576097821434, "kl": 0.007742929750826782, "entropy": 0.48951542345935073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.188449974917862, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.607713557551147, "policy_loss": -0.006069947764395721, "vf_loss": 7.613591332410379, "vf_explained_var": 0.227991884347623, "kl": 0.007686708930130831, "entropy": 0.17091627150931687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -59.773723541410675, "episode_reward_mean": 236.5029111396692, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1004.9362619964755, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 378.35785159312303, "predator_policy": 1003.6834248813584}, "policy_reward_mean": {"prey_policy": -429.8282689977925, "predator_policy": 548.0797245676274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [587.5349821974344, 192.6961090965815, 78.7999999999998, 30.602642959281155, 208.12718912235292, -4.793090581454944, 11.417321006755271, 301.98586096776796, 14.174625394881925, 101.75622881655961, 637.6026274582232, 725.4337328276289, -20.255915918446874, 483.35502203611077, 2.0000000000000036, 121.70685694874608, 19.126456024220758, 505.55524000947895, 177.90756739980586, 646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-425.53032496532404, -667.7413263049874, -554.6202428658777, 78.92116032649209, 40.0000000000003, 19.971053852837986, -809.0774301263607, -399.8665050500119, -48.13665288478331, -642.1505600155407, -763.4110695202411, -556.2410212893201, -806.2547525561355, -398.281218628632, 23.98288664256398, -495.03568434450295, -706.5259078532573, -861.0258918818043, -432.02818421167484, -29.625475377163, -580.8299357668062, 219.8911113618914, -861.9538602132768, 26.221357215140355, -546.8341586197572, -540.3604926493496, -575.797767137441, -268.9721709461039, -781.7612248773296, -566.825564198994, -590.5524689041054, -568.0060521585206, -799.5788573553751, -579.6029531515096, 48.502193323613746, -645.631748765923, -791.7670616926789, -291.3075040350809, 110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856], "policy_predator_policy_reward": [788.8540512097585, 891.9525822579975, 558.7601397044939, 109.6350519314741, 0.0, 18.828946147161993, 816.2370802584232, 423.30949787723193, 288.5047681712321, 609.9096338514465, 764.7110695202413, 550.1479307078657, 614.0101481137059, 601.9431440778174, 338.61752339758635, 434.42113527212257, 711.7005332481393, 870.0258918818043, 445.4281842116779, 117.9817041937243, 450.4638134771357, 548.0776383860036, 742.7052615258879, 818.4609742998738, 422.61198468553937, 644.3267506651213, 582.2116222741121, 745.9133378455471, 781.7612248773296, 568.8255641989941, 718.4253970310285, 561.8399809803461, 806.775402646103, 591.5328638850037, 490.59898038464877, 612.0858150671389, 794.9126666168306, 466.0694665107401, 632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.612280791348334, "mean_inference_ms": 5.8213550886050385, "mean_action_processing_ms": 2.1370499778414613, "mean_env_wait_ms": 12.679201057176295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02533245086669922, "StateBufferConnector_ms": 0.023762106895446777, "ViewRequirementAgentConnector_ms": 0.49013376235961914}, "num_episodes": 9, "episode_return_max": 898.9524975342854, "episode_return_min": -59.773723541410675, "episode_return_mean": 236.5029111396692, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.08971014007352, "num_env_steps_trained_throughput_per_sec": 143.08971014007352, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 30865.797, "restore_workers_time_ms": 0.043, "training_step_time_ms": 30865.409, "sample_time_ms": 5397.044, "learn_time_ms": 25430.325, "learn_throughput": 157.293, "synch_weights_time_ms": 30.644}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "01806_00000", "date": "2024-08-22_13-16-01", "timestamp": 1724312761, "time_this_iter_s": 28.036137104034424, "time_total_s": 2120.1487743854523, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeec7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2120.1487743854523, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 45.839999999999996, "ram_util_percent": 82.985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.609614063444592, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.269733547029041, "policy_loss": -0.006864990531984303, "vf_loss": 7.275484363111869, "vf_explained_var": 0.4237472131769493, "kl": 0.005570837062975717, "entropy": 0.48872394757296045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.53592776974673, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.338628783553997, "policy_loss": -0.005924580703987174, "vf_loss": 7.344420065198626, "vf_explained_var": 0.24323547309037868, "kl": 0.005331587398464166, "entropy": 0.16523094910477834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 214.53274742957433, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 9.757227620297176}, "policy_reward_max": {"prey_policy": 378.35785159312303, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -452.6596278952454, "predator_policy": 559.9260016100329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [646.8542953112819, 3.419429952213948, 223.7352934115776, 759.1601371149727, 132.75882416101453, 370.7215448633756, 711.8187255519654, 172.12622540134478, 786.4543653491319, 44.169829220422905, 78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [110.7701573381837, -899.910791277617, -701.3524058409737, -1004.9362619964755, -377.5504348904605, -356.6905564951636, -871.9699536415453, 109.44998790395975, -536.9444327804517, -776.1816485195795, -226.40541995144042, -755.9835100810965, -643.2041595486625, 193.09616232147187, -749.2416851649413, -302.6476846262624, 83.12956926581037, -702.772539561546, -546.0236599086238, -598.0458850203328, -31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542], "policy_predator_policy_reward": [632.2364524480523, 803.7584768026638, 706.0246729083053, 1003.6834248813584, 347.5783925327533, 610.397892264447, 834.3988137785208, 687.281289074036, 697.6244002318431, 748.2605052292023, 716.8528373435723, 636.2576375523419, 515.6752380663089, 646.2514847128485, 744.2913276227773, 479.7242675697745, 749.8440569469603, 656.2532786979081, 541.6092968646844, 646.6300772846961, 51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.851815372887457, "mean_inference_ms": 6.053751570110487, "mean_action_processing_ms": 2.177624830493511, "mean_env_wait_ms": 12.962493629825675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08189225196838379, "StateBufferConnector_ms": 0.04227864742279053, "ViewRequirementAgentConnector_ms": 0.6066344976425171}, "num_episodes": 19, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 214.53274742957433, "episodes_this_iter": 19}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.08991346794339, "num_env_steps_trained_throughput_per_sec": 104.08991346794339, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 31982.059, "restore_workers_time_ms": 0.047, "training_step_time_ms": 31981.657, "sample_time_ms": 6576.841, "learn_time_ms": 25365.52, "learn_throughput": 157.694, "synch_weights_time_ms": 31.059}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "01806_00000", "date": "2024-08-22_13-16-39", "timestamp": 1724312799, "time_this_iter_s": 38.50995683670044, "time_total_s": 2158.6587312221527, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2158.6587312221527, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 56.959259259259255, "ram_util_percent": 82.88148148148149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.439088161407955, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.48782780107367, "policy_loss": -0.006290968399859531, "vf_loss": 7.493017023076456, "vf_explained_var": 0.5291605788563926, "kl": 0.005508815195096075, "entropy": 0.4779994673199124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.074956157724692, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.485601194573458, "policy_loss": -0.006779915278176309, "vf_loss": 7.4922336210018745, "vf_explained_var": 0.2635593170211429, "kl": 0.0058996012801472, "entropy": 0.1658628671178742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 196.35095678796446, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 9.757227620297176}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -452.0011910844241, "predator_policy": 550.1766694784066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.09873902708276, 71.74381169555855, 616.2444843358628, 123.0647926279994, 96.6955782895721, 277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-31.290545704248352, -49.95228212571326, -980.8629538391992, -94.32951435857561, 121.5232838110229, -532.1613603006383, -151.07177218436814, -224.68829136088414, -621.0329989211408, -81.04218693492699, -691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095], "policy_predator_policy_reward": [51.081951701357625, 108.25961515568638, 981.4629538391991, 165.4733260541343, 287.14944234128535, 739.7331184841938, 264.46401127635824, 234.36084489689304, 597.2065711288041, 201.5641930168357, 457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.978340994015902, "mean_inference_ms": 6.193359339888471, "mean_action_processing_ms": 2.1930499981005416, "mean_env_wait_ms": 13.119197082244563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08196008205413818, "StateBufferConnector_ms": 0.039463043212890625, "ViewRequirementAgentConnector_ms": 0.5925986766815186}, "num_episodes": 10, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 196.35095678796446, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 133.1345051928613, "num_env_steps_trained_throughput_per_sec": 133.1345051928613, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 32226.475, "restore_workers_time_ms": 0.057, "training_step_time_ms": 32226.099, "sample_time_ms": 6624.47, "learn_time_ms": 25562.545, "learn_throughput": 156.479, "synch_weights_time_ms": 31.098}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "01806_00000", "date": "2024-08-22_13-17-09", "timestamp": 1724312829, "time_this_iter_s": 30.06176209449768, "time_total_s": 2188.7204933166504, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b85430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2188.7204933166504, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 51.1186046511628, "ram_util_percent": 81.35116279069766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.10351710849338, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.0242349680138645, "policy_loss": -0.007881687976735293, "vf_loss": 7.030880245834432, "vf_explained_var": 0.442925326786344, "kl": 0.006181971755657325, "entropy": 0.48106162964351595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.072304335851516, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.937748626426414, "policy_loss": -0.007880828510871324, "vf_loss": 6.945404982188391, "vf_explained_var": 0.25782422735577537, "kl": 0.008978660936620106, "entropy": 0.20410856344397105, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 493.02624999999534}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 195.576655260439, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 9.757227620297176}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -462.9788828131948, "predator_policy": 560.7672104434147}, "custom_metrics": {}, "hist_stats": {"episode_reward": [277.37526141722105, 170.4681418465336, 486.40054608136114, 40.923600035034056, 559.213906788801, 354.44180877714575, 88.18876483599728, 330.365739036641, 90.01190872004388, 409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-691.869327511987, 20.45345349074912, -167.07443467050416, -518.1961840453536, -455.0475776497197, -400.67369253000624, -595.6949194305665, -274.6331935691534, -204.71836515742314, 378.35785159312303, -231.61611158134932, -114.22801323744153, -177.90150290619414, -653.6803500555637, -157.06431032522067, -714.7963892434826, -528.295850940196, -157.41139361380408, -593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108], "policy_predator_policy_reward": [457.5020223463417, 491.2891130921177, 244.45074866547938, 611.2880118969107, 672.2941276518573, 669.8276886092362, 595.6560588541547, 315.5956541806012, 224.43880710539824, 161.13561324769617, 558.059982011692, 142.2259515842435, 265.79026774219005, 653.9803500555638, 407.63733860195424, 794.5891000033911, 418.5621084919311, 357.15704478211273, 595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.0502210676242045, "mean_inference_ms": 6.269339956975484, "mean_action_processing_ms": 2.1981903311941142, "mean_env_wait_ms": 13.182273510623977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08076906204223633, "StateBufferConnector_ms": 0.03931128978729248, "ViewRequirementAgentConnector_ms": 0.5874313116073608}, "num_episodes": 5, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 195.576655260439, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.61308937726115, "num_env_steps_trained_throughput_per_sec": 114.61308937726115, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 32856.296, "restore_workers_time_ms": 0.057, "training_step_time_ms": 32855.918, "sample_time_ms": 6897.503, "learn_time_ms": 25919.243, "learn_throughput": 154.325, "synch_weights_time_ms": 31.124}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "01806_00000", "date": "2024-08-22_13-17-44", "timestamp": 1724312864, "time_this_iter_s": 34.95458388328552, "time_total_s": 2223.675077199936, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc58b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2223.675077199936, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.489795918367335, "ram_util_percent": 82.64489795918367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.9085173682561, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.0868443267055286, "policy_loss": -0.007979497239708151, "vf_loss": 7.093479447137742, "vf_explained_var": 0.41690558523097365, "kl": 0.0067219286666759265, "entropy": 0.4825751444334706, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.230695905130375, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.140162916536684, "policy_loss": -0.007779408828724944, "vf_loss": 7.147741583163145, "vf_explained_var": 0.39973060744149347, "kl": 0.008029263713840572, "entropy": 0.17486998591788863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 185.96515330148347, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 9.757227620297176}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -481.54038726168744, "predator_policy": 574.5229639124294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [409.5045784060841, 0.09999999999999964, 21.027361189698937, 110.92932028596145, 274.6506996037284, 33.190820888012425, 270.2863795984707, 2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-593.9797149400973, 47.84734956293397, -636.0109630070815, -698.671358005901, -888.0325691358676, -412.7403127057775, -326.6827627834896, -238.69321191885678, -260.25439232255917, -346.8353936582431, -702.6562546098136, -866.7835767151803, -357.7712277580193, -464.3302047758943, -669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999], "policy_predator_policy_reward": [595.2358743306027, 360.40106945264563, 636.1109630070815, 698.671358005901, 887.4083189530526, 434.3919240782939, 342.5393280748665, 333.76596691344656, 578.6533123277155, 303.08717325681545, 814.9330484518746, 787.6976037611348, 437.6278073042236, 654.7600048281604, 672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.167224589655677, "mean_inference_ms": 6.378069581794506, "mean_action_processing_ms": 2.204916409039643, "mean_env_wait_ms": 13.308044677440805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0799485445022583, "StateBufferConnector_ms": 0.03851723670959473, "ViewRequirementAgentConnector_ms": 0.6075543165206909}, "num_episodes": 9, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 185.96515330148347, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.62400017475736, "num_env_steps_trained_throughput_per_sec": 137.62400017475736, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 32214.249, "restore_workers_time_ms": 0.056, "training_step_time_ms": 32213.935, "sample_time_ms": 6325.899, "learn_time_ms": 25851.21, "learn_throughput": 154.732, "synch_weights_time_ms": 28.971}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "01806_00000", "date": "2024-08-22_13-18-13", "timestamp": 1724312893, "time_this_iter_s": 29.10910701751709, "time_total_s": 2252.784184217453, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306a609d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2252.784184217453, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 42.12619047619047, "ram_util_percent": 82.82380952380952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.196097548550398, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.810870993578876, "policy_loss": -0.009153733841542687, "vf_loss": 6.818672128203054, "vf_explained_var": 0.498514690348711, "kl": 0.0067629476765259395, "entropy": 0.5105160022854174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.041654433144462, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.961533713971496, "policy_loss": -0.006958759373063764, "vf_loss": 6.968325294514813, "vf_explained_var": 0.4354373883318018, "kl": 0.006687304700746955, "entropy": 0.1490530176058648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 184.91436015367282, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 9.757227620297176}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -482.53079743704546, "predator_policy": 574.9879775138821}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.6000000000000005, 427.76445861384684, 325.2280211478104, 145.7390013320997, 100.89999999999841, 95.95225819859267, 14.589860451676577, -5.9254221330895795, 222.29121667302562, 188.00230542516297, 529.3679491890716, 22.381692503167912, 316.97087034395594, 440.07379274837643, 6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-669.4247171953666, -710.8986031017862, -815.9062957038443, -249.19282897845565, -474.44415093374755, -212.6719621858058, -808.9923840829276, -393.16228869055544, 33.23043143309592, 34.89139768247443, -835.1663286461961, -198.33331888381204, -636.1852241383539, -160.2566247835571, -496.4582541548252, -424.64065762558846, -282.7162396862094, -657.1351629888856, -229.46427437651107, -794.1845289549217, -578.7652934374262, 129.41094634223168, -217.77097430965463, -749.0520353293697, -739.8796279795832, -179.0753661835584, 374.52674441481446, -140.78278064101787, -563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305], "policy_predator_policy_reward": [672.024717195367, 710.8986031017862, 779.2111954047945, 713.6523878913505, 503.9510950236361, 508.39303924372484, 721.8364242809821, 626.0572498246061, 23.020943264132896, 9.757227620297176, 835.0322965091065, 294.41960921949374, 639.5385189279025, 171.49319044568375, 614.2540881569919, 300.9194014903358, 526.0796062493484, 636.0630130987711, 595.1818413470937, 616.4692674095052, 306.9626521484084, 671.759644135857, 203.80355502131633, 785.4011471208785, 757.2717950906521, 478.654069416446, 31.147048333559116, 175.1827806410159, 569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.260332368075982, "mean_inference_ms": 6.456334135758331, "mean_action_processing_ms": 2.240250846828482, "mean_env_wait_ms": 13.419974737206285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07963001728057861, "StateBufferConnector_ms": 0.041327834129333496, "ViewRequirementAgentConnector_ms": 0.6136709451675415}, "num_episodes": 7, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 184.91436015367282, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 95.91105349598378, "num_env_steps_trained_throughput_per_sec": 95.91105349598378, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 33592.351, "restore_workers_time_ms": 0.05, "training_step_time_ms": 33592.048, "sample_time_ms": 7409.019, "learn_time_ms": 26143.698, "learn_throughput": 153.001, "synch_weights_time_ms": 32.143}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "01806_00000", "date": "2024-08-22_13-18-55", "timestamp": 1724312935, "time_this_iter_s": 41.76000785827637, "time_total_s": 2294.5441920757294, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeeddd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2294.5441920757294, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 63.25689655172413, "ram_util_percent": 83.10344827586206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.969457818339112, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.794528610996468, "policy_loss": -0.009381654409435454, "vf_loss": 6.80208915478338, "vf_explained_var": 0.3980296599171149, "kl": 0.00910570422315566, "entropy": 0.5478267123459508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.06651081761355, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 7.158110090286013, "policy_loss": -0.008974373719048878, "vf_loss": 7.166878055390858, "vf_explained_var": 0.3063595971102437, "kl": 0.008256837082090516, "entropy": 0.16377479975658749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 189.3555586739556, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 29.948370454046167}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -474.0454982973957, "predator_policy": 568.7232776343736}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.099999999999992, 184.76264687479127, 425.06095207809926, 552.162286030968, 281.1218874783812, 35.77871376374777, 349.11932259856576, 452.8146276923909, 118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-563.8740111154169, -855.0212901282865, -347.0644177851475, -275.6966583129863, -1.7866537057767513, -505.73186484913913, -605.3657671934975, 34.21377298046531, -439.3606738169838, -744.5276275443513, -625.64388707056, -514.0007329709752, -18.821909740693513, -540.3196026610962, -619.6691788302759, -27.825909029452703, -499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058], "policy_predator_policy_reward": [569.9740111154176, 855.0212901282865, 148.38571567937754, 659.1380072935492, 457.4735939693135, 475.10587666370236, 552.4062709858016, 570.9080092581978, 762.8971441491235, 702.1130446906016, 630.2438870705611, 545.1794467347231, 383.9990392699924, 524.2617957303637, 527.74395960934, 572.5657559427758, 498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.460680367868472, "mean_inference_ms": 6.642544583663436, "mean_action_processing_ms": 2.29463847498071, "mean_env_wait_ms": 13.661493580263373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07429647445678711, "StateBufferConnector_ms": 0.03928542137145996, "ViewRequirementAgentConnector_ms": 0.6106845140457153}, "num_episodes": 14, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 189.3555586739556, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.07764226826447, "num_env_steps_trained_throughput_per_sec": 125.07764226826447, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 33897.44, "restore_workers_time_ms": 0.049, "training_step_time_ms": 33897.14, "sample_time_ms": 7747.07, "learn_time_ms": 26109.559, "learn_throughput": 153.201, "synch_weights_time_ms": 32.84}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "01806_00000", "date": "2024-08-22_13-19-27", "timestamp": 1724312967, "time_this_iter_s": 32.03645586967468, "time_total_s": 2326.580647945404, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306a60670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2326.580647945404, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 47.71777777777778, "ram_util_percent": 83.19111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.466006179587552, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.944069706447541, "policy_loss": -0.006581412256503152, "vf_loss": 6.9495393278737545, "vf_explained_var": 0.41689566253985044, "kl": 0.005558939275908328, "entropy": 0.5229035723146307, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.792188507160812, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.980171781872946, "policy_loss": -0.007543746366229637, "vf_loss": 6.987561804150778, "vf_explained_var": 0.31349807454164696, "kl": 0.006148969511767583, "entropy": 0.14826651301491198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 183.29036324492168, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 29.948370454046167}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -472.9595388820002, "predator_policy": 564.6047205044613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [118.67869811764012, 636.0022202069481, 542.6815454734514, 574.3822823618516, 151.3021106399072, 416.91776643239854, 1.8463506925269573, 239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-499.4638134525214, -729.3948223808221, 52.25130504333443, -747.1626055283824, -594.4629044703354, -52.31005283159203, -144.5526261570815, -756.4731846437636, -153.24263076384477, -885.2809492759385, 2.3782675765502908, -686.9063578483787, -745.4422436659671, -597.0391224382104, -439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246], "policy_predator_policy_reward": [498.06939394816175, 849.4679400028244, 650.3807763791698, 680.5327443128232, 581.8348550176795, 607.6196477576965, 698.6682476494265, 776.7398455132679, 303.8447414037509, 885.9809492759387, 475.0119807084604, 626.4338759957632, 745.7422436659671, 598.5854731307373, 361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.563837531962744, "mean_inference_ms": 6.745531126664527, "mean_action_processing_ms": 2.3203696557444933, "mean_env_wait_ms": 13.775502865765262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06978166103363037, "StateBufferConnector_ms": 0.0391087532043457, "ViewRequirementAgentConnector_ms": 0.48795902729034424}, "num_episodes": 8, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 183.29036324492168, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 133.3503607133673, "num_env_steps_trained_throughput_per_sec": 133.3503607133673, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 33959.714, "restore_workers_time_ms": 0.05, "training_step_time_ms": 33959.415, "sample_time_ms": 7765.303, "learn_time_ms": 26153.85, "learn_throughput": 152.941, "synch_weights_time_ms": 33.251}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "01806_00000", "date": "2024-08-22_13-19-57", "timestamp": 1724312997, "time_this_iter_s": 30.035202980041504, "time_total_s": 2356.6158509254456, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2356.6158509254456, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 42.88604651162791, "ram_util_percent": 82.8232558139535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.23628817866088, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.337448972368997, "policy_loss": -0.007594880362647393, "vf_loss": 6.34374834444157, "vf_explained_var": 0.5896180049452201, "kl": 0.006477514062589281, "entropy": 0.6189797727834611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.277107949231667, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.681861999552086, "policy_loss": -0.00841387893472399, "vf_loss": 6.690074540193749, "vf_explained_var": 0.44960908662705196, "kl": 0.008053960513185571, "entropy": 0.13833948296529275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 165.08052715246052, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 3.419168101911282}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -469.99573190690614, "predator_policy": 552.5359954831367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.92417922880804, 6.799999999999995, -12.670652890957712, 0.7387463440671431, 266.12884228101757, 80.37834711262596, 157.74387808482655, 339.63981975011063, -59.773723541410675, 67.40667839948836, 132.913393933778, 7.343011054414797, 339.4650971505157, 280.414145554314, 26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-439.0264264077121, -69.13209594993945, -492.5007328496877, -610.2037883840968, -689.6818176687486, -739.0590084888804, -875.7013306393109, -138.3352495982241, -626.1921628121448, -280.91364197309474, -874.1019521395613, -51.3203244129491, -366.8892509693515, -148.79166465108221, -105.04009943515128, -680.5911251799267, -567.3362572887959, -601.7599327647189, -401.60931963016634, -450.5670177834495, -101.41894643359988, -625.7586128990364, -857.4671889801677, -78.24620695168653, -293.6931724424971, -963.8828719511664, -908.2477440143408, -283.83633357391466, -909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291], "policy_predator_policy_reward": [361.70246670709497, 386.3802348793684, 499.2007328496889, 610.3037883840968, 776.9038970680506, 639.1662761986177, 890.6416160903809, 124.13371049122185, 556.6254930403805, 616.6091540258805, 131.69867152557484, 874.1019521395613, 277.14520854213646, 396.2795851631295, 615.0311379762743, 510.2399063889092, 665.8652744584756, 443.45719205362775, 507.97707933886716, 411.60593647424497, 256.549095579958, 603.5418576864554, 858.3258785638645, 84.7305284224045, 647.3828313860816, 949.6583101580964, 876.7401500683575, 595.7580730742188, 906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.628787197491029, "mean_inference_ms": 6.788264050595173, "mean_action_processing_ms": 2.3416468608760606, "mean_env_wait_ms": 13.859366885111037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06484866142272949, "StateBufferConnector_ms": 0.03640627861022949, "ViewRequirementAgentConnector_ms": 0.38057613372802734}, "num_episodes": 7, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 165.08052715246052, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.27521262100475, "num_env_steps_trained_throughput_per_sec": 141.27521262100475, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 32392.411, "restore_workers_time_ms": 0.051, "training_step_time_ms": 32392.2, "sample_time_ms": 6354.889, "learn_time_ms": 26000.418, "learn_throughput": 153.844, "synch_weights_time_ms": 30.199}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "01806_00000", "date": "2024-08-22_13-20-26", "timestamp": 1724313026, "time_this_iter_s": 28.362953901290894, "time_total_s": 2384.9788048267365, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b85820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2384.9788048267365, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 39.055, "ram_util_percent": 82.615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.273236963484024, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.791759871931934, "policy_loss": -0.007947014071658333, "vf_loss": 6.798330561824576, "vf_explained_var": 0.4366144769406193, "kl": 0.006881698345637353, "entropy": 0.5647980179420855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.563444827094912, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.841925741629626, "policy_loss": -0.007844642869556549, "vf_loss": 6.849578970449942, "vf_explained_var": 0.47445083061854043, "kl": 0.007656181601083113, "entropy": 0.13400412018967683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 898.9524975342854, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 165.95674823097724, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 3.419168101911282}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -475.02261344459765, "predator_policy": 558.0009875600866}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.547132023569848, -20.20865023917236, 389.49081998759584, 11.799999999999974, 18.7, 395.0117676736359, 898.9524975342854, 6.799999999999992, 6.999999999999998, 22.6161165235171, 129.25188076937025, -102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-909.3453611264946, -144.56733694999656, -682.6663615750699, -724.4203258058805, -166.9322038698074, 48.84380340045291, -721.8290437705873, -527.7965195105076, -620.8396234173412, -506.720662497566, -767.9880750487562, -231.39734019312934, -746.4245050659488, 43.68557205368856, -636.6841693105707, -994.5662801363954, -668.460588058735, -773.7516332231627, -765.9035222047936, -463.9339845302365, -710.2643466575297, -441.3889977030972, -501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677], "policy_predator_policy_reward": [906.0999780021187, 174.35985209794228, 715.4425707568874, 671.4354663848908, 208.99112204132726, 298.5880984156199, 728.2290437705881, 533.1965195105083, 622.639623417341, 523.6206624975672, 650.6587946335187, 743.7383882819978, 819.6370889690346, 782.0543415775095, 637.5841693105709, 1000.4662801363954, 669.7605880587353, 779.451633223164, 767.9035222047938, 484.55010105375476, 664.2339765611327, 616.6712485688663, 396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.737502990005843, "mean_inference_ms": 6.899937377291929, "mean_action_processing_ms": 2.378343205623857, "mean_env_wait_ms": 14.008862105588015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.061979055404663086, "StateBufferConnector_ms": 0.02584969997406006, "ViewRequirementAgentConnector_ms": 0.33217060565948486}, "num_episodes": 14, "episode_return_max": 898.9524975342854, "episode_return_min": -102.10553377885074, "episode_return_mean": 165.95674823097724, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.37889889081703, "num_env_steps_trained_throughput_per_sec": 137.37889889081703, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 32150.453, "restore_workers_time_ms": 0.052, "training_step_time_ms": 32150.245, "sample_time_ms": 5927.012, "learn_time_ms": 26187.421, "learn_throughput": 152.745, "synch_weights_time_ms": 30.14}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "01806_00000", "date": "2024-08-22_13-20-55", "timestamp": 1724313055, "time_this_iter_s": 29.167419910430908, "time_total_s": 2414.1462247371674, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aef214c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2414.1462247371674, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 41.459523809523816, "ram_util_percent": 82.82142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.84363889492378, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.71212159464599, "policy_loss": -0.00864745675679789, "vf_loss": 6.719364906492688, "vf_explained_var": 0.5458410155836236, "kl": 0.007020646144473363, "entropy": 0.5675558502396578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.748336542220343, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.4557007037773335, "policy_loss": -0.007357931011430328, "vf_loss": 6.4629140329108665, "vf_explained_var": 0.43455470983313504, "kl": 0.0057854856689652755, "entropy": 0.15456574791795993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 822.2155622845894, "episode_reward_min": -102.10553377885074, "episode_reward_mean": 164.49490614828872, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1317.9058915211642, "predator_policy": 3.419168101911282}, "policy_reward_max": {"prey_policy": 396.4, "predator_policy": 1318.0058915211644}, "policy_reward_mean": {"prey_policy": -466.2891598332927, "predator_policy": 548.5366129074375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.10553377885074, 275.9234677304508, 8.512287531209598, 23.693785170818263, -8.874095360449745, -4.100422968163178, 61.4000000000006, 288.8469666970259, 189.52784927361458, 244.82472023887897, 103.38291301531521, 647.1546669821782, 24.14776879077227, 0.3000000000000016, 59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-501.4652486683668, -914.7472541763251, -668.9541693397033, -126.63424070281417, -662.9147832877276, -537.9368203188693, -799.0023627197072, -713.2894497748512, -349.64821229789317, -627.9958488782103, -635.1622995808189, -348.9841647575499, -35.855866903456686, -208.579427203248, -694.069797223147, -268.4530343374667, -170.53486655564484, -226.975854976251, -695.7278380049205, -52.5892820342425, -828.4790389567942, -830.2137167395136, -696.6413346449292, 37.476972347135984, -657.7769022655918, -467.66604651078444, -949.4499338254018, -1317.9058915211642, -636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017], "policy_predator_policy_reward": [396.08375357344056, 918.0232154924014, 660.3504146016594, 411.16146317130824, 667.427070818937, 541.9368203188701, 796.546896626274, 739.4387010391018, 606.7909078491427, 361.9790579665141, 641.2387232562527, 338.80731811395793, 70.75586690345686, 235.0794272032465, 668.2975294426941, 583.0722688149464, 300.1493746476375, 286.8891961578736, 330.5492710362901, 662.5925692417528, 1037.9152045619771, 724.16046414965, 582.4269532264346, 723.8920760535349, 673.8345982003399, 475.7561193668107, 949.6499338254018, 1318.0058915211644, 718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.806271449248405, "mean_inference_ms": 6.977867667825812, "mean_action_processing_ms": 2.4106491952126556, "mean_env_wait_ms": 14.093555363639862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02981710433959961, "StateBufferConnector_ms": 0.02778756618499756, "ViewRequirementAgentConnector_ms": 0.3258894681930542}, "num_episodes": 11, "episode_return_max": 822.2155622845894, "episode_return_min": -102.10553377885074, "episode_return_mean": 164.49490614828872, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.52892355334197, "num_env_steps_trained_throughput_per_sec": 140.52892355334197, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 32201.39, "restore_workers_time_ms": 0.05, "training_step_time_ms": 32201.208, "sample_time_ms": 5957.173, "learn_time_ms": 26206.674, "learn_throughput": 152.633, "synch_weights_time_ms": 31.899}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "01806_00000", "date": "2024-08-22_13-21-23", "timestamp": 1724313083, "time_this_iter_s": 28.535288095474243, "time_total_s": 2442.6815128326416, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae3d6160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2442.6815128326416, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 39.964999999999996, "ram_util_percent": 83.0325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.352136893121024, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.547072658841572, "policy_loss": -0.011444871593266726, "vf_loss": 6.556865601817136, "vf_explained_var": 0.5165919110888526, "kl": 0.00825973512264826, "entropy": 0.5614497531028021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.632857509138724, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.590542463776926, "policy_loss": -0.0064437752895096624, "vf_loss": 6.596848437899635, "vf_explained_var": 0.36041591262060496, "kl": 0.0055119467773548664, "entropy": 0.15165269671293793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 822.2155622845894, "episode_reward_min": -81.06464474508928, "episode_reward_mean": 163.93924400813793, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1031.642596809465, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1034.818760798861}, "policy_reward_mean": {"prey_policy": -456.1868098183913, "predator_policy": 538.1564318224607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.414714140764566, 290.61611718356505, 822.2155622845894, 297.37252840589633, 286.90439411221286, -25.57657519840847, 123.68537845539477, 47.97549002320842, 21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-636.9097548235819, -652.0760946095542, -413.7262771111853, -300.08286560848234, -715.2252014922669, 396.4, -1008.1211091948046, -363.953074684049, -775.8641835627318, -584.3639443298194, -140.05214740225352, -774.3781235193507, -414.5474442807127, -558.8291304584596, -619.3773944430005, -336.1057412941511, -707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617], "policy_predator_policy_reward": [718.6638070242066, 629.7367565496966, 393.98709307183213, 610.4381668313969, 683.6476965849171, 457.3930671919394, 634.6279514858854, 1034.818760798861, 771.7319066606814, 875.4006153440853, 72.30882674695383, 816.5448689762419, 542.32257638406, 554.7393768105104, 672.3364695359484, 331.12215622441323, 586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.85361707430892, "mean_inference_ms": 7.008769628621251, "mean_action_processing_ms": 2.450486639642964, "mean_env_wait_ms": 14.169773720511127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05958819389343262, "StateBufferConnector_ms": 0.009310483932495117, "ViewRequirementAgentConnector_ms": 0.28248322010040283}, "num_episodes": 14, "episode_return_max": 822.2155622845894, "episode_return_min": -81.06464474508928, "episode_return_mean": 163.93924400813793, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.70968371281566, "num_env_steps_trained_throughput_per_sec": 142.70968371281566, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 31161.444, "restore_workers_time_ms": 0.045, "training_step_time_ms": 31161.281, "sample_time_ms": 4773.303, "learn_time_ms": 26351.693, "learn_throughput": 151.793, "synch_weights_time_ms": 31.459}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "01806_00000", "date": "2024-08-22_13-21-52", "timestamp": 1724313112, "time_this_iter_s": 28.0833477973938, "time_total_s": 2470.7648606300354, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306a60c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2470.7648606300354, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 39.43, "ram_util_percent": 82.2775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.570648925014275, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.498924968860767, "policy_loss": -0.008845847935253193, "vf_loss": 6.506322303146281, "vf_explained_var": 0.5155231723709712, "kl": 0.007242592834626083, "entropy": 0.5556726451588686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.444297945688643, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.696234114207918, "policy_loss": -0.008058908230147113, "vf_loss": 6.704124497105836, "vf_explained_var": 0.47613499341187654, "kl": 0.0067417871964622345, "entropy": 0.16573147868353222, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -81.06464474508928, "episode_reward_mean": 164.04773790762334, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1031.642596809465, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 981.9667653525177}, "policy_reward_mean": {"prey_policy": -443.19908764663444, "predator_policy": 525.2229566004467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.323108172448123, 35.17287420055132, 133.35072853685148, -19.059952743295053, 403.8254932824545, 17.784553179360852, 298.7998567072943, 207.06730279771068, -42.41535798765905, 50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-707.901772561901, -590.2262837747297, -139.70127727369314, -483.0141263124959, -251.20309926108084, -641.4545937463095, -632.5516004232385, -577.6195141569071, -476.5362285877809, -305.1640790448518, -938.2172326633979, -37.96521825026046, -221.56481067913475, -567.8307874609969, -586.6890180847421, -496.3084783215108, -724.372220630037, -349.50099503149175, -779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529], "policy_predator_policy_reward": [586.3094496678982, 733.1417148411799, 138.7753605272504, 519.1129172594926, 361.29311204561196, 664.7153094986311, 386.04108992481946, 805.0700719120293, 668.3257990318688, 517.2000018832193, 950.7508651118023, 43.21613898121707, 532.1699693773941, 556.0254854700314, 606.620936876968, 683.4438623269955, 673.966963536142, 357.490894137729, 780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.888517654396524, "mean_inference_ms": 7.045384709666, "mean_action_processing_ms": 2.4543818193227733, "mean_env_wait_ms": 14.193365766367165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059564828872680664, "StateBufferConnector_ms": 0.009291768074035645, "ViewRequirementAgentConnector_ms": 0.28217828273773193}, "num_episodes": 8, "episode_return_max": 774.6991061314311, "episode_return_min": -81.06464474508928, "episode_return_mean": 164.04773790762334, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.18985908966135, "num_env_steps_trained_throughput_per_sec": 143.18985908966135, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 30950.447, "restore_workers_time_ms": 0.027, "training_step_time_ms": 30950.305, "sample_time_ms": 4707.493, "learn_time_ms": 26203.652, "learn_throughput": 152.65, "synch_weights_time_ms": 34.179}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "01806_00000", "date": "2024-08-22_13-22-20", "timestamp": 1724313140, "time_this_iter_s": 27.991141080856323, "time_total_s": 2498.7560017108917, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeeddd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2498.7560017108917, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 38.29, "ram_util_percent": 82.50250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.014979694255445, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.87301195840987, "policy_loss": -0.010452983162252518, "vf_loss": 6.881583111879056, "vf_explained_var": 0.4582116277129562, "kl": 0.009409205458328995, "entropy": 0.5701790027832859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.60394319377879, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.495194152549461, "policy_loss": -0.00861394642901523, "vf_loss": 6.5035996618725, "vf_explained_var": 0.4775825549685766, "kl": 0.008337734626894373, "entropy": 0.178179920200633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -81.06464474508928, "episode_reward_mean": 166.73868141610183, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1031.642596809465, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 981.9667653525177}, "policy_reward_mean": {"prey_policy": -437.4099822210142, "predator_policy": 520.7793229290658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.51042497934895, 87.3077788194485, 553.7904037869747, -32.859957328521304, 282.0301806006451, 80.01456745592643, 12.09999999999995, 445.7614413170603, 26.975288710657285, 227.80854108358662, 426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-779.7398413728918, -186.65381579966618, -429.0848709972032, -750.0552342877445, 9.001207818388622, -409.07547070473504, -569.6850658374776, -632.2783476560983, -801.1292571047866, -375.9945736124365, -543.6516412863857, -845.2306216321983, -405.4452297173689, -587.1267648807129, -197.33171545905842, -779.0367428906999, -490.9447048892773, -423.6668240544158, -179.58838810484622, -553.7433568353625, -490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025], "policy_predator_policy_reward": [780.109704100148, 236.79437805175877, 510.8350429142585, 755.6128411901384, 762.0445443083695, 191.82012236495427, 527.5096151250873, 641.593841039971, 923.068807733215, 536.0852035846535, 562.1135888453273, 906.7832415291814, 416.84522971736885, 587.826764880713, 704.9998930813073, 717.1300065855087, 501.9447048892796, 439.6421127650763, 322.5097459236368, 638.6305401001581, 703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.904647746310677, "mean_inference_ms": 7.062666221874986, "mean_action_processing_ms": 2.4807168319834854, "mean_env_wait_ms": 14.229984580311267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059435486793518066, "StateBufferConnector_ms": 0.012280941009521484, "ViewRequirementAgentConnector_ms": 0.286867618560791}, "num_episodes": 9, "episode_return_max": 774.6991061314311, "episode_return_min": -81.06464474508928, "episode_return_mean": 166.73868141610183, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 141.50429587409081, "num_env_steps_trained_throughput_per_sec": 141.50429587409081, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 30287.217, "restore_workers_time_ms": 0.029, "training_step_time_ms": 30287.048, "sample_time_ms": 4407.999, "learn_time_ms": 25838.037, "learn_throughput": 154.811, "synch_weights_time_ms": 35.619}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "01806_00000", "date": "2024-08-22_13-22-48", "timestamp": 1724313168, "time_this_iter_s": 28.307051181793213, "time_total_s": 2527.063052892685, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aef21ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2527.063052892685, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 38.7975, "ram_util_percent": 82.64500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.290021137711864, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": Infinity, "policy_loss": -0.007807151470382614, "vf_loss": 6.711796497667908, "vf_explained_var": 0.5484700141760407, "kl": Infinity, "entropy": 0.5977297522403576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.87054195101299, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.585731254557453, "policy_loss": -0.006896686082380632, "vf_loss": 6.592443862289348, "vf_explained_var": 0.4134919986523018, "kl": 0.007362427735927875, "entropy": 0.16855454195744146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -81.06464474508928, "episode_reward_mean": 180.31931612158797, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1031.642596809465, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 981.9667653525177}, "policy_reward_mean": {"prey_policy": -418.46303652578854, "predator_policy": 508.62269458658307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.7927098956861, 160.18140666103452, 152.4055093711713, -15.604726665475182, 36.051116134231734, 428.8240063263264, -19.692194221874036, -61.98742027302902, 166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-490.29911526974365, -387.47687648194807, -281.57326102111887, -745.478868530018, -480.90289948330536, -706.0146557560253, -593.9622520626905, -555.8683618434026, -637.6921101753799, -416.4649533379305, 373.18918680169946, -619.5676754721159, -477.1099345984373, -177.37704048575478, -146.36427867958622, -483.9966573281891, -544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832], "policy_predator_policy_reward": [703.1569763187706, 601.4117253286047, 469.54712924508664, 717.6864069670871, 642.2555192303575, 697.0675453801457, 567.8439410362591, 566.3819462043605, 477.8292376243968, 612.3789420231433, 443.09453722363503, 232.1079577731068, 77.38680460735156, 557.407976254967, 538.4251452806978, 29.948370454046167, 596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.923590032097667, "mean_inference_ms": 7.079778375071706, "mean_action_processing_ms": 2.491777617686802, "mean_env_wait_ms": 14.257880947593614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058537840843200684, "StateBufferConnector_ms": 0.012192249298095703, "ViewRequirementAgentConnector_ms": 0.25204193592071533}, "num_episodes": 10, "episode_return_max": 774.6991061314311, "episode_return_min": -81.06464474508928, "episode_return_mean": 180.31931612158797, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.5854126793656, "num_env_steps_trained_throughput_per_sec": 140.5854126793656, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 30225.989, "restore_workers_time_ms": 0.031, "training_step_time_ms": 30225.822, "sample_time_ms": 4224.132, "learn_time_ms": 25960.182, "learn_throughput": 154.082, "synch_weights_time_ms": 36.009}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "01806_00000", "date": "2024-08-22_13-23-17", "timestamp": 1724313197, "time_this_iter_s": 28.497849941253662, "time_total_s": 2555.5609028339386, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeedddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2555.5609028339386, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 39.91951219512195, "ram_util_percent": 83.05365853658537}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.002058999752872, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.78778515568486, "policy_loss": -0.0070827553378881285, "vf_loss": 6.793014240264893, "vf_explained_var": 0.4197049653088605, "kl": 0.006178796996249172, "entropy": 0.5515295888065661, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.83561717442104, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.665188701064499, "policy_loss": -0.007186838276881389, "vf_loss": 6.672150293986003, "vf_explained_var": 0.41172423028441335, "kl": 0.00900925987476493, "entropy": 0.1764524250355347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 492.7899999999936}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -81.06464474508928, "episode_reward_mean": 187.9916301276035, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1031.642596809465, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 981.9667653525177}, "policy_reward_mean": {"prey_policy": -409.0454398721845, "predator_policy": 503.041254935987}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.93890501154638, 214.29999999999995, 227.6888358352825, 696.8241695405944, 727.8551931750479, -81.06464474508928, 249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-544.2020445473939, -403.6001933108476, -677.4302017331077, -29.80597062983791, -585.1672807290572, 104.01779299851968, -496.76655264736667, 302.31712178335266, 5.6774421892649265, -1031.642596809465, -431.38350694022853, -657.2659347916922, -448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923], "policy_predator_policy_reward": [596.8582743948431, 517.8828684749457, 678.0302017331078, 243.5059706298371, 594.4000133827693, 114.43831018305029, 473.7917727855995, 417.4818276190082, 981.9667653525177, 771.853582442727, 311.48140166368097, 696.1033953231549, 544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.913714129914235, "mean_inference_ms": 7.075198125182956, "mean_action_processing_ms": 2.4882242392655405, "mean_env_wait_ms": 14.253096708529629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05841970443725586, "StateBufferConnector_ms": 0.009537696838378906, "ViewRequirementAgentConnector_ms": 0.22404241561889648}, "num_episodes": 8, "episode_return_max": 774.6991061314311, "episode_return_min": -81.06464474508928, "episode_return_mean": 187.9916301276035, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.70495932603774, "num_env_steps_trained_throughput_per_sec": 142.70495932603774, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 28858.445, "restore_workers_time_ms": 0.031, "training_step_time_ms": 28858.257, "sample_time_ms": 3134.178, "learn_time_ms": 25682.316, "learn_throughput": 155.749, "synch_weights_time_ms": 35.8}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "01806_00000", "date": "2024-08-22_13-23-45", "timestamp": 1724313225, "time_this_iter_s": 28.065572023391724, "time_total_s": 2583.6264748573303, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2583.6264748573303, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.67, "ram_util_percent": 82.8225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.731454173850004, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.619372659511667, "policy_loss": -0.008728420961569384, "vf_loss": 6.625976519105295, "vf_explained_var": 0.4882742567037148, "kl": 0.007081848886061125, "entropy": 0.5526852503655448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.05968063470548, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.340540407574366, "policy_loss": -0.00693103197971901, "vf_loss": 6.347322438759779, "vf_explained_var": 0.4121757227907736, "kl": 0.0059600896413916, "entropy": 0.14804786484708232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -42.355930669557935, "episode_reward_mean": 172.1992280192673, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -945.155529403382, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -416.78766660849806, "predator_policy": 502.8872806181325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [249.28037778209685, 118.00280942439507, 159.0973618446681, 226.9100363800427, 217.07842044197045, 189.02550081909718, 51.10658813265908, 56.33914258112472, 28.72112064585192, 407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-448.3591545261299, -324.28916408024287, -435.2671307041692, -529.1797538434562, -59.826013740167454, -187.33514161160744, -156.6029359454167, -745.4528688588886, -353.7747162832963, -168.87537066576058, -293.22700853544023, -622.1670930281903, -295.5518416542657, -712.3531393024684, -673.1696994466349, -524.9086297746551, -323.4366194228133, -663.1911075955127, -155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479], "policy_predator_policy_reward": [544.1929611198548, 477.73573526861406, 389.67305647431914, 692.7766374977015, 182.10823764399208, 224.15027955245102, 367.815901168239, 761.1499400161086, 344.54094350662746, 395.18756388440517, 488.1657223019032, 616.2538800808364, 318.69052451446737, 740.3210445749238, 682.7858159701543, 571.6316558322633, 339.136619422818, 676.2122282413657, 189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.9084171354747115, "mean_inference_ms": 7.064742164012507, "mean_action_processing_ms": 2.482203212823313, "mean_env_wait_ms": 14.236107293347139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05837821960449219, "StateBufferConnector_ms": 0.009516119956970215, "ViewRequirementAgentConnector_ms": 0.21528208255767822}, "num_episodes": 6, "episode_return_max": 774.6991061314311, "episode_return_min": -42.355930669557935, "episode_return_mean": 172.1992280192673, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.7074095165326, "num_env_steps_trained_throughput_per_sec": 144.7074095165326, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 28424.629, "restore_workers_time_ms": 0.032, "training_step_time_ms": 28424.425, "sample_time_ms": 2805.831, "learn_time_ms": 25579.778, "learn_throughput": 156.374, "synch_weights_time_ms": 33.311}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "01806_00000", "date": "2024-08-22_13-24-12", "timestamp": 1724313252, "time_this_iter_s": 27.706660747528076, "time_total_s": 2611.3331356048584, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aeec74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2611.3331356048584, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 38.9974358974359, "ram_util_percent": 82.84358974358973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.05951301181127, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.171817674081792, "policy_loss": -0.007947049423973396, "vf_loss": 6.178177507087667, "vf_explained_var": 0.46602263601999433, "kl": 0.005290671131356802, "entropy": 0.609978111238076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.872070064746513, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.081437938427799, "policy_loss": -0.009218549653493538, "vf_loss": 6.090463803306458, "vf_explained_var": 0.47953031630743115, "kl": 0.0077067772172903885, "entropy": 0.15577551620820212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -59.206686278472006, "episode_reward_mean": 175.96033880804416, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -945.155529403382, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -420.5687238751085, "predator_policy": 508.5488932791314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.8938907459808, 289.6046896998271, 690.6334671171916, -32.923506128180065, 80.79999999999968, 1.9999999999999984, 142.59612620423013, 71.17601469420804, 99.12472887287079, 71.78493804359596, 153.34555686370166, 4.199999999999999, -14.061105741607694, 73.2032635722635, 35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-155.77418377829042, 333.0546302271742, -441.1719667749826, -378.0397135288463, 172.16567792956684, -701.8582275329958, -561.0539188185898, -592.6216876581246, -38.264058358843144, 43.38083189808906, -544.054017928937, -866.0067803107776, -487.657578029108, -757.5059764615627, 22.982773477837735, -6.313097049528674, -498.53466207319207, -567.2445030506603, -569.4932910070579, -329.18289895388915, -694.4655852716876, -651.9815026988291, -557.3460697768234, -646.9059098426094, -632.0530626943005, -799.7181683435774, -739.5237279005767, -438.7818366280375, -382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867], "policy_predator_policy_reward": [189.7741837782885, 40.83926051880441, 473.63514668756943, 635.1812233160883, 582.4060460046632, 637.9199707159552, 675.6063145978992, 445.145785750637, 72.26405835884306, 3.419168101911282, 544.9540179289372, 867.1067803107775, 641.2303614399839, 746.5293192549163, 12.493241216370091, 42.01309704952901, 636.1922316281996, 528.711662368528, 528.5561821421259, 441.90494586241795, 812.6563941094478, 687.1362507247719, 561.5460697768241, 646.9059098426094, 620.1657994536647, 797.5443258426063, 583.9830256505209, 667.5258024503607, 553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.88864772386513, "mean_inference_ms": 7.040579666760539, "mean_action_processing_ms": 2.4746583433987, "mean_env_wait_ms": 14.21323829929679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05852365493774414, "StateBufferConnector_ms": 0.00950777530670166, "ViewRequirementAgentConnector_ms": 0.2034602165222168}, "num_episodes": 9, "episode_return_max": 774.6991061314311, "episode_return_min": -59.206686278472006, "episode_return_mean": 175.96033880804416, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 142.03003075731323, "num_env_steps_trained_throughput_per_sec": 142.03003075731323, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 28241.348, "restore_workers_time_ms": 0.124, "training_step_time_ms": 28241.002, "sample_time_ms": 2644.991, "learn_time_ms": 25557.19, "learn_throughput": 156.512, "synch_weights_time_ms": 33.192}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "01806_00000", "date": "2024-08-22_13-24-41", "timestamp": 1724313281, "time_this_iter_s": 28.219890832901, "time_total_s": 2639.5530264377594, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ae48eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2639.5530264377594, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 40.92, "ram_util_percent": 82.9825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.285255297403488, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.876057002153346, "policy_loss": -0.007264095277614182, "vf_loss": 5.881696630407263, "vf_explained_var": 0.583991254637481, "kl": 0.005414898665227666, "entropy": 0.6813374682078286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.541960726087055, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 5.788482557528864, "policy_loss": -0.008654676932871105, "vf_loss": 5.796959796279826, "vf_explained_var": 0.5249760082159093, "kl": 0.007097912449192591, "entropy": 0.17302889876737795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 183.16289038422354, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -945.155529403382, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -418.4691509152349, "predator_policy": 510.0505961073475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.996178241845485, 11.043254442796428, 163.8397845279692, 150.67750948303978, 92.43601029851615, 143.10853918004636, 188.16342338793493, 76.79127436710445, 177.05595125274132, 56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-382.7443009843142, -519.7150020440716, -646.824707747762, -501.9969669721846, -699.6981239292886, -27.598934452385603, -472.58706807156705, -656.9642439907751, -650.0490968097675, -632.9960139271682, -546.1563934555891, -159.13972054145944, -230.34904113848543, -167.55867548326358, -460.00401290141434, -653.8673736234005, -896.0592167439398, -567.0129391679974, -688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338], "policy_predator_policy_reward": [553.439477296659, 385.01600397357686, 649.0860097882129, 510.77891937453126, 650.3380164108031, 240.79882649884058, 442.4007427017791, 837.8280788436032, 646.2355140056762, 729.2456070297774, 573.8337919767198, 274.5708612003749, 255.33794452222958, 330.73319548745314, 540.9035686085581, 649.7590922833647, 727.3017748753872, 912.826332289294, 684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8553548030695834, "mean_inference_ms": 7.030310916541066, "mean_action_processing_ms": 2.4730016783008617, "mean_env_wait_ms": 14.187644169607845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05859935283660889, "StateBufferConnector_ms": 0.009533882141113281, "ViewRequirementAgentConnector_ms": 0.2328270673751831}, "num_episodes": 14, "episode_return_max": 774.6991061314311, "episode_return_min": -199.8915541431219, "episode_return_mean": 183.16289038422354, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.3179580492484, "num_env_steps_trained_throughput_per_sec": 138.3179580492484, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 28301.884, "restore_workers_time_ms": 0.126, "training_step_time_ms": 28301.561, "sample_time_ms": 2682.071, "learn_time_ms": 25581.087, "learn_throughput": 156.366, "synch_weights_time_ms": 33.268}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "01806_00000", "date": "2024-08-22_13-25-10", "timestamp": 1724313310, "time_this_iter_s": 28.983871936798096, "time_total_s": 2668.5368983745575, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306aab700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2668.5368983745575, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 42.30731707317073, "ram_util_percent": 82.55853658536586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.840934698417705, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 5.9643080782007285, "policy_loss": -0.008096935572447601, "vf_loss": 5.970395067507628, "vf_explained_var": 0.5550647199469269, "kl": 0.006699724993840964, "entropy": 0.6230885946246051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.186254485700495, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.146778855500398, "policy_loss": -0.007833758391755282, "vf_loss": 6.154438967427248, "vf_explained_var": 0.527281360903745, "kl": 0.0069453769133712056, "entropy": 0.15672234754083017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 774.6991061314311, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 189.21206322926992, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -945.155529403382, "predator_policy": 1.4338823847498596}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -405.17805378270447, "predator_policy": 499.7840853973402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.92068116918877, 774.6991061314311, 482.96831709601634, 8.981460555138202, -14.18774685658723, 129.926522156719, 283.02280769454194, 409.78056002635594, 101.8394603888745, 313.1163327796594, 4.1000000000000005, 8.029642163231939, 12.199999999999974, 667.0084959545694, 97.14383459666615, 0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-688.2863890714393, -283.1775683690913, -821.7151538674946, 152.1491346670677, -246.92054234287295, 255.5187754918711, -592.1265016978974, -167.84232543894475, -574.5023094259155, -342.100048158643, -676.99184840809, -132.36193063816867, -473.15271809817676, -238.81453896579, -314.8294228847689, -752.8549192611061, -590.947432112461, -580.164480115656, -305.23746640216433, -673.3230149455206, -702.2575229378077, -527.2016587265748, -703.9715931049994, -614.84315655655, -502.5538173856253, -909.1823108246017, 400.0, -589.4877861205522, -481.5180833474288, -148.08664849362896, -621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666], "policy_predator_policy_reward": [684.269298244795, 344.11534036492856, 686.3425561339959, 757.9225691978622, 215.47437928491263, 258.8957046621032, 595.1810189657864, 173.76926872619276, 582.2700503050671, 320.1445604229088, 590.757502047618, 348.52279915535706, 438.37134830246345, 556.6187164560458, 746.7756268702535, 730.6892753019883, 615.4107650845874, 657.5406075324033, 686.3381740306803, 605.3386400966646, 702.5575229378078, 531.0016587265746, 704.4323740983169, 622.4120177264656, 514.553817385628, 909.3823108246016, 491.339805048988, 365.1564770261296, 175.95577779273677, 550.79278864499, 621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.842985124749817, "mean_inference_ms": 7.005244825199291, "mean_action_processing_ms": 2.468325589210959, "mean_env_wait_ms": 14.15834365596657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.059415221214294434, "StateBufferConnector_ms": 0.00961768627166748, "ViewRequirementAgentConnector_ms": 0.23366892337799072}, "num_episodes": 9, "episode_return_max": 774.6991061314311, "episode_return_min": -199.8915541431219, "episode_return_mean": 189.21206322926992, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 126.77037130833462, "num_env_steps_trained_throughput_per_sec": 126.77037130833462, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 28545.547, "restore_workers_time_ms": 0.133, "training_step_time_ms": 28545.204, "sample_time_ms": 2807.032, "learn_time_ms": 25698.458, "learn_throughput": 155.651, "synch_weights_time_ms": 34.784}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "01806_00000", "date": "2024-08-22_13-25-41", "timestamp": 1724313341, "time_this_iter_s": 31.597565174102783, "time_total_s": 2700.1344635486603, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aef214c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2700.1344635486603, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 49.248888888888885, "ram_util_percent": 83.39777777777776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.035896098424516, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.00010000000000000003, "total_loss": 6.032380672737404, "policy_loss": -0.007493154971155698, "vf_loss": 6.038473297300793, "vf_explained_var": 0.49488074098314555, "kl": 0.004668416479287087, "entropy": 0.6187150191693079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.81562936873663, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.19969303544867, "policy_loss": -0.0088968152865255, "vf_loss": 6.208358086480034, "vf_explained_var": 0.4501233910757398, "kl": 0.00927071672908607, "entropy": 0.15906906466162393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 759.1499869272477, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 168.24719051443523, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -945.155529403382, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 361.0496312532229, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -394.8994553528188, "predator_policy": 479.02305061003733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.49999999999999845, 88.15240810960458, 37.5166757320065, 305.85475898140527, 147.8711780820339, 85.98345300921207, -42.355930669557935, 20.9606071889879, 28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515, 253.2167167223632, 7.699999999999992, 75.33954086422423, 46.35987235432248, 71.52962861588034, 9.209828122274986, 12.599999999999948, -76.97301509699642, 21.300000000000022, 0.018193838802666562, 311.83655374246706, 61.7346187151716, -35.70597240741504, -41.2096867444594, 522.1059236457069], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-621.5633799674404, -604.1883186334233, -349.55640328492495, -585.0906920591298, -630.4540680681882, -658.7032751646223, -578.3639860013774, -487.42883000259536, -69.34568685333389, -275.1309806353772, -487.57103403323487, -945.155529403382, -510.2180162584791, -788.5116574323857, -728.1457757541983, -733.5897560418233, -506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666, -338.1637702322377, -61.75569412357499, -632.2256435602968, -543.7168012105002, -460.46155696426456, -223.10268785667128, -248.13366846335109, -368.546662171168, -93.19480862579633, -106.72532308623411, -253.73010457036779, -584.6449135226583, -505.67077668195344, -616.8060215303948, -139.4692393693865, -784.1382304889438, -577.6093677352927, -460.5264138831863, -486.075247430184, -250.56149669386375, -278.61420860559747, -293.979201121916, -478.25252843839417, -400.1650271037935, -452.1254272631885, -193.98822885799362, -278.6090303472069, -470.07048138039596, -364.35255691426795, 174.35152666718233], "policy_predator_policy_reward": [621.8633799674404, 604.3883186334233, 627.7571894967116, 395.0423139569524, 641.0677630899005, 685.6062558749192, 609.1497671767703, 762.4978078086112, 242.26976528692842, 250.0780802838239, 575.4153554795805, 943.2946609662486, 711.4741454233233, 544.8995975979846, 708.0934273631716, 774.6027116218381, 523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715, 287.937942301091, 365.1982387770901, 632.825643560297, 550.8168012105021, 440.0350908006238, 318.8686948845378, 357.70187544343037, 305.33832754541885, 143.35577394857705, 128.09398637933035, 258.3399326926449, 589.2449135226585, 511.67077668195424, 623.4060215303956, 807.695039291625, 38.93941546970968, 584.8093677352931, 474.6264138831895, 736.6549379628535, 0.0, 494.20633953275006, 390.2236239372331, 541.5772686691429, 398.5749055882174, 28.824803328825396, 581.5828803849433, 33.65885612108818, 673.8109688620589, 363.9189987412938, 348.1879551514993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.827634706154905, "mean_inference_ms": 6.989154666300346, "mean_action_processing_ms": 2.4601157633656743, "mean_env_wait_ms": 14.141449095639054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05961263179779053, "StateBufferConnector_ms": 0.007366657257080078, "ViewRequirementAgentConnector_ms": 0.21816158294677734}, "num_episodes": 15, "episode_return_max": 759.1499869272477, "episode_return_min": -199.8915541431219, "episode_return_mean": 168.24719051443523, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.54987547733947, "num_env_steps_trained_throughput_per_sec": 131.54987547733947, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 28739.832, "restore_workers_time_ms": 0.133, "training_step_time_ms": 28739.464, "sample_time_ms": 3005.414, "learn_time_ms": 25690.353, "learn_throughput": 155.7, "synch_weights_time_ms": 38.704}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "01806_00000", "date": "2024-08-22_13-26-12", "timestamp": 1724313372, "time_this_iter_s": 30.448098182678223, "time_total_s": 2730.5825617313385, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b97af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2730.5825617313385, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 46.77441860465116, "ram_util_percent": 83.16279069767442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.711657577595382, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.409425753134268, "policy_loss": -0.007657263451625431, "vf_loss": 6.415846914462942, "vf_explained_var": 0.5190614484605335, "kl": 0.008240794990379264, "entropy": 0.6172727752299536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.35624887653129, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.270688642017425, "policy_loss": -0.010586046433894249, "vf_loss": 6.280979259430416, "vf_explained_var": 0.580583871293951, "kl": 0.01181673133110125, "entropy": 0.16259154633239464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 482.63125000000576}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 759.1499869272477, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 173.14264434262424, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -878.0505982962081, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 361.0496312532229, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -384.1812675150309, "predator_policy": 470.75258968634387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.383708858873256, 77.99999999999984, 123.81943887833117, 58.22953058558636, 134.131556895473, 378.4724404787806, 230.5044125511948, 481.9574838812358, 402.4096089411184, 75.16751026442545, 76.30292555434809, 134.5110607891929, 56.154614773510666, 20.680589345934955, 189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515, 253.2167167223632, 7.699999999999992, 75.33954086422423, 46.35987235432248, 71.52962861588034, 9.209828122274986, 12.599999999999948, -76.97301509699642, 21.300000000000022, 0.018193838802666562, 311.83655374246706, 61.7346187151716, -35.70597240741504, -41.2096867444594, 522.1059236457069, 103.36488647519033, 16.69999999999998, 56.976294878718804, -14.46000738457112, 144.38616883153787, -2.293481482802226, 501.84139882361626, 327.51327311089705], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-506.18356435568575, -668.881816072421, 14.533394752733932, 38.36611761525042, -417.4860456184741, -436.1053052155236, -569.6038860171583, -512.2356984111617, -13.812776603912763, -146.3467963211299, -393.2097432999046, -354.48237367849737, -181.68019681998118, -380.60933449864336, -607.2013695452375, -5.246462851218574, -255.09758183400984, -721.5718827234508, -280.42822532192383, -257.005771538953, -360.14994498211587, -662.8101006311426, -265.1991923947638, -414.8162994181529, -683.1911565236493, -762.4620695429818, -568.9500341450109, -474.39077157953415, -868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666, -338.1637702322377, -61.75569412357499, -632.2256435602968, -543.7168012105002, -460.46155696426456, -223.10268785667128, -248.13366846335109, -368.546662171168, -93.19480862579633, -106.72532308623411, -253.73010457036779, -584.6449135226583, -505.67077668195344, -616.8060215303948, -139.4692393693865, -784.1382304889438, -577.6093677352927, -460.5264138831863, -486.075247430184, -250.56149669386375, -278.61420860559747, -293.979201121916, -478.25252843839417, -400.1650271037935, -452.1254272631885, -193.98822885799362, -278.6090303472069, -470.07048138039596, -364.35255691426795, 174.35152666718233, -588.36054457163, -604.5703483189504, -434.3649086665454, -627.3817204186145, 28.38899984223711, -243.82264423463073, -727.1228565059945, -504.5074989435593, -77.27474522730928, -237.6310181461086, -756.53044862157, -594.5466828672669, -650.0161713963671, -91.67443577886439, -476.42871222080595, -323.5360859603606], "policy_predator_policy_reward": [523.1980642059692, 680.2510250810107, 23.66660524726609, 1.4338823847498596, 469.0397867659959, 508.3710029463339, 511.6427260583393, 628.4263889555704, 129.8213249906523, 164.46980482986555, 438.65896692691734, 687.5055905302702, 355.6894202358899, 437.10452363392903, 583.041051718689, 511.3642645590021, 676.5307799519834, 702.5482935465926, 334.2017199352853, 278.39978719002636, 337.5626243272166, 761.700346840393, 381.19798134127996, 433.32857126084167, 749.7315154553492, 752.076325384797, 371.61890374493925, 692.4024913255452, 871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715, 287.937942301091, 365.1982387770901, 632.825643560297, 550.8168012105021, 440.0350908006238, 318.8686948845378, 357.70187544343037, 305.33832754541885, 143.35577394857705, 128.09398637933035, 258.3399326926449, 589.2449135226585, 511.67077668195424, 623.4060215303956, 807.695039291625, 38.93941546970968, 584.8093677352931, 474.6264138831895, 736.6549379628535, 0.0, 494.20633953275006, 390.2236239372331, 541.5772686691429, 398.5749055882174, 28.824803328825396, 581.5828803849433, 33.65885612108818, 673.8109688620589, 363.9189987412938, 348.1879551514993, 698.7877608546214, 597.5080185111517, 444.9649086665468, 633.4817204186147, 0.8254424758404358, 271.5844967952734, 629.4277462381452, 587.742601826839, 186.34111862587446, 272.9508135790823, 591.0936671125572, 757.6899828934824, 640.3767464428046, 603.1552595560375, 603.2537421685082, 524.2243291235607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.841848974797696, "mean_inference_ms": 6.990639152102401, "mean_action_processing_ms": 2.4515556448015894, "mean_env_wait_ms": 14.142661414866698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06179642677307129, "StateBufferConnector_ms": 0.007579803466796875, "ViewRequirementAgentConnector_ms": 0.2282806634902954}, "num_episodes": 8, "episode_return_max": 759.1499869272477, "episode_return_min": -199.8915541431219, "episode_return_mean": 173.14264434262424, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.8798274352873, "num_env_steps_trained_throughput_per_sec": 114.8798274352873, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 29418.849, "restore_workers_time_ms": 0.138, "training_step_time_ms": 29418.444, "sample_time_ms": 3721.801, "learn_time_ms": 25650.234, "learn_throughput": 155.944, "synch_weights_time_ms": 41.171}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "01806_00000", "date": "2024-08-22_13-26-47", "timestamp": 1724313407, "time_this_iter_s": 34.87513613700867, "time_total_s": 2765.457697868347, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b8c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2765.457697868347, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 53.10612244897959, "ram_util_percent": 82.97142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.110157735764034, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.619962699324996, "policy_loss": -0.006028452826782115, "vf_loss": 6.624927044923974, "vf_explained_var": 0.542929277659724, "kl": 0.007094037874784104, "entropy": 0.5712070367639027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.8914952384101, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.49208042356703, "policy_loss": -0.007849802218732379, "vf_loss": 6.499691411174794, "vf_explained_var": 0.45323709381951227, "kl": 0.009552279052635034, "entropy": 0.17099583025962586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 759.1499869272477, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 170.21064355492376, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -878.0505982962081, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 361.0496312532229, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -387.8154362964549, "predator_policy": 472.9207580739175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [189.48342763151544, 363.6173550189888, 116.12447960844736, 241.36445287494846, 100.84456552694492, 17.36149379567188, 219.31197841760127, 60.88295424497066, 25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515, 253.2167167223632, 7.699999999999992, 75.33954086422423, 46.35987235432248, 71.52962861588034, 9.209828122274986, 12.599999999999948, -76.97301509699642, 21.300000000000022, 0.018193838802666562, 311.83655374246706, 61.7346187151716, -35.70597240741504, -41.2096867444594, 522.1059236457069, 103.36488647519033, 16.69999999999998, 56.976294878718804, -14.46000738457112, 144.38616883153787, -2.293481482802226, 501.84139882361626, 327.51327311089705, 7.187321874818323, 96.9944002082757, 65.30000000000057, 84.77525625995288, 299.69706240982407, 36.70184219094619, 371.33848298766327, 172.606349109762, 86.54937607371052, 157.51251991324267, 125.12456795268085, 206.3807309218636, 270.69052987025606, 4.66636325496493], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-868.3335935772786, -210.84788396199482, -657.2835557513395, -246.86305645725227, -83.41122302420223, -238.01515662453323, -331.39762149678774, -259.6639123338147, -641.9764463582876, -196.183893611455, -263.57190660322794, -472.50950273378044, -240.18024102737527, -370.768225788025, -823.7635824948162, -259.17718754681596, -460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666, -338.1637702322377, -61.75569412357499, -632.2256435602968, -543.7168012105002, -460.46155696426456, -223.10268785667128, -248.13366846335109, -368.546662171168, -93.19480862579633, -106.72532308623411, -253.73010457036779, -584.6449135226583, -505.67077668195344, -616.8060215303948, -139.4692393693865, -784.1382304889438, -577.6093677352927, -460.5264138831863, -486.075247430184, -250.56149669386375, -278.61420860559747, -293.979201121916, -478.25252843839417, -400.1650271037935, -452.1254272631885, -193.98822885799362, -278.6090303472069, -470.07048138039596, -364.35255691426795, 174.35152666718233, -588.36054457163, -604.5703483189504, -434.3649086665454, -627.3817204186145, 28.38899984223711, -243.82264423463073, -727.1228565059945, -504.5074989435593, -77.27474522730928, -237.6310181461086, -756.53044862157, -594.5466828672669, -650.0161713963671, -91.67443577886439, -476.42871222080595, -323.5360859603606, -643.4640424404791, -482.7737922718817, -319.375413781071, -630.4077182246682, -53.00448343344465, -78.06355289522496, -301.10076129205277, -531.3388942662749, -637.3491146393344, -361.7549895852628, -423.0551198932104, -384.3575097064923, -390.45871584475196, -399.0907373417539, -355.18156967187736, -241.57827783796492, -582.6775611902283, -472.5934343483063, -557.5452983525092, -234.58534185855817, -418.6660551365391, -626.9497037964196, -334.04213079867606, -170.73367194956788, -587.2621951361008, -44.6763844349591, -761.5518186274501, -549.4543551063712], "policy_predator_policy_reward": [871.7904519580297, 396.8744532127578, 591.1683927450732, 676.5955744825018, 219.015231556492, 218.5356277006912, 399.35089549045705, 433.0750912151027, 636.0501845279883, 302.9547209686973, 111.37297745512855, 642.0699256775509, 704.996842334989, 125.26360289801097, 823.7635824948162, 320.0601417917903, 504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715, 287.937942301091, 365.1982387770901, 632.825643560297, 550.8168012105021, 440.0350908006238, 318.8686948845378, 357.70187544343037, 305.33832754541885, 143.35577394857705, 128.09398637933035, 258.3399326926449, 589.2449135226585, 511.67077668195424, 623.4060215303956, 807.695039291625, 38.93941546970968, 584.8093677352931, 474.6264138831895, 736.6549379628535, 0.0, 494.20633953275006, 390.2236239372331, 541.5772686691429, 398.5749055882174, 28.824803328825396, 581.5828803849433, 33.65885612108818, 673.8109688620589, 363.9189987412938, 348.1879551514993, 698.7877608546214, 597.5080185111517, 444.9649086665468, 633.4817204186147, 0.8254424758404358, 271.5844967952734, 629.4277462381452, 587.742601826839, 186.34111862587446, 272.9508135790823, 591.0936671125572, 757.6899828934824, 640.3767464428046, 603.1552595560375, 603.2537421685082, 524.2243291235607, 646.2640424404797, 487.1611141467012, 484.76761064836313, 562.0099215656534, 87.30448343344348, 109.06355289522327, 391.7402969964999, 525.4746148217797, 629.6362839499888, 669.1648826844378, 252.94866863017305, 591.1658031604777, 737.1860684319859, 423.7018677421829, 375.6868837506379, 393.6793128689759, 616.1671647641983, 525.6532068480523, 555.5049038783986, 394.1382562459158, 583.5099134852044, 587.2304134004389, 353.94373796865426, 357.2127957014581, 552.7469558702112, 349.88215357110755, 761.9518186274502, 553.7207183613372]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.832776042985277, "mean_inference_ms": 7.004454394543586, "mean_action_processing_ms": 2.4930957036204817, "mean_env_wait_ms": 14.156974515007187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01463305950164795, "StateBufferConnector_ms": 0.007673144340515137, "ViewRequirementAgentConnector_ms": 0.20698320865631104}, "num_episodes": 14, "episode_return_max": 759.1499869272477, "episode_return_min": -199.8915541431219, "episode_return_mean": 170.21064355492376, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.34264579010886, "num_env_steps_trained_throughput_per_sec": 149.34264579010886, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 29303.764, "restore_workers_time_ms": 0.14, "training_step_time_ms": 29303.362, "sample_time_ms": 3733.963, "learn_time_ms": 25525.881, "learn_throughput": 156.704, "synch_weights_time_ms": 38.42}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "01806_00000", "date": "2024-08-22_13-27-14", "timestamp": 1724313434, "time_this_iter_s": 26.829493045806885, "time_total_s": 2792.287190914154, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3aef21dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2792.287190914154, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 38.6, "ram_util_percent": 81.99473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.975115762942686, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.438489404304948, "policy_loss": -0.009359055770334428, "vf_loss": 6.446309767829048, "vf_explained_var": 0.51913988565011, "kl": 0.010257827121734855, "entropy": 0.5681690965379987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.63731129762357, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.454112575167701, "policy_loss": -0.010321740553068816, "vf_loss": 6.46419453898435, "vf_explained_var": 0.476575854089525, "kl": 0.00959066870257692, "entropy": 0.16154022685907504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 920.9710588120797, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 178.96711020702605, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -878.0505982962081, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 361.0496312532229, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -385.1961605076342, "predator_policy": 474.67971561114814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.957699218119632, 418.2564792337664, 290.8329885341365, 432.4858571006323, 650.5574644320768, 596.6994234613405, 138.2999999999971, -24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515, 253.2167167223632, 7.699999999999992, 75.33954086422423, 46.35987235432248, 71.52962861588034, 9.209828122274986, 12.599999999999948, -76.97301509699642, 21.300000000000022, 0.018193838802666562, 311.83655374246706, 61.7346187151716, -35.70597240741504, -41.2096867444594, 522.1059236457069, 103.36488647519033, 16.69999999999998, 56.976294878718804, -14.46000738457112, 144.38616883153787, -2.293481482802226, 501.84139882361626, 327.51327311089705, 7.187321874818323, 96.9944002082757, 65.30000000000057, 84.77525625995288, 299.69706240982407, 36.70184219094619, 371.33848298766327, 172.606349109762, 86.54937607371052, 157.51251991324267, 125.12456795268085, 206.3807309218636, 270.69052987025606, 4.66636325496493, 458.62597686744573, 210.97499323930228, 920.9710588120797, 132.30513383147746, -2.4495951714011452, -129.73358378787756, 321.83899724037013, 272.1043912979209], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-460.16544728256827, -591.5305940209828, -672.2358535197636, -120.54644947848954, -457.42000056839913, -165.95079711558145, -616.1615221328487, 120.3740916464802, -582.0780439580549, 42.95126179089911, 256.6102162845811, -495.62590496460206, 104.11643988169763, -219.0618900187265, -619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666, -338.1637702322377, -61.75569412357499, -632.2256435602968, -543.7168012105002, -460.46155696426456, -223.10268785667128, -248.13366846335109, -368.546662171168, -93.19480862579633, -106.72532308623411, -253.73010457036779, -584.6449135226583, -505.67077668195344, -616.8060215303948, -139.4692393693865, -784.1382304889438, -577.6093677352927, -460.5264138831863, -486.075247430184, -250.56149669386375, -278.61420860559747, -293.979201121916, -478.25252843839417, -400.1650271037935, -452.1254272631885, -193.98822885799362, -278.6090303472069, -470.07048138039596, -364.35255691426795, 174.35152666718233, -588.36054457163, -604.5703483189504, -434.3649086665454, -627.3817204186145, 28.38899984223711, -243.82264423463073, -727.1228565059945, -504.5074989435593, -77.27474522730928, -237.6310181461086, -756.53044862157, -594.5466828672669, -650.0161713963671, -91.67443577886439, -476.42871222080595, -323.5360859603606, -643.4640424404791, -482.7737922718817, -319.375413781071, -630.4077182246682, -53.00448343344465, -78.06355289522496, -301.10076129205277, -531.3388942662749, -637.3491146393344, -361.7549895852628, -423.0551198932104, -384.3575097064923, -390.45871584475196, -399.0907373417539, -355.18156967187736, -241.57827783796492, -582.6775611902283, -472.5934343483063, -557.5452983525092, -234.58534185855817, -418.6660551365391, -626.9497037964196, -334.04213079867606, -170.73367194956788, -587.2621951361008, -44.6763844349591, -761.5518186274501, -549.4543551063712, -347.8366160929597, 14.727213065161777, -299.51747701008856, -679.5085814149932, -789.4699408199747, 337.3705521915407, -423.12827961058133, -228.57119954714747, -538.3578534272256, -326.7455638685801, -356.92089129692374, -382.35351182628983, -207.58152383280233, -530.0027075614926, -357.77831564731224, -524.4171349272092], "policy_predator_policy_reward": [504.557171571364, 573.0965689503064, 640.4142668653325, 570.6245153666856, 250.05122992323183, 664.1525562948865, 343.18365661838396, 585.0896309686166, 668.2227944185378, 521.4614521806923, 440.3613888908267, 395.35372325053515, 11.883560118300817, 241.36189001872523, 415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715, 287.937942301091, 365.1982387770901, 632.825643560297, 550.8168012105021, 440.0350908006238, 318.8686948845378, 357.70187544343037, 305.33832754541885, 143.35577394857705, 128.09398637933035, 258.3399326926449, 589.2449135226585, 511.67077668195424, 623.4060215303956, 807.695039291625, 38.93941546970968, 584.8093677352931, 474.6264138831895, 736.6549379628535, 0.0, 494.20633953275006, 390.2236239372331, 541.5772686691429, 398.5749055882174, 28.824803328825396, 581.5828803849433, 33.65885612108818, 673.8109688620589, 363.9189987412938, 348.1879551514993, 698.7877608546214, 597.5080185111517, 444.9649086665468, 633.4817204186147, 0.8254424758404358, 271.5844967952734, 629.4277462381452, 587.742601826839, 186.34111862587446, 272.9508135790823, 591.0936671125572, 757.6899828934824, 640.3767464428046, 603.1552595560375, 603.2537421685082, 524.2243291235607, 646.2640424404797, 487.1611141467012, 484.76761064836313, 562.0099215656534, 87.30448343344348, 109.06355289522327, 391.7402969964999, 525.4746148217797, 629.6362839499888, 669.1648826844378, 252.94866863017305, 591.1658031604777, 737.1860684319859, 423.7018677421829, 375.6868837506379, 393.6793128689759, 616.1671647641983, 525.6532068480523, 555.5049038783986, 394.1382562459158, 583.5099134852044, 587.2304134004389, 353.94373796865426, 357.2127957014581, 552.7469558702112, 349.88215357110755, 761.9518186274502, 553.7207183613372, 356.5199494262962, 435.2154304689474, 560.035179319501, 629.9658723448865, 676.697706505317, 696.3727409351957, 394.5553403884025, 389.4492726008043, 565.1630375600716, 297.4907845643351, 606.3114981573768, 3.2293211779615816, 540.2943515865925, 519.128877048071, 582.0274388006333, 572.2724030718119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.853131014226368, "mean_inference_ms": 7.0305984979713285, "mean_action_processing_ms": 2.4701451586509657, "mean_env_wait_ms": 14.180087677201977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014657378196716309, "StateBufferConnector_ms": 0.004789113998413086, "ViewRequirementAgentConnector_ms": 0.2109154462814331}, "num_episodes": 8, "episode_return_max": 920.9710588120797, "episode_return_min": -199.8915541431219, "episode_return_mean": 178.96711020702605, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.5207300803753, "num_env_steps_trained_throughput_per_sec": 132.5207300803753, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 29495.39, "restore_workers_time_ms": 0.137, "training_step_time_ms": 29494.999, "sample_time_ms": 3865.579, "learn_time_ms": 25587.264, "learn_throughput": 156.328, "synch_weights_time_ms": 36.908}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "01806_00000", "date": "2024-08-22_13-27-44", "timestamp": 1724313464, "time_this_iter_s": 30.254209995269775, "time_total_s": 2822.541400909424, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306bc5790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2822.541400909424, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 46.913953488372094, "ram_util_percent": 82.88837209302324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.045182310336482, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.00010000000000000003, "total_loss": 6.110952478237253, "policy_loss": -0.008465230571864931, "vf_loss": 6.118179486289857, "vf_explained_var": 0.46979324729354294, "kl": 0.008254694894803738, "entropy": 0.5831502323428159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.856191210267404, "cur_kl_coeff": 0.025, "cur_lr": 0.00010000000000000003, "total_loss": 6.297121504122618, "policy_loss": -0.01004399551256072, "vf_loss": 6.30693201186165, "vf_explained_var": 0.40224476529176906, "kl": 0.009339428690838671, "entropy": 0.1549141616259933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 482.3950000000041}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 920.9710588120797, "episode_reward_min": -199.8915541431219, "episode_reward_mean": 173.52493963499856, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -878.0505982962081, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 361.0496312532229, "predator_policy": 1133.7571123334228}, "policy_reward_mean": {"prey_policy": -387.969083202238, "predator_policy": 474.7315530197382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.76536569402507, 502.29463944272203, 158.34224927048422, 260.49073332687976, 117.62273006556758, 131.68739036844866, 179.049974619988, 271.20292814816077, -1.4494397198838618, 757.2552417499829, 65.09617136900142, 61.58569490535899, 57.42994152211653, -7.51043725469256, 208.10408675808725, -11.403209316106164, 713.7540793807805, -59.206686278472006, 446.13785386858984, 255.6777839799209, 194.33205965091176, -25.830557599418782, 170.45819714057473, 1.6000000000000036, -25.250293213296658, 349.59522197555515, 42.20092054063417, 318.54097457802374, 164.77522778334614, 319.61504221794416, 297.6459532161758, 318.8713706631167, 18.087448897329836, 171.76788824732543, 26.61395201720554, -199.8915541431219, 759.1499869272477, 310.24897322930633, -137.5881845880717, 3.3068272626268085, 42.923701474313496, 79.76055608733107, 370.55827234279457, 190.59568347035253, 91.4470023065057, 289.72991348766607, 455.21586074891337, 120.49139250612515, 253.2167167223632, 7.699999999999992, 75.33954086422423, 46.35987235432248, 71.52962861588034, 9.209828122274986, 12.599999999999948, -76.97301509699642, 21.300000000000022, 0.018193838802666562, 311.83655374246706, 61.7346187151716, -35.70597240741504, -41.2096867444594, 522.1059236457069, 103.36488647519033, 16.69999999999998, 56.976294878718804, -14.46000738457112, 144.38616883153787, -2.293481482802226, 501.84139882361626, 327.51327311089705, 7.187321874818323, 96.9944002082757, 65.30000000000057, 84.77525625995288, 299.69706240982407, 36.70184219094619, 371.33848298766327, 172.606349109762, 86.54937607371052, 157.51251991324267, 125.12456795268085, 206.3807309218636, 270.69052987025606, 4.66636325496493, 458.62597686744573, 210.97499323930228, 920.9710588120797, 132.30513383147746, -2.4495951714011452, -129.73358378787756, 321.83899724037013, 272.1043912979209, 199.6880887355638, 125.65783305858871, 508.1514120017348, 193.09669867704162, 320.8594493161411, 493.3700060671889, 168.049366921061], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-619.5235994701042, -629.6373163904683, 293.1407753873056, -245.3867162885832, -488.91609088517316, -78.9037814222489, -641.9803819867883, -54.52630679479981, 34.136470917887806, -237.60930174377194, -764.0140376171094, -482.0336115209014, -32.29871283984498, -191.49284577178344, -269.55265849182916, -548.9065598206297, -407.6945014823102, -115.83787224867541, -874.3530560107529, 210.54282471557923, -449.8418104045066, -626.8285876814216, -403.56600852961185, -763.4724107739186, -85.21740798663436, -668.0785759861907, -607.2764269600643, -125.98001179690795, -695.6835564894834, -73.60711073093829, -795.0523018715295, -699.0930632193479, 361.0496312532229, -668.5177148509018, -350.34634953318346, -504.90341182005193, -836.1986706378387, -317.71105956365966, -189.5150914347974, -754.6984961035357, -81.03508694071087, -299.71848959852707, -444.5604056757865, -710.544317155875, -503.0563316414057, -628.307723649577, -771.1083500554189, -721.4229824818262, -339.61159246003274, -512.9723999912867, -215.88430698503174, -661.8946940222963, -437.6514763218272, -225.595478797513, -613.3289567254818, 93.17904611641188, -255.03493149242456, -111.01362804323645, -436.2345803363638, -553.6868564688881, -256.220357686058, -623.1834637417859, -767.6777999026276, -69.0863194412963, -406.83916450844987, -785.0805962904508, -550.7844082939612, -690.4108749993478, -283.2852756978415, -316.8727979448317, -564.7282851684054, -483.0075917656297, -606.371867733225, 353.4969597126292, -878.0505982962081, -149.67868364978938, -541.1238355233742, -628.0030949571338, -627.4048795178081, -603.7974734842496, -464.30082915523246, -331.44018323616706, -322.3131193779087, -212.80724118404748, -573.6852662510079, -355.78630759992507, -349.3900005210894, -638.9111190976944, -561.8360207042851, -554.1322477148565, 54.48539722744525, -709.2559044749405, -84.65659436777808, 356.37318748876805, -152.26674864616865, -81.97705486180666, -338.1637702322377, -61.75569412357499, -632.2256435602968, -543.7168012105002, -460.46155696426456, -223.10268785667128, -248.13366846335109, -368.546662171168, -93.19480862579633, -106.72532308623411, -253.73010457036779, -584.6449135226583, -505.67077668195344, -616.8060215303948, -139.4692393693865, -784.1382304889438, -577.6093677352927, -460.5264138831863, -486.075247430184, -250.56149669386375, -278.61420860559747, -293.979201121916, -478.25252843839417, -400.1650271037935, -452.1254272631885, -193.98822885799362, -278.6090303472069, -470.07048138039596, -364.35255691426795, 174.35152666718233, -588.36054457163, -604.5703483189504, -434.3649086665454, -627.3817204186145, 28.38899984223711, -243.82264423463073, -727.1228565059945, -504.5074989435593, -77.27474522730928, -237.6310181461086, -756.53044862157, -594.5466828672669, -650.0161713963671, -91.67443577886439, -476.42871222080595, -323.5360859603606, -643.4640424404791, -482.7737922718817, -319.375413781071, -630.4077182246682, -53.00448343344465, -78.06355289522496, -301.10076129205277, -531.3388942662749, -637.3491146393344, -361.7549895852628, -423.0551198932104, -384.3575097064923, -390.45871584475196, -399.0907373417539, -355.18156967187736, -241.57827783796492, -582.6775611902283, -472.5934343483063, -557.5452983525092, -234.58534185855817, -418.6660551365391, -626.9497037964196, -334.04213079867606, -170.73367194956788, -587.2621951361008, -44.6763844349591, -761.5518186274501, -549.4543551063712, -347.8366160929597, 14.727213065161777, -299.51747701008856, -679.5085814149932, -789.4699408199747, 337.3705521915407, -423.12827961058133, -228.57119954714747, -538.3578534272256, -326.7455638685801, -356.92089129692374, -382.35351182628983, -207.58152383280233, -530.0027075614926, -357.77831564731224, -524.4171349272092, -474.7713810635798, -341.4625846506578, -55.5140955387131, 40.0000000000003, 180.94830821250966, -412.83361261094467, -649.4210173655667, 27.133787742301095, 94.3966581814918, -660.2517253330219, -821.2025517526457, -231.4486483874998, -652.5313934307314, -454.35077638005254], "policy_predator_policy_reward": [415.77612814691844, 808.6194220196315, 191.56905361957342, 262.9715267244248, 547.2850598335783, 178.8770617443295, 264.9653369798926, 692.0320851285745, 142.57299683373623, 178.52256405772033, 764.4915208090828, 613.2435186973823, 190.53630291723402, 212.30523031438418, 568.1995265883398, 521.4626198722793, 510.9482094993782, 11.134724511727242, 761.5584919847764, 659.5069810603835, 557.697530568209, 584.0690388867195, 492.9420097682184, 735.6821044406744, 357.494524840086, 453.2314006548571, 630.2412136036577, 95.50478789862112, 321.6284236554059, 655.7663303231047, 348.9850434413479, 1133.7571123334228, 605.7173205706084, 415.50484240785227, 610.9499794057969, 185.0930956689728, 780.054815672967, 819.9927683971199, 528.239796162933, 671.6515753553248, 261.23334243662885, 313.85229375352816, 341.3108124490925, 787.9633527831566, 685.9696965951771, 615.852555836385, 771.1083500554189, 723.0229824818266, 300.3402249191066, 526.9934743189219, 757.9516589079168, 469.4225640749673, 489.79078550966716, 215.65709015030706, 628.6083600013628, 210.08252518573067, 264.3287929788198, 266.4949943401931, 650.6491803523588, 658.8872986708394, 587.254016985577, 589.7957576584439, 486.63345663849054, 669.0020333685496, 433.2003082474807, 776.8069014487523, 630.0489762841181, 782.9141952565215, 251.4162193745592, 375.35580628532847, 381.11475972377343, 466.7295630671399, 500.70857582058204, 511.31631912726345, 800.7016142236356, 537.2766409516621, 537.2970021504514, 494.2417437419843, 518.6636251092797, 715.8455551554049, 460.89566245205333, 377.7690514136647, 291.1943854108663, 323.6865312384238, 495.3351099970218, 804.6947361967076, 522.6019262759852, 656.2948768131572, 635.5436967134118, 571.8715740122379, 234.64451626022074, 709.8559044749406, 116.93245560238663, 66.56681202553108, 166.97724099954257, 187.75795501455715, 287.937942301091, 365.1982387770901, 632.825643560297, 550.8168012105021, 440.0350908006238, 318.8686948845378, 357.70187544343037, 305.33832754541885, 143.35577394857705, 128.09398637933035, 258.3399326926449, 589.2449135226585, 511.67077668195424, 623.4060215303956, 807.695039291625, 38.93941546970968, 584.8093677352931, 474.6264138831895, 736.6549379628535, 0.0, 494.20633953275006, 390.2236239372331, 541.5772686691429, 398.5749055882174, 28.824803328825396, 581.5828803849433, 33.65885612108818, 673.8109688620589, 363.9189987412938, 348.1879551514993, 698.7877608546214, 597.5080185111517, 444.9649086665468, 633.4817204186147, 0.8254424758404358, 271.5844967952734, 629.4277462381452, 587.742601826839, 186.34111862587446, 272.9508135790823, 591.0936671125572, 757.6899828934824, 640.3767464428046, 603.1552595560375, 603.2537421685082, 524.2243291235607, 646.2640424404797, 487.1611141467012, 484.76761064836313, 562.0099215656534, 87.30448343344348, 109.06355289522327, 391.7402969964999, 525.4746148217797, 629.6362839499888, 669.1648826844378, 252.94866863017305, 591.1658031604777, 737.1860684319859, 423.7018677421829, 375.6868837506379, 393.6793128689759, 616.1671647641983, 525.6532068480523, 555.5049038783986, 394.1382562459158, 583.5099134852044, 587.2304134004389, 353.94373796865426, 357.2127957014581, 552.7469558702112, 349.88215357110755, 761.9518186274502, 553.7207183613372, 356.5199494262962, 435.2154304689474, 560.035179319501, 629.9658723448865, 676.697706505317, 696.3727409351957, 394.5553403884025, 389.4492726008043, 565.1630375600716, 297.4907845643351, 606.3114981573768, 3.2293211779615816, 540.2943515865925, 519.128877048071, 582.0274388006333, 572.2724030718119, 658.4108732896491, 357.51118116015584, 85.49547382835729, 55.67645476894658, 393.2468522155363, 346.78986418463353, 276.81044649097043, 538.5734818093382, 664.3053895146214, 222.40912695304948, 758.5089551543416, 787.5122510529825, 656.0360637828861, 618.8954729489606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.8558641919731755, "mean_inference_ms": 7.025941166821977, "mean_action_processing_ms": 2.479124016883518, "mean_env_wait_ms": 14.186617965750704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014721155166625977, "StateBufferConnector_ms": 0.004843473434448242, "ViewRequirementAgentConnector_ms": 0.24166333675384521}, "num_episodes": 7, "episode_return_max": 920.9710588120797, "episode_return_min": -199.8915541431219, "episode_return_mean": 173.52493963499856, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.74403931982167, "num_env_steps_trained_throughput_per_sec": 137.74403931982167, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 29554.081, "restore_workers_time_ms": 0.135, "training_step_time_ms": 29553.68, "sample_time_ms": 3921.447, "learn_time_ms": 25589.362, "learn_throughput": 156.315, "synch_weights_time_ms": 37.389}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "01806_00000", "date": "2024-08-22_13-28-13", "timestamp": 1724313493, "time_this_iter_s": 29.082139015197754, "time_total_s": 2851.6235399246216, "pid": 84627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 10, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x306b8cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2851.6235399246216, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 45.27560975609756, "ram_util_percent": 83.14390243902439}}
